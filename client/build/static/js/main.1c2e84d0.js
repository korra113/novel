/*! For license information please see main.1c2e84d0.js.LICENSE.txt */
(()=>{var e={2:(e,t,n)=>{"use strict";var r,o=n(1251),i=n(9304),a=n(9820),s=n(1725),l=n(5077),c=n(2557),d=n(4902),u=n(3094),p=n(3701),h=n(1911),f=n(4591),g=n(1557),m=n(7583),v=n(969),y=n(7792),x=Function,b=function(e){try{return x('"use strict"; return ('+e+").constructor;")()}catch(t){}},w=n(5558),S=n(2090),k=function(){throw new d},C=w?function(){try{return k}catch(e){try{return w(arguments,"callee").get}catch(t){return k}}}():k,j=n(2108)(),_=n(1291),E=n(7651),D=n(757),M=n(5061),T=n(4937),I={},A="undefined"!==typeof Uint8Array&&_?_(Uint8Array):r,O={__proto__:null,"%AggregateError%":"undefined"===typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":j&&_?_([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":I,"%AsyncGenerator%":I,"%AsyncGeneratorFunction%":I,"%AsyncIteratorPrototype%":I,"%Atomics%":"undefined"===typeof Atomics?r:Atomics,"%BigInt%":"undefined"===typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"===typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"===typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":a,"%Float16Array%":"undefined"===typeof Float16Array?r:Float16Array,"%Float32Array%":"undefined"===typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":I,"%Int8Array%":"undefined"===typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":j&&_?_(_([][Symbol.iterator]())):r,"%JSON%":"object"===typeof JSON?JSON:r,"%Map%":"undefined"===typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&j&&_?_((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":o,"%Object.getOwnPropertyDescriptor%":w,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?r:Promise,"%Proxy%":"undefined"===typeof Proxy?r:Proxy,"%RangeError%":s,"%ReferenceError%":l,"%Reflect%":"undefined"===typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&j&&_?_((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":j&&_?_(""[Symbol.iterator]()):r,"%Symbol%":j?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":C,"%TypedArray%":A,"%TypeError%":d,"%Uint8Array%":"undefined"===typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"===typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?r:WeakSet,"%Function.prototype.call%":T,"%Function.prototype.apply%":M,"%Object.defineProperty%":S,"%Object.getPrototypeOf%":E,"%Math.abs%":p,"%Math.floor%":h,"%Math.max%":f,"%Math.min%":g,"%Math.pow%":m,"%Math.round%":v,"%Math.sign%":y,"%Reflect.getPrototypeOf%":D};if(_)try{null.error}catch(Y){var R=_(_(Y));O["%Error.prototype%"]=R}var z=function e(t){var n;if("%AsyncFunction%"===t)n=b("async function () {}");else if("%GeneratorFunction%"===t)n=b("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=b("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&_&&(n=_(o.prototype))}return O[t]=n,n},F={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},P=n(3864),B=n(4384),L=P.call(T,Array.prototype.concat),N=P.call(M,Array.prototype.splice),U=P.call(T,String.prototype.replace),V=P.call(T,String.prototype.slice),W=P.call(T,RegExp.prototype.exec),H=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G=/\\(\\)?/g,X=function(e,t){var n,r=e;if(B(F,r)&&(r="%"+(n=F[r])[0]+"%"),B(O,r)){var o=O[r];if(o===I&&(o=z(r)),"undefined"===typeof o&&!t)throw new d("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!==typeof e||0===e.length)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof t)throw new d('"allowMissing" argument must be a boolean');if(null===W(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=V(e,0,1),n=V(e,-1);if("%"===t&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return U(e,H,function(e,t,n,o){r[r.length]=n?U(o,G,"$1"):t||e}),r}(e),r=n.length>0?n[0]:"",o=X("%"+r+"%",t),i=o.name,a=o.value,s=!1,l=o.alias;l&&(r=l[0],N(n,L([0,1],l)));for(var u=1,p=!0;u<n.length;u+=1){var h=n[u],f=V(h,0,1),g=V(h,-1);if(('"'===f||"'"===f||"`"===f||'"'===g||"'"===g||"`"===g)&&f!==g)throw new c("property names with quotes must have matching quotes");if("constructor"!==h&&p||(s=!0),B(O,i="%"+(r+="."+h)+"%"))a=O[i];else if(null!=a){if(!(h in a)){if(!t)throw new d("base intrinsic for "+e+" exists, but the property is not available.");return}if(w&&u+1>=n.length){var m=w(a,h);a=(p=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:a[h]}else p=B(a,h),a=a[h];p&&!s&&(O[i]=a)}}return a}},14:e=>{e.exports=function(){return!1}},61:e=>{e.exports=function(e,t){return e<t}},66:(e,t,n)=>{"use strict";var r=n(8117),o=n(3290),i=r("RegExp.prototype.exec"),a=n(4902);e.exports=function(e){if(!o(e))throw new a("`regex` must be a RegExp");return function(t){return null!==i(e,t)}}},111:(e,t,n)=>{var r=n(1069),o=0;e.exports=function(e){var t=++o;return r(e)+t}},127:(e,t,n)=>{var r=n(2125);e.exports=function(e,t){return r(e,t,"pre")}},141:e=>{e.exports=function(e){return void 0===e}},143:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},149:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},191:(e,t,n)=>{"use strict";var r=n(5750);e.exports=i;var o="\0";function i(e){this._isDirected=!r.has(e,"directed")||e.directed,this._isMultigraph=!!r.has(e,"multigraph")&&e.multigraph,this._isCompound=!!r.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[o]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function a(e,t){e[t]?e[t]++:e[t]=1}function s(e,t){--e[t]||delete e[t]}function l(e,t,n,o){var i=""+t,a=""+n;if(!e&&i>a){var s=i;i=a,a=s}return i+"\x01"+a+"\x01"+(r.isUndefined(o)?"\0":o)}function c(e,t){return l(e,t.v,t.w,t.name)}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(e){return this._label=e,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._in[t])})},i.prototype.sinks=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._out[t])})},i.prototype.setNodes=function(e,t){var n=arguments,o=this;return r.each(e,function(e){n.length>1?o.setNode(e,t):o.setNode(e)}),this},i.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=o,this._children[e]={},this._children[o][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},i.prototype.node=function(e){return this._nodes[e]},i.prototype.hasNode=function(e){return r.has(this._nodes,e)},i.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),function(e){t.setParent(e)}),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},i.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=o;else{for(var n=t+="";!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},i.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},i.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==o)return t}},i.prototype.children=function(e){if(r.isUndefined(e)&&(e=o),this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===o)return this.nodes();if(this.hasNode(e))return[]}},i.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},i.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},i.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},i.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},i.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;r.each(this._nodes,function(n,r){e(r)&&t.setNode(r,n)}),r.each(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))});var o={};function i(e){var r=n.parent(e);return void 0===r||t.hasNode(r)?(o[e]=r,r):r in o?o[r]:i(r)}return this._isCompound&&r.each(t.nodes(),function(e){t.setParent(e,i(e))}),t},i.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(e,t){var n=this,o=arguments;return r.reduce(e,function(e,r){return o.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r}),this},i.prototype.setEdge=function(){var e,t,n,o,i=!1,s=arguments[0];"object"===typeof s&&null!==s&&"v"in s?(e=s.v,t=s.w,n=s.name,2===arguments.length&&(o=arguments[1],i=!0)):(e=s,t=arguments[1],n=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var c=l(this._isDirected,e,t,n);if(r.has(this._edgeLabels,c))return i&&(this._edgeLabels[c]=o),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[c]=i?o:this._defaultEdgeLabelFn(e,t,n);var d=function(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};r&&(s.name=r);return s}(this._isDirected,e,t,n);return e=d.v,t=d.w,Object.freeze(d),this._edgeObjs[c]=d,a(this._preds[t],e),a(this._sucs[e],t),this._in[t][c]=d,this._out[e][c]=d,this._edgeCount++,this},i.prototype.edge=function(e,t,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[r]},i.prototype.hasEdge=function(e,t,n){var o=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return r.has(this._edgeLabels,o)},i.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],s(this._preds[t],e),s(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},i.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var o=r.values(n);return t?r.filter(o,function(e){return e.v===t}):o}},i.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var o=r.values(n);return t?r.filter(o,function(e){return e.w===t}):o}},i.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},247:(e,t,n)=>{var r=n(5750),o=n(8808);e.exports=function(e){return r.filter(o(e),function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])})}},310:(e,t,n)=>{var r=n(1817),o=n(5990),i=n(6140);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},320:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},388:(e,t,n)=>{var r=n(8208),o=n(5641);function i(e,t,n){for(var o;t.length&&(o=r.last(t)).i<=n;)t.pop(),e.push(o.vs),n++;return n}e.exports=function(e,t){var n=o.partition(e,function(e){return r.has(e,"barycenter")}),a=n.lhs,s=r.sortBy(n.rhs,function(e){return-e.i}),l=[],c=0,d=0,u=0;a.sort((p=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:p?t.i-e.i:e.i-t.i})),u=i(l,s,u),r.forEach(a,function(e){u+=e.vs.length,l.push(e.vs),c+=e.barycenter*e.weight,d+=e.weight,u=i(l,s,u)});var p;var h={vs:r.flatten(l,!0)};d&&(h.barycenter=c/d,h.weight=d);return h}},396:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},438:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).get(e)}},449:(e,t,n)=>{var r=n(6924),o=n(2761);e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},450:(e,t,n)=>{var r=n(755),o=n(5647),i=n(4416),a=n(6272),s=o(function(e){return i(r(e,1,a,!0))});e.exports=s},474:(e,t,n)=>{var r=n(3204),o=n(8122),i=n(6571);e.exports=function(e){return i(e)?r(e,!0):o(e)}},539:(e,t,n)=>{var r=n(9742),o=n(7498),i=n(3279);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},550:(e,t,n)=>{"use strict";var r=n(8208),o=n(5819),i=n(4308),a=n(9791),s=n(1987),l=n(8381),c=n(7938).Graph,d=n(5641);function u(e,t,n){return r.map(t,function(t){return s(e,t,n)})}function p(e,t){var n=new c;r.forEach(e,function(e){var o=e.graph().root,i=a(e,o,n,t);r.forEach(i.vs,function(t,n){e.node(t).order=n}),l(e,n,i.vs)})}function h(e,t){r.forEach(t,function(t){r.forEach(t,function(t,n){e.node(t).order=n})})}e.exports=function(e){var t=d.maxRank(e),n=u(e,r.range(1,t+1),"inEdges"),a=u(e,r.range(t-1,-1,-1),"outEdges"),s=o(e);h(e,s);for(var l,c=Number.POSITIVE_INFINITY,f=0,g=0;g<4;++f,++g){p(f%2?n:a,f%4>=2),s=d.buildLayerMatrix(e);var m=i(e,s);m<c&&(g=0,l=r.cloneDeep(s),c=m)}h(e,l)}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},620:(e,t,n)=>{var r=n(6913),o=n(4052),i=n(2761);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==r(e)}},644:e=>{e.exports=function(e){return e!==e}},705:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},723:(e,t,n)=>{var r=n(7529),o=n(7171),i=n(9096),a=n(4052);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},726:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},755:(e,t,n)=>{var r=n(8895),o=n(7116);e.exports=function e(t,n,i,a,s){var l=-1,c=t.length;for(i||(i=o),s||(s=[]);++l<c;){var d=t[l];n>0&&i(d)?n>1?e(d,n-1,i,a,s):r(s,d):a||(s[s.length]=d)}return s}},757:e=>{"use strict";e.exports="undefined"!==typeof Reflect&&Reflect.getPrototypeOf||null},793:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},794:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.hasMultiEffects=t.readVectorMask=t.booleanOperations=t.readBezierKnot=t.infoHandlersMap=t.infoHandlers=void 0;var o=n(4445),i=n(980),a=n(6302),s=n(8147),l=n(5171),c=n(2038),d=n(9729),u=n(6960),p=n(6427),h="abcdefghijklmnopqrstuvwxyz";function f(e,n,r,o){var i={key:e,has:n,read:r,write:o};t.infoHandlers.push(i),t.infoHandlersMap[i.key]=i}function g(e,n){t.infoHandlersMap[e]=t.infoHandlersMap[n]}function m(e){return function(t){return void 0!==t[e]}}function v(e){if((0,s.readUint32)(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return(0,s.readUint32)(e)}function y(e,t){(0,l.writeUint32)(e,0),(0,l.writeUint32)(e,t)}function x(e,t,n){var r=(0,s.readFixedPointPath32)(e)*n,o=(0,s.readFixedPointPath32)(e)*t,i=(0,s.readFixedPointPath32)(e)*n,a=(0,s.readFixedPointPath32)(e)*t,l=(0,s.readFixedPointPath32)(e)*n;return[o,r,a,i,(0,s.readFixedPointPath32)(e)*t,l]}function b(e,t,n,r){(0,l.writeFixedPointPath32)(e,t[1]/r),(0,l.writeFixedPointPath32)(e,t[0]/n),(0,l.writeFixedPointPath32)(e,t[3]/r),(0,l.writeFixedPointPath32)(e,t[2]/n),(0,l.writeFixedPointPath32)(e,t[5]/r),(0,l.writeFixedPointPath32)(e,t[4]/n)}function w(e,n,r,o,i){for(var a=e.offset+i,l=n.paths,c=void 0;a-e.offset>=26;){var d=(0,s.readUint16)(e);switch(d){case 0:case 3:(0,s.readUint16)(e);var u=(0,s.readInt16)(e),p=(0,s.readUint16)(e);(0,s.skipBytes)(e,18),c={open:3===d,knots:[],fillRule:2===p?"non-zero":"even-odd"},-1!==u&&(c.operation=t.booleanOperations[u]),l.push(c);break;case 1:case 2:case 4:case 5:c.knots.push({linked:1===d||4===d,points:x(e,r,o)});break;case 6:(0,s.skipBytes)(e,24);break;case 7:var h=(0,s.readFixedPointPath32)(e),f=(0,s.readFixedPointPath32)(e),g=(0,s.readFixedPointPath32)(e),m=(0,s.readFixedPointPath32)(e),v=(0,s.readFixedPointPath32)(e);(0,s.skipBytes)(e,4),n.clipboard={top:h,left:f,bottom:g,right:m,resolution:v};break;case 8:n.fillStartsWithAllPixels=!!(0,s.readUint16)(e),(0,s.skipBytes)(e,22);break;default:throw new Error("Invalid vmsk section")}}return l}t.infoHandlers=[],t.infoHandlersMap={},f("TySh",m("text"),function(e,t,n){if(1!==(0,s.readInt16)(e))throw new Error("Invalid TySh version");for(var o=[],i=0;i<6;i++)o.push((0,s.readFloat64)(e));if(50!==(0,s.readInt16)(e))throw new Error("Invalid TySh text version");var a=(0,c.readVersionAndDescriptor)(e);if(1!==(0,s.readInt16)(e))throw new Error("Invalid TySh warp version");var l=(0,c.readVersionAndDescriptor)(e);if(t.text={transform:o,left:(0,s.readFloat32)(e),top:(0,s.readFloat32)(e),right:(0,s.readFloat32)(e),bottom:(0,s.readFloat32)(e),text:a["Txt "].replace(/\r/g,"\n"),index:a.TextIndex||0,gridding:c.textGridding.decode(a.textGridding),antiAlias:c.Annt.decode(a.AntA),orientation:c.Ornt.decode(a.Ornt),warp:{style:c.warpStyle.decode(l.warpStyle),value:l.warpValue||0,perspective:l.warpPerspective||0,perspectiveOther:l.warpPerspectiveOther||0,rotate:c.Ornt.decode(l.warpRotate)}},a.bounds&&(t.text.bounds=(0,c.descBoundsToBounds)(a.bounds)),a.boundingBox&&(t.text.boundingBox=(0,c.descBoundsToBounds)(a.boundingBox)),a.EngineData){var p=(0,d.parseEngineData)(a.EngineData),h=(0,u.decodeEngineData)(p);t.text=r(r({},t.text),h)}(0,s.skipBytes)(e,n())},function(e,t){var n=t.text,o=n.warp||{},i=n.transform||[1,0,0,1,0,0],a=r(r(r({"Txt ":(n.text||"").replace(/\r?\n/g,"\r"),textGridding:c.textGridding.encode(n.gridding),Ornt:c.Ornt.encode(n.orientation),AntA:c.Annt.encode(n.antiAlias)},n.bounds?{bounds:(0,c.boundsToDescBounds)(n.bounds)}:{}),n.boundingBox?{boundingBox:(0,c.boundsToDescBounds)(n.boundingBox)}:{}),{TextIndex:n.index||0,EngineData:(0,d.serializeEngineData)((0,u.encodeEngineData)(n))});(0,l.writeInt16)(e,1);for(var s=0;s<6;s++)(0,l.writeFloat64)(e,i[s]);(0,l.writeInt16)(e,50),(0,c.writeVersionAndDescriptor)(e,"","TxLr",a,"text"),(0,l.writeInt16)(e,1),(0,c.writeVersionAndDescriptor)(e,"","warp",j(o)),(0,l.writeFloat32)(e,n.left),(0,l.writeFloat32)(e,n.top),(0,l.writeFloat32)(e,n.right),(0,l.writeFloat32)(e,n.bottom)}),f("SoCo",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);t.vectorFill=(0,c.parseVectorContent)(n)},function(e,t){var n=(0,c.serializeVectorContent)(t.vectorFill).descriptor;(0,c.writeVersionAndDescriptor)(e,"","null",n)}),f("GdFl",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)},function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.vectorFill=(0,c.parseVectorContent)(r),(0,s.skipBytes)(e,n())},function(e,t){var n=(0,c.serializeVectorContent)(t.vectorFill).descriptor;(0,c.writeVersionAndDescriptor)(e,"","null",n)}),f("PtFl",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);t.vectorFill=(0,c.parseVectorContent)(n)},function(e,t){var n=(0,c.serializeVectorContent)(t.vectorFill).descriptor;(0,c.writeVersionAndDescriptor)(e,"","null",n)}),f("vscg",function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke},function(e,t,n){(0,s.readSignature)(e);var r=(0,c.readVersionAndDescriptor)(e);t.vectorFill=(0,c.parseVectorContent)(r),(0,s.skipBytes)(e,n())},function(e,t){var n=(0,c.serializeVectorContent)(t.vectorFill),r=n.descriptor,o=n.key;(0,l.writeSignature)(e,o),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),t.readBezierKnot=x,t.booleanOperations=["exclude","combine","subtract","intersect"],t.readVectorMask=w,f("vmsk",m("vectorMask"),function(e,t,n,r){var o=r.width,i=r.height;if(3!==(0,s.readUint32)(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var a=t.vectorMask,l=(0,s.readUint32)(e);a.invert=0!==(1&l),a.notLink=0!==(2&l),a.disable=0!==(4&l),w(e,a,o,i,n()),(0,s.skipBytes)(e,n())},function(e,n,r){var o=r.width,i=r.height,a=n.vectorMask,s=(a.invert?1:0)|(a.notLink?2:0)|(a.disable?4:0);(0,l.writeUint32)(e,3),(0,l.writeUint32)(e,s),(0,l.writeUint16)(e,6),(0,l.writeZeros)(e,24);var c=a.clipboard;c&&((0,l.writeUint16)(e,7),(0,l.writeFixedPointPath32)(e,c.top),(0,l.writeFixedPointPath32)(e,c.left),(0,l.writeFixedPointPath32)(e,c.bottom),(0,l.writeFixedPointPath32)(e,c.right),(0,l.writeFixedPointPath32)(e,c.resolution),(0,l.writeZeros)(e,4)),(0,l.writeUint16)(e,8),(0,l.writeUint16)(e,a.fillStartsWithAllPixels?1:0),(0,l.writeZeros)(e,22);for(var d=0,u=a.paths;d<u.length;d++){var p=u[d];(0,l.writeUint16)(e,p.open?3:0),(0,l.writeUint16)(e,p.knots.length),(0,l.writeUint16)(e,p.operation?t.booleanOperations.indexOf(p.operation):-1),(0,l.writeUint16)(e,"non-zero"===p.fillRule?2:1),(0,l.writeZeros)(e,18);for(var h=p.open?4:1,f=p.open?5:2,g=0,m=p.knots;g<m.length;g++){var v=m[g],y=v.linked,x=v.points;(0,l.writeUint16)(e,y?h:f),b(e,x,o,i)}}}),g("vsms","vmsk"),f("vowv",m("vowv"),function(e,t){t.vowv=(0,s.readUint32)(e)},function(e,t){(0,l.writeUint32)(e,t.vowv)}),f("vogk",m("vectorOrigination"),function(e,t,n){if(1!==(0,s.readInt32)(e))throw new Error("Invalid vogk version");var r=(0,c.readVersionAndDescriptor)(e);t.vectorOrigination={keyDescriptorList:[]};for(var o=0,i=r.keyDescriptorList;o<i.length;o++){var a=i[o],l={};null!=a.keyShapeInvalidated&&(l.keyShapeInvalidated=a.keyShapeInvalidated),null!=a.keyOriginType&&(l.keyOriginType=a.keyOriginType),null!=a.keyOriginResolution&&(l.keyOriginResolution=a.keyOriginResolution),a.keyOriginShapeBBox&&(l.keyOriginShapeBoundingBox={top:(0,c.parseUnitsOrNumber)(a.keyOriginShapeBBox["Top "]),left:(0,c.parseUnitsOrNumber)(a.keyOriginShapeBBox.Left),bottom:(0,c.parseUnitsOrNumber)(a.keyOriginShapeBBox.Btom),right:(0,c.parseUnitsOrNumber)(a.keyOriginShapeBBox.Rght)});var d=a.keyOriginRRectRadii;d&&(l.keyOriginRRectRadii={topRight:(0,c.parseUnits)(d.topRight),topLeft:(0,c.parseUnits)(d.topLeft),bottomLeft:(0,c.parseUnits)(d.bottomLeft),bottomRight:(0,c.parseUnits)(d.bottomRight)});var u=a.keyOriginBoxCorners;u&&(l.keyOriginBoxCorners=[{x:u.rectangleCornerA.Hrzn,y:u.rectangleCornerA.Vrtc},{x:u.rectangleCornerB.Hrzn,y:u.rectangleCornerB.Vrtc},{x:u.rectangleCornerC.Hrzn,y:u.rectangleCornerC.Vrtc},{x:u.rectangleCornerD.Hrzn,y:u.rectangleCornerD.Vrtc}]);var p=a.Trnf;p&&(l.transform=[p.xx,p.xy,p.yx,p.yy,p.tx,p.ty]),t.vectorOrigination.keyDescriptorList.push(l)}(0,s.skipBytes)(e,n())},function(e,t){for(var n=t.vectorOrigination,r={keyDescriptorList:[]},o=0;o<n.keyDescriptorList.length;o++){var i=n.keyDescriptorList[o];r.keyDescriptorList.push({});var a=r.keyDescriptorList[r.keyDescriptorList.length-1];null!=i.keyOriginType&&(a.keyOriginType=i.keyOriginType),null!=i.keyOriginResolution&&(a.keyOriginResolution=i.keyOriginResolution);var s=i.keyOriginRRectRadii;s&&(a.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:(0,c.unitsValue)(s.topRight,"topRight"),topLeft:(0,c.unitsValue)(s.topLeft,"topLeft"),bottomLeft:(0,c.unitsValue)(s.bottomLeft,"bottomLeft"),bottomRight:(0,c.unitsValue)(s.bottomRight,"bottomRight")});var d=i.keyOriginShapeBoundingBox;d&&(a.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":(0,c.unitsValue)(d.top,"top"),Left:(0,c.unitsValue)(d.left,"left"),Btom:(0,c.unitsValue)(d.bottom,"bottom"),Rght:(0,c.unitsValue)(d.right,"right")});var u=i.keyOriginBoxCorners;u&&4===u.length&&(a.keyOriginBoxCorners={rectangleCornerA:{Hrzn:u[0].x,Vrtc:u[0].y},rectangleCornerB:{Hrzn:u[1].x,Vrtc:u[1].y},rectangleCornerC:{Hrzn:u[2].x,Vrtc:u[2].y},rectangleCornerD:{Hrzn:u[3].x,Vrtc:u[3].y}});var p=i.transform;p&&6===p.length&&(a.Trnf={xx:p[0],xy:p[1],yx:p[2],yy:p[3],tx:p[4],ty:p[5]}),null!=i.keyShapeInvalidated&&(a.keyShapeInvalidated=i.keyShapeInvalidated),a.keyOriginIndex=o}(0,l.writeInt32)(e,1),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),f("lmfx",function(e){return void 0!==e.effects&&te(e.effects)},function(e,t,n){if(0!==(0,s.readUint32)(e))throw new Error("Invalid lmfx version");var r=(0,c.readVersionAndDescriptor)(e);t.effects=(0,c.parseEffects)(r,!!e.logMissingFeatures),(0,s.skipBytes)(e,n())},function(e,t,n,r){var o=(0,c.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,l.writeUint32)(e,0),(0,c.writeVersionAndDescriptor)(e,"","null",o)}),f("lrFX",m("effects"),function(e,t,n){t.effects||(t.effects=(0,i.readEffects)(e)),(0,s.skipBytes)(e,n())},function(e,t){(0,i.writeEffects)(e,t.effects)}),f("luni",m("name"),function(e,t,n){if(n()>4){var r=(0,s.readUint32)(e);n()>=2*r?t.name=(0,s.readUnicodeStringWithLength)(e,r):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");(0,s.skipBytes)(e,n())},function(e,t){(0,l.writeUnicodeString)(e,t.name)}),f("lnsr",m("nameSource"),function(e,t){return t.nameSource=(0,s.readSignature)(e)},function(e,t){return(0,l.writeSignature)(e,t.nameSource)}),f("lyid",m("id"),function(e,t){t.id=(0,s.readUint32)(e)},function(e,t,n,r){for(var o=t.id;r.layerIds.has(o);)o+=100;(0,l.writeUint32)(e,o),r.layerIds.add(o),r.layerToId.set(t,o)}),f("lsct",m("sectionDivider"),function(e,t,n){t.sectionDivider={type:(0,s.readUint32)(e)},n()&&((0,s.checkSignature)(e,"8BIM"),t.sectionDivider.key=(0,s.readSignature)(e)),n()&&(t.sectionDivider.subType=(0,s.readUint32)(e))},function(e,t){(0,l.writeUint32)(e,t.sectionDivider.type),t.sectionDivider.key&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&(0,l.writeUint32)(e,t.sectionDivider.subType))}),g("lsdk","lsct"),f("clbl",m("blendClippendElements"),function(e,t){t.blendClippendElements=!!(0,s.readUint8)(e),(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,t.blendClippendElements?1:0),(0,l.writeZeros)(e,3)}),f("infx",m("blendInteriorElements"),function(e,t){t.blendInteriorElements=!!(0,s.readUint8)(e),(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,t.blendInteriorElements?1:0),(0,l.writeZeros)(e,3)}),f("knko",m("knockout"),function(e,t){t.knockout=!!(0,s.readUint8)(e),(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,t.knockout?1:0),(0,l.writeZeros)(e,3)}),f("lmgm",m("layerMaskAsGlobalMask"),function(e,t){t.layerMaskAsGlobalMask=!!(0,s.readUint8)(e),(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,t.layerMaskAsGlobalMask?1:0),(0,l.writeZeros)(e,3)}),f("lspf",m("protected"),function(e,t){var n=(0,s.readUint32)(e);t.protected={transparency:0!==(1&n),composite:0!==(2&n),position:0!==(4&n)},8&n&&(t.protected.artboards=!0)},function(e,t){var n=(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0);(0,l.writeUint32)(e,n)}),f("lclr",m("layerColor"),function(e,t){var n=(0,s.readUint16)(e);(0,s.skipBytes)(e,6),t.layerColor=a.layerColors[n]},function(e,t){var n=a.layerColors.indexOf(t.layerColor);(0,l.writeUint16)(e,-1===n?0:n),(0,l.writeZeros)(e,6)}),f("shmd",function(e){return void 0!==e.timestamp||void 0!==e.animationFrames||void 0!==e.animationFrameFlags||void 0!==e.timeline||void 0!==e.comps},function(e,t,n){for(var r=(0,s.readUint32)(e),o=function(n){(0,s.checkSignature)(e,"8BIM");var r=(0,s.readSignature)(e);(0,s.readUint8)(e),(0,s.skipBytes)(e,3),(0,s.readSection)(e,1,function(n){if("cust"===r)void 0!==(o=(0,c.readVersionAndDescriptor)(e)).layerTime&&(t.timestamp=o.layerTime);else if("mlst"===r){var o=(0,c.readVersionAndDescriptor)(e);t.animationFrames=[];for(var i=0;i<o.LaSt.length;i++){var a=o.LaSt[i],l={frames:a.FrLs};void 0!==a.enab&&(l.enable=a.enab),a.Ofst&&(l.offset=(0,c.horzVrtcToXY)(a.Ofst)),a.FXRf&&(l.referencePoint=(0,c.horzVrtcToXY)(a.FXRf)),a.Lefx&&(l.effects=(0,c.parseEffects)(a.Lefx,!!e.logMissingFeatures)),a.blendOptions&&a.blendOptions.Opct&&(l.opacity=(0,c.parsePercent)(a.blendOptions.Opct)),t.animationFrames.push(l)}}else if("mdyn"===r){(0,s.readUint16)(e);var d=(0,s.readUint8)(e),u=(0,s.readUint8)(e);t.animationFrameFlags={propagateFrameOne:!d,unifyLayerPosition:0!==(1&u),unifyLayerStyle:0!==(2&u),unifyLayerVisibility:0!==(4&u)}}else if("tmln"===r){var p=(o=(0,c.readVersionAndDescriptor)(e)).timeScope,h={start:(0,c.frac)(p.Strt),duration:(0,c.frac)(p.duration),inTime:(0,c.frac)(p.inTime),outTime:(0,c.frac)(p.outTime),autoScope:o.autoScope,audioLevel:o.audioLevel};o.trackList&&(h.tracks=(0,c.parseTrackList)(o.trackList,!!e.logMissingFeatures)),t.timeline=h}else if("cmls"===r){o=(0,c.readVersionAndDescriptor)(e);t.comps={settings:[]},o.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:o.origFXRefPoint.Hrzn,y:o.origFXRefPoint.Vrtc});for(var f=0,g=o.layerSettings;f<g.length;f++){var m=g[f];t.comps.settings.push({compList:m.compList});var v=t.comps.settings[t.comps.settings.length-1];"enab"in m&&(v.enabled=m.enab),m.Ofst&&(v.offset={x:m.Ofst.Hrzn,y:m.Ofst.Vrtc}),m.FXRefPoint&&(v.effectsReferencePoint={x:m.FXRefPoint.Hrzn,y:m.FXRefPoint.Vrtc})}}else if("extn"===r){o=(0,c.readVersionAndDescriptor)(e);e.logMissingFeatures&&e.log('Unhandled "shmd" section key',r)}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',r);(0,s.skipBytes)(e,n())})},i=0;i<r;i++)o();(0,s.skipBytes)(e,n())},function(e,t,n,r){var o=t.animationFrames,i=t.animationFrameFlags,a=t.timestamp,s=t.timeline,d=t.comps,u=0;o&&u++,i&&u++,s&&u++,void 0!==a&&u++,d&&u++,(0,l.writeUint32)(e,u),o&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,"mlst"),(0,l.writeUint8)(e,0),(0,l.writeZeros)(e,3),(0,l.writeSection)(e,2,function(){for(var n,r={LaID:null!==(n=t.id)&&void 0!==n?n:0,LaSt:[]},i=0;i<o.length;i++){var a=o[i],s={};void 0!==a.enable&&(s.enab=a.enable),s.FrLs=a.frames,a.offset&&(s.Ofst=(0,c.xyToHorzVrtc)(a.offset)),a.referencePoint&&(s.FXRf=(0,c.xyToHorzVrtc)(a.referencePoint)),a.effects&&(s.Lefx=(0,c.serializeEffects)(a.effects,!1,!1)),void 0!==a.opacity&&(s.blendOptions={Opct:(0,c.unitsPercent)(a.opacity)}),r.LaSt.push(s)}(0,c.writeVersionAndDescriptor)(e,"","null",r)},!0)),i&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,"mdyn"),(0,l.writeUint8)(e,0),(0,l.writeZeros)(e,3),(0,l.writeSection)(e,2,function(){(0,l.writeUint16)(e,0),(0,l.writeUint8)(e,i.propagateFrameOne?0:15),(0,l.writeUint8)(e,(i.unifyLayerPosition?1:0)|(i.unifyLayerStyle?2:0)|(i.unifyLayerVisibility?4:0))})),s&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,"tmln"),(0,l.writeUint8)(e,0),(0,l.writeZeros)(e,3),(0,l.writeSection)(e,2,function(){var n={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(n.trackList=(0,c.serializeTrackList)(s.tracks));var o=r.layerToId.get(t)||t.id;if(!o)throw new Error("You need to provide layer.id value whan writing document with animations");n.LyrI=o,(0,c.writeVersionAndDescriptor)(e,"","null",n,"anim")},!0)),void 0!==a&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,"cust"),(0,l.writeUint8)(e,0),(0,l.writeZeros)(e,3),(0,l.writeSection)(e,2,function(){var t={layerTime:a};(0,c.writeVersionAndDescriptor)(e,"","metadata",t)},!0)),d&&((0,l.writeSignature)(e,"8BIM"),(0,l.writeSignature)(e,"cmls"),(0,l.writeUint8)(e,0),(0,l.writeZeros)(e,3),(0,l.writeSection)(e,2,function(){var n=r.layerToId.get(t)||t.id;if(!n)throw new Error("You need to provide layer.id value whan writing document with layer comps");var o={};d.originalEffectsReferencePoint&&(o.origFXRefPoint={Hrzn:d.originalEffectsReferencePoint.x,Vrtc:d.originalEffectsReferencePoint.y}),o.LyrI=n,o.layerSettings=[];for(var i=0,a=d.settings;i<a.length;i++){var s=a[i],l={};void 0!==s.enabled&&(l.enab=s.enabled),s.offset&&(l.Ofst={Hrzn:s.offset.x,Vrtc:s.offset.y}),s.effectsReferencePoint&&(l.FXRefPoint={Hrzn:s.effectsReferencePoint.x,Vrtc:s.effectsReferencePoint.y}),l.compList=s.compList,o.layerSettings.push(l)}(0,c.writeVersionAndDescriptor)(e,"","null",o)},!0))}),f("PxSc",function(){return!1},function(e,t){var n=(0,c.readVersionAndDescriptor)(e,!0);1986285651===n.pixelSourceType?t.pixelSource={type:"vdPS",origin:{x:n.origin.Hrzn,y:n.origin.Vrtc},interpretation:{interpretAlpha:n.interpretation.interpretAlpha.split(".")[1],profile:n.interpretation.profile},frameReader:{type:"QTFR",link:{name:n.frameReader["Lnk "]["Nm  "],fullPath:n.frameReader["Lnk "].fullPath,originalPath:n.frameReader["Lnk "].originalPath,relativePath:n.frameReader["Lnk "].relPath,alias:n.frameReader["Lnk "].alis},mediaDescriptor:n.frameReader.mediaDescriptor},showAlteredVideo:n.showAlteredVideo}:e.log("Unknown pixelSourceType")},function(e,t){var n=t.pixelSource,r={_name:"",_classID:"PixelSource",pixelSourceType:1986285651,descVersion:1,origin:{Hrzn:n.origin.x,Vrtc:n.origin.y},interpretation:{_name:"",_classID:"footageInterpretation",Vrsn:1,interpretAlpha:"alphaInterpretation.".concat(n.interpretation.interpretAlpha),profile:n.interpretation.profile},frameReader:{_name:"",_classID:"FrameReader",frameReaderType:1364477522,descVersion:1,"Lnk ":{_name:"",_classID:"ExternalFileLink",descVersion:2,"Nm  ":n.frameReader.link.name,fullPath:n.frameReader.link.fullPath,originalPath:n.frameReader.link.originalPath,alis:n.frameReader.link.alias,relPath:n.frameReader.link.relativePath},mediaDescriptor:n.frameReader.mediaDescriptor},showAlteredVideo:n.showAlteredVideo};(0,c.writeVersionAndDescriptor)(e,"","PixelSource",r)}),f("vstk",m("vectorStroke"),function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.vectorStroke={strokeEnabled:r.strokeEnabled,fillEnabled:r.fillEnabled,lineWidth:(0,c.parseUnits)(r.strokeStyleLineWidth),lineDashOffset:(0,c.parseUnits)(r.strokeStyleLineDashOffset),miterLimit:r.strokeStyleMiterLimit,lineCapType:c.strokeStyleLineCapType.decode(r.strokeStyleLineCapType),lineJoinType:c.strokeStyleLineJoinType.decode(r.strokeStyleLineJoinType),lineAlignment:c.strokeStyleLineAlignment.decode(r.strokeStyleLineAlignment),scaleLock:r.strokeStyleScaleLock,strokeAdjust:r.strokeStyleStrokeAdjust,lineDashSet:r.strokeStyleLineDashSet.map(c.parseUnits),blendMode:c.BlnM.decode(r.strokeStyleBlendMode),opacity:(0,c.parsePercent)(r.strokeStyleOpacity),content:(0,c.parseVectorContent)(r.strokeStyleContent),resolution:r.strokeStyleResolution},(0,s.skipBytes)(e,n())},function(e,t){var n,r,o,i=t.vectorStroke,a={strokeStyleVersion:2,strokeEnabled:!!i.strokeEnabled,fillEnabled:!!i.fillEnabled,strokeStyleLineWidth:i.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:i.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(n=i.miterLimit)&&void 0!==n?n:100,strokeStyleLineCapType:c.strokeStyleLineCapType.encode(i.lineCapType),strokeStyleLineJoinType:c.strokeStyleLineJoinType.encode(i.lineJoinType),strokeStyleLineAlignment:c.strokeStyleLineAlignment.encode(i.lineAlignment),strokeStyleScaleLock:!!i.scaleLock,strokeStyleStrokeAdjust:!!i.strokeAdjust,strokeStyleLineDashSet:i.lineDashSet||[],strokeStyleBlendMode:c.BlnM.encode(i.blendMode),strokeStyleOpacity:(0,c.unitsPercent)(null!==(r=i.opacity)&&void 0!==r?r:1),strokeStyleContent:(0,c.serializeVectorContent)(i.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(o=i.resolution)&&void 0!==o?o:72};(0,c.writeVersionAndDescriptor)(e,"","strokeStyle",a)}),f("artb",m("artboard"),function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e),o=r.artboardRect;t.artboard={rect:{top:o["Top "],left:o.Left,bottom:o.Btom,right:o.Rght},guideIndices:r.guideIndeces,presetName:r.artboardPresetName,color:(0,c.parseColor)(r["Clr "]),backgroundType:r.artboardBackgroundType},(0,s.skipBytes)(e,n())},function(e,t){var n,r=t.artboard,o=r.rect,i={artboardRect:{"Top ":o.top,Left:o.left,Btom:o.bottom,Rght:o.right},guideIndeces:r.guideIndices||[],artboardPresetName:r.presetName||"","Clr ":(0,c.serializeColor)(r.color),artboardBackgroundType:null!==(n=r.backgroundType)&&void 0!==n?n:1};(0,c.writeVersionAndDescriptor)(e,"","artboard",i)}),f("sn2P",m("usingAlignedRendering"),function(e,t){return t.usingAlignedRendering=!!(0,s.readUint32)(e)},function(e,t){return(0,l.writeUint32)(e,t.usingAlignedRendering?1:0)});var S=["unknown","vector","raster","image stack"];function k(e){var t,n,o,i,a,s,l=r(r({style:c.warpStyle.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:c.Ornt.decode(e.warpRotate),bounds:e.bounds&&{top:(0,c.parseUnitsOrNumber)(e.bounds["Top "]),left:(0,c.parseUnitsOrNumber)(e.bounds.Left),bottom:(0,c.parseUnitsOrNumber)(e.bounds.Btom),right:(0,c.parseUnitsOrNumber)(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});null==e.deformNumRows&&null==e.deformNumCols||(l.deformNumRows=e.deformNumRows,l.deformNumCols=e.deformNumCols);var d=e.customEnvelopeWarp;if(d){l.customEnvelopeWarp={meshPoints:[]};for(var u=(null===(t=d.meshPoints.find(function(e){return"Hrzn"===e.type}))||void 0===t?void 0:t.values)||[],p=(null===(n=d.meshPoints.find(function(e){return"Vrtc"===e.type}))||void 0===n?void 0:n.values)||[],h=0;h<u.length;h++)l.customEnvelopeWarp.meshPoints.push({x:u[h],y:p[h]});(d.quiltSliceX||d.quiltSliceY)&&(l.customEnvelopeWarp.quiltSliceX=(null===(i=null===(o=d.quiltSliceX)||void 0===o?void 0:o[0])||void 0===i?void 0:i.values)||[],l.customEnvelopeWarp.quiltSliceY=(null===(s=null===(a=d.quiltSliceY)||void 0===a?void 0:a[0])||void 0===s?void 0:s.values)||[])}return l}function C(e){var t,n;return null!=e.deformNumCols||null!=e.deformNumRows||(null===(t=e.customEnvelopeWarp)||void 0===t?void 0:t.quiltSliceX)||(null===(n=e.customEnvelopeWarp)||void 0===n?void 0:n.quiltSliceY)}function j(e){var t=e.bounds,n=r(r({warpStyle:c.warpStyle.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:c.Ornt.encode(e.rotate),bounds:{"Top ":(0,c.unitsValue)(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:(0,c.unitsValue)(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:(0,c.unitsValue)(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:(0,c.unitsValue)(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),o=C(e);o&&((a=n).deformNumRows=e.deformNumRows||0,a.deformNumCols=e.deformNumCols||0);var i=e.customEnvelopeWarp;if(i){var a,s=i.meshPoints||[];if(o)(a=n).customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:i.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:i.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:s.map(function(e){return e.x})},{type:"Vrtc",values:s.map(function(e){return e.y})}]};else n.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:s.map(function(e){return e.x})},{type:"Vrtc",values:s.map(function(e){return e.y})}]}}return n}function _(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function E(e){for(var t=[],n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t}function D(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t}function M(e){return E(function(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}(e))}function T(e){return{x:(0,c.parseUnits)(e.Hrzn),y:(0,c.parseUnits)(e.Vrtc)}}function I(e){return{_name:"",_classID:"Pnt ",Hrzn:(0,c.unitsValue)(e.x,"x"),Vrtc:(0,c.unitsValue)(e.y,"y")}}function A(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map(function(e){return function(e,t){var n={name:e["Nm  "],opacity:(0,c.parsePercent)(e.blendOptions.Opct),blendMode:c.BlnM.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:(0,c.parseColor)(e.FrgC),backgroundColor:(0,c.parseColor)(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return r(r({},n),{type:"box blur",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"GsnB":return r(r({},n),{type:"gaussian blur",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"MtnB":return r(r({},n),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:(0,c.parseUnits)(e.Fltr.Dstn)}});case"RdlB":return r(r({},n),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:c.BlrM.decode(e.Fltr.BlrM),quality:c.BlrQ.decode(e.Fltr.BlrQ)}});case"shapeBlur":return r(r({},n),{type:"shape blur",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return r(r({},n),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:c.SmBQ.decode(e.Fltr.SmBQ),mode:c.SmBM.decode(e.Fltr.SmBM)}});case"surfaceBlur":return r(r({},n),{type:"surface blur",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return r(r({},n),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:c.DspM.decode(e.Fltr.DspM),undefinedAreas:c.UndA.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return r(r({},n),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return r(r({},n),{type:"polar coordinates",filter:{conversion:c.Cnvr.decode(e.Fltr.Cnvr)}});case"Rple":return r(r({},n),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:c.RplS.decode(e.Fltr.RplS)}});case"Shr ":return r(r({},n),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map(function(e){return{x:e.Hrzn,y:e.Vrtc}}),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:c.UndA.decode(e.Fltr.UndA)}});case"Sphr":return r(r({},n),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:c.SphM.decode(e.Fltr.SphM)}});case"Twrl":return r(r({},n),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return r(r({},n),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:c.Wvtp.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:c.UndA.decode(e.Fltr.UndA)}});case"ZgZg":return r(r({},n),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:c.ZZTy.decode(e.Fltr.ZZTy)}});case"AdNs":return r(r({},n),{type:"add noise",filter:{amount:(0,c.parsePercent)(e.Fltr.Nose),distribution:c.Dstr.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return r(r({},n),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return r(r({},n),{type:"median",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"denoise":return r(r({},n),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:(0,c.parsePercent)(e.Fltr.ClNs),sharpenDetails:(0,c.parsePercent)(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map(function(e){return r({channels:e.Chnl.map(c.Chnl.decode),amount:e.Amnt},e.EdgF?{preserveDetails:e.EdgF}:{})})}});case"ClrH":return r(r({},n),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return r(r({},n),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return r(r({},n),{type:"mezzotint",filter:{type:c.MztT.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return r(r({},n),{type:"mosaic",filter:{cellSize:(0,c.parseUnits)(e.Fltr.ClSz)}});case"Pntl":return r(r({},n),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return r(r({},n),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return r(r({},n),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return r(r({},n),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return r(r({},n),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:c.Lns.decode(e.Fltr["Lns "])}});case"smartSharpen":return r(r({},n),{type:"smart sharpen",filter:{amount:(0,c.parsePercent)(e.Fltr.Amnt),radius:(0,c.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:c.blurType.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:(0,c.parsePercent)(e.Fltr.sdwM.Amnt),tonalWidth:(0,c.parsePercent)(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:(0,c.parsePercent)(e.Fltr.hglM.Amnt),tonalWidth:(0,c.parsePercent)(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return r(r({},n),{type:"unsharp mask",filter:{amount:(0,c.parsePercent)(e.Fltr.Amnt),radius:(0,c.parseUnits)(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return r(r({},n),{type:"diffuse",filter:{mode:c.DfsM.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return r(r({},n),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return r(r({},n),{type:"extrude",filter:{type:c.ExtT.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:c.ExtR.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return r(r({},n),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:c.FlCl.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return r(r({},n),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:c.CntE.decode(e.Fltr["Edg "])}});case"Wnd ":return r(r({},n),{type:"wind",filter:{method:c.WndM.decode(e.Fltr.WndM),direction:c.Drct.decode(e.Fltr.Drct)}});case"Dntr":return r(r({},n),{type:"de-interlace",filter:{eliminate:c.IntE.decode(e.Fltr.IntE),newFieldsBy:c.IntC.decode(e.Fltr.IntC)}});case"Cstm":return r(r({},n),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return r(r({},n),{type:"high pass",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"Mxm ":return r(r({},n),{type:"maximum",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"Mnm ":return r(r({},n),{type:"minimum",filter:{radius:(0,c.parseUnits)(e.Fltr["Rds "])}});case"Ofst":return r(r({},n),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:c.FlMd.decode(e.Fltr["Fl  "])}});case"rigidTransform":return r(r({},n),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map(function(e){return{rigidType:e.rigidType,originalVertexArray:M(e.originalVertexArray),deformedVertexArray:M(e.deformedVertexArray),indexArray:Array.from((t=e.indexArray,new Uint32Array(t.buffer.slice(t.byteOffset),0,t.byteLength/4))),pinOffsets:E(e.pinOffsets),posFinalPins:E(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,selectedPin:e.selectedPin,pinPosition:E(e.PinP),pinRotation:e.PnRt,pinOverlay:e.PnOv,pinDepth:e.PnDp,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{pathComponents:e.meshBoundaryPath.pathComponents.map(function(e){return{shapeOperation:e.shapeOperation.split(".")[1],paths:e.SbpL.map(function(e){return{closed:e.Clsp,points:e["Pts "].map(function(e){return{anchor:T(e.Anch),forward:T(e["Fwd "]),backward:T(e["Bwd "]),smooth:e.Smoo}})}})}})}};var t})}});case"PbPl":for(var o=[],i=e.Fltr,a=0;a<26&&i["PN".concat(h[a],"a")];a++)for(var s=0;s<26&&i["PN".concat(h[a]).concat(h[s])];s++)o.push({name:i["PN".concat(h[a]).concat(h[s])],value:i["PF".concat(h[a]).concat(h[s])]});return r(r({},n),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:o}});case"HsbP":return r(r({},n),{type:"hsb/hsl",filter:{inputMode:c.ClrS.decode(e.Fltr.Inpt),rowOrder:c.ClrS.decode(e.Fltr.Otpt)}});case"oilPaint":return r(r({},n),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return r(r({},n),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});case"perspectiveWarpTransform":return r(r({},n),{type:"perspective warp",filter:{vertices:e.Fltr.vertices.map(T),warpedVertices:e.Fltr.warpedVertices.map(T),quads:e.Fltr.quads.map(function(e){return e.indices})}});case"Crvs":return r(r({},n),{type:"curves",filter:r({presetKind:c.presetKindType.decode(e.Fltr.presetKind)},e.Fltr.Adjs?{adjustments:e.Fltr.Adjs.map(function(e){var t=e.Chnl.map(c.Chnl.decode);if(e["Crv "])return{channels:t,curve:e["Crv "].map(function(e){var t={x:e.Hrzn,y:e.Vrtc};return e.Cnty&&(t.curved=!0),t})};if(e.Mpng)return{channels:t,values:e.Mpng};throw new Error("Unknown curve adjustment")})}:{})});case"BrgC":return r(r({},n),{type:"brightness/contrast",filter:{brightness:e.Fltr.Brgh,contrast:e.Fltr.Cntr,useLegacy:!!e.Fltr.useLegacy}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return r(r({},n),{type:"average"});case 1114403360:return r(r({},n),{type:"blur"});case 1114403405:return r(r({},n),{type:"blur more"});case 1148416099:return r(r({},n),{type:"despeckle"});case 1180922912:return r(r({},n),{type:"facet"});case 1181902701:return r(r({},n),{type:"fragment"});case 1399353968:return r(r({},n),{type:"sharpen"});case 1399353925:return r(r({},n),{type:"sharpen edges"});case 1399353933:return r(r({},n),{type:"sharpen more"});case 1181639749:return r(r({},n),{type:"find edges"});case 1399616122:return r(r({},n),{type:"solarize"});case 1314149187:return r(r({},n),{type:"ntsc colors"});case 1231976050:return r(r({},n),{type:"invert"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}(e,t)}).filter(function(e){return!!e})}}function O(e){return(0,c.unitsValue)(e.radius,"radius")}function R(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,n=e.height,r=t/3,o=2*t/3,i=n/3,a=2*n/3;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:n,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:0,y:0},{x:r,y:0},{x:o,y:0},{x:t,y:0},{x:0,y:i},{x:r,y:i},{x:o,y:i},{x:t,y:i},{x:0,y:a},{x:r,y:a},{x:o,y:a},{x:t,y:a},{x:0,y:n},{x:r,y:n},{x:o,y:n},{x:t,y:n}]}}}function z(e){return{top:(0,s.readInt32)(e),left:(0,s.readInt32)(e),bottom:(0,s.readInt32)(e),right:(0,s.readInt32)(e)}}function F(e,t){(0,l.writeInt32)(e,t.top),(0,l.writeInt32)(e,t.left),(0,l.writeInt32)(e,t.bottom),(0,l.writeInt32)(e,t.right)}function P(e){f(e,function(t){var n=t;return!(!n.linkedFiles||!n.linkedFiles.length)&&!("lnkE"===e&&!n.linkedFiles.some(function(e){return e.linkedFile}))},function(t,n,r,o){var i=n;for(i.linkedFiles=i.linkedFiles||[];r()>8;){var a=v(t),l=t.offset,d=(0,s.readSignature)(t),u=(0,s.readInt32)(t),p=(0,s.readPascalString)(t,1),h=(0,s.readUnicodeString)(t),f=(0,s.readSignature)(t).trim(),g=(0,s.readSignature)(t).trim(),m=v(t),y=(0,s.readUint8)(t)?(0,c.readVersionAndDescriptor)(t):void 0,x="liFE"===d?(0,c.readVersionAndDescriptor)(t):void 0,b={id:p,name:h};if(f&&(b.type=f),g&&(b.creator=g),y&&(b.descriptor={compInfo:{compID:y.compInfo.compID,originalCompID:y.compInfo.originalCompID}}),"liFE"===d&&u>3){var w=(0,s.readInt32)(t),S=(0,s.readUint8)(t),k=(0,s.readUint8)(t),C=(0,s.readUint8)(t),j=(0,s.readUint8)(t),_=(0,s.readFloat64)(t),E=Math.floor(_),D=1e3*(_-E);b.time=new Date(Date.UTC(w,S,k,C,j,E,D)).toISOString()}var M="liFE"===d?v(t):0;for("liFA"===d&&(0,s.skipBytes)(t,8),"liFD"===d&&(b.data=(0,s.readBytes)(t,m)),u>=5&&(b.childDocumentID=(0,s.readUnicodeString)(t)),u>=6&&(b.assetModTime=(0,s.readFloat64)(t)),u>=7&&(b.assetLockedState=(0,s.readUint8)(t)),"liFE"===d&&2===u&&(b.data=(0,s.readBytes)(t,M)),t.skipLinkedFilesData&&(b.data=void 0),"lnkE"===e&&(b.linkedFile={fileSize:M,name:(null===x||void 0===x?void 0:x["Nm  "])||"",fullPath:(null===x||void 0===x?void 0:x.fullPath)||"",originalPath:(null===x||void 0===x?void 0:x.originalPath)||"",relativePath:(null===x||void 0===x?void 0:x.relPath)||""}),i.linkedFiles.push(b);a%4;)a++;t.offset=l+a}(0,s.skipBytes)(t,r())},function(t,n){for(var r,o,i,a,s,d,u,p,h,f=0,g=n.linkedFiles;f<g.length;f++){var m=g[f];if("lnkE"===e===!!m.linkedFile){var v=2;null!=m.assetLockedState?v=7:null!=m.assetModTime?v=6:null!=m.childDocumentID?v=5:"lnkE"==e&&(v=3),y(t,0);var x=t.offset;if((0,l.writeSignature)(t,"lnkE"===e?"liFE":m.data?"liFD":"liFA"),(0,l.writeInt32)(t,v),!m.id||"string"!==typeof m.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(m.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if((0,l.writePascalString)(t,m.id,1),(0,l.writeUnicodeStringWithPadding)(t,m.name||""),(0,l.writeSignature)(t,m.type?"".concat(m.type,"    ").substring(0,4):"    "),(0,l.writeSignature)(t,m.creator?"".concat(m.creator,"    ").substring(0,4):"\0\0\0\0"),y(t,m.data?m.data.byteLength:0),m.descriptor&&m.descriptor.compInfo){var b={compInfo:{compID:m.descriptor.compInfo.compID,originalCompID:m.descriptor.compInfo.originalCompID}};(0,l.writeUint8)(t,1),(0,c.writeVersionAndDescriptor)(t,"","null",b)}else(0,l.writeUint8)(t,0);if("lnkE"===e){b={descVersion:2,"Nm  ":null!==(o=null===(r=m.linkedFile)||void 0===r?void 0:r.name)&&void 0!==o?o:"",fullPath:null!==(a=null===(i=m.linkedFile)||void 0===i?void 0:i.fullPath)&&void 0!==a?a:"",originalPath:null!==(d=null===(s=m.linkedFile)||void 0===s?void 0:s.originalPath)&&void 0!==d?d:"",relPath:null!==(p=null===(u=m.linkedFile)||void 0===u?void 0:u.relativePath)&&void 0!==p?p:""};(0,c.writeVersionAndDescriptor)(t,"","ExternalFileLink",b);var w=m.time?new Date(m.time):new Date;(0,l.writeInt32)(t,w.getUTCFullYear()),(0,l.writeUint8)(t,w.getUTCMonth()),(0,l.writeUint8)(t,w.getUTCDate()),(0,l.writeUint8)(t,w.getUTCHours()),(0,l.writeUint8)(t,w.getUTCMinutes()),(0,l.writeFloat64)(t,w.getUTCSeconds()+w.getUTCMilliseconds()/1e3)}m.data?(0,l.writeBytes)(t,m.data):y(t,(null===(h=m.linkedFile)||void 0===h?void 0:h.fileSize)||0),v>=5&&(0,l.writeUnicodeStringWithPadding)(t,m.childDocumentID||""),v>=6&&(0,l.writeFloat64)(t,m.assetModTime||0),v>=7&&(0,l.writeUint8)(t,m.assetLockedState||0);var S=t.offset-x;for(t.view.setUint32(x-4,S,!1);S%4;)S++,(0,l.writeUint8)(t,0)}}})}function B(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function L(e){return{shadowInput:(0,s.readInt16)(e),highlightInput:(0,s.readInt16)(e),shadowOutput:(0,s.readInt16)(e),highlightOutput:(0,s.readInt16)(e),midtoneInput:(0,s.readInt16)(e)/100}}function N(e,t){(0,l.writeInt16)(e,t.shadowInput),(0,l.writeInt16)(e,t.highlightInput),(0,l.writeInt16)(e,t.shadowOutput),(0,l.writeInt16)(e,t.highlightOutput),(0,l.writeInt16)(e,Math.round(100*t.midtoneInput))}function U(e){for(var t=(0,s.readUint16)(e),n=[],r=0;r<t;r++){var o=(0,s.readInt16)(e),i=(0,s.readInt16)(e);n.push({input:i,output:o})}return n}function V(e,t){(0,l.writeUint16)(e,t.length);for(var n=0,r=t;n<r.length;n++){var o=r[n];(0,l.writeUint16)(e,o.output),(0,l.writeUint16)(e,o.input)}}function W(e){return{a:(0,s.readInt16)(e),b:(0,s.readInt16)(e),c:(0,s.readInt16)(e),d:(0,s.readInt16)(e),hue:(0,s.readInt16)(e),saturation:(0,s.readInt16)(e),lightness:(0,s.readInt16)(e)}}function H(e,t){var n=t||{};(0,l.writeInt16)(e,n.a||0),(0,l.writeInt16)(e,n.b||0),(0,l.writeInt16)(e,n.c||0),(0,l.writeInt16)(e,n.d||0),(0,l.writeInt16)(e,n.hue||0),(0,l.writeInt16)(e,n.saturation||0),(0,l.writeInt16)(e,n.lightness||0)}function G(e){return{cyanRed:(0,s.readInt16)(e),magentaGreen:(0,s.readInt16)(e),yellowBlue:(0,s.readInt16)(e)}}function X(e,t){(0,l.writeInt16)(e,t.cyanRed||0),(0,l.writeInt16)(e,t.magentaGreen||0),(0,l.writeInt16)(e,t.yellowBlue||0)}function Y(e){var t=(0,s.readInt16)(e),n=(0,s.readInt16)(e),r=(0,s.readInt16)(e);return(0,s.skipBytes)(e,2),{red:t,green:n,blue:r,constant:(0,s.readInt16)(e)}}function q(e,t){var n=t||{};(0,l.writeInt16)(e,n.red),(0,l.writeInt16)(e,n.green),(0,l.writeInt16)(e,n.blue),(0,l.writeZeros)(e,2),(0,l.writeInt16)(e,n.constant)}f("PlLd",m("placedLayer"),function(e,t,n){if("plcL"!==(0,s.readSignature)(e))throw new Error("Invalid PlLd signature");if(3!==(0,s.readInt32)(e))throw new Error("Invalid PlLd version");var r=(0,s.readPascalString)(e,1),o=(0,s.readInt32)(e),i=(0,s.readInt32)(e);(0,s.readInt32)(e);var a=(0,s.readInt32)(e);if(!S[a])throw new Error("Invalid PlLd type");for(var l=[],d=0;d<8;d++)l.push((0,s.readFloat64)(e));var u=(0,s.readInt32)(e);if(0!==u)throw new Error("Invalid Warp version ".concat(u));var p=(0,c.readVersionAndDescriptor)(e);t.placedLayer=t.placedLayer||{id:r,type:S[a],pageNumber:o,totalPages:i,transform:l,warp:k(p)},(0,s.skipBytes)(e,n())},function(e,t){var n=t.placedLayer;if((0,l.writeSignature)(e,"plcL"),(0,l.writeInt32)(e,3),!n.id||"string"!==typeof n.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(n.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if((0,l.writePascalString)(e,n.id,1),(0,l.writeInt32)(e,1),(0,l.writeInt32)(e,1),(0,l.writeInt32)(e,16),-1===S.indexOf(n.type))throw new Error("Invalid placedLayer type");(0,l.writeInt32)(e,S.indexOf(n.type));for(var r=0;r<8;r++)(0,l.writeFloat64)(e,n.transform[r]);(0,l.writeInt32)(e,0);var o=R(n),i=C(o)?"quiltWarp":"warp";(0,c.writeVersionAndDescriptor)(e,"",i,j(o),i)}),f("SoLd",m("placedLayer"),function(e,t,n){if("soLD"!==(0,s.readSignature)(e))throw new Error("Invalid SoLd type");var r=(0,s.readInt32)(e);if(4!==r&&5!==r)throw new Error("Invalid SoLd version");var o=(0,c.readVersionAndDescriptor)(e,!0);t.placedLayer={id:o.Idnt,placed:o.placed,type:S[o.Type],pageNumber:o.PgNm,totalPages:o.totalPages,frameStep:(0,c.frac)(o.frameStep),duration:(0,c.frac)(o.duration),frameCount:o.frameCount,transform:o.Trnf,width:o["Sz  "].Wdth,height:o["Sz  "].Hght,resolution:(0,c.parseUnits)(o.Rslt),warp:k(o.quiltWarp||o.warp)},o.nonAffineTransform&&o.nonAffineTransform.some(function(e,t){return e!==o.Trnf[t]})&&(t.placedLayer.nonAffineTransform=o.nonAffineTransform),o.Crop&&(t.placedLayer.crop=o.Crop),o.comp&&(t.placedLayer.comp=o.comp),o.compInfo&&(t.placedLayer.compInfo={compID:o.compInfo.compID,originalCompID:o.compInfo.originalCompID}),o.filterFX&&(t.placedLayer.filter=A(o.filterFX,e)),(0,s.skipBytes)(e,n())},function(e,t){var n,o;(0,l.writeSignature)(e,"soLD"),(0,l.writeInt32)(e,4);var i=t.placedLayer;if(!i.id||"string"!==typeof i.id||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(i.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var a=r(r({Idnt:i.id,placed:null!==(n=i.placed)&&void 0!==n?n:i.id,PgNm:i.pageNumber||1,totalPages:i.totalPages||1},i.crop?{Crop:i.crop}:{}),{frameStep:i.frameStep||{numerator:0,denominator:600},duration:i.duration||{numerator:0,denominator:600},frameCount:i.frameCount||0,Annt:16,Type:S.indexOf(i.type),Trnf:i.transform,nonAffineTransform:null!==(o=i.nonAffineTransform)&&void 0!==o?o:i.transform,warp:j(R(i)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:i.width||0,Hght:i.height||0},Rslt:i.resolution?(0,c.unitsValue)(i.resolution,"resolution"):{units:"Density",value:72}});if(i.filter&&(a.filterFX={_name:"",_classID:"filterFXStyle",enab:i.filter.enabled,validAtPosition:i.filter.validAtPosition,filterMaskEnable:i.filter.maskEnabled,filterMaskLinked:i.filter.maskLinked,filterMaskExtendWithWhite:i.filter.maskExtendWithWhite,filterFXList:i.filter.list.map(function(e){return function(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:(0,c.unitsPercentF)(e.opacity),"Md  ":c.BlnM.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:(0,c.serializeColor)(e.foregroundColor),BckC:(0,c.serializeColor)(e.backgroundColor)};switch(e.type){case"average":return r(r({},t),{filterID:1098281575});case"blur":return r(r({},t),{filterID:1114403360});case"blur more":return r(r({},t),{filterID:1114403405});case"box blur":return r(r({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":O(e.filter)},filterID:697});case"gaussian blur":return r(r({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":O(e.filter)},filterID:1198747202});case"motion blur":return r(r({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:(0,c.unitsValue)(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return r(r({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:c.BlrM.encode(e.filter.method),BlrQ:c.BlrQ.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return r(r({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":O(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return r(r({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:c.SmBQ.encode(e.filter.quality),SmBM:c.SmBM.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return r(r({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":O(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return r(r({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:c.DspM.encode(e.filter.displacementMap),UndA:c.UndA.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return r(r({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return r(r({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:c.Cnvr.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return r(r({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:c.RplS.encode(e.filter.size)},filterID:1383099493});case"shear":return r(r({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map(function(e){return{_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y}}),UndA:c.UndA.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return r(r({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:c.SphM.encode(e.filter.mode)},filterID:1399875698});case"twirl":return r(r({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return r(r({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:c.Wvtp.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:c.UndA.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return r(r({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:c.ZZTy.encode(e.filter.style)},filterID:1516722791});case"add noise":return r(r({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:c.Dstr.encode(e.filter.distribution),Nose:(0,c.unitsPercentF)(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return r(r({},t),{filterID:1148416099});case"dust and scratches":return r(r({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return r(r({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":O(e.filter)},filterID:1298427424});case"reduce noise":return r(r({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:(0,c.unitsPercentF)(e.filter.reduceColorNoise),Shrp:(0,c.unitsPercentF)(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map(function(e){return r({_name:"",_classID:"channelDenoiseParams",Chnl:e.channels.map(function(e){return c.Chnl.encode(e)}),Amnt:e.amount},e.preserveDetails?{EdgF:e.preserveDetails}:{})}),preset:e.filter.preset},filterID:633});case"color halftone":return r(r({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return r(r({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return r(r({},t),{filterID:1180922912});case"fragment":return r(r({},t),{filterID:1181902701});case"mezzotint":return r(r({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:c.MztT.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return r(r({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:(0,c.unitsValue)(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return r(r({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return r(r({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return r(r({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return r(r({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return r(r({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":c.Lns.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return r(r({},t),{filterID:1399353968});case"sharpen edges":return r(r({},t),{filterID:1399353925});case"sharpen more":return r(r({},t),{filterID:1399353933});case"smart sharpen":return r(r({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:(0,c.unitsPercentF)(e.filter.amount),"Rds ":O(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:c.blurType.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:(0,c.unitsPercentF)(e.filter.shadow.fadeAmount),Wdth:(0,c.unitsPercentF)(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:(0,c.unitsPercentF)(e.filter.highlight.fadeAmount),Wdth:(0,c.unitsPercentF)(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return r(r({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:(0,c.unitsPercentF)(e.filter.amount),"Rds ":O(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return r(r({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":c.DfsM.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return r(r({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return r(r({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:c.ExtT.encode(e.filter.type),ExtR:c.ExtR.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return r(r({},t),{filterID:1181639749});case"solarize":return r(r({},t),{filterID:1399616122});case"tiles":return r(r({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:c.FlCl.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return r(r({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":c.CntE.encode(e.filter.edge)},filterID:1416782659});case"wind":return r(r({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:c.WndM.encode(e.filter.method),Drct:c.Drct.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return r(r({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:c.IntE.encode(e.filter.eliminate),IntC:c.IntC.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return r(r({},t),{filterID:1314149187});case"invert":return r(r({},t),{filterID:1231976050});case"custom":return r(r({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return r(r({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":O(e.filter)},filterID:1214736464});case"maximum":return r(r({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":O(e.filter)},filterID:1299737888});case"minimum":return r(r({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":O(e.filter)},filterID:1299082528});case"offset":return r(r({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":c.FlMd.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return r(r({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map(function(e){return{_name:"",_classID:"puppetShape",rigidType:e.rigidType,VrsM:1,VrsN:0,originalVertexArray:_(new Float32Array(D(e.originalVertexArray))),deformedVertexArray:_(new Float32Array(D(e.deformedVertexArray))),indexArray:_(new Uint32Array(e.indexArray)),pinOffsets:D(e.pinOffsets),posFinalPins:D(e.posFinalPins),pinVertexIndices:e.pinVertexIndices,PinP:D(e.pinPosition),PnRt:e.pinRotation,PnOv:e.pinOverlay,PnDp:e.pinDepth,meshQuality:e.meshQuality,meshExpansion:e.meshExpansion,meshRigidity:e.meshRigidity,imageResolution:e.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:e.meshBoundaryPath.pathComponents.map(function(e){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(e.shapeOperation),SbpL:e.paths.map(function(e){return{_name:"",_classID:"Sbpl",Clsp:e.closed,"Pts ":e.points.map(function(e){return{_name:"",_classID:"Pthp",Anch:I(e.anchor),"Fwd ":I(e.forward),"Bwd ":I(e.backward),Smoo:e.smooth}})}})}})},selectedPin:e.selectedPin}}),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":for(var n={},o=0;o<e.filter.parameters.length;o++){var i=e.filter.parameters[o],a=i.name,s=i.value,l="".concat(h[Math.floor(o/26)]).concat(h[o%26]);n["PN".concat(l)]=a,n["PT".concat(l)]=0,n["PF".concat(l)]=s}return r(r({},t),{Fltr:r({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},n),filterID:1348620396});case"oil paint":return r(r({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return r(r({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});case"perspective warp":return r(r({},t),{Fltr:{_name:"Perspective Warp",_classID:"perspectiveWarpTransform",vertices:e.filter.vertices.map(I),warpedVertices:e.filter.warpedVertices.map(I),quads:e.filter.quads.map(function(e){return{indices:e}})},filterID:442});case"curves":return r(r({},t),{Fltr:r({_name:"Curves",_classID:"Crvs",presetKind:c.presetKindType.encode(e.filter.presetKind)},e.filter.adjustments?{Adjs:e.filter.adjustments.map(function(e){return"curve"in e?{_name:"",_classID:"CrvA",Chnl:e.channels.map(c.Chnl.encode),"Crv ":e.curve.map(function(e){return r({_name:"",_classID:"Pnt ",Hrzn:e.x,Vrtc:e.y},e.curved?{Cnty:!0}:{})})}:{_name:"",_classID:"CrvA",Chnl:e.channels.map(c.Chnl.encode),Mpng:e.values}})}:{}),filterID:1131574899});case"brightness/contrast":return r(r({},t),{Fltr:{_name:"Brightness/Contrast",_classID:"BrgC",Brgh:e.filter.brightness,Cntr:e.filter.contrast,useLegacy:!!e.filter.useLegacy},filterID:1114793795});default:throw new Error("Unknow filter type: ".concat(e.type))}}(e)})}),i.warp&&C(i.warp)){var s=j(i.warp);a.quiltWarp=s,a.warp={warpStyle:"warpStyle.warpNone",warpValue:s.warpValue,warpPerspective:s.warpPerspective,warpPerspectiveOther:s.warpPerspectiveOther,warpRotate:s.warpRotate,bounds:s.bounds,uOrder:s.uOrder,vOrder:s.vOrder}}else delete a.quiltWarp;i.comp&&(a.comp=i.comp),i.compInfo&&(a.compInfo=i.compInfo),(0,c.writeVersionAndDescriptor)(e,"","null",a,a.quiltWarp?"quiltWarp":"warp")}),g("SoLE","SoLd"),f("fxrp",m("referencePoint"),function(e,t){t.referencePoint={x:(0,s.readFloat64)(e),y:(0,s.readFloat64)(e)}},function(e,t){(0,l.writeFloat64)(e,t.referencePoint.x),(0,l.writeFloat64)(e,t.referencePoint.y)}),f("Lr16",function(){return!1},function(e,t,n,r,o){(0,s.readLayerInfo)(e,r,o)},function(e,t){}),f("Lr32",function(){return!1},function(e,t,n,r,o){(0,s.readLayerInfo)(e,r,o)},function(e,t){}),f("LMsk",m("userMask"),function(e,t){if(t.userMask={colorSpace:(0,s.readColor)(e),opacity:(0,s.readUint16)(e)/255},128!==(0,s.readUint8)(e))throw new Error("Invalid flag value");(0,s.skipBytes)(e,1)},function(e,t){var n=t.userMask;(0,l.writeColor)(e,n.colorSpace),(0,l.writeUint16)(e,255*(0,a.clamp)(n.opacity,0,1)),(0,l.writeUint8)(e,128),(0,l.writeZeros)(e,1)}),a.MOCK_HANDLERS?f("Patt",function(e){return void 0!==e._Patt},function(e,t,n){t._Patt=(0,s.readBytes)(e,n())},function(e,t){return!1}):f("Patt",function(e){return!e},function(e,t,n){n()&&(0,s.skipBytes)(e,n())},function(e,t){}),a.MOCK_HANDLERS&&f("CAI ",function(e){return void 0!==e._CAI_},function(e,t,n){t._CAI_=(0,s.readBytes)(e,n())},function(e,t){(0,l.writeBytes)(e,t._CAI_)}),a.MOCK_HANDLERS&&f("OCIO",function(e){return void 0!==e._OCIO},function(e,t,n){t._OCIO=(0,s.readBytes)(e,n())},function(e,t){(0,l.writeBytes)(e,t._OCIO)}),a.MOCK_HANDLERS&&f("GenI",function(e){return void 0!==e._GenI},function(e,t,r){var o=(0,c.readVersionAndDescriptor)(e,!0);console.log("GenI",n(6494).inspect(o,!1,99,!0)),t._GenI=(0,s.readBytes)(e,r())},function(e,t){(0,l.writeBytes)(e,t._GenI)}),f("Anno",function(e){return void 0!==e.annotations},function(e,t,n){var r=(0,s.readUint16)(e),o=(0,s.readUint16)(e);if(2!==r||1!==o)throw new Error("Invalid Anno version");for(var i=(0,s.readUint32)(e),a=[],l=0;l<i;l++){(0,s.readUint32)(e);var c=(0,s.readSignature)(e),d=!!(0,s.readUint8)(e);(0,s.readUint8)(e),(0,s.readUint16)(e);var u=z(e),p=z(e),h=(0,s.readColor)(e),f=(0,s.readPascalString)(e,2),g=(0,s.readPascalString)(e,2),m=(0,s.readPascalString)(e,2);(0,s.readUint32)(e),(0,s.readSignature)(e);var v=(0,s.readUint32)(e),y=void 0;if("txtA"===c)v>=2&&65279===(0,s.readUint16)(e)?y=(0,s.readUnicodeStringWithLength)(e,(v-2)/2):(e.offset-=2,y=(0,s.readAsciiString)(e,v)),y=y.replace(/\r/g,"\n");else{if("sndA"!==c)throw new Error("Unknown annotation type");y=(0,s.readBytes)(e,v)}a.push({type:"txtA"===c?"text":"sound",open:d,iconLocation:u,popupLocation:p,color:h,author:f,name:g,date:m,data:y})}t.annotations=a,(0,s.skipBytes)(e,n())},function(e,t){var n=t.annotations;(0,l.writeUint16)(e,2),(0,l.writeUint16)(e,1),(0,l.writeUint32)(e,n.length);for(var r=0,o=n;r<o.length;r++){var i=o[r],a="sound"===i.type;if(a&&!(i.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!a&&"string"!==typeof i.data)throw new Error("Text annotation data should be string");var s=e.offset;(0,l.writeUint32)(e,0),(0,l.writeSignature)(e,a?"sndA":"txtA"),(0,l.writeUint8)(e,i.open?1:0),(0,l.writeUint8)(e,28),(0,l.writeUint16)(e,1),F(e,i.iconLocation),F(e,i.popupLocation),(0,l.writeColor)(e,i.color),(0,l.writePascalString)(e,i.author||"",2),(0,l.writePascalString)(e,i.name||"",2),(0,l.writePascalString)(e,i.date||"",2);var c=e.offset;(0,l.writeUint32)(e,0),(0,l.writeSignature)(e,a?"sndM":"txtC"),(0,l.writeUint32)(e,0);var d=e.offset;if(a)(0,l.writeBytes)(e,i.data);else{(0,l.writeUint16)(e,65279);for(var u=i.data.replace(/\n/g,"\r"),p=0;p<u.length;p++)(0,l.writeUint16)(e,u.charCodeAt(p))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(c,e.offset-c,!1),e.view.setUint32(d-4,e.offset-d,!1)}}),P("lnk2"),P("lnkE"),g("lnkD","lnk2"),g("lnk3","lnk2"),f("pths",m("pathList"),function(e,t){(0,c.readVersionAndDescriptor)(e,!0);t.pathList=[]},function(e,t){(0,c.writeVersionAndDescriptor)(e,"","pathsDataClass",{pathList:[]})}),f("lyvr",m("version"),function(e,t){return t.version=(0,s.readUint32)(e)},function(e,t){return(0,l.writeUint32)(e,t.version)}),f("lfxs",function(){return!1},function(e,t,n){if(0!==(0,s.readUint32)(e))throw new Error("Invalid lfxs version");var r=(0,c.readVersionAndDescriptor)(e);t.effects=(0,c.parseEffects)(r,!!e.logMissingFeatures),(0,s.skipBytes)(e,n())},function(e,t,n,r){var o=(0,c.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,l.writeUint32)(e,0),(0,c.writeVersionAndDescriptor)(e,"","null",o)}),f("brit",B("brightness/contrast"),function(e,t,n){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:(0,s.readInt16)(e),contrast:(0,s.readInt16)(e),meanValue:(0,s.readInt16)(e),labColorOnly:!!(0,s.readUint8)(e),useLegacy:!0}),(0,s.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,l.writeInt16)(e,r.brightness||0),(0,l.writeInt16)(e,r.contrast||0),(0,l.writeInt16)(e,null!==(n=r.meanValue)&&void 0!==n?n:127),(0,l.writeUint8)(e,r.labColorOnly?1:0),(0,l.writeZeros)(e,1)}),f("levl",B("levels"),function(e,t,n){if(2!==(0,s.readUint16)(e))throw new Error("Invalid levl version");t.adjustment=r(r({},t.adjustment),{type:"levels",rgb:L(e),red:L(e),green:L(e),blue:L(e)}),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};(0,l.writeUint16)(e,2),N(e,n.rgb||r),N(e,n.red||r),N(e,n.blue||r),N(e,n.green||r);for(var o=0;o<59;o++)N(e,r)}),f("curv",B("curves"),function(e,t,n){if((0,s.readUint8)(e),1!==(0,s.readUint16)(e))throw new Error("Invalid curv version");(0,s.readUint16)(e);var o=(0,s.readUint16)(e),i={type:"curves"};1&o&&(i.rgb=U(e)),2&o&&(i.red=U(e)),4&o&&(i.green=U(e)),8&o&&(i.blue=U(e)),t.adjustment=r(r({},t.adjustment),i),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r=n.rgb,o=n.red,i=n.green,a=n.blue,s=0,c=0;r&&r.length&&(s|=1,c++),o&&o.length&&(s|=2,c++),i&&i.length&&(s|=4,c++),a&&a.length&&(s|=8,c++),(0,l.writeUint8)(e,0),(0,l.writeUint16)(e,1),(0,l.writeUint16)(e,0),(0,l.writeUint16)(e,s),r&&r.length&&V(e,r),o&&o.length&&V(e,o),i&&i.length&&V(e,i),a&&a.length&&V(e,a),(0,l.writeSignature)(e,"Crv "),(0,l.writeUint16)(e,4),(0,l.writeUint16)(e,0),(0,l.writeUint16)(e,c),r&&r.length&&((0,l.writeUint16)(e,0),V(e,r)),o&&o.length&&((0,l.writeUint16)(e,1),V(e,o)),i&&i.length&&((0,l.writeUint16)(e,2),V(e,i)),a&&a.length&&((0,l.writeUint16)(e,3),V(e,a))}),f("expA",B("exposure"),function(e,t,n){if(1!==(0,s.readUint16)(e))throw new Error("Invalid expA version");t.adjustment=r(r({},t.adjustment),{type:"exposure",exposure:(0,s.readFloat32)(e),offset:(0,s.readFloat32)(e),gamma:(0,s.readFloat32)(e)}),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,l.writeUint16)(e,1),(0,l.writeFloat32)(e,n.exposure),(0,l.writeFloat32)(e,n.offset),(0,l.writeFloat32)(e,n.gamma),(0,l.writeZeros)(e,2)}),f("vibA",B("vibrance"),function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.adjustment={type:"vibrance"},void 0!==r.vibrance&&(t.adjustment.vibrance=r.vibrance),void 0!==r.Strt&&(t.adjustment.saturation=r.Strt),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={};void 0!==n.vibrance&&(r.vibrance=n.vibrance),void 0!==n.saturation&&(r.Strt=n.saturation),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),f("hue2",B("hue/saturation"),function(e,t,n){if(2!==(0,s.readUint16)(e))throw new Error("Invalid hue2 version");t.adjustment=r(r({},t.adjustment),{type:"hue/saturation",master:W(e),reds:W(e),yellows:W(e),greens:W(e),cyans:W(e),blues:W(e),magentas:W(e)}),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,l.writeUint16)(e,2),H(e,n.master),H(e,n.reds),H(e,n.yellows),H(e,n.greens),H(e,n.cyans),H(e,n.blues),H(e,n.magentas)}),f("blnc",B("color balance"),function(e,t,n){t.adjustment={type:"color balance",shadows:G(e),midtones:G(e),highlights:G(e),preserveLuminosity:!!(0,s.readUint8)(e)},(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment;X(e,n.shadows||{}),X(e,n.midtones||{}),X(e,n.highlights||{}),(0,l.writeUint8)(e,n.preserveLuminosity?1:0),(0,l.writeZeros)(e,1)}),f("blwh",B("black & white"),function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.adjustment={type:"black & white",reds:r["Rd  "],yellows:r.Yllw,greens:r["Grn "],cyans:r["Cyn "],blues:r["Bl  "],magentas:r.Mgnt,useTint:!!r.useTint,presetKind:r.bwPresetKind,presetFileName:r.blackAndWhitePresetFileName},void 0!==r.tintColor&&(t.adjustment.tintColor=(0,c.parseColor)(r.tintColor)),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={"Rd  ":n.reds||0,Yllw:n.yellows||0,"Grn ":n.greens||0,"Cyn ":n.cyans||0,"Bl  ":n.blues||0,Mgnt:n.magentas||0,useTint:!!n.useTint,tintColor:(0,c.serializeColor)(n.tintColor),bwPresetKind:n.presetKind||0,blackAndWhitePresetFileName:n.presetFileName||""};(0,c.writeVersionAndDescriptor)(e,"","null",r)}),f("phfl",B("photo filter"),function(e,t,n){var r,o=(0,s.readUint16)(e);if(2!==o&&3!==o)throw new Error("Invalid phfl version");r=2===o?(0,s.readColor)(e):{l:(0,s.readInt32)(e)/100,a:(0,s.readInt32)(e)/100,b:(0,s.readInt32)(e)/100},t.adjustment={type:"photo filter",color:r,density:(0,s.readUint32)(e)/100,preserveLuminosity:!!(0,s.readUint8)(e)},(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,l.writeUint16)(e,2),(0,l.writeColor)(e,n.color||{l:0,a:0,b:0}),(0,l.writeUint32)(e,100*(n.density||0)),(0,l.writeUint8)(e,n.preserveLuminosity?1:0),(0,l.writeZeros)(e,3)}),f("mixr",B("channel mixer"),function(e,t,n){if(1!==(0,s.readUint16)(e))throw new Error("Invalid mixr version");var o=t.adjustment=r(r({},t.adjustment),{type:"channel mixer",monochrome:!!(0,s.readUint16)(e)});o.monochrome||(o.red=Y(e),o.green=Y(e),o.blue=Y(e)),o.gray=Y(e),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment;(0,l.writeUint16)(e,1),(0,l.writeUint16)(e,n.monochrome?1:0),n.monochrome?(q(e,n.gray),(0,l.writeZeros)(e,30)):(q(e,n.red),q(e,n.green),q(e,n.blue),q(e,n.gray))});var Z=(0,a.createEnum)("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),$=(0,a.createEnum)("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),K=(0,a.createEnum)("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});f("clrL",B("color lookup"),function(e,t,n){if(1!==(0,s.readUint16)(e))throw new Error("Invalid clrL version");var r=(0,c.readVersionAndDescriptor)(e);t.adjustment={type:"color lookup"};var o=t.adjustment;void 0!==r.lookupType&&(o.lookupType=Z.decode(r.lookupType)),void 0!==r["Nm  "]&&(o.name=r["Nm  "]),void 0!==r.Dthr&&(o.dither=r.Dthr),void 0!==r.profile&&(o.profile=r.profile),void 0!==r.LUTFormat&&(o.lutFormat=$.decode(r.LUTFormat)),void 0!==r.dataOrder&&(o.dataOrder=K.decode(r.dataOrder)),void 0!==r.tableOrder&&(o.tableOrder=K.decode(r.tableOrder)),void 0!==r.LUT3DFileData&&(o.lut3DFileData=r.LUT3DFileData),void 0!==r.LUT3DFileName&&(o.lut3DFileName=r.LUT3DFileName),(0,s.skipBytes)(e,n())},function(e,t){var n=t.adjustment,r={};void 0!==n.lookupType&&(r.lookupType=Z.encode(n.lookupType)),void 0!==n.name&&(r["Nm  "]=n.name),void 0!==n.dither&&(r.Dthr=n.dither),void 0!==n.profile&&(r.profile=n.profile),void 0!==n.lutFormat&&(r.LUTFormat=$.encode(n.lutFormat)),void 0!==n.dataOrder&&(r.dataOrder=K.encode(n.dataOrder)),void 0!==n.tableOrder&&(r.tableOrder=K.encode(n.tableOrder)),void 0!==n.lut3DFileData&&(r.LUT3DFileData=n.lut3DFileData),void 0!==n.lut3DFileName&&(r.LUT3DFileName=n.lut3DFileName),(0,l.writeUint16)(e,1),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),f("nvrt",B("invert"),function(e,t,n){t.adjustment={type:"invert"},(0,s.skipBytes)(e,n())},function(){}),f("post",B("posterize"),function(e,t,n){t.adjustment={type:"posterize",levels:(0,s.readUint16)(e)},(0,s.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,l.writeUint16)(e,null!==(n=r.levels)&&void 0!==n?n:4),(0,l.writeZeros)(e,2)}),f("thrs",B("threshold"),function(e,t,n){t.adjustment={type:"threshold",level:(0,s.readUint16)(e)},(0,s.skipBytes)(e,n())},function(e,t){var n,r=t.adjustment;(0,l.writeUint16)(e,null!==(n=r.level)&&void 0!==n?n:128),(0,l.writeZeros)(e,2)});var J=["","","","rgb","hsb","","lab"];function Q(e){return{c:(0,s.readInt16)(e),m:(0,s.readInt16)(e),y:(0,s.readInt16)(e),k:(0,s.readInt16)(e)}}function ee(e,t){var n=t||{};(0,l.writeInt16)(e,n.c),(0,l.writeInt16)(e,n.m),(0,l.writeInt16)(e,n.y),(0,l.writeInt16)(e,n.k)}function te(e){return Object.keys(e).map(function(t){return e[t]}).some(function(e){return Array.isArray(e)&&e.length>1})}f("grdm",B("gradient map"),function(e,t,n){var r=(0,s.readUint16)(e);if(1!==r&&3!==r)throw new Error("Invalid grdm version");var o={type:"gradient map",gradientType:"solid"};o.reverse=!!(0,s.readUint8)(e),o.dither=!!(0,s.readUint8)(e);var i=!!(0,s.readUint8)(e);if(e.offset--,i){var a=(0,s.readSignature)(e);o.method=c.gradientInterpolationMethodType.decode(a)}o.name=(0,s.readUnicodeString)(e),o.colorStops=[],o.opacityStops=[];for(var l=(0,s.readUint16)(e),d=0;d<l;d++)o.colorStops.push({location:(0,s.readUint32)(e),midpoint:(0,s.readUint32)(e)/100,color:(0,s.readColor)(e)}),(0,s.skipBytes)(e,2);var u=(0,s.readUint16)(e);for(d=0;d<u;d++)o.opacityStops.push({location:(0,s.readUint32)(e),midpoint:(0,s.readUint32)(e)/100,opacity:(0,s.readUint16)(e)/255});if(2!==(0,s.readUint16)(e))throw new Error("Invalid grdm expansion count");var p=(0,s.readUint16)(e);if(o.smoothness=p/4096,32!==(0,s.readUint16)(e))throw new Error("Invalid grdm length");o.gradientType=(0,s.readUint16)(e)?"noise":"solid",o.randomSeed=(0,s.readUint32)(e),o.addTransparency=!!(0,s.readUint16)(e),o.restrictColors=!!(0,s.readUint16)(e),o.roughness=(0,s.readUint32)(e)/4096,o.colorModel=J[(0,s.readUint16)(e)]||"rgb",o.min=[(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768],o.max=[(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768,(0,s.readUint16)(e)/32768],(0,s.skipBytes)(e,n());for(var h=0,f=o.colorStops;h<f.length;h++){f[h].location/=p}for(var g=0,m=o.opacityStops;g<m.length;g++){m[g].location/=p}t.adjustment=o},function(e,t){var n,r,o,i=t.adjustment;(0,l.writeUint16)(e,void 0!==i.method?3:1),(0,l.writeUint8)(e,i.reverse?1:0),(0,l.writeUint8)(e,i.dither?1:0),void 0!==i.method&&(0,l.writeSignature)(e,c.gradientInterpolationMethodType.encode(i.method)),(0,l.writeUnicodeStringWithPadding)(e,i.name||""),(0,l.writeUint16)(e,i.colorStops&&i.colorStops.length||0);for(var a=Math.round(4096*(null!==(n=i.smoothness)&&void 0!==n?n:1)),s=0,d=i.colorStops||[];s<d.length;s++){var u=d[s];(0,l.writeUint32)(e,Math.round(u.location*a)),(0,l.writeUint32)(e,Math.round(100*u.midpoint)),(0,l.writeColor)(e,u.color),(0,l.writeZeros)(e,2)}(0,l.writeUint16)(e,i.opacityStops&&i.opacityStops.length||0);for(var p=0,h=i.opacityStops||[];p<h.length;p++){u=h[p];(0,l.writeUint32)(e,Math.round(u.location*a)),(0,l.writeUint32)(e,Math.round(100*u.midpoint)),(0,l.writeUint16)(e,Math.round(255*u.opacity))}(0,l.writeUint16)(e,2),(0,l.writeUint16)(e,a),(0,l.writeUint16)(e,32),(0,l.writeUint16)(e,"noise"===i.gradientType?1:0),(0,l.writeUint32)(e,i.randomSeed||0),(0,l.writeUint16)(e,i.addTransparency?1:0),(0,l.writeUint16)(e,i.restrictColors?1:0),(0,l.writeUint32)(e,Math.round(4096*(null!==(r=i.roughness)&&void 0!==r?r:1)));var f=J.indexOf(null!==(o=i.colorModel)&&void 0!==o?o:"rgb");(0,l.writeUint16)(e,-1===f?3:f);for(var g=0;g<4;g++)(0,l.writeUint16)(e,Math.round(32768*(i.min&&i.min[g]||0)));for(g=0;g<4;g++)(0,l.writeUint16)(e,Math.round(32768*(i.max&&i.max[g]||0)));(0,l.writeZeros)(e,4)}),f("selc",B("selective color"),function(e,t){if(1!==(0,s.readUint16)(e))throw new Error("Invalid selc version");var n=(0,s.readUint16)(e)?"absolute":"relative";(0,s.skipBytes)(e,8),t.adjustment={type:"selective color",mode:n,reds:Q(e),yellows:Q(e),greens:Q(e),cyans:Q(e),blues:Q(e),magentas:Q(e),whites:Q(e),neutrals:Q(e),blacks:Q(e)}},function(e,t){var n=t.adjustment;(0,l.writeUint16)(e,1),(0,l.writeUint16)(e,"absolute"===n.mode?1:0),(0,l.writeZeros)(e,8),ee(e,n.reds),ee(e,n.yellows),ee(e,n.greens),ee(e,n.cyans),ee(e,n.blues),ee(e,n.magentas),ee(e,n.whites),ee(e,n.neutrals),ee(e,n.blacks)}),f("CgEd",function(e){var t=e.adjustment;return!!t&&("brightness/contrast"===t.type&&!t.useLegacy||("levels"===t.type||"curves"===t.type||"exposure"===t.type||"channel mixer"===t.type||"hue/saturation"===t.type)&&void 0!==t.presetFileName)},function(e,t,n){var o=(0,c.readVersionAndDescriptor)(e);if(1!==o.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in o?r(r({},t.adjustment),{presetKind:o.presetKind,presetFileName:o.presetFileName}):"curvesPresetFileName"in o?r(r({},t.adjustment),{presetKind:o.curvesPresetKind,presetFileName:o.curvesPresetFileName}):"mixerPresetFileName"in o?r(r({},t.adjustment),{presetKind:o.mixerPresetKind,presetFileName:o.mixerPresetFileName}):{type:"brightness/contrast",brightness:o.Brgh,contrast:o.Cntr,meanValue:o.means,useLegacy:!!o.useLegacy,labColorOnly:!!o["Lab "],auto:!!o.Auto},(0,s.skipBytes)(e,n())},function(e,t){var n,r,o,i,a=t.adjustment;if("levels"===a.type||"exposure"===a.type||"hue/saturation"===a.type){var s={Vrsn:1,presetKind:null!==(n=a.presetKind)&&void 0!==n?n:1,presetFileName:a.presetFileName||""};(0,c.writeVersionAndDescriptor)(e,"","null",s)}else if("curves"===a.type){s={Vrsn:1,curvesPresetKind:null!==(r=a.presetKind)&&void 0!==r?r:1,curvesPresetFileName:a.presetFileName||""};(0,c.writeVersionAndDescriptor)(e,"","null",s)}else if("channel mixer"===a.type){s={Vrsn:1,mixerPresetKind:null!==(o=a.presetKind)&&void 0!==o?o:1,mixerPresetFileName:a.presetFileName||""};(0,c.writeVersionAndDescriptor)(e,"","null",s)}else{if("brightness/contrast"!==a.type)throw new Error("Unhandled CgEd case");s={Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:null!==(i=a.meanValue)&&void 0!==i?i:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto};(0,c.writeVersionAndDescriptor)(e,"","null",s)}}),f("Txt2",m("engineData"),function(e,t,n,r){var i=(0,s.readBytes)(e,n());t.engineData=(0,o.fromByteArray)(i);var a=function(e){var t=[];return function e(n){var r;if(n.children)for(var o=0,i=n.children;o<i.length;o++){var a=i[o];void 0!==(null===(r=a.text)||void 0===r?void 0:r.index)&&(t[a.text.index]=a),e(a)}}(e),t}(r),l=(0,d.parseEngineData)(i),c=(0,p.decodeEngineData2)(l).ResourceDict.TextFrameSet;if(c)for(var u=0;u<c.length;u++){var h=a[u];c[u].path&&(null===h||void 0===h?void 0:h.text)&&(h.text.textPath=c[u].path)}},function(e,t){var n=(0,o.toByteArray)(t.engineData);(0,l.writeBytes)(e,n)}),f("FEid",m("filterEffectsMasks"),function(e,t,n){var r=(0,s.readInt32)(e);if(r<1||r>3)throw new Error("Invalid filterEffects version ".concat(r));for(t.filterEffectsMasks=[];n()>8;){if((0,s.readUint32)(e))throw new Error("filterEffects: 64 bit length is not supported");var o=(0,s.readUint32)(e),i=e.offset+o,a=(0,s.readPascalString)(e,1),l=(0,s.readInt32)(e);if(1!==l)throw new Error("Invalid filterEffect version ".concat(l));if((0,s.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");(0,s.readUint32)(e);for(var c=(0,s.readInt32)(e),d=(0,s.readInt32)(e),u=(0,s.readInt32)(e),p=(0,s.readInt32)(e),h=(0,s.readInt32)(e),f=(0,s.readInt32)(e),g=[],m=0;m<f+2;m++){if((0,s.readInt32)(e)){if((0,s.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");var v=(0,s.readUint32)(e);if(!v)throw new Error("filterEffect: Empty channel");var y=(0,s.readUint16)(e),x=(0,s.readBytes)(e,v-2);g.push({compressionMode:y,data:x})}else g.push(void 0)}if(t.filterEffectsMasks.push({id:a,top:c,left:d,bottom:u,right:p,depth:h,channels:g}),e.offset<i&&(0,s.readUint8)(e)){var b=(0,s.readInt32)(e),w=(0,s.readInt32)(e),S=(0,s.readInt32)(e),k=(0,s.readInt32)(e);if((0,s.readUint32)(e))throw new Error("filterEffect: 64 bit length is not supported");var C=(0,s.readUint32)(e);y=(0,s.readUint16)(e),x=(0,s.readBytes)(e,C-2);t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={top:b,left:w,bottom:S,right:k,compressionMode:y,data:x}}e.offset=i;for(var j=o;j%4;)e.offset++,j++}},function(e,t){var n;(0,l.writeInt32)(e,3);for(var r=0,o=t.filterEffectsMasks;r<o.length;r++){var i=o[r];(0,l.writeUint32)(e,0),(0,l.writeUint32)(e,0);var a=e.offset;(0,l.writePascalString)(e,i.id,1),(0,l.writeInt32)(e,1),(0,l.writeUint32)(e,0),(0,l.writeUint32)(e,0);var s=e.offset;(0,l.writeInt32)(e,i.top),(0,l.writeInt32)(e,i.left),(0,l.writeInt32)(e,i.bottom),(0,l.writeInt32)(e,i.right),(0,l.writeInt32)(e,i.depth);var c=Math.max(0,i.channels.length-2);(0,l.writeInt32)(e,c);for(var d=0;d<c+2;d++){var u=i.channels[d];(0,l.writeInt32)(e,u?1:0),u&&((0,l.writeUint32)(e,0),(0,l.writeUint32)(e,u.data.length+2),(0,l.writeUint16)(e,u.compressionMode),(0,l.writeBytes)(e,u.data))}e.view.setUint32(s-4,e.offset-s,!1);var p=null===(n=t.filterEffectsMasks[t.filterEffectsMasks.length-1])||void 0===n?void 0:n.extra;p&&((0,l.writeUint8)(e,1),(0,l.writeInt32)(e,p.top),(0,l.writeInt32)(e,p.left),(0,l.writeInt32)(e,p.bottom),(0,l.writeInt32)(e,p.right),(0,l.writeUint32)(e,0),(0,l.writeUint32)(e,p.data.byteLength+2),(0,l.writeUint16)(e,p.compressionMode),(0,l.writeBytes)(e,p.data));var h=e.offset-a;for(e.view.setUint32(a-4,h,!1);h%4;)(0,l.writeZeros)(e,1),h++}}),g("FXid","FEid"),f("FMsk",m("filterMask"),function(e,t){t.filterMask={colorSpace:(0,s.readColor)(e),opacity:(0,s.readUint16)(e)/255}},function(e,t){var n;(0,l.writeColor)(e,t.filterMask.colorSpace),(0,l.writeUint16)(e,255*(0,a.clamp)(null!==(n=t.filterMask.opacity)&&void 0!==n?n:1,0,1))}),f("artd",function(e){return void 0!==e.artboards},function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.artboards={count:r["Cnt "],autoExpandOffset:{horizontal:r.autoExpandOffset.Hrzn,vertical:r.autoExpandOffset.Vrtc},origin:{horizontal:r.origin.Hrzn,vertical:r.origin.Vrtc},autoExpandEnabled:r.autoExpandEnabled,autoNestEnabled:r.autoNestEnabled,autoPositionEnabled:r.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!r.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:(0,c.parseColor)(r.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:r.docDefaultNewArtboardBackgroundType},(0,s.skipBytes)(e,n())},function(e,t){var n,r,o,i,a,s=t.artboards,l={"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:null===(n=s.autoExpandEnabled)||void 0===n||n,autoNestEnabled:null===(r=s.autoNestEnabled)||void 0===r||r,autoPositionEnabled:null===(o=s.autoPositionEnabled)||void 0===o||o,shrinkwrapOnSaveEnabled:null===(i=s.shrinkwrapOnSaveEnabled)||void 0===i||i,docDefaultNewArtboardBackgroundColor:(0,c.serializeColor)(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:null!==(a=s.docDefaultNewArtboardBackgroundType)&&void 0!==a?a:1};(0,c.writeVersionAndDescriptor)(e,"","null",l,"artd")}),t.hasMultiEffects=te,f("lfx2",function(e){return void 0!==e.effects&&!te(e.effects)},function(e,t,n){if(0!==(0,s.readUint32)(e))throw new Error("Invalid lfx2 version");var r=(0,c.readVersionAndDescriptor)(e);t.effects=(0,c.parseEffects)(r,!!e.logMissingFeatures),(0,s.skipBytes)(e,n())},function(e,t,n,r){var o=(0,c.serializeEffects)(t.effects,!!r.logMissingFeatures,!0);(0,l.writeUint32)(e,0),(0,c.writeVersionAndDescriptor)(e,"","null",o)}),f("cinf",m("compositorUsed"),function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);function o(e){return e.split(".")[1]}t.compositorUsed={description:r.description,reason:r.reason,engine:o(r.Engn)},r.Vrsn&&(t.compositorUsed.version=r.Vrsn),r.psVersion&&(t.compositorUsed.photoshopVersion=r.psVersion),r.enableCompCore&&(t.compositorUsed.enableCompCore=o(r.enableCompCore)),r.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=o(r.enableCompCoreGPU)),r.enableCompCoreThreads&&(t.compositorUsed.enableCompCoreThreads=o(r.enableCompCoreThreads)),r.compCoreSupport&&(t.compositorUsed.compCoreSupport=o(r.compCoreSupport)),r.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=o(r.compCoreGPUSupport)),(0,s.skipBytes)(e,n())},function(e,t){var n=t.compositorUsed,r={Vrsn:n.version||{major:1,minor:0,fix:0}};n.photoshopVersion&&(r.psVersion=n.photoshopVersion),r.description=n.description,r.reason=n.reason,r.Engn="Engn.".concat(n.engine),n.enableCompCore&&(r.enableCompCore="enable.".concat(n.enableCompCore)),n.enableCompCoreGPU&&(r.enableCompCoreGPU="enable.".concat(n.enableCompCoreGPU)),n.enableCompCoreThreads&&(r.enableCompCoreThreads="enable.".concat(n.enableCompCoreThreads)),n.compCoreSupport&&(r.compCoreSupport="reason.".concat(n.compCoreSupport)),n.compCoreGPUSupport&&(r.compCoreGPUSupport="reason.".concat(n.compCoreGPUSupport)),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),f("extn",function(e){return void 0!==e._extn},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);a.MOCK_HANDLERS&&(t._extn=n)},function(e,t){a.MOCK_HANDLERS&&(0,c.writeVersionAndDescriptor)(e,"","null",t._extn)}),f("iOpa",m("fillOpacity"),function(e,t){t.fillOpacity=(0,s.readUint8)(e)/255,(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,255*t.fillOpacity),(0,l.writeZeros)(e,3)}),f("brst",m("channelBlendingRestrictions"),function(e,t,n){for(t.channelBlendingRestrictions=[];n()>4;)t.channelBlendingRestrictions.push((0,s.readInt32)(e))},function(e,t){for(var n=0,r=t.channelBlendingRestrictions;n<r.length;n++){var o=r[n];(0,l.writeInt32)(e,o)}}),f("tsly",m("transparencyShapesLayer"),function(e,t){t.transparencyShapesLayer=!!(0,s.readUint8)(e),(0,s.skipBytes)(e,3)},function(e,t){(0,l.writeUint8)(e,t.transparencyShapesLayer?1:0),(0,l.writeZeros)(e,3)})},801:(e,t,n)=>{var r=n(1141),o=n(6686),i=n(9841),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},819:(e,t,n)=>{var r=n(755);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},868:(e,t,n)=>{"use strict";const r=n(2390),o=n(2792),i=n(4903),a=n(3785),s=n(3847),l=Object.prototype.toString,{Z_NO_FLUSH:c,Z_SYNC_FLUSH:d,Z_FULL_FLUSH:u,Z_FINISH:p,Z_OK:h,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:g,Z_DEFAULT_STRATEGY:m,Z_DEFLATED:v}=n(2328);function y(e){this.options=o.assign({level:g,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;let n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=r.deflateSetDictionary(this.strm,e),n!==h)throw new Error(a[n]);this._dict_set=!0}}function x(e,t){const n=new y(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,o=this.options.chunkSize;let a,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?p:c,"string"===typeof e?n.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(o),n.next_out=0,n.avail_out=o),(s===d||s===u)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(a=r.deflate(n,s),a===f)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),a=r.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===h;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===h&&(this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=y,e.exports.deflate=x,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,x(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,x(e,t)},e.exports.constants=n(2328)},914:(e,t,n)=>{var r=n(9841);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},929:(e,t,n)=>{var r=n(3211),o=n(6571),i=n(9194),a=n(6686);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&i(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},969:e=>{"use strict";e.exports=Math.round},980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeEffects=t.readEffects=void 0;var r=n(6302),o=n(8147),i=n(5171),a=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function s(e){return(0,o.checkSignature)(e,"8BIM"),r.toBlendMode[(0,o.readSignature)(e)]||"normal"}function l(e,t){(0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,r.fromBlendMode[t]||"norm")}function c(e){return(0,o.readUint8)(e)/255}function d(e,t){(0,i.writeUint8)(e,0|Math.round(255*t))}function u(e,t){var n;(0,i.writeUint32)(e,51),(0,i.writeUint32)(e,2),(0,i.writeFixedPoint32)(e,t.size&&t.size.value||0),(0,i.writeFixedPoint32)(e,0),(0,i.writeFixedPoint32)(e,t.angle||0),(0,i.writeFixedPoint32)(e,t.distance&&t.distance.value||0),(0,i.writeColor)(e,t.color),l(e,t.blendMode),(0,i.writeUint8)(e,t.enabled?1:0),(0,i.writeUint8)(e,t.useGlobalLight?1:0),d(e,null!==(n=t.opacity)&&void 0!==n?n:1),(0,i.writeColor)(e,t.color)}t.readEffects=function(e){var t=(0,o.readUint16)(e);if(0!==t)throw new Error("Invalid effects layer version: ".concat(t));for(var n=(0,o.readUint16)(e),r={},i=0;i<n;i++){(0,o.checkSignature)(e,"8BIM");var l=(0,o.readSignature)(e);switch(l){case"cmnS":var d=(0,o.readUint32)(e),u=(0,o.readUint32)(e),p=!!(0,o.readUint8)(e);if((0,o.skipBytes)(e,2),7!==d||0!==u||!p)throw new Error("Invalid effects common state");break;case"dsdw":case"isdw":var h=(0,o.readUint32)(e),f=(0,o.readUint32)(e);if(41!==h&&51!==h)throw new Error("Invalid shadow size: ".concat(h));if(0!==f&&2!==f)throw new Error("Invalid shadow version: ".concat(f));d=(0,o.readFixedPoint32)(e);(0,o.readFixedPoint32)(e);var g=(0,o.readFixedPoint32)(e),m=(0,o.readFixedPoint32)(e),v=(0,o.readColor)(e),y=s(e),x=!!(0,o.readUint8)(e),b=!!(0,o.readUint8)(e),w=c(e);h>=51&&(0,o.readColor)(e);var S={size:{units:"Pixels",value:d},distance:{units:"Pixels",value:m},angle:g,color:v,blendMode:y,enabled:x,useGlobalLight:b,opacity:w};"dsdw"===l?r.dropShadow=[S]:r.innerShadow=[S];break;case"oglw":h=(0,o.readUint32)(e);var k=(0,o.readUint32)(e);if(32!==h&&42!==h)throw new Error("Invalid outer glow size: ".concat(h));if(0!==k&&2!==k)throw new Error("Invalid outer glow version: ".concat(k));d=(0,o.readFixedPoint32)(e);(0,o.readFixedPoint32)(e);v=(0,o.readColor)(e),y=s(e),x=!!(0,o.readUint8)(e),w=c(e);h>=42&&(0,o.readColor)(e),r.outerGlow={size:{units:"Pixels",value:d},color:v,blendMode:y,enabled:x,opacity:w};break;case"iglw":h=(0,o.readUint32)(e);var C=(0,o.readUint32)(e);if(32!==h&&43!==h)throw new Error("Invalid inner glow size: ".concat(h));if(0!==C&&2!==C)throw new Error("Invalid inner glow version: ".concat(C));d=(0,o.readFixedPoint32)(e);(0,o.readFixedPoint32)(e);v=(0,o.readColor)(e),y=s(e),x=!!(0,o.readUint8)(e),w=c(e);h>=43&&((0,o.readUint8)(e),(0,o.readColor)(e)),r.innerGlow={size:{units:"Pixels",value:d},color:v,blendMode:y,enabled:x,opacity:w};break;case"bevl":h=(0,o.readUint32)(e);var j=(0,o.readUint32)(e);if(58!==h&&78!==h)throw new Error("Invalid bevel size: ".concat(h));if(0!==j&&2!==j)throw new Error("Invalid bevel version: ".concat(j));g=(0,o.readFixedPoint32)(e);var _=(0,o.readFixedPoint32)(e),E=(d=(0,o.readFixedPoint32)(e),s(e)),D=s(e),M=(0,o.readColor)(e),T=(0,o.readColor)(e),I=a[(0,o.readUint8)(e)]||"inner bevel",A=c(e),O=c(e),R=(x=!!(0,o.readUint8)(e),b=!!(0,o.readUint8)(e),(0,o.readUint8)(e)?"down":"up");h>=78&&((0,o.readColor)(e),(0,o.readColor)(e)),r.bevel={size:{units:"Pixels",value:d},angle:g,strength:_,highlightBlendMode:E,shadowBlendMode:D,highlightColor:M,shadowColor:T,style:I,highlightOpacity:A,shadowOpacity:O,enabled:x,useGlobalLight:b,direction:R};break;case"sofi":d=(0,o.readUint32)(e);var z=(0,o.readUint32)(e);if(34!==d)throw new Error("Invalid effects solid fill info size: ".concat(d));if(2!==z)throw new Error("Invalid effects solid fill info version: ".concat(z));y=s(e),v=(0,o.readColor)(e),w=c(e),x=!!(0,o.readUint8)(e);(0,o.readColor)(e),r.solidFill=[{blendMode:y,color:v,opacity:w,enabled:x}];break;default:throw new Error("Invalid effect type: '".concat(l,"'"))}}return r},t.writeEffects=function(e,t){var n,r,o,s,c,p,h=null===(n=t.dropShadow)||void 0===n?void 0:n[0],f=null===(r=t.innerShadow)||void 0===r?void 0:r[0],g=t.outerGlow,m=t.innerGlow,v=t.bevel,y=null===(o=t.solidFill)||void 0===o?void 0:o[0],x=1;if(h&&x++,f&&x++,g&&x++,m&&x++,v&&x++,y&&x++,(0,i.writeUint16)(e,0),(0,i.writeUint16)(e,x),(0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"cmnS"),(0,i.writeUint32)(e,7),(0,i.writeUint32)(e,0),(0,i.writeUint8)(e,1),(0,i.writeZeros)(e,2),h&&((0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"dsdw"),u(e,h)),f&&((0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"isdw"),u(e,f)),g&&((0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"oglw"),(0,i.writeUint32)(e,42),(0,i.writeUint32)(e,2),(0,i.writeFixedPoint32)(e,(null===(s=g.size)||void 0===s?void 0:s.value)||0),(0,i.writeFixedPoint32)(e,0),(0,i.writeColor)(e,g.color),l(e,g.blendMode),(0,i.writeUint8)(e,g.enabled?1:0),d(e,g.opacity||0),(0,i.writeColor)(e,g.color)),m&&((0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"iglw"),(0,i.writeUint32)(e,43),(0,i.writeUint32)(e,2),(0,i.writeFixedPoint32)(e,(null===(c=m.size)||void 0===c?void 0:c.value)||0),(0,i.writeFixedPoint32)(e,0),(0,i.writeColor)(e,m.color),l(e,m.blendMode),(0,i.writeUint8)(e,m.enabled?1:0),d(e,m.opacity||0),(0,i.writeUint8)(e,0),(0,i.writeColor)(e,m.color)),v){(0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"bevl"),(0,i.writeUint32)(e,78),(0,i.writeUint32)(e,2),(0,i.writeFixedPoint32)(e,v.angle||0),(0,i.writeFixedPoint32)(e,v.strength||0),(0,i.writeFixedPoint32)(e,(null===(p=v.size)||void 0===p?void 0:p.value)||0),l(e,v.highlightBlendMode),l(e,v.shadowBlendMode),(0,i.writeColor)(e,v.highlightColor),(0,i.writeColor)(e,v.shadowColor);var b=a.indexOf(v.style);(0,i.writeUint8)(e,b<=0?1:b),d(e,v.highlightOpacity||0),d(e,v.shadowOpacity||0),(0,i.writeUint8)(e,v.enabled?1:0),(0,i.writeUint8)(e,v.useGlobalLight?1:0),(0,i.writeUint8)(e,"down"===v.direction?1:0),(0,i.writeColor)(e,v.highlightColor),(0,i.writeColor)(e,v.shadowColor)}y&&((0,i.writeSignature)(e,"8BIM"),(0,i.writeSignature)(e,"sofi"),(0,i.writeUint32)(e,34),(0,i.writeUint32)(e,2),l(e,y.blendMode),(0,i.writeColor)(e,y.color),d(e,y.opacity||0),(0,i.writeUint8)(e,y.enabled?1:0),(0,i.writeColor)(e,y.color))}},1069:(e,t,n)=>{var r=n(8541);e.exports=function(e){return null==e?"":r(e)}},1097:(e,t,n)=>{var r=n(5750),o=n(191);function i(e){return r.map(e.nodes(),function(t){var n=e.node(t),o=e.parent(t),i={v:t};return r.isUndefined(n)||(i.value=n),r.isUndefined(o)||(i.parent=o),i})}function a(e){return r.map(e.edges(),function(t){var n=e.edge(t),o={v:t.v,w:t.w};return r.isUndefined(t.name)||(o.name=t.name),r.isUndefined(n)||(o.value=n),o})}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:i(e),edges:a(e)};r.isUndefined(e.graph())||(t.value=r.clone(e.graph()));return t},read:function(e){var t=new o(e.options).setGraph(e.value);return r.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),r.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}}},1104:(e,t,n)=>{var r=n(6614),o=n(8673);e.exports=function(e,t){return e&&r(t,o(t),e)}},1141:(e,t,n)=>{var r=n(143),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},1143:(e,t,n)=>{var r=n(3028)(Object.keys,Object);e.exports=r},1153:(e,t,n)=>{"use strict";var r=n(5043),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1163:(e,t,n)=>{var r=n(5647),o=n(3211),i=n(929),a=n(474),s=Object.prototype,l=s.hasOwnProperty,c=r(function(e,t){e=Object(e);var n=-1,r=t.length,c=r>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(r=1);++n<r;)for(var d=t[n],u=a(d),p=-1,h=u.length;++p<h;){var f=u[p],g=e[f];(void 0===g||o(g,s[f])&&!l.call(e,f))&&(e[f]=d[f])}return e});e.exports=c},1170:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1251:e=>{"use strict";e.exports=Object},1268:(e,t,n)=>{var r=n(5428),o=n(7574),i=n(6832),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},1276:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.writePsdBuffer=t.writePsdUint8Array=t.writePsd=t.readPsd=t.byteArrayToBase64=t.initializeCanvas=void 0;var i=n(5171),a=n(8147),s=n(4445);o(n(7620),t),o(n(6529),t);var l=n(6302);function c(e,t){var n=(0,i.createWriter)();return(0,i.writePsd)(n,e,t),(0,i.getWriterBufferNoCopy)(n)}Object.defineProperty(t,"initializeCanvas",{enumerable:!0,get:function(){return l.initializeCanvas}}),o(n(9328),t),t.byteArrayToBase64=s.fromByteArray,t.readPsd=function(e,t){var n="buffer"in e?(0,a.createReader)(e.buffer,e.byteOffset,e.byteLength):(0,a.createReader)(e);return(0,a.readPsd)(n,t)},t.writePsd=function(e,t){var n=(0,i.createWriter)();return(0,i.writePsd)(n,e,t),(0,i.getWriterBuffer)(n)},t.writePsdUint8Array=c,t.writePsdBuffer=function(e,t){if("undefined"===typeof Buffer)throw new Error("Buffer not supported on this platform");return Buffer.from(c(e,t))}},1277:(e,t,n)=>{"use strict";var r=n(8208),o=n(5641),i=n(9558).positionX;e.exports=function(e){(function(e){var t=o.buildLayerMatrix(e),n=e.graph().ranksep,i=0;r.forEach(t,function(t){var o=r.max(r.map(t,function(t){return e.node(t).height}));r.forEach(t,function(t){e.node(t).y=i+o/2}),i+=o+n})})(e=o.asNonCompoundGraph(e)),r.forEach(i(e),function(t,n){e.node(n).x=t})}},1291:(e,t,n)=>{"use strict";var r=n(757),o=n(7651),i=n(7297);e.exports=r?function(e){return r(e)}:o?function(e){if(!e||"object"!==typeof e&&"function"!==typeof e)throw new TypeError("getProto: not an object");return o(e)}:i?function(e){return i(e)}:null},1295:(e,t,n)=>{var r=n(9812),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},1310:e=>{e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},1340:(e,t,n)=>{var r=n(3211);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1516:(e,t,n)=>{var r=n(2929);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},1557:e=>{"use strict";e.exports=Math.min},1558:e=>{e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},1583:(e,t,n)=>{"use strict";var r=n(8117),o=n(66)(/^\s*(?:function)?\*/),i=n(4635)(),a=n(1291),s=r("Object.prototype.toString"),l=r("Function.prototype.toString"),c=n(4112);e.exports=function(e){if("function"!==typeof e)return!1;if(o(l(e)))return!0;if(!i)return"[object GeneratorFunction]"===s(e);if(!a)return!1;var t=c();return t&&a(e)===t.prototype}},1609:(e,t,n)=>{var r=n(6614),o=n(474);e.exports=function(e){return r(e,o(e))}},1629:(e,t,n)=>{var r=n(6913),o=n(6686);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1632:(e,t,n)=>{var r=n(4724),o=n(6311),i=n(7168);e.exports=function(e){return o(e)?i(e):r(e)}},1712:(e,t,n)=>{"use strict";var r=n(5438),o=n(2090),i=n(4781),a=n(6142);e.exports=function(e){var t=i(arguments),n=e.length-(arguments.length-1);return r(t,1+(n>0?n:0),!0)},o?o(e.exports,"apply",{value:a}):e.exports.apply=a},1714:(e,t,n)=>{var r=n(1340);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},1725:e=>{"use strict";e.exports=RangeError},1733:(e,t,n)=>{var r=n(1775),o=n(4664),i=n(9096);e.exports=function(e,t){var n={};return t=i(t,3),o(e,function(e,o,i){r(n,o,t(e,o,i))}),n}},1740:(e,t,n)=>{var r=n(7132);e.exports=function(e){return r(e,4)}},1775:(e,t,n)=>{var r=n(5654);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1817:(e,t,n)=>{var r=n(6686),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},1896:(e,t,n)=>{var r=n(2125);e.exports=function(e,t){return r(e,t,"post")}},1903:(e,t,n)=>{"use strict";var r=n(8799),o=Object.prototype.toString,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");var a,s;arguments.length>=3&&(a=n),s=e,"[object Array]"===o.call(s)?function(e,t,n){for(var r=0,o=e.length;r<o;r++)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a):"string"===typeof e?function(e,t,n){for(var r=0,o=e.length;r<o;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,a):function(e,t,n){for(var r in e)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a)}},1911:e=>{"use strict";e.exports=Math.floor},1946:(e,t,n)=>{var r=n(1340);e.exports=function(e){return r(this.__data__,e)>-1}},1980:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},1981:(e,t,n)=>{"use strict";var r=n(8208);function o(e){r.forEach(e.nodes(),function(t){i(e.node(t))}),r.forEach(e.edges(),function(t){i(e.edge(t))})}function i(e){var t=e.width;e.width=e.height,e.height=t}function a(e){e.y=-e.y}function s(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||o(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){r.forEach(e.nodes(),function(t){a(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,a),r.has(n,"y")&&a(n)})}(e);"lr"!==t&&"rl"!==t||(!function(e){r.forEach(e.nodes(),function(t){s(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,s),r.has(n,"x")&&s(n)})}(e),o(e))}}},1987:(e,t,n)=>{var r=n(8208),o=n(7938).Graph;e.exports=function(e,t,n){var i=function(e){var t;for(;e.hasNode(t=r.uniqueId("_root")););return t}(e),a=new o({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(t){return e.node(t)});return r.forEach(e.nodes(),function(o){var s=e.node(o),l=e.parent(o);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(a.setNode(o),a.setParent(o,l||i),r.forEach(e[n](o),function(t){var n=t.v===o?t.w:t.v,i=a.edge(n,o),s=r.isUndefined(i)?0:i.weight;a.setEdge(n,o,{weight:e.edge(t).weight+s})}),r.has(s,"minRank")&&a.setNode(o,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),a}},2038:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.ESliceOrigin=t.ESliceVertAlign=t.ESliceHorzAlign=t.ESliceType=t.FrFl=t.FStl=t.ClrS=t.gradientInterpolationMethodType=t.stdTrackID=t.animInterpStyleEnum=t.GrdT=t.IGSr=t.BETE=t.BESs=t.bvlT=t.BESl=t.BlnM=t.warpStyle=t.Annt=t.Ornt=t.textGridding=t.frac=t.unitsValue=t.unitsPercentF=t.unitsPercent=t.unitsAngle=t.parseUnitsToNumber=t.parseUnitsOrNumber=t.parseUnits=t.parsePercentOrAngle=t.parsePercent=t.parseAngle=t.serializeColor=t.parseColor=t.serializeVectorContent=t.parseVectorContent=t.serializeTrackList=t.parseTrackList=t.parseEffects=t.serializeEffects=t.boundsToDescBounds=t.descBoundsToBounds=t.xyToHorzVrtc=t.horzVrtcToXY=t.writeVersionAndDescriptor=t.readVersionAndDescriptor=t.writeDescriptorStructure=t.readDescriptorStructure=t.readAsciiStringOrClassId=t.setLogErrors=void 0,t.presetKindType=t.prjM=t.FlMd=t.IntC=t.IntE=t.Drct=t.WndM=t.CntE=t.FlCl=t.ExtR=t.ExtT=t.DfsM=t.blurType=t.Lns=t.MztT=t.Chnl=t.Dstr=t.ZZTy=t.Wvtp=t.SphM=t.RplS=t.Cnvr=t.UndA=t.DspM=t.SmBQ=t.SmBM=t.BlrQ=t.BlrM=t.strokeStyleLineAlignment=t.strokeStyleLineJoinType=t.strokeStyleLineCapType=t.ESliceBGColorType=void 0;var i=n(6302),a=n(8147),s=n(5171);var l={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},c=function(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}(l),d=!1;function u(e,t){return{name:e,classID:t}}t.setLogErrors=function(e){d=e};for(var p=u("","null"),h={strokeStyleContent:u("","solidColorLayer"),printProofSetup:u("Proof Setup","proofSetup"),Grad:u("Gradient","Grdn"),Trnf:u("Transform","Trnf"),patternFill:u("","patternFill"),ebbl:u("","ebbl"),SoFi:u("","SoFi"),GrFl:u("","GrFl"),sdwC:u("","RGBC"),hglC:u("","RGBC"),"Clr ":u("","RGBC"),tintColor:u("","RGBC"),Ofst:u("","Pnt "),ChFX:u("","ChFX"),MpgS:u("","ShpC"),DrSh:u("","DrSh"),IrSh:u("","IrSh"),OrGl:u("","OrGl"),IrGl:u("","IrGl"),TrnS:u("","ShpC"),Ptrn:u("","Ptrn"),FrFX:u("","FrFX"),phase:u("","Pnt "),frameStep:p,duration:p,workInTime:p,workOutTime:p,audioClipGroupList:p,bounds:u("","Rctn"),customEnvelopeWarp:u("","customEnvelopeWarp"),warp:u("","warp"),"Sz  ":u("","Pnt "),origin:u("","Pnt "),autoExpandOffset:u("","Pnt "),keyOriginShapeBBox:u("","unitRect"),Vrsn:p,psVersion:p,docDefaultNewArtboardBackgroundColor:u("","RGBC"),artboardRect:u("","classFloatRect"),keyOriginRRectRadii:u("","radii"),keyOriginBoxCorners:p,rectangleCornerA:u("","Pnt "),rectangleCornerB:u("","Pnt "),rectangleCornerC:u("","Pnt "),rectangleCornerD:u("","Pnt "),compInfo:p,quiltWarp:u("","quiltWarp"),generatorSettings:p,crema:p,FrIn:p,blendOptions:p,FXRf:p,Lefx:p,time:p,animKey:p,timeScope:p,inTime:p,outTime:p,sheetStyle:p,translation:p,Skew:p,boundingBox:u("","boundingBox"),"Lnk ":u("","ExternalFileLink"),frameReader:u("","FrameReader"),effectParams:u("","motionTrackEffectParams"),Impr:u("None","none"),Anch:u("","Pnt "),"Fwd ":u("","Pnt "),"Bwd ":u("","Pnt "),FlrC:u("","Pnt "),meshBoundaryPath:u("","pathClass"),filterFX:u("","filterFXStyle"),Fltr:u("","rigidTransform"),FrgC:u("","RGBC"),BckC:u("","RGBC"),sdwM:u("Parameters","adaptCorrectTones"),hglM:u("Parameters","adaptCorrectTones"),customShape:u("","customShape"),origFXRefPoint:p,FXRefPoint:p,ClMg:u("","ClMg")},f={"Crv ":u("","CrPt"),Clrs:u("","Clrt"),Trns:u("","TrnS"),keyDescriptorList:p,solidFillMulti:u("","SoFi"),gradientFillMulti:u("","GrFl"),dropShadowMulti:u("","DrSh"),innerShadowMulti:u("","IrSh"),frameFXMulti:u("","FrFX"),FrIn:p,FSts:p,LaSt:p,sheetTimelineOptions:p,trackList:u("","animationTrack"),globalTrackList:u("","animationTrack"),keyList:p,audioClipGroupList:p,audioClipList:p,countObjectList:u("","countObject"),countGroupList:u("","countGroup"),slices:u("","slice"),"Pts ":u("","Pthp"),SbpL:u("","SbpL"),pathComponents:u("","PaCm"),filterFXList:u("","filterFX"),puppetShapeList:u("","puppetShape"),channelDenoise:u("","channelDenoiseParams"),ShrP:u("","Pnt "),layerSettings:p,list:p,Adjs:u("","CrvA")},g={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment","originalPath"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ","placedLayerOCIOConversion","gradientsInterpolationMethod"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy","Cnty"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList","Adjs"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},m=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],v={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long",Chnl:"enum"},y={},x=0,b=Object.keys(g);x<b.length;x++)for(var w=b[x],S=0,k=g[w];S<k.length;S++){var C=k[S];y[C]=w}for(var j=0,_=Object.keys(h);j<_.length;j++){C=_[j];y[C]||(y[C]="Objc")}for(var E=0,D=Object.keys(f);E<D.length;E++){C=D[E];v[C]="Objc"}function M(e,t,n,r){return"presetKind"===e?"string"===typeof t?"enum":"long":"null"===e&&"slices"===n?"TEXT":"groupID"===e?"slices"===n?"long":"TEXT":"Sz  "===e?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":"Type"===e?"string"===typeof t?"enum":"long":"AntA"===e?"string"===typeof t?"enum":"bool":"Hrzn"!==e&&"Vrtc"!==e||"keyType.Pstn"!==r.Type&&"Ofst"!==r._classID?"Hrzn"===e||"Vrtc"===e||"Top "===e||"Left"===e||"Btom"===e||"Rght"===e?"slices"===n?"long":"number"===typeof t?"doub":"UntF":"Vrsn"===e?"number"===typeof t?"long":"Objc":"Rd  "===e||"Grn "===e||"Bl  "===e?"artd"===n?"long":"doub":"Trnf"===e?Array.isArray(t)?"VlLs":"Objc":y[e]:"long"}function T(e){var t=(0,a.readInt32)(e);return(0,a.readAsciiString)(e,t||4)}function I(e,t){if(4===t.length&&"warp"!==t&&"time"!==t&&"hold"!==t&&"list"!==t)(0,s.writeInt32)(e,0),(0,s.writeSignature)(e,t);else{(0,s.writeInt32)(e,t.length);for(var n=0;n<t.length;n++)(0,s.writeUint8)(e,t.charCodeAt(n))}}function A(e,t){for(var n=P(e),r=t?{_name:n.name,_classID:n.classID}:{},o=(0,a.readUint32)(e),i=0;i<o;i++){var s=T(e),l=R(e,(0,a.readSignature)(e),t);r[s]=l}return r}function O(e,t,n,r,o){d&&!n&&console.log("Missing classId for: ",t,n,r),(0,s.writeUnicodeStringWithPadding)(e,t),I(e,n);var i=Object.keys(r),a=i.length;"_name"in r&&a--,"_classID"in r&&a--,(0,s.writeUint32)(e,a);for(var l=0,c=i;l<c.length;l++){var f=c[l];if("_name"!==f&&"_classID"!==f){var g=M(f,r[f],o,r),v=h[f];"bounds"===f&&"text"===o?v=u("","bounds"):"origin"===f?g="slices"===o?"enum":"Objc":"Cyn "!==f&&"Mgnt"!==f&&"Ylw "!==f&&"Blck"!==f||"CMYC"!==r._classID?/^PN[a-z][a-z]$/.test(f)?g="TEXT":/^PT[a-z][a-z]$/.test(f)?g="long":/^PF[a-z][a-z]$/.test(f)?g="doub":"Rds "!==f&&"Thsh"!==f||"number"!==typeof r[f]||"SmrB"!==r._classID?"ClSz"===f||"Rds "===f||"Amnt"===f?g="number"===typeof r[f]?"long":"UntF":"sdwM"!==f&&"hglM"!==f||"string"!==typeof r[f]?"blur"===f&&"string"===typeof r[f]?g="enum":"Hght"===f&&"number"===typeof r[f]&&"Embs"===r._classID?g="long":"Angl"!==f||"number"!==typeof r[f]||"Embs"!==r._classID&&"smartSharpen"!==r._classID&&"Twrl"!==r._classID&&"MtnB"!==r._classID?"Angl"===f&&"number"===typeof r[f]?g="doub":"bounds"===f&&"slices"===o?(g="Objc",v=u("","Rct1")):"Scl "===f?"object"===typeof r[f]&&"Hrzn"in r[f]?(g="Objc",v=p):g="number"===typeof r[f]?"long":"UntF":"audioClipGroupList"===f&&1===i.length?g="VlLs":"Strt"!==f&&"Brgh"!==f||!("H   "in r)?"Wdth"===f&&"object"===typeof r[f]?g="UntF":"Ofst"===f&&"number"===typeof r[f]?g="long":"Strt"===f&&"object"===typeof r[f]?(g="Objc",v=p):-1!==m.indexOf(f)?g="RGBC"===n&&"artd"!==o?"doub":"long":"profile"===f?g="printOutput"===n?"TEXT":"tdta":"strokeStyleContent"===f?r[f]["Clr "]?v=u("","solidColorLayer"):r[f].Grad?v=u("","gradientLayer"):r[f].Ptrn?v=u("","patternLayer"):d&&console.log("Invalid strokeStyleContent value",r[f]):"bounds"===f&&"quiltWarp"===o&&(v=u("","classFloatRect")):g="doub":g="long":g="enum":g="doub":g="doub",v&&"RGBC"===v.classID&&"H   "in r[f]&&(v={classID:"HSBC",name:""}),I(e,f),(0,s.writeSignature)(e,g||"long"),F(e,g||"long",r[f],f,v,o),d&&!g&&console.log("Missing descriptor field type for: '".concat(f,"' in"),r)}}}function R(e,t,n){switch(t){case"obj ":return function(e){for(var t=(0,a.readInt32)(e),n=[],r=0;r<t;r++){var o=(0,a.readSignature)(e);switch(o){case"prop":P(e);var i=T(e);n.push(i);break;case"Clss":n.push(P(e));break;case"Enmr":P(e);var s=T(e),l=T(e);n.push("".concat(s,".").concat(l));break;case"rele":P(e),n.push((0,a.readUint32)(e));break;case"Idnt":case"indx":n.push((0,a.readInt32)(e));break;case"name":P(e),n.push((0,a.readUnicodeString)(e));break;default:throw new Error("Invalid descriptor reference type: ".concat(o))}}return n}(e);case"Objc":case"GlbO":return A(e,n);case"VlLs":for(var r=(0,a.readInt32)(e),o=[],i=0;i<r;i++){var s=(0,a.readSignature)(e);o.push(R(e,s,n))}return o;case"doub":return(0,a.readFloat64)(e);case"UntF":var c=(0,a.readSignature)(e),d=(0,a.readFloat64)(e);if(!l[c])throw new Error("Invalid units: ".concat(c));return{units:l[c],value:d};case"UnFl":c=(0,a.readSignature)(e),d=(0,a.readFloat32)(e);if(!l[c])throw new Error("Invalid units: ".concat(c));return{units:l[c],value:d};case"TEXT":return(0,a.readUnicodeString)(e);case"enum":var u=T(e);d=T(e);return"".concat(u,".").concat(d);case"long":return(0,a.readInt32)(e);case"comp":return{low:(0,a.readUint32)(e),high:(0,a.readUint32)(e)};case"bool":return!!(0,a.readUint8)(e);case"type":case"GlbC":return P(e);case"alis":var p=(0,a.readInt32)(e);return(0,a.readAsciiString)(e,p);case"tdta":var h=(0,a.readInt32)(e);return(0,a.readBytes)(e,h);case"ObAr":(0,a.readInt32)(e),(0,a.readUnicodeString)(e),T(e);var f=(0,a.readInt32)(e);for(o=[],i=0;i<f;i++){var g=T(e);(0,a.readSignature)(e),(0,a.readSignature)(e);for(var m=(0,a.readInt32)(e),v=[],y=0;y<m;y++)v.push((0,a.readFloat64)(e));o.push({type:g,values:v})}return o;case"Pth ":(0,a.readInt32)(e);var x=(0,a.readSignature)(e);(0,a.readInt32LE)(e);var b=(0,a.readInt32LE)(e);return{sig:x,path:(0,a.readUnicodeStringWithLengthLE)(e,b)};default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}t.readAsciiStringOrClassId=T,t.readDescriptorStructure=A,t.writeDescriptorStructure=O;var z={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function F(e,t,n,r,o,i){switch(t){case"obj ":!function(e,t,n){(0,s.writeInt32)(e,n.length);for(var r=0;r<n.length;r++){var o=n[r],i="unknown";switch("string"===typeof o&&(i=/^[a-z ]+\.[a-z ]+$/i.test(o)?"Enmr":"name"),(0,s.writeSignature)(e,i),i){case"Enmr":var a=o.split("."),l=a[0],c=a[1];B(e,"\0",l),I(e,l),I(e,c);break;case"name":B(e,"\0","Lyr "),(0,s.writeUnicodeString)(e,o+"\0");break;default:throw new Error("Invalid descriptor reference type: ".concat(i))}}}(e,0,n);break;case"Objc":case"GlbO":if("object"!==typeof n)throw new Error("Invalid struct value: ".concat(JSON.stringify(n),", key: ").concat(r));if(!o)throw new Error("Missing ext type for: '".concat(r,"' (").concat(JSON.stringify(n),")"));O(e,n._name||o.name,n._classID||o.classID,n,i);break;case"VlLs":if(!Array.isArray(n))throw new Error("Invalid list value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,s.writeInt32)(e,n.length);for(var a=0;a<n.length;a++){var l=v[r];(0,s.writeSignature)(e,l||"long"),F(e,l||"long",n[a],"".concat(r,"[]"),f[r],i),d&&!l&&console.log("Missing descriptor array type for: '".concat(r,"' in"),n)}break;case"doub":if("number"!==typeof n)throw new Error("Invalid number value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,s.writeFloat64)(e,n);break;case"UntF":if(!c[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(r));(0,s.writeSignature)(e,c[n.units]),(0,s.writeFloat64)(e,n.value);break;case"UnFl":if(!c[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(r));(0,s.writeSignature)(e,c[n.units]),(0,s.writeFloat32)(e,n.value);break;case"TEXT":(0,s.writeUnicodeStringWithPadding)(e,n);break;case"enum":if("string"!==typeof n)throw new Error("Invalid enum value: ".concat(JSON.stringify(n),", key: ").concat(r));var u=n.split("."),p=u[0],h=u[1];I(e,p),I(e,h);break;case"long":if("number"!==typeof n)throw new Error("Invalid integer value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,s.writeInt32)(e,n);break;case"bool":if("boolean"!==typeof n)throw new Error("Invalid boolean value: ".concat(JSON.stringify(n),", key: ").concat(r));(0,s.writeUint8)(e,n?1:0);break;case"tdta":(0,s.writeInt32)(e,n.byteLength),(0,s.writeBytes)(e,n);break;case"ObAr":(0,s.writeInt32)(e,16),(0,s.writeUnicodeStringWithPadding)(e,"");var g=z[r];if(!g)throw new Error("Not implemented ObArType for: ".concat(r));I(e,g),(0,s.writeInt32)(e,n.length);for(a=0;a<n.length;a++){I(e,n[a].type),(0,s.writeSignature)(e,"UnFl"),(0,s.writeSignature)(e,"#Pxl"),(0,s.writeInt32)(e,n[a].values.length);for(var m=0;m<n[a].values.length;m++)(0,s.writeFloat64)(e,n[a].values[m])}break;case"Pth ":var y=12+2*n.path.length;(0,s.writeInt32)(e,y),(0,s.writeSignature)(e,n.sig),(0,s.writeInt32LE)(e,y),(0,s.writeInt32LE)(e,n.path.length),(0,s.writeUnicodeStringWithoutLengthLE)(e,n.path);break;default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function P(e){return{name:(0,a.readUnicodeString)(e),classID:T(e)}}function B(e,t,n){(0,s.writeUnicodeString)(e,t),I(e,n)}function L(e){return{x:e.Hrzn,y:e.Vrtc}}function N(e){return{Hrzn:e.x,Vrtc:e.y}}function U(e){var n={enabled:!!e.enab,position:t.FStl.decode(e.Styl),fillType:t.FrFl.decode(e.PntT),blendMode:t.BlnM.decode(e["Md  "]),opacity:oe(e.Opct),size:ae(e["Sz  "])};return void 0!==e.present&&(n.present=e.present),void 0!==e.showInDialog&&(n.showInDialog=e.showInDialog),void 0!==e.overprint&&(n.overprint=e.overprint),e["Clr "]&&(n.color=te(e["Clr "])),e.Grad&&(n.gradient=K(e)),e.Ptrn&&(n.pattern=J(e)),n}function V(e){var n={};return n.enab=!!e.enabled,void 0!==e.present&&(n.present=!!e.present),void 0!==e.showInDialog&&(n.showInDialog=!!e.showInDialog),n.Styl=t.FStl.encode(e.position),n.PntT=t.FrFl.encode(e.fillType),n["Md  "]=t.BlnM.encode(e.blendMode),n.Opct=le(e.opacity),n["Sz  "]=de(e.size,"size"),e.color&&(n["Clr "]=ne(e.color)),e.gradient&&(n=r(r({},n),Q(e.gradient))),e.pattern&&(n=r(r({},n),ee(e.pattern))),void 0!==e.overprint&&(n.overprint=!!e.overprint),n}function W(e,t,n){for(var r,o,i,a=n?{"Scl ":ce(null!==(r=e.scale)&&void 0!==r?r:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":ce(null!==(o=e.scale)&&void 0!==o?o:1)},s=0,l=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"];s<l.length;s++){if(e[h=l[s]]&&!Array.isArray(e[h]))throw new Error("".concat(h," should be an array"))}var c=function(e){return!!e&&e.length>1&&n},d=function(e){return!!e&&e.length>=1&&(!n||1===e.length)};if(d(e.dropShadow)&&(a.DrSh=q(e.dropShadow[0],"dropShadow",t)),c(e.dropShadow)&&(a.dropShadowMulti=e.dropShadow.map(function(e){return q(e,"dropShadow",t)})),d(e.innerShadow)&&(a.IrSh=q(e.innerShadow[0],"innerShadow",t)),c(e.innerShadow)&&(a.innerShadowMulti=e.innerShadow.map(function(e){return q(e,"innerShadow",t)})),e.outerGlow&&(a.OrGl=q(e.outerGlow,"outerGlow",t)),c(e.solidFill)&&(a.solidFillMulti=e.solidFill.map(function(e){return q(e,"solidFill",t)})),c(e.gradientOverlay)&&(a.gradientFillMulti=e.gradientOverlay.map(function(e){return q(e,"gradientOverlay",t)})),c(e.stroke)&&(a.frameFXMulti=e.stroke.map(function(e){return V(e)})),e.innerGlow&&(a.IrGl=q(e.innerGlow,"innerGlow",t)),e.bevel&&(a.ebbl=q(e.bevel,"bevel",t)),d(e.solidFill)&&(a.SoFi=q(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(a.patternFill=q(e.patternOverlay,"patternOverlay",t)),d(e.gradientOverlay)&&(a.GrFl=q(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(a.ChFX=q(e.satin,"satin",t)),d(e.stroke)&&(a.FrFX=V(null===(i=e.stroke)||void 0===i?void 0:i[0])),n){a.numModifyingFX=0;for(var u=0,p=Object.keys(e);u<p.length;u++){var h,f=e[h=p[u]];if(Array.isArray(f))for(var g=0,m=f;g<m.length;g++){m[g].enabled&&a.numModifyingFX++}else f.enabled&&a.numModifyingFX++}}return a}function H(e,t){var n={},r=e.masterFXSwitch,i=e.DrSh,a=e.dropShadowMulti,s=e.IrSh,l=e.innerShadowMulti,c=e.OrGl,d=e.IrGl,u=e.ebbl,p=e.SoFi,h=e.solidFillMulti,f=e.patternFill,g=e.GrFl,m=e.gradientFillMulti,v=e.ChFX,y=e.FrFX,x=e.frameFXMulti,b=(e.numModifyingFX,o(e,["masterFXSwitch","DrSh","dropShadowMulti","IrSh","innerShadowMulti","OrGl","IrGl","ebbl","SoFi","solidFillMulti","patternFill","GrFl","gradientFillMulti","ChFX","FrFX","frameFXMulti","numModifyingFX"]));return r||(n.disabled=!0),e["Scl "]&&(n.scale=oe(e["Scl "])),i&&(n.dropShadow=[Y(i,t)]),a&&(n.dropShadow=a.map(function(e){return Y(e,t)})),s&&(n.innerShadow=[Y(s,t)]),l&&(n.innerShadow=l.map(function(e){return Y(e,t)})),c&&(n.outerGlow=Y(c,t)),d&&(n.innerGlow=Y(d,t)),u&&(n.bevel=Y(u,t)),p&&(n.solidFill=[Y(p,t)]),h&&(n.solidFill=h.map(function(e){return Y(e,t)})),f&&(n.patternOverlay=Y(f,t)),g&&(n.gradientOverlay=[Y(g,t)]),m&&(n.gradientOverlay=m.map(function(e){return Y(e,t)})),v&&(n.satin=Y(v,t)),y&&(n.stroke=[U(y)]),x&&(n.stroke=x.map(function(e){return U(e)})),t&&Object.keys(b).length>1&&console.log("Unhandled effect keys:",b),n}function G(e,n){for(var r=[],o=0;o<e.length;o++){var i=e[o],a=i.time,s=a.denominator,l=a.numerator,c=i.selected,d=i.animKey,u={numerator:l,denominator:s},p=t.animInterpStyleEnum.decode(i.animInterpStyle);switch(d.Type){case"keyType.Opct":r.push({interpolation:p,time:u,selected:c,type:"opacity",value:oe(d.Opct)});break;case"keyType.Pstn":r.push({interpolation:p,time:u,selected:c,type:"position",x:d.Hrzn,y:d.Vrtc});break;case"keyType.Trnf":r.push({interpolation:p,time:u,selected:c,type:"transform",scale:L(d["Scl "]),skew:L(d.Skew),rotation:d.rotation,translation:L(d.translation)});break;case"keyType.sheetStyle":var h={interpolation:p,time:u,selected:c,type:"style"};d.sheetStyle.Lefx&&(h.style=H(d.sheetStyle.Lefx,n)),r.push(h);break;case"keyType.globalLighting":r.push({interpolation:p,time:u,selected:c,type:"globalLighting",globalAngle:d.gblA,globalAltitude:d.globalAltitude});break;default:throw new Error("Unsupported keyType value")}}return r}function X(e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=o.time,a=o.selected,s=void 0!==a&&a,l=o.interpolation,c=t.animInterpStyleEnum.encode(l),d=void 0;switch(o.type){case"opacity":d={Type:"keyType.Opct",Opct:le(o.value)};break;case"position":d={Type:"keyType.Pstn",Hrzn:o.x,Vrtc:o.y};break;case"transform":d={Type:"keyType.Trnf","Scl ":N(o.scale),Skew:N(o.skew),rotation:o.rotation,translation:N(o.translation)};break;case"style":d={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},o.style&&(d.sheetStyle={Vrsn:1,Lefx:W(o.style,!1,!1),blendOptions:{}});break;case"globalLighting":d={Type:"keyType.globalLighting",gblA:o.globalAngle,globalAltitude:o.globalAltitude};break;default:throw new Error("Unsupported keyType value")}n.push({Vrsn:1,animInterpStyle:c,time:i,animKey:d,selected:s})}return n}function Y(e,n){for(var r={},o=0,i=Object.keys(e);o<i.length;o++){var a=i[o],s=e[a];switch(a){case"enab":r.enabled=!!s;break;case"uglg":r.useGlobalLight=!!s;break;case"AntA":r.antialiased=!!s;break;case"Algn":r.align=!!s;break;case"Dthr":r.dither=!!s;break;case"Invr":r.invert=!!s;break;case"Rvrs":r.reverse=!!s;break;case"Clr ":r.color=te(s);break;case"hglC":r.highlightColor=te(s);break;case"sdwC":r.shadowColor=te(s);break;case"Styl":r.position=t.FStl.decode(s);break;case"Md  ":r.blendMode=t.BlnM.decode(s);break;case"hglM":r.highlightBlendMode=t.BlnM.decode(s);break;case"sdwM":r.shadowBlendMode=t.BlnM.decode(s);break;case"bvlS":r.style=t.BESl.decode(s);break;case"bvlD":r.direction=t.BESs.decode(s);break;case"bvlT":r.technique=t.bvlT.decode(s);break;case"GlwT":r.technique=t.BETE.decode(s);break;case"glwS":r.source=t.IGSr.decode(s);break;case"Type":r.type=t.GrdT.decode(s);break;case"gs99":r.interpolationMethod=t.gradientInterpolationMethodType.decode(s);break;case"Opct":r.opacity=oe(s);break;case"hglO":r.highlightOpacity=oe(s);break;case"sdwO":r.shadowOpacity=oe(s);break;case"lagl":case"Angl":r.angle=re(s);break;case"Lald":r.altitude=re(s);break;case"Sftn":r.soften=ae(s);break;case"srgR":r.strength=oe(s);break;case"blur":r.size=ae(s);break;case"Nose":r.noise=oe(s);break;case"Inpr":r.range=oe(s);break;case"Ckmt":r.choke=ae(s);break;case"ShdN":r.jitter=oe(s);break;case"Dstn":r.distance=ae(s);break;case"Scl ":r.scale=oe(s);break;case"Ptrn":r.pattern={name:s["Nm  "],id:s.Idnt};break;case"phase":r.phase={x:s.Hrzn,y:s.Vrtc};break;case"Ofst":r.offset={x:oe(s.Hrzn),y:oe(s.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:s["Nm  "],curve:s["Crv "].map(function(e){return{x:e.Hrzn,y:e.Vrtc}})};break;case"Grad":r.gradient=Z(s);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[a]=s;break;case"_name":case"_classID":break;default:n&&console.log("Invalid effect key: '".concat(a,"', value:"),s)}}return r}function q(e,n,r){var o={enab:!1};"dropShadow"===n&&(o.TrnS={"Nm  ":"","Crv ":[]});for(var i=0,a=Object.keys(e);i<a.length;i++){var s=a[i],l=e[s];switch(s){case"enabled":o.enab=!!l;break;case"useGlobalLight":o.uglg=!!l;break;case"antialiased":o.AntA=!!l;break;case"align":o.Algn=!!l;break;case"dither":o.Dthr=!!l;break;case"invert":o.Invr=!!l;break;case"reverse":o.Rvrs=!!l;break;case"color":o["Clr "]=ne(l);break;case"highlightColor":o.hglC=ne(l);break;case"shadowColor":o.sdwC=ne(l);break;case"position":o.Styl=t.FStl.encode(l);break;case"blendMode":o["Md  "]=t.BlnM.encode(l);break;case"highlightBlendMode":o.hglM=t.BlnM.encode(l);break;case"shadowBlendMode":o.sdwM=t.BlnM.encode(l);break;case"style":o.bvlS=t.BESl.encode(l);break;case"direction":o.bvlD=t.BESs.encode(l);break;case"technique":"bevel"===n?o.bvlT=t.bvlT.encode(l):o.GlwT=t.BETE.encode(l);break;case"source":o.glwS=t.IGSr.encode(l);break;case"type":o.Type=t.GrdT.encode(l);break;case"interpolationMethod":o.gs99=t.gradientInterpolationMethodType.encode(l);break;case"opacity":o.Opct=le(l);break;case"highlightOpacity":o.hglO=le(l);break;case"shadowOpacity":o.sdwO=le(l);break;case"angle":"gradientOverlay"===n||"patternFill"===n?o.Angl=se(l):o.lagl=se(l);break;case"altitude":o.Lald=se(l);break;case"soften":o.Sftn=de(l,s);break;case"strength":o.srgR=le(l);break;case"size":o.blur=de(l,s);break;case"noise":o.Nose=le(l);break;case"range":o.Inpr=le(l);break;case"choke":o.Ckmt=de(l,s);break;case"jitter":o.ShdN=le(l);break;case"distance":o.Dstn=de(l,s);break;case"scale":o["Scl "]=le(l);break;case"pattern":o.Ptrn={"Nm  ":l.name,Idnt:l.id};break;case"phase":o.phase={Hrzn:l.x,Vrtc:l.y};break;case"offset":o.Ofst={Hrzn:le(l.x),Vrtc:le(l.y)};break;case"contour":o["satin"===n?"MpgS":"TrnS"]={"Nm  ":l.name,"Crv ":l.curve.map(function(e){return{Hrzn:e.x,Vrtc:e.y}})};break;case"gradient":o.Grad=$(l);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":o[s]=l;break;default:r&&console.log("Invalid effect key: '".concat(s,"', value:"),l)}}return o}function Z(e){if("GrdF.CstS"===e.GrdF){var n=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map(function(e){return{color:te(e["Clr "]),location:e.Lctn/n,midpoint:e.Mdpn/100}}),opacityStops:e.Trns.map(function(e){return{opacity:oe(e.Opct),location:e.Lctn/n,midpoint:e.Mdpn/100}})}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:t.ClrS.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map(function(e){return e/100}),max:e["Mxm "].map(function(e){return e/100})}}function $(e){var n,r;if("solid"===e.type){var o=Math.round(4096*(null!==(n=e.smoothness)&&void 0!==n?n:1));return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:o,Clrs:e.colorStops.map(function(e){var t;return{"Clr ":ne(e.color),Type:"Clry.UsrS",Lctn:Math.round(e.location*o),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}}),Trns:e.opacityStops.map(function(e){var t;return{Opct:le(e.opacity),Lctn:Math.round(e.location*o),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}})}}return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:t.ClrS.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(r=e.roughness)&&void 0!==r?r:1)),"Mnm ":(e.min||[0,0,0,0]).map(function(e){return 100*e}),"Mxm ":(e.max||[1,1,1,1]).map(function(e){return 100*e})}}function K(e){var n=Z(e.Grad);return n.style=t.GrdT.decode(e.Type),void 0!==e.Dthr&&(n.dither=e.Dthr),void 0!==e.gradientsInterpolationMethod&&(n.interpolationMethod=t.gradientInterpolationMethodType.decode(e.gradientsInterpolationMethod)),void 0!==e.Rvrs&&(n.reverse=e.Rvrs),void 0!==e.Angl&&(n.angle=re(e.Angl)),void 0!==e["Scl "]&&(n.scale=oe(e["Scl "])),void 0!==e.Algn&&(n.align=e.Algn),void 0!==e.Ofst&&(n.offset={x:oe(e.Ofst.Hrzn),y:oe(e.Ofst.Vrtc)}),n}function J(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function Q(e){var n={};return void 0!==e.dither&&(n.Dthr=e.dither),void 0!==e.interpolationMethod&&(n.gradientsInterpolationMethod=t.gradientInterpolationMethodType.encode(e.interpolationMethod)),void 0!==e.reverse&&(n.Rvrs=e.reverse),void 0!==e.angle&&(n.Angl=se(e.angle)),n.Type=t.GrdT.encode(e.style),void 0!==e.align&&(n.Algn=e.align),void 0!==e.scale&&(n["Scl "]=le(e.scale)),e.offset&&(n.Ofst={Hrzn:le(e.offset.x),Vrtc:le(e.offset.y)}),n.Grad=$(e),n}function ee(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return void 0!==e.linked&&(t.Lnkd=!!e.linked),void 0!==e.phase&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function te(e){if("H   "in e)return{h:ie(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}function ne(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":se(360*e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}function re(e){if(void 0===e)return 0;if("Angle"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value}function oe(e){if(void 0===e)return 1;if("Percent"!==e.units)throw new Error("Invalid units: ".concat(e.units));return e.value/100}function ie(e){if(void 0===e)return 1;if("Percent"===e.units)return e.value/100;if("Angle"===e.units)return e.value/360;throw new Error("Invalid units: ".concat(e.units))}function ae(e){var t=e.units,n=e.value;if("Pixels"!==t&&"Millimeters"!==t&&"Points"!==t&&"None"!==t&&"Picas"!==t&&"Inches"!==t&&"Centimeters"!==t&&"Density"!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:n})));return{value:n,units:t}}function se(e){return{units:"Angle",value:e||0}}function le(e){return{units:"Percent",value:Math.round(100*(e||0))}}function ce(e){return{units:"Percent",value:100*(e||0)}}function de(e,t){if(null==e)return{units:"Pixels",value:0};if("object"!==typeof e)throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var n=e.units,r=e.value;if("number"!==typeof r)throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if("Pixels"!==n&&"Millimeters"!==n&&"Points"!==n&&"None"!==n&&"Picas"!==n&&"Inches"!==n&&"Centimeters"!==n&&"Density"!==n)throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:n,value:r}}t.readVersionAndDescriptor=function(e,t){void 0===t&&(t=!1);var n=(0,a.readUint32)(e);if(16!==n)throw new Error("Invalid descriptor version: ".concat(n));return A(e,t)},t.writeVersionAndDescriptor=function(e,t,n,r,o){void 0===o&&(o=""),(0,s.writeUint32)(e,16),O(e,t,n,r,o)},t.horzVrtcToXY=L,t.xyToHorzVrtc=N,t.descBoundsToBounds=function(e){return{top:ae(e["Top "]),left:ae(e.Left),right:ae(e.Rght),bottom:ae(e.Btom)}},t.boundsToDescBounds=function(e){var t;return(t={Left:de(e.left,"bounds.left")})["Top "]=de(e.top,"bounds.top"),t.Rght=de(e.right,"bounds.right"),t.Btom=de(e.bottom,"bounds.bottom"),t},t.serializeEffects=W,t.parseEffects=H,t.parseTrackList=function(e,n){for(var r=[],o=0;o<e.length;o++){var i=e[o],a={type:t.stdTrackID.decode(i.trackID),enabled:i.enab,keys:G(i.keyList,n)};i.effectParams&&(a.effectParams={fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin,keys:G(i.effectParams.keyList,n)}),r.push(a)}return r},t.serializeTrackList=function(e){for(var n=[],o=0;o<e.length;o++){var i=e[o];n.push(r(r({trackID:t.stdTrackID.encode(i.type),Vrsn:1,enab:!!i.enabled,Effc:!!i.effectParams},i.effectParams?{effectParams:{keyList:X(i.keys),fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin}}:{}),{keyList:X(i.keys)}))}return n},t.parseVectorContent=function(e){if("Grad"in e)return K(e);if("Ptrn"in e)return r({type:"pattern"},J(e));if("Clr "in e)return{type:"color",color:te(e["Clr "])};throw new Error("Invalid vector content")},t.serializeVectorContent=function(e){return"color"===e.type?{key:"SoCo",descriptor:{"Clr ":ne(e.color)}}:"pattern"===e.type?{key:"PtFl",descriptor:ee(e)}:{key:"GdFl",descriptor:Q(e)}},t.parseColor=te,t.serializeColor=ne,t.parseAngle=re,t.parsePercent=oe,t.parsePercentOrAngle=ie,t.parseUnits=ae,t.parseUnitsOrNumber=function(e,t){return void 0===t&&(t="Pixels"),"number"===typeof e?{value:e,units:t}:ae(e)},t.parseUnitsToNumber=function(e,t){var n=e.units,r=e.value;if(n!==t)throw new Error("Invalid units: ".concat(JSON.stringify({units:n,value:r})));return r},t.unitsAngle=se,t.unitsPercent=le,t.unitsPercentF=ce,t.unitsValue=de,t.frac=function(e){return{numerator:e.numerator,denominator:e.denominator}},t.textGridding=(0,i.createEnum)("textGridding","none",{none:"None",round:"Rnd "}),t.Ornt=(0,i.createEnum)("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),t.Annt=(0,i.createEnum)("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"}),t.warpStyle=(0,i.createEnum)("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"}),t.BlnM=(0,i.createEnum)("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"}),t.BESl=(0,i.createEnum)("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),t.bvlT=(0,i.createEnum)("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),t.BESs=(0,i.createEnum)("BESs","up",{up:"In  ",down:"Out "}),t.BETE=(0,i.createEnum)("BETE","softer",{softer:"SfBL",precise:"PrBL"}),t.IGSr=(0,i.createEnum)("IGSr","edge",{edge:"SrcE",center:"SrcC"}),t.GrdT=(0,i.createEnum)("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"}),t.animInterpStyleEnum=(0,i.createEnum)("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"}),t.stdTrackID=(0,i.createEnum)("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"}),t.gradientInterpolationMethodType=(0,i.createEnum)("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr ",classic:"Gcls",smooth:"Smoo"}),t.ClrS=(0,i.createEnum)("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"}),t.FStl=(0,i.createEnum)("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),t.FrFl=(0,i.createEnum)("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),t.ESliceType=(0,i.createEnum)("ESliceType","image",{image:"Img ",noImage:"noImage"}),t.ESliceHorzAlign=(0,i.createEnum)("ESliceHorzAlign","default",{default:"default"}),t.ESliceVertAlign=(0,i.createEnum)("ESliceVertAlign","default",{default:"default"}),t.ESliceOrigin=(0,i.createEnum)("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"}),t.ESliceBGColorType=(0,i.createEnum)("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "}),t.strokeStyleLineCapType=(0,i.createEnum)("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),t.strokeStyleLineJoinType=(0,i.createEnum)("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),t.strokeStyleLineAlignment=(0,i.createEnum)("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"}),t.BlrM=(0,i.createEnum)("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "}),t.BlrQ=(0,i.createEnum)("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "}),t.SmBM=(0,i.createEnum)("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"}),t.SmBQ=(0,i.createEnum)("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"}),t.DspM=(0,i.createEnum)("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"}),t.UndA=(0,i.createEnum)("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"}),t.Cnvr=(0,i.createEnum)("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"}),t.RplS=(0,i.createEnum)("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "}),t.SphM=(0,i.createEnum)("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"}),t.Wvtp=(0,i.createEnum)("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"}),t.ZZTy=(0,i.createEnum)("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"}),t.Dstr=(0,i.createEnum)("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "}),t.Chnl=(0,i.createEnum)("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"}),t.MztT=(0,i.createEnum)("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"}),t.Lns=(0,i.createEnum)("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"}),t.blurType=(0,i.createEnum)("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"}),t.DfsM=(0,i.createEnum)("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"}),t.ExtT=(0,i.createEnum)("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"}),t.ExtR=(0,i.createEnum)("ExtR","random",{random:"Rndm","level-based":"LvlB"}),t.FlCl=(0,i.createEnum)("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"}),t.CntE=(0,i.createEnum)("CntE","upper",{lower:"Lwr ",upper:"Upr "}),t.WndM=(0,i.createEnum)("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"}),t.Drct=(0,i.createEnum)("Drct","from the right",{left:"Left",right:"Rght"}),t.IntE=(0,i.createEnum)("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"}),t.IntC=(0,i.createEnum)("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"}),t.FlMd=(0,i.createEnum)("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "}),t.prjM=(0,i.createEnum)("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"}),t.presetKindType=(0,i.createEnum)("presetKindType","presetKindCustom",{custom:"presetKindCustom",default:"presetKindDefault"})},2070:(e,t,n)=>{var r=n(7937)(n(6552),"Set");e.exports=r},2074:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},2090:e=>{"use strict";var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch(n){t=!1}e.exports=t},2101:(e,t,n)=>{"use strict";var r=n(2090),o=function(){return!!r};o.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},2108:(e,t,n)=>{"use strict";var r="undefined"!==typeof Symbol&&Symbol,o=n(9534);e.exports=function(){return"function"===typeof r&&("function"===typeof Symbol&&("symbol"===typeof r("foo")&&("symbol"===typeof Symbol("bar")&&o())))}},2117:(e,t,n)=>{var r=n(6741),o=n(9057);e.exports=function(e,t){return null!=e&&o(e,t,r)}},2125:(e,t,n)=>{var r=n(5750);function o(e,t,n,i,a,s){r.has(i,t)||(i[t]=!0,n||s.push(t),r.each(a(t),function(t){o(e,t,n,i,a,s)}),n&&s.push(t))}e.exports=function(e,t,n){r.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],s={};return r.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);o(e,t,"post"===n,s,i,a)}),a}},2154:(e,t,n)=>{var r=n(5575),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},2247:(e,t,n)=>{"use strict";const{Deflate:r,deflate:o,deflateRaw:i,gzip:a}=n(868),{Inflate:s,inflate:l,inflateRaw:c,ungzip:d}=n(8488),u=n(2328);e.exports.Deflate=r,e.exports.deflate=o,e.exports.deflateRaw=i,e.exports.gzip=a,e.exports.Inflate=s,e.exports.inflate=l,e.exports.inflateRaw=c,e.exports.ungzip=d,e.exports.constants=u},2256:(e,t)=>{"use strict";function n(e){return 0===(4294967168&e)?1:0===(4294965248&e)?2:0===(4294901760&e)?3:4}function r(e){for(var t=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319){if(r+1<e.length){var i=e.charCodeAt(r+1);56320===(64512&i)&&(r++,t+=n(((1023&o)<<10)+(1023&i)+65536))}}else t+=n(o)}return t}function o(e,t,r){var o=n(r);switch(o){case 1:e[t]=r;break;case 2:e[t]=r>>6&31|192,e[t+1]=63&r|128;break;case 3:e[t]=r>>12&15|224,e[t+1]=r>>6&63|128,e[t+2]=63&r|128;break;default:e[t]=r>>18&7|240,e[t+1]=r>>12&63|128,e[t+2]=r>>6&63|128,e[t+3]=63&r|128}return o}function i(e,t,n){for(var r=0;r<n.length;r++){var i=n.charCodeAt(r);if(i>=55296&&i<=56319){if(r+1<n.length){var a=n.charCodeAt(r+1);if(56320===(64512&a))r++,t+=o(e,t,((1023&i)<<10)+(1023&a)+65536)}}else t+=o(e,t,i)}return t}function a(e,t){if(t>=e.length)throw Error("Invalid byte index");var n=e[t];if(128===(192&n))return 63&n;throw Error("Invalid continuation byte")}Object.defineProperty(t,"__esModule",{value:!0}),t.decodeString=t.encodeString=t.encodeStringTo=t.stringLengthInBytes=void 0,t.stringLengthInBytes=r,t.encodeStringTo=i,t.encodeString=function(e){if(e.length>1e3&&"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);var t=new Uint8Array(r(e));return i(t,0,e),t},t.decodeString=function(e){if(e.byteLength>1e3&&"undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t=[],n=0;n<e.length;){var r=e[n++],o=void 0;if(0===(128&r))o=r;else if(192===(224&r)){if((o=(31&r)<<6|a(e,n++))<128)throw Error("Invalid continuation byte")}else if(224===(240&r)){if((o=(15&r)<<12|a(e,n++)<<6|a(e,n++))<2048)throw Error("Invalid continuation byte");if(o>=55296&&o<=57343)throw Error("Lone surrogate U+".concat(o.toString(16).toUpperCase()," is not a scalar value"))}else{if(240!==(248&r))throw Error("Invalid UTF-8 detected");if((o=(15&r)<<18|a(e,n++)<<12|a(e,n++)<<6|a(e,n++))<65536||o>1114111)throw Error("Invalid continuation byte")}o>65535&&(o-=65536,t.push(String.fromCharCode(o>>>10&1023|55296)),o=56320|1023&o),t.push(String.fromCharCode(o))}return t.join("")}},2322:(e,t,n)=>{var r=n(6913),o=n(5990),i=n(2761),a=Function.prototype,s=Object.prototype,l=a.toString,c=s.hasOwnProperty,d=l.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==d}},2328:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2330:(e,t,n)=>{"use strict";var r=n(5043);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useState,a=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(r){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,d=r[1];return s(function(){o.value=n,o.getSnapshot=t,c(o)&&d({inst:o})},[e,n,t]),a(function(){return c(o)&&d({inst:o}),e(function(){c(o)&&d({inst:o})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},2390:(e,t,n)=>{"use strict";const{_tr_init:r,_tr_stored_block:o,_tr_flush_block:i,_tr_tally:a,_tr_align:s}=n(2484),l=n(4544),c=n(3250),d=n(3785),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:p,Z_FULL_FLUSH:h,Z_FINISH:f,Z_BLOCK:g,Z_OK:m,Z_STREAM_END:v,Z_STREAM_ERROR:y,Z_DATA_ERROR:x,Z_BUF_ERROR:b,Z_DEFAULT_COMPRESSION:w,Z_FILTERED:S,Z_HUFFMAN_ONLY:k,Z_RLE:C,Z_FIXED:j,Z_DEFAULT_STRATEGY:_,Z_UNKNOWN:E,Z_DEFLATED:D}=n(2328),M=258,T=262,I=42,A=113,O=666,R=(e,t)=>(e.msg=d[t],t),z=e=>2*e-(e>4?9:0),F=e=>{let t=e.length;for(;--t>=0;)e[t]=0},P=e=>{let t,n,r,o=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=o?n-o:0}while(--t);t=o,r=t;do{n=e.prev[--r],e.prev[r]=n>=o?n-o:0}while(--t)};let B=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const L=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},N=(e,t)=>{i(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,L(e.strm)},U=(e,t)=>{e.pending_buf[e.pending++]=t},V=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},W=(e,t,n,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=l(e.adler,t,o,n):2===e.state.wrap&&(e.adler=c(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},H=(e,t)=>{let n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-T?e.strstart-(e.w_size-T):0,c=e.window,d=e.w_mask,u=e.prev,p=e.strstart+M;let h=c[i+a-1],f=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,c[n+a]===f&&c[n+a-1]===h&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(r=M-(p-i),i=p-M,r>a){if(e.match_start=t,a=r,r>=s)break;h=c[i+a-1],f=c[i+a]}}}while((t=u[t&d])>l&&0!==--o);return a<=e.lookahead?a:e.lookahead},G=e=>{const t=e.w_size;let n,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-T)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),P(e),r+=t),0===e.strm.avail_in)break;if(n=W(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=B(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=B(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<T&&0!==e.strm.avail_in)},X=(e,t)=>{let n,r,i,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,l=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&t!==f||t===u||n!==r+e.strm.avail_in))break;s=t===f&&n===r+e.strm.avail_in?1:0,o(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,L(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(W(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==u&&t!==f&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(W(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,a=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=a||(r||t===f)&&t!==u&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,s=t===f&&0===e.strm.avail_in&&n===r?1:0,o(e,e.block_start,n,s),e.block_start+=n,L(e.strm)),s?3:1)},Y=(e,t)=>{let n,r;for(;;){if(e.lookahead<T){if(G(e),e.lookahead<T&&t===u)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-T&&(e.match_length=H(e,n)),e.match_length>=3)if(r=a(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=B(e,e.ins_h,e.window[e.strstart+1]);else r=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===f?(N(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(N(e,!1),0===e.strm.avail_out)?1:2},q=(e,t)=>{let n,r,o;for(;;){if(e.lookahead<T){if(G(e),e.lookahead<T&&t===u)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-T&&(e.match_length=H(e,n),e.match_length<=5&&(e.strategy===S||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=a(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=a(e,0,e.window[e.strstart-1]),r&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===f?(N(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(N(e,!1),0===e.strm.avail_out)?1:2};function Z(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}const $=[new Z(0,0,0,0,X),new Z(4,4,8,4,Y),new Z(4,5,16,8,Y),new Z(4,6,32,32,Y),new Z(4,4,16,16,q),new Z(8,16,32,32,q),new Z(8,16,128,128,q),new Z(8,32,128,256,q),new Z(32,128,258,1024,q),new Z(32,258,258,4096,q)];function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=D,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),F(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const J=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==I&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==A&&t.status!==O?1:0},Q=e=>{if(J(e))return R(e,y);e.total_in=e.total_out=0,e.data_type=E;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?I:A,e.adler=2===t.wrap?0:1,t.last_flush=-2,r(t),m},ee=e=>{const t=Q(e);var n;return t===m&&((n=e.state).window_size=2*n.w_size,F(n.head),n.max_lazy_match=$[n.level].max_lazy,n.good_match=$[n.level].good_length,n.nice_match=$[n.level].nice_length,n.max_chain_length=$[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},te=(e,t,n,r,o,i)=>{if(!e)return y;let a=1;if(t===w&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||n!==D||r<8||r>15||t<0||t>9||i<0||i>j||8===r&&1!==a)return R(e,y);8===r&&(r=9);const s=new K;return e.state=s,s.strm=e,s.status=I,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=n,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,D,15,8,_),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=Q,e.exports.deflateSetHeader=(e,t)=>J(e)||2!==e.state.wrap?y:(e.state.gzhead=t,m),e.exports.deflate=(e,t)=>{if(J(e)||t>g||t<0)return e?R(e,y):y;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===O&&t!==f)return R(e,0===e.avail_out?b:y);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(L(e),0===e.avail_out)return n.last_flush=-1,m}else if(0===e.avail_in&&z(t)<=z(r)&&t!==f)return R(e,b);if(n.status===O&&0!==e.avail_in)return R(e,b);if(n.status===I&&0===n.wrap&&(n.status=A),n.status===I){let t=D+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=k||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,V(n,t),0!==n.strstart&&(V(n,e.adler>>>16),V(n,65535&e.adler)),e.adler=1,n.status=A,L(e),0!==n.pending)return n.last_flush=-1,m}if(57===n.status)if(e.adler=0,U(n,31),U(n,139),U(n,8),n.gzhead)U(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),U(n,255&n.gzhead.time),U(n,n.gzhead.time>>8&255),U(n,n.gzhead.time>>16&255),U(n,n.gzhead.time>>24&255),U(n,9===n.level?2:n.strategy>=k||n.level<2?4:0),U(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(U(n,255&n.gzhead.extra.length),U(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=c(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(U(n,0),U(n,0),U(n,0),U(n,0),U(n,0),U(n,9===n.level?2:n.strategy>=k||n.level<2?4:0),U(n,3),n.status=A,L(e),0!==n.pending)return n.last_flush=-1,m;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=c(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=o,L(e),0!==n.pending)return n.last_flush=-1,m;t=0,r-=o}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=c(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=c(e.adler,n.pending_buf,n.pending-r,r)),L(e),0!==n.pending)return n.last_flush=-1,m;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,U(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=c(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=c(e.adler,n.pending_buf,n.pending-r,r)),L(e),0!==n.pending)return n.last_flush=-1,m;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,U(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=c(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(L(e),0!==n.pending))return n.last_flush=-1,m;U(n,255&e.adler),U(n,e.adler>>8&255),e.adler=0}if(n.status=A,L(e),0!==n.pending)return n.last_flush=-1,m}if(0!==e.avail_in||0!==n.lookahead||t!==u&&n.status!==O){let r=0===n.level?X(n,t):n.strategy===k?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(G(e),0===e.lookahead)){if(t===u)return 1;break}if(e.match_length=0,n=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(N(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===C?((e,t)=>{let n,r,o,i;const s=e.window;for(;;){if(e.lookahead<=M){if(G(e),e.lookahead<=M&&t===u)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=s[o],r===s[++o]&&r===s[++o]&&r===s[++o])){i=e.strstart+M;do{}while(r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&o<i);e.match_length=M-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(N(e,!1),0===e.strm.avail_out)?1:2})(n,t):$[n.level].func(n,t);if(3!==r&&4!==r||(n.status=O),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),m;if(2===r&&(t===p?s(n):t!==g&&(o(n,0,0,!1),t===h&&(F(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),L(e),0===e.avail_out))return n.last_flush=-1,m}return t!==f?m:n.wrap<=0?v:(2===n.wrap?(U(n,255&e.adler),U(n,e.adler>>8&255),U(n,e.adler>>16&255),U(n,e.adler>>24&255),U(n,255&e.total_in),U(n,e.total_in>>8&255),U(n,e.total_in>>16&255),U(n,e.total_in>>24&255)):(V(n,e.adler>>>16),V(n,65535&e.adler)),L(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?m:v)},e.exports.deflateEnd=e=>{if(J(e))return y;const t=e.state.status;return e.state=null,t===A?R(e,x):m},e.exports.deflateSetDictionary=(e,t)=>{let n=t.length;if(J(e))return y;const r=e.state,o=r.wrap;if(2===o||1===o&&r.status!==I||r.lookahead)return y;if(1===o&&(e.adler=l(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===o&&(F(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,G(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=B(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,G(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=i,r.wrap=o,m},e.exports.deflateInfo="pako deflate (from Nodeca project)"},2450:function(e,t,n){var r,o,i;o=[],void 0===(i="function"===typeof(r=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){l(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=a.URL||a.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):o(l.href)?r(e,t,n):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),n);else if(o(e))r(e,n,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){i(s)})}}:function(e,t,n,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var i="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&l||s)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},d.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,p=u.createObjectURL(e);o?o.location=p:location.href=p,o=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})?r.apply(t,o):r)||(e.exports=i)},2460:(e,t,n)=>{"use strict";var r=n(5758).longestPath,o=n(3088),i=n(4501);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:s(e);break;case"tight-tree":!function(e){r(e),o(e)}(e);break;case"longest-path":a(e)}};var a=r;function s(e){i(e)}},2484:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const n=256,r=286,o=30,i=15,a=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new Array(576);t(d);const u=new Array(60);t(u);const p=new Array(512);t(p);const h=new Array(256);t(h);const f=new Array(29);t(f);const g=new Array(o);function m(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let v,y,x;function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(g);const w=e=>e<256?p[e]:p[256+(e>>>7)],S=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},k=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},C=(e,t,n)=>{k(e,n[2*t],n[2*t+1])},j=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},_=(e,t,n)=>{const r=new Array(16);let o,a,s=0;for(o=1;o<=i;o++)s=s+n[o-1]<<1,r[o]=s;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=j(r[t]++,t))}},E=e=>{let t;for(t=0;t<r;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},D=e=>{e.bi_valid>8?S(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},M=(e,t,n,r)=>{const o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]},T=(e,t,n)=>{const r=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&M(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!M(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r},I=(e,t,r)=>{let o,i,l,c,d=0;if(0!==e.sym_next)do{o=255&e.pending_buf[e.sym_buf+d++],o+=(255&e.pending_buf[e.sym_buf+d++])<<8,i=e.pending_buf[e.sym_buf+d++],0===o?C(e,i,t):(l=h[i],C(e,l+n+1,t),c=a[l],0!==c&&(i-=f[l],k(e,i,c)),o--,l=w(o),C(e,l,r),c=s[l],0!==c&&(o-=g[l],k(e,o,c)))}while(d<e.sym_next);C(e,256,t)},A=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,l,c,d=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)0!==n[2*s]?(e.heap[++e.heap_len]=d=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=d<2?++d:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,o&&(e.static_len-=r[2*c+1]);for(t.max_code=d,s=e.heap_len>>1;s>=1;s--)T(e,n,s);c=a;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],T(e,n,1),l=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=l,n[2*c]=n[2*s]+n[2*l],e.depth[c]=(e.depth[s]>=e.depth[l]?e.depth[s]:e.depth[l])+1,n[2*s+1]=n[2*l+1]=c,e.heap[1]=c++,T(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,p,h,f,g,m=0;for(h=0;h<=i;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)u=e.heap[d],h=n[2*n[2*u+1]+1]+1,h>c&&(h=c,m++),n[2*u+1]=h,u>r||(e.bl_count[h]++,f=0,u>=l&&(f=s[u-l]),g=n[2*u],e.opt_len+=g*(h+f),a&&(e.static_len+=g*(o[2*u+1]+f)));if(0!==m){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(h=c;0!==h;h--)for(u=e.bl_count[h];0!==u;)p=e.heap[--d],p>r||(n[2*p+1]!==h&&(e.opt_len+=(h-n[2*p+1])*n[2*p],n[2*p+1]=h),u--)}})(e,t),_(n,d,e.bl_count)},O=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))},R=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<l&&o===a)){if(s<c)do{C(e,o,e.bl_tree)}while(0!==--s);else 0!==o?(o!==i&&(C(e,o,e.bl_tree),s--),C(e,16,e.bl_tree),k(e,s-3,2)):s<=10?(C(e,17,e.bl_tree),k(e,s-3,3)):(C(e,18,e.bl_tree),k(e,s-11,7));s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}};let z=!1;const F=(e,t,n,r)=>{k(e,0+(r?1:0),3),D(e),S(e,n),S(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};e.exports._tr_init=e=>{z||((()=>{let e,t,n,c,b;const w=new Array(16);for(n=0,c=0;c<28;c++)for(f[c]=n,e=0;e<1<<a[c];e++)h[n++]=c;for(h[n-1]=c,b=0,c=0;c<16;c++)for(g[c]=b,e=0;e<1<<s[c];e++)p[b++]=c;for(b>>=7;c<o;c++)for(g[c]=b<<7,e=0;e<1<<s[c]-7;e++)p[256+b++]=c;for(t=0;t<=i;t++)w[t]=0;for(e=0;e<=143;)d[2*e+1]=8,e++,w[8]++;for(;e<=255;)d[2*e+1]=9,e++,w[9]++;for(;e<=279;)d[2*e+1]=7,e++,w[7]++;for(;e<=287;)d[2*e+1]=8,e++,w[8]++;for(_(d,287,w),e=0;e<o;e++)u[2*e+1]=5,u[2*e]=j(e,5);v=new m(d,a,257,r,i),y=new m(u,s,0,o,i),x=new m(new Array(0),l,0,19,7)})(),z=!0),e.l_desc=new b(e.dyn_ltree,v),e.d_desc=new b(e.dyn_dtree,y),e.bl_desc=new b(e.bl_tree,x),e.bi_buf=0,e.bi_valid=0,E(e)},e.exports._tr_stored_block=F,e.exports._tr_flush_block=(e,t,r,o)=>{let i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<n;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),A(e,e.l_desc),A(e,e.d_desc),s=(e=>{let t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),A(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?F(e,t,r,o):4===e.strategy||a===i?(k(e,2+(o?1:0),3),I(e,d,u)):(k(e,4+(o?1:0),3),((e,t,n,r)=>{let o;for(k(e,t-257,5),k(e,n-1,5),k(e,r-4,4),o=0;o<r;o++)k(e,e.bl_tree[2*c[o]+1],3);R(e,e.dyn_ltree,t-1),R(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),I(e,e.dyn_ltree,e.dyn_dtree)),E(e),o&&D(e)},e.exports._tr_tally=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(h[r]+n+1)]++,e.dyn_dtree[2*w(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{k(e,2,3),C(e,256,d),(e=>{16===e.bi_valid?(S(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},2520:(e,t,n)=>{var r=n(5816),o=n(9096),i=n(9140),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var l=null==n?0:i(n);return l<0&&(l=a(s+l,0)),r(e,o(t,3),l)}},2536:(e,t,n)=>{var r=n(149),o=n(2969),i=n(9096),a=n(8883),s=n(320),l=n(7574),c=n(5893),d=n(3279),u=n(4052);e.exports=function(e,t,n){t=t.length?r(t,function(e){return u(e)?function(t){return o(t,1===e.length?e[0]:e)}:e}):[d];var p=-1;t=r(t,l(i));var h=a(e,function(e,n,o){return{criteria:r(t,function(t){return t(e)}),index:++p,value:e}});return s(h,function(e,t){return c(e,t,n)})}},2541:e=>{e.exports=function(e){return function(){return e}}},2557:e=>{"use strict";e.exports=SyntaxError},2580:(e,t,n)=>{e.exports=n(5491)},2587:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},2597:(e,t,n)=>{var r=n(4052),o=n(9841),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(a.test(e)||!i.test(e)||null!=t&&e in Object(t))}},2616:(e,t,n)=>{var r=n(4008),o=n(5857)(function(e,t){return null==e?{}:r(e,t)});e.exports=o},2622:(e,t,n)=>{var r=n(705);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},2662:(e,t,n)=>{var r=n(5575);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},2717:(e,t,n)=>{var r=n(726),o=n(1817),i=n(4664),a=n(9096),s=n(5990),l=n(4052),c=n(4543),d=n(1629),u=n(6686),p=n(1268);e.exports=function(e,t,n){var h=l(e),f=h||c(e)||p(e);if(t=a(t,4),null==n){var g=e&&e.constructor;n=f?h?new g:[]:u(e)&&d(g)?o(s(e)):{}}return(f?r:i)(e,function(e,r,o){return t(n,e,r,o)}),n}},2730:(e,t,n)=>{"use strict";var r=n(5043),o=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!u.call(f,e)||!u.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var F,P=Object.assign;function B(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var L=!1;function N(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var l="\n"+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function U(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=N(e.type,!1);case 11:return e=N(e.type.render,!1);case 1:return e=N(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case S:return"Portal";case j:return"Profiler";case C:return"StrictMode";case M:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case D:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return P({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function J(e,t){K(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return P({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var me=P({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,ke=null;function Ce(e){if(e=mo(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=yo(t),we(e.stateNode,e.type,t))}}function je(e){Se?ke?ke.push(e):ke=[e]:Se=e}function _e(){if(Se){var e=Se,t=ke;if(ke=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ee(e,t){return e(t)}function De(){}var Me=!1;function Te(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ee(e,t,n)}finally{Me=!1,(null!==Se||null!==ke)&&(De(),_e())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=yo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ae=!1;if(d)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ed){Ae=!1}function Re(e,t,n,r,o,i,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var ze=!1,Fe=null,Pe=!1,Be=null,Le={onError:function(e){ze=!0,Fe=e}};function Ne(e,t,n,r,o,i,a,s,l){ze=!1,Fe=null,Re.apply(Le,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(r=o.return)){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return We(o),e;if(a===r)return We(o),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=a;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=a;break}if(l===r){s=!0,r=o,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=o;break}if(l===r){s=!0,r=a,n=o;break}l=l.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Xe=o.unstable_scheduleCallback,Ye=o.unstable_cancelCallback,qe=o.unstable_shouldYield,Ze=o.unstable_requestPaint,$e=o.unstable_now,Ke=o.unstable_getCurrentPriorityLevel,Je=o.unstable_ImmediatePriority,Qe=o.unstable_UserBlockingPriority,et=o.unstable_NormalPriority,tt=o.unstable_LowPriority,nt=o.unstable_IdlePriority,rt=null,ot=null;var it=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/st|0)|0},at=Math.log,st=Math.LN2;var lt=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~o;0!==s?r=dt(s):0!==(i&=a)&&(r=dt(i))}else 0!==(a=n&~o)?r=dt(a):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-it(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var yt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,St,kt,Ct,jt=!1,_t=[],Et=null,Dt=null,Mt=null,Tt=new Map,It=new Map,At=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Dt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function zt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=mo(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ft(e){var t=go(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=mo(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){Pt(e)&&n.delete(t)}function Lt(){jt=!1,null!==Et&&Pt(Et)&&(Et=null),null!==Dt&&Pt(Dt)&&(Dt=null),null!==Mt&&Pt(Mt)&&(Mt=null),Tt.forEach(Bt),It.forEach(Bt)}function Nt(e,t){e.blockedOn===t&&(e.blockedOn=null,jt||(jt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Lt)))}function Ut(e){function t(t){return Nt(t,e)}if(0<_t.length){Nt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Nt(Et,e),null!==Dt&&Nt(Dt,e),null!==Mt&&Nt(Mt,e),Tt.forEach(t),It.forEach(t),n=0;n<At.length;n++)(r=At[n]).blockedOn===e&&(r.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Ft(n),null===n.blockedOn&&At.shift()}var Vt=b.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var o=yt,i=Vt.transition;Vt.transition=null;try{yt=1,Xt(e,t,n,r)}finally{yt=o,Vt.transition=i}}function Gt(e,t,n,r){var o=yt,i=Vt.transition;Vt.transition=null;try{yt=4,Xt(e,t,n,r)}finally{yt=o,Vt.transition=i}}function Xt(e,t,n,r){if(Wt){var o=qt(e,t,n,r);if(null===o)Nr(e,t,r,Yt,n),Rt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Et=zt(Et,e,t,n,r,o),!0;case"dragenter":return Dt=zt(Dt,e,t,n,r,o),!0;case"mouseover":return Mt=zt(Mt,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Tt.set(i,zt(Tt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,It.set(i,zt(It.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==o;){var i=mo(o);if(null!==i&&bt(i),null===(i=qt(e,t,n,r))&&Nr(e,t,r,Yt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Nr(e,t,r,null,n)}}var Yt=null;function qt(e,t,n,r){if(Yt=null,null!==(e=go(e=be(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ke()){case Je:return 1;case Qe:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var $t=null,Kt=null,Jt=null;function Qt(){if(Jt)return Jt;var e,t,n=Kt,r=n.length,o="value"in $t?$t.value:$t.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Jt=o.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function rn(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return P(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var on,an,sn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=rn(ln),dn=P({},ln,{view:0,detail:0}),un=rn(dn),pn=P({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,an=e.screenY-sn.screenY):an=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),hn=rn(pn),fn=rn(P({},pn,{dataTransfer:0})),gn=rn(P({},dn,{relatedTarget:0})),mn=rn(P({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=rn(P({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),yn=rn(P({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function kn(){return Sn}var Cn=rn(P({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),jn=rn(P({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=rn(P({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),En=rn(P({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=rn(P({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Mn=[9,13,27,32],Tn=d&&"CompositionEvent"in window,In=null;d&&"documentMode"in document&&(In=document.documentMode);var An=d&&"TextEvent"in window&&!In,On=d&&(!Tn||In&&8<In&&11>=In),Rn=String.fromCharCode(32),zn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Ln={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ln[e.type]:"textarea"===t}function Un(e,t,n,r){je(r),0<(t=Vr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Wn=null;function Hn(e){Rr(e,0)}function Gn(e){if(Y(vo(e)))return e}function Xn(e,t){if("change"===e)return t}var Yn=!1;if(d){var qn;if(d){var Zn="oninput"in document;if(!Zn){var $n=document.createElement("div");$n.setAttribute("oninput","return;"),Zn="function"===typeof $n.oninput}qn=Zn}else qn=!1;Yn=qn&&(!document.documentMode||9<document.documentMode)}function Kn(){Vn&&(Vn.detachEvent("onpropertychange",Jn),Wn=Vn=null)}function Jn(e){if("value"===e.propertyName&&Gn(Wn)){var t=[];Un(t,Wn,e,be(e)),Te(Hn,t)}}function Qn(e,t,n){"focusin"===e?(Kn(),Wn=n,(Vn=t).attachEvent("onpropertychange",Jn)):"focusout"===e&&Kn()}function er(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn(Wn)}function tr(e,t){if("click"===e)return Gn(t)}function nr(e,t){if("input"===e||"change"===e)return Gn(t)}var rr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function or(e,t){if(rr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!u.call(t,o)||!rr(e[o],t[o]))return!1}return!0}function ir(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ar(e,t){var n,r=ir(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ir(r)}}function sr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?sr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function lr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function cr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=lr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&sr(n.ownerDocument.documentElement,n)){if(null!==r&&cr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=ar(n,i);var a=ar(n,r);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ur=d&&"documentMode"in document&&11>=document.documentMode,pr=null,hr=null,fr=null,gr=!1;function mr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;gr||null==pr||pr!==q(r)||("selectionStart"in(r=pr)&&cr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},fr&&or(fr,r)||(fr=r,0<(r=Vr(hr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pr)))}function vr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var yr={animationend:vr("Animation","AnimationEnd"),animationiteration:vr("Animation","AnimationIteration"),animationstart:vr("Animation","AnimationStart"),transitionend:vr("Transition","TransitionEnd")},xr={},br={};function wr(e){if(xr[e])return xr[e];if(!yr[e])return e;var t,n=yr[e];for(t in n)if(n.hasOwnProperty(t)&&t in br)return xr[e]=n[t];return e}d&&(br=document.createElement("div").style,"AnimationEvent"in window||(delete yr.animationend.animation,delete yr.animationiteration.animation,delete yr.animationstart.animation),"TransitionEvent"in window||delete yr.transitionend.transition);var Sr=wr("animationend"),kr=wr("animationiteration"),Cr=wr("animationstart"),jr=wr("transitionend"),_r=new Map,Er="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){_r.set(e,t),l(t,[e])}for(var Mr=0;Mr<Er.length;Mr++){var Tr=Er[Mr];Dr(Tr.toLowerCase(),"on"+(Tr[0].toUpperCase()+Tr.slice(1)))}Dr(Sr,"onAnimationEnd"),Dr(kr,"onAnimationIteration"),Dr(Cr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(jr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ar=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function Or(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,a,s,l,c){if(Ne.apply(this,arguments),ze){if(!ze)throw Error(i(198));var d=Fe;ze=!1,Fe=null,Pe||(Pe=!0,Be=d)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;Or(o,s,c),i=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;Or(o,s,c),i=l}}}if(Pe)throw e=Be,Pe=!1,Be=null,e}function zr(e,t){var n=t[po];void 0===n&&(n=t[po]=new Set);var r=e+"__bubble";n.has(r)||(Lr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),Lr(n,e,r,t)}var Pr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Pr]){e[Pr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Ar.has(t)||Fr(t,!1,e),Fr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Pr]||(t[Pr]=!0,Fr("selectionchange",!1,t))}}function Lr(e,t,n,r){switch(Zt(t)){case 1:var o=Ht;break;case 4:o=Gt;break;default:o=Xt}n=o.bind(null,t,n,e),o=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Nr(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=go(s)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}s=s.parentNode}}r=r.return}Te(function(){var r=i,o=be(n),a=[];e:{var s=_r.get(e);if(void 0!==s){var l=cn,c=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_n;break;case Sr:case kr:case Cr:l=mn;break;case jr:l=En;break;case"scroll":l=un;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=jn}var d=0!==(4&t),u=!d&&"scroll"===e,p=d?null!==s?s+"Capture":null:s;d=[];for(var h,f=r;null!==f;){var g=(h=f).stateNode;if(5===h.tag&&null!==g&&(h=g,null!==p&&(null!=(g=Ie(f,p))&&d.push(Ur(f,g,h)))),u)break;f=f.return}0<d.length&&(s=new l(s,c,null,n,o),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!go(c)&&!c[uo])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?go(c):null)&&(c!==(u=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=hn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=jn,g="onPointerLeave",p="onPointerEnter",f="pointer"),u=null==l?s:vo(l),h=null==c?s:vo(c),(s=new d(g,f+"leave",l,n,o)).target=u,s.relatedTarget=h,g=null,go(o)===r&&((d=new d(p,f+"enter",c,n,o)).target=h,d.relatedTarget=u,g=d),u=g,l&&c)e:{for(p=c,f=0,h=d=l;h;h=Wr(h))f++;for(h=0,g=p;g;g=Wr(g))h++;for(;0<f-h;)d=Wr(d),f--;for(;0<h-f;)p=Wr(p),h--;for(;f--;){if(d===p||null!==p&&d===p.alternate)break e;d=Wr(d),p=Wr(p)}d=null}else d=null;null!==l&&Hr(a,s,l,d,!1),null!==c&&null!==u&&Hr(a,u,c,d,!0)}if("select"===(l=(s=r?vo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Xn;else if(Nn(s))if(Yn)m=nr;else{m=er;var v=Qn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=tr);switch(m&&(m=m(e,r))?Un(a,m,n,o):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?vo(r):window,e){case"focusin":(Nn(v)||"true"===v.contentEditable)&&(pr=v,hr=r,fr=null);break;case"focusout":fr=hr=pr=null;break;case"mousedown":gr=!0;break;case"contextmenu":case"mouseup":case"dragend":gr=!1,mr(a,n,o);break;case"selectionchange":if(ur)break;case"keydown":case"keyup":mr(a,n,o)}var y;if(Tn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Bn?Fn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(On&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Bn&&(y=Qt()):(Kt="value"in($t=o)?$t.value:$t.textContent,Bn=!0)),0<(v=Vr(r,x)).length&&(x=new yn(x,e,null,n,o),a.push({event:x,listeners:v}),y?x.data=y:null!==(y=Pn(n))&&(x.data=y))),(y=An?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(zn=!0,Rn);case"textInput":return(e=t.data)===Rn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Tn&&Fn(e,t)?(e=Qt(),Jt=Kt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(o=new yn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=y))}Rr(a,t)})}function Ur(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Ie(e,n))&&r.unshift(Ur(e,i,o)),null!=(i=Ie(e,t))&&r.push(Ur(e,i,o))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hr(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Ie(n,i))&&a.unshift(Ur(n,l,s)):o||null!=(l=Ie(n,i))&&a.push(Ur(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Gr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Gr,"\n").replace(Xr,"")}function qr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(i(425))}function Zr(){}var $r=null,Kr=null;function Jr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Qr="function"===typeof setTimeout?setTimeout:void 0,eo="function"===typeof clearTimeout?clearTimeout:void 0,to="function"===typeof Promise?Promise:void 0,no="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof to?function(e){return to.resolve(null).then(e).catch(ro)}:Qr;function ro(e){setTimeout(function(){throw e})}function oo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Ut(t)}function io(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ao(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var so=Math.random().toString(36).slice(2),lo="__reactFiber$"+so,co="__reactProps$"+so,uo="__reactContainer$"+so,po="__reactEvents$"+so,ho="__reactListeners$"+so,fo="__reactHandles$"+so;function go(e){var t=e[lo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[uo]||n[lo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ao(e);null!==e;){if(n=e[lo])return n;e=ao(e)}return t}n=(e=n).parentNode}return null}function mo(e){return!(e=e[lo]||e[uo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function yo(e){return e[co]||null}var xo=[],bo=-1;function wo(e){return{current:e}}function So(e){0>bo||(e.current=xo[bo],xo[bo]=null,bo--)}function ko(e,t){bo++,xo[bo]=e.current,e.current=t}var Co={},jo=wo(Co),_o=wo(!1),Eo=Co;function Do(e,t){var n=e.type.contextTypes;if(!n)return Co;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Mo(e){return null!==(e=e.childContextTypes)&&void 0!==e}function To(){So(_o),So(jo)}function Io(e,t,n){if(jo.current!==Co)throw Error(i(168));ko(jo,t),ko(_o,n)}function Ao(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(i(108,W(e)||"Unknown",o));return P({},n,r)}function Oo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Co,Eo=jo.current,ko(jo,e),ko(_o,_o.current),!0}function Ro(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ao(e,t,Eo),r.__reactInternalMemoizedMergedChildContext=e,So(_o),So(jo),ko(jo,e)):So(_o),ko(_o,n)}var zo=null,Fo=!1,Po=!1;function Bo(e){null===zo?zo=[e]:zo.push(e)}function Lo(){if(!Po&&null!==zo){Po=!0;var e=0,t=yt;try{var n=zo;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}zo=null,Fo=!1}catch(o){throw null!==zo&&(zo=zo.slice(e+1)),Xe(Je,Lo),o}finally{yt=t,Po=!1}}return null}var No=[],Uo=0,Vo=null,Wo=0,Ho=[],Go=0,Xo=null,Yo=1,qo="";function Zo(e,t){No[Uo++]=Wo,No[Uo++]=Vo,Vo=e,Wo=t}function $o(e,t,n){Ho[Go++]=Yo,Ho[Go++]=qo,Ho[Go++]=Xo,Xo=e;var r=Yo;e=qo;var o=32-it(r)-1;r&=~(1<<o),n+=1;var i=32-it(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Yo=1<<32-it(t)+o|n<<o|r,qo=i+e}else Yo=1<<i|n<<o|r,qo=e}function Ko(e){null!==e.return&&(Zo(e,1),$o(e,1,0))}function Jo(e){for(;e===Vo;)Vo=No[--Uo],No[Uo]=null,Wo=No[--Uo],No[Uo]=null;for(;e===Xo;)Xo=Ho[--Go],Ho[Go]=null,qo=Ho[--Go],Ho[Go]=null,Yo=Ho[--Go],Ho[Go]=null}var Qo=null,ei=null,ti=!1,ni=null;function ri(e,t){var n=Ec(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Qo=e,ei=io(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Qo=e,ei=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xo?{id:Yo,overflow:qo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ec(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Qo=e,ei=null,!0);default:return!1}}function ii(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ai(e){if(ti){var t=ei;if(t){var n=t;if(!oi(e,t)){if(ii(e))throw Error(i(418));t=io(n.nextSibling);var r=Qo;t&&oi(e,t)?ri(r,n):(e.flags=-4097&e.flags|2,ti=!1,Qo=e)}}else{if(ii(e))throw Error(i(418));e.flags=-4097&e.flags|2,ti=!1,Qo=e}}}function si(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Qo=e}function li(e){if(e!==Qo)return!1;if(!ti)return si(e),ti=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Jr(e.type,e.memoizedProps)),t&&(t=ei)){if(ii(e))throw ci(),Error(i(418));for(;t;)ri(e,t),t=io(t.nextSibling)}if(si(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ei=io(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ei=null}}else ei=Qo?io(e.stateNode.nextSibling):null;return!0}function ci(){for(var e=ei;e;)e=io(e.nextSibling)}function di(){ei=Qo=null,ti=!1}function ui(e){null===ni?ni=[e]:ni.push(e)}var pi=b.ReactCurrentBatchConfig;function hi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function fi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gi(e){return(0,e._init)(e._payload)}function mi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Oc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===k?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===A&&gi(i)===t.type)?((r=o(t,n.props)).ref=hi(e,t,n),r.return=e,r):((r=Tc(n.type,n.key,n.props,null,e.mode,r)).ref=hi(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Rc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function u(e,t,n,r,i){return null===t||7!==t.tag?((t=Ic(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Tc(t.type,t.key,t.props,null,e.mode,n)).ref=hi(e,null,t),n.return=e,n;case S:return(t=Rc(t,e.mode,n)).return=e,t;case A:return p(e,(0,t._init)(t._payload),n)}if(te(t)||z(t))return(t=Ic(t,e.mode,n,null)).return=e,t;fi(e,t)}return null}function h(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===o?c(e,t,n,r):null;case S:return n.key===o?d(e,t,n,r):null;case A:return h(e,t,(o=n._init)(n._payload),r)}if(te(n)||z(n))return null!==o?null:u(e,t,n,r,null);fi(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case S:return d(t,e=e.get(null===r.key?n:r.key)||null,r,o);case A:return f(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||z(r))return u(t,e=e.get(n)||null,r,o,null);fi(t,r)}return null}function g(o,i,s,l){for(var c=null,d=null,u=i,g=i=0,m=null;null!==u&&g<s.length;g++){u.index>g?(m=u,u=null):m=u.sibling;var v=h(o,u,s[g],l);if(null===v){null===u&&(u=m);break}e&&u&&null===v.alternate&&t(o,u),i=a(v,i,g),null===d?c=v:d.sibling=v,d=v,u=m}if(g===s.length)return n(o,u),ti&&Zo(o,g),c;if(null===u){for(;g<s.length;g++)null!==(u=p(o,s[g],l))&&(i=a(u,i,g),null===d?c=u:d.sibling=u,d=u);return ti&&Zo(o,g),c}for(u=r(o,u);g<s.length;g++)null!==(m=f(u,o,g,s[g],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?g:m.key),i=a(m,i,g),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach(function(e){return t(o,e)}),ti&&Zo(o,g),c}function m(o,s,l,c){var d=z(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,g=s,m=s=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var x=h(o,g,y.value,c);if(null===x){null===g&&(g=v);break}e&&g&&null===x.alternate&&t(o,g),s=a(x,s,m),null===u?d=x:u.sibling=x,u=x,g=v}if(y.done)return n(o,g),ti&&Zo(o,m),d;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=p(o,y.value,c))&&(s=a(y,s,m),null===u?d=y:u.sibling=y,u=y);return ti&&Zo(o,m),d}for(g=r(o,g);!y.done;m++,y=l.next())null!==(y=f(g,o,m,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),s=a(y,s,m),null===u?d=y:u.sibling=y,u=y);return e&&g.forEach(function(e){return t(o,e)}),ti&&Zo(o,m),d}return function e(r,i,a,l){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,d=i;null!==d;){if(d.key===c){if((c=a.type)===k){if(7===d.tag){n(r,d.sibling),(i=o(d,a.props.children)).return=r,r=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&gi(c)===d.type){n(r,d.sibling),(i=o(d,a.props)).ref=hi(r,d,a),i.return=r,r=i;break e}n(r,d);break}t(r,d),d=d.sibling}a.type===k?((i=Ic(a.props.children,r.mode,l,a.key)).return=r,r=i):((l=Tc(a.type,a.key,a.props,null,r.mode,l)).ref=hi(r,i,a),l.return=r,r=l)}return s(r);case S:e:{for(d=a.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=o(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Rc(a,r.mode,l)).return=r,r=i}return s(r);case A:return e(r,i,(d=a._init)(a._payload),l)}if(te(a))return g(r,i,a,l);if(z(a))return m(r,i,a,l);fi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,a)).return=r,r=i):(n(r,i),(i=Oc(a,r.mode,l)).return=r,r=i),s(r)):n(r,i)}}var vi=mi(!0),yi=mi(!1),xi=wo(null),bi=null,wi=null,Si=null;function ki(){Si=wi=bi=null}function Ci(e){var t=xi.current;So(xi),e._currentValue=t}function ji(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function _i(e,t){bi=e,Si=wi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(gs=!0),e.firstContext=null)}function Ei(e){var t=e._currentValue;if(Si!==e)if(e={context:e,memoizedValue:t,next:null},null===wi){if(null===bi)throw Error(i(308));wi=e,bi.dependencies={lanes:0,firstContext:e}}else wi=wi.next=e;return t}var Di=null;function Mi(e){null===Di?Di=[e]:Di.push(e)}function Ti(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Mi(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ii(e,r)}function Ii(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ai=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Ii(e,n)}return null===(o=r.interleaved)?(t.next=t,Mi(r)):(t.next=o.next,o.next=t),r.interleaved=t,Ii(e,n)}function Pi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var o=e.updateQueue;Ai=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=o.baseState;for(a=0,d=c=l=null,s=i;;){var p=s.lane,h=s.eventTime;if((r&p)===p){null!==d&&(d=d.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,g=s;switch(p=t,h=n,g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(h,u,p);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=g.payload)?f.call(h,u,p):f)||void 0===p)break e;u=P({},u,p);break e;case 2:Ai=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=h,l=u):d=d.next=h,a|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===d&&(l=u),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=d,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Al|=a,e.lanes=a,e.memoizedState=u}}function Ni(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(i(191,o));o.call(r)}}}var Ui={},Vi=wo(Ui),Wi=wo(Ui),Hi=wo(Ui);function Gi(e){if(e===Ui)throw Error(i(174));return e}function Xi(e,t){switch(ko(Hi,t),ko(Wi,e),ko(Vi,Ui),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}So(Vi),ko(Vi,t)}function Yi(){So(Vi),So(Wi),So(Hi)}function qi(e){Gi(Hi.current);var t=Gi(Vi.current),n=le(t,e.type);t!==n&&(ko(Wi,e),ko(Vi,n))}function Zi(e){Wi.current===e&&(So(Vi),So(Wi))}var $i=wo(0);function Ki(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ji=[];function Qi(){for(var e=0;e<Ji.length;e++)Ji[e]._workInProgressVersionPrimary=null;Ji.length=0}var ea=b.ReactCurrentDispatcher,ta=b.ReactCurrentBatchConfig,na=0,ra=null,oa=null,ia=null,aa=!1,sa=!1,la=0,ca=0;function da(){throw Error(i(321))}function ua(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rr(e[n],t[n]))return!1;return!0}function pa(e,t,n,r,o,a){if(na=a,ra=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ea.current=null===e||null===e.memoizedState?Za:$a,e=n(r,o),sa){a=0;do{if(sa=!1,la=0,25<=a)throw Error(i(301));a+=1,ia=oa=null,t.updateQueue=null,ea.current=Ka,e=n(r,o)}while(sa)}if(ea.current=qa,t=null!==oa&&null!==oa.next,na=0,ia=oa=ra=null,aa=!1,t)throw Error(i(300));return e}function ha(){var e=0!==la;return la=0,e}function fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ia?ra.memoizedState=ia=e:ia=ia.next=e,ia}function ga(){if(null===oa){var e=ra.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===ia?ra.memoizedState:ia.next;if(null!==t)ia=t,oa=e;else{if(null===e)throw Error(i(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===ia?ra.memoizedState=ia=e:ia=ia.next=e}return ia}function ma(e,t){return"function"===typeof t?t(e):t}function va(e){var t=ga(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=oa,o=r.baseQueue,a=n.pending;if(null!==a){if(null!==o){var s=o.next;o.next=a.next,a.next=s}r.baseQueue=o=a,n.pending=null}if(null!==o){a=o.next,r=r.baseState;var l=s=null,c=null,d=a;do{var u=d.lane;if((na&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=p,s=r):c=c.next=p,ra.lanes|=u,Al|=u}d=d.next}while(null!==d&&d!==a);null===c?s=r:c.next=l,rr(r,t.memoizedState)||(gs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{a=o.lane,ra.lanes|=a,Al|=a,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ya(e){var t=ga(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{a=e(a,s.action),s=s.next}while(s!==o);rr(a,t.memoizedState)||(gs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function xa(){}function ba(e,t){var n=ra,r=ga(),o=t(),a=!rr(r.memoizedState,o);if(a&&(r.memoizedState=o,gs=!0),r=r.queue,Aa(ka.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ia&&1&ia.memoizedState.tag){if(n.flags|=2048,Ea(9,Sa.bind(null,n,r,o,t),void 0,null),null===jl)throw Error(i(349));0!==(30&na)||wa(n,t,o)}return o}function wa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ra.updateQueue)?(t={lastEffect:null,stores:null},ra.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Sa(e,t,n,r){t.value=n,t.getSnapshot=r,Ca(t)&&ja(e)}function ka(e,t,n){return n(function(){Ca(t)&&ja(e)})}function Ca(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rr(e,n)}catch(r){return!0}}function ja(e){var t=Ii(e,1);null!==t&&Jl(t,e,1,-1)}function _a(e){var t=fa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:e},t.queue=e,e=e.dispatch=Ha.bind(null,ra,e),[t.memoizedState,e]}function Ea(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ra.updateQueue)?(t={lastEffect:null,stores:null},ra.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Da(){return ga().memoizedState}function Ma(e,t,n,r){var o=fa();ra.flags|=e,o.memoizedState=Ea(1|t,n,void 0,void 0===r?null:r)}function Ta(e,t,n,r){var o=ga();r=void 0===r?null:r;var i=void 0;if(null!==oa){var a=oa.memoizedState;if(i=a.destroy,null!==r&&ua(r,a.deps))return void(o.memoizedState=Ea(t,n,i,r))}ra.flags|=e,o.memoizedState=Ea(1|t,n,i,r)}function Ia(e,t){return Ma(8390656,8,e,t)}function Aa(e,t){return Ta(2048,8,e,t)}function Oa(e,t){return Ta(4,2,e,t)}function Ra(e,t){return Ta(4,4,e,t)}function za(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ta(4,4,za.bind(null,t,e),n)}function Pa(){}function Ba(e,t){var n=ga();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ua(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function La(e,t){var n=ga();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ua(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Na(e,t,n){return 0===(21&na)?(e.baseState&&(e.baseState=!1,gs=!0),e.memoizedState=n):(rr(n,t)||(n=ft(),ra.lanes|=n,Al|=n,e.baseState=!0),t)}function Ua(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=ta.transition;ta.transition={};try{e(!1),t()}finally{yt=n,ta.transition=r}}function Va(){return ga().memoizedState}function Wa(e,t,n){var r=Kl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ga(e))Xa(t,n);else if(null!==(n=Ti(e,t,n,r))){Jl(n,e,r,$l()),Ya(n,t,r)}}function Ha(e,t,n){var r=Kl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ga(e))Xa(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,rr(s,a)){var l=t.interleaved;return null===l?(o.next=o,Mi(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(c){}null!==(n=Ti(e,t,o,r))&&(Jl(n,e,r,o=$l()),Ya(n,t,r))}}function Ga(e){var t=e.alternate;return e===ra||null!==t&&t===ra}function Xa(e,t){sa=aa=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ya(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var qa={readContext:Ei,useCallback:da,useContext:da,useEffect:da,useImperativeHandle:da,useInsertionEffect:da,useLayoutEffect:da,useMemo:da,useReducer:da,useRef:da,useState:da,useDebugValue:da,useDeferredValue:da,useTransition:da,useMutableSource:da,useSyncExternalStore:da,useId:da,unstable_isNewReconciler:!1},Za={readContext:Ei,useCallback:function(e,t){return fa().memoizedState=[e,void 0===t?null:t],e},useContext:Ei,useEffect:Ia,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ma(4194308,4,za.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ma(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ma(4,2,e,t)},useMemo:function(e,t){var n=fa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=fa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Wa.bind(null,ra,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},fa().memoizedState=e},useState:_a,useDebugValue:Pa,useDeferredValue:function(e){return fa().memoizedState=e},useTransition:function(){var e=_a(!1),t=e[0];return e=Ua.bind(null,e[1]),fa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ra,o=fa();if(ti){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===jl)throw Error(i(349));0!==(30&na)||wa(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,Ia(ka.bind(null,r,a,e),[e]),r.flags|=2048,Ea(9,Sa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=fa(),t=jl.identifierPrefix;if(ti){var n=qo;t=":"+t+"R"+(n=(Yo&~(1<<32-it(Yo)-1)).toString(32)+n),0<(n=la++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ca++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$a={readContext:Ei,useCallback:Ba,useContext:Ei,useEffect:Aa,useImperativeHandle:Fa,useInsertionEffect:Oa,useLayoutEffect:Ra,useMemo:La,useReducer:va,useRef:Da,useState:function(){return va(ma)},useDebugValue:Pa,useDeferredValue:function(e){return Na(ga(),oa.memoizedState,e)},useTransition:function(){return[va(ma)[0],ga().memoizedState]},useMutableSource:xa,useSyncExternalStore:ba,useId:Va,unstable_isNewReconciler:!1},Ka={readContext:Ei,useCallback:Ba,useContext:Ei,useEffect:Aa,useImperativeHandle:Fa,useInsertionEffect:Oa,useLayoutEffect:Ra,useMemo:La,useReducer:ya,useRef:Da,useState:function(){return ya(ma)},useDebugValue:Pa,useDeferredValue:function(e){var t=ga();return null===oa?t.memoizedState=e:Na(t,oa.memoizedState,e)},useTransition:function(){return[ya(ma)[0],ga().memoizedState]},useMutableSource:xa,useSyncExternalStore:ba,useId:Va,unstable_isNewReconciler:!1};function Ja(e,t){if(e&&e.defaultProps){for(var n in t=P({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function Qa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:P({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var es={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$l(),o=Kl(e),i=zi(r,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Fi(e,i,o))&&(Jl(t,e,o,r),Pi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$l(),o=Kl(e),i=zi(r,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Fi(e,i,o))&&(Jl(t,e,o,r),Pi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$l(),r=Kl(e),o=zi(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Fi(e,o,r))&&(Jl(t,e,r,n),Pi(t,e,r))}};function ts(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!or(n,r)||!or(o,i))}function ns(e,t,n){var r=!1,o=Co,i=t.contextType;return"object"===typeof i&&null!==i?i=Ei(i):(o=Mo(t)?Eo:jo.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Do(e,o):Co),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=es,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function rs(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&es.enqueueReplaceState(t,t.state,null)}function os(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=Ei(i):(i=Mo(t)?Eo:jo.current,o.context=Do(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Qa(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&es.enqueueReplaceState(o,o.state,null),Li(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function is(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function as(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ls="function"===typeof WeakMap?WeakMap:Map;function cs(e,t,n){(n=zi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Nl||(Nl=!0,Ul=r),ss(0,t)},n}function ds(e,t,n){(n=zi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ss(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ss(0,t),"function"!==typeof r&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function us(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ls;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=wc.bind(null,e,t,n),t.then(e,e))}function ps(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function hs(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zi(-1,1)).tag=2,Fi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var fs=b.ReactCurrentOwner,gs=!1;function ms(e,t,n,r){t.child=null===e?yi(t,null,n,r):vi(t,e.child,n,r)}function vs(e,t,n,r,o){n=n.render;var i=t.ref;return _i(t,o),r=pa(e,t,n,r,i,o),n=ha(),null===e||gs?(ti&&n&&Ko(t),t.flags|=1,ms(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ns(e,t,o))}function ys(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Tc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,xs(e,t,i,r,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:or)(a,r)&&e.ref===t.ref)return Ns(e,t,o)}return t.flags|=1,(e=Mc(i,r)).ref=t.ref,e.return=t,t.child=e}function xs(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(or(i,r)&&e.ref===t.ref){if(gs=!1,t.pendingProps=r=i,0===(e.lanes&o))return t.lanes=e.lanes,Ns(e,t,o);0!==(131072&e.flags)&&(gs=!0)}}return Ss(e,t,n,r,o)}function bs(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ko(Ml,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ko(Ml,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,ko(Ml,Dl),Dl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,ko(Ml,Dl),Dl|=r;return ms(e,t,o,n),t.child}function ws(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ss(e,t,n,r,o){var i=Mo(n)?Eo:jo.current;return i=Do(t,i),_i(t,o),n=pa(e,t,n,r,i,o),r=ha(),null===e||gs?(ti&&r&&Ko(t),t.flags|=1,ms(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ns(e,t,o))}function ks(e,t,n,r,o){if(Mo(n)){var i=!0;Oo(t)}else i=!1;if(_i(t,o),null===t.stateNode)Ls(e,t),ns(t,n,r),os(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ei(c):c=Do(t,c=Mo(n)?Eo:jo.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==c)&&rs(t,a,r,c),Ai=!1;var p=t.memoizedState;a.state=p,Li(t,r,a,o),l=t.memoizedState,s!==r||p!==l||_o.current||Ai?("function"===typeof d&&(Qa(t,n,d,r),l=t.memoizedState),(s=Ai||ts(t,n,s,r,p,l,c))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ri(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Ja(t.type,s),a.props=c,u=t.pendingProps,p=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ei(l):l=Do(t,l=Mo(n)?Eo:jo.current);var h=n.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==u||p!==l)&&rs(t,a,r,l),Ai=!1,p=t.memoizedState,a.state=p,Li(t,r,a,o);var f=t.memoizedState;s!==u||p!==f||_o.current||Ai?("function"===typeof h&&(Qa(t,n,h,r),f=t.memoizedState),(c=Ai||ts(t,n,c,r,p,f,l)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Cs(e,t,n,r,i,o)}function Cs(e,t,n,r,o,i){ws(e,t);var a=0!==(128&t.flags);if(!r&&!a)return o&&Ro(t,n,!1),Ns(e,t,i);r=t.stateNode,fs.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=vi(t,e.child,null,i),t.child=vi(t,null,s,i)):ms(e,t,s,i),t.memoizedState=r.state,o&&Ro(t,n,!0),t.child}function js(e){var t=e.stateNode;t.pendingContext?Io(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Io(0,t.context,!1),Xi(e,t.containerInfo)}function _s(e,t,n,r,o){return di(),ui(o),t.flags|=256,ms(e,t,n,r),t.child}var Es,Ds,Ms,Ts,Is={dehydrated:null,treeContext:null,retryLane:0};function As(e){return{baseLanes:e,cachePool:null,transitions:null}}function Os(e,t,n){var r,o=t.pendingProps,a=$i.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),ko($i,1&a),null===e)return ai(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Ac(l,o,0,null),e=Ic(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=As(n),t.memoizedState=Is,e):Rs(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,o,a,s){if(n)return 256&t.flags?(t.flags&=-257,zs(e,t,s,r=as(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=Ac({mode:"visible",children:r.children},o,0,null),(a=Ic(a,o,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&vi(t,e.child,null,s),t.child.memoizedState=As(s),t.memoizedState=Is,a);if(0===(1&t.mode))return zs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,zs(e,t,s,r=as(a=Error(i(419)),r,void 0))}if(l=0!==(s&e.childLanes),gs||l){if(null!==(r=jl)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Ii(e,o),Jl(r,e,o,-1))}return uc(),zs(e,t,s,r=as(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=kc.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,ei=io(o.nextSibling),Qo=t,ti=!0,ni=null,null!==e&&(Ho[Go++]=Yo,Ho[Go++]=qo,Ho[Go++]=Xo,Yo=e.id,qo=e.overflow,Xo=t),t=Rs(t,r.children),t.flags|=4096,t)}(e,t,l,o,r,a,n);if(s){s=o.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&l)&&t.child!==a?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Mc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Mc(r,s):(s=Ic(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?As(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Is,o}return e=(s=e.child).sibling,o=Mc(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Rs(e,t){return(t=Ac({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){return null!==r&&ui(r),vi(t,e.child,null,n),(e=Rs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ji(e.return,t,n)}function Ps(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Bs(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(ms(e,t,r.children,n),0!==(2&(r=$i.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fs(e,n,t);else if(19===e.tag)Fs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ko($i,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Ki(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ps(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Ki(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ps(t,!0,n,null,i);break;case"together":Ps(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ls(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ns(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Al|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Us(e,t){if(!ti)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Vs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ws(e,t,n){var r=t.pendingProps;switch(Jo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vs(t),null;case 1:case 17:return Mo(t.type)&&To(),Vs(t),null;case 3:return r=t.stateNode,Yi(),So(_o),So(jo),Qi(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(li(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ni&&(nc(ni),ni=null))),Ds(e,t),Vs(t),null;case 5:Zi(t);var o=Gi(Hi.current);if(n=t.type,null!==e&&null!=t.stateNode)Ms(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Vs(t),null}if(e=Gi(Vi.current),li(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[lo]=t,r[co]=a,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(o=0;o<Ir.length;o++)zr(Ir[o],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":$(r,a),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},zr("invalid",r);break;case"textarea":oe(r,a),zr("invalid",r)}for(var l in ve(n,a),o=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&qr(r.textContent,c,e),o=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&qr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":X(r),Q(r,a,!0);break;case"textarea":X(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[lo]=t,e[co]=r,Es(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":zr("cancel",e),zr("close",e),o=r;break;case"iframe":case"object":case"embed":zr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Ir.length;o++)zr(Ir[o],e);o=r;break;case"source":zr("error",e),o=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),o=r;break;case"details":zr("toggle",e),o=r;break;case"input":$(e,r),o=Z(e,r),zr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=P({},r,{value:void 0}),zr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),zr("invalid",e)}for(a in ve(n,o),c=o)if(c.hasOwnProperty(a)){var d=c[a];"style"===a?ge(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&de(e,d):"children"===a?"string"===typeof d?("textarea"!==n||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=d&&"onScroll"===a&&zr("scroll",e):null!=d&&x(e,a,d,l))}switch(n){case"input":X(e),Q(e,r,!1);break;case"textarea":X(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vs(t),null;case 6:if(e&&null!=t.stateNode)Ts(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Gi(Hi.current),Gi(Vi.current),li(t)){if(r=t.stateNode,n=t.memoizedProps,r[lo]=t,(a=r.nodeValue!==n)&&null!==(e=Qo))switch(e.tag){case 3:qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[lo]=t,t.stateNode=r}return Vs(t),null;case 13:if(So($i),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ti&&null!==ei&&0!==(1&t.mode)&&0===(128&t.flags))ci(),di(),t.flags|=98560,a=!1;else if(a=li(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[lo]=t}else di(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vs(t),a=!1}else null!==ni&&(nc(ni),ni=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$i.current)?0===Tl&&(Tl=3):uc())),null!==t.updateQueue&&(t.flags|=4),Vs(t),null);case 4:return Yi(),Ds(e,t),null===e&&Br(t.stateNode.containerInfo),Vs(t),null;case 10:return Ci(t.type._context),Vs(t),null;case 19:if(So($i),null===(a=t.memoizedState))return Vs(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Us(a,!1);else{if(0!==Tl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=Ki(e))){for(t.flags|=128,Us(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ko($i,1&$i.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Bl&&(t.flags|=128,r=!0,Us(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Ki(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Us(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ti)return Vs(t),null}else 2*$e()-a.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Us(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=$i.current,ko($i,r?1&n|2:1&n),t):(Vs(t),null);case 22:case 23:return sc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Vs(t),6&t.subtreeFlags&&(t.flags|=8192)):Vs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Hs(e,t){switch(Jo(t),t.tag){case 1:return Mo(t.type)&&To(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yi(),So(_o),So(jo),Qi(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(So($i),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));di()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return So($i),null;case 4:return Yi(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return sc(),null;default:return null}}Es=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(){},Ms=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Gi(Vi.current);var i,a=null;switch(n){case"input":o=Z(e,o),r=Z(e,r),a=[];break;case"select":o=P({},o,{value:void 0}),r=P({},r,{value:void 0}),a=[];break;case"textarea":o=re(e,o),r=re(e,r),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ve(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var l=o[d];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&zr("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(t.updateQueue=d)&&(t.flags|=4)}},Ts=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Xs=!1,Ys="function"===typeof WeakSet?WeakSet:Set,qs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){bc(e,t,r)}else n.current=null}function $s(e,t,n){try{n()}catch(r){bc(e,t,r)}}var Ks=!1;function Js(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&$s(t,n,i)}o=o.next}while(o!==r)}}function Qs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function el(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function tl(e){var t=e.alternate;null!==t&&(e.alternate=null,tl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[lo],delete t[co],delete t[po],delete t[ho],delete t[fo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nl(e){return 5===e.tag||3===e.tag||4===e.tag}function rl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ol(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ol(e,t,n),e=e.sibling;null!==e;)ol(e,t,n),e=e.sibling}function il(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(il(e,t,n),e=e.sibling;null!==e;)il(e,t,n),e=e.sibling}var al=null,sl=!1;function ll(e,t,n){for(n=n.child;null!==n;)cl(e,t,n),n=n.sibling}function cl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:Xs||Zs(n,t);case 6:var r=al,o=sl;al=null,ll(e,t,n),sl=o,null!==(al=r)&&(sl?(e=al,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):al.removeChild(n.stateNode));break;case 18:null!==al&&(sl?(e=al,n=n.stateNode,8===e.nodeType?oo(e.parentNode,n):1===e.nodeType&&oo(e,n),Ut(e)):oo(al,n.stateNode));break;case 4:r=al,o=sl,al=n.stateNode.containerInfo,sl=!0,ll(e,t,n),al=r,sl=o;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&$s(n,t,a),o=o.next}while(o!==r)}ll(e,t,n);break;case 1:if(!Xs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){bc(n,t,s)}ll(e,t,n);break;case 21:ll(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,ll(e,t,n),Xs=r):ll(e,t,n);break;default:ll(e,t,n)}}function dl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach(function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ul(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:al=l.stateNode,sl=!1;break e;case 3:case 4:al=l.stateNode.containerInfo,sl=!0;break e}l=l.return}if(null===al)throw Error(i(160));cl(a,s,o),al=null,sl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(d){bc(o,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}function pl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ul(t,e),hl(e),4&r){try{Js(3,e,e.return),Qs(3,e)}catch(m){bc(e,e.return,m)}try{Js(5,e,e.return)}catch(m){bc(e,e.return,m)}}break;case 1:ul(t,e),hl(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(ul(t,e),hl(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{ue(o,"")}catch(m){bc(e,e.return,m)}}if(4&r&&null!=(o=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&K(o,a),ye(l,s);var d=ye(l,a);for(s=0;s<c.length;s+=2){var u=c[s],p=c[s+1];"style"===u?ge(o,p):"dangerouslySetInnerHTML"===u?de(o,p):"children"===u?ue(o,p):x(o,u,p,d)}switch(l){case"input":J(o,a);break;case"textarea":ie(o,a);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(o,!!a.multiple,f,!1):h!==!!a.multiple&&(null!=a.defaultValue?ne(o,!!a.multiple,a.defaultValue,!0):ne(o,!!a.multiple,a.multiple?[]:"",!1))}o[co]=a}catch(m){bc(e,e.return,m)}}break;case 6:if(ul(t,e),hl(e),4&r){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(m){bc(e,e.return,m)}}break;case 3:if(ul(t,e),hl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){bc(e,e.return,m)}break;case 4:default:ul(t,e),hl(e);break;case 13:ul(t,e),hl(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Pl=$e())),4&r&&dl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(d=Xs)||u,ul(t,e),Xs=d):ul(t,e),hl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(qs=e,u=e.child;null!==u;){for(p=qs=u;null!==qs;){switch(f=(h=qs).child,h.tag){case 0:case 11:case 14:case 15:Js(4,h,h.return);break;case 1:Zs(h,h.return);var g=h.stateNode;if("function"===typeof g.componentWillUnmount){r=h,n=h.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){bc(r,n,m)}}break;case 5:Zs(h,h.return);break;case 22:if(null!==h.memoizedState){vl(p);continue}}null!==f?(f.return=h,qs=f):vl(p)}u=u.sibling}e:for(u=null,p=e;;){if(5===p.tag){if(null===u){u=p;try{o=p.stateNode,d?"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",s))}catch(m){bc(e,e.return,m)}}}else if(6===p.tag){if(null===u)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(m){bc(e,e.return,m)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ul(t,e),hl(e),4&r&&dl(e);case 21:}}function hl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(nl(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(ue(o,""),r.flags&=-33),il(e,rl(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;ol(e,rl(e),a);break;default:throw Error(i(161))}}catch(s){bc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function fl(e,t,n){qs=e,gl(e,t,n)}function gl(e,t,n){for(var r=0!==(1&e.mode);null!==qs;){var o=qs,i=o.child;if(22===o.tag&&r){var a=null!==o.memoizedState||Gs;if(!a){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Gs;var c=Xs;if(Gs=a,(Xs=l)&&!c)for(qs=o;null!==qs;)l=(a=qs).child,22===a.tag&&null!==a.memoizedState?yl(o):null!==l?(l.return=a,qs=l):yl(o);for(;null!==i;)qs=i,gl(i,t,n),i=i.sibling;qs=o,Gs=s,Xs=c}ml(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,qs=i):ml(e)}}function ml(e){for(;null!==qs;){var t=qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||Qs(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Ja(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ni(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ni(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var p=u.dehydrated;null!==p&&Ut(p)}}}break;default:throw Error(i(163))}Xs||512&t.flags&&el(t)}catch(h){bc(t,t.return,h)}}if(t===e){qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,qs=n;break}qs=t.return}}function vl(e){for(;null!==qs;){var t=qs;if(t===e){qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,qs=n;break}qs=t.return}}function yl(e){for(;null!==qs;){var t=qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Qs(4,t)}catch(l){bc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(l){bc(t,o,l)}}var i=t.return;try{el(t)}catch(l){bc(t,i,l)}break;case 5:var a=t.return;try{el(t)}catch(l){bc(t,a,l)}}}catch(l){bc(t,t.return,l)}if(t===e){qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,qs=s;break}qs=t.return}}var xl,bl=Math.ceil,wl=b.ReactCurrentDispatcher,Sl=b.ReactCurrentOwner,kl=b.ReactCurrentBatchConfig,Cl=0,jl=null,_l=null,El=0,Dl=0,Ml=wo(0),Tl=0,Il=null,Al=0,Ol=0,Rl=0,zl=null,Fl=null,Pl=0,Bl=1/0,Ll=null,Nl=!1,Ul=null,Vl=null,Wl=!1,Hl=null,Gl=0,Xl=0,Yl=null,ql=-1,Zl=0;function $l(){return 0!==(6&Cl)?$e():-1!==ql?ql:ql=$e()}function Kl(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==El?El&-El:null!==pi.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function Jl(e,t,n,r){if(50<Xl)throw Xl=0,Yl=null,Error(i(185));mt(e,n,r),0!==(2&Cl)&&e===jl||(e===jl&&(0===(2&Cl)&&(Ol|=n),4===Tl&&rc(e,El)),Ql(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(Bl=$e()+500,Fo&&Lo()))}function Ql(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-it(i),s=1<<a,l=o[a];-1===l?0!==(s&n)&&0===(s&r)||(o[a]=pt(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ut(e,e===jl?El:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Fo=!0,Bo(e)}(oc.bind(null,e)):Bo(oc.bind(null,e)),no(function(){0===(6&Cl)&&Lo()}),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=Qe;break;case 16:default:n=et;break;case 536870912:n=nt}n=jc(n,ec.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ec(e,t){if(ql=-1,Zl=0,0!==(6&Cl))throw Error(i(327));var n=e.callbackNode;if(yc()&&e.callbackNode!==n)return null;var r=ut(e,e===jl?El:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=pc(e,r);else{t=r;var o=Cl;Cl|=2;var a=dc();for(jl===e&&El===t||(Ll=null,Bl=$e()+500,lc(e,t));;)try{fc();break}catch(l){cc(e,l)}ki(),wl.current=a,Cl=o,null!==_l?t=0:(jl=null,El=0,t=Tl)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(r=o,t=tc(e,o))),1===t)throw n=Il,lc(e,0),rc(e,r),Ql(e,$e()),n;if(6===t)rc(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!rr(i(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=pc(e,r))&&(0!==(a=ht(e))&&(r=a,t=tc(e,a))),1===t))throw n=Il,lc(e,0),rc(e,r),Ql(e,$e()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:vc(e,Fl,Ll);break;case 3:if(rc(e,r),(130023424&r)===r&&10<(t=Pl+500-$e())){if(0!==ut(e,0))break;if(((o=e.suspendedLanes)&r)!==r){$l(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Qr(vc.bind(null,e,Fl,Ll),t);break}vc(e,Fl,Ll);break;case 4:if(rc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-it(r);a=1<<s,(s=t[s])>o&&(o=s),r&=~a}if(r=o,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bl(r/1960))-r)){e.timeoutHandle=Qr(vc.bind(null,e,Fl,Ll),r);break}vc(e,Fl,Ll);break;default:throw Error(i(329))}}}return Ql(e,$e()),e.callbackNode===n?ec.bind(null,e):null}function tc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(lc(e,t).flags|=256),2!==(e=pc(e,t))&&(t=Fl,Fl=n,null!==t&&nc(t)),e}function nc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function rc(e,t){for(t&=~Rl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function oc(e){if(0!==(6&Cl))throw Error(i(327));yc();var t=ut(e,0);if(0===(1&t))return Ql(e,$e()),null;var n=pc(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=tc(e,r))}if(1===n)throw n=Il,lc(e,0),rc(e,t),Ql(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vc(e,Fl,Ll),Ql(e,$e()),null}function ic(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Bl=$e()+500,Fo&&Lo())}}function ac(e){null!==Hl&&0===Hl.tag&&0===(6&Cl)&&yc();var t=Cl;Cl|=1;var n=kl.transition,r=yt;try{if(kl.transition=null,yt=1,e)return e()}finally{yt=r,kl.transition=n,0===(6&(Cl=t))&&Lo()}}function sc(){Dl=Ml.current,So(Ml)}function lc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,eo(n)),null!==_l)for(n=_l.return;null!==n;){var r=n;switch(Jo(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&To();break;case 3:Yi(),So(_o),So(jo),Qi();break;case 5:Zi(r);break;case 4:Yi();break;case 13:case 19:So($i);break;case 10:Ci(r.type._context);break;case 22:case 23:sc()}n=n.return}if(jl=e,_l=e=Mc(e.current,null),El=Dl=t,Tl=0,Il=null,Rl=Ol=Al=0,Fl=zl=null,null!==Di){for(t=0;t<Di.length;t++)if(null!==(r=(n=Di[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=o,r.next=a}n.pending=r}Di=null}return e}function cc(e,t){for(;;){var n=_l;try{if(ki(),ea.current=qa,aa){for(var r=ra.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}aa=!1}if(na=0,ia=oa=ra=null,sa=!1,la=0,Sl.current=null,null===n||null===n.return){Tl=1,Il=t,_l=null;break}e:{var a=e,s=n.return,l=n,c=t;if(t=El,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,p=u.tag;if(0===(1&u.mode)&&(0===p||11===p||15===p)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=ps(s);if(null!==f){f.flags&=-257,hs(f,s,l,0,t),1&f.mode&&us(a,d,t),c=d;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){us(a,d,t),uc();break e}c=Error(i(426))}else if(ti&&1&l.mode){var v=ps(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),hs(v,s,l,0,t),ui(is(c,l));break e}}a=c=is(c,l),4!==Tl&&(Tl=2),null===zl?zl=[a]:zl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bi(a,cs(0,c,t));break e;case 1:l=c;var y=a.type,x=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Vl||!Vl.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t,Bi(a,ds(a,l,t));break e}}a=a.return}while(null!==a)}mc(n)}catch(b){t=b,_l===n&&null!==n&&(_l=n=n.return);continue}break}}function dc(){var e=wl.current;return wl.current=qa,null===e?qa:e}function uc(){0!==Tl&&3!==Tl&&2!==Tl||(Tl=4),null===jl||0===(268435455&Al)&&0===(268435455&Ol)||rc(jl,El)}function pc(e,t){var n=Cl;Cl|=2;var r=dc();for(jl===e&&El===t||(Ll=null,lc(e,t));;)try{hc();break}catch(o){cc(e,o)}if(ki(),Cl=n,wl.current=r,null!==_l)throw Error(i(261));return jl=null,El=0,Tl}function hc(){for(;null!==_l;)gc(_l)}function fc(){for(;null!==_l&&!qe();)gc(_l)}function gc(e){var t=xl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?mc(e):_l=t,Sl.current=null}function mc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ws(n,t,Dl)))return void(_l=n)}else{if(null!==(n=Hs(n,t)))return n.flags&=32767,void(_l=n);if(null===e)return Tl=6,void(_l=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(_l=t);_l=t=e}while(null!==t);0===Tl&&(Tl=5)}function vc(e,t,n){var r=yt,o=kl.transition;try{kl.transition=null,yt=1,function(e,t,n,r){do{yc()}while(null!==Hl);if(0!==(6&Cl))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-it(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,a),e===jl&&(_l=jl=null,El=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,jc(et,function(){return yc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=kl.transition,kl.transition=null;var s=yt;yt=1;var l=Cl;Cl|=4,Sl.current=null,function(e,t){if($r=Wt,cr(e=lr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var s=0,l=-1,c=-1,d=0,u=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==o&&3!==p.nodeType||(l=s+o),p!==a||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++d===o&&(l=s),h===a&&++u===r&&(c=s),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kr={focusedElem:e,selectionRange:n},Wt=!1,qs=t;null!==qs;)if(e=(t=qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,qs=e;else for(;null!==qs;){t=qs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ja(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(w){bc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,qs=e;break}qs=t.return}g=Ks,Ks=!1}(e,n),pl(n,e),dr(Kr),Wt=!!$r,Kr=$r=null,e.current=n,fl(n,e,o),Ze(),Cl=l,yt=s,kl.transition=a}else e.current=n;if(Wl&&(Wl=!1,Hl=e,Gl=o),a=e.pendingLanes,0===a&&(Vl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),Ql(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Nl)throw Nl=!1,e=Ul,Ul=null,e;0!==(1&Gl)&&0!==e.tag&&yc(),a=e.pendingLanes,0!==(1&a)?e===Yl?Xl++:(Xl=0,Yl=e):Xl=0,Lo()}(e,t,n,r)}finally{kl.transition=o,yt=r}return null}function yc(){if(null!==Hl){var e=xt(Gl),t=kl.transition,n=yt;try{if(kl.transition=null,yt=16>e?16:e,null===Hl)var r=!1;else{if(e=Hl,Hl=null,Gl=0,0!==(6&Cl))throw Error(i(331));var o=Cl;for(Cl|=4,qs=e.current;null!==qs;){var a=qs,s=a.child;if(0!==(16&qs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(qs=d;null!==qs;){var u=qs;switch(u.tag){case 0:case 11:case 15:Js(8,u,a)}var p=u.child;if(null!==p)p.return=u,qs=p;else for(;null!==qs;){var h=(u=qs).sibling,f=u.return;if(tl(u),u===d){qs=null;break}if(null!==h){h.return=f,qs=h;break}qs=f}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,qs=s;else e:for(;null!==qs;){if(0!==(2048&(a=qs).flags))switch(a.tag){case 0:case 11:case 15:Js(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,qs=y;break e}qs=a.return}}var x=e.current;for(qs=x;null!==qs;){var b=(s=qs).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,qs=b;else e:for(s=x;null!==qs;){if(0!==(2048&(l=qs).flags))try{switch(l.tag){case 0:case 11:case 15:Qs(9,l)}}catch(S){bc(l,l.return,S)}if(l===s){qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,qs=w;break e}qs=l.return}}if(Cl=o,Lo(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(S){}r=!0}return r}finally{yt=n,kl.transition=t}}return!1}function xc(e,t,n){e=Fi(e,t=cs(0,t=is(n,t),1),1),t=$l(),null!==e&&(mt(e,1,t),Ql(e,t))}function bc(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Vl||!Vl.has(r))){t=Fi(t,e=ds(t,e=is(n,e),1),1),e=$l(),null!==t&&(mt(t,1,e),Ql(t,e));break}}t=t.return}}function wc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=$l(),e.pingedLanes|=e.suspendedLanes&n,jl===e&&(El&n)===n&&(4===Tl||3===Tl&&(130023424&El)===El&&500>$e()-Pl?lc(e,0):Rl|=n),Ql(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=$l();null!==(e=Ii(e,t))&&(mt(e,t,n),Ql(e,n))}function kc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Sc(e,n)}function jc(e,t){return Xe(e,t)}function _c(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ec(e,t,n,r){return new _c(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Ec(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Tc(e,t,n,r,o,a){var s=2;if(r=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Ic(n.children,o,a,t);case C:s=8,o|=8;break;case j:return(e=Ec(12,n,t,2|o)).elementType=j,e.lanes=a,e;case M:return(e=Ec(13,n,t,o)).elementType=M,e.lanes=a,e;case T:return(e=Ec(19,n,t,o)).elementType=T,e.lanes=a,e;case O:return Ac(n,o,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case E:s=9;break e;case D:s=11;break e;case I:s=14;break e;case A:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ec(s,n,t,o)).elementType=e,t.type=r,t.lanes=a,t}function Ic(e,t,n,r){return(e=Ec(7,e,r,t)).lanes=n,e}function Ac(e,t,n,r){return(e=Ec(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Ec(6,e,null,t)).lanes=n,e}function Rc(e,t,n){return(t=Ec(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,o,i,a,s,l){return e=new zc(e,t,n,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ec(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Pc(e){if(!e)return Co;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Mo(n))return Ao(e,n,t)}return t}function Bc(e,t,n,r,o,i,a,s,l){return(e=Fc(n,r,!0,e,0,i,0,s,l)).context=Pc(null),n=e.current,(i=zi(r=$l(),o=Kl(n))).callback=void 0!==t&&null!==t?t:null,Fi(n,i,o),e.current.lanes=o,mt(e,o,r),Ql(e,r),e}function Lc(e,t,n,r){var o=t.current,i=$l(),a=Kl(o);return n=Pc(n),null===t.context?t.context=n:t.pendingContext=n,(t=zi(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Fi(o,t,a))&&(Jl(e,o,a,i),Pi(e,o,a)),a}function Nc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Uc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vc(e,t){Uc(e,t),(e=e.alternate)&&Uc(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_o.current)gs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return gs=!1,function(e,t,n){switch(t.tag){case 3:js(t),di();break;case 5:qi(t);break;case 1:Mo(t.type)&&Oo(t);break;case 4:Xi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;ko(xi,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ko($i,1&$i.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Os(e,t,n):(ko($i,1&$i.current),null!==(e=Ns(e,t,n))?e.sibling:null);ko($i,1&$i.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),ko($i,$i.current),r)break;return null;case 22:case 23:return t.lanes=0,bs(e,t,n)}return Ns(e,t,n)}(e,t,n);gs=0!==(131072&e.flags)}else gs=!1,ti&&0!==(1048576&t.flags)&&$o(t,Wo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ls(e,t),e=t.pendingProps;var o=Do(t,jo.current);_i(t,n),o=pa(null,t,r,e,o,n);var a=ha();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mo(r)?(a=!0,Oo(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Oi(t),o.updater=es,t.stateNode=o,o._reactInternals=t,os(t,r,e,n),t=Cs(null,t,r,!0,a,n)):(t.tag=0,ti&&a&&Ko(t),ms(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ls(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===D)return 11;if(e===I)return 14}return 2}(r),e=Ja(r,e),o){case 0:t=Ss(null,t,r,e,n);break e;case 1:t=ks(null,t,r,e,n);break e;case 11:t=vs(null,t,r,e,n);break e;case 14:t=ys(null,t,r,Ja(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Ss(e,t,r,o=t.elementType===r?o:Ja(r,o),n);case 1:return r=t.type,o=t.pendingProps,ks(e,t,r,o=t.elementType===r?o:Ja(r,o),n);case 3:e:{if(js(t),null===e)throw Error(i(387));r=t.pendingProps,o=(a=t.memoizedState).element,Ri(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=_s(e,t,r,n,o=is(Error(i(423)),t));break e}if(r!==o){t=_s(e,t,r,n,o=is(Error(i(424)),t));break e}for(ei=io(t.stateNode.containerInfo.firstChild),Qo=t,ti=!0,ni=null,n=yi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(di(),r===o){t=Ns(e,t,n);break e}ms(e,t,r,n)}t=t.child}return t;case 5:return qi(t),null===e&&ai(t),r=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,Jr(r,o)?s=null:null!==a&&Jr(r,a)&&(t.flags|=32),ws(e,t),ms(e,t,s,n),t.child;case 6:return null===e&&ai(t),null;case 13:return Os(e,t,n);case 4:return Xi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=vi(t,null,r,n):ms(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,vs(e,t,r,o=t.elementType===r?o:Ja(r,o),n);case 7:return ms(e,t,t.pendingProps,n),t.child;case 8:case 12:return ms(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,ko(xi,r._currentValue),r._currentValue=s,null!==a)if(rr(a.value,s)){if(a.children===o.children&&!_o.current){t=Ns(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=zi(-1,n&-n)).tag=2;var d=a.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ji(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ji(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ms(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,_i(t,n),r=r(o=Ei(o)),t.flags|=1,ms(e,t,r,n),t.child;case 14:return o=Ja(r=t.type,t.pendingProps),ys(e,t,r,o=Ja(r.type,o),n);case 15:return xs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Ja(r,o),Ls(e,t),t.tag=1,Mo(r)?(e=!0,Oo(t)):e=!1,_i(t,n),ns(t,r,o),os(t,r,o,n),Cs(null,t,r,!0,e,n);case 19:return Bs(e,t,n);case 22:return bs(e,t,n)}throw Error(i(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Hc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function qc(){}function Zc(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof o){var s=o;o=function(){var e=Nc(a);s.call(e)}}Lc(t,a,e,o)}else a=function(e,t,n,r,o){if(o){if("function"===typeof r){var i=r;r=function(){var e=Nc(a);i.call(e)}}var a=Bc(t,r,e,0,null,!1,0,"",qc);return e._reactRootContainer=a,e[uo]=a.current,Br(8===e.nodeType?e.parentNode:e),ac(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=Nc(l);s.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",qc);return e._reactRootContainer=l,e[uo]=l.current,Br(8===e.nodeType?e.parentNode:e),ac(function(){Lc(t,l,n,r)}),l}(n,t,e,o,r);return Nc(a)}Gc.prototype.render=Hc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Lc(e,t,null,null)},Gc.prototype.unmount=Hc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ac(function(){Lc(null,e,null,null)}),t[uo]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Ft(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),Ql(t,$e()),0===(6&Cl)&&(Bl=$e()+500,Lo()))}break;case 13:ac(function(){var t=Ii(e,1);if(null!==t){var n=$l();Jl(t,e,1,n)}}),Vc(e,1)}},wt=function(e){if(13===e.tag){var t=Ii(e,134217728);if(null!==t)Jl(t,e,134217728,$l());Vc(e,134217728)}},St=function(e){if(13===e.tag){var t=Kl(e),n=Ii(e,t);if(null!==n)Jl(n,e,t,$l());Vc(e,t)}},kt=function(){return yt},Ct=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=yo(r);if(!o)throw Error(i(90));Y(r),J(r,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=ic,De=ac;var $c={usingClientEntryPoint:!1,Events:[mo,vo,yo,je,_e,ic]},Kc={findFiberByHostInstance:go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jc={bundleType:Kc.bundleType,version:Kc.version,rendererPackageName:Kc.rendererPackageName,rendererConfig:Kc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:Kc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{rt=Qc.inject(Jc),ot=Qc}catch(ed){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$c,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(i(299));var n=!1,r="",o=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,o),e[uo]=t.current,Br(8===e.nodeType?e.parentNode:e),new Hc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return ac(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,o=!1,a="",s=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,o,0,a,s),e[uo]=t.current,Br(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Gc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(i(40));return!!e._reactRootContainer&&(ac(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[uo]=null})}),!0)},t.unstable_batchedUpdates=ic,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2759:(e,t,n)=>{var r=n(9421),o=n(5652),i=n(9096),a=n(6487),s=n(4052);e.exports=function(e,t,n){var l=s(e)?r:a,c=arguments.length<3;return l(e,i(t,4),n,c,o)}},2761:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2777:(e,t,n)=>{var r=n(5193),o=n(2761),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},2786:(e,t,n)=>{"use strict";var r=n(8208),o=n(5641);e.exports={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),function(t){!function(e,t){var n,r,i,a=t.v,s=e.node(a).rank,l=t.w,c=e.node(l).rank,d=t.name,u=e.edge(t),p=u.labelRank;if(c===s+1)return;for(e.removeEdge(t),i=0,++s;s<c;++i,++s)u.points=[],r={width:0,height:0,edgeLabel:u,edgeObj:t,rank:s},n=o.addDummyNode(e,"edge",r,"_d"),s===p&&(r.width=u.width,r.height=u.height,r.dummy="edge-label",r.labelpos=u.labelpos),e.setEdge(a,n,{weight:u.weight},d),0===i&&e.graph().dummyChains.push(n),a=n;e.setEdge(a,l,{weight:u.weight},d)}(e,t)})},undo:function(e){r.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)})}}},2792:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const r=n.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const n in r)t(r,n)&&(e[n]=r[n])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let r=0,o=e.length;r<o;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,o=0,i=e.length;r<i;r++){let t=e[r];n.set(t,o),o+=t.length}return n}},2816:e=>{"use strict";e.exports=Number.isNaN||function(e){return e!==e}},2866:(e,t,n)=>{var r=n(2969);e.exports=function(e){return function(t){return r(t,e)}}},2929:(e,t,n)=>{var r=n(6552).Uint8Array;e.exports=r},2936:(e,t,n)=>{"use strict";var r=n(7163),o="undefined"===typeof globalThis?n.g:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"===typeof o[r[t]]&&(e[e.length]=r[t]);return e}},2969:(e,t,n)=>{var r=n(5324),o=n(914);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},3028:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},3088:(e,t,n)=>{"use strict";var r=n(8208),o=n(7938).Graph,i=n(5758).slack;function a(e,t){return r.forEach(e.nodes(),function n(o){r.forEach(t.nodeEdges(o),function(r){var a=r.v,s=o===a?r.w:a;e.hasNode(s)||i(t,r)||(e.setNode(s,{}),e.setEdge(o,s,{}),n(s))})}),e.nodeCount()}function s(e,t){return r.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return i(t,n)})}function l(e,t,n){r.forEach(e.nodes(),function(e){t.node(e).rank+=n})}e.exports=function(e){var t,n,r=new o({directed:!1}),c=e.nodes()[0],d=e.nodeCount();r.setNode(c,{});for(;a(r,e)<d;)t=s(r,e),n=r.hasNode(t.v)?i(e,t):-i(e,t),l(r,e,n);return r}},3094:e=>{"use strict";e.exports=URIError},3097:(e,t,n)=>{var r=n(2969);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},3130:(e,t,n)=>{var r=n(8208),o=n(7938).Graph,i=n(6684);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new o,a=0,s=0;r.forEach(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),r.forEach(e.edges(),function(e){var r=n.edge(e.v,e.w)||0,o=t(e),i=r+o;n.setEdge(e.v,e.w,i),s=Math.max(s,n.node(e.v).out+=o),a=Math.max(a,n.node(e.w).in+=o)});var c=r.range(s+a+3).map(function(){return new i}),d=a+1;return r.forEach(n.nodes(),function(e){l(c,d,n.node(e))}),{graph:n,buckets:c,zeroIdx:d}}(e,t||a),c=function(e,t,n){var r,o=[],i=t[t.length-1],a=t[0];for(;e.nodeCount();){for(;r=a.dequeue();)s(e,t,n,r);for(;r=i.dequeue();)s(e,t,n,r);if(e.nodeCount())for(var l=t.length-2;l>0;--l)if(r=t[l].dequeue()){o=o.concat(s(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(c,function(t){return e.outEdges(t.v,t.w)}),!0)};var a=r.constant(1);function s(e,t,n,o,i){var a=i?[]:void 0;return r.forEach(e.inEdges(o.v),function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,l(t,n,s)}),r.forEach(e.outEdges(o.v),function(r){var o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,l(t,n,a)}),e.removeNode(o.v),a}function l(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},3204:(e,t,n)=>{var r=n(3343),o=n(2777),i=n(4052),a=n(4543),s=n(9194),l=n(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),d=!n&&o(e),u=!n&&!d&&a(e),p=!n&&!d&&!u&&l(e),h=n||d||u||p,f=h?r(e.length,String):[],g=f.length;for(var m in e)!t&&!c.call(e,m)||h&&("length"==m||u&&("offset"==m||"parent"==m)||p&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g))||f.push(m);return f}},3211:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},3223:(e,t,n)=>{var r=n(3868),o=n(4353),i=n(8710),a=n(1980),s=n(310),l=n(2777),c=n(4052),d=n(6272),u=n(4543),p=n(1629),h=n(6686),f=n(2322),g=n(1268),m=n(3737),v=n(1609);e.exports=function(e,t,n,y,x,b,w){var S=m(e,n),k=m(t,n),C=w.get(k);if(C)r(e,n,C);else{var j=b?b(S,k,n+"",e,t,w):void 0,_=void 0===j;if(_){var E=c(k),D=!E&&u(k),M=!E&&!D&&g(k);j=k,E||D||M?c(S)?j=S:d(S)?j=a(S):D?(_=!1,j=o(k,!0)):M?(_=!1,j=i(k,!0)):j=[]:f(k)||l(k)?(j=S,l(S)?j=v(S):h(S)&&!p(S)||(j=s(k))):_=!1}_&&(w.set(k,j),x(j,k,y,b,w),w.delete(k)),r(e,n,j)}}},3250:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());e.exports=(e,n,r,o)=>{const i=t,a=o+r;e^=-1;for(let t=o;t<a;t++)e=e>>>8^i[255&(e^n[t])];return-1^e}},3253:(e,t,n)=>{var r=n(5538),o=n(3868),i=n(4258),a=n(3223),s=n(6686),l=n(474),c=n(3737);e.exports=function e(t,n,d,u,p){t!==n&&i(n,function(i,l){if(p||(p=new r),s(i))a(t,n,l,d,e,u,p);else{var h=u?u(c(t,l),i,l+"",t,n,p):void 0;void 0===h&&(h=i),o(t,l,h)}},l)}},3279:e=>{e.exports=function(e){return e}},3290:(e,t,n)=>{"use strict";var r,o=n(8117),i=n(4635)(),a=n(4384),s=n(5558);if(i){var l=o("RegExp.prototype.exec"),c={},d=function(){throw c},u={toString:d,valueOf:d};"symbol"===typeof Symbol.toPrimitive&&(u[Symbol.toPrimitive]=d),r=function(e){if(!e||"object"!==typeof e)return!1;var t=s(e,"lastIndex");if(!(t&&a(t,"value")))return!1;try{l(e,u)}catch(n){return n===c}}}else{var p=o("Object.prototype.toString");r=function(e){return!(!e||"object"!==typeof e&&"function"!==typeof e)&&"[object RegExp]"===p(e)}}e.exports=r},3305:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.resourceHandlersMap=t.resourceHandlers=void 0;var o=n(4445),i=n(8147),a=n(5171),s=n(6302),l=n(2256),c=n(2038);function d(e,n,r,o){var i={key:e,has:n,read:r,write:o};t.resourceHandlers.push(i),t.resourceHandlersMap[i.key]=i}t.resourceHandlers=[],t.resourceHandlersMap={};var u=[void 0,"PPI","PPCM"],p=[void 0,"Inches","Centimeters","Points","Picas","Columns"],h="0123456789abcdef";function f(e){return e<=57?e-48:e-87}function g(e,t){return f(e.charCodeAt(t))<<4|f(e.charCodeAt(t+1))}function m(e,t){var n=(0,i.readBytes)(e,t);return(0,l.decodeString)(n)}function v(e,t){var n=(0,l.encodeString)(t);(0,a.writeBytes)(e,n)}function y(e){for(var t=(0,i.readUint8)(e),n=(0,i.readBytes)(e,t),r=!1,o=0;o<n.byteLength;o++)if(128&n[o]){r=!0;break}return r?new TextDecoder("gbk").decode(n):(0,l.decodeString)(n)}function x(e,t){for(var n="",r=0,o=t.codePointAt(r++);void 0!==o;o=t.codePointAt(r++))n+=o>127?"?":String.fromCodePoint(o);var i=(0,l.encodeString)(n);(0,a.writeUint8)(e,i.byteLength),(0,a.writeBytes)(e,i)}s.MOCK_HANDLERS&&d(1028,function(e){return void 0!==e._ir1028},function(e,t,n){t._ir1028=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1028)}),d(1061,function(e){return void 0!==e.captionDigest},function(e,t){for(var n="",r=0;r<16;r++){var o=(0,i.readUint8)(e);n+=h[o>>4],n+=h[15&o]}t.captionDigest=n},function(e,t){for(var n=0;n<16;n++)(0,a.writeUint8)(e,g(t.captionDigest,2*n))}),d(1060,function(e){return void 0!==e.xmpMetadata},function(e,t,n){t.xmpMetadata=m(e,n())},function(e,t){v(e,t.xmpMetadata)});var b=(0,s.createEnum)("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});s.MOCK_HANDLERS&&d(1085,function(e){return void 0!==e._ir1085},function(e,t,n){t._ir1085=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1085)}),d(1082,function(e){return void 0!==e.printInformation},function(e,t){var n,r,o=(0,c.readVersionAndDescriptor)(e);t.printInformation={printerName:o.printerName||"",renderingIntent:b.decode(null!==(n=o.Inte)&&void 0!==n?n:"Inte.Img ")};var i=t.printInformation;void 0!==o.PstS&&(i.printerManagesColors=o.PstS),void 0!==o["Nm  "]&&(i.printerProfile=o["Nm  "]),void 0!==o.MpBl&&(i.blackPointCompensation=o.MpBl),void 0!==o.printSixteenBit&&(i.printSixteenBit=o.printSixteenBit),void 0!==o.hardProof&&(i.hardProof=o.hardProof),o.printProofSetup&&("Bltn"in o.printProofSetup?i.proofSetup={builtin:o.printProofSetup.Bltn.split(".")[1]}:i.proofSetup={profile:o.printProofSetup.profile,renderingIntent:b.decode(null!==(r=o.printProofSetup.Inte)&&void 0!==r?r:"Inte.Img "),blackPointCompensation:!!o.printProofSetup.MpBl,paperWhite:!!o.printProofSetup.paperWhite})},function(e,t){var n,r,o=t.printInformation,i={};o.printerManagesColors?i.PstS=!0:(void 0!==o.hardProof&&(i.hardProof=!!o.hardProof),i.ClrS="ClrS.RGBC",i["Nm  "]=null!==(n=o.printerProfile)&&void 0!==n?n:"CIE RGB"),i.Inte=b.encode(o.renderingIntent),o.printerManagesColors||(i.MpBl=!!o.blackPointCompensation),i.printSixteenBit=!!o.printSixteenBit,i.printerName=o.printerName||"",o.proofSetup&&"profile"in o.proofSetup?i.printProofSetup={profile:o.proofSetup.profile||"",Inte:b.encode(o.proofSetup.renderingIntent),MpBl:!!o.proofSetup.blackPointCompensation,paperWhite:!!o.proofSetup.paperWhite}:i.printProofSetup={Bltn:(null===(r=o.proofSetup)||void 0===r?void 0:r.builtin)?"builtinProof.".concat(o.proofSetup.builtin):"builtinProof.proofCMYK"},(0,c.writeVersionAndDescriptor)(e,"","printOutput",i)}),s.MOCK_HANDLERS&&d(1083,function(e){return void 0!==e._ir1083},function(e,t,n){t._ir1083=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1083)}),d(1005,function(e){return void 0!==e.resolutionInfo},function(e,t){var n=(0,i.readFixedPoint32)(e),r=(0,i.readUint16)(e),o=(0,i.readUint16)(e),a=(0,i.readFixedPoint32)(e),s=(0,i.readUint16)(e),l=(0,i.readUint16)(e);t.resolutionInfo={horizontalResolution:n,horizontalResolutionUnit:u[r]||"PPI",widthUnit:p[o]||"Inches",verticalResolution:a,verticalResolutionUnit:u[s]||"PPI",heightUnit:p[l]||"Inches"}},function(e,t){var n=t.resolutionInfo;(0,a.writeFixedPoint32)(e,n.horizontalResolution||0),(0,a.writeUint16)(e,Math.max(1,u.indexOf(n.horizontalResolutionUnit))),(0,a.writeUint16)(e,Math.max(1,p.indexOf(n.widthUnit))),(0,a.writeFixedPoint32)(e,n.verticalResolution||0),(0,a.writeUint16)(e,Math.max(1,u.indexOf(n.verticalResolutionUnit))),(0,a.writeUint16)(e,Math.max(1,p.indexOf(n.heightUnit)))});var w=["centered","size to fit","user defined"];d(1062,function(e){return void 0!==e.printScale},function(e,t){t.printScale={style:w[(0,i.readInt16)(e)],x:(0,i.readFloat32)(e),y:(0,i.readFloat32)(e),scale:(0,i.readFloat32)(e)}},function(e,t){var n=t.printScale,r=n.style,o=n.x,i=n.y,s=n.scale;(0,a.writeInt16)(e,Math.max(0,w.indexOf(r))),(0,a.writeFloat32)(e,o||0),(0,a.writeFloat32)(e,i||0),(0,a.writeFloat32)(e,s||0)}),d(1006,function(e){return void 0!==e.alphaChannelNames},function(e,t,n){if(t.alphaChannelNames)(0,i.skipBytes)(e,n());else for(t.alphaChannelNames=[];n()>0;){var r=y(e);t.alphaChannelNames.push(r)}},function(e,t){for(var n=0,r=t.alphaChannelNames;n<r.length;n++){x(e,r[n])}}),d(1045,function(e){return void 0!==e.alphaChannelNames},function(e,t,n){for(t.alphaChannelNames=[];n()>0;)t.alphaChannelNames.push((0,i.readUnicodeString)(e))},function(e,t){for(var n=0,r=t.alphaChannelNames;n<r.length;n++){var o=r[n];(0,a.writeUnicodeStringWithPadding)(e,o)}}),s.MOCK_HANDLERS&&d(1077,function(e){return void 0!==e._ir1077},function(e,t,n){t._ir1077=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1077)}),d(1053,function(e){return void 0!==e.alphaIdentifiers},function(e,t,n){for(t.alphaIdentifiers=[];n()>=4;)t.alphaIdentifiers.push((0,i.readUint32)(e))},function(e,t){for(var n=0,r=t.alphaIdentifiers;n<r.length;n++){var o=r[n];(0,a.writeUint32)(e,o)}}),d(1010,function(e){return void 0!==e.backgroundColor},function(e,t){return t.backgroundColor=(0,i.readColor)(e)},function(e,t){return(0,a.writeColor)(e,t.backgroundColor)}),d(1037,function(e){return void 0!==e.globalAngle},function(e,t){return t.globalAngle=(0,i.readInt32)(e)},function(e,t){return(0,a.writeInt32)(e,t.globalAngle)}),d(1049,function(e){return void 0!==e.globalAltitude},function(e,t){return t.globalAltitude=(0,i.readUint32)(e)},function(e,t){return(0,a.writeUint32)(e,t.globalAltitude)}),d(1011,function(e){return void 0!==e.printFlags},function(e,t){t.printFlags={labels:!!(0,i.readUint8)(e),cropMarks:!!(0,i.readUint8)(e),colorBars:!!(0,i.readUint8)(e),registrationMarks:!!(0,i.readUint8)(e),negative:!!(0,i.readUint8)(e),flip:!!(0,i.readUint8)(e),interpolate:!!(0,i.readUint8)(e),caption:!!(0,i.readUint8)(e),printFlags:!!(0,i.readUint8)(e)}},function(e,t){var n=t.printFlags;(0,a.writeUint8)(e,n.labels?1:0),(0,a.writeUint8)(e,n.cropMarks?1:0),(0,a.writeUint8)(e,n.colorBars?1:0),(0,a.writeUint8)(e,n.registrationMarks?1:0),(0,a.writeUint8)(e,n.negative?1:0),(0,a.writeUint8)(e,n.flip?1:0),(0,a.writeUint8)(e,n.interpolate?1:0),(0,a.writeUint8)(e,n.caption?1:0),(0,a.writeUint8)(e,n.printFlags?1:0)}),d(1034,function(e){return void 0!==e.copyrighted},function(e,t){t.copyrighted=!!(0,i.readUint8)(e)},function(e,t){(0,a.writeUint8)(e,t.copyrighted?1:0)}),d(1035,function(e){return void 0!==e.url},function(e,t,n){t.url=(0,i.readAsciiString)(e,n())},function(e,t){(0,a.writeAsciiString)(e,t.url)}),s.MOCK_HANDLERS&&d(1e4,function(e){return void 0!==e._ir10000},function(e,t,n){t._ir10000=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir10000)}),s.MOCK_HANDLERS&&d(1013,function(e){return void 0!==e._ir1013},function(e,t,n){t._ir1013=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1013)}),s.MOCK_HANDLERS&&d(1016,function(e){return void 0!==e._ir1016},function(e,t,n){t._ir1016=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1016)}),d(1080,function(e){return void 0!==e.countInformation},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);t.countInformation=n.countGroupList.map(function(e){return{color:{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]},name:e["Nm  "],size:e["Rds "],fontSize:e.fontSize,visible:e.Vsbl,points:e.countObjectList.map(function(e){return{x:e["X   "],y:e["Y   "]}})}})},function(e,t){var n={Vrsn:1,countGroupList:t.countInformation.map(function(e){return{"Rd  ":e.color.r,"Grn ":e.color.g,"Bl  ":e.color.b,"Nm  ":e.name,"Rds ":e.size,fontSize:e.fontSize,Vsbl:e.visible,countObjectList:e.points.map(function(e){return{"X   ":e.x,"Y   ":e.y}})}})};(0,c.writeVersionAndDescriptor)(e,"","Cnt ",n)}),d(1024,function(e){return void 0!==e.layerState},function(e,t){return t.layerState=(0,i.readUint16)(e)},function(e,t){return(0,a.writeUint16)(e,t.layerState)}),d(1026,function(e){return void 0!==e.layersGroup},function(e,t,n){for(t.layersGroup=[];n()>0;)t.layersGroup.push((0,i.readUint16)(e))},function(e,t){for(var n=0,r=t.layersGroup;n<r.length;n++){var o=r[n];(0,a.writeUint16)(e,o)}}),d(1072,function(e){return void 0!==e.layerGroupsEnabledId},function(e,t,n){for(t.layerGroupsEnabledId=[];n()>0;)t.layerGroupsEnabledId.push((0,i.readUint8)(e))},function(e,t){for(var n=0,r=t.layerGroupsEnabledId;n<r.length;n++){var o=r[n];(0,a.writeUint8)(e,o)}}),d(1069,function(e){return void 0!==e.layerSelectionIds},function(e,t){var n=(0,i.readUint16)(e);for(t.layerSelectionIds=[];n--;)t.layerSelectionIds.push((0,i.readUint32)(e))},function(e,t){(0,a.writeUint16)(e,t.layerSelectionIds.length);for(var n=0,r=t.layerSelectionIds;n<r.length;n++){var o=r[n];(0,a.writeUint32)(e,o)}}),d(1032,function(e){return void 0!==e.gridAndGuidesInformation},function(e,t){var n=(0,i.readUint32)(e),r=(0,i.readUint32)(e),o=(0,i.readUint32)(e),a=(0,i.readUint32)(e);if(1!==n)throw new Error("Invalid 1032 resource version: ".concat(n));t.gridAndGuidesInformation={grid:{horizontal:r,vertical:o},guides:[]};for(var s=0;s<a;s++)t.gridAndGuidesInformation.guides.push({location:(0,i.readUint32)(e)/32,direction:(0,i.readUint8)(e)?"horizontal":"vertical"})},function(e,t){var n=t.gridAndGuidesInformation,r=n.grid||{horizontal:576,vertical:576},o=n.guides||[];(0,a.writeUint32)(e,1),(0,a.writeUint32)(e,r.horizontal),(0,a.writeUint32)(e,r.vertical),(0,a.writeUint32)(e,o.length);for(var i=0,s=o;i<s.length;i++){var l=s[i];(0,a.writeUint32)(e,32*l.location),(0,a.writeUint8)(e,"horizontal"===l.direction?1:0)}}),d(1065,function(e){return void 0!==e.layerComps},function(e,t){var n=(0,c.readVersionAndDescriptor)(e,!0);t.layerComps={list:[]};for(var r=0,o=n.list;r<o.length;r++){var i=o[r];t.layerComps.list.push({id:i.compID,name:i["Nm  "],capturedInfo:i.capturedInfo}),"comment"in i&&(t.layerComps.list[t.layerComps.list.length-1].comment=i.comment)}"lastAppliedComp"in n&&(t.layerComps.lastApplied=n.lastAppliedComp)},function(e,t){for(var n=t.layerComps,r={list:[]},o=0,i=n.list;o<i.length;o++){var a=i[o],s={_classID:"Comp"};s["Nm  "]=a.name,"comment"in a&&(s.comment=a.comment),s.compID=a.id,s.capturedInfo=a.capturedInfo,r.list.push(s)}"lastApplied"in n&&(r.lastAppliedComp=n.lastApplied),(0,c.writeVersionAndDescriptor)(e,"","CompList",r)}),s.MOCK_HANDLERS&&d(1092,function(e){return void 0!==e._ir1092},function(e,t,n){t._ir1092=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1092)});var S=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];function k(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function C(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function j(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}d(1078,function(e){return void 0!==e.onionSkins},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);t.onionSkins={enabled:n.enab,framesBefore:n.numBefore,framesAfter:n.numAfter,frameSpacing:n.Spcn,minOpacity:n.minOpacity/100,maxOpacity:n.maxOpacity/100,blendMode:S[n.BlnM]||"normal"}},function(e,t){var n=t.onionSkins,r={Vrsn:1,enab:n.enabled,numBefore:n.framesBefore,numAfter:n.framesAfter,Spcn:n.frameSpacing,minOpacity:100*n.minOpacity|0,maxOpacity:100*n.maxOpacity|0,BlnM:Math.max(0,S.indexOf(n.blendMode))};(0,c.writeVersionAndDescriptor)(e,"","null",r)}),d(1075,function(e){return void 0!==e.timelineInformation},function(e,t){var n,r,o=(0,c.readVersionAndDescriptor)(e);t.timelineInformation={enabled:o.enab,frameStep:(0,c.frac)(o.frameStep),frameRate:o.frameRate,time:(0,c.frac)(o.time),duration:(0,c.frac)(o.duration),workInTime:(0,c.frac)(o.workInTime),workOutTime:(0,c.frac)(o.workOutTime),repeats:o.LCnt,hasMotion:o.hasMotion,globalTracks:(0,c.parseTrackList)(o.globalTrackList,!!e.logMissingFeatures)},(null===(r=null===(n=o.audioClipGroupList)||void 0===n?void 0:n.audioClipGroupList)||void 0===r?void 0:r.length)&&(t.timelineInformation.audioClipGroups=o.audioClipGroupList.audioClipGroupList.map(function(e){return{id:e.groupID,muted:e.muted,audioClips:e.audioClipList.map(function(e){var t=e.clipID,n=e.timeScope,r=e.muted,o=e.audioLevel,i=e.frameReader;return{id:t,start:(0,c.frac)(n.Strt),duration:(0,c.frac)(n.duration),inTime:(0,c.frac)(n.inTime),outTime:(0,c.frac)(n.outTime),muted:r,audioLevel:o,frameReader:{type:i.frameReaderType,mediaDescriptor:i.mediaDescriptor,link:{name:i["Lnk "]["Nm  "],fullPath:i["Lnk "].fullPath,relativePath:i["Lnk "].relPath}}}})}}))},function(e,t){var n,r=t.timelineInformation,o={Vrsn:1,enab:r.enabled,frameStep:r.frameStep,frameRate:r.frameRate,time:r.time,duration:r.duration,workInTime:r.workInTime,workOutTime:r.workOutTime,LCnt:r.repeats,globalTrackList:(0,c.serializeTrackList)(r.globalTracks),audioClipGroupList:{audioClipGroupList:null===(n=r.audioClipGroups)||void 0===n?void 0:n.map(function(e){return{groupID:e.id,muted:e.muted,audioClipList:e.audioClips.map(function(e){return{clipID:e.id,timeScope:{Vrsn:1,Strt:e.start,duration:e.duration,inTime:e.inTime,outTime:e.outTime},frameReader:{frameReaderType:e.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":e.frameReader.link.name,fullPath:e.frameReader.link.fullPath,relPath:e.frameReader.link.relativePath},mediaDescriptor:e.frameReader.mediaDescriptor},muted:e.muted,audioLevel:e.audioLevel}})}})},hasMotion:r.hasMotion};(0,c.writeVersionAndDescriptor)(e,"","null",o,"anim")}),d(1076,function(e){return void 0!==e.sheetDisclosure},function(e,t){var n=(0,c.readVersionAndDescriptor)(e);t.sheetDisclosure={},n.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=n.sheetTimelineOptions.map(function(e){return{sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}}))},function(e,t){var n=t.sheetDisclosure,r={Vrsn:1};n.sheetTimelineOptions&&(r.sheetTimelineOptions=n.sheetTimelineOptions.map(function(e){return{Vrsn:2,sheetID:e.sheetID,sheetDisclosed:e.sheetDisclosed,lightsDisclosed:e.lightsDisclosed,meshesDisclosed:e.meshesDisclosed,materialsDisclosed:e.materialsDisclosed}})),(0,c.writeVersionAndDescriptor)(e,"","null",r)}),d(1054,function(e){return void 0!==e.urlsList},function(e,t){var n=(0,i.readUint32)(e);t.urlsList=[];for(var r=0;r<n;r++){if("slic"!==(0,i.readSignature)(e)&&e.throwForMissingFeatures)throw new Error("Unknown long");var o=(0,i.readUint32)(e),a=(0,i.readUnicodeString)(e);t.urlsList.push({id:o,url:a,ref:"slice"})}},function(e,t){var n=t.urlsList;(0,a.writeUint32)(e,n.length);for(var r=0;r<n.length;r++)(0,a.writeSignature)(e,"slic"),(0,a.writeUint32)(e,n[r].id),(0,a.writeUnicodeString)(e,n[r].url)});var _=["autoGenerated","layer","userGenerated"],E=["noImage","image"],D=["default"];d(1050,function(e){return e.slices?e.slices.length:0},function(e,t){var n=(0,i.readUint32)(e);if(6===n){t.slices||(t.slices=[]);var o=(0,i.readInt32)(e),a=(0,i.readInt32)(e),s=(0,i.readInt32)(e),l=(0,i.readInt32)(e),d=(0,i.readUnicodeString)(e),u=(0,i.readUint32)(e);t.slices.push({bounds:{top:o,left:a,bottom:s,right:l},groupName:d,slices:[]});for(var p=t.slices[t.slices.length-1].slices,h=0;h<u;h++){var f=(0,i.readUint32)(e),g=(0,i.readUint32)(e),m=j(_,(0,i.readUint32)(e)),v="layer"==m?(0,i.readUint32)(e):0,y=(0,i.readUnicodeString)(e),x=j(E,(0,i.readUint32)(e)),b=(0,i.readInt32)(e),w=(0,i.readInt32)(e),S=(0,i.readInt32)(e),k=(0,i.readInt32)(e),M=(0,i.readUnicodeString)(e),T=(0,i.readUnicodeString)(e),I=(0,i.readUnicodeString)(e),A=(0,i.readUnicodeString)(e),O=!!(0,i.readUint8)(e),R=(0,i.readUnicodeString)(e),z=j(D,(0,i.readUint32)(e)),F=j(D,(0,i.readUint32)(e)),P=(0,i.readUint8)(e),B=(0,i.readUint8)(e),L=(0,i.readUint8)(e),N=(0,i.readUint8)(e),U=P+B+L+N===0?"none":0===P?"matte":"color";p.push({id:f,groupId:g,origin:m,associatedLayerId:v,name:y,target:T,message:I,altTag:A,cellTextIsHTML:O,cellText:R,horizontalAlignment:z,verticalAlignment:F,type:x,url:M,bounds:{top:w,left:b,bottom:k,right:S},backgroundColorType:U,backgroundColor:{r:B,g:L,b:N,a:P}})}(V=(0,c.readVersionAndDescriptor)(e)).slices.forEach(function(e){var t=p.find(function(t){return e.sliceID==t.id});t&&(t.topOutset=e.topOutset,t.leftOutset=e.leftOutset,t.bottomOutset=e.bottomOutset,t.rightOutset=e.rightOutset)})}else{if(7!==n&&8!==n)throw new Error("Invalid slices version (".concat(n,")"));var V=(0,c.readVersionAndDescriptor)(e);t.slices||(t.slices=[]),t.slices.push({groupName:V.baseName,bounds:C(V.bounds),slices:V.slices.map(function(e){return r(r({},e["Nm  "]?{name:e["Nm  "]}:{}),{id:e.sliceID,groupId:e.groupID,associatedLayerId:0,origin:c.ESliceOrigin.decode(e.origin),type:c.ESliceType.decode(e.Type),bounds:C(e.bounds),url:e.url,target:e.null,message:e.Msge,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horizontalAlignment:c.ESliceHorzAlign.decode(e.horzAlign),verticalAlignment:c.ESliceVertAlign.decode(e.vertAlign),backgroundColorType:c.ESliceBGColorType.decode(e.bgColorType),backgroundColor:e.bgColor?{r:e.bgColor["Rd  "],g:e.bgColor["Grn "],b:e.bgColor["Bl  "],a:e.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:e.topOutset||0,leftOutset:e.leftOutset||0,bottomOutset:e.bottomOutset||0,rightOutset:e.rightOutset||0})})})}},function(e,t,n){var o=t.slices[n],i=o.bounds,s=o.groupName,l=o.slices;(0,a.writeUint32)(e,6),(0,a.writeInt32)(e,i.top),(0,a.writeInt32)(e,i.left),(0,a.writeInt32)(e,i.bottom),(0,a.writeInt32)(e,i.right),(0,a.writeUnicodeString)(e,s),(0,a.writeUint32)(e,l.length);for(var d=0;d<l.length;d++){var u=l[d],p=u.backgroundColor,h=p.a,f=p.r,g=p.g,m=p.b;"none"===u.backgroundColorType?h=f=g=m=0:"matte"===u.backgroundColorType&&(h=0,f=g=m=255),(0,a.writeUint32)(e,u.id),(0,a.writeUint32)(e,u.groupId),(0,a.writeUint32)(e,_.indexOf(u.origin)),"layer"===u.origin&&(0,a.writeUint32)(e,u.associatedLayerId),(0,a.writeUnicodeString)(e,u.name||""),(0,a.writeUint32)(e,E.indexOf(u.type)),(0,a.writeInt32)(e,u.bounds.left),(0,a.writeInt32)(e,u.bounds.top),(0,a.writeInt32)(e,u.bounds.right),(0,a.writeInt32)(e,u.bounds.bottom),(0,a.writeUnicodeString)(e,u.url),(0,a.writeUnicodeString)(e,u.target),(0,a.writeUnicodeString)(e,u.message),(0,a.writeUnicodeString)(e,u.altTag),(0,a.writeUint8)(e,u.cellTextIsHTML?1:0),(0,a.writeUnicodeString)(e,u.cellText),(0,a.writeUint32)(e,D.indexOf(u.horizontalAlignment)),(0,a.writeUint32)(e,D.indexOf(u.verticalAlignment)),(0,a.writeUint8)(e,h),(0,a.writeUint8)(e,f),(0,a.writeUint8)(e,g),(0,a.writeUint8)(e,m)}var v={bounds:k(i),slices:[]};l.forEach(function(e){var t=r(r({sliceID:e.id,groupID:e.groupId,origin:c.ESliceOrigin.encode(e.origin),Type:c.ESliceType.encode(e.type),bounds:k(e.bounds)},e.name?{"Nm  ":e.name}:{}),{url:e.url,null:e.target,Msge:e.message,altTag:e.altTag,cellTextIsHTML:e.cellTextIsHTML,cellText:e.cellText,horzAlign:c.ESliceHorzAlign.encode(e.horizontalAlignment),vertAlign:c.ESliceVertAlign.encode(e.verticalAlignment),bgColorType:c.ESliceBGColorType.encode(e.backgroundColorType)});if("color"===e.backgroundColorType){var n=e.backgroundColor,o=n.r,i=n.g,a=n.b,s=n.a;t.bgColor={"Rd  ":o,"Grn ":i,"Bl  ":a,alpha:s}}t.topOutset=e.topOutset||0,t.leftOutset=e.leftOutset||0,t.bottomOutset=e.bottomOutset||0,t.rightOutset=e.rightOutset||0,v.slices.push(t)}),(0,c.writeVersionAndDescriptor)(e,"","null",v,"slices")}),d(1064,function(e){return void 0!==e.pixelAspectRatio},function(e,t){if((0,i.readUint32)(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:(0,i.readFloat64)(e)}},function(e,t){(0,a.writeUint32)(e,2),(0,a.writeFloat64)(e,t.pixelAspectRatio.aspect)}),d(1041,function(e){return void 0!==e.iccUntaggedProfile},function(e,t){t.iccUntaggedProfile=!!(0,i.readUint8)(e)},function(e,t){(0,a.writeUint8)(e,t.iccUntaggedProfile?1:0)}),s.MOCK_HANDLERS&&d(1039,function(e){return void 0!==e._ir1039},function(e,t,n){t._ir1039=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1039)}),d(1044,function(e){return void 0!==e.idsSeedNumber},function(e,t){return t.idsSeedNumber=(0,i.readUint32)(e)},function(e,t){return(0,a.writeUint32)(e,t.idsSeedNumber)}),d(1036,function(e){return void 0!==e.thumbnail||void 0!==e.thumbnailRaw},function(e,t,n){var r=(0,i.readUint32)(e),o=(0,i.readUint32)(e),a=(0,i.readUint32)(e);(0,i.readUint32)(e),(0,i.readUint32)(e),(0,i.readUint32)(e);var l=(0,i.readUint16)(e),c=(0,i.readUint16)(e);if(1!==r||24!==l||1!==c)return e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(r,", bitsPerPixel: ").concat(l,", planes: ").concat(c,")")),void(0,i.skipBytes)(e,n());var d=n(),u=(0,i.readBytes)(e,d);e.useRawThumbnail?t.thumbnailRaw={width:o,height:a,data:u}:u.byteLength&&(t.thumbnail=(0,s.createCanvasFromData)(u))},function(e,t){var n,r=0,i=0,s=new Uint8Array(0);if(t.thumbnailRaw)r=t.thumbnailRaw.width,i=t.thumbnailRaw.height,s=t.thumbnailRaw.data;else try{var l=null===(n=t.thumbnail.toDataURL("image/jpeg",1))||void 0===n?void 0:n.substring(23);l&&(s=(0,o.toByteArray)(l),r=t.thumbnail.width,i=t.thumbnail.height)}catch(p){}var c=4*Math.floor((24*r+31)/32),d=c*i*1,u=s.length;(0,a.writeUint32)(e,1),(0,a.writeUint32)(e,r),(0,a.writeUint32)(e,i),(0,a.writeUint32)(e,c),(0,a.writeUint32)(e,d),(0,a.writeUint32)(e,u),(0,a.writeUint16)(e,24),(0,a.writeUint16)(e,1),(0,a.writeBytes)(e,s)}),d(1057,function(e){return void 0!==e.versionInfo},function(e,t,n){if(1!==(0,i.readUint32)(e))throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!(0,i.readUint8)(e),writerName:(0,i.readUnicodeString)(e),readerName:(0,i.readUnicodeString)(e),fileVersion:(0,i.readUint32)(e)},(0,i.skipBytes)(e,n())},function(e,t){var n=t.versionInfo;(0,a.writeUint32)(e,1),(0,a.writeUint8)(e,n.hasRealMergedData?1:0),(0,a.writeUnicodeString)(e,n.writerName),(0,a.writeUnicodeString)(e,n.readerName),(0,a.writeUint32)(e,n.fileVersion)}),s.MOCK_HANDLERS&&d(1058,function(e){return void 0!==e._ir1058},function(e,t,n){t._ir1058=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1058)}),d(7e3,function(e){return void 0!==e.imageReadyVariables},function(e,t,n){t.imageReadyVariables=m(e,n())},function(e,t){v(e,t.imageReadyVariables)}),d(7001,function(e){return void 0!==e.imageReadyDataSets},function(e,t,n){t.imageReadyDataSets=m(e,n())},function(e,t){v(e,t.imageReadyDataSets)}),d(1088,function(e){return void 0!==e.pathSelectionState},function(e,t,n){var r=(0,c.readVersionAndDescriptor)(e);t.pathSelectionState=r.null},function(e,t){var n={null:t.pathSelectionState};(0,c.writeVersionAndDescriptor)(e,"","null",n)}),s.MOCK_HANDLERS&&d(1025,function(e){return void 0!==e._ir1025},function(e,t,n){t._ir1025=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir1025)});var M=(0,s.createEnum)("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});d(4e3,function(e){return void 0!==e.animations},function(e,t,n){var r=(0,i.readSignature)(e);if("mani"===r)(0,i.checkSignature)(e,"IRFR"),(0,i.readSection)(e,1,function(n){for(var r=function(){(0,i.checkSignature)(e,"8BIM");var n=(0,i.readSignature)(e);(0,i.readSection)(e,1,function(r){if("AnDs"===n){var o=(0,c.readVersionAndDescriptor)(e);t.animations={frames:o.FrIn.map(function(e){return{id:e.FrID,delay:(e.FrDl||0)/100,dispose:e.FrDs?M.decode(e.FrDs):"auto"}}),animations:o.FSts.map(function(e){return{id:e.FsID,frames:e.FsFr,repeats:e.LCnt,activeFrame:e.AFrm||0}})}}else if("Roll"===n){var a=(0,i.readBytes)(e,r());e.logDevFeatures&&e.log("#4000 Roll",a)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",n)})};n()>0;)r()});else if("mopt"===r){var o=(0,i.readBytes)(e,n());e.logDevFeatures&&e.log("#4000 mopt",o)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",r)},function(e,t){t.animations&&((0,a.writeSignature)(e,"mani"),(0,a.writeSignature)(e,"IRFR"),(0,a.writeSection)(e,1,function(){(0,a.writeSignature)(e,"8BIM"),(0,a.writeSignature)(e,"AnDs"),(0,a.writeSection)(e,1,function(){for(var n={FrIn:[],FSts:[]},r=0;r<t.animations.frames.length;r++){var o=t.animations.frames[r],i={FrID:o.id};o.delay&&(i.FrDl=100*o.delay|0),i.FrDs=M.encode(o.dispose),n.FrIn.push(i)}for(r=0;r<t.animations.animations.length;r++){var a=t.animations.animations[r],s={FsID:a.id,AFrm:0|a.activeFrame,FsFr:a.frames,LCnt:0|a.repeats};n.FSts.push(s)}(0,c.writeVersionAndDescriptor)(e,"","null",n)})}))}),s.MOCK_HANDLERS&&d(4001,function(e){return void 0!==e._ir4001},function(e,t,n){if(s.MOCK_HANDLERS)t._ir4001=(0,i.readBytes)(e,n());else{var r=(0,i.readSignature)(e);if("mfri"===r){if(2!==(0,i.readUint32)(e))throw new Error("Invalid mfri version");var o=(0,i.readUint32)(e),a=(0,i.readBytes)(e,o);e.logDevFeatures&&e.log("mfri",a)}else if("mset"===r){var l=(0,c.readVersionAndDescriptor)(e);e.logDevFeatures&&e.log("mset",l)}else e.logMissingFeatures&&e.log("Unhandled key in #4001",r)}},function(e,t){(0,a.writeBytes)(e,t._ir4001)}),s.MOCK_HANDLERS&&d(4002,function(e){return void 0!==e._ir4002},function(e,t,n){t._ir4002=(0,i.readBytes)(e,n())},function(e,t){(0,a.writeBytes)(e,t._ir4002)})},3331:(e,t,n)=>{var r=n(9676),o=n(929),i=n(7303);e.exports=function(e){return function(t,n,a){return a&&"number"!=typeof a&&o(t,n,a)&&(n=a=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),a=void 0===a?t<n?1:-1:i(a),r(t,n,a,e)}}},3343:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},3366:(e,t,n)=>{var r=n(7894),o=n(9057);e.exports=function(e,t){return null!=e&&o(e,t,r)}},3411:(e,t,n)=>{var r=n(149),o=n(9096),i=n(8883),a=n(4052);e.exports=function(e,t){return(a(e)?r:i)(e,o(t,3))}},3440:(e,t,n)=>{var r=n(6552)["__core-js_shared__"];e.exports=r},3516:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},3577:(e,t,n)=>{e.exports={graphlib:n(7938),layout:n(6675),debug:n(3774),util:{time:n(5641).time,notime:n(5641).notime},version:n(5185)}},3668:(e,t,n)=>{var r=n(8902),o=n(2587),i=n(8114);e.exports=function(e,t,n,a,s,l){var c=1&n,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var p=l.get(e),h=l.get(t);if(p&&h)return p==t&&h==e;var f=-1,g=!0,m=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++f<d;){var v=e[f],y=t[f];if(a)var x=c?a(y,v,f,t,e,l):a(v,y,f,e,t,l);if(void 0!==x){if(x)continue;g=!1;break}if(m){if(!o(t,function(e,t){if(!i(m,t)&&(v===e||s(v,e,n,a,l)))return m.push(t)})){g=!1;break}}else if(v!==y&&!s(v,y,n,a,l)){g=!1;break}}return l.delete(e),l.delete(t),g}},3701:e=>{"use strict";e.exports=Math.abs},3713:(e,t,n)=>{var r=n(6140),o=n(1143),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3737:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}},3774:(e,t,n)=>{var r=n(8208),o=n(5641),i=n(7938).Graph;e.exports={debugOrdering:function(e){var t=o.buildLayerMatrix(e),n=new i({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),r.forEach(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name)}),r.forEach(t,function(e,t){var o="layer"+t;n.setNode(o,{rank:"same"}),r.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t})}),n}}},3781:(e,t,n)=>{var r=n(9417),o=n(8673);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,r(a)]}return t}},3785:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},3847:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},3864:(e,t,n)=>{"use strict";var r=n(7724);e.exports=Function.prototype.bind||r},3868:(e,t,n)=>{var r=n(1775),o=n(3211);e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},3892:e=>{e.exports=function(e){return this.__data__.has(e)}},3932:(e,t,n)=>{var r=n(396),o=n(2866),i=n(2597),a=n(914);e.exports=function(e){return i(e)?r(a(e)):o(e)}},4008:(e,t,n)=>{var r=n(7449),o=n(3366);e.exports=function(e,t){return r(e,t,function(t,n){return o(e,n)})}},4020:e=>{e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},4052:e=>{var t=Array.isArray;e.exports=t},4065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},4079:(e,t,n)=>{var r=n(8259),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)}),t});e.exports=a},4112:e=>{"use strict";const t=function*(){}.constructor;e.exports=()=>t},4160:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},4190:(e,t,n)=>{var r=n(1340);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function x(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,g(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,o)&&!C.hasOwnProperty(o)&&(i[o]=t[o]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===i[o]&&(i[o]=l[o]);return{$$typeof:n,type:e,key:a,ref:s,props:i,_owner:k.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function D(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===i?"."+D(l,0):i,w(a)?(o="",null!=e&&(o=e.replace(E,"$&/")+"/"),M(a,t,o,"",function(e){return e})):null!=a&&(_(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,o+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var d=i+D(s=e[c],c);l+=M(s,t,o,d,a)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=M(s=s.value,t,o,d=i+D(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],o=0;return M(e,r,"","",function(e){return t.call(n,e,o++)}),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},O={transition:null},R={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};function z(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=a,t.PureComponent=x,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=z,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!C.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];o.children=l}return{$$typeof:n,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=z,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},4258:(e,t,n)=>{var r=n(5906)();e.exports=r},4262:(e,t,n)=>{var r=n(8895),o=n(4052);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},4308:(e,t,n)=>{"use strict";var r=n(8208);function o(e,t,n){for(var o=r.zipObject(n,r.map(n,function(e,t){return t})),i=r.flatten(r.map(t,function(t){return r.sortBy(r.map(e.outEdges(t),function(t){return{pos:o[t.w],weight:e.edge(t).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var s=2*a-1;a-=1;var l=r.map(new Array(s),function(){return 0}),c=0;return r.forEach(i.forEach(function(e){var t=e.pos+a;l[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=l[t+1]),l[t=t-1>>1]+=e.weight;c+=e.weight*n})),c}e.exports=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=o(e,t[r-1],t[r]);return n}},4320:(e,t,n)=>{var r=n(3713),o=n(6924),i=n(2777),a=n(4052),s=n(6571),l=n(4543),c=n(6140),d=n(1268),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||d(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(u.call(e,n))return!1;return!0}},4353:(e,t,n)=>{e=n.nmd(e);var r=n(6552),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},4384:(e,t,n)=>{"use strict";var r=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=n(3864);e.exports=i.call(r,o)},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4416:(e,t,n)=>{var r=n(8902),o=n(5866),i=n(1558),a=n(8114),s=n(8182),l=n(2074);e.exports=function(e,t,n){var c=-1,d=o,u=e.length,p=!0,h=[],f=h;if(n)p=!1,d=i;else if(u>=200){var g=t?null:s(e);if(g)return l(g);p=!1,d=a,f=new r}else f=t?[]:h;e:for(;++c<u;){var m=e[c],v=t?t(m):m;if(m=n||0!==m?m:0,p&&v===v){for(var y=f.length;y--;)if(f[y]===v)continue e;t&&f.push(v),h.push(m)}else d(f,v,n)||(f!==h&&f.push(v),h.push(m))}return h}},4428:(e,t,n)=>{var r=n(5750);function o(){this._arr=[],this._keyIndices={}}e.exports=o,o.prototype.size=function(){return this._arr.length},o.prototype.keys=function(){return this._arr.map(function(e){return e.key})},o.prototype.has=function(e){return r.has(this._keyIndices,e)},o.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},o.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},o.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!r.has(n,e)){var o=this._arr,i=o.length;return n[e]=i,o.push({key:e,priority:t}),this._decrease(i),!0}return!1},o.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},o.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},o.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))},o.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},o.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t}},4445:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],l=i[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,l)),d=0,u=l>0?a-4:a;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,l=r-o;s<l;s+=a)i.push(c(e,s,s+a>l?l:s+a));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function c(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},4501:(e,t,n)=>{"use strict";var r=n(8208),o=n(3088),i=n(5758).slack,a=n(5758).longestPath,s=n(7938).alg.preorder,l=n(7938).alg.postorder,c=n(5641).simplify;function d(e){e=c(e),a(e);var t,n=o(e);for(h(n),u(n,e);t=g(n);)v(n,e,t,m(n,e,t))}function u(e,t){var n=l(e,e.nodes());n=n.slice(0,n.length-1),r.forEach(n,function(n){!function(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=p(e,t,n)}(e,t,n)})}function p(e,t,n){var o=e.node(n).parent,i=!0,a=t.edge(n,o),s=0;return a||(i=!1,a=t.edge(o,n)),s=a.weight,r.forEach(t.nodeEdges(n),function(r){var a,l,c=r.v===n,d=c?r.w:r.v;if(d!==o){var u=c===i,p=t.edge(r).weight;if(s+=u?p:-p,a=n,l=d,e.hasEdge(a,l)){var h=e.edge(n,d).cutvalue;s+=u?-h:h}}}),s}function h(e,t){arguments.length<2&&(t=e.nodes()[0]),f(e,{},1,t)}function f(e,t,n,o,i){var a=n,s=e.node(o);return t[o]=!0,r.forEach(e.neighbors(o),function(i){r.has(t,i)||(n=f(e,t,n,i,o))}),s.low=a,s.lim=n++,i?s.parent=i:delete s.parent,n}function g(e){return r.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function m(e,t,n){var o=n.v,a=n.w;t.hasEdge(o,a)||(o=n.w,a=n.v);var s=e.node(o),l=e.node(a),c=s,d=!1;s.lim>l.lim&&(c=l,d=!0);var u=r.filter(t.edges(),function(t){return d===y(e,e.node(t.v),c)&&d!==y(e,e.node(t.w),c)});return r.minBy(u,function(e){return i(t,e)})}function v(e,t,n,o){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(o.v,o.w,{}),h(e),u(e,t),function(e,t){var n=r.find(e.nodes(),function(e){return!t.node(e).parent}),o=s(e,n);o=o.slice(1),r.forEach(o,function(n){var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)})}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=d,d.initLowLimValues=h,d.initCutValues=u,d.calcCutValue=p,d.leaveEdge=g,d.enterEdge=m,d.exchangeEdges=v},4543:(e,t,n)=>{e=n.nmd(e);var r=n(6552),o=n(14),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||o;e.exports=l},4544:e=>{"use strict";e.exports=(e,t,n,r)=>{let o=65535&e,i=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{o=o+t[r++]|0,i=i+o|0}while(--a);o%=65521,i%=65521}return o|i<<16}},4545:(e,t,n)=>{var r=n(7160);e.exports=function(){this.__data__=new r,this.size=0}},4552:(e,t,n)=>{var r=n(9812),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(l){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o}},4570:(e,t,n)=>{var r=n(5647),o=n(929);e.exports=function(e){return r(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var l=n[r];l&&e(t,l,r,a)}return t})}},4590:e=>{"use strict";e.exports="undefined"!==typeof Reflect&&Reflect&&Reflect.apply},4591:e=>{"use strict";e.exports=Math.max},4635:(e,t,n)=>{"use strict";var r=n(9534);e.exports=function(){return r()&&!!Symbol.toStringTag}},4657:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},4664:(e,t,n)=>{var r=n(4258),o=n(8673);e.exports=function(e,t){return e&&r(e,t,o)}},4677:(e,t,n)=>{var r=n(3253),o=n(4570)(function(e,t,n){r(e,t,n)});e.exports=o},4724:(e,t,n)=>{var r=n(396)("length");e.exports=r},4753:e=>{"use strict";const t=15,n=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),r=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),o=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),i=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,a,s,l,c,d,u,p)=>{const h=p.bits;let f,g,m,v,y,x,b=0,w=0,S=0,k=0,C=0,j=0,_=0,E=0,D=0,M=0,T=null;const I=new Uint16Array(16),A=new Uint16Array(16);let O,R,z,F=null;for(b=0;b<=t;b++)I[b]=0;for(w=0;w<l;w++)I[a[s+w]]++;for(C=h,k=t;k>=1&&0===I[k];k--);if(C>k&&(C=k),0===k)return c[d++]=20971520,c[d++]=20971520,p.bits=1,0;for(S=1;S<k&&0===I[S];S++);for(C<S&&(C=S),E=1,b=1;b<=t;b++)if(E<<=1,E-=I[b],E<0)return-1;if(E>0&&(0===e||1!==k))return-1;for(A[1]=0,b=1;b<t;b++)A[b+1]=A[b]+I[b];for(w=0;w<l;w++)0!==a[s+w]&&(u[A[a[s+w]]++]=w);if(0===e?(T=F=u,x=20):1===e?(T=n,F=r,x=257):(T=o,F=i,x=0),M=0,w=0,b=S,y=d,j=C,_=0,m=-1,D=1<<C,v=D-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){O=b-_,u[w]+1<x?(R=0,z=u[w]):u[w]>=x?(R=F[u[w]-x],z=T[u[w]-x]):(R=96,z=0),f=1<<b-_,g=1<<j,S=g;do{g-=f,c[y+(M>>_)+g]=O<<24|R<<16|z}while(0!==g);for(f=1<<b-1;M&f;)f>>=1;if(0!==f?(M&=f-1,M+=f):M=0,w++,0===--I[b]){if(b===k)break;b=a[s+u[w]]}if(b>C&&(M&v)!==m){for(0===_&&(_=C),y+=S,j=b-_,E=1<<j;j+_<k&&(E-=I[j+_],!(E<=0));)j++,E<<=1;if(D+=1<<j,1===e&&D>852||2===e&&D>592)return 1;m=M&v,c[m]=C<<24|j<<16|y-d}}return 0!==M&&(c[y+M]=b-_<<24|64<<16),p.bits=C,0}},4757:(e,t,n)=>{var r=n(6552);e.exports=function(){return r.Date.now()}},4781:(e,t,n)=>{"use strict";var r=n(3864),o=n(4902),i=n(4937),a=n(5747);e.exports=function(e){if(e.length<1||"function"!==typeof e[0])throw new o("a function is required");return a(r,i,e)}},4816:(e,t,n)=>{var r=n(7251),o=n(7159),i=n(438),a=n(9394),s=n(6874);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},4888:e=>{"use strict";const t=16209;e.exports=function(e,n){let r,o,i,a,s,l,c,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_;const E=e.state;r=e.next_in,j=e.input,o=r+(e.avail_in-5),i=e.next_out,_=e.output,a=i-(n-e.avail_out),s=i+(e.avail_out-257),l=E.dmax,c=E.wsize,d=E.whave,u=E.wnext,p=E.window,h=E.hold,f=E.bits,g=E.lencode,m=E.distcode,v=(1<<E.lenbits)-1,y=(1<<E.distbits)-1;e:do{f<15&&(h+=j[r++]<<f,f+=8,h+=j[r++]<<f,f+=8),x=g[h&v];t:for(;;){if(b=x>>>24,h>>>=b,f-=b,b=x>>>16&255,0===b)_[i++]=65535&x;else{if(!(16&b)){if(0===(64&b)){x=g[(65535&x)+(h&(1<<b)-1)];continue t}if(32&b){E.mode=16191;break e}e.msg="invalid literal/length code",E.mode=t;break e}w=65535&x,b&=15,b&&(f<b&&(h+=j[r++]<<f,f+=8),w+=h&(1<<b)-1,h>>>=b,f-=b),f<15&&(h+=j[r++]<<f,f+=8,h+=j[r++]<<f,f+=8),x=m[h&y];n:for(;;){if(b=x>>>24,h>>>=b,f-=b,b=x>>>16&255,!(16&b)){if(0===(64&b)){x=m[(65535&x)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",E.mode=t;break e}if(S=65535&x,b&=15,f<b&&(h+=j[r++]<<f,f+=8,f<b&&(h+=j[r++]<<f,f+=8)),S+=h&(1<<b)-1,S>l){e.msg="invalid distance too far back",E.mode=t;break e}if(h>>>=b,f-=b,b=i-a,S>b){if(b=S-b,b>d&&E.sane){e.msg="invalid distance too far back",E.mode=t;break e}if(k=0,C=p,0===u){if(k+=c-b,b<w){w-=b;do{_[i++]=p[k++]}while(--b);k=i-S,C=_}}else if(u<b){if(k+=c+u-b,b-=u,b<w){w-=b;do{_[i++]=p[k++]}while(--b);if(k=0,u<w){b=u,w-=b;do{_[i++]=p[k++]}while(--b);k=i-S,C=_}}}else if(k+=u-b,b<w){w-=b;do{_[i++]=p[k++]}while(--b);k=i-S,C=_}for(;w>2;)_[i++]=C[k++],_[i++]=C[k++],_[i++]=C[k++],w-=3;w&&(_[i++]=C[k++],w>1&&(_[i++]=C[k++]))}else{k=i-S;do{_[i++]=_[k++],_[i++]=_[k++],_[i++]=_[k++],w-=3}while(w>2);w&&(_[i++]=_[k++],w>1&&(_[i++]=_[k++]))}break}}break}}while(r<o&&i<s);w=f>>3,r-=w,f-=w<<3,h&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<o?o-r+5:5-(r-o),e.avail_out=i<s?s-i+257:257-(i-s),E.hold=h,E.bits=f}},4902:e=>{"use strict";e.exports=TypeError},4903:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){t=!1}const n=new Uint8Array(256);for(let o=0;o<256;o++)n[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;n[254]=n[254]=1,e.exports.string2buf=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,i,a=e.length,s=0;for(o=0;o<a;o++)n=e.charCodeAt(o),55296===(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),i=0,o=0;i<s;o++)n=e.charCodeAt(o),55296===(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t};e.exports.buf2string=(e,r)=>{const o=r||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,r));let i,a;const s=new Array(2*o);for(a=0,i=0;i<o;){let t=e[i++];if(t<128){s[a++]=t;continue}let r=n[t];if(r>4)s[a++]=65533,i+=r-1;else{for(t&=2===r?31:3===r?15:7;r>1&&i<o;)t=t<<6|63&e[i++],r--;r>1?s[a++]=65533:t<65536?s[a++]=t:(t-=65536,s[a++]=55296|t>>10&1023,s[a++]=56320|1023&t)}}return((e,n)=>{if(n<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(e[t]);return r})(s,a)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128===(192&e[r]);)r--;return r<0||0===r?t:r+n[e[r]]>t?r:t}},4937:e=>{"use strict";e.exports=Function.prototype.call},4949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeJpeg=void 0;var n=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),r=4017,o=799,i=3406,a=2276,s=1567,l=3784,c=5793,d=2896,u=67108864,p=0;function h(e){var t=p+e;if(t>u){var n=Math.ceil((t-u)/1024/1024);throw new Error("Max memory limit exceeded by at least ".concat(n,"MB"))}p=t}function f(e,t){for(var n=16;n>0&&!e[n-1];)n--;for(var r=[{children:[],index:0}],o=0,i=r[0],a=0;a<n;a++){for(var s=0;s<e[a];s++){for((i=r.pop()).children[i.index]=t[o];i.index>0;){if(0===r.length)throw new Error("Could not recreate Huffman Table");i=r.pop()}for(i.index++,r.push(i);r.length<=a;){var l={children:[],index:0};r.push(l),i.children[i.index]=l.children,i=l}o++}if(a+1<n){l={children:[],index:0};r.push(l),i.children[i.index]=l.children,i=l}}return r[0].children}function g(e,t,r,o,i,a,s,l,c){var d=r.mcusPerLine,u=r.progressive,p=t,h=0,f=0;function g(){if(f>0)return f--,h>>f&1;if(255==(h=e[t++])){var n=e[t++];if(n)throw new Error("unexpected marker: ".concat((h<<8|n).toString(16)))}return f=7,h>>>7}function m(e){for(var t=e;;){if("number"===typeof(t=t[g()]))return t;if(void 0===t)throw new Error("invalid huffman sequence")}}function v(e){for(var t=0;e>0;)t=t<<1|g(),e--;return t}function y(e){var t=v(e);return t>=1<<e-1?t:t+(-1<<e)+1}var x=0;var b=0,w=0;function S(e,t,n,r,o){var i=n%d,a=(n/d|0)*e.v+r,s=i*e.h+o;void 0!==e.blocks[a]&&t(e,e.blocks[a][s])}function k(e,t,n){var r=n/e.blocksPerLine|0,o=n%e.blocksPerLine;void 0!==e.blocks[r]&&t(e,e.blocks[r][o])}var C,j,_=o.length;j=u?0===a?0===l?function(e,t){var n=m(e.huffmanTableDC),r=0===n?0:y(n)<<c;t[0]=e.pred+=r}:function(e,t){t[0]|=g()<<c}:0===l?function(e,t){if(x>0)x--;else for(var r=a,o=s;r<=o;){var i=m(e.huffmanTableAC),l=15&i,d=i>>4;if(0!==l)t[n[r+=d]]=y(l)*(1<<c),r++;else{if(d<15){x=v(d)+(1<<d)-1;break}r+=16}}}:function(e,t){for(var r=a,o=s,i=0;r<=o;){var l=n[r],d=t[l]<0?-1:1;switch(b){case 0:var u=m(e.huffmanTableAC),p=15&u;if(i=u>>4,0===p)i<15?(x=v(i)+(1<<i),b=4):(i=16,b=1);else{if(1!==p)throw new Error("invalid ACn encoding");w=y(p),b=i?2:3}continue;case 1:case 2:t[l]?t[l]+=(g()<<c)*d:0===--i&&(b=2==b?3:0);break;case 3:t[l]?t[l]+=(g()<<c)*d:(t[l]=w<<c,b=0);break;case 4:t[l]&&(t[l]+=(g()<<c)*d)}r++}4===b&&0===--x&&(b=0)}:function(e,t){var r=m(e.huffmanTableDC),o=0===r?0:y(r);t[0]=e.pred+=o;for(var i=1;i<64;){var a=m(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s)t[n[i+=l]]=y(s),i++;else{if(l<15)break;i+=16}}};var E,D,M,T,I=0;for(E=1==_?o[0].blocksPerLine*o[0].blocksPerColumn:d*r.mcusPerColumn,i||(i=E);I<E;){for(var A=0;A<_;A++)o[A].pred=0;if(x=0,1==_){C=o[0];for(var O=0;O<i;O++)k(C,j,I),I++}else for(O=0;O<i;O++){for(A=0;A<_;A++){D=(C=o[A]).h,M=C.v;for(var R=0;R<M;R++)for(var z=0;z<D;z++)S(C,j,I,R,z)}if(++I===E)break}if(I===E)do{if(255===e[t]&&0!==e[t+1])break;t+=1}while(t<e.length-2);if(f=0,(T=e[t]<<8|e[t+1])<65280)throw new Error("marker was not found");if(!(T>=65488&&T<=65495))break;t+=2}return t-p}function m(e){var t=[],n=e.blocksPerLine,u=e.blocksPerColumn,p=n<<3,f=new Int32Array(64),g=new Uint8Array(64);function m(t,n,u){for(var p=e.quantizationTable,h=u,f=0;f<64;f++)h[f]=t[f]*p[f];for(f=0;f<8;++f){var g=8*f;if(0!=h[1+g]||0!=h[2+g]||0!=h[3+g]||0!=h[4+g]||0!=h[5+g]||0!=h[6+g]||0!=h[7+g]){var m=c*h[0+g]+128>>8,v=c*h[4+g]+128>>8,y=h[2+g],x=h[6+g],b=d*(h[1+g]-h[7+g])+128>>8,w=d*(h[1+g]+h[7+g])+128>>8,S=h[3+g]<<4,k=h[5+g]<<4,C=m-v+1>>1;m=m+v+1>>1,v=C,C=y*l+x*s+128>>8,y=y*s-x*l+128>>8,x=C,C=b-k+1>>1,b=b+k+1>>1,k=C,C=w+S+1>>1,S=w-S+1>>1,w=C,C=m-x+1>>1,m=m+x+1>>1,x=C,C=v-y+1>>1,v=v+y+1>>1,y=C,C=b*a+w*i+2048>>12,b=b*i-w*a+2048>>12,w=C,C=S*o+k*r+2048>>12,S=S*r-k*o+2048>>12,k=C,h[0+g]=m+w,h[7+g]=m-w,h[1+g]=v+k,h[6+g]=v-k,h[2+g]=y+S,h[5+g]=y-S,h[3+g]=x+b,h[4+g]=x-b}else{var j=c*h[0+g]+512>>10;h[0+g]=j,h[1+g]=j,h[2+g]=j,h[3+g]=j,h[4+g]=j,h[5+g]=j,h[6+g]=j,h[7+g]=j}}for(f=0;f<8;++f){var _=f;if(0!=h[8+_]||0!=h[16+_]||0!=h[24+_]||0!=h[32+_]||0!=h[40+_]||0!=h[48+_]||0!=h[56+_]){m=c*h[0+_]+2048>>12,v=c*h[32+_]+2048>>12,y=h[16+_],x=h[48+_],b=d*(h[8+_]-h[56+_])+2048>>12,w=d*(h[8+_]+h[56+_])+2048>>12,S=h[24+_],k=h[40+_],C=m-v+1>>1;m=m+v+1>>1,v=C,C=y*l+x*s+2048>>12,y=y*s-x*l+2048>>12,x=C,C=b-k+1>>1,b=b+k+1>>1,k=C,C=w+S+1>>1,S=w-S+1>>1,w=C,C=m-x+1>>1,m=m+x+1>>1,x=C,C=v-y+1>>1,v=v+y+1>>1,y=C,C=b*a+w*i+2048>>12,b=b*i-w*a+2048>>12,w=C,C=S*o+k*r+2048>>12,S=S*r-k*o+2048>>12,k=C,h[0+_]=m+w,h[56+_]=m-w,h[8+_]=v+k,h[48+_]=v-k,h[16+_]=y+S,h[40+_]=y-S,h[24+_]=x+b,h[32+_]=x-b}else{var E=c*u[f+0]+8192>>14;h[0+_]=E,h[8+_]=E,h[16+_]=E,h[24+_]=E,h[32+_]=E,h[40+_]=E,h[48+_]=E,h[56+_]=E}}for(f=0;f<64;++f){var D=128+(h[f]+8>>4);n[f]=D<0?0:D>255?255:D}}h(p*u*8);for(var v=0;v<u;v++){for(var y=v<<3,x=0;x<8;x++)t.push(new Uint8Array(p));for(var b=0;b<n;b++){m(e.blocks[v][b],g,f);for(var w=0,S=b<<3,k=0;k<8;k++){var C=t[y+k];for(x=0;x<8;x++)C[S+x]=g[w++]}}}return t}function v(e){return e<0?0:e>255?255:e}t.decodeJpeg=function(e,t){if(p=0,0===e.length)throw new Error("Empty jpeg buffer");var r=function(e){var t={width:0,height:0,comments:[],adobe:void 0,components:[],exifBuffer:void 0,jfif:void 0},r=1e8,o=0;function i(){var t=e[o]<<8|e[o+1];return o+=2,t}function a(){var t=i(),n=e.subarray(o,o+t-2);return o+=n.length,n}function s(e){var t=0,n=0;for(var r in e.components)e.components.hasOwnProperty(r)&&(t<(a=e.components[r]).h&&(t=a.h),n<a.v&&(n=a.v));var o=Math.ceil(e.samplesPerLine/8/t),i=Math.ceil(e.scanLines/8/n);for(var r in e.components)if(e.components.hasOwnProperty(r)){var a=e.components[r],s=Math.ceil(Math.ceil(e.samplesPerLine/8)*a.h/t),l=Math.ceil(Math.ceil(e.scanLines/8)*a.v/n),c=o*a.h,d=i*a.v,u=[];h(d*c*256);for(var p=0;p<d;p++){for(var f=[],g=0;g<c;g++)f.push(new Int32Array(64));u.push(f)}a.blocksPerLine=s,a.blocksPerColumn=l,a.blocks=u}e.maxH=t,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=i}var l=null,c=null,d=void 0,u=0,p=[],v=[],y=[],x=[],b=i(),w=-1;if(65496!=b)throw new Error("SOI not found");for(b=i();65497!=b;){switch(b){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var S=a();if(65534===b){for(var k="",C=0;C<S.byteLength;C++)k+=String.fromCharCode(S[C]);t.comments.push(k)}65504===b&&74===S[0]&&70===S[1]&&73===S[2]&&70===S[3]&&0===S[4]&&(l={version:{major:S[5],minor:S[6]},densityUnits:S[7],xDensity:S[8]<<8|S[9],yDensity:S[10]<<8|S[11],thumbWidth:S[12],thumbHeight:S[13],thumbData:S.subarray(14,14+3*S[12]*S[13])}),65505===b&&69===S[0]&&120===S[1]&&105===S[2]&&102===S[3]&&0===S[4]&&(t.exifBuffer=S.subarray(5,S.length)),65518===b&&65===S[0]&&100===S[1]&&111===S[2]&&98===S[3]&&101===S[4]&&0===S[5]&&(c={version:S[6],flags0:S[7]<<8|S[8],flags1:S[9]<<8|S[10],transformCode:S[11]});break;case 65499:for(var j=i()+o-2;o<j;){var _=e[o++];h(256);var E=new Int32Array(64);if(_>>4===0)for(var D=0;D<64;D++)E[n[D]]=e[o++];else{if(_>>4!==1)throw new Error("DQT: invalid table spec");for(D=0;D<64;D++)E[n[D]]=i()}p[15&_]=E}break;case 65472:case 65473:case 65474:i();var M=(d={extended:65473===b,progressive:65474===b,precision:e[o++],scanLines:i(),samplesPerLine:i(),components:{},componentsOrder:[],maxH:0,maxV:0,mcusPerLine:0,mcusPerColumn:0}).scanLines*d.samplesPerLine;if(M>r){var T=Math.ceil((M-r)/1e6);throw new Error("maxResolutionInMP limit exceeded by ".concat(T,"MP"))}for(var I=e[o++],A=0;A<I;A++){var O=e[o],R=e[o+1]>>4,z=15&e[o+1],F=e[o+2];d.componentsOrder.push(O),d.components[O]={h:R,v:z,quantizationIdx:F,blocksPerColumn:0,blocksPerLine:0,blocks:[],pred:0},o+=3}s(d),v.push(d);break;case 65476:var P=i();for(A=2;A<P;){var B=e[o++],L=new Uint8Array(16),N=0;for(D=0;D<16;D++,o++)N+=L[D]=e[o];h(16+N);var U=new Uint8Array(N);for(D=0;D<N;D++,o++)U[D]=e[o];A+=17+N,(B>>4===0?x:y)[15&B]=f(L,U)}break;case 65501:i(),u=i();break;case 65500:i(),i();break;case 65498:i();var V=e[o++],W=[];for(A=0;A<V;A++){var H=d.components[e[o++]],G=e[o++];H.huffmanTableDC=x[G>>4],H.huffmanTableAC=y[15&G],W.push(H)}var X=e[o++],Y=e[o++],q=e[o++],Z=g(e,o,d,W,u,X,Y,q>>4,15&q);o+=Z;break;case 65535:255!==e[o]&&o--;break;default:if(255==e[o-3]&&e[o-2]>=192&&e[o-2]<=254){o-=3;break}if(224===b||225==b){if(-1!==w)throw new Error("first unknown JPEG marker at offset ".concat(w.toString(16),", second unknown JPEG marker ").concat(b.toString(16)," at offset ").concat((o-1).toString(16)));w=o-1;var $=i();if(255===e[o+$-2]){o+=$-2;break}}throw new Error("unknown JPEG marker "+b.toString(16))}b=i()}if(1!=v.length)throw new Error("only single frame JPEGs supported");for(A=0;A<v.length;A++){var K=v[A].components;for(var D in K)K[D].quantizationTable=p[K[D].quantizationIdx],delete K[D].quantizationIdx}for(t.width=d.samplesPerLine,t.height=d.scanLines,t.jfif=l,t.adobe=c,t.components=[],A=0;A<d.componentsOrder.length;A++)H=d.components[d.componentsOrder[A]],t.components.push({lines:m(H),scaleX:H.h/d.maxH,scaleY:H.v/d.maxV});return t}(e);h(r.width*r.height*4);var o=function(e){var t=0,n=!1,r=e.width,o=e.height,i=r*o*e.components.length;h(i);var a=new Uint8Array(i);switch(e.components.length){case 1:for(var s=e.components[0],l=0;l<o;l++)for(var c=s.lines[0|l*s.scaleY],d=0;d<r;d++){var u=c[0|d*s.scaleX];a[t++]=u}break;case 2:s=e.components[0];var p=e.components[1];for(l=0;l<o;l++){c=s.lines[0|l*s.scaleY];var f=p.lines[0|l*p.scaleY];for(d=0;d<r;d++){var g=c[0|d*s.scaleX];a[t++]=g;var m=f[0|d*p.scaleX];a[t++]=m}}break;case 3:n=!0,e.adobe&&e.adobe.transformCode&&(n=!0),s=e.components[0],p=e.components[1];var y=e.components[2];for(l=0;l<o;l++){c=s.lines[0|l*s.scaleY],f=p.lines[0|l*p.scaleY];var x=y.lines[0|l*y.scaleY];for(d=0;d<r;d++){u=void 0;var b=void 0,w=void 0,S=void 0,k=void 0,C=void 0;n?(u=c[0|d*s.scaleX],b=f[0|d*p.scaleX],S=v(u+1.402*((w=x[0|d*y.scaleX])-128)),k=v(u-.3441363*(b-128)-.71413636*(w-128)),C=v(u+1.772*(b-128))):(S=c[0|d*s.scaleX],k=f[0|d*p.scaleX],C=x[0|d*y.scaleX]),a[t++]=S,a[t++]=k,a[t++]=C}}break;case 4:if(!e.adobe)throw new Error("Unsupported color mode (4 components)");n=!1,e.adobe&&e.adobe.transformCode&&(n=!0),s=e.components[0],p=e.components[1],y=e.components[2];var j=e.components[3];for(l=0;l<o;l++){c=s.lines[0|l*s.scaleY],f=p.lines[0|l*p.scaleY],x=y.lines[0|l*y.scaleY];var _=j.lines[0|l*j.scaleY];for(d=0;d<r;d++){u=void 0,b=void 0,w=void 0;var E=void 0,D=void 0,M=void 0,T=void 0;n?(u=c[0|d*s.scaleX],b=f[0|d*p.scaleX],w=x[0|d*y.scaleX],E=_[0|d*j.scaleX],D=255-v(u+1.402*(w-128)),M=255-v(u-.3441363*(b-128)-.71413636*(w-128)),T=255-v(u+1.772*(b-128))):(D=c[0|d*s.scaleX],M=f[0|d*p.scaleX],T=x[0|d*y.scaleX],E=_[0|d*j.scaleX]),a[t++]=255-D,a[t++]=255-M,a[t++]=255-T,a[t++]=255-E}}break;default:throw new Error("Unsupported color mode")}return a}(r),i=t(r.width,r.height),a=i.width,s=i.height,l=i.data,c=0,d=0;switch(r.components.length){case 1:for(var u=0;u<s;u++)for(var y=0;y<a;y++){var x=o[c++];l[d++]=x,l[d++]=x,l[d++]=x,l[d++]=255}break;case 3:for(u=0;u<s;u++)for(y=0;y<a;y++){var b=o[c++],w=o[c++],S=o[c++];l[d++]=b,l[d++]=w,l[d++]=S,l[d++]=255}break;case 4:for(u=0;u<s;u++)for(y=0;y<a;y++){var k=o[c++],C=o[c++],j=(x=o[c++],o[c++]);b=255-v(k*(1-j/255)+j),w=255-v(C*(1-j/255)+j),S=255-v(x*(1-j/255)+j);l[d++]=b,l[d++]=w,l[d++]=S,l[d++]=255}break;default:throw new Error("Unsupported color mode")}return i}},4992:(e,t,n)=>{"use strict";var r=n(2090),o=n(2557),i=n(4902),a=n(5558);e.exports=function(e,t,n){if(!e||"object"!==typeof e&&"function"!==typeof e)throw new i("`obj` must be an object or a function`");if("string"!==typeof t&&"symbol"!==typeof t)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!==typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!==typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!==typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!==typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,d=arguments.length>6&&arguments[6],u=!!a&&a(e,t);if(r)r(e,t,{configurable:null===c&&u?u.configurable:!c,enumerable:null===s&&u?u.enumerable:!s,value:n,writable:null===l&&u?u.writable:!l});else{if(!d&&(s||l||c))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},5029:(e,t,n)=>{var r=n(6989),o=n(3097),i=n(3366),a=n(2597),s=n(9417),l=n(1310),c=n(914);e.exports=function(e,t){return a(e)&&s(t)?l(c(e),t):function(n){var a=o(n,e);return void 0===a&&a===t?i(n,e):r(t,a,3)}}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5051:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5061:e=>{"use strict";e.exports=Function.prototype.apply},5077:e=>{"use strict";e.exports=ReferenceError},5111:(e,t,n)=>{var r=n(3279);e.exports=function(e){return"function"==typeof e?e:r}},5119:(e,t,n)=>{var r=n(6614),o=n(474);e.exports=function(e,t){return e&&r(t,o(t),e)}},5146:(e,t,n)=>{var r=n(8208),o=n(5641);function i(e,t,n,a,s,l,c){var d=e.children(c);if(d.length){var u=o.addBorderNode(e,"_bt"),p=o.addBorderNode(e,"_bb"),h=e.node(c);e.setParent(u,c),h.borderTop=u,e.setParent(p,c),h.borderBottom=p,r.forEach(d,function(r){i(e,t,n,a,s,l,r);var o=e.node(r),d=o.borderTop?o.borderTop:r,h=o.borderBottom?o.borderBottom:r,f=o.borderTop?a:2*a,g=d!==h?1:s-l[c]+1;e.setEdge(u,d,{weight:f,minlen:g,nestingEdge:!0}),e.setEdge(h,p,{weight:f,minlen:g,nestingEdge:!0})}),e.parent(c)||e.setEdge(t,u,{weight:0,minlen:s+l[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:n})}e.exports={run:function(e){var t=o.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(o,i){var a=e.children(o);a&&a.length&&r.forEach(a,function(e){n(e,i+1)}),t[o]=i}return r.forEach(e.children(),function(e){n(e,1)}),t}(e),a=r.max(r.values(n))-1,s=2*a+1;e.graph().nestingRoot=t,r.forEach(e.edges(),function(t){e.edge(t).minlen*=s});var l=function(e){return r.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}(e)+1;r.forEach(e.children(),function(r){i(e,t,s,l,a,n,r)}),e.graph().nodeRankFactor=s},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}}},5171:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.writeColor=t.writePsd=t.writeSection=t.writeUnicodeStringWithPadding=t.writeUnicodeString=t.writeUnicodeStringWithoutLengthLE=t.writeUnicodeStringWithoutLength=t.writePascalString=t.writeAsciiString=t.writeSignature=t.writeZeros=t.writeBytes=t.writeFixedPointPath32=t.writeFixedPoint32=t.writeFloat64=t.writeFloat32=t.writeUint32=t.writeInt32LE=t.writeInt32=t.writeUint16LE=t.writeUint16=t.writeInt16=t.writeUint8=t.getWriterBufferNoCopy=t.getWriterBuffer=t.createWriter=void 0;var o=n(6302),i=n(794),a=n(3305);function s(e,t){var n=_(e,1);e.view.setUint8(n,t)}function l(e,t){var n=_(e,2);e.view.setInt16(n,t,!1)}function c(e,t){var n=_(e,2);e.view.setUint16(n,t,!1)}function d(e,t){var n=_(e,2);e.view.setUint16(n,t,!0)}function u(e,t){var n=_(e,4);e.view.setInt32(n,t,!1)}function p(e,t){var n=_(e,4);e.view.setUint32(n,t,!1)}function h(e,t){var n=_(e,8);e.view.setFloat64(n,t,!1)}function f(e,t){t&&(j(e,e.offset+t.length),new Uint8Array(e.buffer).set(t,e.offset),e.offset+=t.length)}function g(e,t){for(var n=0;n<t;n++)s(e,0)}function m(e,t){if(4!==t.length)throw new Error("Invalid signature: '".concat(t,"'"));for(var n=0;n<4;n++)s(e,t.charCodeAt(n))}function v(e,t,n){var r=t.length;if(r>255)throw new Error("String too long");s(e,r);for(var o=0;o<r;o++){var i=t.charCodeAt(o);s(e,i<128?i:"?".charCodeAt(0))}for(;++r%n;)s(e,0)}function y(e,t){for(var n=0;n<t.length;n++)c(e,t.charCodeAt(n))}function x(e){void 0===e&&(e=[]);for(var t=0,n=0,r=e;n<r.length;n++){var o=r[n];if(o.canvas||o.imageData){var i=D(o),a=i.width,s=i.height;t=Math.max(t,2*s+2*a*s)}o.children&&(t=Math.max(t,x(o.children)))}return t}function b(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1),o&&p(e,0);var i=e.offset;p(e,0),n();for(var a=e.offset-i-4,l=a;l%t;)s(e,0),l++;r&&(a=l),e.view.setUint32(i,a,!1)}function w(e){var t;null===(t=e.children)||void 0===t||t.forEach(w);var n=e.imageData;if(n&&(n.data instanceof Uint32Array||n.data instanceof Uint16Array))throw new Error("imageData has incorrect bitDepth");if("mask"in e&&e.mask){var r=e.mask.imageData;if(r&&(r.data instanceof Uint32Array||r.data instanceof Uint16Array))throw new Error("mask imageData has incorrect bitDepth")}}function S(e,t){s(e,t[0]),s(e,t[1]),s(e,t[2]),s(e,t[3])}function k(e,t,n,r){for(var a=function(i){var a=i.key;if("Txt2"===a&&r.invalidateTextLayers)return"continue";if("vmsk"===a&&r.psb&&(a="vsms"),i.has(t)){var s=r.psb&&-1!==o.largeAdditionalInfoKeys.indexOf(a),l="Txt2"!==a&&"cinf"!==a&&"extn"!==a&&"CAI "!==a&&"OCIO"!==a,c="Txt2"===a||"luni"===a||"vmsk"===a||"artb"===a||"artd"===a||"vogk"===a||"SoLd"===a||"lnk2"===a||"vscg"===a||"vsms"===a||"GdFl"===a||"lmfx"===a||"lrFX"===a||"cinf"===a||"PlLd"===a||"Anno"===a||"CAI "===a||"OCIO"===a||"GenI"===a||"FEid"===a||"curv"===a||"CgEd"===a||"vibA"===a||"blwh"===a||"grdm"===a;m(e,s?"8B64":"8BIM"),m(e,a),b(e,c?4:2,function(){i.write(e,t,n,r)},l,s)}},s=0,l=i.infoHandlers;s<l.length;s++){a(l[s])}}function C(e,t){if(t)for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a.children&&a.canvas)throw new Error("Invalid layer, cannot have both 'canvas' and 'children' properties");if(a.children&&a.imageData)throw new Error("Invalid layer, cannot have both 'imageData' and 'children' properties");a.children?(e.push({name:"</Layer group>",sectionDivider:{type:3}}),C(e,a.children),e.push(r(r({},a),{blendMode:"pass through"===a.blendMode?"normal":a.blendMode,sectionDivider:{type:!1===a.opened?2:1,key:o.fromBlendMode[a.blendMode]||"pass",subType:0}}))):e.push(r({},a))}}function j(e,t){t>e.buffer.byteLength&&function(e,t){var n=e.buffer.byteLength;do{n*=2}while(t>n);var r=new ArrayBuffer(n),o=new Uint8Array(r),i=new Uint8Array(e.buffer);o.set(i),e.buffer=r,e.view=new DataView(e.buffer)}(e,t)}function _(e,t){var n=e.offset;return j(e,e.offset+=t),n}function E(e,t,n,r,i,a){var s,l,c=0|r.top,d=0|r.left,u=r.right,p=r.bottom,h=D(r),f=h.width,g=h.height,m=r.imageData;if(!m&&r.canvas&&f&&g&&(m=r.canvas.getContext("2d").getImageData(0,0,f,g)),m&&(m.width!==f||m.height!==g))throw new Error("Invalid imageData dimentions");u=d+f,p=c+g,o.RAW_IMAGE_DATA&&n[a?"realMaskDataRaw":"maskDataRaw"]?(s=n[a?"realMaskDataRaw":"maskDataRaw"],l=n[a?"realMaskDataRawCompression":"maskDataRawCompression"]):m?i.compress?(s=(0,o.writeDataZipWithoutPrediction)(m,[0]),l=2):(s=(0,o.writeDataRLE)(e,m,[0],!!i.psb),l=1):(s=new Uint8Array(0),l=1),t.channels.push({channelId:a?-3:-2,compression:l,buffer:s,length:2+s.length}),t[a?"realMask":"mask"]={top:c,left:d,right:u,bottom:p}}function D(e){var t,n,r,o,i=e.canvas,a=e.imageData;return{width:null!==(n=null!==(t=null===a||void 0===a?void 0:a.width)&&void 0!==t?t:null===i||void 0===i?void 0:i.width)&&void 0!==n?n:0,height:null!==(o=null!==(r=null===a||void 0===a?void 0:a.height)&&void 0!==r?r:null===i||void 0===i?void 0:i.height)&&void 0!==o?o:0}}function M(e,t,n,r){for(var o=e.data,i=4*(t*e.width+n)+3|0,a=i+4*(r-n)|0,s=i;s<a;s=s+4|0)if(0!==o[s])return!1;return!0}function T(e,t,n,r){for(var o=e.data,i=4*e.width|0,a=n,s=n*i+4*t+3|0;a<r;a++,s=s+i|0)if(0!==o[s])return!1;return!0}t.createWriter=function(e){void 0===e&&(e=4096);var t=new ArrayBuffer(e);return{buffer:t,view:new DataView(t),offset:0,tempBuffer:void 0}},t.getWriterBuffer=function(e){return e.buffer.slice(0,e.offset)},t.getWriterBufferNoCopy=function(e){return new Uint8Array(e.buffer,0,e.offset)},t.writeUint8=s,t.writeInt16=l,t.writeUint16=c,t.writeUint16LE=d,t.writeInt32=u,t.writeInt32LE=function(e,t){var n=_(e,4);e.view.setInt32(n,t,!0)},t.writeUint32=p,t.writeFloat32=function(e,t){var n=_(e,4);e.view.setFloat32(n,t,!1)},t.writeFloat64=h,t.writeFixedPoint32=function(e,t){u(e,65536*t)},t.writeFixedPointPath32=function(e,t){u(e,t*(1<<24))},t.writeBytes=f,t.writeZeros=g,t.writeSignature=m,t.writeAsciiString=function(e,t){for(var n=0;n<t.length;n++)s(e,t.charCodeAt(n))},t.writePascalString=v,t.writeUnicodeStringWithoutLength=y,t.writeUnicodeStringWithoutLengthLE=function(e,t){for(var n=0;n<t.length;n++)d(e,t.charCodeAt(n))},t.writeUnicodeString=function(e,t){p(e,t.length),y(e,t)},t.writeUnicodeStringWithPadding=function(e,t){p(e,t.length+1);for(var n=0;n<t.length;n++)c(e,t.charCodeAt(n));c(e,0)},t.writeSection=b,t.writePsd=function(e,t,n){var i;if(void 0===n&&(n={}),!(+t.width>0&&+t.height>0))throw new Error("Invalid document size");if((t.width>3e4||t.height>3e4)&&!n.psb)throw new Error("Document size is too large (max is 30000x30000, use PSB format instead)");var d=null!==(i=t.bitsPerChannel)&&void 0!==i?i:8;if(8!==d)throw new Error("bitsPerChannel other than 8 are not supported for writing");w(t);var y=r({},t.imageResources),j=r(r({},n),{layerIds:new Set,layerToId:new Map});j.generateThumbnail&&(y.thumbnail=function(e){var t=(0,o.createCanvas)(10,10),n=1;e.width>e.height?(t.width=160,t.height=Math.floor(e.height*(t.width/e.width)),n=t.width/e.width):(t.height=160,t.width=Math.floor(e.width*(t.height/e.height)),n=t.height/e.height);var r=t.getContext("2d");r.scale(n,n),e.imageData?r.drawImage((0,o.imageDataToCanvas)(e.imageData),0,0):e.canvas&&r.drawImage(e.canvas,0,0);return t}(t));var _=t.imageData;if(!_&&t.canvas&&(_=t.canvas.getContext("2d").getImageData(0,0,t.canvas.width,t.canvas.height)),_&&(t.width!==_.width||t.height!==_.height))throw new Error("Document canvas must have the same size as document");var I=!!_&&(0,o.hasAlpha)(_),A=Math.max(x(t.children),8*t.width*t.height+2*t.height);e.tempBuffer=new Uint8Array(A),m(e,"8BPS"),c(e,n.psb?2:1),g(e,6),c(e,I?4:3),p(e,t.height),p(e,t.width),c(e,d),c(e,3),b(e,1,function(){var n,r,o;if(t.palette){for(var i=0;i<256;i++)s(e,(null===(n=t.palette[i])||void 0===n?void 0:n.r)||0);for(i=0;i<256;i++)s(e,(null===(r=t.palette[i])||void 0===r?void 0:r.g)||0);for(i=0;i<256;i++)s(e,(null===(o=t.palette[i])||void 0===o?void 0:o.b)||0)}});var O=[];C(O,t.children),O.length||O.push({}),y.layersGroup=O.map(function(e){return e.linkGroup||0}),y.layerGroupsEnabledId=O.map(function(e){return 0==e.linkGroupEnabled?0:1}),b(e,1,function(){for(var t=function(t){for(var n=t.has(y),r=!1===n?0:!0===n?1:n,o=function(n){m(e,"8BIM"),c(e,t.key),v(e,"",2),b(e,2,function(){return t.write(e,y,n)})},i=0;i<r;i++)o(i)},n=0,r=a.resourceHandlers;n<r.length;n++){t(r[n])}}),b(e,2,function(){!function(e,t,n,r,i){b(e,4,function(){var a;l(e,r?-t.length:t.length);for(var d=t.map(function(t,n){return function(e,t,n,r){var i=function(e,t,n,r){var i,a=0|t.top,s=0|t.left,l=0|t.right,c=0|t.bottom,d=[{channelId:-1,compression:0,buffer:void 0,length:2},{channelId:0,compression:0,buffer:void 0,length:2},{channelId:1,compression:0,buffer:void 0,length:2},{channelId:2,compression:0,buffer:void 0,length:2}],u=D(t),p=u.width,h=u.height;if(!t.canvas&&!t.imageData||!p||!h)return{layer:t,top:a,left:s,right:l=s,bottom:c=a,channels:d};l=s+p,c=a+h;var f=t.imageData||t.canvas.getContext("2d").getImageData(0,0,p,h);if(r.trimImageData){var g=function(e){var t=0,n=0,r=e.width,o=e.height;for(;t<o&&M(e,t,n,r);)t++;for(;o>t&&M(e,o-1,n,r);)o--;for(;n<r&&T(e,n,t,o);)n++;for(;r>n&&T(e,r-1,t,o);)r--;return{top:t,left:n,right:r,bottom:o}}(f);if(0!==g.left||0!==g.top||g.right!==f.width||g.bottom!==f.height){if(s+=g.left,a+=g.top,l-=f.width-g.right,h=(c-=f.height-g.bottom)-a,!(p=l-s)||!h)return{layer:t,top:a,left:s,right:l,bottom:c,channels:d};f=function(e,t,n,r,i){if(e.data instanceof Uint32Array||e.data instanceof Uint16Array)throw new Error("imageData has incorrect bit depth");for(var a=(0,o.createImageData)(r,i),s=e.data,l=a.data,c=0;c<i;c++)for(var d=0;d<r;d++){var u=4*(d+t+(c+n)*e.width),p=4*(d+c*r);l[p]=s[u],l[p+1]=s[u+1],l[p+2]=s[u+2],l[p+3]=s[u+3]}return a}(f,g.left,g.top,p,h)}}var m=[0,1,2];(!n||r.noBackground||t.mask||(0,o.hasAlpha)(f)||o.RAW_IMAGE_DATA&&(null===(i=t.imageDataRaw)||void 0===i?void 0:i[-1]))&&m.unshift(-1);return d=m.map(function(n){var i,a,s=(0,o.offsetForChannel)(n,!1);return o.RAW_IMAGE_DATA&&t.imageDataRaw?(i=t.imageDataRaw[n],a=t.imageDataRawCompression[n]):r.compress?(i=(0,o.writeDataZipWithoutPrediction)(f,[s]),a=2):(i=(0,o.writeDataRLE)(e,f,[s],!!r.psb),a=1),{channelId:n,compression:a,buffer:i,length:2+i.length}}),{layer:t,top:a,left:s,right:l,bottom:c,channels:d}}(e,t,n,r);t.mask&&E(e,i,t,t.mask,r,!1);t.realMask&&E(e,i,t,t.realMask,r,!0);return i}(e.tempBuffer,t,0===n,i)}),y=function(t){var r=t.layer,d=t.top,f=t.left,y=t.bottom,x=t.right,w=t.channels;u(e,d),u(e,f),u(e,y),u(e,x),c(e,w.length);for(var C=0,j=w;C<j.length;C++){var _=j[C];l(e,_.channelId),i.psb&&p(e,0),p(e,_.length)}m(e,"8BIM"),m(e,o.fromBlendMode[r.blendMode]||"norm"),s(e,Math.round(255*(0,o.clamp)(null!==(a=r.opacity)&&void 0!==a?a:1,0,1))),s(e,r.clipping?1:0);var E=8;r.transparencyProtected&&(E|=1),r.hidden&&(E|=2),(r.vectorMask||r.sectionDivider&&0!==r.sectionDivider.type||r.adjustment)&&(E|=16),r.effectsOpen&&(E|=32),s(e,E),s(e,0),b(e,1,function(){!function(e,t,n){var r=t.mask,o=t.realMask;b(e,1,function(){if(r||o){var t=0,i=0,a=0;r&&(void 0!==r.userMaskDensity&&(t|=1),void 0!==r.userMaskFeather&&(t|=2),void 0!==r.vectorMaskDensity&&(t|=4),void 0!==r.vectorMaskFeather&&(t|=8),r.disabled&&(i|=2),r.positionRelativeToLayer&&(i|=1),r.fromVectorData&&(i|=8),t&&(i|=16));var l=n.mask||{};if(u(e,l.top||0),u(e,l.left||0),u(e,l.bottom||0),u(e,l.right||0),s(e,r&&r.defaultColor||0),s(e,i),o){o.disabled&&(a|=2),o.positionRelativeToLayer&&(a|=1),o.fromVectorData&&(a|=8);var c=n.realMask||{};s(e,a),s(e,o.defaultColor||0),u(e,c.top||0),u(e,c.left||0),u(e,c.bottom||0),u(e,c.right||0)}t&&r&&(s(e,t),void 0!==r.userMaskDensity&&s(e,Math.round(255*r.userMaskDensity)),void 0!==r.userMaskFeather&&h(e,r.userMaskFeather),void 0!==r.vectorMaskDensity&&s(e,Math.round(255*r.vectorMaskDensity)),void 0!==r.vectorMaskFeather&&h(e,r.vectorMaskFeather)),g(e,2)}})}(e,r,t),function(e,t){b(e,1,function(){var n=t.blendingRanges;if(n){S(e,n.compositeGrayBlendSource),S(e,n.compositeGraphBlendDestinationRange);for(var r=0,o=n.ranges;r<o.length;r++){var i=o[r];S(e,i.sourceRange),S(e,i.destRange)}}})}(e,r),v(e,(r.name||"").substring(0,255),4),k(e,r,n,i)})},x=0,w=d;x<w.length;x++){y(w[x])}for(var C=0,j=d;C<j.length;C++)for(var _=0,I=j[C].channels;_<I.length;_++){var A=I[_];c(e,A.compression),A.buffer&&f(e,A.buffer)}},!0,i.psb)}(e,O,t,I,j),function(e,t){b(e,1,function(){t&&(c(e,t.overlayColorSpace),c(e,t.colorSpace1),c(e,t.colorSpace2),c(e,t.colorSpace3),c(e,t.colorSpace4),c(e,255*t.opacity),s(e,t.kind),g(e,3))})}(e,t.globalLayerMaskInfo),k(e,t,t,j)},void 0,!!j.psb);var R=I?[0,1,2,3]:[0,1,2],z=_?_.width:t.width,F=_?_.height:t.height,P={data:new Uint8Array(z*F*4),width:z,height:F};if(c(e,1),o.RAW_IMAGE_DATA&&t.imageDataRaw)console.log("writing raw image data"),f(e,t.imageDataRaw);else{if(_&&P.data.set(new Uint8Array(_.data.buffer,_.data.byteOffset,_.data.byteLength)),I)for(var B=P.width*P.height*4,L=P.data,N=0;N<B;N+=4){var U=L[N+3];if(0!=U&&255!=U){var V=U/255,W=255*(1-V);L[N+0]=L[N+0]*V+W,L[N+1]=L[N+1]*V+W,L[N+2]=L[N+2]*V+W}}f(e,(0,o.writeDataRLE)(e.tempBuffer,P,R,!!n.psb))}},t.writeColor=function(e,t){t?"r"in t?(c(e,0),c(e,Math.round(257*t.r)),c(e,Math.round(257*t.g)),c(e,Math.round(257*t.b)),c(e,0)):"fr"in t?(c(e,0),c(e,Math.round(255*t.fr*257)),c(e,Math.round(255*t.fg*257)),c(e,Math.round(255*t.fb*257)),c(e,0)):"l"in t?(c(e,7),l(e,Math.round(1e4*t.l)),l(e,Math.round(t.a<0?12800*t.a:12700*t.a)),l(e,Math.round(t.b<0?12800*t.b:12700*t.b)),c(e,0)):"h"in t?(c(e,1),c(e,Math.round(65535*t.h)),c(e,Math.round(65535*t.s)),c(e,Math.round(65535*t.b)),c(e,0)):"c"in t?(c(e,2),c(e,Math.round(257*t.c)),c(e,Math.round(257*t.m)),c(e,Math.round(257*t.y)),c(e,Math.round(257*t.k))):(c(e,8),c(e,Math.round(1e4*t.k/255)),g(e,6)):(c(e,0),g(e,8))}},5185:e=>{e.exports="0.8.5"},5193:(e,t,n)=>{var r=n(6913),o=n(2761);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},5204:(e,t,n)=>{var r=n(7937)(n(6552),"Map");e.exports=r},5324:(e,t,n)=>{var r=n(4052),o=n(2597),i=n(4079),a=n(1069);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(a(e))}},5387:(e,t,n)=>{var r=n(7937)(n(6552),"Promise");e.exports=r},5428:(e,t,n)=>{var r=n(6913),o=n(6173),i=n(2761),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},5438:(e,t,n)=>{"use strict";var r=n(2),o=n(4992),i=n(2101)(),a=n(5558),s=n(4902),l=r("%Math.floor%");e.exports=function(e,t){if("function"!==typeof e)throw new s("`fn` is not a function");if("number"!==typeof t||t<0||t>4294967295||l(t)!==t)throw new s("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,c=!0;if("length"in e&&a){var d=a(e,"length");d&&!d.configurable&&(r=!1),d&&!d.writable&&(c=!1)}return(r||c||!n)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},5446:e=>{e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},5491:(e,t,n)=>{var r=n(726),o=n(5652),i=n(5111),a=n(4052);e.exports=function(e,t){return(a(e)?r:o)(e,i(t))}},5538:(e,t,n)=>{var r=n(7160),o=n(4545),i=n(793),a=n(7760),s=n(3892),l=n(6788);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=s,c.prototype.set=l,e.exports=c},5558:(e,t,n)=>{"use strict";var r=n(8258);if(r)try{r([],"length")}catch(o){r=null}e.exports=r},5575:(e,t,n)=>{var r=n(7937)(Object,"create");e.exports=r},5636:(e,t,n)=>{var r=n(1170),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),l=Array(s);++a<s;)l[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=n(l),r(e,this,c)}}},5640:(e,t,n)=>{var r=n(3713),o=n(6924),i=n(6571),a=n(620),s=n(1632);e.exports=function(e){if(null==e)return 0;if(i(e))return a(e)?s(e):e.length;var t=o(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},5641:(e,t,n)=>{"use strict";var r=n(8208),o=n(7938).Graph;function i(e,t,n,o){var i;do{i=r.uniqueId(o)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function a(e){return r.max(r.map(e.nodes(),function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n}))}e.exports={addDummyNode:i,simplify:function(e){var t=(new o).setGraph(e.graph());return r.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),r.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t},asNonCompoundGraph:function(e){var t=new o({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),r.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,l=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a);return{x:o+n,y:i+r}},buildLayerMatrix:function(e){var t=r.map(r.range(a(e)+1),function(){return[]});return r.forEach(e.nodes(),function(n){var o=e.node(n),i=o.rank;r.isUndefined(i)||(t[i][o.order]=n)}),t},normalizeRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank}));r.forEach(e.nodes(),function(n){var o=e.node(n);r.has(o,"rank")&&(o.rank-=t)})},removeEmptyRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank})),n=[];r.forEach(e.nodes(),function(r){var o=e.node(r).rank-t;n[o]||(n[o]=[]),n[o].push(r)});var o=0,i=e.graph().nodeRankFactor;r.forEach(n,function(t,n){r.isUndefined(t)&&n%i!==0?--o:o&&r.forEach(t,function(t){e.node(t).rank+=o})})},addBorderNode:function(e,t,n,r){var o={width:0,height:0};arguments.length>=4&&(o.rank=n,o.order=r);return i(e,"border",o,t)},maxRank:a,partition:function(e,t){var n={lhs:[],rhs:[]};return r.forEach(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n},time:function(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}},notime:function(e,t){return t()}}},5647:(e,t,n)=>{var r=n(3279),o=n(5636),i=n(6350);e.exports=function(e,t){return i(o(e,t,r),e+"")}},5652:(e,t,n)=>{var r=n(4664),o=n(6516)(r);e.exports=o},5654:(e,t,n)=>{var r=n(7937),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=o},5673:(e,t,n)=>{"use strict";var r=n(8208),o=n(3130);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?o(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},o={};function i(a){r.has(o,a)||(o[a]=!0,n[a]=!0,r.forEach(e.outEdges(a),function(e){r.has(n,e.w)?t.push(e):i(e.w)}),delete n[a])}return r.forEach(e.nodes(),i),t}(e);r.forEach(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))})},undo:function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}}},5713:e=>{e.exports=function(){}},5747:(e,t,n)=>{"use strict";var r=n(3864),o=n(5061),i=n(4937),a=n(4590);e.exports=a||r.call(i,o)},5750:(e,t,n)=>{var r;try{r={clone:n(1740),constant:n(2541),each:n(2580),filter:n(723),has:n(2117),isArray:n(4052),isEmpty:n(4320),isFunction:n(1629),isUndefined:n(141),keys:n(8673),map:n(3411),reduce:n(2759),size:n(5640),transform:n(2717),union:n(450),values:n(6727)}}catch(o){}r||(r=window._),e.exports=r},5752:(e,t,n)=>{var r=n(9395),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,a,s){var l=1&n,c=r(e),d=c.length;if(d!=r(t).length&&!l)return!1;for(var u=d;u--;){var p=c[u];if(!(l?p in t:o.call(t,p)))return!1}var h=s.get(e),f=s.get(t);if(h&&f)return h==t&&f==e;var g=!0;s.set(e,t),s.set(t,e);for(var m=l;++u<d;){var v=e[p=c[u]],y=t[p];if(i)var x=l?i(y,v,p,t,e,s):i(v,y,p,e,t,s);if(!(void 0===x?v===y||a(v,y,n,i,s):x)){g=!1;break}m||(m="constructor"==p)}if(g&&!m){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(g=!1)}return s.delete(e),s.delete(t),g}},5758:(e,t,n)=>{"use strict";var r=n(8208);e.exports={longestPath:function(e){var t={};r.forEach(e.sources(),function n(o){var i=e.node(o);if(r.has(t,o))return i.rank;t[o]=!0;var a=r.min(r.map(e.outEdges(o),function(t){return n(t.w)-e.edge(t).minlen}));return a!==Number.POSITIVE_INFINITY&&void 0!==a&&null!==a||(a=0),i.rank=a})},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},5791:(e,t,n)=>{var r=n(6924),o=n(2761);e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},5797:(e,t,n)=>{var r=n(4816);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},5816:e=>{e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},5819:(e,t,n)=>{"use strict";var r=n(8208);e.exports=function(e){var t={},n=r.filter(e.nodes(),function(t){return!e.children(t).length}),o=r.max(r.map(n,function(t){return e.node(t).rank})),i=r.map(r.range(o+1),function(){return[]});var a=r.sortBy(n,function(t){return e.node(t).rank});return r.forEach(a,function n(o){if(r.has(t,o))return;t[o]=!0;var a=e.node(o);i[a.rank].push(o),r.forEach(e.successors(o),n)}),i}},5822:(e,t,n)=>{var r=n(5750),o=n(4428);e.exports=function(e,t,n,r){return function(e,t,n,r){var i,a,s={},l=new o,c=function(e){var t=e.v!==i?e.v:e.w,r=s[t],o=n(e),c=a.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+o);c<r.distance&&(r.distance=c,r.predecessor=i,l.decrease(t,c))};e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},l.add(e,n)});for(;l.size()>0&&(i=l.removeMin(),(a=s[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(c);return s}(e,String(t),n||i,r||function(t){return e.outEdges(t)})};var i=r.constant(1)},5857:(e,t,n)=>{var r=n(819),o=n(5636),i=n(6350);e.exports=function(e){return i(o(e,void 0,r),e+"")}},5866:(e,t,n)=>{var r=n(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},5893:(e,t,n)=>{var r=n(6599);e.exports=function(e,t,n){for(var o=-1,i=e.criteria,a=t.criteria,s=i.length,l=n.length;++o<s;){var c=r(i[o],a[o]);if(c)return o>=l?c:c*("desc"==n[o]?-1:1)}return e.index-t.index}},5906:e=>{e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===n(i[l],l,i))break}return t}}},5921:(e,t,n)=>{var r=n(449),o=n(7574),i=n(6832),a=i&&i.isSet,s=a?o(a):r;e.exports=s},5972:(e,t,n)=>{var r=n(8208),o=n(5641);function i(e,t,n,r,i,a){var s={width:0,height:0,rank:a,borderType:t},l=i[t][a-1],c=o.addDummyNode(e,"border",s,n);i[t][a]=c,e.setParent(c,r),l&&e.setEdge(l,c,{weight:1})}e.exports=function(e){r.forEach(e.children(),function t(n){var o=e.children(n),a=e.node(n);if(o.length&&r.forEach(o,t),r.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var s=a.minRank,l=a.maxRank+1;s<l;++s)i(e,"borderLeft","_bl",n,a,s),i(e,"borderRight","_br",n,a,s)}})}},5990:(e,t,n)=>{var r=n(3028)(Object.getPrototypeOf,Object);e.exports=r},5992:(e,t,n)=>{var r=n(5750);e.exports=function(e){var t,n={},o=[];function i(o){r.has(n,o)||(n[o]=!0,t.push(o),r.each(e.successors(o),i),r.each(e.predecessors(o),i))}return r.each(e.nodes(),function(e){t=[],i(e),t.length&&o.push(t)}),o}},6095:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},6140:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},6142:(e,t,n)=>{"use strict";var r=n(3864),o=n(5061),i=n(5747);e.exports=function(){return i(r,o,arguments)}},6159:(e,t,n)=>{e.exports=function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return o(t[a][1][e]||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i=void 0,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";var r=e("./utils"),o=e("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,o,a,s,l,c,d=[],u=0,p=e.length,h=p,f="string"!==r.getTypeOf(e);u<e.length;)h=p-u,o=f?(t=e[u++],n=u<p?e[u++]:0,u<p?e[u++]:0):(t=e.charCodeAt(u++),n=u<p?e.charCodeAt(u++):0,u<p?e.charCodeAt(u++):0),a=t>>2,s=(3&t)<<4|n>>4,l=1<h?(15&n)<<2|o>>6:64,c=2<h?63&o:64,d.push(i.charAt(a)+i.charAt(s)+i.charAt(l)+i.charAt(c));return d.join("")},n.decode=function(e){var t,n,r,a,s,l,c=0,d=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var p,h=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===i.charAt(64)&&h--,e.charAt(e.length-2)===i.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(p=o.uint8array?new Uint8Array(0|h):new Array(0|h);c<e.length;)t=i.indexOf(e.charAt(c++))<<2|(a=i.indexOf(e.charAt(c++)))>>4,n=(15&a)<<4|(s=i.indexOf(e.charAt(c++)))>>2,r=(3&s)<<6|(l=i.indexOf(e.charAt(c++))),p[d++]=t,64!==s&&(p[d++]=n),64!==l&&(p[d++]=r);return p}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),o=e("./stream/DataWorker"),i=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,n,r,o){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=o}s.prototype={getContentWorker:function(){var e=new o(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new o(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new i).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),o=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var i=o,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var i=o,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^i[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r=null;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,o=e("pako"),i=e("./utils"),a=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",i.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(i.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function o(e,t,n,o,a,d){var u,p,h=e.file,f=e.compression,g=d!==s.utf8encode,m=i.transformTo("string",d(h.name)),v=i.transformTo("string",s.utf8encode(h.name)),y=h.comment,x=i.transformTo("string",d(y)),b=i.transformTo("string",s.utf8encode(y)),w=v.length!==h.name.length,S=b.length!==y.length,k="",C="",j="",_=h.dir,E=h.date,D={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(D.crc32=e.crc32,D.compressedSize=e.compressedSize,D.uncompressedSize=e.uncompressedSize);var M=0;t&&(M|=8),g||!w&&!S||(M|=2048);var T=0,I=0;_&&(T|=16),"UNIX"===a?(I=798,T|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(h.unixPermissions,_)):(I=20,T|=function(e){return 63&(e||0)}(h.dosPermissions)),u=E.getUTCHours(),u<<=6,u|=E.getUTCMinutes(),u<<=5,u|=E.getUTCSeconds()/2,p=E.getUTCFullYear()-1980,p<<=4,p|=E.getUTCMonth()+1,p<<=5,p|=E.getUTCDate(),w&&(C=r(1,1)+r(l(m),4)+v,k+="up"+r(C.length,2)+C),S&&(j=r(1,1)+r(l(x),4)+b,k+="uc"+r(j.length,2)+j);var A="";return A+="\n\0",A+=r(M,2),A+=f.magic,A+=r(u,2),A+=r(p,2),A+=r(D.crc32,4),A+=r(D.compressedSize,4),A+=r(D.uncompressedSize,4),A+=r(m.length,2),A+=r(k.length,2),{fileRecord:c.LOCAL_FILE_HEADER+A+m+k,dirRecord:c.CENTRAL_FILE_HEADER+r(I,2)+A+r(x.length,2)+"\0\0\0\0"+r(T,4)+r(o,4)+m+k+x}}var i=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function d(e,t,n,r){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(d,a),d.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=o(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=o(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,o=function(e,t,n,o,a){var s=i.transformTo("string",a(o));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:o,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},d.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),o=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var i=new o(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach(function(e,n){a++;var o=function(e,t){var n=e||t,o=r[n];if(!o)throw new Error(n+" is not a valid compression method !");return o}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(o,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(i)}),i.entriesCount=a}catch(e){i.error(e)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),o=e("./external"),i=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new o.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),l.isNode&&l.isStream(e)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new a(t);return n.load(e),n}).then(function(e){var n=[o.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var i=0;i<r.length;i++)n.push(c(r[i]));return o.Promise.all(n)}).then(function(e){for(var o=e.shift(),i=o.files,a=0;a<i.length;a++){var s=i[a],l=s.fileNameStr,c=r.resolve(s.fileNameStr);n.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(c).unsafeOriginalName=l)}return o.zipComment.length&&(n.comment=o.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),o=e("../stream/GenericWorker");function i(e,t){o.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(i,o),i.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function o(e,t,n){r.call(this,t),this._helper=e;var o=this;e.on("data",function(e,t){o.push(e)||o._helper.pause(),n&&n(t)}).on("error",function(e){o.emit("error",e)}).on("end",function(){o.push(null)})}e("../utils").inherits(o,r),o.prototype._read=function(){this._helper.resume()},t.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,o=i.getTypeOf(t),s=i.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(r=f(e))&&m.call(this,r,!0);var u="string"===o&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!u),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",o="string");var v=null;v=t instanceof c||t instanceof a?t:p.isNode&&p.isStream(t)?new h(e,t):i.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var y=new d(e,v,s);this.files[e]=y}var o=e("./utf8"),i=e("./utils"),a=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),p=e("./nodejsUtils"),h=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(v(e)){var o=e;return this.filter(function(e,t){return!t.dir&&o.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=m.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=u.generateWorker(this,n,r)}catch(e){(t=new a("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function o(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(o,r),o.prototype.byteAt=function(e){return this.data[this.zero+e]},o.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),o=e.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===t&&this.data[i+1]===n&&this.data[i+2]===r&&this.data[i+3]===o)return i-this.zero;return-1},o.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),o=e.charCodeAt(3),i=this.readData(4);return t===i[0]&&n===i[1]&&r===i[2]&&o===i[3]},o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function o(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=o},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function o(e){r.call(this,e)}e("../utils").inherits(o,r),o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function o(e){r.call(this,e)}e("../utils").inherits(o,r),o.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},o.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},o.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function o(e){r.call(this,e)}e("../utils").inherits(o,r),o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),o=e("../support"),i=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||o.uint8array?"nodebuffer"===t?new s(e):o.uint8array?new l(r.transformTo("uint8array",e)):new i(r.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),o=e("../utils");function i(e){r.call(this,"ConvertWorker to "+e),this.destType=e}o.inherits(i,r),i.prototype.processChunk=function(e){this.push({data:o.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),o=e("../crc32");function i(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(i,r),i.prototype.processChunk=function(e){this.streamInfo.crc32=o(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),o=e("./GenericWorker");function i(e){o.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(i,o),i.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}o.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),o=e("./GenericWorker");function i(e){o.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(i,o),i.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),o=e("./ConvertWorker"),i=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function d(e,t){return new l.Promise(function(n,o){var i=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){i.push(e),t&&t(n)}).on("error",function(e){i=[],o(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,o=null,i=0;for(n=0;n<t.length;n++)i+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(o=new Uint8Array(i),n=0;n<t.length;n++)o.set(t[n],r),r+=t[n].length;return o;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,i),c);n(e)}catch(e){o(e)}i=[]}).resume()})}function u(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,r.checkSupport(a),this._worker=e.pipe(new o(a)),e.lock()}catch(e){this._worker=new i("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return d(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(r),n.blob=0===o.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),o=e("./support"),i=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function d(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return o.nodebuffer?i.newBufferFrom(e,"utf-8"):function(e){var t,n,r,i,a,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=o.uint8array?new Uint8Array(l):new Array(l),i=a=0;a<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return o.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,o,i,a=e.length,l=new Array(2*a);for(t=n=0;t<a;)if((o=e[t++])<128)l[n++]=o;else if(4<(i=s[o]))l[n++]=65533,t+=i-1;else{for(o&=2===i?31:3===i?15:7;1<i&&t<a;)o=o<<6|63&e[t++],i--;1<i?l[n++]=65533:o<65536?l[n++]=o:(o-=65536,l[n++]=55296|o>>10&1023,l[n++]=56320|1023&o)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(o.uint8array?"uint8array":"array",e))},r.inherits(c,a),c.prototype.processChunk=function(e){var t=r.transformTo(o.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;a!==t.length&&(o.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(d,a),d.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),o=e("./base64"),i=e("./nodejsUtils"),a=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(t,r){n.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return o.append(t),o.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var r=[],o=0,i=e.length;if(i<=n)return String.fromCharCode.apply(null,e);for(;o<i;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+n,i)))):r.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+n,i)))),o+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,i.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,r=n.getTypeOf(e),o=!0;if("uint8array"===r?o=c.applyCanBeUsed.uint8array:"nodebuffer"===r&&(o=c.applyCanBeUsed.nodebuffer),o)for(;1<t;)try{return c.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=d;var p={};p.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,i.allocBuffer(e.length))}},p.array={string:d,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(e)}},p.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return i.newBufferFrom(e)}},p.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return p[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var o=t[r];"."===o||""===o&&0!==r&&r!==t.length-1||(".."===o?n.pop():n.push(o))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&i.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,i,s,c){return a.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var d=n.getTypeOf(t);return d?("arraybuffer"===d?t=n.transformTo("uint8array",t):"string"===d&&(c?t=o.decode(t):i&&!0!==s&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),o=e("./utils"),i=e("./signature"),a=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(t)+", expected "+o.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=o.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,i.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),o=e("./utils"),i=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,o=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<o;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(o)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=o.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var i=o.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var o=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!r&&(t=t.pipe(new a.Utf8EncodeWorker)),!i&&r&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new o(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new i(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)r.prototype[c[u]]=d;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,a=new o(d),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,n=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||n()}}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function o(){}var i={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){r(function(){var r;try{r=t(n)}catch(r){return i.reject(e,r)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)})}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}var a=f(function(){t(o,r)});"error"===a.status&&r(a.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(o);return this.state!==l?u(n,this.state===s?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){i.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=f(p,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;for(var o=-1,a=e.queue.length;++o<a;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:i.resolve(new this(o),e)},c.reject=function(e){var t=new this(o);return i.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,c=new this(o);++l<n;)d(e[l],l);return c;function d(e,o){t.resolve(e).then(function(e){a[o]=e,++s!==n||r||(r=!0,i.resolve(c,a))},function(e){r||(r=!0,i.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a,s=-1,l=new this(o);++s<n;)a=e[s],t.resolve(a).then(function(e){r||(r=!0,i.resolve(l,e))},function(e){r||(r=!0,i.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),o=e("./utils/common"),i=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,d=-1,u=0,p=8;function h(e){if(!(this instanceof h))return new h(e);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,f))!==c)throw new Error(a[n]);this._dict_set=!0}}function f(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}h.prototype.push=function(e,t){var n,a,s=this.strm,d=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new o.Buf8(d),s.next_out=0,s.avail_out=d),1!==(n=r.deflate(s,a))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(i.buf2binstring(o.shrinkBuf(s.output,s.next_out))):this.onData(o.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==a||(this.onEnd(c),!(s.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=h,n.deflate=f,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),o=e("./utils/common"),i=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function p(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}u.prototype.push=function(e,t){var n,s,l,c,u,p,h=this.strm,f=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?h.input=i.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new o.Buf8(f),h.next_out=0,h.avail_out=f),(n=r.inflate(h,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(p="string"==typeof g?i.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,n=r.inflateSetDictionary(this.strm,p)),n===a.Z_BUF_ERROR&&!0===m&&(n=a.Z_OK,m=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),!(this.ended=!0);h.next_out&&(0!==h.avail_out&&n!==a.Z_STREAM_END&&(0!==h.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(h.output,h.next_out),c=h.next_out-l,u=i.buf2string(h.output,l),h.next_out=c,h.avail_out=f-c,c&&o.arraySet(h.output,h.output,l,c,0),this.onData(u)):this.onData(o.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(m=!0)}while((0<h.avail_in||0===h.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(h.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=p,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},n.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,r,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),o);else for(var i=0;i<r;i++)e[o+i]=t[n+i]},flattenChunks:function(e){var t,n,r,o,i,a;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),t=o=0,n=e.length;t<n;t++)i=e[t],a.set(i,o),o+=i.length;return a}},i={arraySet:function(e,t,n,r,o){for(var i=0;i<r;i++)e[o+i]=t[n+i]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,i))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),o=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,o,i,a,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(o=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(o-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),i=a=0;a<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(o=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(o-56320),i++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,o=t.length;n<o;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,o,i,s=t||e.length,c=new Array(2*s);for(n=r=0;n<s;)if((o=e[n++])<128)c[r++]=o;else if(4<(i=a[o]))c[r++]=65533,n+=i-1;else{for(o&=2===i?31:3===i?15:7;1<i&&n<s;)o=o<<6|63&e[n++],i--;1<i?c[r++]=65533:o<65536?c[r++]=o:(o-=65536,c[r++]=55296|o>>10&1023,c[r++]=56320|1023&o)}return l(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var o=65535&e,i=e>>>16&65535,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;i=i+(o=o+t[r++]|0)|0,--a;);o%=65521,i%=65521}return o|i<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,o){var i=r,a=o+n;e^=-1;for(var s=o;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,o=e("../utils/common"),i=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=0,d=4,u=0,p=-2,h=-1,f=4,g=2,m=8,v=9,y=286,x=30,b=19,w=2*y+1,S=15,k=3,C=258,j=C+k+1,_=42,E=113,D=1,M=2,T=3,I=4;function A(e,t){return e.msg=l[t],t}function O(e){return(e<<1)-(4<e?9:0)}function R(e){for(var t=e.length;0<=--t;)e[t]=0}function z(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(o.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function F(e,t){i._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,z(e.strm)}function P(e,t){e.pending_buf[e.pending++]=t}function B(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function L(e,t){var n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-j?e.strstart-(e.w_size-j):0,c=e.window,d=e.w_mask,u=e.prev,p=e.strstart+C,h=c[i+a-1],f=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===f&&c[n+a-1]===h&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(r=C-(p-i),i=p-C,a<r){if(e.match_start=t,s<=(a=r))break;h=c[i+a-1],f=c[i+a]}}}while((t=u[t&d])>l&&0!=--o);return a<=e.lookahead?a:e.lookahead}function N(e){var t,n,r,i,l,c,d,u,p,h,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-j)){for(o.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;r=e.head[--t],e.head[t]=f<=r?r-f:0,--n;);for(t=n=f;r=e.prev[--t],e.prev[t]=f<=r?r-f:0,--n;);i+=f}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,h=void 0,(p=i)<(h=c.avail_in)&&(h=p),n=0===h?0:(c.avail_in-=h,o.arraySet(d,c.input,c.next_in,h,u),1===c.state.wrap?c.adler=a(c.adler,d,h,u):2===c.state.wrap&&(c.adler=s(c.adler,d,h,u)),c.next_in+=h,c.total_in+=h,h),e.lookahead+=n,e.lookahead+e.insert>=k)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+k-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<j&&0!==e.strm.avail_in)}function U(e,t){for(var n,r;;){if(e.lookahead<j){if(N(e),e.lookahead<j&&t===c)return D;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-j&&(e.match_length=L(e,n)),e.match_length>=k)if(r=i._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(F(e,!1),0===e.strm.avail_out))return D}return e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(F(e,!0),0===e.strm.avail_out?T:I):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?D:M}function V(e,t){for(var n,r,o;;){if(e.lookahead<j){if(N(e),e.lookahead<j&&t===c)return D;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-j&&(e.match_length=L(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===k&&4096<e.strstart-e.match_start)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){for(o=e.strstart+e.lookahead-k,r=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=k-1,e.strstart++,r&&(F(e,!1),0===e.strm.avail_out))return D}else if(e.match_available){if((r=i._tr_tally(e,0,e.window[e.strstart-1]))&&F(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return D}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(F(e,!0),0===e.strm.avail_out?T:I):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?D:M}function W(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*w),this.dyn_dtree=new o.Buf16(2*(2*x+1)),this.bl_tree=new o.Buf16(2*(2*b+1)),R(this.dyn_ltree),R(this.dyn_dtree),R(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(S+1),this.heap=new o.Buf16(2*y+1),R(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*y+1),R(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=g,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?_:E,e.adler=2===t.wrap?0:1,t.last_flush=c,i._tr_init(t),u):A(e,p)}function X(e){var t=G(e);return t===u&&function(e){e.window_size=2*e.w_size,R(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=k-1,e.match_available=0,e.ins_h=0}(e.state),t}function Y(e,t,n,r,i,a){if(!e)return p;var s=1;if(t===h&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),i<1||v<i||n!==m||r<8||15<r||t<0||9<t||a<0||f<a)return A(e,p);8===r&&(r=9);var l=new H;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+k-1)/k),l.window=new o.Buf8(2*l.w_size),l.head=new o.Buf16(l.hash_size),l.prev=new o.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new o.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,X(e)}r=[new W(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(N(e),0===e.lookahead&&t===c)return D;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,F(e,!1),0===e.strm.avail_out))return D;if(e.strstart-e.block_start>=e.w_size-j&&(F(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===d?(F(e,!0),0===e.strm.avail_out?T:I):(e.strstart>e.block_start&&(F(e,!1),e.strm.avail_out),D)}),new W(4,4,8,4,U),new W(4,5,16,8,U),new W(4,6,32,32,U),new W(4,4,16,16,V),new W(8,16,32,32,V),new W(8,16,128,128,V),new W(8,32,128,256,V),new W(32,128,258,1024,V),new W(32,258,258,4096,V)],n.deflateInit=function(e,t){return Y(e,t,m,15,8,0)},n.deflateInit2=Y,n.deflateReset=X,n.deflateResetKeep=G,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?p:(e.state.gzhead=t,u):p},n.deflate=function(e,t){var n,o,a,l;if(!e||!e.state||5<t||t<0)return e?A(e,p):p;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||666===o.status&&t!==d)return A(e,0===e.avail_out?-5:p);if(o.strm=e,n=o.last_flush,o.last_flush=t,o.status===_)if(2===o.wrap)e.adler=0,P(o,31),P(o,139),P(o,8),o.gzhead?(P(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),P(o,255&o.gzhead.time),P(o,o.gzhead.time>>8&255),P(o,o.gzhead.time>>16&255),P(o,o.gzhead.time>>24&255),P(o,9===o.level?2:2<=o.strategy||o.level<2?4:0),P(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(P(o,255&o.gzhead.extra.length),P(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=s(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(P(o,0),P(o,0),P(o,0),P(o,0),P(o,0),P(o,9===o.level?2:2<=o.strategy||o.level<2?4:0),P(o,3),o.status=E);else{var h=m+(o.w_bits-8<<4)<<8;h|=(2<=o.strategy||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(h|=32),h+=31-h%31,o.status=E,B(o,h),0!==o.strstart&&(B(o,e.adler>>>16),B(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),z(e),a=o.pending,o.pending!==o.pending_buf_size));)P(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),z(e),a=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,P(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),0===l&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),z(e),a=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,P(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),0===l&&(o.status=103)}else o.status=103;if(103===o.status&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&z(e),o.pending+2<=o.pending_buf_size&&(P(o,255&e.adler),P(o,e.adler>>8&255),e.adler=0,o.status=E)):o.status=E),0!==o.pending){if(z(e),0===e.avail_out)return o.last_flush=-1,u}else if(0===e.avail_in&&O(t)<=O(n)&&t!==d)return A(e,-5);if(666===o.status&&0!==e.avail_in)return A(e,-5);if(0!==e.avail_in||0!==o.lookahead||t!==c&&666!==o.status){var f=2===o.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(N(e),0===e.lookahead)){if(t===c)return D;break}if(e.match_length=0,n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(F(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===d?(F(e,!0),0===e.strm.avail_out?T:I):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?D:M}(o,t):3===o.strategy?function(e,t){for(var n,r,o,a,s=e.window;;){if(e.lookahead<=C){if(N(e),e.lookahead<=C&&t===c)return D;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&0<e.strstart&&(r=s[o=e.strstart-1])===s[++o]&&r===s[++o]&&r===s[++o]){a=e.strstart+C;do{}while(r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&o<a);e.match_length=C-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(n=i._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(F(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===d?(F(e,!0),0===e.strm.avail_out?T:I):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?D:M}(o,t):r[o.level].func(o,t);if(f!==T&&f!==I||(o.status=666),f===D||f===T)return 0===e.avail_out&&(o.last_flush=-1),u;if(f===M&&(1===t?i._tr_align(o):5!==t&&(i._tr_stored_block(o,0,0,!1),3===t&&(R(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),z(e),0===e.avail_out))return o.last_flush=-1,u}return t!==d?u:o.wrap<=0?1:(2===o.wrap?(P(o,255&e.adler),P(o,e.adler>>8&255),P(o,e.adler>>16&255),P(o,e.adler>>24&255),P(o,255&e.total_in),P(o,e.total_in>>8&255),P(o,e.total_in>>16&255),P(o,e.total_in>>24&255)):(B(o,e.adler>>>16),B(o,65535&e.adler)),z(e),0<o.wrap&&(o.wrap=-o.wrap),0!==o.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==_&&69!==t&&73!==t&&91!==t&&103!==t&&t!==E&&666!==t?A(e,p):(e.state=null,t===E?A(e,-3):u):p},n.deflateSetDictionary=function(e,t){var n,r,i,s,l,c,d,h,f=t.length;if(!e||!e.state)return p;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==_||n.lookahead)return p;for(1===s&&(e.adler=a(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(R(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new o.Buf8(n.w_size),o.arraySet(h,t,f-n.w_size,n.w_size,0),t=h,f=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,N(n);n.lookahead>=k;){for(r=n.strstart,i=n.lookahead-(k-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+k-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--i;);n.strstart=r,n.lookahead=k-1,N(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=k-1,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=s,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,o,i,a,s,l,c,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_;n=e.state,r=e.next_in,j=e.input,o=r+(e.avail_in-5),i=e.next_out,_=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),l=n.dmax,c=n.wsize,d=n.whave,u=n.wnext,p=n.window,h=n.hold,f=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(h+=j[r++]<<f,f+=8,h+=j[r++]<<f,f+=8),x=g[h&v];t:for(;;){if(h>>>=b=x>>>24,f-=b,0===(b=x>>>16&255))_[i++]=65535&x;else{if(!(16&b)){if(0==(64&b)){x=g[(65535&x)+(h&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&x,(b&=15)&&(f<b&&(h+=j[r++]<<f,f+=8),w+=h&(1<<b)-1,h>>>=b,f-=b),f<15&&(h+=j[r++]<<f,f+=8,h+=j[r++]<<f,f+=8),x=m[h&y];n:for(;;){if(h>>>=b=x>>>24,f-=b,!(16&(b=x>>>16&255))){if(0==(64&b)){x=m[(65535&x)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(S=65535&x,f<(b&=15)&&(h+=j[r++]<<f,(f+=8)<b&&(h+=j[r++]<<f,f+=8)),l<(S+=h&(1<<b)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=b,f-=b,(b=i-a)<S){if(d<(b=S-b)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(C=p,(k=0)===u){if(k+=c-b,b<w){for(w-=b;_[i++]=p[k++],--b;);k=i-S,C=_}}else if(u<b){if(k+=c+u-b,(b-=u)<w){for(w-=b;_[i++]=p[k++],--b;);if(k=0,u<w){for(w-=b=u;_[i++]=p[k++],--b;);k=i-S,C=_}}}else if(k+=u-b,b<w){for(w-=b;_[i++]=p[k++],--b;);k=i-S,C=_}for(;2<w;)_[i++]=C[k++],_[i++]=C[k++],_[i++]=C[k++],w-=3;w&&(_[i++]=C[k++],1<w&&(_[i++]=C[k++]))}else{for(k=i-S;_[i++]=_[k++],_[i++]=_[k++],_[i++]=_[k++],2<(w-=3););w&&(_[i++]=_[k++],1<w&&(_[i++]=_[k++]))}break}}break}}while(r<o&&i<s);r-=w=f>>3,h&=(1<<(f-=w<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<o?o-r+5:5-(r-o),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=h,n.bits=f}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),o=e("./adler32"),i=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=1,c=2,d=0,u=-2,p=1,h=852,f=592;function g(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=p,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(h),t.distcode=t.distdyn=new r.Buf32(f),t.sane=1,t.back=-1,d):u}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,v(e)):u}function x(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,y(e))):u}function b(e,t){var n,r;return e?(r=new m,(e.state=r).window=null,(n=x(e,t))!==d&&(e.state=null),n):u}var w,S,k=!0;function C(e){if(k){var t;for(w=new r.Buf32(512),S=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(c,e.lens,0,32,S,0,e.work,{bits:5}),k=!1}e.lencode=w,e.lenbits=9,e.distcode=S,e.distbits=5}function j(e,t,n,o){var i,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),o>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(o<(i=a.wsize-a.wnext)&&(i=o),r.arraySet(a.window,t,n-o,i,a.wnext),(o-=i)?(r.arraySet(a.window,t,n-o,o,0),a.wnext=o,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}n.inflateReset=y,n.inflateReset2=x,n.inflateResetKeep=v,n.inflateInit=function(e){return b(e,15)},n.inflateInit2=b,n.inflate=function(e,t){var n,h,f,m,v,y,x,b,w,S,k,_,E,D,M,T,I,A,O,R,z,F,P,B,L=0,N=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),v=e.next_out,f=e.output,x=e.avail_out,m=e.next_in,h=e.input,y=e.avail_in,b=n.hold,w=n.bits,S=y,k=x,F=d;e:for(;;)switch(n.mode){case p:if(0===n.wrap){n.mode=13;break}for(;w<16;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(2&n.wrap&&35615===b){N[n.check=0]=255&b,N[1]=b>>>8&255,n.check=i(n.check,N,2,0),w=b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&b)){e.msg="unknown compression method",n.mode=30;break}if(w-=4,z=8+(15&(b>>>=4)),0===n.wbits)n.wbits=z;else if(z>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<z,e.adler=n.check=1,n.mode=512&b?10:12,w=b=0;break;case 2:for(;w<16;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(n.flags=b,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=i(n.check,N,2,0)),w=b=0,n.mode=3;case 3:for(;w<32;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.head&&(n.head.time=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,N[2]=b>>>16&255,N[3]=b>>>24&255,n.check=i(n.check,N,4,0)),w=b=0,n.mode=4;case 4:for(;w<16;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=i(n.check,N,2,0)),w=b=0,n.mode=5;case 5:if(1024&n.flags){for(;w<16;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=i(n.check,N,2,0)),w=b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(y<(_=n.length)&&(_=y),_&&(n.head&&(z=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,h,m,_,z)),512&n.flags&&(n.check=i(n.check,h,_,m)),y-=_,m+=_,n.length-=_),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===y)break e;for(_=0;z=h[m+_++],n.head&&z&&n.length<65536&&(n.head.name+=String.fromCharCode(z)),z&&_<y;);if(512&n.flags&&(n.check=i(n.check,h,_,m)),y-=_,m+=_,z)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===y)break e;for(_=0;z=h[m+_++],n.head&&z&&n.length<65536&&(n.head.comment+=String.fromCharCode(z)),z&&_<y;);if(512&n.flags&&(n.check=i(n.check,h,_,m)),y-=_,m+=_,z)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;w<16;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(b!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}w=b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;w<32;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}e.adler=n.check=g(b),w=b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=v,e.avail_out=x,e.next_in=m,e.avail_in=y,n.hold=b,n.bits=w,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){b>>>=7&w,w-=7&w,n.mode=27;break}for(;w<3;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}switch(n.last=1&b,w-=1,3&(b>>>=1)){case 0:n.mode=14;break;case 1:if(C(n),n.mode=20,6!==t)break;b>>>=2,w-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}b>>>=2,w-=2;break;case 14:for(b>>>=7&w,w-=7&w;w<32;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&b,w=b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(_=n.length){if(y<_&&(_=y),x<_&&(_=x),0===_)break e;r.arraySet(f,h,m,_,v),y-=_,m+=_,x-=_,v+=_,n.length-=_;break}n.mode=12;break;case 17:for(;w<14;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(n.nlen=257+(31&b),b>>>=5,w-=5,n.ndist=1+(31&b),b>>>=5,w-=5,n.ncode=4+(15&b),b>>>=4,w-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;w<3;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.lens[U[n.have++]]=7&b,b>>>=3,w-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},F=s(0,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,F){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;T=(L=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,I=65535&L,!((M=L>>>24)<=w);){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(I<16)b>>>=M,w-=M,n.lens[n.have++]=I;else{if(16===I){for(B=M+2;w<B;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(b>>>=M,w-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}z=n.lens[n.have-1],_=3+(3&b),b>>>=2,w-=2}else if(17===I){for(B=M+3;w<B;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}w-=M,z=0,_=3+(7&(b>>>=M)),b>>>=3,w-=3}else{for(B=M+7;w<B;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}w-=M,z=0,_=11+(127&(b>>>=M)),b>>>=7,w-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;_--;)n.lens[n.have++]=z}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,P={bits:n.lenbits},F=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,F){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},F=s(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,F){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=y&&258<=x){e.next_out=v,e.avail_out=x,e.next_in=m,e.avail_in=y,n.hold=b,n.bits=w,a(e,k),v=e.next_out,f=e.output,x=e.avail_out,m=e.next_in,h=e.input,y=e.avail_in,b=n.hold,w=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;T=(L=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,I=65535&L,!((M=L>>>24)<=w);){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(T&&0==(240&T)){for(A=M,O=T,R=I;T=(L=n.lencode[R+((b&(1<<A+O)-1)>>A)])>>>16&255,I=65535&L,!(A+(M=L>>>24)<=w);){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}b>>>=A,w-=A,n.back+=A}if(b>>>=M,w-=M,n.back+=M,n.length=I,0===T){n.mode=26;break}if(32&T){n.back=-1,n.mode=12;break}if(64&T){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&T,n.mode=22;case 22:if(n.extra){for(B=n.extra;w<B;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;T=(L=n.distcode[b&(1<<n.distbits)-1])>>>16&255,I=65535&L,!((M=L>>>24)<=w);){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(0==(240&T)){for(A=M,O=T,R=I;T=(L=n.distcode[R+((b&(1<<A+O)-1)>>A)])>>>16&255,I=65535&L,!(A+(M=L>>>24)<=w);){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}b>>>=A,w-=A,n.back+=A}if(b>>>=M,w-=M,n.back+=M,64&T){e.msg="invalid distance code",n.mode=30;break}n.offset=I,n.extra=15&T,n.mode=24;case 24:if(n.extra){for(B=n.extra;w<B;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===x)break e;if(_=k-x,n.offset>_){if((_=n.offset-_)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}E=_>n.wnext?(_-=n.wnext,n.wsize-_):n.wnext-_,_>n.length&&(_=n.length),D=n.window}else D=f,E=v-n.offset,_=n.length;for(x<_&&(_=x),x-=_,n.length-=_;f[v++]=D[E++],--_;);0===n.length&&(n.mode=21);break;case 26:if(0===x)break e;f[v++]=n.length,x--,n.mode=21;break;case 27:if(n.wrap){for(;w<32;){if(0===y)break e;y--,b|=h[m++]<<w,w+=8}if(k-=x,e.total_out+=k,n.total+=k,k&&(e.adler=n.check=n.flags?i(n.check,f,k,v-k):o(n.check,f,k,v-k)),k=x,(n.flags?b:g(b))!==n.check){e.msg="incorrect data check",n.mode=30;break}w=b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;w<32;){if(0===y)break e;y--,b+=h[m++]<<w,w+=8}if(b!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}w=b=0}n.mode=29;case 29:F=1;break e;case 30:F=-3;break e;case 31:return-4;default:return u}return e.next_out=v,e.avail_out=x,e.next_in=m,e.avail_in=y,n.hold=b,n.bits=w,(n.wsize||k!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&j(e,e.output,e.next_out,k-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,k-=e.avail_out,e.total_in+=S,e.total_out+=k,n.total+=k,n.wrap&&k&&(e.adler=n.check=n.flags?i(n.check,f,k,e.next_out-k):o(n.check,f,k,e.next_out-k)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==S&&0===k||4===t)&&F===d&&(F=-5),F)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,d},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?u:((n.head=t).done=!1,d):u},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&o(1,t,r,0)!==n.check?-3:j(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,d):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,d,u,p){var h,f,g,m,v,y,x,b,w,S=p.bits,k=0,C=0,j=0,_=0,E=0,D=0,M=0,T=0,I=0,A=0,O=null,R=0,z=new r.Buf16(16),F=new r.Buf16(16),P=null,B=0;for(k=0;k<=15;k++)z[k]=0;for(C=0;C<l;C++)z[t[n+C]]++;for(E=S,_=15;1<=_&&0===z[_];_--);if(_<E&&(E=_),0===_)return c[d++]=20971520,c[d++]=20971520,p.bits=1,0;for(j=1;j<_&&0===z[j];j++);for(E<j&&(E=j),k=T=1;k<=15;k++)if(T<<=1,(T-=z[k])<0)return-1;if(0<T&&(0===e||1!==_))return-1;for(F[1]=0,k=1;k<15;k++)F[k+1]=F[k]+z[k];for(C=0;C<l;C++)0!==t[n+C]&&(u[F[t[n+C]]++]=C);if(y=0===e?(O=P=u,19):1===e?(O=o,R-=257,P=i,B-=257,256):(O=a,P=s,-1),k=j,v=d,M=C=A=0,g=-1,m=(I=1<<(D=E))-1,1===e&&852<I||2===e&&592<I)return 1;for(;;){for(x=k-M,w=u[C]<y?(b=0,u[C]):u[C]>y?(b=P[B+u[C]],O[R+u[C]]):(b=96,0),h=1<<k-M,j=f=1<<D;c[v+(A>>M)+(f-=h)]=x<<24|b<<16|w,0!==f;);for(h=1<<k-1;A&h;)h>>=1;if(0!==h?(A&=h-1,A+=h):A=0,C++,0==--z[k]){if(k===_)break;k=t[n+u[C]]}if(E<k&&(A&m)!==g){for(0===M&&(M=E),v+=j,T=1<<(D=k-M);D+M<_&&!((T-=z[D+M])<=0);)D++,T<<=1;if(I+=1<<D,1===e&&852<I||2===e&&592<I)return 1;c[g=A&m]=E<<24|D<<16|v-d}}return 0!==A&&(c[v+A]=k-M<<24|64<<16),p.bits=E,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common"),o=0,i=1;function a(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,c=256,d=c+1+l,u=30,p=19,h=2*d+1,f=15,g=16,m=7,v=256,y=16,x=17,b=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(2*(d+2));a(j);var _=new Array(2*u);a(_);var E=new Array(512);a(E);var D=new Array(256);a(D);var M=new Array(l);a(M);var T,I,A,O=new Array(u);function R(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}function z(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function F(e){return e<256?E[e]:E[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function B(e,t,n){e.bi_valid>g-n?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>g-e.bi_valid,e.bi_valid+=n-g):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function L(e,t,n){B(e,n[2*t],n[2*t+1])}function N(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function U(e,t,n){var r,o,i=new Array(f+1),a=0;for(r=1;r<=f;r++)i[r]=a=a+n[r-1]<<1;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=N(i[s]++,s))}}function V(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<p;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function W(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,n,r){var o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]}function G(e,t,n){for(var r=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&H(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!H(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r}function X(e,t,n){var r,o,i,a,s=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],o=e.pending_buf[e.l_buf+s],s++,0===r?L(e,o,t):(L(e,(i=D[o])+c+1,t),0!==(a=w[i])&&B(e,o-=M[i],a),L(e,i=F(--r),n),0!==(a=S[i])&&B(e,r-=O[i],a)),s<e.last_lit;);L(e,v,t)}function Y(e,t){var n,r,o,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=h,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(o=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)G(e,i,n);for(o=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,i[2*o]=i[2*n]+i[2*r],e.depth[o]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,i[2*n+1]=i[2*r+1]=o,e.heap[1]=o++,G(e,i,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,o,i,a,s,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,g=t.stat_desc.extra_base,m=t.stat_desc.max_length,v=0;for(i=0;i<=f;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<h;n++)m<(i=l[2*l[2*(r=e.heap[n])+1]+1]+1)&&(i=m,v++),l[2*r+1]=i,c<r||(e.bl_count[i]++,a=0,g<=r&&(a=p[r-g]),s=l[2*r],e.opt_len+=s*(i+a),u&&(e.static_len+=s*(d[2*r+1]+a)));if(0!==v){do{for(i=m-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[m]--,v-=2}while(0<v);for(i=m;0!==i;i--)for(r=e.bl_count[i];0!==r;)c<(o=e.heap[--n])||(l[2*o+1]!==i&&(e.opt_len+=(i-l[2*o+1])*l[2*o],l[2*o+1]=i),r--)}}(e,t),U(i,c,e.bl_count)}function q(e,t,n){var r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[2*y]++):s<=10?e.bl_tree[2*x]++:e.bl_tree[2*b]++,i=o,c=(s=0)===a?(l=138,3):o===a?(l=6,3):(l=7,4))}function Z(e,t,n){var r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<l&&o===a)){if(s<c)for(;L(e,o,e.bl_tree),0!=--s;);else 0!==o?(o!==i&&(L(e,o,e.bl_tree),s--),L(e,y,e.bl_tree),B(e,s-3,2)):s<=10?(L(e,x,e.bl_tree),B(e,s-3,3)):(L(e,b,e.bl_tree),B(e,s-11,7));i=o,c=(s=0)===a?(l=138,3):o===a?(l=6,3):(l=7,4)}}a(O);var $=!1;function K(e,t,n,o){B(e,(s<<1)+(o?1:0),3),function(e,t,n,o){W(e),o&&(P(e,n),P(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){$||(function(){var e,t,n,r,o,i=new Array(f+1);for(r=n=0;r<l-1;r++)for(M[r]=n,e=0;e<1<<w[r];e++)D[n++]=r;for(D[n-1]=r,r=o=0;r<16;r++)for(O[r]=o,e=0;e<1<<S[r];e++)E[o++]=r;for(o>>=7;r<u;r++)for(O[r]=o<<7,e=0;e<1<<S[r]-7;e++)E[256+o++]=r;for(t=0;t<=f;t++)i[t]=0;for(e=0;e<=143;)j[2*e+1]=8,e++,i[8]++;for(;e<=255;)j[2*e+1]=9,e++,i[9]++;for(;e<=279;)j[2*e+1]=7,e++,i[7]++;for(;e<=287;)j[2*e+1]=8,e++,i[8]++;for(U(j,d+1,i),e=0;e<u;e++)_[2*e+1]=5,_[2*e]=N(e,5);T=new R(j,w,c+1,d,f),I=new R(_,S,0,u,f),A=new R(new Array(0),k,0,p,m)}(),$=!0),e.l_desc=new z(e.dyn_ltree,T),e.d_desc=new z(e.dyn_dtree,I),e.bl_desc=new z(e.bl_tree,A),e.bi_buf=0,e.bi_valid=0,V(e)},n._tr_stored_block=K,n._tr_flush_block=function(e,t,n,r){var a,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return i;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return i;return o}(e)),Y(e,e.l_desc),Y(e,e.d_desc),l=function(e){var t;for(q(e,e.dyn_ltree,e.l_desc.max_code),q(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=p-1;3<=t&&0===e.bl_tree[2*C[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=n+5,n+4<=a&&-1!==t?K(e,t,n,r):4===e.strategy||s===a?(B(e,2+(r?1:0),3),X(e,j,_)):(B(e,4+(r?1:0),3),function(e,t,n,r){var o;for(B(e,t-257,5),B(e,n-1,5),B(e,r-4,4),o=0;o<r;o++)B(e,e.bl_tree[2*C[o]+1],3);Z(e,e.dyn_ltree,t-1),Z(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),X(e,e.dyn_ltree,e.dyn_dtree)),V(e),r&&W(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(D[n]+c+1)]++,e.dyn_dtree[2*F(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){B(e,2,3),L(e,v,j),function(e){16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,o,i,a=1,s={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){p(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){o.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(p,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var o={callback:e,args:t};return s[a]=o,n(a),a++},d.clearImmediate=u}function u(e){delete s[e]}function p(e){if(l)setTimeout(p,0,e);else{var n=s[e];if(n){l=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{u(e),l=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&p(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},6173:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6179:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6272:(e,t,n)=>{var r=n(6571),o=n(2761);e.exports=function(e){return o(e)&&r(e)}},6297:(e,t,n)=>{var r=n(8208);e.exports=function(e,t){return r.map(t,function(t){var n=e.inEdges(t);if(n.length){var o=r.reduce(n,function(t,n){var r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:o.sum/o.weight,weight:o.weight}}return{v:t}})}},6302:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCanvas=t.createImageData=t.createCanvas=t.createCanvasFromData=t.writeDataZipWithoutPrediction=t.writeDataRLE=t.writeDataRaw=t.decodeBitmap=t.imageDataToCanvas=t.resetImageData=t.hasAlpha=t.clamp=t.offsetForChannel=t.Compression=t.ChannelID=t.MaskParams=t.LayerMaskFlags=t.ColorSpace=t.createEnum=t.revMap=t.largeAdditionalInfoKeys=t.layerColors=t.toBlendMode=t.fromBlendMode=t.RAW_IMAGE_DATA=t.MOCK_HANDLERS=void 0;var r=n(2247),o=n(4949);function i(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}t.MOCK_HANDLERS=!1,t.RAW_IMAGE_DATA=!1,t.fromBlendMode={},t.toBlendMode={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"},Object.keys(t.toBlendMode).forEach(function(e){return t.fromBlendMode[t.toBlendMode[e]]=e}),t.layerColors=["none","red","orange","yellow","green","blue","violet","gray"],t.largeAdditionalInfoKeys=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"],t.revMap=i,t.createEnum=function(e,t,n){var r=i(n);return{decode:function(e){var n=e.split(".")[1];if(n&&!r[n])throw new Error("Unrecognized value for enum: '".concat(e,"'"));return r[n]||t},encode:function(r){if(r&&!n[r])throw new Error("Invalid value for enum: '".concat(r,"'"));return"".concat(e,".").concat(n[r]||n[t])}}},function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"}(t.ColorSpace||(t.ColorSpace={})),function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"}(t.LayerMaskFlags||(t.LayerMaskFlags={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(t.MaskParams||(t.MaskParams={})),function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"}(t.ChannelID||(t.ChannelID={})),function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(t.Compression||(t.Compression={})),t.offsetForChannel=function(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}},t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.hasAlpha=function(e){for(var t=e.width*e.height*4,n=3;n<t;n+=4)if(255!==e.data[n])return!0;return!1},t.resetImageData=function(e){for(var t=e.data,n=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,r=0,o=0|t.length;r<o;r=r+4|0)t[r+0]=0,t[r+1]=0,t[r+2]=0,t[r+3]=n},t.imageDataToCanvas=function(e){var n,r=(0,t.createCanvas)(e.width,e.height);if(e.data instanceof Uint8ClampedArray)n=e;else{n=(0,t.createImageData)(e.width,e.height);var o=e.data,i=n.data;if(o instanceof Float32Array)for(var a=0,s=o.length;a<s;a+=4)i[a+0]=Math.round(255*Math.pow(o[a+0],1/2.2)),i[a+1]=Math.round(255*Math.pow(o[a+1],1/2.2)),i[a+2]=Math.round(255*Math.pow(o[a+2],1/2.2)),i[a+3]=Math.round(255*o[a+3]);else{var l=o instanceof Uint16Array?8:0;for(a=0,s=o.length;a<s;a++)i[a]=o[a]>>>l}}return r.getContext("2d").putImageData(n,0,0),r},t.decodeBitmap=function(e,t,n,r){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var o=0,i=0,a=0;o<r;o++)for(var s=0;s<n;)for(var l=e[a++],c=0;c<8&&s<n;c++,s++,i+=4){var d=128&l?0:255;l<<=1,t[i+0]=d,t[i+1]=d,t[i+2]=d,t[i+3]=255}},t.writeDataRaw=function(e,t,n,r){if(n&&r){for(var o=new Uint8Array(n*r),i=0;i<o.length;i++)o[i]=e.data[4*i+t];return o}},t.writeDataRLE=function(e,t,n,r){var o=t.data,i=t.width,a=t.height;if(i&&a){for(var s=4*i|0,l=0,c=n.length*(r?4:2)*a|0,d=0,u=n;d<u.length;d++)for(var p=u[d],h=0,f=0|p;h<a;h++){var g=h*s|0,m=g+s|0,v=m+p-4|0,y=v-4|0,x=c;for(f=g+p|0;f<m;f=f+4|0)if(f<y){var b=o[f],w=o[f=f+4|0],S=o[f=f+4|0];if(b===w&&b===S){for(var k=3;k<128&&f<v&&o[f+4|0]===b;)k=k+1|0,f=f+4|0;e[c++]=1-k,e[c++]=b}else{var C=c,j=!0;k=1;for(e[c++]=0,e[c++]=b;f<v&&k<128;){if(b=w,w=S,S=o[f=f+4|0],b===w&&b===S){f=f-12|0,j=!1;break}k++,e[c++]=b}j&&(k<127?(e[c++]=w,e[c++]=S,k+=2):k<128?(e[c++]=w,k++,f=f-4|0):f=f-8|0),e[C]=k-1}}else f===v?(e[c++]=0,e[c++]=o[f]):(e[c++]=1,e[c++]=o[f],f=f+4|0,e[c++]=o[f]);var _=c-x;r&&(e[l++]=_>>24&255,e[l++]=_>>16&255),e[l++]=_>>8&255,e[l++]=255&_}return e.slice(0,c)}},t.writeDataZipWithoutPrediction=function(e,t){for(var n=e.data,o=e.width*e.height,i=new Uint8Array(o),a=[],s=0,l=0,c=t;l<c.length;l++){for(var d=0,u=h=c[l];d<o;d++,u+=4)i[d]=n[u];var p=(0,r.deflate)(i);a.push(p),s+=p.byteLength}if(a.length>0){p=new Uint8Array(s);for(var h=0,f=0,g=a;f<g.length;f++){var m=g[f];p.set(m,h),h+=m.byteLength}return p}return a[0]},t.createCanvasFromData=function(e){var n=(0,t.createCanvas)(100,100);try{var r=n.getContext("2d"),i=(0,o.decodeJpeg)(e,function(e,t){return r.createImageData(e,t)});n.width=i.width,n.height=i.height,r.putImageData(i,0,0)}catch(a){console.error("JPEG decompression error",a.message)}return n};t.createCanvas=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")};var a=void 0;t.createImageData=function(e,n){return a||(a=(0,t.createCanvas)(1,1)),a.getContext("2d").createImageData(e,n)},"undefined"!==typeof document&&(t.createCanvas=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}),t.initializeCanvas=function(e,n){t.createCanvas=e,t.createImageData=n||t.createImageData}},6311:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6326:(e,t,n)=>{var r=n(8895),o=n(5990),i=n(9621),a=n(7828),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:a;e.exports=s},6329:e=>{"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},6350:(e,t,n)=>{var r=n(8325),o=n(6578)(r);e.exports=o},6368:(e,t,n)=>{var r=n(5750),o=n(191),i=n(4428);e.exports=function(e,t){var n,a=new o,s={},l=new i;function c(e){var r=e.v===n?e.w:e.v,o=l.priority(r);if(void 0!==o){var i=t(e);i<o&&(s[r]=n,l.decrease(r,i))}}if(0===e.nodeCount())return a;r.each(e.nodes(),function(e){l.add(e,Number.POSITIVE_INFINITY),a.setNode(e)}),l.decrease(e.nodes()[0],0);var d=!1;for(;l.size()>0;){if(n=l.removeMin(),r.has(s,n))a.setEdge(n,s[n]);else{if(d)throw new Error("Input graph is not connected: "+e);d=!0}e.nodeEdges(n).forEach(c)}return a}},6399:(e,t,n)=>{var r=n(5538),o=n(3668),i=n(9987),a=n(5752),s=n(6924),l=n(4052),c=n(4543),d=n(1268),u="[object Arguments]",p="[object Array]",h="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,g,m,v){var y=l(e),x=l(t),b=y?p:s(e),w=x?p:s(t),S=(b=b==u?h:b)==h,k=(w=w==u?h:w)==h,C=b==w;if(C&&c(e)){if(!c(t))return!1;y=!0,S=!1}if(C&&!S)return v||(v=new r),y||d(e)?o(e,t,n,g,m,v):i(e,t,b,n,g,m,v);if(!(1&n)){var j=S&&f.call(e,"__wrapped__"),_=k&&f.call(t,"__wrapped__");if(j||_){var E=j?e.value():e,D=_?t.value():t;return v||(v=new r),m(E,D,n,g,v)}}return!!C&&(v||(v=new r),a(e,t,n,g,m,v))}},6427:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeEngineData2=void 0;var n={0:{uproot:!0,children:{0:{name:"Type"},1:{name:"Values"}}}},r={0:{name:"Font"},1:{name:"FontSize"},2:{name:"FauxBold"},3:{name:"FauxItalic"},4:{name:"AutoLeading"},5:{name:"Leading"},6:{name:"HorizontalScale"},7:{name:"VerticalScale"},8:{name:"Tracking"},9:{name:"BaselineShift"},11:{name:"Kerning?"},12:{name:"FontCaps"},13:{name:"FontBaseline"},15:{name:"Strikethrough?"},16:{name:"Underline?"},18:{name:"Ligatures"},19:{name:"DLigatures"},23:{name:"Fractions"},24:{name:"Ordinals"},28:{name:"StylisticAlternates"},30:{name:"OldStyle?"},35:{name:"BaselineDirection"},38:{name:"Language"},52:{name:"NoBreak"},53:{name:"FillColor",children:n},54:{name:"StrokeColor",children:n},55:{children:{99:{uproot:!0}}},79:{children:n}},o={0:{name:"Justification"},1:{name:"FirstLineIndent"},2:{name:"StartIndent"},3:{name:"EndIndent"},4:{name:"SpaceBefore"},5:{name:"SpaceAfter"},7:{name:"AutoLeading"},9:{name:"AutoHyphenate"},10:{name:"HyphenatedWordSize"},11:{name:"PreHyphen"},12:{name:"PostHyphen"},13:{name:"ConsecutiveHyphens?"},14:{name:"Zone"},15:{name:"HypenateCapitalizedWords"},17:{name:"WordSpacing"},18:{name:"LetterSpacing"},19:{name:"GlyphSpacing"},32:{name:"StyleSheet",children:r}},i={name:"StyleSheetData",children:r},a={0:{name:"ResourceDict",children:{1:{name:"FontSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},2:{name:"FontType"}}}}}}}}},2:{name:"2",children:{}},3:{name:"MojiKumiSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"InternalName"}}}}}}},4:{name:"KinsokuSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{uproot:!0,children:{0:{name:"NoStart"},1:{name:"NoEnd"},2:{name:"Keep"},3:{name:"Hanging"},4:{name:"Name"}}}}}}}}},5:{name:"StyleSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},6:i}}}}}},6:{name:"ParagraphSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{name:"Properties",children:o},6:{name:"DefaultStyleSheet"}}}}}}},8:{name:"TextFrameSet",children:{0:{uproot:!0,children:{0:{name:"path",children:{0:{name:"name"},1:{name:"bezierCurve",children:{0:{name:"controlPoints"}}},2:{name:"data",children:{0:{name:"type"},1:{name:"orientation"},2:{name:"frameMatrix"},4:{name:"4"},6:{name:"textRange"},7:{name:"rowGutter"},8:{name:"columnGutter"},9:{name:"9"},10:{name:"baselineAlignment",children:{0:{name:"flag"},1:{name:"min"}}},11:{name:"pathData",children:{1:{name:"1"},0:{name:"reversed"},2:{name:"2"},3:{name:"3"},4:{name:"spacing"},5:{name:"5"},6:{name:"6"},7:{name:"7"},18:{name:"18"}}},12:{name:"12"},13:{name:"13"}}},3:{name:"3"},97:{name:"uuid"}}}}}}},9:{name:"Predefined",children:{0:{children:{0:{uproot:!0}}},1:{children:{0:{uproot:!0}}}}}}},1:{name:"EngineDict",children:{0:{name:"0",children:{3:{name:"SuperscriptSize"},4:{name:"SuperscriptPosition"},5:{name:"SubscriptSize"},6:{name:"SubscriptPosition"},7:{name:"SmallCapSize"},8:{name:"UseFractionalGlyphWidths"},15:{children:{0:{uproot:!0}}}}},1:{name:"Editors?",children:{0:{name:"Editor",children:{0:{name:"Text"},5:{name:"ParagraphRun",children:{0:{name:"RunArray",children:{0:{name:"ParagraphSheet",children:{0:{uproot:!0,children:{0:{name:"0"},5:{name:"5",children:o},6:{name:"6"}}}}},1:{name:"RunLength"}}}}},6:{name:"StyleRun",children:{0:{name:"RunArray",children:{0:{name:"StyleSheet",children:{0:{uproot:!0,children:{6:i}}}},1:{name:"RunLength"}}}}}}},1:{name:"FontVectorData ???"}}},2:{name:"StyleSheet",children:r},3:{name:"ParagraphSheet",children:o}}}};function s(e,t){var n,r;if(null===e)return e;if(Array.isArray(e))return e.map(function(e){return s(e,t)});if("object"!==typeof e)return e;for(var o={},i=0,a=Object.keys(e);i<a.length;i++){var l=a[i];if(t[l]){if(t[l].uproot){"99"!==l&&(o=s(e[l],null!==(n=t[l].children)&&void 0!==n?n:{})),e[99]&&(o._type=e[99]);break}o[t[l].name||l]=s(e[l],null!==(r=t[l].children)&&void 0!==r?r:{})}else"99"===l?o._type=e[l]:o[l]=s(e[l],{})}return o}t.decodeEngineData2=function(e){return s(e,a)}},6434:(e,t,n)=>{var r=n(7132);e.exports=function(e){return r(e,5)}},6467:(e,t,n)=>{var r=n(8208);e.exports=function(e){var t=function(e){var t={},n=0;function o(i){var a=n;r.forEach(e.children(i),o),t[i]={low:a,lim:n++}}return r.forEach(e.children(),o),t}(e);r.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){var o,i,a=[],s=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),a.push(o)}while(o&&(t[o].low>l||c>t[o].lim));i=o,o=r;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,t,o.v,o.w),a=i.path,s=i.lca,l=0,c=a[l],d=!0;n!==o.w;){if(r=e.node(n),d){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(d=!1)}if(!d){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(n,c),n=e.successors(n)[0]}})}},6487:e=>{e.exports=function(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}},6494:(e,t,n)=>{var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(l(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),s=r[n];n<i;s=r[++n])m(s)||!w(s)?a+=" "+s:a+=" "+l(s);return a},t.deprecate=function(e,n){if("undefined"!==typeof process&&!0===process.noDeprecation)return e;if("undefined"===typeof process)return function(){return t.deprecate(e,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),r=!0}return e.apply(this,arguments)}};var i={},a=/^$/;if({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG){var s={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+s+"$","i")}function l(e,n){var r={seen:[],stylize:d};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&t._extend(r,n),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=l.styles[t];return n?"\x1b["+l.colors[n][0]+"m"+e+"\x1b["+l.colors[n][1]+"m":e}function d(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&C(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return y(o)||(o=u(e,o,r)),o}var i=function(e,t){if(x(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(i)return i;var a=Object.keys(n),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),k(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return p(n);if(0===a.length){if(C(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return e.stylize(Date.prototype.toString.call(n),"date");if(k(n))return p(n)}var c,d="",w=!1,j=["{","}"];(f(n)&&(w=!0,j=["[","]"]),C(n))&&(d=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(d=" "+RegExp.prototype.toString.call(n)),S(n)&&(d=" "+Date.prototype.toUTCString.call(n)),k(n)&&(d=" "+p(n)),0!==a.length||w&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=w?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)D(t,String(a))?i.push(h(e,t,n,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(h(e,t,n,r,o,!0))}),i}(e,n,r,s,a):a.map(function(t){return h(e,n,r,s,t,w)}),e.seen.pop(),function(e,t,n){var r=e.reduce(function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,d,j)):j[0]+d+j[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),D(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=m(n)?u(e,l.value,null):u(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").slice(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),x(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e){return Array.isArray(e)}function g(e){return"boolean"===typeof e}function m(e){return null===e}function v(e){return"number"===typeof e}function y(e){return"string"===typeof e}function x(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===j(e)}function w(e){return"object"===typeof e&&null!==e}function S(e){return w(e)&&"[object Date]"===j(e)}function k(e){return w(e)&&("[object Error]"===j(e)||e instanceof Error)}function C(e){return"function"===typeof e}function j(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!i[e])if(a.test(e)){var n=process.pid;i[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else i[e]=function(){};return i[e]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(9321),t.isArray=f,t.isBoolean=g,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=y,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=x,t.isRegExp=b,t.types.isRegExp=b,t.isObject=w,t.isDate=S,t.types.isDate=S,t.isError=k,t.types.isNativeError=k,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=n(5446);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[_(e.getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":");return[e.getDate(),E[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=n(6329),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var M="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function T(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');if(M&&e[M]){var t;if("function"!==typeof(t=e[M]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,M,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise(function(e,r){t=e,n=r}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(e,r){e?n(e):t(r)});try{e.apply(this,o)}catch(a){n(a)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),M&&Object.defineProperty(t,M,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=M,t.callbackify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var r=t.pop();if("function"!==typeof r)throw new TypeError("The last argument must be of type Function");var o=this,i=function(){return r.apply(o,arguments)};e.apply(this,t).then(function(e){process.nextTick(i.bind(null,null,e))},function(e){process.nextTick(T.bind(null,e,i))})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}},6516:(e,t,n)=>{var r=n(6571);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==o(s[a],a,s););return n}}},6529:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.readCsh=void 0;var o=n(794),i=n(8147);t.readCsh=function(e){var t=(0,i.createReader)(e.buffer,e.byteOffset,e.byteLength),n={shapes:[]};if((0,i.checkSignature)(t,"cush"),2!==(0,i.readUint32)(t))throw new Error("Invalid version");for(var a=(0,i.readUint32)(t),s=0;s<a;s++){for(var l=(0,i.readUnicodeString)(t);t.offset%4;)t.offset++;if(1!==(0,i.readUint32)(t))throw new Error("Invalid shape version");var c=(0,i.readUint32)(t),d=t.offset+c,u=(0,i.readPascalString)(t,1),p=(0,i.readUint32)(t),h=(0,i.readUint32)(t),f=(0,i.readUint32)(t),g=(0,i.readUint32)(t)-h,m=f-p,v={paths:[]};(0,o.readVectorMask)(t,v,g,m,d-t.offset),n.shapes.push(r({name:l,id:u,width:g,height:m},v)),t.offset=d}return n}},6532:(e,t,n)=>{var r=n(5538),o=n(6989);e.exports=function(e,t,n,i){var a=n.length,s=a,l=!i;if(null==e)return!s;for(e=Object(e);a--;){var c=n[a];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var d=(c=n[a])[0],u=e[d],p=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var h=new r;if(i)var f=i(u,p,d,e,t,h);if(!(void 0===f?o(p,u,3,i,h):f))return!1}}return!0}},6552:(e,t,n)=>{var r=n(7105),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},6571:(e,t,n)=>{var r=n(1629),o=n(6173);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},6578:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var o=t(),i=16-(o-r);if(r=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},6599:(e,t,n)=>{var r=n(9841);e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,i=e===e,a=r(e),s=void 0!==t,l=null===t,c=t===t,d=r(t);if(!l&&!d&&!a&&e>t||a&&s&&c&&!l&&!d||o&&s&&c||!n&&c||!i)return 1;if(!o&&!a&&!d&&e<t||d&&n&&i&&!o&&!a||l&&n&&i||!s&&i||!c)return-1}return 0}},6600:(e,t,n)=>{var r=n(7937)(n(6552),"WeakMap");e.exports=r},6604:(e,t,n)=>{var r=n(3331)();e.exports=r},6614:(e,t,n)=>{var r=n(8420),o=n(1775);e.exports=function(e,t,n,i){var a=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var c=t[s],d=i?i(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),a?o(n,c,d):r(n,c,d)}return n}},6675:(e,t,n)=>{"use strict";var r=n(8208),o=n(5673),i=n(2786),a=n(2460),s=n(5641).normalizeRanks,l=n(6467),c=n(5641).removeEmptyRanks,d=n(5146),u=n(5972),p=n(1981),h=n(550),f=n(1277),g=n(5641),m=n(7938).Graph;e.exports=function(e,t){var n=t&&t.debugTiming?g.time:g.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return function(e){var t=new m({multigraph:!0,compound:!0}),n=_(e.graph());return t.setGraph(r.merge({},y,j(n,v),r.pick(n,x))),r.forEach(e.nodes(),function(n){var o=_(e.node(n));t.setNode(n,r.defaults(j(o,b),w)),t.setParent(n,e.parent(n))}),r.forEach(e.edges(),function(n){var o=_(e.edge(n));t.setEdge(n,r.merge({},k,j(o,S),r.pick(o,C)))}),t}(e)});n("  runLayout",function(){!function(e,t){t("    makeSpaceForEdgeLabels",function(){!function(e){var t=e.graph();t.ranksep/=2,r.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)})}(e)}),t("    removeSelfEdges",function(){!function(e){r.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}(e)}),t("    acyclic",function(){o.run(e)}),t("    nestingGraph.run",function(){d.run(e)}),t("    rank",function(){a(g.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),o={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};g.addDummyNode(e,"edge-proxy",o,"_ep")}})}(e)}),t("    removeEmptyRanks",function(){c(e)}),t("    nestingGraph.cleanup",function(){d.cleanup(e)}),t("    normalizeRanks",function(){s(e)}),t("    assignRankMinMax",function(){!function(e){var t=0;r.forEach(e.nodes(),function(n){var o=e.node(n);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,t=r.max(t,o.maxRank))}),e.graph().maxRank=t}(e)}),t("    removeEdgeLabelProxies",function(){!function(e){r.forEach(e.nodes(),function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}(e)}),t("    normalize.run",function(){i.run(e)}),t("    parentDummyChains",function(){l(e)}),t("    addBorderSegments",function(){u(e)}),t("    order",function(){h(e)}),t("    insertSelfEdges",function(){!function(e){var t=g.buildLayerMatrix(e);r.forEach(t,function(t){var n=0;r.forEach(t,function(t,o){var i=e.node(t);i.order=o+n,r.forEach(i.selfEdges,function(t){g.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:o+ ++n,e:t.e,label:t.label},"_se")}),delete i.selfEdges})})}(e)}),t("    adjustCoordinateSystem",function(){p.adjust(e)}),t("    position",function(){f(e)}),t("    positionSelfEdges",function(){!function(e){r.forEach(e.nodes(),function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}})}(e)}),t("    removeBorderNodes",function(){!function(e){r.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),o=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(r.last(n.borderLeft)),s=e.node(r.last(n.borderRight));n.width=Math.abs(s.x-a.x),n.height=Math.abs(i.y-o.y),n.x=a.x+n.width/2,n.y=o.y+n.height/2}}),r.forEach(e.nodes(),function(t){"border"===e.node(t).dummy&&e.removeNode(t)})}(e)}),t("    normalize.undo",function(){i.undo(e)}),t("    fixupEdgeLabelCoords",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}(e)}),t("    undoCoordinateSystem",function(){p.undo(e)}),t("    translateGraph",function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,i=0,a=e.graph(),s=a.marginx||0,l=a.marginy||0;function c(e){var r=e.x,a=e.y,s=e.width,l=e.height;t=Math.min(t,r-s/2),n=Math.max(n,r+s/2),o=Math.min(o,a-l/2),i=Math.max(i,a+l/2)}r.forEach(e.nodes(),function(t){c(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.has(n,"x")&&c(n)}),t-=s,o-=l,r.forEach(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=o}),r.forEach(e.edges(),function(n){var i=e.edge(n);r.forEach(i.points,function(e){e.x-=t,e.y-=o}),r.has(i,"x")&&(i.x-=t),r.has(i,"y")&&(i.y-=o)}),a.width=n-t+s,a.height=i-o+l}(e)}),t("    assignNodeIntersects",function(){!function(e){r.forEach(e.edges(),function(t){var n,r,o=e.edge(t),i=e.node(t.v),a=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=a,r=i),o.points.unshift(g.intersectRect(i,n)),o.points.push(g.intersectRect(a,r))})}(e)}),t("    reversePoints",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}(e)}),t("    acyclic.undo",function(){o.undo(e)})}(t,n)}),n("  updateInputGraph",function(){!function(e,t){r.forEach(e.nodes(),function(n){var r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,t.children(n).length&&(r.width=o.width,r.height=o.height))}),r.forEach(e.edges(),function(n){var o=e.edge(n),i=t.edge(n);o.points=i.points,r.has(i,"x")&&(o.x=i.x,o.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)})})};var v=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},x=["acyclicer","ranker","rankdir","align"],b=["width","height"],w={width:0,height:0},S=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},C=["labelpos"];function j(e,t){return r.mapValues(r.pick(e,t),Number)}function _(e){var t={};return r.forEach(e,function(e,n){t[n.toLowerCase()]=e}),t}},6684:e=>{function t(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=t,t.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},t.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},t.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}},6686:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6704:e=>{e.exports=function(e){return this.__data__.has(e)}},6727:(e,t,n)=>{var r=n(6983),o=n(8673);e.exports=function(e){return null==e?[]:r(e,o(e))}},6741:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},6745:(e,t,n)=>{var r=n(9742),o=n(61),i=n(3279);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},6788:(e,t,n)=>{var r=n(7160),o=n(5204),i=n(4816);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(e,t),this.size=n.size,this}},6806:(e,t,n)=>{var r=n(1516);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},6832:(e,t,n)=>{e=n.nmd(e);var r=n(7105),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s},6874:(e,t,n)=>{var r=n(2622);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},6913:(e,t,n)=>{var r=n(9812),o=n(4552),i=n(6095),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},6924:(e,t,n)=>{var r=n(7685),o=n(5204),i=n(5387),a=n(2070),s=n(6600),l=n(6913),c=n(6996),d="[object Map]",u="[object Promise]",p="[object Set]",h="[object WeakMap]",f="[object DataView]",g=c(r),m=c(o),v=c(i),y=c(a),x=c(s),b=l;(r&&b(new r(new ArrayBuffer(1)))!=f||o&&b(new o)!=d||i&&b(i.resolve())!=u||a&&b(new a)!=p||s&&b(new s)!=h)&&(b=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case g:return f;case m:return d;case v:return u;case y:return p;case x:return h}return t}),e.exports=b},6945:(e,t,n)=>{var r=n(5750);e.exports=function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach(function(e){r[e]={},r[e][e]={distance:0},o.forEach(function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})}),n(e).forEach(function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}})}),o.forEach(function(e){var t=r[e];o.forEach(function(n){var i=r[n];o.forEach(function(n){var r=i[e],o=t[n],a=i[n],s=r.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)})})}),r}(e,t||o,n||function(t){return e.outEdges(t)})};var o=r.constant(1)},6954:(e,t,n)=>{var r=n(1629),o=n(7857),i=n(6686),a=n(6996),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,p=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?p:s).test(a(e))}},6960:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.encodeEngineData=t.decodeEngineData=void 0;var r={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},o={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},i={font:r,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},a={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},s=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],l=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],c=["none","crisp","strong","smooth","sharp"],d=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function u(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function p(e){var t=e.Values;switch(e.Type){case 0:return{k:255*t[1]};case 1:return 1===t[0]?{r:255*t[1],g:255*t[2],b:255*t[3]}:{r:255*t[1],g:255*t[2],b:255*t[3],a:255*t[0]};case 2:return{c:255*t[1],m:255*t[2],y:255*t[3],k:255*t[4]};default:throw new Error("Unknown color type in text layer")}}function h(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}return{Type:1,Values:[0,0,0,0]}}function f(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function g(e,t){if(!e||!t)return!1;for(var n=0,r=Object.keys(e);n<r.length;n++){if(e[a=r[n]]!==t[a])return!1}for(var o=0,i=Object.keys(t);o<i.length;o++){var a;if(e[a=i[o]]!==t[a])return!1}return!0}function m(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t.name)return n;return e.push(t),e.length-1}function v(e,t,n){for(var r={},o=0,i=t;o<i.length;o++){var a=i[o],s=u(a);void 0!==e[s]&&(r[a]="justification"===a?d[e[s]]:"font"===a?n[e[s]]:"fillColor"===a||"strokeColor"===a?p(e[s]):e[s])}return r}function y(e,t,n){for(var r,o={},i=0,a=t;i<a.length;i++){var s=a[i],l=u(s);void 0!==e[s]&&(o[l]="justification"===s?d.indexOf(null!==(r=e[s])&&void 0!==r?r:"left"):"font"===s?m(n,e[s]):"fillColor"===s||"strokeColor"===s?h(e[s]):e[s])}return o}function x(e,t){return v(e,s,t)}function b(e,t){return v(e,l,t)}function w(e,t){return y(e,s,t)}function S(e,t){return y(e,l,t)}function k(e,t,n){if(t.length){for(var r=function(n){var r=t[0].style[n];if(void 0!==r){var o=!1;o=Array.isArray(r)?t.every(function(e){return f(e.style[n],r)}):"object"===typeof r?t.every(function(e){return g(e.style[n],r)}):t.every(function(e){return e.style[n]===r}),o&&(e[n]=r)}if(void 0!==e[n])for(var i=0,a=t;i<a.length;i++){var s=a[i];(Array.isArray(r)?f(s.style[n],r):"object"===typeof r?g(s.style[n],r):s.style[n]===r)&&delete s.style[n]}},o=0,i=n;o<i.length;o++){r(i[o])}t.every(function(e){return 0===Object.keys(e.style).length})&&(t.length=0)}}t.decodeEngineData=function(e){for(var t,n,r,o,i,a,d=e.EngineDict,u=e.ResourceDict,p=u.FontSet.map(function(e){return{name:e.Name,script:e.Script,type:e.FontType,synthetic:e.Synthetic}}),h=d.Editor.Text.replace(/\r/g,"\n"),f=0;/\n$/.test(h);)h=h.substring(0,h.length-1),f++;var g={text:h,antiAlias:null!==(t=c[d.AntiAlias])&&void 0!==t?t:"smooth",useFractionalGlyphWidths:!!d.UseFractionalGlyphWidths,superscriptSize:u.SuperscriptSize,superscriptPosition:u.SuperscriptPosition,subscriptSize:u.SubscriptSize,subscriptPosition:u.SubscriptPosition,smallCapSize:u.SmallCapSize},m=null===(a=null===(i=null===(o=null===(r=null===(n=d.Rendered)||void 0===n?void 0:n.Shapes)||void 0===r?void 0:r.Children)||void 0===o?void 0:o[0])||void 0===i?void 0:i.Cookie)||void 0===a?void 0:a.Photoshop;m&&(g.shapeType=1===m.ShapeType?"box":"point",m.PointBase&&(g.pointBase=m.PointBase),m.BoxBounds&&(g.boxBounds=m.BoxBounds));var v=d.ParagraphRun;g.paragraphStyle={},g.paragraphStyleRuns=[];for(var y=0;y<v.RunArray.length;y++){var w=v.RunArray[y],S=v.RunLengthArray[y],C=x(w.ParagraphSheet.Properties,p);g.paragraphStyleRuns.push({length:S,style:C})}for(var j=f;g.paragraphStyleRuns.length&&j>0;j--)0===--g.paragraphStyleRuns[g.paragraphStyleRuns.length-1].length&&g.paragraphStyleRuns.pop();k(g.paragraphStyle,g.paragraphStyleRuns,s),g.paragraphStyleRuns.length||delete g.paragraphStyleRuns;var _=d.StyleRun;for(g.style={},g.styleRuns=[],y=0;y<_.RunArray.length;y++){var E=_.RunLengthArray[y];(C=b(_.RunArray[y].StyleSheet.StyleSheetData,p)).font||(C.font=p[0]),g.styleRuns.push({length:E,style:C})}for(j=f;g.styleRuns.length&&j>0;j--)0===--g.styleRuns[g.styleRuns.length-1].length&&g.styleRuns.pop();return k(g.style,g.styleRuns,l),g.styleRuns.length||delete g.styleRuns,g},t.encodeEngineData=function(e){var t,s,l,d,u,p,f,g,m,v,y,x,b="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),k=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],C=(null===(t=e.style)||void 0===t?void 0:t.font)||(null===(l=null===(s=e.styleRuns)||void 0===s?void 0:s.find(function(e){return e.style.font}))||void 0===l?void 0:l.style.font)||r,j=[],_=[],E=e.paragraphStyleRuns;if(E&&E.length){for(var D=b.length,M=0,T=E;M<T.length;M++){var I=T[M];D-=U=Math.min(I.length,D),U&&(1===D&&I===E[E.length-1]&&(U++,D--),_.push(U),j.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:w(n(n(n({},o),e.paragraphStyle),I.style),k)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}D&&(_.push(D),j.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:w(n(n({},o),e.paragraphStyle),k)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var A=0,O=0;A<b.length;A++)13===b.charCodeAt(A)&&(_.push(A-O+1),j.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:w(n(n({},o),e.paragraphStyle),k)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),O=A+1);for(var R=S(n(n({},i),{font:C}),k),z=e.styleRuns||[{length:b.length,style:e.style||{}}],F=[],P=[],B=b.length,L=0,N=z;L<N.length;L++){var U,V=N[L];B-=U=Math.min(V.length,B),U&&(1===B&&V===z[z.length-1]&&(U++,B--),P.push(U),F.push({StyleSheet:{StyleSheetData:S(n(n({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),V.style),k)}}))}B&&z.length&&(P.push(B),F.push({StyleSheet:{StyleSheetData:S(n({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),k)}}));var W=n(n({},a),e.gridInfo),H="vertical"===e.orientation?2:0,G="vertical"===e.orientation?1:0,X="box"===e.shapeType?1:0,Y={ShapeType:X};0===X?Y.PointBase=e.pointBase||[0,0]:Y.BoxBounds=e.boxBounds||[0,0,0,0],Y.Base={ShapeType:X,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var q={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"\u3001\u3002\uff0c\uff0e\u30fb\uff1a\uff1b\uff1f\uff01\u30fc\u2015\u2019\u201d\uff09\u3015\uff3d\uff5d\u3009\u300b\u300d\u300f\u3011\u30fd\u30fe\u309d\u309e\u3005\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\u30f5\u30f6\u309b\u309c?!)]},.:;\u2103\u2109\xa2\uff05\u2030",NoEnd:"\u2018\u201c\uff08\u3014\uff3b\uff5b\u3008\u300a\u300c\u300e\u3010([{\uffe5\uff04\xa3\uff20\xa7\u3012\uff03",Keep:"\u2015\u2025",Hanging:"\u3001\u3002.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"\u3001\u3002\uff0c\uff0e\u30fb\uff1a\uff1b\uff1f\uff01\u2019\u201d\uff09\u3015\uff3d\uff5d\u3009\u300b\u300d\u300f\u3011\u30fd\u30fe\u309d\u309e\u3005",NoEnd:"\u2018\u201c\uff08\u3014\uff3b\uff5b\u3008\u300a\u300c\u300e\u3010",Keep:"\u2015\u2025",Hanging:"\u3001\u3002.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:w(n(n({},o),e.paragraphStyle),k)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:R}],FontSet:k.map(function(e){return{Name:e.name,Script:e.script||0,FontType:e.type||0,Synthetic:e.synthetic||0}}),SuperscriptSize:null!==(d=e.superscriptSize)&&void 0!==d?d:.583,SuperscriptPosition:null!==(u=e.superscriptPosition)&&void 0!==u?u:.333,SubscriptSize:null!==(p=e.subscriptSize)&&void 0!==p?p:.583,SubscriptPosition:null!==(f=e.subscriptPosition)&&void 0!==f?f:.333,SmallCapSize:null!==(g=e.smallCapSize)&&void 0!==g?g:.7};return{EngineDict:{Editor:{Text:b},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:j,RunLengthArray:_,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:F,RunLengthArray:P,IsJoinable:2},GridInfo:{GridIsOn:!!W.isOn,ShowGrid:!!W.show,GridSize:null!==(m=W.size)&&void 0!==m?m:18,GridLeading:null!==(v=W.leading)&&void 0!==v?v:22,GridColor:h(W.color),GridLeadingFillColor:h(W.color),AlignLineHeightToGridFlags:!!W.alignLineHeightToGridFlags},AntiAlias:c.indexOf(null!==(y=e.antiAlias)&&void 0!==y?y:"sharp"),UseFractionalGlyphWidths:null===(x=e.useFractionalGlyphWidths)||void 0===x||x,Rendered:{Version:1,Shapes:{WritingDirection:H,Children:[{ShapeType:X,Procession:G,Lines:{WritingDirection:H,Children:[]},Cookie:{Photoshop:Y}}]}}},ResourceDict:n({},q),DocumentResources:n({},q)}}},6983:(e,t,n)=>{var r=n(149);e.exports=function(e,t){return r(t,function(t){return e[t]})}},6989:(e,t,n)=>{var r=n(6399),o=n(2761);e.exports=function e(t,n,i,a,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!==t&&n!==n:r(t,n,i,a,e,s))}},6996:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},7094:(e,t,n)=>{"use strict";const r=n(4544),o=n(3250),i=n(4888),a=n(4753),{Z_FINISH:s,Z_BLOCK:l,Z_TREES:c,Z_OK:d,Z_STREAM_END:u,Z_NEED_DICT:p,Z_STREAM_ERROR:h,Z_DATA_ERROR:f,Z_MEM_ERROR:g,Z_BUF_ERROR:m,Z_DEFLATED:v}=n(2328),y=16180,x=16190,b=16191,w=16192,S=16194,k=16199,C=16200,j=16206,_=16209,E=16210,D=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function M(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const T=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<y||t.mode>16211?1:0},I=e=>{if(T(e))return h;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=y,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,d},A=e=>{if(T(e))return h;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,I(e)},O=(e,t)=>{let n;if(T(e))return h;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?h:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,A(e))},R=(e,t)=>{if(!e)return h;const n=new M;e.state=n,n.strm=e,n.window=null,n.mode=y;const r=O(e,t);return r!==d&&(e.state=null),r};let z,F,P=!0;const B=e=>{if(P){z=new Int32Array(512),F=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,z,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,F,0,e.work,{bits:5}),P=!1}e.lencode=z,e.lenbits=9,e.distcode=F,e.distbits=5},L=(e,t,n,r)=>{let o;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(t.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};e.exports.inflateReset=A,e.exports.inflateReset2=O,e.exports.inflateResetKeep=I,e.exports.inflateInit=e=>R(e,15),e.exports.inflateInit2=R,e.exports.inflate=(e,t)=>{let n,M,I,A,O,R,z,F,P,N,U,V,W,H,G,X,Y,q,Z,$,K,J,Q=0;const ee=new Uint8Array(4);let te,ne;const re=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(T(e)||!e.output||!e.input&&0!==e.avail_in)return h;n=e.state,n.mode===b&&(n.mode=w),O=e.next_out,I=e.output,z=e.avail_out,A=e.next_in,M=e.input,R=e.avail_in,F=n.hold,P=n.bits,N=R,U=z,J=d;e:for(;;)switch(n.mode){case y:if(0===n.wrap){n.mode=w;break}for(;P<16;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(2&n.wrap&&35615===F){0===n.wbits&&(n.wbits=15),n.check=0,ee[0]=255&F,ee[1]=F>>>8&255,n.check=o(n.check,ee,2,0),F=0,P=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&F)<<8)+(F>>8))%31){e.msg="incorrect header check",n.mode=_;break}if((15&F)!==v){e.msg="unknown compression method",n.mode=_;break}if(F>>>=4,P-=4,K=8+(15&F),0===n.wbits&&(n.wbits=K),K>15||K>n.wbits){e.msg="invalid window size",n.mode=_;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&F?16189:b,F=0,P=0;break;case 16181:for(;P<16;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(n.flags=F,(255&n.flags)!==v){e.msg="unknown compression method",n.mode=_;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=_;break}n.head&&(n.head.text=F>>8&1),512&n.flags&&4&n.wrap&&(ee[0]=255&F,ee[1]=F>>>8&255,n.check=o(n.check,ee,2,0)),F=0,P=0,n.mode=16182;case 16182:for(;P<32;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.head&&(n.head.time=F),512&n.flags&&4&n.wrap&&(ee[0]=255&F,ee[1]=F>>>8&255,ee[2]=F>>>16&255,ee[3]=F>>>24&255,n.check=o(n.check,ee,4,0)),F=0,P=0,n.mode=16183;case 16183:for(;P<16;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.head&&(n.head.xflags=255&F,n.head.os=F>>8),512&n.flags&&4&n.wrap&&(ee[0]=255&F,ee[1]=F>>>8&255,n.check=o(n.check,ee,2,0)),F=0,P=0,n.mode=16184;case 16184:if(1024&n.flags){for(;P<16;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.length=F,n.head&&(n.head.extra_len=F),512&n.flags&&4&n.wrap&&(ee[0]=255&F,ee[1]=F>>>8&255,n.check=o(n.check,ee,2,0)),F=0,P=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(V=n.length,V>R&&(V=R),V&&(n.head&&(K=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(M.subarray(A,A+V),K)),512&n.flags&&4&n.wrap&&(n.check=o(n.check,M,V,A)),R-=V,A+=V,n.length-=V),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===R)break e;V=0;do{K=M[A+V++],n.head&&K&&n.length<65536&&(n.head.name+=String.fromCharCode(K))}while(K&&V<R);if(512&n.flags&&4&n.wrap&&(n.check=o(n.check,M,V,A)),R-=V,A+=V,K)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===R)break e;V=0;do{K=M[A+V++],n.head&&K&&n.length<65536&&(n.head.comment+=String.fromCharCode(K))}while(K&&V<R);if(512&n.flags&&4&n.wrap&&(n.check=o(n.check,M,V,A)),R-=V,A+=V,K)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;P<16;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(4&n.wrap&&F!==(65535&n.check)){e.msg="header crc mismatch",n.mode=_;break}F=0,P=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=b;break;case 16189:for(;P<32;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}e.adler=n.check=D(F),F=0,P=0,n.mode=x;case x:if(0===n.havedict)return e.next_out=O,e.avail_out=z,e.next_in=A,e.avail_in=R,n.hold=F,n.bits=P,p;e.adler=n.check=1,n.mode=b;case b:if(t===l||t===c)break e;case w:if(n.last){F>>>=7&P,P-=7&P,n.mode=j;break}for(;P<3;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}switch(n.last=1&F,F>>>=1,P-=1,3&F){case 0:n.mode=16193;break;case 1:if(B(n),n.mode=k,t===c){F>>>=2,P-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=_}F>>>=2,P-=2;break;case 16193:for(F>>>=7&P,P-=7&P;P<32;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if((65535&F)!==(F>>>16^65535)){e.msg="invalid stored block lengths",n.mode=_;break}if(n.length=65535&F,F=0,P=0,n.mode=S,t===c)break e;case S:n.mode=16195;case 16195:if(V=n.length,V){if(V>R&&(V=R),V>z&&(V=z),0===V)break e;I.set(M.subarray(A,A+V),O),R-=V,A+=V,z-=V,O+=V,n.length-=V;break}n.mode=b;break;case 16196:for(;P<14;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(n.nlen=257+(31&F),F>>>=5,P-=5,n.ndist=1+(31&F),F>>>=5,P-=5,n.ncode=4+(15&F),F>>>=4,P-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=_;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;P<3;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.lens[re[n.have++]]=7&F,F>>>=3,P-=3}for(;n.have<19;)n.lens[re[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,te={bits:n.lenbits},J=a(0,n.lens,0,19,n.lencode,0,n.work,te),n.lenbits=te.bits,J){e.msg="invalid code lengths set",n.mode=_;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;Q=n.lencode[F&(1<<n.lenbits)-1],G=Q>>>24,X=Q>>>16&255,Y=65535&Q,!(G<=P);){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(Y<16)F>>>=G,P-=G,n.lens[n.have++]=Y;else{if(16===Y){for(ne=G+2;P<ne;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(F>>>=G,P-=G,0===n.have){e.msg="invalid bit length repeat",n.mode=_;break}K=n.lens[n.have-1],V=3+(3&F),F>>>=2,P-=2}else if(17===Y){for(ne=G+3;P<ne;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}F>>>=G,P-=G,K=0,V=3+(7&F),F>>>=3,P-=3}else{for(ne=G+7;P<ne;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}F>>>=G,P-=G,K=0,V=11+(127&F),F>>>=7,P-=7}if(n.have+V>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=_;break}for(;V--;)n.lens[n.have++]=K}}if(n.mode===_)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=_;break}if(n.lenbits=9,te={bits:n.lenbits},J=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,te),n.lenbits=te.bits,J){e.msg="invalid literal/lengths set",n.mode=_;break}if(n.distbits=6,n.distcode=n.distdyn,te={bits:n.distbits},J=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,te),n.distbits=te.bits,J){e.msg="invalid distances set",n.mode=_;break}if(n.mode=k,t===c)break e;case k:n.mode=C;case C:if(R>=6&&z>=258){e.next_out=O,e.avail_out=z,e.next_in=A,e.avail_in=R,n.hold=F,n.bits=P,i(e,U),O=e.next_out,I=e.output,z=e.avail_out,A=e.next_in,M=e.input,R=e.avail_in,F=n.hold,P=n.bits,n.mode===b&&(n.back=-1);break}for(n.back=0;Q=n.lencode[F&(1<<n.lenbits)-1],G=Q>>>24,X=Q>>>16&255,Y=65535&Q,!(G<=P);){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(X&&0===(240&X)){for(q=G,Z=X,$=Y;Q=n.lencode[$+((F&(1<<q+Z)-1)>>q)],G=Q>>>24,X=Q>>>16&255,Y=65535&Q,!(q+G<=P);){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}F>>>=q,P-=q,n.back+=q}if(F>>>=G,P-=G,n.back+=G,n.length=Y,0===X){n.mode=16205;break}if(32&X){n.back=-1,n.mode=b;break}if(64&X){e.msg="invalid literal/length code",n.mode=_;break}n.extra=15&X,n.mode=16201;case 16201:if(n.extra){for(ne=n.extra;P<ne;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.length+=F&(1<<n.extra)-1,F>>>=n.extra,P-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;Q=n.distcode[F&(1<<n.distbits)-1],G=Q>>>24,X=Q>>>16&255,Y=65535&Q,!(G<=P);){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(0===(240&X)){for(q=G,Z=X,$=Y;Q=n.distcode[$+((F&(1<<q+Z)-1)>>q)],G=Q>>>24,X=Q>>>16&255,Y=65535&Q,!(q+G<=P);){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}F>>>=q,P-=q,n.back+=q}if(F>>>=G,P-=G,n.back+=G,64&X){e.msg="invalid distance code",n.mode=_;break}n.offset=Y,n.extra=15&X,n.mode=16203;case 16203:if(n.extra){for(ne=n.extra;P<ne;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}n.offset+=F&(1<<n.extra)-1,F>>>=n.extra,P-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=_;break}n.mode=16204;case 16204:if(0===z)break e;if(V=U-z,n.offset>V){if(V=n.offset-V,V>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=_;break}V>n.wnext?(V-=n.wnext,W=n.wsize-V):W=n.wnext-V,V>n.length&&(V=n.length),H=n.window}else H=I,W=O-n.offset,V=n.length;V>z&&(V=z),z-=V,n.length-=V;do{I[O++]=H[W++]}while(--V);0===n.length&&(n.mode=C);break;case 16205:if(0===z)break e;I[O++]=n.length,z--,n.mode=C;break;case j:if(n.wrap){for(;P<32;){if(0===R)break e;R--,F|=M[A++]<<P,P+=8}if(U-=z,e.total_out+=U,n.total+=U,4&n.wrap&&U&&(e.adler=n.check=n.flags?o(n.check,I,U,O-U):r(n.check,I,U,O-U)),U=z,4&n.wrap&&(n.flags?F:D(F))!==n.check){e.msg="incorrect data check",n.mode=_;break}F=0,P=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;P<32;){if(0===R)break e;R--,F+=M[A++]<<P,P+=8}if(4&n.wrap&&F!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=_;break}F=0,P=0}n.mode=16208;case 16208:J=u;break e;case _:J=f;break e;case E:return g;default:return h}return e.next_out=O,e.avail_out=z,e.next_in=A,e.avail_in=R,n.hold=F,n.bits=P,(n.wsize||U!==e.avail_out&&n.mode<_&&(n.mode<j||t!==s))&&L(e,e.output,e.next_out,U-e.avail_out)?(n.mode=E,g):(N-=e.avail_in,U-=e.avail_out,e.total_in+=N,e.total_out+=U,n.total+=U,4&n.wrap&&U&&(e.adler=n.check=n.flags?o(n.check,I,U,e.next_out-U):r(n.check,I,U,e.next_out-U)),e.data_type=n.bits+(n.last?64:0)+(n.mode===b?128:0)+(n.mode===k||n.mode===S?256:0),(0===N&&0===U||t===s)&&J===d&&(J=m),J)},e.exports.inflateEnd=e=>{if(T(e))return h;let t=e.state;return t.window&&(t.window=null),e.state=null,d},e.exports.inflateGetHeader=(e,t)=>{if(T(e))return h;const n=e.state;return 0===(2&n.wrap)?h:(n.head=t,t.done=!1,d)},e.exports.inflateSetDictionary=(e,t)=>{const n=t.length;let o,i,a;return T(e)?h:(o=e.state,0!==o.wrap&&o.mode!==x?h:o.mode===x&&(i=1,i=r(i,t,n,0),i!==o.check)?f:(a=L(e,t,n,n),a?(o.mode=E,g):(o.havedict=1,d)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},7105:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},7116:(e,t,n)=>{var r=n(9812),o=n(2777),i=n(4052),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},7132:(e,t,n)=>{var r=n(5538),o=n(726),i=n(8420),a=n(1104),s=n(5119),l=n(4353),c=n(1980),d=n(8124),u=n(9075),p=n(9395),h=n(8592),f=n(6924),g=n(8268),m=n(8630),v=n(310),y=n(4052),x=n(4543),b=n(7887),w=n(6686),S=n(5921),k=n(8673),C=n(474),j="[object Arguments]",_="[object Function]",E="[object Object]",D={};D[j]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object DataView]"]=D["[object Boolean]"]=D["[object Date]"]=D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Map]"]=D["[object Number]"]=D[E]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object Symbol]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Error]"]=D[_]=D["[object WeakMap]"]=!1,e.exports=function e(t,n,M,T,I,A){var O,R=1&n,z=2&n,F=4&n;if(M&&(O=I?M(t,T,I,A):M(t)),void 0!==O)return O;if(!w(t))return t;var P=y(t);if(P){if(O=g(t),!R)return c(t,O)}else{var B=f(t),L=B==_||"[object GeneratorFunction]"==B;if(x(t))return l(t,R);if(B==E||B==j||L&&!I){if(O=z||L?{}:v(t),!R)return z?u(t,s(O,t)):d(t,a(O,t))}else{if(!D[B])return I?t:{};O=m(t,B,R)}}A||(A=new r);var N=A.get(t);if(N)return N;A.set(t,O),S(t)?t.forEach(function(r){O.add(e(r,n,M,r,t,A))}):b(t)&&t.forEach(function(r,o){O.set(o,e(r,n,M,o,t,A))});var U=P?void 0:(F?z?h:p:z?C:k)(t);return o(U||t,function(r,o){U&&(r=t[o=r]),i(O,o,e(r,n,M,o,t,A))}),O}},7159:(e,t,n)=>{var r=n(2622);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},7160:(e,t,n)=>{var r=n(7563),o=n(9935),i=n(4190),a=n(1946),s=n(1714);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},7163:e=>{"use strict";e.exports=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},7168:e=>{var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+r+"|"+o+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[i,a,s].join("|")+")"+c+l+")*"),u="(?:"+[i+r+"?",r,a,s,n].join("|")+")",p=RegExp(o+"(?="+o+")|"+u+d,"g");e.exports=function(e){for(var t=p.lastIndex=0;p.test(e);)++t;return t}},7171:(e,t,n)=>{var r=n(5652);e.exports=function(e,t){var n=[];return r(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,d=e[c];if(0>i(l,n))c<o&&0>i(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>i(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,p=null,h=3,f=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(d);null!==t;){if(null===t.callback)o(d);else{if(!(t.startTime<=e))break;o(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(m=!1,b(e),!g)if(null!==r(c))g=!0,O(S);else{var t=r(d);null!==t&&R(w,t.startTime-e)}}function S(e,n){g=!1,m&&(m=!1,y(_),_=-1),f=!0;var i=h;try{for(b(n),p=r(c);null!==p&&(!(p.expirationTime>n)||e&&!M());){var a=p.callback;if("function"===typeof a){p.callback=null,h=p.priorityLevel;var s=a(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(c)&&o(c),b(n)}else o(c);p=r(c)}if(null!==p)var l=!0;else{var u=r(d);null!==u&&R(w,u.startTime-n),l=!1}return l}finally{p=null,h=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,j=null,_=-1,E=5,D=-1;function M(){return!(t.unstable_now()-D<E)}function T(){if(null!==j){var e=t.unstable_now();D=e;var n=!0;try{n=j(!0,e)}finally{n?k():(C=!1,j=null)}}else C=!1}if("function"===typeof x)k=function(){x(T)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,A=I.port2;I.port1.onmessage=T,k=function(){A.postMessage(null)}}else k=function(){v(T,0)};function O(e){j=e,C||(C=!0,k())}function R(e,n){_=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,O(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(d,e),null===r(c)&&e===r(d)&&(m?(y(_),_=-1):m=!0,R(w,i-a))):(e.sortIndex=s,n(c,e),g||f||(g=!0,O(S))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},7251:(e,t,n)=>{var r=n(8724),o=n(7160),i=n(5204);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},7297:(e,t,n)=>{"use strict";var r,o=n(4781),i=n(5558);try{r=[].__proto__===Array.prototype}catch(c){if(!c||"object"!==typeof c||!("code"in c)||"ERR_PROTO_ACCESS"!==c.code)throw c}var a=!!r&&i&&i(Object.prototype,"__proto__"),s=Object,l=s.getPrototypeOf;e.exports=a&&"function"===typeof a.get?o([a.get]):"function"===typeof l&&function(e){return l(null==e?e:s(e))}},7303:(e,t,n)=>{var r=n(801),o=1/0;e.exports=function(e){return e?(e=r(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},7424:(e,t,n)=>{var r=n(755),o=n(2536),i=n(5647),a=n(929),s=i(function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),o(e,r(t,1),[])});e.exports=s},7449:(e,t,n)=>{var r=n(2969),o=n(9261),i=n(5324);e.exports=function(e,t,n){for(var a=-1,s=t.length,l={};++a<s;){var c=t[a],d=r(e,c);n(d,c)&&o(l,i(c,e),d)}return l}},7498:e=>{e.exports=function(e,t){return e>t}},7529:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},7563:e=>{e.exports=function(){this.__data__=[],this.size=0}},7574:e=>{e.exports=function(e){return function(t){return e(t)}}},7583:e=>{"use strict";e.exports=Math.pow},7615:(e,t,n)=>{var r=n(5575);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},7620:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.readAbr=void 0;var o=n(2038),i=n(8147),a=["off","fade","pen pressure","pen tilt","stylus wheel","initial direction","direction","initial rotation","rotation"],s=["round point","round blunt","round curve","round angle","round fan","flat point","flat blunt","flat curve","flat angle","flat fan"],l=["erodible point","erodible flat","erodible round","erodible square","erodible triangle","custom"],c={_:"brush",MixB:"mixer brush",SmTl:"smudge brush"};function d(e){return{control:a[e.bVTy],steps:e.fStp,jitter:(0,o.parsePercent)(e.jitter),minimum:(0,o.parsePercent)(e["Mnm "])}}function u(e){switch(e._classID){case"computedBrush":return{type:"computed",size:(0,o.parseUnitsToNumber)(e.Dmtr,"Pixels"),angle:(0,o.parseAngle)(e.Angl),roundness:(0,o.parsePercent)(e.Rndn),spacingOn:e.Intr,spacing:(0,o.parsePercent)(e.Spcn),flipX:e.flipX,flipY:e.flipY,hardness:(0,o.parsePercent)(e.Hrdn)};case"sampledBrush":return{type:"sampled",size:(0,o.parseUnitsToNumber)(e.Dmtr,"Pixels"),angle:(0,o.parseAngle)(e.Angl),roundness:(0,o.parsePercent)(e.Rndn),spacingOn:e.Intr,spacing:(0,o.parsePercent)(e.Spcn),flipX:e.flipX,flipY:e.flipY,name:e["Nm  "],sampledData:e.sampledData};case"dBrush":return{type:"dynamic",shape:s[e["Shp "]],angle:(0,o.parseAngle)(e.Angl),size:(0,o.parseUnitsToNumber)(e.Dmtr,"Pixels"),density:(0,o.parsePercent)(e.Dnst),length:(0,o.parsePercent)(e.Lngt),clumping:(0,o.parsePercent)(e.clumping),thickness:(0,o.parsePercent)(e.thickness),stiffness:(0,o.parsePercent)(e.stiffness),physics:e.physics,spacing:(0,o.parsePercent)(e.Spcn),spacingOn:e.Intr,flipX:e.flipX,flipY:e.flipY};case"dTips":return r(r({type:"tips",angle:(0,o.parseAngle)(e.Angl),size:(0,o.parseUnitsToNumber)(e.Dmtr,"Pixels"),shape:s[e["Shp "]],physics:e.physics,spacing:(0,o.parsePercent)(e.Spcn),spacingOn:e.Intr,flipX:e.flipX,flipY:e.flipY,tipsType:l[e.dtipsType],tipsLengthRatio:(0,o.parsePercent)(e.dtipsLengthRatio),tipsHardness:(0,o.parsePercent)(e.dtipsHardness)},e.dtipsGridSize&&e.dtipsErodibleTipHeightMap?{tipsGridSize:e.dtipsGridSize,tipsErodibleTipHeightMap:p(e.dtipsErodibleTipHeightMap)}:{}),{tipsAirbrushCutoffAngle:e.dtipsAirbrushCutoffAngle,tipsAirbrushGranularity:(0,o.parsePercent)(e.dtipsAirbrushGranularity),tipsAirbrushStreakiness:(0,o.parsePercent)(e.dtipsAirbrushStreakiness),tipsAirbrushSplatSize:(0,o.parsePercent)(e.dtipsAirbrushSplatSize),tipsAirbrushSplatCount:e.dtipsAirbrushSplatCount});default:throw console.log(n(6494).inspect(e,!1,99,!0)),new Error("Unknown brush classId: ".concat(e._classID))}}function p(e){for(var t=[],n=0;n<e.byteLength;n++)t.push(e[n]);return t}t.readAbr=function(e,t){var n,r,a,s;void 0===t&&(t={});var l=(0,i.createReader)(e.buffer,e.byteOffset,e.byteLength),p=(0,i.readInt16)(l),h=[],f=[],g=[];if(1===p||2===p)throw new Error("Unsupported ABR version (".concat(p,")"));if(6!==p&&7!==p&&9!==p&&10!==p)throw new Error("Unsupported ABR version (".concat(p,")"));var m=(0,i.readInt16)(l);if(1!==m&&2!==m)throw new Error("Unsupported ABR minor version");for(;l.offset<l.view.byteLength;){(0,i.checkSignature)(l,"8BIM");var v=(0,i.readSignature)(l),y=(0,i.readUint32)(l),x=l.offset+y;switch(v){case"samp":for(;l.offset<x;){for(var b=(0,i.readUint32)(l);3&b;)b++;var w=l.offset+b,S=(0,i.readPascalString)(l,1);(0,i.skipBytes)(l,1===m?10:264);var k=(0,i.readInt32)(l),C=(0,i.readInt32)(l),j=(0,i.readInt32)(l)-k,_=(0,i.readInt32)(l)-C;if(_<=0||j<=0)throw new Error("Invalid bounds");var E=(0,i.readInt16)(l),D=(0,i.readUint8)(l),M=new Uint8Array(_*j);if(8===E)if(0===D)M.set((0,i.readBytes)(l,M.byteLength));else{if(1!==D)throw new Error("Invalid compression");(0,i.readDataRLE)(l,{width:_,height:j,data:M},_,j,E,1,[0],!1)}else{if(16!==E)throw new Error("Invalid depth");if(0!==D)throw 1===D?new Error("not implemented (16bit RLE)"):new Error("Invalid compression");for(var T=0;T<M.byteLength;T++)M[T]=(0,i.readUint16)(l)>>8}h.push({id:S,bounds:{x:C,y:k,w:_,h:j},alpha:M}),l.offset=w}break;case"desc":for(var I=0,A=(P=(0,o.readVersionAndDescriptor)(l,!0)).Brsh;I<A.length;I++){var O=A[I],R={name:O["Nm  "],shape:u(O.Brsh),spacing:(0,o.parsePercent)(O.Spcn),wetEdges:O.Wtdg,noise:O.Nose,useBrushSize:O.useBrushSize};null!=O.interpretation&&(R.interpretation=O.interpretation),null!=O.protectTexture&&(R.protectTexture=O.protectTexture),O.useTipDynamics&&(R.shapeDynamics={tiltScale:(0,o.parsePercent)(O.tiltScale),sizeDynamics:d(O.szVr),angleDynamics:d(O.angleDynamics),roundnessDynamics:d(O.roundnessDynamics),flipX:O.flipX,flipY:O.flipY,brushProjection:O.brushProjection,minimumDiameter:(0,o.parsePercent)(O.minimumDiameter),minimumRoundness:(0,o.parsePercent)(O.minimumRoundness)}),O.useScatter&&(R.scatter={count:O["Cnt "],bothAxes:O.bothAxes,countDynamics:d(O.countDynamics),scatterDynamics:d(O.scatterDynamics)}),O.useTexture&&O.Txtr&&(R.texture={id:O.Txtr.Idnt,name:O.Txtr["Nm  "],blendMode:o.BlnM.decode(O.textureBlendMode),depth:(0,o.parsePercent)(O.textureDepth),depthMinimum:(0,o.parsePercent)(O.minimumDepth),depthDynamics:d(O.textureDepthDynamics),scale:(0,o.parsePercent)(O.textureScale),invert:O.InvT,brightness:O.textureBrightness,contrast:O.textureContrast});var z=O.dualBrush;z&&z.useDualBrush&&(R.dualBrush={flip:z.Flip,shape:u(z.Brsh),blendMode:o.BlnM.decode(z.BlnM),useScatter:z.useScatter,spacing:(0,o.parsePercent)(z.Spcn),count:z["Cnt "],bothAxes:z.bothAxes,countDynamics:d(z.countDynamics),scatterDynamics:d(z.scatterDynamics)}),O.useColorDynamics&&(R.colorDynamics={foregroundBackground:d(O.clVr),hue:(0,o.parsePercent)(O["H   "]),saturation:(0,o.parsePercent)(O.Strt),brightness:(0,o.parsePercent)(O.Brgh),purity:(0,o.parsePercent)(O.purity),perTip:O.colorDynamicsPerTip}),O.usePaintDynamics&&(R.transfer={flowDynamics:d(O.prVr),opacityDynamics:d(O.opVr),wetnessDynamics:d(O.wtVr),mixDynamics:d(O.mxVr)}),O.useBrushPose&&(R.brushPose={overrideAngle:O.overridePoseAngle,overrideTiltX:O.overridePoseTiltX,overrideTiltY:O.overridePoseTiltY,overridePressure:O.overridePosePressure,pressure:(0,o.parsePercent)(O.brushPosePressure),tiltX:O.brushPoseTiltX,tiltY:O.brushPoseTiltY,angle:O.brushPoseAngle});var F=O.toolOptions;F&&(R.toolOptions={type:c[F._classID]||"brush",brushPreset:F.brushPreset,flow:null!==(n=F.flow)&&void 0!==n?n:100,smooth:null!==(r=F.Smoo)&&void 0!==r?r:0,mode:o.BlnM.decode(F["Md  "]||"BlnM.Nrml"),opacity:null!==(a=F.Opct)&&void 0!==a?a:100,smoothing:!!F.smoothing,smoothingValue:F.smoothingValue||0,smoothingRadiusMode:!!F.smoothingRadiusMode,smoothingCatchup:!!F.smoothingCatchup,smoothingCatchupAtEnd:!!F.smoothingCatchupAtEnd,smoothingZoomCompensation:!!F.smoothingZoomCompensation,pressureSmoothing:!!F.pressureSmoothing,usePressureOverridesSize:!!F.usePressureOverridesSize,usePressureOverridesOpacity:!!F.usePressureOverridesOpacity,useLegacy:!!F.useLegacy},F.prVr&&(R.toolOptions.flowDynamics=d(F.prVr)),F.opVr&&(R.toolOptions.opacityDynamics=d(F.opVr)),F.szVr&&(R.toolOptions.sizeDynamics=d(F.szVr)),"wetness"in F&&(R.toolOptions.wetness=F.wetness),"dryness"in F&&(R.toolOptions.dryness=F.dryness),"mix"in F&&(R.toolOptions.mix=F.mix),"autoFill"in F&&(R.toolOptions.autoFill=F.autoFill),"autoClean"in F&&(R.toolOptions.autoClean=F.autoClean),"loadSolidColorOnly"in F&&(R.toolOptions.loadSolidColorOnly=F.loadSolidColorOnly),"sampleAllLayers"in F&&(R.toolOptions.sampleAllLayers=F.sampleAllLayers),"SmdF"in F&&(R.toolOptions.smudgeFingerPainting=F.SmdF),"SmdS"in F&&(R.toolOptions.smudgeSampleAllLayers=F.SmdS),"Prs "in F&&(R.toolOptions.strength=F["Prs "]),"SmdF"in F&&(R.toolOptions.smudgeFingerPainting=F.SmdF),"SmdS"in F&&(R.toolOptions.smudgeSampleAllLayers=F.SmdS)),f.push(R)}break;case"patt":l.offset<x&&(g.push((0,i.readPattern)(l)),l.offset=x);break;case"phry":var P=(0,o.readVersionAndDescriptor)(l);t.logMissingFeatures&&(null===(s=P.hierarchy)||void 0===s||s.length);break;default:throw new Error("Invalid brush type: ".concat(v))}for(;y%4;)l.offset++,y++}return{samples:h,patterns:g,brushes:f}}},7651:(e,t,n)=>{"use strict";var r=n(1251);e.exports=r.getPrototypeOf||null},7685:(e,t,n)=>{var r=n(7937)(n(6552),"DataView");e.exports=r},7717:(e,t,n)=>{var r=n(4258),o=n(5111),i=n(474);e.exports=function(e,t){return null==e?e:r(e,o(t),i)}},7724:e=>{"use strict";var t=Object.prototype.toString,n=Math.max,r=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var o=0;o<t.length;o+=1)n[o+e.length]=t[o];return n};e.exports=function(e){var o=this;if("function"!==typeof o||"[object Function]"!==t.apply(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var i,a=function(e,t){for(var n=[],r=t||0,o=0;r<e.length;r+=1,o+=1)n[o]=e[r];return n}(arguments,1),s=n(0,o.length-a.length),l=[],c=0;c<s;c++)l[c]="$"+c;if(i=Function("binder","return function ("+function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n}(l,",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof i){var t=o.apply(this,r(a,arguments));return Object(t)===t?t:this}return o.apply(e,r(a,arguments))}),o.prototype){var d=function(){};d.prototype=o.prototype,i.prototype=new d,d.prototype=null}return i}},7760:e=>{e.exports=function(e){return this.__data__.get(e)}},7792:(e,t,n)=>{"use strict";var r=n(2816);e.exports=function(e){return r(e)||0===e?e:e<0?-1:1}},7828:e=>{e.exports=function(){return[]}},7857:(e,t,n)=>{var r=n(3440),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},7887:(e,t,n)=>{var r=n(5791),o=n(7574),i=n(6832),a=i&&i.isMap,s=a?o(a):r;e.exports=s},7894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7937:(e,t,n)=>{var r=n(6954),o=n(4657);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},7938:(e,t,n)=>{var r;try{r=n(9207)}catch(o){}r||(r=window.graphlib),e.exports=r},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8004:(e,t,n)=>{"use strict";var r=n(1903),o=n(2936),i=n(1712),a=n(8117),s=n(5558),l=n(1291),c=a("Object.prototype.toString"),d=n(4635)(),u="undefined"===typeof globalThis?n.g:globalThis,p=o(),h=a("String.prototype.slice"),f=a("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},g={__proto__:null};r(p,d&&s&&l?function(e){var t=new u[e];if(Symbol.toStringTag in t&&l){var n=l(t),r=s(n,Symbol.toStringTag);if(!r&&n){var o=l(n);r=s(o,Symbol.toStringTag)}g["$"+e]=i(r.get)}}:function(e){var t=new u[e],n=t.slice||t.set;n&&(g["$"+e]=i(n))});e.exports=function(e){if(!e||"object"!==typeof e)return!1;if(!d){var t=h(c(e),8,-1);return f(p,t)>-1?t:"Object"===t&&function(e){var t=!1;return r(g,function(n,r){if(!t)try{n(e),t=h(r,1)}catch(o){}}),t}(e)}return s?function(e){var t=!1;return r(g,function(n,r){if(!t)try{"$"+n(e)===r&&(t=h(r,1))}catch(o){}}),t}(e):null}},8114:e=>{e.exports=function(e,t){return e.has(t)}},8117:(e,t,n)=>{"use strict";var r=n(2),o=n(4781),i=o([r("%String.prototype.indexOf%")]);e.exports=function(e,t){var n=r(e,!!t);return"function"===typeof n&&i(e,".prototype.")>-1?o([n]):n}},8122:(e,t,n)=>{var r=n(6686),o=n(6140),i=n(3516),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},8124:(e,t,n)=>{var r=n(6614),o=n(9621);e.exports=function(e,t){return r(e,o(e),t)}},8129:(e,t,n)=>{var r=n(8420),o=n(9377);e.exports=function(e,t){return o(e||[],t||[],r)}},8147:function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.readPattern=t.readColor=t.readSection=t.readDataRLE=t.readDataZip=t.createImageDataBitDepth=t.readAdditionalLayerInfo=t.readGlobalLayerMaskInfo=t.readData=t.readLayerInfo=t.readPsd=t.checkSignature=t.skipBytes=t.readAsciiString=t.readUnicodeStringWithLengthLE=t.readUnicodeStringWithLength=t.readUnicodeString=t.readPascalString=t.validSignatureAt=t.readSignature=t.readBytes=t.readFixedPointPath32=t.readFixedPoint32=t.readFloat64=t.readFloat32=t.readUint32=t.readInt32LE=t.readInt32=t.readUint16LE=t.readUint16=t.readInt16=t.peekUint8=t.readUint8=t.warnOrThrow=t.createReader=t.supportedColorModes=void 0;var o=n(2247),i=n(6302),a=n(794),s=n(3305);t.supportedColorModes=[0,1,3,2];var l=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function c(e){for(var t=e.width*e.height*4,n=0;n<t;n+=4){var r=e.data[n];e.data[n+1]=r,e.data[n+2]=r}}function d(e,t,n){return{view:new DataView(e,t,n),offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}function u(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}function p(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function h(e){return e.view.getUint8(e.offset)}function f(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function g(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function m(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}function v(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function y(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function x(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function b(e,t){var n=e.view.byteOffset+e.offset;if(e.offset+=t,n+t>e.view.buffer.byteLength){if(u(e,"Reading bytes exceeding buffer length"),t>104857600)throw new Error("Reading past end of file");var r=new Uint8Array(t),o=Math.min(t,e.view.byteLength-n);return o>0&&r.set(new Uint8Array(e.view.buffer,n,o)),r}return new Uint8Array(e.view.buffer,n,t)}function w(e){return D(e,4)}function S(e,t){var n=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return"8BIM"==n||"8B64"==n}function k(e,t){for(var n=p(e),r=n?D(e,n):"";++n%t;)e.offset++;return r}function C(e){return j(e,y(e))}function j(e,t){for(var n="";t--;){var r=g(e);(r||t>0)&&(n+=String.fromCharCode(r))}return n}function _(e,t){e.offset+=t}function E(e,t,n){var r=e.offset,o=w(e);if(o!==t&&o!==n)throw new Error("Invalid signature: '".concat(o,"' at 0x").concat(r.toString(16)))}function D(e,t){for(var n=b(e,t),r="",o=0;o<n.length;o++)r+=String.fromCharCode(n[o]);return r}function M(e){return"8BIM"===e||"MeSa"===e||"AgHg"===e||"PHUT"===e||"DCSR"===e}function T(e,t,n){var r,o,a=n.layersGroup,s=void 0===a?[]:a,l=n.layerGroupsEnabledId,c=void 0===l?[]:l,d=f(e);d<0&&(e.globalAlpha=!0,d=-d);for(var u=[],p=[],h=0;h<d;h++){var g=I(e,t,n),m=g.layer,v=g.channels;void 0!==s[h]&&(m.linkGroup=s[h]),void 0!==c[h]&&(m.linkGroupEnabled=!!c[h]),u.push(m),p.push(v)}if(!e.skipLayerImageData)for(h=0;h<d;h++)O(e,t,u[h],p[h]);t.children||(t.children=[]);var y=[t];for(h=u.length-1;h>=0;h--){var x=u[h],b=x.sectionDivider?x.sectionDivider.type:0;1===b||2===b?(x.opened=1===b,x.children=[],(null===(r=x.sectionDivider)||void 0===r?void 0:r.key)&&(x.blendMode=null!==(o=i.toBlendMode[x.sectionDivider.key])&&void 0!==o?o:x.blendMode),y[y.length-1].children.unshift(x),y.push(x)):3===b?y.pop():y[y.length-1].children.unshift(x)}}function I(e,t,n){var r={};r.top=v(e),r.left=v(e),r.bottom=v(e),r.right=v(e);for(var o=g(e),a=[],s=0;s<o;s++){var l=f(e),c=y(e);if(e.large){if(0!==c)throw new Error("Sizes larger than 4GB are not supported");c=y(e)}a.push({id:l,length:c})}E(e,"8BIM");var d=w(e);if(!i.toBlendMode[d])throw new Error("Invalid blend mode: '".concat(d,"'"));r.blendMode=i.toBlendMode[d],r.opacity=p(e)/255,r.clipping=1===p(e);var u=p(e);return r.transparencyProtected=0!==(1&u),r.hidden=0!==(2&u),32&u&&(r.effectsOpen=!0),_(e,1),q(e,1,function(o){!function(e,t){q(e,1,function(n){if(n()){var r={};t.mask=r,r.top=v(e),r.left=v(e),r.bottom=v(e),r.right=v(e),r.defaultColor=p(e);var o=p(e);if(r.positionRelativeToLayer=0!==(1&o),r.disabled=0!==(2&o),r.fromVectorData=0!==(8&o),n()>=18){var i={};t.realMask=i;var a=p(e);i.positionRelativeToLayer=0!==(1&a),i.disabled=0!==(2&a),i.fromVectorData=0!==(8&a),i.defaultColor=p(e),i.top=v(e),i.left=v(e),i.bottom=v(e),i.right=v(e)}if(16&o){var s=p(e);1&s&&(r.userMaskDensity=p(e)/255),2&s&&(r.userMaskFeather=x(e)),4&s&&(r.vectorMaskDensity=p(e)/255),8&s&&(r.vectorMaskFeather=x(e))}_(e,n())}})}(e,r);var i=function(e){return q(e,1,function(t){for(var n=A(e),r=A(e),o=[];t()>0;){var i=A(e),a=A(e);o.push({sourceRange:i,destRange:a})}return{compositeGrayBlendSource:n,compositeGraphBlendDestinationRange:r,ranges:o}})}(e);for(i&&(r.blendingRanges=i),r.name=k(e,1);o()>4&&!S(e,e.offset);)e.offset++;for(;o()>=12;)L(e,r,t,n);_(e,o())}),{layer:r,channels:a}}function A(e){return[p(e),p(e),p(e),p(e)]}function O(e,t,n,r){var o,a,s,l,d,u=(n.right||0)-(n.left||0),p=(n.bottom||0)-(n.top||0),h=4===t.colorMode;if(u&&p)if(h){if(8!==t.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");d={width:u,height:p,data:new Uint8ClampedArray(u*p*5)};for(var f=4;f<d.data.byteLength;f+=5)d.data[f]=255}else d=N(u,p,null!==(o=t.bitsPerChannel)&&void 0!==o?o:8),(0,i.resetImageData)(d);i.RAW_IMAGE_DATA&&(n.imageDataRaw=[],n.imageDataRawCompression=[]);for(var m=0,v=r;m<v.length;m++){var y=v[m];if(0!==y.length){if(y.length<2)throw new Error("Invalid channel length");var x=e.offset,b=g(e);if(b>3&&(e.offset-=1,b=g(e)),b>3&&(e.offset-=3,b=g(e)),b>3)throw new Error("Invalid compression: ".concat(b));if(-2===y.id||-3===y.id){var w=-2===y.id?n.mask:n.realMask;if(!w)throw new Error("Missing layer ".concat(-2===y.id?"mask":"real mask"," data"));var S=(w.right||0)-(w.left||0),k=(w.bottom||0)-(w.top||0);if(S<0||k<0||S>3e4||k>3e4)throw new Error("Invalid mask size");if(S&&k){var C=N(S,k,null!==(a=t.bitsPerChannel)&&void 0!==a?a:8);(0,i.resetImageData)(C);var j=e.offset;R(e,y.length,C,b,S,k,null!==(s=t.bitsPerChannel)&&void 0!==s?s:8,0,e.large,4),i.RAW_IMAGE_DATA&&(-2===y.id?(n.maskDataRawCompression=b,n.maskDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+j,e.offset-j)):(n.realMaskDataRawCompression=b,n.realMaskDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+j,e.offset-j))),c(C),e.useImageData?w.imageData=C:w.canvas=(0,i.imageDataToCanvas)(C)}}else{var _=(0,i.offsetForChannel)(y.id,h),E=d;if(_<0&&(E=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(y.id));R(e,y.length,E,b,u,p,null!==(l=t.bitsPerChannel)&&void 0!==l?l:8,_,e.large,h?5:4),i.RAW_IMAGE_DATA&&(n.imageDataRawCompression[y.id]=b,n.imageDataRaw[y.id]=new Uint8Array(e.view.buffer,e.view.byteOffset+x+2,y.length-2)),e.offset=x+y.length,E&&1===t.colorMode&&c(E)}}}if(d){if(h){var D=d;U(D,d=(0,i.createImageData)(D.width,D.height),!1)}e.useImageData?n.imageData=d:n.canvas=(0,i.imageDataToCanvas)(d)}}function R(e,t,n,r,o,i,a,s,l,c){if(0===r)H(e,n,o,i,a,c,s);else if(1===r)Y(e,n,o,i,a,c,[s],l);else if(2===r)X(e,t,n,o,i,a,c,s,!1);else{if(3!==r)throw new Error("Invalid Compression type: ".concat(r));X(e,t,n,o,i,a,c,s,!0)}}function z(e){return q(e,1,function(t){if(t()){var n=g(e),r=g(e),o=g(e),i=g(e),a=g(e),s=g(e)/255,l=p(e);return _(e,t()),{overlayColorSpace:n,colorSpace1:r,colorSpace2:o,colorSpace3:i,colorSpace4:a,opacity:s,kind:l}}})}t.createReader=d,t.warnOrThrow=u,t.readUint8=p,t.peekUint8=h,t.readInt16=f,t.readUint16=g,t.readUint16LE=m,t.readInt32=v,t.readInt32LE=function(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)},t.readUint32=y,t.readFloat32=function(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)},t.readFloat64=x,t.readFixedPoint32=function(e){return v(e)/65536},t.readFixedPointPath32=function(e){return v(e)/(1<<24)},t.readBytes=b,t.readSignature=w,t.validSignatureAt=S,t.readPascalString=k,t.readUnicodeString=C,t.readUnicodeStringWithLength=j,t.readUnicodeStringWithLengthLE=function(e,t){for(var n="";t--;){var r=m(e);(r||t>0)&&(n+=String.fromCharCode(r))}return n},t.readAsciiString=function(e,t){for(var n="";t--;)n+=String.fromCharCode(p(e));return n},t.skipBytes=_,t.checkSignature=E,t.readPsd=function(e,n){var o;void 0===n&&(n={}),E(e,"8BPS");var a=g(e);if(1!==a&&2!==a)throw new Error("Invalid PSD file version: ".concat(a));_(e,6);var d=g(e),u=y(e),f=y(e),m=g(e),v=g(e),x=1===a?3e4:3e5;if(f>x||u>x)throw new Error("Invalid size: ".concat(f,"x").concat(u));if(d>16)throw new Error("Invalid channel count: ".concat(d));if(![1,8,16,32].includes(m))throw new Error("Invalid bitsPerChannel: ".concat(m));if(-1===t.supportedColorModes.indexOf(v))throw new Error("Color mode not supported: ".concat(null!==(o=l[v])&&void 0!==o?o:v));var w={width:f,height:u,channels:d,bitsPerChannel:m,colorMode:v};Object.assign(e,n),e.large=2===a,e.globalAlpha=!1,q(e,1,function(t){if(t()){if(2===v){if(768!=t())throw new Error("Invalid color palette size");w.palette=[];for(var n=0;n<256;n++)w.palette.push({r:p(e),g:0,b:0});for(n=0;n<256;n++)w.palette[n].g=p(e);for(n=0;n<256;n++)w.palette[n].b=p(e)}_(e,t())}});var S={};q(e,1,function(t){for(var n=function(){P(e,M);var t=g(e);k(e,2),q(e,2,function(n){var r=s.resourceHandlersMap[t],o=1036===t&&!!e.skipThumbnail;if(r&&!o)try{r.read(e,S,n)}catch(i){if(e.throwForMissingFeatures)throw i;_(e,n())}else _(e,n())})};t()>0;)n()});var C=r(S,["layersGroup","layerGroupsEnabledId"]);Object.keys(C)&&(w.imageResources=C),q(e,1,function(t){if(q(e,2,function(t){T(e,w,S),_(e,t())},void 0,e.large),t()>0){var n=z(e);n&&(w.globalLayerMaskInfo=n)}else _(e,t());for(;t()>0;){for(;t()&&0===h(e);)_(e,1);t()>=12?L(e,w,w,S):_(e,t())}},void 0,e.large);var j=w.children&&w.children.length;return e.skipCompositeImageData&&(e.skipLayerImageData||j)||function(e,n){var r,o=g(e),a=null!==(r=n.bitsPerChannel)&&void 0!==r?r:8;if(-1===t.supportedColorModes.indexOf(n.colorMode))throw new Error("Color mode not supported: ".concat(n.colorMode));if(0!==o&&1!==o)throw new Error("Compression type not supported: ".concat(o));var s=N(n.width,n.height,a);switch((0,i.resetImageData)(s),n.colorMode){case 0:if(1!==a)throw new Error("Invalid bitsPerChannel for bitmap color mode");var l=void 0;if(0===o)l=b(e,Math.ceil(n.width/8)*n.height);else{if(1!==o)throw new Error("Bitmap compression not supported: ".concat(o));Y(e,{data:l=new Uint8Array(n.width*n.height),width:n.width,height:n.height},n.width,n.height,8,1,[0],e.large)}(0,i.decodeBitmap)(l,s.data,n.width,n.height);break;case 3:case 1:var d=1===n.colorMode?[0]:[0,1,2];if(n.channels&&n.channels>3)for(var u=3;u<n.channels;u++)d.push(u);else e.globalAlpha&&d.push(3);if(0===o)for(u=0;u<d.length;u++)H(e,s,n.width,n.height,a,4,d[u]);else if(1===o){var p=e.offset;Y(e,s,n.width,n.height,a,4,d,e.large),i.RAW_IMAGE_DATA&&(n.imageDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+p,e.offset-p))}1===n.colorMode&&c(s);break;case 2:if(8!==a)throw new Error("bitsPerChannel Not supproted");if(1!==n.channels)throw new Error("Invalid channel count");if(!n.palette)throw new Error("Missing color palette");if(0===o)throw new Error("Not implemented");if(1!==o)throw new Error("Not implemented");var h={width:s.width,height:s.height,data:new Uint8Array(s.width*s.height)};Y(e,h,n.width,n.height,a,1,[0],e.large),function(e,t,n){for(var r=e.width*e.height,o=e.data,i=t.data,a=0,s=0;a<r;a++,s+=4){var l=n[o[a]];i[s+0]=l.r,i[s+1]=l.g,i[s+2]=l.b,i[s+3]=255}}(h,s,n.palette);break;case 4:if(8!==a)throw new Error("bitsPerChannel Not supproted");if(4!==n.channels)throw new Error("Invalid channel count");d=[0,1,2,3];if(e.globalAlpha&&d.push(4),0===o)throw new Error("Not implemented");if(1!==o)throw new Error("Not implemented");var f={width:s.width,height:s.height,data:new Uint8Array(s.width*s.height*5)};p=e.offset;Y(e,f,n.width,n.height,a,5,d,e.large),U(f,s,!0),i.RAW_IMAGE_DATA&&(n.imageDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+p,e.offset-p));break;default:throw new Error("Color mode not supported: ".concat(n.colorMode))}if(e.globalAlpha){if(8!==n.bitsPerChannel)throw new Error("bitsPerChannel Not supproted");var m=s.data,v=s.width*s.height*4;for(u=0;u<v;u+=4){var y=m[u+3];if(0!=y&&255!=y){var x=1/(y/255),w=255*(1-x);m[u+0]=m[u+0]*x+w,m[u+1]=m[u+1]*x+w,m[u+2]=m[u+2]*x+w}}}e.useImageData?n.imageData=s:n.canvas=(0,i.imageDataToCanvas)(s)}(e,w),w},t.readLayerInfo=T,t.readData=R,t.readGlobalLayerMaskInfo=z;var F=[0,1,-1,2,-2,3,-3,4,-4];function P(e,t){for(var n=e.offset,r="",o=0,i=F;o<i.length;o++){var a=i[o];try{e.offset=n+a,r=w(e)}catch(s){}if(t(r))break}if(!t(r))throw new Error("Invalid signature: '".concat(r,"' at 0x").concat(n.toString(16)));return r}function B(e){return"8BIM"===e||"8B64"===e}function L(e,t,n,r){var o=P(e,B),s=w(e),l="8B64"===o||e.large&&-1!==i.largeAdditionalInfoKeys.indexOf(s);q(e,2,function(o){var i=a.infoHandlersMap[s];if(i)try{i.read(e,t,o,n,r)}catch(l){if(e.throwForMissingFeatures)throw l}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(s)),_(e,o());o()&&(e.logMissingFeatures&&e.log("Unread ".concat(o()," bytes left for additional info: ").concat(s)),_(e,o()))},!1,l)}function N(e,t,n,r){if(void 0===r&&(r=4),1===n||8===n)return 4===r?(0,i.createImageData)(e,t):{width:e,height:t,data:new Uint8ClampedArray(e*t*r)};if(16===n)return{width:e,height:t,data:new Uint16Array(e*t*r)};if(32===n)return{width:e,height:t,data:new Float32Array(e*t*r)};throw new Error("Invalid bitDepth (".concat(n,")"))}function U(e,t,n){for(var r=t.width*t.height*4,o=e.data,i=t.data,a=0,s=0;s<r;a+=5,s+=4){var l=o[a],c=o[a+1],d=o[a+2],u=o[a+3];i[s]=(l*u|0)/255|0,i[s+1]=(c*u|0)/255|0,i[s+2]=(d*u|0)/255|0,i[s+3]=n?255-o[a+4]:o[a+4]}}function V(e,t){if(8===t)return e;if(16===t){if(e.byteOffset%2){var n=new Uint16Array(e.byteLength/2);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2)}if(32===t){if(e.byteOffset%4){n=new Float32Array(e.byteLength/4);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}throw new Error("Invalid bitDepth (".concat(t,")"))}function W(e,t,n,r){!function(e,t){if(e.byteLength/e.length!==t.byteLength/t.length)throw new Error("Invalid array types")}(e.data,t);for(var o=e.width*e.height,i=e.data,a=0,s=0|n;a<o;a++,s=s+r|0)i[s]=t[a]}function H(e,t,n,r,o,i,a){var s=b(e,n*r*Math.floor(o/8));if(32==o)for(var l=0;l<s.byteLength;l+=4){var c=s[l+0],d=s[l+1],u=s[l+2],p=s[l+3];s[l+0]=p,s[l+1]=u,s[l+2]=d,s[l+3]=c}var h=V(s,o);t&&a<i&&W(t,h,a,i)}function G(e,t,n,r){for(var o=0;o<n;o++)for(var i=1,a=o*t+1;i<t;i++,a++)e[a]=(e[a-1]+e[a])%r}function X(e,t,n,r,i,a,s,l,c){var d=b(e,t),u=(0,o.inflate)(d);if(n&&l<s){var p=V(u,a);if(8===a)c&&G(u,r,i,256),W(n,u,l,s);else if(16===a)c&&G(p,r,i,65536),W(n,p,l,s);else{if(32!==a)throw new Error("Invalid bitDepth");c&&G(u,4*r,i,256);for(var h=l,f=new Uint32Array(n.data.buffer,n.data.byteOffset,n.data.length),g=0;g<i;g++)for(var m=4*r*g,v=0;v<r;v++,m++,h+=s){var y=m+r,x=y+r,w=x+r;f[h]=(u[m]<<24|u[y]<<16|u[x]<<8|u[w])>>>0}}}}function Y(e,t,n,r,o,i,a,s){var l,c=t&&t.data;if(s){l=new Uint32Array(a.length*r);for(var d=0,u=0;d<a.length;d++)for(var p=0;p<r;p++,u++)l[u]=y(e)}else{l=new Uint16Array(a.length*r);for(d=0,u=0;d<a.length;d++)for(p=0;p<r;p++,u++)l[u]=g(e)}if(1!==o&&8!==o)throw new Error("Invalid bit depth (".concat(o,")"));var h=i-1|0,f=0;for(u=0;f<a.length;f++){var m=0|a[f];if(!c||(f>h||m>h))for(p=0;p<r;p++,u++)_(e,l[u]);else{p=0;for(var v=0|m;p<r;p++,u++)for(var x=l[u],w=b(e,x),S=0,k=0;S<x;S++){var C=w[S];if(C>128){var j=w[++S];C=256-C|0;for(var E=0;E<=C&&k<n;E=E+1|0,k=k+1|0)c[v]=j,v=v+i|0}else if(C<128)for(E=0;E<=C&&k<n;E=E+1|0,k=k+1|0)c[v]=w[++S],v=v+i|0}}}}function q(e,t,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=!1);var i=y(e);if(o){if(0!==i)throw new Error("Sizes larger than 4GB are not supported");i=y(e)}if(!(i<=0&&r)){var a=e.offset+i;if(a>e.view.byteLength)throw new Error("Section exceeds file size");var s=n(function(){return a-e.offset});for(e.offset!==a&&(e.offset>a?u(e,"Exceeded section limits"):u(e,"Unread section data"));i%t;)i++,a++;return e.offset=a,s}}function Z(e,t,n,r,o){for(var i=e.width,a=e.height,s=t.width,l=0;l<a;l++)for(var c=0;c<i;c++){var d=c+l*i,u=4*(n+c+(l+r)*s),p=e.data[d];t.data[u+o]=p}}t.readAdditionalLayerInfo=L,t.createImageDataBitDepth=N,t.readDataZip=X,t.readDataRLE=Y,t.readSection=q,t.readColor=function(e){switch(g(e)){case 0:var t=g(e)/257,n=g(e)/257,r=g(e)/257;return _(e,2),{r:t,g:n,b:r};case 1:var o=g(e)/65535,i=g(e)/65535;r=g(e)/65535;return _(e,2),{h:o,s:i,b:r};case 2:return{c:g(e)/257,m:g(e)/257,y:g(e)/257,k:d=g(e)/257};case 7:var a=f(e)/1e4,s=f(e),l=f(e),c=s<0?s/12800:s/12700;r=l<0?l/12800:l/12700;return _(e,2),{l:a,a:c,b:r};case 8:var d=255*g(e)/1e4;return _(e,6),{k:d};default:throw new Error("Invalid color space")}},t.readPattern=function(e){y(e);var t=y(e);if(1!==t)throw new Error("Invalid pattern version: ".concat(t));var n=y(e),r=f(e),o=f(e);if(3!==n&&1!==n&&2!==n)throw new Error("Unsupported pattern color mode: ".concat(n));var i=C(e),a=k(e,1),s=[];if(2===n){for(var l=0;l<256;l++)s.push({r:p(e),g:p(e),b:p(e)});_(e,4)}var u=y(e);if(3!==u)throw new Error("Invalid pattern VMAL version: ".concat(u));y(e);var h=y(e),m=y(e),v=y(e),x=y(e),w=y(e),S=x-m,j=v-h,E=new Uint8Array(S*j*4);for(l=3;l<E.byteLength;l+=4)E[l]=255;l=0;for(var D=0;l<w+2;l++){if(y(e)){var M=y(e),T=y(e),I=y(e),A=y(e),O=y(e),R=y(e),z=g(e),F=p(e),P=b(e,M-23);if(8!==T||8!==z)throw new Error("16bit pixel depth not supported for patterns");var B=R-A,L=O-I,N=A-m,U=I-h;if(0===F){if(3===n&&D<3)for(var V=0;V<L;V++)for(var W=0;W<B;W++){var H=W+V*B;E[(q=4*(N+W+(V+U)*S))+D]=P[H]}if(1===n&&D<1)for(var G=0;G<L;G++)for(var X=0;X<B;X++){var q=4*(N+X+(G+U)*S),$=P[H=X+G*B];E[q+0]=$,E[q+1]=$,E[q+2]=$}if(2===n)throw new Error("Indexed pattern color mode not implemented")}else{if(1!==F)throw new Error("Invalid pattern compression mode");var K={data:E,width:S,height:j},J={data:new Uint8Array(B*L),width:B,height:L},Q=d(P.buffer,P.byteOffset,P.byteLength);if(3===n&&D<3&&(Y(Q,J,B,L,8,1,[0],!1),Z(J,K,N,U,D)),1===n&&D<1&&(Y(Q,J,B,L,8,1,[0],!1),Z(J,K,N,U,0),c(K)),2===n)throw new Error("Indexed pattern color mode not implemented")}D++}}return{id:a,name:i,x:r,y:o,bounds:{x:m,y:h,w:S,h:j},data:E}}},8182:(e,t,n)=>{var r=n(2070),o=n(5713),i=n(2074),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=a},8208:(e,t,n)=>{var r;try{r={cloneDeep:n(6434),constant:n(2541),defaults:n(1163),each:n(2580),filter:n(723),find:n(8990),flatten:n(819),forEach:n(5491),forIn:n(7717),has:n(2117),isUndefined:n(141),last:n(4065),map:n(3411),mapValues:n(1733),max:n(539),merge:n(4677),min:n(6745),minBy:n(9364),now:n(4757),pick:n(2616),range:n(6604),reduce:n(2759),sortBy:n(7424),uniqueId:n(111),values:n(6727),zipObject:n(8129)}}catch(o){}r||(r=window._),e.exports=r},8258:e=>{"use strict";e.exports=Object.getOwnPropertyDescriptor},8259:(e,t,n)=>{var r=n(5797);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},8268:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},8311:e=>{e.exports="2.1.8"},8317:(e,t,n)=>{"use strict";var r=n(4635)(),o=n(8117)("Object.prototype.toString"),i=function(e){return!(r&&e&&"object"===typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},a=function(e){return!!i(e)||null!==e&&"object"===typeof e&&"length"in e&&"number"===typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"callee"in e&&"[object Function]"===o(e.callee)},s=function(){return i(arguments)}();i.isLegacyArguments=a,e.exports=s?i:a},8325:(e,t,n)=>{var r=n(2541),o=n(5654),i=n(3279),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},8353:(e,t,n)=>{var r=n(5750);function o(e){var t={},n={},o=[];if(r.each(e.sinks(),function a(s){if(r.has(n,s))throw new i;r.has(t,s)||(n[s]=!0,t[s]=!0,r.each(e.predecessors(s),a),delete n[s],o.push(s))}),r.size(t)!==e.nodeCount())throw new i;return o}function i(){}e.exports=o,o.CycleException=i,i.prototype=new Error},8381:(e,t,n)=>{var r=n(8208);e.exports=function(e,t,n){var o,i={};r.forEach(n,function(n){for(var r,a,s=e.parent(n);s;){if((r=e.parent(s))?(a=i[r],i[r]=s):(a=o,o=s),a&&a!==s)return void t.setEdge(a,s);s=r}})}},8396:(e,t,n)=>{"use strict";var r=n(8208);e.exports=function(e,t){var n={};return r.forEach(e,function(e,t){var o=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(o.barycenter=e.barycenter,o.weight=e.weight)}),r.forEach(t.edges(),function(e){var t=n[e.v],o=n[e.w];r.isUndefined(t)||r.isUndefined(o)||(o.indegree++,t.out.push(n[e.w]))}),function(e){var t=[];function n(e){return function(t){t.merged||(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function o(t){return function(n){n.in.push(t),0===--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),r.forEach(i.in.reverse(),n(i)),r.forEach(i.out,o(i))}return r.map(r.filter(t,function(e){return!e.merged}),function(e){return r.pick(e,["vs","i","barycenter","weight"])})}(r.filter(n,function(e){return!e.indegree}))}},8420:(e,t,n)=>{var r=n(1775),o=n(3211),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];i.call(e,t)&&o(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},8443:(e,t,n)=>{"use strict";e.exports=n(9717)},8468:(e,t,n)=>{var r=n(5816),o=n(644),i=n(4020);e.exports=function(e,t,n){return t===t?i(e,t,n):r(e,o,n)}},8488:(e,t,n)=>{"use strict";const r=n(7094),o=n(2792),i=n(4903),a=n(3785),s=n(3847),l=n(9409),c=Object.prototype.toString,{Z_NO_FLUSH:d,Z_FINISH:u,Z_OK:p,Z_STREAM_END:h,Z_NEED_DICT:f,Z_STREAM_ERROR:g,Z_DATA_ERROR:m,Z_MEM_ERROR:v}=n(2328);function y(e){this.options=o.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;let n=r.inflateInit2(this.strm,t.windowBits);if(n!==p)throw new Error(a[n]);if(this.header=new l,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=i.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary),n!==p)))throw new Error(a[n])}function x(e,t){const n=new y(t);if(n.push(e),n.err)throw n.msg||a[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,o=this.options.chunkSize,a=this.options.dictionary;let s,l,y;if(this.ended)return!1;for(l=t===~~t?t:!0===t?u:d,"[object ArrayBuffer]"===c.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(o),n.next_out=0,n.avail_out=o),s=r.inflate(n,l),s===f&&a&&(s=r.inflateSetDictionary(n,a),s===p?s=r.inflate(n,l):s===m&&(s=f));n.avail_in>0&&s===h&&n.state.wrap>0&&0!==e[n.next_in];)r.inflateReset(n),s=r.inflate(n,l);switch(s){case g:case m:case f:case v:return this.onEnd(s),this.ended=!0,!1}if(y=n.avail_out,n.next_out&&(0===n.avail_out||s===h))if("string"===this.options.to){let e=i.utf8border(n.output,n.next_out),t=n.next_out-e,r=i.buf2string(n.output,e);n.next_out=t,n.avail_out=o-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==p||0!==y){if(s===h)return s=r.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=y,e.exports.inflate=x,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,x(e,t)},e.exports.ungzip=x,e.exports.constants=n(2328)},8541:(e,t,n)=>{var r=n(9812),o=n(149),i=n(4052),a=n(9841),s=r?r.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},8582:(e,t,n)=>{e.exports={components:n(5992),dijkstra:n(5822),dijkstraAll:n(8976),findCycles:n(247),floydWarshall:n(6945),isAcyclic:n(9825),postorder:n(1896),preorder:n(127),prim:n(6368),tarjan:n(8808),topsort:n(8353)}},8592:(e,t,n)=>{var r=n(4262),o=n(6326),i=n(474);e.exports=function(e){return r(e,i,o)}},8630:(e,t,n)=>{var r=n(1516),o=n(6806),i=n(8962),a=n(1295),s=n(8710);e.exports=function(e,t,n){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return i(e);case"[object Symbol]":return a(e)}}},8673:(e,t,n)=>{var r=n(3204),o=n(3713),i=n(6571);e.exports=function(e){return i(e)?r(e):o(e)}},8710:(e,t,n)=>{var r=n(1516);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},8724:(e,t,n)=>{var r=n(7615),o=n(5051),i=n(2154),a=n(8734),s=n(2662);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},8734:(e,t,n)=>{var r=n(5575),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},8799:e=>{"use strict";var t,n,r=Function.prototype.toString,o="object"===typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"===typeof o&&"function"===typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},o(function(){throw 42},null,t)}catch(h){h!==n&&(o=null)}else o=null;var i=/^\s*class\b/,a=function(e){try{var t=r.call(e);return i.test(t)}catch(n){return!1}},s=function(e){try{return!a(e)&&(r.call(e),!0)}catch(t){return!1}},l=Object.prototype.toString,c="function"===typeof Symbol&&!!Symbol.toStringTag,d=!(0 in[,]),u=function(){return!1};if("object"===typeof document){var p=document.all;l.call(p)===l.call(document.all)&&(u=function(e){if((d||!e)&&("undefined"===typeof e||"object"===typeof e))try{var t=l.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(n){}return!1})}e.exports=o?function(e){if(u(e))return!0;if(!e)return!1;if("function"!==typeof e&&"object"!==typeof e)return!1;try{o(e,null,t)}catch(r){if(r!==n)return!1}return!a(e)&&s(e)}:function(e){if(u(e))return!0;if(!e)return!1;if("function"!==typeof e&&"object"!==typeof e)return!1;if(c)return s(e);if(a(e))return!1;var t=l.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&s(e)}},8808:(e,t,n)=>{var r=n(5750);e.exports=function(e){var t=0,n=[],o={},i=[];function a(s){var l=o[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(e){r.has(o,e)?o[e].onStack&&(l.lowlink=Math.min(l.lowlink,o[e].index)):(a(e),l.lowlink=Math.min(l.lowlink,o[e].lowlink))}),l.lowlink===l.index){var c,d=[];do{c=n.pop(),o[c].onStack=!1,d.push(c)}while(s!==c);i.push(d)}}return e.nodes().forEach(function(e){r.has(o,e)||a(e)}),i}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8883:(e,t,n)=>{var r=n(5652),o=n(6571);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,function(e,r,o){i[++n]=t(e,r,o)}),i}},8895:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},8902:(e,t,n)=>{var r=n(4816),o=n(6179),i=n(6704);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},8962:e=>{var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},8976:(e,t,n)=>{var r=n(5822),o=n(5750);e.exports=function(e,t,n){return o.transform(e.nodes(),function(o,i){o[i]=r(e,i,t,n)},{})}},8990:(e,t,n)=>{var r=n(9995)(n(2520));e.exports=r},9057:(e,t,n)=>{var r=n(5324),o=n(2777),i=n(4052),a=n(9194),s=n(6173),l=n(914);e.exports=function(e,t,n){for(var c=-1,d=(t=r(t,e)).length,u=!1;++c<d;){var p=l(t[c]);if(!(u=null!=e&&n(e,p)))break;e=e[p]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&s(d)&&a(p,d)&&(i(e)||o(e))}},9075:(e,t,n)=>{var r=n(6614),o=n(6326);e.exports=function(e,t){return r(e,o(e),t)}},9096:(e,t,n)=>{var r=n(9256),o=n(5029),i=n(3279),a=n(4052),s=n(3932);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?o(e[0],e[1]):r(e):s(e)}},9140:(e,t,n)=>{var r=n(7303);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},9194:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},9207:(e,t,n)=>{var r=n(9383);e.exports={Graph:r.Graph,json:n(1097),alg:n(8582),version:r.version}},9256:(e,t,n)=>{var r=n(6532),o=n(3781),i=n(1310);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},9261:(e,t,n)=>{var r=n(8420),o=n(5324),i=n(9194),a=n(6686),s=n(914);e.exports=function(e,t,n,l){if(!a(e))return e;for(var c=-1,d=(t=o(t,e)).length,u=d-1,p=e;null!=p&&++c<d;){var h=s(t[c]),f=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;if(c!=u){var g=p[h];void 0===(f=l?l(g,h,p):void 0)&&(f=a(g)?g:i(t[c+1])?[]:{})}r(p,h,f),p=p[h]}return e}},9304:e=>{"use strict";e.exports=Error},9321:(e,t,n)=>{"use strict";var r=n(8317),o=n(1583),i=n(8004),a=n(9849);function s(e){return e.call.bind(e)}var l="undefined"!==typeof BigInt,c="undefined"!==typeof Symbol,d=s(Object.prototype.toString),u=s(Number.prototype.valueOf),p=s(String.prototype.valueOf),h=s(Boolean.prototype.valueOf);if(l)var f=s(BigInt.prototype.valueOf);if(c)var g=s(Symbol.prototype.valueOf);function m(e,t){if("object"!==typeof e)return!1;try{return t(e),!0}catch(n){return!1}}function v(e){return"[object Map]"===d(e)}function y(e){return"[object Set]"===d(e)}function x(e){return"[object WeakMap]"===d(e)}function b(e){return"[object WeakSet]"===d(e)}function w(e){return"[object ArrayBuffer]"===d(e)}function S(e){return"undefined"!==typeof ArrayBuffer&&(w.working?w(e):e instanceof ArrayBuffer)}function k(e){return"[object DataView]"===d(e)}function C(e){return"undefined"!==typeof DataView&&(k.working?k(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=o,t.isTypedArray=a,t.isPromise=function(e){return"undefined"!==typeof Promise&&e instanceof Promise||null!==e&&"object"===typeof e&&"function"===typeof e.then&&"function"===typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||C(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},v.working="undefined"!==typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!==typeof Map&&(v.working?v(e):e instanceof Map)},y.working="undefined"!==typeof Set&&y(new Set),t.isSet=function(e){return"undefined"!==typeof Set&&(y.working?y(e):e instanceof Set)},x.working="undefined"!==typeof WeakMap&&x(new WeakMap),t.isWeakMap=function(e){return"undefined"!==typeof WeakMap&&(x.working?x(e):e instanceof WeakMap)},b.working="undefined"!==typeof WeakSet&&b(new WeakSet),t.isWeakSet=function(e){return b(e)},w.working="undefined"!==typeof ArrayBuffer&&w(new ArrayBuffer),t.isArrayBuffer=S,k.working="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView&&k(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=C;var j="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function _(e){return"[object SharedArrayBuffer]"===d(e)}function E(e){return"undefined"!==typeof j&&("undefined"===typeof _.working&&(_.working=_(new j)),_.working?_(e):e instanceof j)}function D(e){return m(e,u)}function M(e){return m(e,p)}function T(e){return m(e,h)}function I(e){return l&&m(e,f)}function A(e){return c&&m(e,g)}t.isSharedArrayBuffer=E,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===d(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===d(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===d(e)},t.isGeneratorObject=function(e){return"[object Generator]"===d(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===d(e)},t.isNumberObject=D,t.isStringObject=M,t.isBooleanObject=T,t.isBigIntObject=I,t.isSymbolObject=A,t.isBoxedPrimitive=function(e){return D(e)||M(e)||T(e)||I(e)||A(e)},t.isAnyArrayBuffer=function(e){return"undefined"!==typeof Uint8Array&&(S(e)||E(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})})},9328:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerCompCapturedInfo=t.SectionDividerType=t.ColorMode=void 0,function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(t.ColorMode||(t.ColorMode={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"}(t.SectionDividerType||(t.SectionDividerType={})),function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"}(t.LayerCompCapturedInfo||(t.LayerCompCapturedInfo={}))},9364:(e,t,n)=>{var r=n(9742),o=n(9096),i=n(61);e.exports=function(e,t){return e&&e.length?r(e,o(t,2),i):void 0}},9377:e=>{e.exports=function(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var s=r<i?t[r]:void 0;n(a,e[r],s)}return a}},9383:(e,t,n)=>{e.exports={Graph:n(191),version:n(8311)}},9394:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).has(e)}},9395:(e,t,n)=>{var r=n(4262),o=n(9621),i=n(8673);e.exports=function(e){return r(e,i,o)}},9409:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},9417:(e,t,n)=>{var r=n(6686);e.exports=function(e){return e===e&&!r(e)}},9421:e=>{e.exports=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9534:e=>{"use strict";e.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"===typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(var r in e[t]=42,e)return!1;if("function"===typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var o=Object.getOwnPropertySymbols(e);if(1!==o.length||o[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},9558:(e,t,n)=>{"use strict";var r=n(8208),o=n(7938).Graph,i=n(5641);function a(e,t){var n={};return r.reduce(t,function(t,o){var i=0,a=0,s=t.length,c=r.last(o);return r.forEach(o,function(t,d){var u=function(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),function(t){return e.node(t).dummy})}(e,t),p=u?e.node(u).order:s;(u||t===c)&&(r.forEach(o.slice(a,d+1),function(t){r.forEach(e.predecessors(t),function(r){var o=e.node(r),a=o.order;!(a<i||p<a)||o.dummy&&e.node(t).dummy||l(n,r,t)})}),a=d+1,i=p)}),o}),n}function s(e,t){var n={};function o(t,o,i,a,s){var c;r.forEach(r.range(o,i),function(o){c=t[o],e.node(c).dummy&&r.forEach(e.predecessors(c),function(t){var r=e.node(t);r.dummy&&(r.order<a||r.order>s)&&l(n,t,c)})})}return r.reduce(t,function(t,n){var i,a=-1,s=0;return r.forEach(n,function(r,l){if("border"===e.node(r).dummy){var c=e.predecessors(r);c.length&&(i=e.node(c[0]).order,o(n,s,l,a,i),s=l,a=i)}o(n,s,n.length,i,t.length)}),n}),n}function l(e,t,n){if(t>n){var r=t;t=n,n=r}var o=e[t];o||(e[t]=o={}),o[n]=!0}function c(e,t,n){if(t>n){var o=t;t=n,n=o}return r.has(e[t],n)}function d(e,t,n,o){var i={},a={},s={};return r.forEach(t,function(e){r.forEach(e,function(e,t){i[e]=e,a[e]=e,s[e]=t})}),r.forEach(t,function(e){var t=-1;r.forEach(e,function(e){var l=o(e);if(l.length){l=r.sortBy(l,function(e){return s[e]});for(var d=(l.length-1)/2,u=Math.floor(d),p=Math.ceil(d);u<=p;++u){var h=l[u];a[e]===e&&t<s[h]&&!c(n,e,h)&&(a[h]=e,a[e]=i[e]=i[h],t=s[h])}}})}),{root:i,align:a}}function u(e,t,n,i,a){var s={},l=function(e,t,n,i){var a=new o,s=e.graph(),l=function(e,t,n){return function(o,i,a){var s,l=o.node(i),c=o.node(a),d=0;if(d+=l.width/2,r.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=-l.width/2;break;case"r":s=l.width/2}if(s&&(d+=n?s:-s),s=0,d+=(l.dummy?t:e)/2,d+=(c.dummy?t:e)/2,d+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":s=c.width/2;break;case"r":s=-c.width/2}return s&&(d+=n?s:-s),s=0,d}}(s.nodesep,s.edgesep,i);return r.forEach(t,function(t){var o;r.forEach(t,function(t){var r=n[t];if(a.setNode(r),o){var i=n[o],s=a.edge(i,r);a.setEdge(i,r,Math.max(l(e,t,o),s||0))}o=t})}),a}(e,t,n,a),c=a?"borderLeft":"borderRight";function d(e,t){for(var n=l.nodes(),r=n.pop(),o={};r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return d(function(e){s[e]=l.inEdges(e).reduce(function(e,t){return Math.max(e,s[t.v]+l.edge(t))},0)},l.predecessors.bind(l)),d(function(t){var n=l.outEdges(t).reduce(function(e,t){return Math.min(e,s[t.w]-l.edge(t))},Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(s[t]=Math.max(s[t],n))},l.successors.bind(l)),r.forEach(i,function(e){s[e]=s[n[e]]}),s}function p(e,t){return r.minBy(r.values(t),function(t){var n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return r.forIn(t,function(t,r){var i=function(e,t){return e.node(t).width}(e,r)/2;n=Math.max(t+i,n),o=Math.min(t-i,o)}),n-o})}function h(e,t){var n=r.values(t),o=r.min(n),i=r.max(n);r.forEach(["u","d"],function(n){r.forEach(["l","r"],function(a){var s,l=n+a,c=e[l];if(c!==t){var d=r.values(c);(s="l"===a?o-r.min(d):i-r.max(d))&&(e[l]=r.mapValues(c,function(e){return e+s}))}})})}function f(e,t){return r.mapValues(e.ul,function(n,o){if(t)return e[t.toLowerCase()][o];var i=r.sortBy(r.map(e,o));return(i[1]+i[2])/2})}e.exports={positionX:function(e){var t,n=i.buildLayerMatrix(e),o=r.merge(a(e,n),s(e,n)),l={};r.forEach(["u","d"],function(i){t="u"===i?n:r.values(n).reverse(),r.forEach(["l","r"],function(n){"r"===n&&(t=r.map(t,function(e){return r.values(e).reverse()}));var a=("u"===i?e.predecessors:e.successors).bind(e),s=d(e,t,o,a),c=u(e,t,s.root,s.align,"r"===n);"r"===n&&(c=r.mapValues(c,function(e){return-e})),l[i+n]=c})});var c=p(e,l);return h(l,c),f(l,e.graph().align)},findType1Conflicts:a,findType2Conflicts:s,addConflict:l,hasConflict:c,verticalAlignment:d,horizontalCompaction:u,alignCoordinates:h,findSmallestWidthAlignment:p,balance:f}},9621:(e,t,n)=>{var r=n(7529),o=n(7828),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),function(t){return i.call(e,t)}))}:o;e.exports=s},9676:e=>{var t=Math.ceil,n=Math.max;e.exports=function(e,r,o,i){for(var a=-1,s=n(t((r-e)/(o||1)),0),l=Array(s);s--;)l[i?s:++a]=e,e+=o;return l}},9717:(e,t,n)=>{"use strict";var r=n(5043),o=n(9461);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=o.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,d=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var u=s(null);if(null===u.current){var p={hasValue:!1,value:null};u.current=p}else p=u.current;u=c(function(){function e(e){if(!l){if(l=!0,a=e,e=r(e),void 0!==o&&p.hasValue){var t=p.value;if(o(t,e))return s=t}return s=e}if(t=s,i(a,e))return t;var n=r(e);return void 0!==o&&o(t,n)?(a=e,t):(a=e,s=n)}var a,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,o]);var h=a(e,u[0],u[1]);return l(function(){p.hasValue=!0,p.value=h},[h]),d(h),h}},9729:(e,t)=>{"use strict";function n(e){return 32===e||10===e||13===e||9===e}function r(e){return e>=48&&e<=57||46===e||45===e}Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEngineData=t.parseEngineData=void 0,t.parseEngineData=function(e){var t=0;function o(){for(;t<e.length&&n(e[t]);)t++}function i(){var n=e[t];return t++,92===n&&(n=e[t],t++),n}function a(){var n="";if(41===e[t])return t++,n;if(254!==e[t]||255!==e[t+1])throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&41!==e[t];){var r=i()<<8|i();n+=String.fromCharCode(r)}return t++,n}var s=null,l=[];function c(e){l.length?(d(e),l.push(e)):(l.push(e),s=e)}function d(e){if(!l.length)throw new Error("Invalid data");var t=l[l.length-1];if("string"===typeof t)l[l.length-2][t]=e,p();else{if(!Array.isArray(t))throw new Error("Invalid data");t.push(e)}}function u(e){l.length||c({});var t=l[l.length-1];if(t&&"string"===typeof t)d("nil"===e?null:"/".concat(e));else{if(!t||"object"!==typeof t)throw new Error("Invalid data");l.push(e)}}function p(){if(!l.length)throw new Error("Invalid data");l.pop()}o();for(var h=e.length;h>0&&0===e[h-1];)h--;for(;t<h;){var f=t,g=e[f];if(60===g&&60===e[f+1])t+=2,c({});else if(62===g&&62===e[f+1])t+=2,p();else if(47===g){for(var m=t+=1;t<e.length&&!n(e[t]);)t++;for(var v="",y=m;y<t;y++)v+=String.fromCharCode(e[y]);u(v)}else if(40===g)t+=1,d(a());else if(91===g)t+=1,c([]);else if(93===g)t+=1,p();else if(110===g&&117===e[f+1]&&108===e[f+2]&&108===e[f+3])t+=4,d(null);else if(116===g&&114===e[f+1]&&117===e[f+2]&&101===e[f+3])t+=4,d(!0);else if(102===g&&97===e[f+1]&&108===e[f+2]&&115===e[f+3]&&101===e[f+4])t+=5,d(!1);else if(r(g)){for(var x="";t<e.length&&r(e[t]);)x+=String.fromCharCode(e[t]),t++;d(parseFloat(x))}else t+=1,console.log("Invalid token '".concat(String.fromCharCode(g),"' (").concat(g,") at ").concat(t));o()}return s};var o=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],i=["RunLengthArray"];t.serializeEngineData=function(e,t){void 0===t&&(t=!1);var n=new Uint8Array(1024),r=0,a=0;function s(e){if(r>=n.length){var t=new Uint8Array(2*n.length);t.set(n),n=t}n[r]=e,r++}function l(e){for(var t=0;t<e.length;t++)s(e.charCodeAt(t))}function c(){if(t)l(" ");else for(var e=0;e<a;e++)l("\t")}function d(e,n){c(),l("/".concat(e)),g(n,e,!0),t||l("\n")}function u(e){return e.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function p(e,t){return t&&-1!==o.indexOf(t)||(0|e)!==e?u(e):function(e){return e.toString()}(e)}function h(e){var t=Object.keys(e);return-1!==t.indexOf("98")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),-1!==t.indexOf("99")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),t}function f(e){40!==e&&41!==e&&92!==e||s(92),s(e)}function g(e,n,r){function o(){r?l(" "):c()}if(void 0===r&&(r=!1),null===e)o(),l(t?"/nil":"null");else if("number"===typeof e)o(),l(p(e,n));else if("boolean"===typeof e)o(),l(e?"true":"false");else if("string"===typeof e)if(o(),"99"!==n&&"98"!==n||"/"!==e.charAt(0)){l("("),s(254),s(255);for(var m=0;m<e.length;m++){var v=e.charCodeAt(m);f(v>>8&255),f(255&v)}l(")")}else l(e);else if(Array.isArray(e))if(o(),e.every(function(e){return"number"===typeof e})){l("[");for(var y=-1!==i.indexOf(n),x=0,b=e;x<b.length;x++){var w=b[x];l(" "),l(y?p(w):u(w))}l(" ]")}else{l("["),t||l("\n");for(var S=0,k=e;S<k.length;S++){g(w=k[S],n),t||l("\n")}c(),l("]")}else if("object"===typeof e){r&&!t&&l("\n"),c(),l("<<"),t||l("\n"),a++;for(var C=0,j=h(e);C<j.length;C++){var _=j[C];d(_,e[_])}a--,c(),l(">>")}}if(t){if("object"===typeof e)for(var m=0,v=h(e);m<v.length;m++){var y=v[m];d(y,e[y])}}else l("\n\n"),g(e);return n.slice(0,r)}},9742:(e,t,n)=>{var r=n(9841);e.exports=function(e,t,n){for(var o=-1,i=e.length;++o<i;){var a=e[o],s=t(a);if(null!=s&&(void 0===l?s===s&&!r(s):n(s,l)))var l=s,c=a}return c}},9791:(e,t,n)=>{var r=n(8208),o=n(6297),i=n(8396),a=n(388);e.exports=function e(t,n,s,l){var c=t.children(n),d=t.node(n),u=d?d.borderLeft:void 0,p=d?d.borderRight:void 0,h={};u&&(c=r.filter(c,function(e){return e!==u&&e!==p}));var f=o(t,c);r.forEach(f,function(n){if(t.children(n.v).length){var o=e(t,n.v,s,l);h[n.v]=o,r.has(o,"barycenter")&&(i=n,a=o,r.isUndefined(i.barycenter)?(i.barycenter=a.barycenter,i.weight=a.weight):(i.barycenter=(i.barycenter*i.weight+a.barycenter*a.weight)/(i.weight+a.weight),i.weight+=a.weight))}var i,a});var g=i(f,s);!function(e,t){r.forEach(e,function(e){e.vs=r.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}(g,h);var m=a(g,l);if(u&&(m.vs=r.flatten([u,m.vs,p],!0),t.predecessors(u).length)){var v=t.node(t.predecessors(u)[0]),y=t.node(t.predecessors(p)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+v.order+y.order)/(m.weight+2),m.weight+=2}return m}},9812:(e,t,n)=>{var r=n(6552).Symbol;e.exports=r},9820:e=>{"use strict";e.exports=EvalError},9825:(e,t,n)=>{var r=n(8353);e.exports=function(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},9841:(e,t,n)=>{var r=n(6913),o=n(2761);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},9849:(e,t,n)=>{"use strict";var r=n(8004);e.exports=function(e){return!!r(e)}},9935:(e,t,n)=>{var r=n(1340),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},9987:(e,t,n)=>{var r=n(9812),o=n(2929),i=n(3211),a=n(3668),s=n(4160),l=n(2074),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,u,p){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=s;case"[object Set]":var f=1&r;if(h||(h=l),e.size!=t.size&&!f)return!1;var g=p.get(e);if(g)return g==t;r|=2,p.set(e,t);var m=a(h(e),h(t),r,c,u,p);return p.delete(e),m;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},9995:(e,t,n)=>{var r=n(9096),o=n(6571),i=n(8673);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!o(t)){var l=r(n,3);t=i(t),n=function(e){return l(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[l?t[c]:c]:void 0}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",n.nc=void 0,(()=>{"use strict";var e=n(5043),t=n(4391);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=n(579);function d(e){if("string"===typeof e||"number"===typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,r=0;r<e.length;r++)""!==(n=d(e[r]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var u={value:()=>{}};function p(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new h(r)}function h(e){this._=e}function f(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function g(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=u,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}h.prototype=p.prototype={constructor:h,on:function(e,t){var n,r,o=this._,i=(r=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(n=(e=i[a]).type)o[n]=g(o[n],e.name,t);else if(null==t)for(n in o)o[n]=g(o[n],e.name,null);return this}for(;++a<s;)if((n=(e=i[a]).type)&&(n=f(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new h(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};const m=p;function v(){}function y(e){return null==e?v:function(){return this.querySelector(e)}}function x(){return[]}function b(e){return null==e?x:function(){return this.querySelectorAll(e)}}function w(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function S(e){return function(){return this.matches(e)}}function k(e){return function(t){return t.matches(e)}}var C=Array.prototype.find;function j(){return this.firstElementChild}var _=Array.prototype.filter;function E(){return Array.from(this.children)}function D(e){return new Array(e.length)}function M(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function T(e,t,n,r,o,i){for(var a,s=0,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new M(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function I(e,t,n,r,o,i,a){var s,l,c,d=new Map,u=t.length,p=i.length,h=new Array(u);for(s=0;s<u;++s)(l=t[s])&&(h[s]=c=a.call(l,l.__data__,s,t)+"",d.has(c)?o[s]=l:d.set(c,l));for(s=0;s<p;++s)c=a.call(e,i[s],s,i)+"",(l=d.get(c))?(r[s]=l,l.__data__=i[s],d.delete(c)):n[s]=new M(e,i[s]);for(s=0;s<u;++s)(l=t[s])&&d.get(h[s])===l&&(o[s]=l)}function A(e){return e.__data__}function O(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function R(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}M.prototype={constructor:M,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var z="http://www.w3.org/1999/xhtml";const F={svg:"http://www.w3.org/2000/svg",xhtml:z,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function P(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),F.hasOwnProperty(t)?{space:F[t],local:e}:e}function B(e){return function(){this.removeAttribute(e)}}function L(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N(e,t){return function(){this.setAttribute(e,t)}}function U(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function V(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function W(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function H(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function G(e){return function(){this.style.removeProperty(e)}}function X(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Y(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function q(e,t){return e.style.getPropertyValue(t)||H(e).getComputedStyle(e,null).getPropertyValue(t)}function Z(e){return function(){delete this[e]}}function $(e,t){return function(){this[e]=t}}function K(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function J(e){return e.trim().split(/^|\s+/)}function Q(e){return e.classList||new ee(e)}function ee(e){this._node=e,this._names=J(e.getAttribute("class")||"")}function te(e,t){for(var n=Q(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function ne(e,t){for(var n=Q(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function re(e){return function(){te(this,e)}}function oe(e){return function(){ne(this,e)}}function ie(e,t){return function(){(t.apply(this,arguments)?te:ne)(this,e)}}function ae(){this.textContent=""}function se(e){return function(){this.textContent=e}}function le(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ce(){this.innerHTML=""}function de(e){return function(){this.innerHTML=e}}function ue(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function pe(){this.nextSibling&&this.parentNode.appendChild(this)}function he(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===z&&t.documentElement.namespaceURI===z?t.createElement(e):t.createElementNS(n,e)}}function ge(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function me(e){var t=P(e);return(t.local?ge:fe)(t)}function ve(){return null}function ye(){var e=this.parentNode;e&&e.removeChild(this)}function xe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function be(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function we(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function Se(e,t,n){return function(){var r,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function ke(e,t,n){var r=H(e),o=r.CustomEvent;"function"===typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Ce(e,t){return function(){return ke(this,e,t)}}function je(e,t){return function(){return ke(this,e,t.apply(this,arguments))}}ee.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var _e=[null];function Ee(e,t){this._groups=e,this._parents=t}function De(){return new Ee([[document.documentElement]],_e)}Ee.prototype=De.prototype={constructor:Ee,select:function(e){"function"!==typeof e&&(e=y(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=t[o],l=s.length,c=r[o]=new Array(l),d=0;d<l;++d)(i=s[d])&&(a=e.call(i,i.__data__,d,s))&&("__data__"in i&&(a.__data__=i.__data__),c[d]=a);return new Ee(r,this._parents)},selectAll:function(e){e="function"===typeof e?w(e):b(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,s=t[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(r.push(e.call(a,a.__data__,c,s)),o.push(a));return new Ee(r,o)},selectChild:function(e){return this.select(null==e?j:function(e){return function(){return C.call(this.children,e)}}("function"===typeof e?e:k(e)))},selectChildren:function(e){return this.selectAll(null==e?E:function(e){return function(){return _.call(this.children,e)}}("function"===typeof e?e:k(e)))},filter:function(e){"function"!==typeof e&&(e=S(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Ee(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,A);var n=t?I:T,r=this._parents,o=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var i=o.length,a=new Array(i),s=new Array(i),l=new Array(i),c=0;c<i;++c){var d=r[c],u=o[c],p=u.length,h=O(e.call(d,d&&d.__data__,c,r)),f=h.length,g=s[c]=new Array(f),m=a[c]=new Array(f);n(d,u,g,m,l[c]=new Array(p),h,t);for(var v,y,x=0,b=0;x<f;++x)if(v=g[x]){for(x>=b&&(b=x+1);!(y=m[b])&&++b<f;);v._next=y||null}}return(a=new Ee(a,r))._enter=s,a._exit=l,a},enter:function(){return new Ee(this._enter||this._groups.map(D),this._parents)},exit:function(){return new Ee(this._exit||this._groups.map(D),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,a=Math.min(o,i),s=new Array(o),l=0;l<a;++l)for(var c,d=n[l],u=r[l],p=d.length,h=s[l]=new Array(p),f=0;f<p;++f)(c=d[f]||u[f])&&(h[f]=c);for(;l<o;++l)s[l]=n[l];return new Ee(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=R);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],l=s.length,c=o[i]=new Array(l),d=0;d<l;++d)(a=s[d])&&(c[d]=a);c.sort(t)}return new Ee(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,s=i.length;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=P(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?L:B:"function"===typeof t?n.local?W:V:n.local?U:N)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?G:"function"===typeof t?Y:X)(e,t,null==n?"":n)):q(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Z:"function"===typeof t?K:$)(e,t)):this.node()[e]},classed:function(e,t){var n=J(e+"");if(arguments.length<2){for(var r=Q(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"===typeof t?ie:t?re:oe)(n,t))},text:function(e){return arguments.length?this.each(null==e?ae:("function"===typeof e?le:se)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ce:("function"===typeof e?ue:de)(e)):this.node().innerHTML},raise:function(){return this.each(pe)},lower:function(){return this.each(he)},append:function(e){var t="function"===typeof e?e:me(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"===typeof e?e:me(e),r=null==t?ve:"function"===typeof t?t:y(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(ye)},clone:function(e){return this.select(e?be:xe)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?Se:we,r=0;r<a;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,d=s.length;c<d;++c)for(r=0,l=s[c];r<a;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?je:Ce)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};const Me=De;function Te(e){return"string"===typeof e?new Ee([[document.querySelector(e)]],[document.documentElement]):new Ee([[e]],_e)}function Ie(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ae={passive:!1},Oe={capture:!0,passive:!1};function Re(e){e.stopImmediatePropagation()}function ze(e){e.preventDefault(),e.stopImmediatePropagation()}function Fe(e){var t=e.document.documentElement,n=Te(e).on("dragstart.drag",ze,Oe);"onselectstart"in t?n.on("selectstart.drag",ze,Oe):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Pe(e,t){var n=e.document.documentElement,r=Te(e).on("dragstart.drag",null);t&&(r.on("click.drag",ze,Oe),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Be=e=>()=>e;function Le(e,t){let{sourceEvent:n,subject:r,target:o,identifier:i,active:a,x:s,y:l,dx:c,dy:d,dispatch:u}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}function Ne(e){return!e.ctrlKey&&!e.button}function Ue(){return this.parentNode}function Ve(e,t){return null==t?{x:e.x,y:e.y}:t}function We(){return navigator.maxTouchPoints||"ontouchstart"in this}function He(){var e,t,n,r,o=Ne,i=Ue,a=Ve,s=We,l={},c=m("start","drag","end"),d=0,u=0;function p(e){e.on("mousedown.drag",h).filter(s).on("touchstart.drag",v).on("touchmove.drag",y,Ae).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(a,s){if(!r&&o.call(this,a,s)){var l=b(this,i.call(this,a,s),a,s,"mouse");l&&(Te(a.view).on("mousemove.drag",f,Oe).on("mouseup.drag",g,Oe),Fe(a.view),Re(a),n=!1,e=a.clientX,t=a.clientY,l("start",a))}}function f(r){if(ze(r),!n){var o=r.clientX-e,i=r.clientY-t;n=o*o+i*i>u}l.mouse("drag",r)}function g(e){Te(e.view).on("mousemove.drag mouseup.drag",null),Pe(e.view,n),ze(e),l.mouse("end",e)}function v(e,t){if(o.call(this,e,t)){var n,r,a=e.changedTouches,s=i.call(this,e,t),l=a.length;for(n=0;n<l;++n)(r=b(this,s,e,t,a[n].identifier,a[n]))&&(Re(e),r("start",e,a[n]))}}function y(e){var t,n,r=e.changedTouches,o=r.length;for(t=0;t<o;++t)(n=l[r[t].identifier])&&(ze(e),n("drag",e,r[t]))}function x(e){var t,n,o=e.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),t=0;t<i;++t)(n=l[o[t].identifier])&&(Re(e),n("end",e,o[t]))}function b(e,t,n,r,o,i){var s,u,h,f=c.copy(),g=Ie(i||n,t);if(null!=(h=a.call(e,new Le("beforestart",{sourceEvent:n,target:p,identifier:o,active:d,x:g[0],y:g[1],dx:0,dy:0,dispatch:f}),r)))return s=h.x-g[0]||0,u=h.y-g[1]||0,function n(i,a,c){var m,v=g;switch(i){case"start":l[o]=n,m=d++;break;case"end":delete l[o],--d;case"drag":g=Ie(c||a,t),m=d}f.call(i,e,new Le(i,{sourceEvent:a,subject:h,target:p,identifier:o,active:m,x:g[0]+s,y:g[1]+u,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:f}),r)}}return p.filter=function(e){return arguments.length?(o="function"===typeof e?e:Be(!!e),p):o},p.container=function(e){return arguments.length?(i="function"===typeof e?e:Be(e),p):i},p.subject=function(e){return arguments.length?(a="function"===typeof e?e:Be(e),p):a},p.touchable=function(e){return arguments.length?(s="function"===typeof e?e:Be(!!e),p):s},p.on=function(){var e=c.on.apply(c,arguments);return e===c?p:e},p.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,p):Math.sqrt(u)},p}Le.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ge(e){return((e=Math.exp(e))+1/e)/2}const Xe=function e(t,n,r){function o(e,o){var i,a,s=e[0],l=e[1],c=e[2],d=o[0],u=o[1],p=o[2],h=d-s,f=u-l,g=h*h+f*f;if(g<1e-12)a=Math.log(p/c)/t,i=function(e){return[s+e*h,l+e*f,c*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),v=(p*p-c*c+r*g)/(2*c*n*m),y=(p*p-c*c-r*g)/(2*p*n*m),x=Math.log(Math.sqrt(v*v+1)-v),b=Math.log(Math.sqrt(y*y+1)-y);a=(b-x)/t,i=function(e){var r=e*a,o=Ge(x),i=c/(n*m)*(o*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+x)-function(e){return((e=Math.exp(e))-1/e)/2}(x));return[s+i*h,l+i*f,c*o/Ge(t*r+x)]}}return i.duration=1e3*a*t/Math.SQRT2,i}return o.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},o}(Math.SQRT2,2,4);var Ye,qe,Ze=0,$e=0,Ke=0,Je=0,Qe=0,et=0,tt="object"===typeof performance&&performance.now?performance:Date,nt="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function rt(){return Qe||(nt(ot),Qe=tt.now()+et)}function ot(){Qe=0}function it(){this._call=this._time=this._next=null}function at(e,t,n){var r=new it;return r.restart(e,t,n),r}function st(){Qe=(Je=tt.now())+et,Ze=$e=0;try{!function(){rt(),++Ze;for(var e,t=Ye;t;)(e=Qe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ze}()}finally{Ze=0,function(){var e,t,n=Ye,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Ye=t);qe=e,ct(r)}(),Qe=0}}function lt(){var e=tt.now(),t=e-Je;t>1e3&&(et-=t,Je=e)}function ct(e){Ze||($e&&($e=clearTimeout($e)),e-Qe>24?(e<1/0&&($e=setTimeout(st,e-tt.now()-et)),Ke&&(Ke=clearInterval(Ke))):(Ke||(Je=tt.now(),Ke=setInterval(lt,1e3)),Ze=1,nt(st)))}function dt(e,t,n){var r=new it;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}it.prototype=at.prototype={constructor:it,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?rt():+n)+(null==t?0:+t),this._next||qe===this||(qe?qe._next=this:Ye=this,qe=this),this._call=e,this._time=n,ct()},stop:function(){this._call&&(this._call=null,this._time=1/0,ct())}};var ut=m("start","end","cancel","interrupt"),pt=[];function ht(e,t,n,r,o,i){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function i(e){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}function a(i){var c,d,u,p;if(1!==n.state)return l();for(c in o)if((p=o[c]).name===n.name){if(3===p.state)return dt(a);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[c]):+c<t&&(p.state=6,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[c])}if(dt(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(i))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(u=n.tween.length),c=0,d=-1;c<u;++c)(p=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++d]=p);r.length=d+1}}function s(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,a=r.length;++i<a;)r[i].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=at(i,0,n.time)}(e,n,{name:t,index:r,group:o,on:ut,tween:pt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function ft(e,t){var n=mt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function gt(e,t){var n=mt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function mt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vt(e,t){var n,r,o,i=e.__transition,a=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete e.__transition}}function yt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var xt,bt=180/Math.PI,wt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function St(e,t,n,r,o,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*bt,skewX:Math.atan(l)*bt,scaleX:a,scaleY:s}}function kt(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],l=[];return i=e(i),a=e(a),function(e,r,o,i,a,s){if(e!==o||r!==i){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:yt(e,o)},{i:l-2,x:yt(r,i)})}else(o||i)&&a.push("translate("+o+t+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:yt(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(i.rotate,a.rotate,s,l),function(e,t,n,i){e!==t?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:yt(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(i.skewX,a.skewX,s,l),function(e,t,n,r,i,a){if(e!==n||t!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:yt(e,n)},{i:s-2,x:yt(t,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var Ct=kt(function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wt:St(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),jt=kt(function(e){return null==e?wt:(xt||(xt=document.createElementNS("http://www.w3.org/2000/svg","g")),xt.setAttribute("transform",e),(e=xt.transform.baseVal.consolidate())?St((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):wt)},", ",")",")");function _t(e,t){var n,r;return function(){var o=gt(this,e),i=o.tween;if(i!==n)for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}o.tween=r}}function Et(e,t,n){var r,o;if("function"!==typeof n)throw new Error;return function(){var i=gt(this,e),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=s;break}l===c&&o.push(s)}i.tween=o}}function Dt(e,t,n){var r=e._id;return e.each(function(){var e=gt(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return mt(e,r).value[t]}}function Mt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Tt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function It(){}var At=.7,Ot=1/At,Rt="\\s*([+-]?\\d+)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ft="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pt=/^#([0-9a-f]{3,8})$/,Bt=new RegExp("^rgb\\(".concat(Rt,",").concat(Rt,",").concat(Rt,"\\)$")),Lt=new RegExp("^rgb\\(".concat(Ft,",").concat(Ft,",").concat(Ft,"\\)$")),Nt=new RegExp("^rgba\\(".concat(Rt,",").concat(Rt,",").concat(Rt,",").concat(zt,"\\)$")),Ut=new RegExp("^rgba\\(".concat(Ft,",").concat(Ft,",").concat(Ft,",").concat(zt,"\\)$")),Vt=new RegExp("^hsl\\(".concat(zt,",").concat(Ft,",").concat(Ft,"\\)$")),Wt=new RegExp("^hsla\\(".concat(zt,",").concat(Ft,",").concat(Ft,",").concat(zt,"\\)$")),Ht={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Gt(){return this.rgb().formatHex()}function Xt(){return this.rgb().formatRgb()}function Yt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Pt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?qt(t):3===n?new Kt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Zt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Zt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Bt.exec(e))?new Kt(t[1],t[2],t[3],1):(t=Lt.exec(e))?new Kt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Nt.exec(e))?Zt(t[1],t[2],t[3],t[4]):(t=Ut.exec(e))?Zt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Vt.exec(e))?rn(t[1],t[2]/100,t[3]/100,1):(t=Wt.exec(e))?rn(t[1],t[2]/100,t[3]/100,t[4]):Ht.hasOwnProperty(e)?qt(Ht[e]):"transparent"===e?new Kt(NaN,NaN,NaN,0):null}function qt(e){return new Kt(e>>16&255,e>>8&255,255&e,1)}function Zt(e,t,n,r){return r<=0&&(e=t=n=NaN),new Kt(e,t,n,r)}function $t(e,t,n,r){return 1===arguments.length?function(e){return e instanceof It||(e=Yt(e)),e?new Kt((e=e.rgb()).r,e.g,e.b,e.opacity):new Kt}(e):new Kt(e,t,n,null==r?1:r)}function Kt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Jt(){return"#".concat(nn(this.r)).concat(nn(this.g)).concat(nn(this.b))}function Qt(){const e=en(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(tn(this.r),", ").concat(tn(this.g),", ").concat(tn(this.b)).concat(1===e?")":", ".concat(e,")"))}function en(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function nn(e){return((e=tn(e))<16?"0":"")+e.toString(16)}function rn(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new an(e,t,n,r)}function on(e){if(e instanceof an)return new an(e.h,e.s,e.l,e.opacity);if(e instanceof It||(e=Yt(e)),!e)return new an;if(e instanceof an)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,s=i-o,l=(i+o)/2;return s?(a=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new an(a,s,l,e.opacity)}function an(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function sn(e){return(e=(e||0)%360)<0?e+360:e}function ln(e){return Math.max(0,Math.min(1,e||0))}function cn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function dn(e,t,n,r,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*o)/6}Mt(It,Yt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gt,formatHex:Gt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return on(this).formatHsl()},formatRgb:Xt,toString:Xt}),Mt(Kt,$t,Tt(It,{brighter(e){return e=null==e?Ot:Math.pow(Ot,e),new Kt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?At:Math.pow(At,e),new Kt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kt(tn(this.r),tn(this.g),tn(this.b),en(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jt,formatHex:Jt,formatHex8:function(){return"#".concat(nn(this.r)).concat(nn(this.g)).concat(nn(this.b)).concat(nn(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Qt,toString:Qt})),Mt(an,function(e,t,n,r){return 1===arguments.length?on(e):new an(e,t,n,null==r?1:r)},Tt(It,{brighter(e){return e=null==e?Ot:Math.pow(Ot,e),new an(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?At:Math.pow(At,e),new an(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Kt(cn(e>=240?e-240:e+120,o,r),cn(e,o,r),cn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new an(sn(this.h),ln(this.s),ln(this.l),en(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=en(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(sn(this.h),", ").concat(100*ln(this.s),"%, ").concat(100*ln(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const un=e=>()=>e;function pn(e,t){return function(n){return e+n*t}}function hn(e){return 1===(e=+e)?fn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):un(isNaN(t)?n:t)}}function fn(e,t){var n=t-e;return n?pn(e,n):un(isNaN(e)?t:e)}const gn=function e(t){var n=hn(t);function r(e,t){var r=n((e=$t(e)).r,(t=$t(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),a=fn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=i(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function mn(e){return function(t){var n,r,o=t.length,i=new Array(o),a=new Array(o),s=new Array(o);for(n=0;n<o;++n)r=$t(t[n]),i[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return i=e(i),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=a(e),r.b=s(e),r+""}}}mn(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],i=e[r+1],a=r>0?e[r-1]:2*o-i,s=r<t-1?e[r+2]:2*i-o;return dn((n-r/t)*t,a,o,i,s)}}),mn(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],i=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return dn((n-r/t)*t,o,i,a,s)}});var vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yn=new RegExp(vn.source,"g");function xn(e,t){var n,r,o,i=vn.lastIndex=yn.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=vn.exec(e))&&(r=yn.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:yt(n,r)})),i=yn.lastIndex;return i<t.length&&(o=t.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function bn(e,t){var n;return("number"===typeof t?yt:t instanceof Yt?gn:(n=Yt(t))?(t=n,gn):xn)(e,t)}function wn(e){return function(){this.removeAttribute(e)}}function Sn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kn(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function Cn(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function jn(e,t,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,l));this.removeAttribute(e)}}function _n(e,t,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,l));this.removeAttributeNS(e.space,e.local)}}function En(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Dn(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Mn(e,t){return function(){ft(this,e).delay=+t.apply(this,arguments)}}function Tn(e,t){return t=+t,function(){ft(this,e).delay=t}}function In(e,t){return function(){gt(this,e).duration=+t.apply(this,arguments)}}function An(e,t){return t=+t,function(){gt(this,e).duration=t}}var On=Me.prototype.constructor;function Rn(e){return function(){this.style.removeProperty(e)}}var zn=0;function Fn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Pn(){return++zn}var Bn=Me.prototype;Fn.prototype=function(e){return Me().transition(e)}.prototype={constructor:Fn,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=y(e));for(var r=this._groups,o=r.length,i=new Array(o),a=0;a<o;++a)for(var s,l,c=r[a],d=c.length,u=i[a]=new Array(d),p=0;p<d;++p)(s=c[p])&&(l=e.call(s,s.__data__,p,c))&&("__data__"in s&&(l.__data__=s.__data__),u[p]=l,ht(u[p],t,n,p,u,mt(s,n)));return new Fn(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=b(e));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var l,c=r[s],d=c.length,u=0;u<d;++u)if(l=c[u]){for(var p,h=e.call(l,l.__data__,u,c),f=mt(l,n),g=0,m=h.length;g<m;++g)(p=h[g])&&ht(p,t,n,g,h,f);i.push(h),a.push(l)}return new Fn(i,a,t,n)},selectChild:Bn.selectChild,selectChildren:Bn.selectChildren,filter:function(e){"function"!==typeof e&&(e=S(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Fn(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var l,c=t[s],d=n[s],u=c.length,p=a[s]=new Array(u),h=0;h<u;++h)(l=c[h]||d[h])&&(p[h]=l);for(;s<r;++s)a[s]=t[s];return new Fn(a,this._parents,this._name,this._id)},selection:function(){return new On(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Pn(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var d=mt(a,t);ht(a,e,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Fn(r,this._parents,e,n)},call:Bn.call,nodes:Bn.nodes,node:Bn.node,size:Bn.size,empty:Bn.empty,each:Bn.each,on:function(e,t){var n=this._id;return arguments.length<2?mt(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?ft:gt;return function(){var a=i(this,e),s=a.on;s!==r&&(o=(r=s).copy()).on(t,n),a.on=o}}(n,e,t))},attr:function(e,t){var n=P(e),r="transform"===n?jt:bn;return this.attrTween(e,"function"===typeof t?(n.local?_n:jn)(n,r,Dt(this,"attr."+e,t)):null==t?(n.local?Sn:wn)(n):(n.local?Cn:kn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=P(e);return this.tween(n,(r.local?En:Dn)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?Ct:bn;return null==t?this.styleTween(e,function(e,t){var n,r,o;return function(){var i=q(this,e),a=(this.style.removeProperty(e),q(this,e));return i===a?null:i===n&&a===r?o:o=t(n=i,r=a)}}(e,r)).on("end.style."+e,Rn(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,o,i;return function(){var a=q(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=q(this,e)),a===l?null:a===r&&l===o?i:(o=l,i=t(r=a,s))}}(e,r,Dt(this,"style."+e,t))).each(function(e,t){var n,r,o,i,a="style."+t,s="end."+a;return function(){var l=gt(this,e),c=l.on,d=null==l.value[a]?i||(i=Rn(t)):void 0;c===n&&o===d||(r=(n=c).copy()).on(s,o=d),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,o,i=n+"";return function(){var a=q(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,o;function i(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,i,n)),r}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Dt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=mt(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((null==t?_t:Et)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Mn:Tn)(t,e)):mt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?In:An)(t,e)):mt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){gt(this,e).ease=t}}(t,e)):mt(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;gt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,a){var s={value:a},l={value:function(){0===--o&&i()}};n.each(function(){var n=gt(this,r),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}),0===o&&i()})},[Symbol.iterator]:Bn[Symbol.iterator]};var Ln={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Nn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Me.prototype.interrupt=function(e){return this.each(function(){vt(this,e)})},Me.prototype.transition=function(e){var t,n;e instanceof Fn?(t=e._id,e=e._name):(t=Pn(),(n=Ln).time=rt(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)(a=s[c])&&ht(a,e,t,c,s,n||Nn(a,t));return new Fn(r,this._parents,e,t)};const Un=e=>()=>e;function Vn(e,t){let{sourceEvent:n,target:r,transform:o,dispatch:i}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:i}})}function Wn(e,t,n){this.k=e,this.x=t,this.y=n}Wn.prototype={constructor:Wn,scale:function(e){return 1===e?this:new Wn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Wn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Hn=new Wn(1,0,0);function Gn(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Hn;return e.__zoom}function Xn(e){e.stopImmediatePropagation()}function Yn(e){e.preventDefault(),e.stopImmediatePropagation()}function qn(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function Zn(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function $n(){return this.__zoom||Hn}function Kn(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Jn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qn(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function er(){var e,t,n,r=qn,o=Zn,i=Qn,a=Kn,s=Jn,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,u=Xe,p=m("start","zoom","end"),h=0,f=10;function g(e){e.property("__zoom",$n).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",j).filter(s).on("touchstart.zoom",_).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Wn(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new Wn(e.k,r,o)}function x(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function b(e,t,n,r){e.on("start.zoom",function(){w(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(r).end()}).tween("zoom",function(){var e=this,i=arguments,a=w(e,i).event(r),s=o.apply(e,i),l=null==n?x(s):"function"===typeof n?n.apply(e,i):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,p="function"===typeof t?t.apply(e,i):t,h=u(d.invert(l).concat(c/d.k),p.invert(l).concat(c/p.k));return function(e){if(1===e)e=p;else{var t=h(e),n=c/t[2];e=new Wn(n,l[0]-t[0]*n,l[1]-t[1]*n)}a.zoom(null,e)}})}function w(e,t,n){return!n&&e.__zooming||new S(e,t)}function S(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=w(this,n).event(e),d=this.__zoom,u=Math.max(l[0],Math.min(l[1],d.k*Math.pow(2,a.apply(this,arguments)))),p=Ie(e);if(s.wheel)s.mouse[0][0]===p[0]&&s.mouse[0][1]===p[1]||(s.mouse[1]=d.invert(s.mouse[0]=p)),clearTimeout(s.wheel);else{if(d.k===u)return;s.mouse=[p,d.invert(p)],vt(this),s.start()}Yn(e),s.wheel=setTimeout(function(){s.wheel=null,s.end()},150),s.zoom("mouse",i(y(v(d,u),s.mouse[0],s.mouse[1]),s.extent,c))}}function C(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];if(!n&&r.apply(this,arguments)){var s=e.currentTarget,l=w(this,o,!0).event(e),d=Te(e.view).on("mousemove.zoom",function(e){if(Yn(e),!l.moved){var t=e.clientX-p,n=e.clientY-f;l.moved=t*t+n*n>h}l.event(e).zoom("mouse",i(y(l.that.__zoom,l.mouse[0]=Ie(e,s),l.mouse[1]),l.extent,c))},!0).on("mouseup.zoom",function(e){d.on("mousemove.zoom mouseup.zoom",null),Pe(e.view,l.moved),Yn(e),l.event(e).end()},!0),u=Ie(e,s),p=e.clientX,f=e.clientY;Fe(e.view),Xn(e),l.mouse=[u,this.__zoom.invert(u)],vt(this),l.start()}}function j(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var s=this.__zoom,l=Ie(e.changedTouches?e.changedTouches[0]:e,this),u=s.invert(l),p=s.k*(e.shiftKey?.5:2),h=i(y(v(s,p),l,u),o.apply(this,n),c);Yn(e),d>0?Te(this).transition().duration(d).call(b,h,l,e):Te(this).call(g.transform,h,l,e)}}function _(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];if(r.apply(this,arguments)){var s,l,c,d,u=n.touches,p=u.length,h=w(this,i,n.changedTouches.length===p).event(n);for(Xn(n),l=0;l<p;++l)d=[d=Ie(c=u[l],this),this.__zoom.invert(d),c.identifier],h.touch0?h.touch1||h.touch0[2]===d[2]||(h.touch1=d,h.taps=0):(h.touch0=d,s=!0,h.taps=1+!!e);e&&(e=clearTimeout(e)),s&&(h.taps<2&&(t=d[0],e=setTimeout(function(){e=null},500)),vt(this),h.start())}}function E(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,a,s,l,d=w(this,n).event(e),u=e.changedTouches,p=u.length;for(Yn(e),o=0;o<p;++o)s=Ie(a=u[o],this),d.touch0&&d.touch0[2]===a.identifier?d.touch0[0]=s:d.touch1&&d.touch1[2]===a.identifier&&(d.touch1[0]=s);if(a=d.that.__zoom,d.touch1){var h=d.touch0[0],f=d.touch0[1],g=d.touch1[0],m=d.touch1[1],x=(x=g[0]-h[0])*x+(x=g[1]-h[1])*x,b=(b=m[0]-f[0])*b+(b=m[1]-f[1])*b;a=v(a,Math.sqrt(x/b)),s=[(h[0]+g[0])/2,(h[1]+g[1])/2],l=[(f[0]+m[0])/2,(f[1]+m[1])/2]}else{if(!d.touch0)return;s=d.touch0[0],l=d.touch0[1]}d.zoom("touch",i(y(a,s,l),d.extent,c))}}function D(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];if(this.__zooming){var a,s,l=w(this,o).event(e),c=e.changedTouches,d=c.length;for(Xn(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),a=0;a<d;++a)s=c[a],l.touch0&&l.touch0[2]===s.identifier?delete l.touch0:l.touch1&&l.touch1[2]===s.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(s=Ie(s,this),Math.hypot(t[0]-s[0],t[1]-s[1])<f)){var u=Te(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return g.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",$n),e!==o?b(e,t,n,r):o.interrupt().each(function(){w(this,arguments).event(r).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()})},g.scaleBy=function(e,t,n,r){g.scaleTo(e,function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)},n,r)},g.scaleTo=function(e,t,n,r){g.transform(e,function(){var e=o.apply(this,arguments),r=this.__zoom,a=null==n?x(e):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"===typeof t?t.apply(this,arguments):t;return i(y(v(r,l),a,s),e,c)},n,r)},g.translateBy=function(e,t,n,r){g.transform(e,function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,r)},g.translateTo=function(e,t,n,r,a){g.transform(e,function(){var e=o.apply(this,arguments),a=this.__zoom,s=null==r?x(e):"function"===typeof r?r.apply(this,arguments):r;return i(Hn.translate(s[0],s[1]).scale(a.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)},r,a)},S.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Te(this.that).datum();p.call(e,this.that,new Vn(e,{sourceEvent:this.sourceEvent,target:g,type:e,transform:this.that.__zoom,dispatch:p}),t)}},g.wheelDelta=function(e){return arguments.length?(a="function"===typeof e?e:Un(+e),g):a},g.filter=function(e){return arguments.length?(r="function"===typeof e?e:Un(!!e),g):r},g.touchable=function(e){return arguments.length?(s="function"===typeof e?e:Un(!!e),g):s},g.extent=function(e){return arguments.length?(o="function"===typeof e?e:Un([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):o},g.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],g):[l[0],l[1]]},g.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(e){return arguments.length?(i=e,g):i},g.duration=function(e){return arguments.length?(d=+e,g):d},g.interpolate=function(e){return arguments.length?(u=e,g):u},g.on=function(){var e=p.on.apply(p,arguments);return e===p?g:e},g.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,g):Math.sqrt(h)},g.tapDistance=function(e){return arguments.length?(f=+e,g):f},g}function tr(e,t){var n,r=t?t.length:0,o=e?Math.min(r,e.length):0,i=new Array(o),a=new Array(r);for(n=0;n<o;++n)i[n]=ir(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<o;++n)a[n]=i[n](e);return a}}function nr(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function rr(e,t){var n,r={},o={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=ir(e[n],t[n]):o[n]=t[n];return function(e){for(n in r)o[n]=r[n](e);return o}}function or(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,o=t.slice();return function(i){for(n=0;n<r;++n)o[n]=e[n]*(1-i)+t[n]*i;return o}}function ir(e,t){var n,r=typeof t;return null==t||"boolean"===r?un(t):("number"===r?yt:"string"===r?(n=Yt(t))?(t=n,gn):xn:t instanceof Yt?gn:t instanceof Date?nr:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?or:Array.isArray(t)?tr:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?rr:yt)(e,t)}Gn.prototype=Wn.prototype;const ar=["inProgress"],sr=()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",lr=e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),cr=()=>"The React Flow parent container needs a width and a height to render the graph.",dr=()=>"Only child nodes can use a parent extent.",ur=()=>"Can't create edge. An edge needs a source and a target.",pr=e=>'Marker type "'.concat(e,"\" doesn't exist."),hr=(e,t)=>{let{id:n,sourceHandle:r,targetHandle:o}=t;return"Couldn't create edge for ".concat(e,' handle id: "').concat("source"===e?r:o,'", edge id: ').concat(n,".")},fr=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",gr=e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),mr=e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),vr=()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",yr=()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.",xr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],br=["Enter"," ","Escape"],wr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":e=>{let{direction:t,x:n,y:r}=e;return"Moved selected node ".concat(t,". New position, x: ").concat(n,", y: ").concat(r)},"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Sr,kr,Cr;!function(e){e.Strict="strict",e.Loose="loose"}(Sr||(Sr={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(kr||(kr={})),function(e){e.Partial="partial",e.Full="full"}(Cr||(Cr={}));const jr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var _r,Er,Dr;!function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(_r||(_r={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(Er||(Er={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(Dr||(Dr={}));const Mr={[Dr.Left]:Dr.Right,[Dr.Right]:Dr.Left,[Dr.Top]:Dr.Bottom,[Dr.Bottom]:Dr.Top};function Tr(e){return null===e?null:e?"valid":"invalid"}const Ir=e=>"id"in e&&"source"in e&&"target"in e,Ar=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Or=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{width:r,height:o}=so(e),i=null!==(t=e.origin)&&void 0!==t?t:n,a=r*i[0],s=o*i[1];return{x:e.position.x-a,y:e.position.y-s}},Rr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===e.size)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(e=>{if(void 0===t.filter||t.filter(e)){const t=qr(e);n=Hr(n,t)}}),Xr(n)},zr=function(e,t){let[n,r,o]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const l=s(s({},to(t,[n,r,o])),{},{width:t.width/o,height:t.height/o}),c=[];for(const s of e.values()){var d,u,p,h,f,g;const{measured:e,selectable:t=!0,hidden:n=!1}=s;if(a&&!t||n)continue;const r=null!==(d=null!==(u=null!==(p=e.width)&&void 0!==p?p:s.width)&&void 0!==u?u:s.initialWidth)&&void 0!==d?d:null,o=null!==(h=null!==(f=null!==(g=e.height)&&void 0!==g?g:s.height)&&void 0!==f?f:s.initialHeight)&&void 0!==h?h:null,m=$r(l,Yr(s)),v=(null!==r&&void 0!==r?r:0)*(null!==o&&void 0!==o?o:0),y=i&&m>0;(!s.internals.handleBounds||y||m>=v||s.dragging)&&c.push(s)}return c};async function Fr(e,t){var n,r,o;let{nodes:i,width:a,height:s,panZoom:l,minZoom:c,maxZoom:d}=e;if(0===i.size)return Promise.resolve(!0);const u=function(e,t){const n=new Map,r=null!==t&&void 0!==t&&t.nodes?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{!e.measured.width||!e.measured.height||!(null===t||void 0===t?void 0:t.includeHiddenNodes)&&e.hidden||r&&!r.has(e.id)||n.set(e.id,e)}),n}(i,t),p=Rr(u),h=oo(p,a,s,null!==(n=null===t||void 0===t?void 0:t.minZoom)&&void 0!==n?n:c,null!==(r=null===t||void 0===t?void 0:t.maxZoom)&&void 0!==r?r:d,null!==(o=null===t||void 0===t?void 0:t.padding)&&void 0!==o?o:.1);return await l.setViewport(h,{duration:null===t||void 0===t?void 0:t.duration,ease:null===t||void 0===t?void 0:t.ease,interpolate:null===t||void 0===t?void 0:t.interpolate}),Promise.resolve(!0)}function Pr(e){var t,n,r;let{nodeId:o,nextPosition:i,nodeLookup:a,nodeOrigin:s=[0,0],nodeExtent:l,onError:c}=e;const d=a.get(o),u=d.parentId?a.get(d.parentId):void 0,{x:p,y:h}=u?u.internals.positionAbsolute:{x:0,y:0},f=null!==(t=d.origin)&&void 0!==t?t:s;let g=l;if("parent"!==d.extent||d.expandParent)u&&ao(d.extent)&&(g=[[d.extent[0][0]+p,d.extent[0][1]+h],[d.extent[1][0]+p,d.extent[1][1]+h]]);else if(u){const e=u.measured.width,t=u.measured.height;e&&t&&(g=[[p,h],[p+e,h+t]])}else null===c||void 0===c||c("005",dr());const m=ao(g)?Nr(i,g,d.measured):i;return void 0!==d.measured.width&&void 0!==d.measured.height||null===c||void 0===c||c("015",yr()),{position:{x:m.x-p+(null!==(n=d.measured.width)&&void 0!==n?n:0)*f[0],y:m.y-h+(null!==(r=d.measured.height)&&void 0!==r?r:0)*f[1]},positionAbsolute:m}}async function Br(e){let{nodesToRemove:t=[],edgesToRemove:n=[],nodes:r,edges:o,onBeforeDelete:i}=e;const a=new Set(t.map(e=>e.id)),s=[];for(const h of r){if(!1===h.deletable)continue;const e=a.has(h.id),t=!e&&h.parentId&&s.find(e=>e.id===h.parentId);(e||t)&&s.push(h)}const l=new Set(n.map(e=>e.id)),c=o.filter(e=>!1!==e.deletable),d=((e,t)=>{const n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))})(s,c),u=d;for(const h of c){l.has(h.id)&&!u.find(e=>e.id===h.id)&&u.push(h)}if(!i)return{edges:u,nodes:s};const p=await i({nodes:s,edges:u});return"boolean"===typeof p?p?{edges:u,nodes:s}:{edges:[],nodes:[]}:p}const Lr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},Nr=function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return{x:Lr(n.x,r[0][0],r[1][0]-(null!==(e=null===o||void 0===o?void 0:o.width)&&void 0!==e?e:0)),y:Lr(n.y,r[0][1],r[1][1]-(null!==(t=null===o||void 0===o?void 0:o.height)&&void 0!==t?t:0))}};function Ur(e,t,n){const{width:r,height:o}=so(n),{x:i,y:a}=n.internals.positionAbsolute;return Nr(e,[[i,a],[i+r,a+o]],t)}const Vr=(e,t,n)=>e<t?Lr(Math.abs(e-t),1,t)/t:e>n?-Lr(Math.abs(e-n),1,t)/t:0,Wr=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return[Vr(e.x,r,t.width-r)*n,Vr(e.y,r,t.height-r)*n]},Hr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Gr=e=>{let{x:t,y:n,width:r,height:o}=e;return{x:t,y:n,x2:t+r,y2:n+o}},Xr=e=>{let{x:t,y:n,x2:r,y2:o}=e;return{x:t,y:n,width:r-t,height:o-n}},Yr=function(e){var t,n,r,o,i,a,s,l;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{x:d,y:u}=Ar(e)?e.internals.positionAbsolute:Or(e,c);return{x:d,y:u,width:null!==(t=null!==(n=null!==(r=null===(o=e.measured)||void 0===o?void 0:o.width)&&void 0!==r?r:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0,height:null!==(i=null!==(a=null!==(s=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==s?s:e.height)&&void 0!==a?a:e.initialHeight)&&void 0!==i?i:0}},qr=function(e){var t,n,r,o,i,a,s,l;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{x:d,y:u}=Ar(e)?e.internals.positionAbsolute:Or(e,c);return{x:d,y:u,x2:d+(null!==(t=null!==(n=null!==(r=null===(o=e.measured)||void 0===o?void 0:o.width)&&void 0!==r?r:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0),y2:u+(null!==(i=null!==(a=null!==(s=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==s?s:e.height)&&void 0!==a?a:e.initialHeight)&&void 0!==i?i:0)}},Zr=(e,t)=>Xr(Hr(Gr(e),Gr(t))),$r=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Kr=e=>Jr(e.width)&&Jr(e.height)&&Jr(e.x)&&Jr(e.y),Jr=e=>!isNaN(e)&&isFinite(e),Qr=(e,t)=>{0},eo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}},to=function(e,t){let{x:n,y:r}=e,[o,i,a]=t;const s={x:(n-o)/a,y:(r-i)/a};return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?eo(s,arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1]):s},no=(e,t)=>{let{x:n,y:r}=e,[o,i,a]=t;return{x:n*a+o,y:r*a+i}};function ro(e,t){if("number"===typeof e)return Math.floor(.5*(t-t/(1+e)));if("string"===typeof e&&e.endsWith("px")){const t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"===typeof e&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error('[React Flow] The padding value "'.concat(e,'" is invalid. Please provide a number or a string with a valid unit (px or %).')),0}const oo=(e,t,n,r,o,i)=>{const a=function(e,t,n){if("string"===typeof e||"number"===typeof e){const r=ro(e,n),o=ro(e,t);return{top:r,right:o,bottom:r,left:o,x:2*o,y:2*r}}if("object"===typeof e){var r,o,i,a,s,l,c,d;const u=ro(null!==(r=null!==(o=e.top)&&void 0!==o?o:e.y)&&void 0!==r?r:0,n),p=ro(null!==(i=null!==(a=e.bottom)&&void 0!==a?a:e.y)&&void 0!==i?i:0,n),h=ro(null!==(s=null!==(l=e.left)&&void 0!==l?l:e.x)&&void 0!==s?s:0,t),f=ro(null!==(c=null!==(d=e.right)&&void 0!==d?d:e.x)&&void 0!==c?c:0,t);return{top:u,right:f,bottom:p,left:h,x:h+f,y:u+p}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(i,t,n),s=(t-a.x)/e.width,l=(n-a.y)/e.height,c=Math.min(s,l),d=Lr(c,r,o),u=t/2-(e.x+e.width/2)*d,p=n/2-(e.y+e.height/2)*d,h=function(e,t,n,r,o,i){const{x:a,y:s}=no(e,[t,n,r]),{x:l,y:c}=no({x:e.x+e.width,y:e.y+e.height},[t,n,r]),d=o-l,u=i-c;return{left:Math.floor(a),top:Math.floor(s),right:Math.floor(d),bottom:Math.floor(u)}}(e,u,p,d,t,n),f=Math.min(h.left-a.left,0),g=Math.min(h.top-a.top,0);return{x:u-f+Math.min(h.right-a.right,0),y:p-g+Math.min(h.bottom-a.bottom,0),zoom:d}},io=()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator)||void 0===e||null===(e=e.userAgent)||void 0===e?void 0:e.indexOf("Mac"))>=0};function ao(e){return void 0!==e&&"parent"!==e}function so(e){var t,n,r,o,i,a,s,l;return{width:null!==(t=null!==(n=null!==(r=null===(o=e.measured)||void 0===o?void 0:o.width)&&void 0!==r?r:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0,height:null!==(i=null!==(a=null!==(s=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==s?s:e.height)&&void 0!==a?a:e.initialHeight)&&void 0!==i?i:0}}function lo(e){var t,n,r,o,i,a;return void 0!==(null!==(t=null!==(n=null===(r=e.measured)||void 0===r?void 0:r.width)&&void 0!==n?n:e.width)&&void 0!==t?t:e.initialWidth)&&void 0!==(null!==(o=null!==(i=null===(a=e.measured)||void 0===a?void 0:a.height)&&void 0!==i?i:e.height)&&void 0!==o?o:e.initialHeight)}function co(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const i=s({},e),a=r.get(n);if(a){var l,c;const e=a.origin||o;i.x+=a.internals.positionAbsolute.x-(null!==(l=t.width)&&void 0!==l?l:0)*e[0],i.y+=a.internals.positionAbsolute.y-(null!==(c=t.height)&&void 0!==c?c:0)*e[1]}return i}function uo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function po(e){return s(s({},wr),e||{})}function ho(e,t){var n,r;let{snapGrid:o=[0,0],snapToGrid:i=!1,transform:a,containerBounds:l}=t;const{x:c,y:d}=xo(e),u=to({x:c-(null!==(n=null===l||void 0===l?void 0:l.left)&&void 0!==n?n:0),y:d-(null!==(r=null===l||void 0===l?void 0:l.top)&&void 0!==r?r:0)},a),{x:p,y:h}=i?eo(u,o):u;return s({xSnapped:p,ySnapped:h},u)}const fo=e=>({width:e.offsetWidth,height:e.offsetHeight}),go=e=>{var t,n;return(null===e||void 0===e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||(null===(n=window)||void 0===n?void 0:n.document)},mo=["INPUT","SELECT","TEXTAREA"];function vo(e){var t;const n=(null===(t=e.composedPath)||void 0===t||null===(t=t.call(e))||void 0===t?void 0:t[0])||e.target;if(1!==(null===n||void 0===n?void 0:n.nodeType))return!1;return mo.includes(n.nodeName)||n.hasAttribute("contenteditable")||!!n.closest(".nokey")}const yo=e=>"clientX"in e,xo=(e,t)=>{var n,r,o,i;const a=yo(e),s=a?e.clientX:null===(n=e.touches)||void 0===n?void 0:n[0].clientX,l=a?e.clientY:null===(r=e.touches)||void 0===r?void 0:r[0].clientY;return{x:s-(null!==(o=null===t||void 0===t?void 0:t.left)&&void 0!==o?o:0),y:l-(null!==(i=null===t||void 0===t?void 0:t.top)&&void 0!==i?i:0)}},bo=(e,t,n,r,o)=>{const i=t.querySelectorAll(".".concat(e));return i&&i.length?Array.from(i).map(t=>{const i=t.getBoundingClientRect();return s({id:t.getAttribute("data-handleid"),type:e,nodeId:o,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/r,y:(i.top-n.top)/r},fo(t))}):null};function wo(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:s,targetControlY:l}=e;const c=.125*t+.375*i+.375*s+.125*r,d=.125*n+.375*a+.375*l+.125*o;return[c,d,Math.abs(c-t),Math.abs(d-n)]}function So(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function ko(e){let{pos:t,x1:n,y1:r,x2:o,y2:i,c:a}=e;switch(t){case Dr.Left:return[n-So(n-o,a),r];case Dr.Right:return[n+So(o-n,a),r];case Dr.Top:return[n,r-So(r-i,a)];case Dr.Bottom:return[n,r+So(i-r,a)]}}function Co(e){let{sourceX:t,sourceY:n,sourcePosition:r=Dr.Bottom,targetX:o,targetY:i,targetPosition:a=Dr.Top,curvature:s=.25}=e;const[l,c]=ko({pos:r,x1:t,y1:n,x2:o,y2:i,c:s}),[d,u]=ko({pos:a,x1:o,y1:i,x2:t,y2:n,c:s}),[p,h,f,g]=wo({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return["M".concat(t,",").concat(n," C").concat(l,",").concat(c," ").concat(d,",").concat(u," ").concat(o,",").concat(i),p,h,f,g]}function jo(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o}=e;const i=Math.abs(r-t)/2,a=r<t?r+i:r-i,s=Math.abs(o-n)/2;return[a,o<n?o+s:o-s,i,s]}function _o(e){let{sourceNode:t,targetNode:n,width:r,height:o,transform:i}=e;const a=Hr(qr(t),qr(n));a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1);const s={x:-i[0]/i[2],y:-i[1]/i[2],width:r/i[2],height:o/i[2]};return $r(s,Xr(a))>0}const Eo=e=>{let{source:t,sourceHandle:n,target:r,targetHandle:o}=e;return"xy-edge__".concat(t).concat(n||"","-").concat(r).concat(o||"")};function Do(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o}=e;const[i,a,s,l]=jo({sourceX:t,sourceY:n,targetX:r,targetY:o});return["M ".concat(t,",").concat(n,"L ").concat(r,",").concat(o),i,a,s,l]}const Mo={[Dr.Left]:{x:-1,y:0},[Dr.Right]:{x:1,y:0},[Dr.Top]:{x:0,y:-1},[Dr.Bottom]:{x:0,y:1}},To=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Io(e){let{source:t,sourcePosition:n=Dr.Bottom,target:r,targetPosition:o=Dr.Top,center:i,offset:a}=e;const s=Mo[n],l=Mo[o],c={x:t.x+s.x*a,y:t.y+s.y*a},d={x:r.x+l.x*a,y:r.y+l.y*a},u=(e=>{let{source:t,sourcePosition:n=Dr.Bottom,target:r}=e;return n===Dr.Left||n===Dr.Right?t.x<r.x?{x:1,y:0}:{x:-1,y:0}:t.y<r.y?{x:0,y:1}:{x:0,y:-1}})({source:c,sourcePosition:n,target:d}),p=0!==u.x?"x":"y",h=u[p];let f,g,m=[];const v={x:0,y:0},y={x:0,y:0},[x,b,w,S]=jo({sourceX:t.x,sourceY:t.y,targetX:r.x,targetY:r.y});if(s[p]*l[p]===-1){var k,C;f=null!==(k=i.x)&&void 0!==k?k:x,g=null!==(C=i.y)&&void 0!==C?C:b;const e=[{x:f,y:c.y},{x:f,y:d.y}],t=[{x:c.x,y:g},{x:d.x,y:g}];m=s[p]===h?"x"===p?e:t:"x"===p?t:e}else{const e=[{x:c.x,y:d.y}],i=[{x:d.x,y:c.y}];if(m="x"===p?s.x===h?i:e:s.y===h?e:i,n===o){const e=Math.abs(t[p]-r[p]);if(e<=a){const n=Math.min(a-1,a-e);s[p]===h?v[p]=(c[p]>t[p]?-1:1)*n:y[p]=(d[p]>r[p]?-1:1)*n}}if(n!==o){const t="x"===p?"y":"x",n=s[p]===l[t],r=c[t]>d[t],o=c[t]<d[t];(1===s[p]&&(!n&&r||n&&o)||1!==s[p]&&(!n&&o||n&&r))&&(m="x"===p?e:i)}const u={x:c.x+v.x,y:c.y+v.y},x={x:d.x+y.x,y:d.y+y.y};Math.max(Math.abs(u.x-m[0].x),Math.abs(x.x-m[0].x))>=Math.max(Math.abs(u.y-m[0].y),Math.abs(x.y-m[0].y))?(f=(u.x+x.x)/2,g=m[0].y):(f=m[0].x,g=(u.y+x.y)/2)}return[[t,{x:c.x+v.x,y:c.y+v.y},...m,{x:d.x+y.x,y:d.y+y.y},r],f,g,w,S]}function Ao(e){let{sourceX:t,sourceY:n,sourcePosition:r=Dr.Bottom,targetX:o,targetY:i,targetPosition:a=Dr.Top,borderRadius:s=5,centerX:l,centerY:c,offset:d=20}=e;const[u,p,h,f,g]=Io({source:{x:t,y:n},sourcePosition:r,target:{x:o,y:i},targetPosition:a,center:{x:l,y:c},offset:d}),m=u.reduce((e,t,n)=>{let r="";return r=n>0&&n<u.length-1?function(e,t,n,r){const o=Math.min(To(e,t)/2,To(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return"L".concat(i," ").concat(a);if(e.y===a){const t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return"L ".concat(i+o*t,",").concat(a,"Q ").concat(i,",").concat(a," ").concat(i,",").concat(a+o*r)}const s=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return"L ".concat(i,",").concat(a+o*l,"Q ").concat(i,",").concat(a," ").concat(i+o*s,",").concat(a)}(u[n-1],t,u[n+1],s):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y),e+=r},"");return[m,p,h,f,g]}function Oo(e){var t;return e&&!!(e.internals.handleBounds||null!==(t=e.handles)&&void 0!==t&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Ro(e){if(!e)return null;const t=[],n=[];for(const i of e){var r,o;i.width=null!==(r=i.width)&&void 0!==r?r:1,i.height=null!==(o=i.height)&&void 0!==o?o:1,"source"===i.type?t.push(i):"target"===i.type&&n.push(i)}return{source:t,target:n}}function zo(e,t){var n,r,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dr.Left,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=(null!==(n=null===t||void 0===t?void 0:t.x)&&void 0!==n?n:0)+e.internals.positionAbsolute.x,l=(null!==(r=null===t||void 0===t?void 0:t.y)&&void 0!==r?r:0)+e.internals.positionAbsolute.y,{width:c,height:d}=null!==t&&void 0!==t?t:so(e);if(a)return{x:s+c/2,y:l+d/2};switch(null!==(o=null===t||void 0===t?void 0:t.position)&&void 0!==o?o:i){case Dr.Top:return{x:s+c/2,y:l};case Dr.Right:return{x:s+c,y:l+d/2};case Dr.Bottom:return{x:s+c/2,y:l+d};case Dr.Left:return{x:s,y:l+d/2}}}function Fo(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function Po(e,t){if(!e)return"";if("string"===typeof e)return e;const n=t?"".concat(t,"__"):"";return"".concat(n).concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&"))}const Bo={nodeOrigin:[0,0],nodeExtent:xr,elevateNodesOnSelect:!0,defaults:{}},Lo=s(s({},Bo),{},{checkEquality:!0});function No(e,t){const n=s({},e);for(const r in t)void 0!==t[r]&&(n[r]=t[r]);return n}function Uo(e,t,n,r){const o=No(Lo,r);let i=e.length>0;const a=new Map(t),l=null!==o&&void 0!==o&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const h of e){var c;let e=a.get(h.id);if(o.checkEquality&&h===(null===(c=e)||void 0===c?void 0:c.internals.userNode))t.set(h.id,e);else{var d,u,p;const n=Or(h,o.nodeOrigin),r=ao(h.extent)?h.extent:o.nodeExtent,i=Nr(n,r,so(h));e=s(s(s({},o.defaults),h),{},{measured:{width:null===(d=h.measured)||void 0===d?void 0:d.width,height:null===(u=h.measured)||void 0===u?void 0:u.height},internals:{positionAbsolute:i,handleBounds:h.measured?null===(p=e)||void 0===p?void 0:p.internals.handleBounds:void 0,z:Wo(h,l),userNode:h}}),t.set(h.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(i=!1),h.parentId&&Vo(e,t,n,r)}return i}function Vo(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:a}=No(Bo,r),l=e.parentId,c=t.get(l);if(!c)return void console.warn("Parent node ".concat(l," not found. Please make sure that parent nodes are in front of their child nodes in the nodes array."));!function(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n);const d=o?1e3:0,{x:u,y:p,z:h}=function(e,t,n,r,o){var i;const{x:a,y:s}=t.internals.positionAbsolute,l=so(e),c=Or(e,n),d=ao(e.extent)?Nr(c,e.extent,l):c;let u=Nr({x:a+d.x,y:s+d.y},r,l);"parent"===e.extent&&(u=Ur(u,l,t));const p=Wo(e,o),h=null!==(i=t.internals.z)&&void 0!==i?i:0;return{x:u.x,y:u.y,z:h>=p?h+1:p}}(e,c,i,a,d),{positionAbsolute:f}=e.internals,g=u!==f.x||p!==f.y;(g||h!==e.internals.z)&&t.set(e.id,s(s({},e),{},{internals:s(s({},e.internals),{},{positionAbsolute:g?{x:u,y:p}:f,z:h})}))}function Wo(e,t){return(Jr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Ho(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0];const o=[],i=new Map;for(const l of e){var a,s;const e=t.get(l.parentId);if(!e)continue;const n=null!==(a=null===(s=i.get(l.parentId))||void 0===s?void 0:s.expandedRect)&&void 0!==a?a:Yr(e),r=Zr(n,l.rect);i.set(l.parentId,{expandedRect:r,parent:e})}return i.size>0&&i.forEach((t,i)=>{var a;let{expandedRect:s,parent:l}=t;const c=l.internals.positionAbsolute,d=so(l),u=null!==(a=l.origin)&&void 0!==a?a:r,p=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,h=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,f=Math.max(d.width,Math.round(s.width)),g=Math.max(d.height,Math.round(s.height)),m=(f-d.width)*u[0],v=(g-d.height)*u[1];var y;(p>0||h>0||m||v)&&(o.push({id:i,type:"position",position:{x:l.position.x-p+m,y:l.position.y-h+v}}),null===(y=n.get(i))||void 0===y||y.forEach(t=>{e.some(e=>e.id===t.id)||o.push({id:t.id,type:"position",position:{x:t.position.x+p,y:t.position.y+h}})}));(d.width<s.width||d.height<s.height||p||h)&&o.push({id:i,type:"dimensions",setAttributes:!0,dimensions:{width:f+(p?u[0]*p-m:0),height:g+(h?u[1]*h-v:0)}})}),o}function Go(e,t,n,r,o,i){let a=o;const s=r.get(a)||new Map;r.set(a,s.set(n,t)),a="".concat(o,"-").concat(e);const l=r.get(a)||new Map;if(r.set(a,l.set(n,t)),i){a="".concat(o,"-").concat(e,"-").concat(i);const s=r.get(a)||new Map;r.set(a,s.set(n,t))}}function Xo(e,t,n){e.clear(),t.clear();for(const r of n){const{source:n,target:o,sourceHandle:i=null,targetHandle:a=null}=r,s={edgeId:r.id,source:n,target:o,sourceHandle:i,targetHandle:a},l="".concat(n,"-").concat(i,"--").concat(o,"-").concat(a);Go("source",s,"".concat(o,"-").concat(a,"--").concat(n,"-").concat(i),e,n,i),Go("target",s,l,e,o,a),t.set(r.id,r)}}function Yo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return!!n&&(!!n.selected||Yo(n,t))}function qo(e,t,n){let r=e;do{var o,i,a;if(null!==(o=r)&&void 0!==o&&null!==(i=o.matches)&&void 0!==i&&i.call(o,t))return!0;if(r===n)return!1;r=null===(a=r)||void 0===a?void 0:a.parentElement}while(r);return!1}function Zo(e){var t,n;let{nodeId:r,dragItems:o,nodeLookup:i,dragging:a=!0}=e;const l=[];for(const[u,p]of o){var c;const e=null===(c=i.get(u))||void 0===c?void 0:c.internals.userNode;e&&l.push(s(s({},e),{},{position:p.position,dragging:a}))}if(!r)return[l[0],l];const d=null===(t=i.get(r))||void 0===t?void 0:t.internals.userNode;return[d?s(s({},d),{},{position:(null===(n=o.get(r))||void 0===n?void 0:n.position)||d.position,dragging:a}):l[0],l]}function $o(e){let{onNodeMouseDown:t,getStoreItems:n,onDragStart:r,onDrag:o,onDragStop:i}=e,a={x:null,y:null},s=0,l=new Map,c=!1,d={x:0,y:0},u=null,p=!1,h=null,f=!1,g=!1;return{update:function(e){let{noDragClassName:m,handleSelector:v,domNode:y,isSelectable:x,nodeId:b,nodeClickDistance:w=0}=e;function S(e,t){let{x:r,y:i}=e;const{nodeLookup:s,nodeExtent:c,snapGrid:d,snapToGrid:u,nodeOrigin:p,onNodeDrag:h,onSelectionDrag:f,onError:m,updateNodePositions:v}=n();a={x:r,y:i};let y=!1,x={x:0,y:0,x2:0,y2:0};if(l.size>1&&c){const e=Rr(l);x=Gr(e)}for(const[n,o]of l){if(!s.has(n))continue;let e={x:r-o.distance.x,y:i-o.distance.y};u&&(e=eo(e,d));let t=[[c[0][0],c[0][1]],[c[1][0],c[1][1]]];if(l.size>1&&c&&!o.extent){const{positionAbsolute:e}=o.internals,n=e.x-x.x+c[0][0],r=e.x+o.measured.width-x.x2+c[1][0];t=[[n,e.y-x.y+c[0][1]],[r,e.y+o.measured.height-x.y2+c[1][1]]]}const{position:a,positionAbsolute:h}=Pr({nodeId:n,nextPosition:e,nodeLookup:s,nodeExtent:t,nodeOrigin:p,onError:m});y=y||o.position.x!==a.x||o.position.y!==a.y,o.position=a,o.internals.positionAbsolute=h}if(g=g||y,y&&(v(l,!0),t&&(o||h||!b&&f))){const[e,n]=Zo({nodeId:b,dragItems:l,nodeLookup:s});null===o||void 0===o||o(t,l,e,n),null===h||void 0===h||h(t,e,n),b||null===f||void 0===f||f(t,n)}}async function k(){if(!u)return;const{transform:e,panBy:t,autoPanSpeed:r,autoPanOnNodeDrag:o}=n();if(!o)return c=!1,void cancelAnimationFrame(s);const[i,l]=Wr(d,u,r);var p,h;0===i&&0===l||(a.x=(null!==(p=a.x)&&void 0!==p?p:0)-i/e[2],a.y=(null!==(h=a.y)&&void 0!==h?h:0)-l/e[2],await t({x:i,y:l})&&S(a,null));s=requestAnimationFrame(k)}function C(e){const{nodeLookup:o,multiSelectionActive:i,nodesDraggable:s,transform:c,snapGrid:d,snapToGrid:h,selectNodesOnDrag:f,onNodeDragStart:g,onSelectionDragStart:m,unselectNodesAndEdges:v}=n();var y;(p=!0,f&&x||i||!b)||(null!==(y=o.get(b))&&void 0!==y&&y.selected||v());x&&f&&b&&(null===t||void 0===t||t(b));const w=ho(e.sourceEvent,{transform:c,snapGrid:d,snapToGrid:h,containerBounds:u});if(a=w,l=function(e,t,n,r){const o=new Map;for(const[s,l]of e)if((l.selected||l.id===r)&&(!l.parentId||!Yo(l,e))&&(l.draggable||t&&"undefined"===typeof l.draggable)){const t=e.get(s);var i,a;t&&o.set(s,{id:s,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:null!==(i=t.measured.width)&&void 0!==i?i:0,height:null!==(a=t.measured.height)&&void 0!==a?a:0}})}return o}(o,s,w,b),l.size>0&&(r||g||!b&&m)){const[t,n]=Zo({nodeId:b,dragItems:l,nodeLookup:o});null===r||void 0===r||r(e.sourceEvent,l,t,n),null===g||void 0===g||g(e.sourceEvent,t,n),b||null===m||void 0===m||m(e.sourceEvent,n)}}h=Te(y);const j=He().clickDistance(w).on("start",e=>{const{domNode:t,nodeDragThreshold:r,transform:o,snapGrid:i,snapToGrid:s}=n();u=(null===t||void 0===t?void 0:t.getBoundingClientRect())||null,f=!1,g=!1,0===r&&C(e);const l=ho(e.sourceEvent,{transform:o,snapGrid:i,snapToGrid:s,containerBounds:u});a=l,d=xo(e.sourceEvent,u)}).on("drag",e=>{const{autoPanOnNodeDrag:t,transform:r,snapGrid:o,snapToGrid:i,nodeDragThreshold:s,nodeLookup:h}=n(),g=ho(e.sourceEvent,{transform:r,snapGrid:o,snapToGrid:i,containerBounds:u});if(("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||b&&!h.has(b))&&(f=!0),!f){if(!c&&t&&p&&(c=!0,k()),!p){var m,v;const t=g.xSnapped-(null!==(m=a.x)&&void 0!==m?m:0),n=g.ySnapped-(null!==(v=a.y)&&void 0!==v?v:0);Math.sqrt(t*t+n*n)>s&&C(e)}(a.x!==g.xSnapped||a.y!==g.ySnapped)&&l&&p&&(d=xo(e.sourceEvent,u),S(g,e.sourceEvent))}}).on("end",e=>{if(p&&!f&&(c=!1,p=!1,cancelAnimationFrame(s),l.size>0)){const{nodeLookup:t,updateNodePositions:r,onNodeDragStop:o,onSelectionDragStop:a}=n();if(g&&(r(l,!1),g=!1),i||o||!b&&a){const[n,r]=Zo({nodeId:b,dragItems:l,nodeLookup:t,dragging:!1});null===i||void 0===i||i(e.sourceEvent,l,n,r),null===o||void 0===o||o(e.sourceEvent,n,r),b||null===a||void 0===a||a(e.sourceEvent,r)}}}).filter(e=>{const t=e.target;return!e.button&&(!m||!qo(t,".".concat(m),y))&&(!v||qo(t,v,y))});h.call(j)},destroy:function(){var e;null===(e=h)||void 0===e||e.on(".drag",null)}}}function Ko(e,t,n,r){let o=[],i=1/0;const a=function(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(const i of t.values())$r(o,Yr(i))>0&&r.push(i);return r}(e,n,t+250);for(const h of a){var l,c,d,u;const n=[...null!==(l=null===(c=h.internals.handleBounds)||void 0===c?void 0:c.source)&&void 0!==l?l:[],...null!==(d=null===(u=h.internals.handleBounds)||void 0===u?void 0:u.target)&&void 0!==d?d:[]];for(const a of n){if(r.nodeId===a.nodeId&&r.type===a.type&&r.id===a.id)continue;const{x:n,y:l}=zo(h,a,a.position,!0),c=Math.sqrt(Math.pow(n-e.x,2)+Math.pow(l-e.y,2));c>t||(c<i?(o=[s(s({},a),{},{x:n,y:l})],i=c):c===i&&o.push(s(s({},a),{},{x:n,y:l})))}}if(!o.length)return null;if(o.length>1){var p;const e="source"===r.type?"target":"source";return null!==(p=o.find(t=>t.type===e))&&void 0!==p?p:o[0]}return o[0]}function Jo(e,t,n,r,o){var i,a,l,c,d,u;let p=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const h=r.get(e);if(!h)return null;const f="strict"===o?null===(i=h.internals.handleBounds)||void 0===i?void 0:i[t]:[...null!==(a=null===(l=h.internals.handleBounds)||void 0===l?void 0:l.source)&&void 0!==a?a:[],...null!==(c=null===(d=h.internals.handleBounds)||void 0===d?void 0:d.target)&&void 0!==c?c:[]],g=null!==(u=n?null===f||void 0===f?void 0:f.find(e=>e.id===n):null===f||void 0===f?void 0:f[0])&&void 0!==u?u:null;return g&&p?s(s({},g),zo(h,g,g.position,!0)):g}function Qo(e,t){return e||(null!==t&&void 0!==t&&t.classList.contains("target")?"target":null!==t&&void 0!==t&&t.classList.contains("source")?"source":null)}const ei=()=>!0;function ti(e,t){let{handle:n,connectionMode:r,fromNodeId:o,fromHandleId:i,fromType:a,doc:s,lib:l,flowId:c,isValidConnection:d=ei,nodeLookup:u}=t;const p="target"===a,h=n?s.querySelector(".".concat(l,'-flow__handle[data-id="').concat(c,"-").concat(null===n||void 0===n?void 0:n.nodeId,"-").concat(null===n||void 0===n?void 0:n.id,"-").concat(null===n||void 0===n?void 0:n.type,'"]')):null,{x:f,y:g}=xo(e),m=s.elementFromPoint(f,g),v=null!==m&&void 0!==m&&m.classList.contains("".concat(l,"-flow__handle"))?m:h,y={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const e=Qo(void 0,v),t=v.getAttribute("data-nodeid"),n=v.getAttribute("data-handleid"),a=v.classList.contains("connectable"),s=v.classList.contains("connectableend");if(!t||!e)return y;const l={source:p?t:o,sourceHandle:p?n:i,target:p?o:t,targetHandle:p?i:n};y.connection=l;const c=a&&s&&(r===Sr.Strict?p&&"source"===e||!p&&"target"===e:t!==o||n!==i);y.isValid=c&&d(l),y.toHandle=Jo(t,e,n,u,r,!0)}return y}const ni={onPointerDown:function(e,t){let{connectionMode:n,connectionRadius:r,handleId:o,nodeId:i,edgeUpdaterType:a,isTarget:c,domNode:d,nodeLookup:u,lib:p,autoPanOnConnect:h,flowId:f,panBy:g,cancelConnection:m,onConnectStart:v,onConnect:y,onConnectEnd:x,isValidConnection:b=ei,onReconnectEnd:w,updateConnection:S,getTransform:k,getFromHandle:C,autoPanSpeed:j,dragThreshold:_=1}=t;const E=go(e.target);let D,M=0;const{x:T,y:I}=xo(e),A=null===E||void 0===E?void 0:E.elementFromPoint(T,I),O=Qo(a,A),R=null===d||void 0===d?void 0:d.getBoundingClientRect();let z=!1;if(!R||!O)return;const F=Jo(i,O,o,u,n);if(!F)return;let P=xo(e,R),B=!1,L=null,N=!1,U=null;function V(){if(!h||!R)return;const[e,t]=Wr(P,R,j);g({x:e,y:t}),M=requestAnimationFrame(V)}const W=s(s({},F),{},{nodeId:i,type:O,position:F.position}),H=u.get(i);let G={inProgress:!0,isValid:null,from:zo(H,W,Dr.Left,!0),fromHandle:W,fromPosition:W.position,fromNode:H,to:P,toHandle:null,toPosition:Mr[W.position],toNode:null};function X(){z=!0,S(G),null===v||void 0===v||v(e,{nodeId:i,handleId:o,handleType:O})}function Y(e){if(!z){const{x:t,y:n}=xo(e),r=t-T,o=n-I;if(!(r*r+o*o>_*_))return;X()}if(!C()||!W)return void q(e);const t=k();P=xo(e,R),D=Ko(to(P,t,!1,[1,1]),r,u,W),B||(V(),B=!0);const a=ti(e,{handle:D,connectionMode:n,fromNodeId:i,fromHandleId:o,fromType:c?"target":"source",isValidConnection:b,doc:E,lib:p,flowId:f,nodeLookup:u});U=a.handleDomNode,L=a.connection,N=function(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}(!!D,a.isValid);const l=s(s({},G),{},{isValid:N,to:a.toHandle&&N?no({x:a.toHandle.x,y:a.toHandle.y},t):P,toHandle:a.toHandle,toPosition:N&&a.toHandle?a.toHandle.position:Mr[W.position],toNode:a.toHandle?u.get(a.toHandle.nodeId):null});N&&D&&G.toHandle&&l.toHandle&&G.toHandle.type===l.toHandle.type&&G.toHandle.nodeId===l.toHandle.nodeId&&G.toHandle.id===l.toHandle.id&&G.to.x===l.to.x&&G.to.y===l.to.y||(S(l),G=l)}function q(e){if(z){(D||U)&&L&&N&&(null===y||void 0===y||y(L));const{inProgress:t}=G,n=s(s({},l(G,ar)),{},{toPosition:G.toHandle?G.toPosition:null});null===x||void 0===x||x(e,n),a&&(null===w||void 0===w||w(e,n))}m(),cancelAnimationFrame(M),B=!1,N=!1,L=null,U=null,E.removeEventListener("mousemove",Y),E.removeEventListener("mouseup",q),E.removeEventListener("touchmove",Y),E.removeEventListener("touchend",q)}0===_&&X(),E.addEventListener("mousemove",Y),E.addEventListener("mouseup",q),E.addEventListener("touchmove",Y),E.addEventListener("touchend",q)},isValid:ti};const ri=e=>({x:e.x,y:e.y,zoom:e.k}),oi=e=>{let{x:t,y:n,zoom:r}=e;return Hn.translate(t,n).scale(r)},ii=(e,t)=>e.target.closest(".".concat(t)),ai=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),si=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,li=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:si,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const o="number"===typeof t&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},ci=e=>{const t=e.ctrlKey&&io()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function di(e){let{domNode:t,minZoom:n,maxZoom:r,paneClickDistance:o,translateExtent:i,viewport:a,onPanZoom:s,onPanZoomStart:l,onPanZoomEnd:c,onDraggingChange:d}=e;const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=t.getBoundingClientRect(),h=er().clickDistance(!Jr(o)||o<0?0:o).scaleExtent([n,r]).translateExtent(i),f=Te(t).call(h);x({x:a.x,y:a.y,zoom:Lr(a.zoom,n,r)},[[0,0],[p.width,p.height]],i);const g=f.on("wheel.zoom"),m=f.on("dblclick.zoom");function v(e,t){return f?new Promise(n=>{null===h||void 0===h||h.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?ir:Xe).transform(li(f,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function y(){h.on("zoom",null)}async function x(e,t,n){const r=oi(e),o=null===h||void 0===h?void 0:h.constrain()(r,t,n);return o&&await v(o),new Promise(e=>e(o))}return h.wheelDelta(ci),{update:function(e){let{noWheelClassName:t,noPanClassName:n,onPaneContextMenu:r,userSelectionActive:o,panOnScroll:i,panOnDrag:a,panOnScrollMode:p,panOnScrollSpeed:v,preventScrolling:x,zoomOnPinch:b,zoomOnScroll:w,zoomOnDoubleClick:S,zoomActivationKeyPressed:k,lib:C,onTransformChange:j}=e;o&&!u.isZoomingOrPanning&&y();const _=i&&!k&&!o?function(e){let{zoomPanValues:t,noWheelClassName:n,d3Selection:r,d3Zoom:o,panOnScrollMode:i,panOnScrollSpeed:a,zoomOnPinch:s,onPanZoomStart:l,onPanZoom:c,onPanZoomEnd:d}=e;return e=>{if(ii(e,n))return!1;e.preventDefault(),e.stopImmediatePropagation();const u=r.property("__zoom").k||1;if(e.ctrlKey&&s){const t=Ie(e),n=ci(e),i=u*Math.pow(2,n);return void o.scaleTo(r,i,t,e)}const p=1===e.deltaMode?20:1;let h=i===kr.Vertical?0:e.deltaX*p,f=i===kr.Horizontal?0:e.deltaY*p;!io()&&e.shiftKey&&i!==kr.Vertical&&(h=e.deltaY*p,f=0),o.translateBy(r,-h/u*a,-f/u*a,{internal:!0});const g=ri(r.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling||(t.isPanScrolling=!0,null===l||void 0===l||l(e,g)),t.isPanScrolling&&(null===c||void 0===c||c(e,g),t.panScrollTimeout=setTimeout(()=>{null===d||void 0===d||d(e,g),t.isPanScrolling=!1},150))}}({zoomPanValues:u,noWheelClassName:t,d3Selection:f,d3Zoom:h,panOnScrollMode:p,panOnScrollSpeed:v,zoomOnPinch:b,onPanZoomStart:l,onPanZoom:s,onPanZoomEnd:c}):function(e){let{noWheelClassName:t,preventScrolling:n,d3ZoomHandler:r}=e;return function(e,o){const i="wheel"===e.type,a=!n&&i&&!e.ctrlKey,s=ii(e,t);if(e.ctrlKey&&i&&s&&e.preventDefault(),a||s)return null;e.preventDefault(),r.call(this,e,o)}}({noWheelClassName:t,preventScrolling:x,d3ZoomHandler:g});if(f.on("wheel.zoom",_,{passive:!1}),!o){const e=function(e){let{zoomPanValues:t,onDraggingChange:n,onPanZoomStart:r}=e;return e=>{var o,i,a;if(null!==(o=e.sourceEvent)&&void 0!==o&&o.internal)return;const s=ri(e.transform);t.mouseButton=(null===(i=e.sourceEvent)||void 0===i?void 0:i.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=s,"mousedown"===(null===(a=e.sourceEvent)||void 0===a?void 0:a.type)&&n(!0),r&&(null===r||void 0===r||r(e.sourceEvent,s))}}({zoomPanValues:u,onDraggingChange:d,onPanZoomStart:l});h.on("start",e);const t=function(e){let{zoomPanValues:t,panOnDrag:n,onPaneContextMenu:r,onTransformChange:o,onPanZoom:i}=e;return e=>{var a,s,l;t.usedRightMouseButton=!(!r||!ai(n,null!==(a=t.mouseButton)&&void 0!==a?a:0)),null!==(s=e.sourceEvent)&&void 0!==s&&s.sync||o([e.transform.x,e.transform.y,e.transform.k]),!i||null!==(l=e.sourceEvent)&&void 0!==l&&l.internal||null===i||void 0===i||i(e.sourceEvent,ri(e.transform))}}({zoomPanValues:u,panOnDrag:a,onPaneContextMenu:!!r,onPanZoom:s,onTransformChange:j});h.on("zoom",t);const n=function(e){let{zoomPanValues:t,panOnDrag:n,panOnScroll:r,onDraggingChange:o,onPanZoomEnd:i,onPaneContextMenu:a}=e;return e=>{var s,l,c,d;if((null===(s=e.sourceEvent)||void 0===s||!s.internal)&&(t.isZoomingOrPanning=!1,a&&ai(n,null!==(l=t.mouseButton)&&void 0!==l?l:0)&&!t.usedRightMouseButton&&e.sourceEvent&&a(e.sourceEvent),t.usedRightMouseButton=!1,o(!1),i&&(c=t.prevViewport,d=e.transform,c.x!==d.x||c.y!==d.y||c.zoom!==d.k))){const n=ri(e.transform);t.prevViewport=n,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{null===i||void 0===i||i(e.sourceEvent,n)},r?150:0)}}}({zoomPanValues:u,panOnDrag:a,panOnScroll:i,onPaneContextMenu:r,onPanZoomEnd:c,onDraggingChange:d});h.on("end",n)}const E=function(e){let{zoomActivationKeyPressed:t,zoomOnScroll:n,zoomOnPinch:r,panOnDrag:o,panOnScroll:i,zoomOnDoubleClick:a,userSelectionActive:s,noWheelClassName:l,noPanClassName:c,lib:d}=e;return e=>{var u;const p=t||n,h=r&&e.ctrlKey;if(1===e.button&&"mousedown"===e.type&&(ii(e,"".concat(d,"-flow__node"))||ii(e,"".concat(d,"-flow__edge"))))return!0;if(!o&&!p&&!i&&!a&&!r)return!1;if(s)return!1;if(ii(e,l)&&"wheel"===e.type)return!1;if(ii(e,c)&&("wheel"!==e.type||i&&"wheel"===e.type&&!t))return!1;if(!r&&e.ctrlKey&&"wheel"===e.type)return!1;if(!r&&"touchstart"===e.type&&(null===(u=e.touches)||void 0===u?void 0:u.length)>1)return e.preventDefault(),!1;if(!p&&!i&&!h&&"wheel"===e.type)return!1;if(!o&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(o)&&!o.includes(e.button)&&"mousedown"===e.type)return!1;const f=Array.isArray(o)&&o.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&f}}({zoomActivationKeyPressed:k,panOnDrag:a,zoomOnScroll:w,panOnScroll:i,zoomOnDoubleClick:S,zoomOnPinch:b,userSelectionActive:o,noPanClassName:n,noWheelClassName:t,lib:C});h.filter(E),S?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)},destroy:y,setViewport:async function(e,t){const n=oi(e);return await v(n,t),new Promise(e=>e(n))},setViewportConstrained:x,getViewport:function(){const e=f?Gn(f.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return f?new Promise(n=>{null===h||void 0===h||h.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?ir:Xe).scaleTo(li(f,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return f?new Promise(n=>{null===h||void 0===h||h.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?ir:Xe).scaleBy(li(f,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){null===h||void 0===h||h.scaleExtent(e)},setTranslateExtent:function(e){null===h||void 0===h||h.translateExtent(e)},syncViewport:function(e){if(f){const t=oi(e),n=f.property("__zoom");n.k===e.zoom&&n.x===e.x&&n.y===e.y||null===h||void 0===h||h.transform(f,t,null,{sync:!0})}},setClickDistance:function(e){const t=!Jr(e)||e<0?0:e;null===h||void 0===h||h.clickDistance(t)}}}var ui;!function(e){e.Line="line",e.Handle="handle"}(ui||(ui={}));function pi(e,t){return Math.max(0,t-e)}function hi(e,t){return Math.max(0,e-t)}function fi(e,t,n){return Math.max(0,t-e,e-n)}function gi(e,t){return e?!t:t}const mi={width:0,height:0,x:0,y:0},vi=s(s({},mi),{},{pointerX:0,pointerY:0,aspectRatio:1});function yi(e,t,n){var r,o;const i=t.position.x+e.position.x,a=t.position.y+e.position.y,s=null!==(r=e.measured.width)&&void 0!==r?r:0,l=null!==(o=e.measured.height)&&void 0!==o?o:0,c=n[0]*s,d=n[1]*l;return[[i-c,a-d],[i+s-c,a+l-d]]}function xi(e){let{domNode:t,nodeId:n,getStoreItems:r,onChange:o,onEnd:i}=e;const a=Te(t);return{update:function(e){let{controlPosition:t,boundaries:l,keepAspectRatio:c,resizeDirection:d,onResizeStart:u,onResize:p,onResizeEnd:h,shouldResize:f}=e,g=s({},mi),m=s({},vi);const v=function(e){return{isHorizontal:e.includes("right")||e.includes("left"),isVertical:e.includes("bottom")||e.includes("top"),affectsX:e.includes("left"),affectsY:e.includes("top")}}(t);let y,x,b,w,S=null,k=[];const C=He().on("start",e=>{var t,o,i,a,l;const{nodeLookup:c,transform:d,snapGrid:p,snapToGrid:h,nodeOrigin:f,paneDomNode:v}=r();if(y=c.get(n),!y)return;S=null!==(t=null===v||void 0===v?void 0:v.getBoundingClientRect())&&void 0!==t?t:null;const{xSnapped:C,ySnapped:j}=ho(e.sourceEvent,{transform:d,snapGrid:p,snapToGrid:h,containerBounds:S});g={width:null!==(o=y.measured.width)&&void 0!==o?o:0,height:null!==(i=y.measured.height)&&void 0!==i?i:0,x:null!==(a=y.position.x)&&void 0!==a?a:0,y:null!==(l=y.position.y)&&void 0!==l?l:0},m=s(s({},g),{},{pointerX:C,pointerY:j,aspectRatio:g.width/g.height}),x=void 0,y.parentId&&("parent"===y.extent||y.expandParent)&&(x=c.get(y.parentId),b=x&&"parent"===y.extent?function(e){return[[0,0],[e.measured.width,e.measured.height]]}(x):void 0),k=[],w=void 0;for(const[r,u]of c)if(u.parentId===n&&(k.push({id:r,position:s({},u.position),extent:u.extent}),"parent"===u.extent||u.expandParent)){var _;const e=yi(u,y,null!==(_=u.origin)&&void 0!==_?_:f);w=w?[[Math.min(e[0][0],w[0][0]),Math.min(e[0][1],w[0][1])],[Math.max(e[1][0],w[1][0]),Math.max(e[1][1],w[1][1])]]:e}null===u||void 0===u||u(e,s({},g))}).on("drag",e=>{var t;const{transform:n,snapGrid:i,snapToGrid:a,nodeOrigin:u}=r(),h=ho(e.sourceEvent,{transform:n,snapGrid:i,snapToGrid:a,containerBounds:S}),C=[];if(!y)return;const{x:j,y:_,width:E,height:D}=g,M={},T=null!==(t=y.origin)&&void 0!==t?t:u,{width:I,height:A,x:O,y:R}=function(e,t,n,r,o,i,a,s){let{affectsX:l,affectsY:c}=t;const{isHorizontal:d,isVertical:u}=t,p=d&&u,{xSnapped:h,ySnapped:f}=n,{minWidth:g,maxWidth:m,minHeight:v,maxHeight:y}=r,{x:x,y:b,width:w,height:S,aspectRatio:k}=e;let C=Math.floor(d?h-e.pointerX:0),j=Math.floor(u?f-e.pointerY:0);const _=w+(l?-C:C),E=S+(c?-j:j),D=-i[0]*w,M=-i[1]*S;let T=fi(_,g,m),I=fi(E,v,y);if(a){let e=0,t=0;l&&C<0?e=pi(x+C+D,a[0][0]):!l&&C>0&&(e=hi(x+_+D,a[1][0])),c&&j<0?t=pi(b+j+M,a[0][1]):!c&&j>0&&(t=hi(b+E+M,a[1][1])),T=Math.max(T,e),I=Math.max(I,t)}if(s){let e=0,t=0;l&&C>0?e=hi(x+C,s[0][0]):!l&&C<0&&(e=pi(x+_,s[1][0])),c&&j>0?t=hi(b+j,s[0][1]):!c&&j<0&&(t=pi(b+E,s[1][1])),T=Math.max(T,e),I=Math.max(I,t)}if(o){if(d){const e=fi(_/k,v,y)*k;if(T=Math.max(T,e),a){let e=0;e=!l&&!c||l&&!c&&p?hi(b+M+_/k,a[1][1])*k:pi(b+M+(l?C:-C)/k,a[0][1])*k,T=Math.max(T,e)}if(s){let e=0;e=!l&&!c||l&&!c&&p?pi(b+_/k,s[1][1])*k:hi(b+(l?C:-C)/k,s[0][1])*k,T=Math.max(T,e)}}if(u){const e=fi(E*k,g,m)/k;if(I=Math.max(I,e),a){let e=0;e=!l&&!c||c&&!l&&p?hi(x+E*k+D,a[1][0])/k:pi(x+(c?j:-j)*k+D,a[0][0])/k,I=Math.max(I,e)}if(s){let e=0;e=!l&&!c||c&&!l&&p?pi(x+E*k,s[1][0])/k:hi(x+(c?j:-j)*k,s[0][0])/k,I=Math.max(I,e)}}}j+=j<0?I:-I,C+=C<0?T:-T,o&&(p?_>E*k?j=(gi(l,c)?-C:C)/k:C=(gi(l,c)?-j:j)*k:d?(j=C/k,c=l):(C=j*k,l=c));const A=l?x+C:x,O=c?b+j:b;return{width:w+(l?-C:C),height:S+(c?-j:j),x:i[0]*C*(l?-1:1)+A,y:i[1]*j*(c?-1:1)+O}}(m,v,h,l,c,T,b,w),z=I!==E,F=A!==D,P=O!==j&&z,B=R!==_&&F;if(!P&&!B&&!z&&!F)return;if((P||B||1===T[0]||1===T[1])&&(M.x=P?O:g.x,M.y=B?R:g.y,g.x=M.x,g.y=M.y,k.length>0)){const e=O-j,t=R-_;for(const n of k)n.position={x:n.position.x-e+T[0]*(I-E),y:n.position.y-t+T[1]*(A-D)},C.push(n)}if((z||F)&&(M.width=!z||d&&"horizontal"!==d?g.width:I,M.height=!F||d&&"vertical"!==d?g.height:A,g.width=M.width,g.height=M.height),x&&y.expandParent){var L,N;const e=T[0]*(null!==(L=M.width)&&void 0!==L?L:0);M.x&&M.x<e&&(g.x=e,m.x=m.x-(M.x-e));const t=T[1]*(null!==(N=M.height)&&void 0!==N?N:0);M.y&&M.y<t&&(g.y=t,m.y=m.y-(M.y-t))}const U=function(e){let{width:t,prevWidth:n,height:r,prevHeight:o,affectsX:i,affectsY:a}=e;const s=t-n,l=r-o,c=[s>0?1:s<0?-1:0,l>0?1:l<0?-1:0];return s&&i&&(c[0]=-1*c[0]),l&&a&&(c[1]=-1*c[1]),c}({width:g.width,prevWidth:E,height:g.height,prevHeight:D,affectsX:v.affectsX,affectsY:v.affectsY}),V=s(s({},g),{},{direction:U});!1!==(null===f||void 0===f?void 0:f(e,V))&&(null===p||void 0===p||p(e,V),o(M,C))}).on("end",e=>{null===h||void 0===h||h(e,s({},g)),null===i||void 0===i||i(s({},g))});a.call(C)},destroy:function(){a.on(".drag",null)}}}var bi=n(8443);const wi=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"===typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!==typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(r,o,i);return i},Si=e=>e?wi(e):wi;const{useDebugValue:ki}=e,{useSyncExternalStoreWithSelector:Ci}=bi,ji=e=>e;function _i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ji,n=arguments.length>2?arguments[2]:void 0;const r=Ci(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ki(r),r}const Ei=(e,t)=>{const n=Si(e),r=function(e){return _i(n,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t)};return Object.assign(r,n),r};function Di(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Mi=n(7950);const Ti=["position","children","className","style"],Ii=["type","position","isValidConnection","isConnectable","isConnectableStart","isConnectableEnd","id","onConnect","children","className","onMouseDown","onTouchStart"],Ai=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"],Oi=["path","labelX","labelY","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","interactionWidth"],Ri=["id"],zi=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","onSelectionStart","onSelectionEnd","onBeforeDelete","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","selectionOnDrag","selectionMode","panActivationKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","edgesReconnectable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","paneClickDistance","nodeClickDistance","children","onReconnect","onReconnectStart","onReconnectEnd","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","reconnectRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","disableKeyboardA11y","autoPanOnConnect","autoPanOnNodeDrag","autoPanSpeed","connectionRadius","isValidConnection","onError","style","id","nodeDragThreshold","connectionDragThreshold","viewport","onViewportChange","width","height","colorMode","debug","onScroll","ariaLabelConfig"],Fi=["children","className"],Pi=(0,e.createContext)(null),Bi=Pi.Provider,Li=sr();function Ni(t,n){const r=(0,e.useContext)(Pi);if(null===r)throw new Error(Li);return _i(r,t,n)}function Ui(){const t=(0,e.useContext)(Pi);if(null===t)throw new Error(Li);return(0,e.useMemo)(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Vi={display:"none"},Wi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Hi="react-flow__node-desc",Gi="react-flow__edge-desc",Xi=e=>e.ariaLiveMessage,Yi=e=>e.ariaLabelConfig;function qi(e){let{rfId:t}=e;const n=Ni(Xi);return(0,c.jsx)("div",{id:"".concat("react-flow__aria-live","-").concat(t),"aria-live":"assertive","aria-atomic":"true",style:Wi,children:n})}function Zi(e){let{rfId:t,disableKeyboardA11y:n}=e;const r=Ni(Yi);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{id:"".concat(Hi,"-").concat(t),style:Vi,children:n?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),(0,c.jsx)("div",{id:"".concat(Gi,"-").concat(t),style:Vi,children:r["edge.a11yDescription.default"]}),!n&&(0,c.jsx)(qi,{rfId:t})]})}const $i=(0,e.forwardRef)((e,t)=>{let{position:n="top-left",children:r,className:o,style:i}=e,a=l(e,Ti);const u="".concat(n).split("-");return(0,c.jsx)("div",s(s({className:d(["react-flow__panel",o,...u]),style:i,ref:t},a),{},{children:r}))});function Ki(e){let{proOptions:t,position:n="bottom-right"}=e;return null!==t&&void 0!==t&&t.hideAttribution?null:(0,c.jsx)($i,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,c.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}$i.displayName="Panel";const Ji=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Qi=e=>e.id;function ea(e,t){return Di(e.selectedNodes.map(Qi),t.selectedNodes.map(Qi))&&Di(e.selectedEdges.map(Qi),t.selectedEdges.map(Qi))}function ta(t){let{onSelectionChange:n}=t;const r=Ui(),{selectedNodes:o,selectedEdges:i}=Ni(Ji,ea);return(0,e.useEffect)(()=>{const e={nodes:o,edges:i};null===n||void 0===n||n(e),r.getState().onSelectionChangeHandlers.forEach(t=>t(e))},[o,i,n]),null}const na=e=>!!e.onSelectionChangeHandlers;function ra(e){let{onSelectionChange:t}=e;const n=Ni(na);return t||n?(0,c.jsx)(ta,{onSelectionChange:t}):null}const oa=[0,0],ia={x:0,y:0,zoom:1},aa=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig","rfId"],sa=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),la={translateExtent:xr,nodeOrigin:oa,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function ca(t){const{setNodes:n,setEdges:r,setMinZoom:o,setMaxZoom:i,setTranslateExtent:a,setNodeExtent:s,reset:l,setDefaultNodesAndEdges:c,setPaneClickDistance:d}=Ni(sa,Di),u=Ui();(0,e.useEffect)(()=>(c(t.defaultNodes,t.defaultEdges),()=>{p.current=la,l()}),[]);const p=(0,e.useRef)(la);return(0,e.useEffect)(()=>{for(const e of aa){const l=t[e];l!==p.current[e]&&("undefined"!==typeof t[e]&&("nodes"===e?n(l):"edges"===e?r(l):"minZoom"===e?o(l):"maxZoom"===e?i(l):"translateExtent"===e?a(l):"nodeExtent"===e?s(l):"paneClickDistance"===e?d(l):"ariaLabelConfig"===e?u.setState({ariaLabelConfig:po(l)}):"fitView"===e?u.setState({fitViewQueued:l}):"fitViewOptions"===e?u.setState({fitViewOptions:l}):u.setState({[e]:l})))}p.current=t},aa.map(e=>t[e])),null}function da(){return"undefined"!==typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}const ua="undefined"!==typeof document?document:null;function pa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{target:ua,actInsideInputWithModifier:!0};const[r,o]=(0,e.useState)(!1),i=(0,e.useRef)(!1),a=(0,e.useRef)(new Set([])),[s,l]=(0,e.useMemo)(()=>{if(null!==t){const e=(Array.isArray(t)?t:[t]).filter(e=>"string"===typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=e.reduce((e,t)=>e.concat(...t),[]);return[e,n]}return[[],[]]},[t]);return(0,e.useEffect)(()=>{var e,r;const c=null!==(e=null===n||void 0===n?void 0:n.target)&&void 0!==e?e:ua,d=null===(r=null===n||void 0===n?void 0:n.actInsideInputWithModifier)||void 0===r||r;if(null!==t){const e=e=>{i.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey;if((!i.current||i.current&&!d)&&vo(e))return!1;const t=fa(e.code,l);if(a.current.add(e[t]),ha(s,a.current,!1)){var r;const t=(null===(r=e.composedPath)||void 0===r||null===(r=r.call(e))||void 0===r?void 0:r[0])||e.target,a="BUTTON"===(null===t||void 0===t?void 0:t.nodeName)||"A"===(null===t||void 0===t?void 0:t.nodeName);!1===n.preventDefault||!i.current&&a||e.preventDefault(),o(!0)}},t=e=>{const t=fa(e.code,l);ha(s,a.current,!0)?(o(!1),a.current.clear()):a.current.delete(e[t]),"Meta"===e.key&&a.current.clear(),i.current=!1},r=()=>{a.current.clear(),o(!1)};return null===c||void 0===c||c.addEventListener("keydown",e),null===c||void 0===c||c.addEventListener("keyup",t),window.addEventListener("blur",r),window.addEventListener("contextmenu",r),()=>{null===c||void 0===c||c.removeEventListener("keydown",e),null===c||void 0===c||c.removeEventListener("keyup",t),window.removeEventListener("blur",r),window.removeEventListener("contextmenu",r)}}},[t,o]),r}function ha(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function fa(e,t){return t.includes(e)?"code":"key"}function ga(e,t){const n=[],r=new Map,o=[];for(const i of e)if("add"!==i.type)if("remove"===i.type||"replace"===i.type)r.set(i.id,[i]);else{const e=r.get(i.id);e?e.push(i):r.set(i.id,[i])}else o.push(i);for(const i of t){const e=r.get(i.id);if(!e){n.push(i);continue}if("remove"===e[0].type)continue;if("replace"===e[0].type){n.push(s({},e[0].item));continue}const t=s({},i);for(const n of e)ma(n,t);n.push(t)}return o.length&&o.forEach(e=>{void 0!==e.index?n.splice(e.index,0,s({},e.item)):n.push(s({},e.item))}),n}function ma(e,t){switch(e.type){case"select":t.selected=e.selected;break;case"position":"undefined"!==typeof e.position&&(t.position=e.position),"undefined"!==typeof e.dragging&&(t.dragging=e.dragging);break;case"dimensions":var n;if("undefined"!==typeof e.dimensions)null!==(n=t.measured)&&void 0!==n||(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(!0!==e.setAttributes&&"width"!==e.setAttributes||(t.width=e.dimensions.width),!0!==e.setAttributes&&"height"!==e.setAttributes||(t.height=e.dimensions.height));"boolean"===typeof e.resizing&&(t.resizing=e.resizing)}}function va(e,t){return ga(e,t)}function ya(e,t){return ga(e,t)}function xa(e,t){return{id:e,type:"select",selected:t}}function ba(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];for(const[o,i]of e){const e=t.has(o);void 0===i.selected&&!e||i.selected===e||(n&&(i.selected=e),r.push(xa(i.id,e)))}return r}function wa(e){let{items:t=[],lookup:n}=e;const r=[],o=new Map(t.map(e=>[e.id,e]));for(const[s,l]of t.entries()){var i,a;const e=n.get(l.id),t=null!==(i=null===e||void 0===e||null===(a=e.internals)||void 0===a?void 0:a.userNode)&&void 0!==i?i:e;void 0!==t&&t!==l&&r.push({id:l.id,item:l,type:"replace"}),void 0===t&&r.push({item:l,type:"add",index:s})}for(const[s]of n){void 0===o.get(s)&&r.push({id:s,type:"remove"})}return r}function Sa(e){return{id:e.id,type:"remove"}}const ka=e=>(e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e))(e);function Ca(t){return(0,e.forwardRef)(t)}const ja="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function _a(t){const[n,r]=(0,e.useState)(BigInt(0)),[o]=(0,e.useState)(()=>function(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}(()=>r(e=>e+BigInt(1))));return ja(()=>{const e=o.get();e.length&&(t(e),o.reset())},[n]),o}const Ea=(0,e.createContext)(null);function Da(t){let{children:n}=t;const r=Ui(),o=(0,e.useCallback)(e=>{const{nodes:t=[],setNodes:n,hasDefaultNodes:o,onNodesChange:i,nodeLookup:a,fitViewQueued:s}=r.getState();let l=t;for(const r of e)l="function"===typeof r?r(l):r;const c=wa({items:l,lookup:a});o&&n(l),c.length>0?null===i||void 0===i||i(c):s&&window.requestAnimationFrame(()=>{const{fitViewQueued:e,nodes:t,setNodes:n}=r.getState();e&&n(t)})},[]),i=_a(o),a=_a((0,e.useCallback)(e=>{const{edges:t=[],setEdges:n,hasDefaultEdges:o,onEdgesChange:i,edgeLookup:a}=r.getState();let s=t;for(const r of e)s="function"===typeof r?r(s):r;o?n(s):i&&i(wa({items:s,lookup:a}))},[])),s=(0,e.useMemo)(()=>({nodeQueue:i,edgeQueue:a}),[]);return(0,c.jsx)(Ea.Provider,{value:s,children:n})}const Ma=e=>!!e.panZoom;function Ta(){const t=(()=>{const t=Ui();return(0,e.useMemo)(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:null===e||void 0===e?void 0:e.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:null===e||void 0===e?void 0:e.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:r}=t.getState();return r?r.scaleTo(e,{duration:null===n||void 0===n?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{var r,o,i;const{transform:[a,s,l],panZoom:c}=t.getState();return c?(await c.setViewport({x:null!==(r=e.x)&&void 0!==r?r:a,y:null!==(o=e.y)&&void 0!==o?o:s,zoom:null!==(i=e.zoom)&&void 0!==i?i:l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,r]=t.getState().transform;return{x:e,y:n,zoom:r}},setCenter:async(e,n,r)=>t.getState().setCenter(e,n,r),fitBounds:async(e,n)=>{var r;const{width:o,height:i,minZoom:a,maxZoom:s,panZoom:l}=t.getState(),c=oo(e,o,i,a,s,null!==(r=null===n||void 0===n?void 0:n.padding)&&void 0!==r?r:.1);return l?(await l.setViewport(c,{duration:null===n||void 0===n?void 0:n.duration,ease:null===n||void 0===n?void 0:n.ease,interpolate:null===n||void 0===n?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:function(e){var n,r;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:i,snapGrid:a,snapToGrid:s,domNode:l}=t.getState();if(!l)return e;const{x:c,y:d}=l.getBoundingClientRect(),u={x:e.x-c,y:e.y-d},p=null!==(n=o.snapGrid)&&void 0!==n?n:a,h=null!==(r=o.snapToGrid)&&void 0!==r?r:s;return to(u,i,h,p)},flowToScreenPosition:e=>{const{transform:n,domNode:r}=t.getState();if(!r)return e;const{x:o,y:i}=r.getBoundingClientRect(),a=no(e,n);return{x:a.x+o,y:a.y+i}}}),[])})(),n=Ui(),r=function(){const t=(0,e.useContext)(Ea);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}(),o=Ni(Ma),i=(0,e.useMemo)(()=>{const e=e=>n.getState().nodeLookup.get(e),t=e=>{r.nodeQueue.push(e)},o=e=>{r.edgeQueue.push(e)},i=e=>{var t,r,o,i;const{nodeLookup:a,nodeOrigin:l}=n.getState(),c=ka(e)?e:a.get(e.id),d=c.parentId?co(c.position,c.measured,c.parentId,a,l):c.position,u=s(s({},c),{},{position:d,width:null!==(t=null===(r=c.measured)||void 0===r?void 0:r.width)&&void 0!==t?t:c.width,height:null!==(o=null===(i=c.measured)||void 0===i?void 0:i.height)&&void 0!==o?o:c.height});return Yr(u)},a=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};t(t=>t.map(t=>{if(t.id===e){const e="function"===typeof n?n(t):n;return r.replace&&ka(e)?e:s(s({},t),e)}return t}))},l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};o(r=>r.map(r=>{if(r.id===e){const e="function"===typeof t?t(r):t;return n.replace&&Ir(e)?e:s(s({},r),e)}return r}))};return{getNodes:()=>n.getState().nodes.map(e=>s({},e)),getNode:t=>{var n;return null===(n=e(t))||void 0===n?void 0:n.internals.userNode},getInternalNode:e,getEdges:()=>{const{edges:e=[]}=n.getState();return e.map(e=>s({},e))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:t,setEdges:o,addNodes:e=>{const t=Array.isArray(e)?e:[e];r.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{const t=Array.isArray(e)?e:[e];r.edgeQueue.push(e=>[...e,...t])},toObject:()=>{const{nodes:e=[],edges:t=[],transform:r}=n.getState(),[o,i,a]=r;return{nodes:e.map(e=>s({},e)),edges:t.map(e=>s({},e)),viewport:{x:o,y:i,zoom:a}}},deleteElements:async e=>{let{nodes:t=[],edges:r=[]}=e;const{nodes:o,edges:i,onNodesDelete:a,onEdgesDelete:s,triggerNodeChanges:l,triggerEdgeChanges:c,onDelete:d,onBeforeDelete:u}=n.getState(),{nodes:p,edges:h}=await Br({nodesToRemove:t,edgesToRemove:r,nodes:o,edges:i,onBeforeDelete:u}),f=h.length>0,g=p.length>0;if(f){const e=h.map(Sa);null===s||void 0===s||s(h),c(e)}if(g){const e=p.map(Sa);null===a||void 0===a||a(p),l(e)}return(g||f)&&(null===d||void 0===d||d({nodes:p,edges:h})),{deletedNodes:p,deletedEdges:h}},getIntersectingNodes:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const o=Kr(e),a=o?e:i(e),s=void 0!==r;return a?(r||n.getState().nodes).filter(r=>{const i=n.getState().nodeLookup.get(r.id);if(i&&!o&&(r.id===e.id||!i.internals.positionAbsolute))return!1;const l=Yr(s?r:i),c=$r(l,a);return t&&c>0||c>=a.width*a.height}):[]},isNodeIntersecting:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Kr(e)?e:i(e);if(!r)return!1;const o=$r(r,t);return n&&o>0||o>=r.width*r.height},updateNode:a,updateNodeData:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};a(e,e=>{const r="function"===typeof t?t(e):t;return n.replace?s(s({},e),{},{data:r}):s(s({},e),{},{data:s(s({},e.data),r)})},n)},updateEdge:l,updateEdgeData:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};l(e,e=>{const r="function"===typeof t?t(e):t;return n.replace?s(s({},e),{},{data:r}):s(s({},e),{},{data:s(s({},e.data),r)})},n)},getNodesBounds:e=>{const{nodeLookup:t,nodeOrigin:r}=n.getState();return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{nodeOrigin:[0,0]};if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const r="string"===typeof n;let o=t.nodeLookup||r?void 0:n;t.nodeLookup&&(o=r?t.nodeLookup.get(n):Ar(n)?n:t.nodeLookup.get(n.id));const i=o?qr(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Hr(e,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Xr(n)}(e,{nodeLookup:t,nodeOrigin:r})},getHandleConnections:e=>{var t,r;let{type:o,id:i,nodeId:a}=e;return Array.from(null!==(t=null===(r=n.getState().connectionLookup.get("".concat(a,"-").concat(o).concat(i?"-".concat(i):"")))||void 0===r?void 0:r.values())&&void 0!==t?t:[])},getNodeConnections:e=>{var t,r;let{type:o,handleId:i,nodeId:a}=e;return Array.from(null!==(t=null===(r=n.getState().connectionLookup.get("".concat(a).concat(o?i?"-".concat(o,"-").concat(i):"-".concat(o):"")))||void 0===r?void 0:r.values())&&void 0!==t?t:[])},fitView:async e=>{var t;const o=null!==(t=n.getState().fitViewResolver)&&void 0!==t?t:function(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}();return n.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:o}),r.nodeQueue.push(e=>[...e]),o.promise}}},[]);return(0,e.useMemo)(()=>s(s(s({},i),t),{},{viewportInitialized:o}),[o])}const Ia=e=>e.selected,Aa="undefined"!==typeof window?window:void 0;const Oa={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ra=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function za(t){let{onPaneContextMenu:n,zoomOnScroll:r=!0,zoomOnPinch:o=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:s=kr.Free,zoomOnDoubleClick:l=!0,panOnDrag:d=!0,defaultViewport:u,translateExtent:p,minZoom:h,maxZoom:f,zoomActivationKeyCode:g,preventScrolling:m=!0,children:v,noWheelClassName:y,noPanClassName:x,onViewportChange:b,isControlledViewport:w,paneClickDistance:S}=t;const k=Ui(),C=(0,e.useRef)(null),{userSelectionActive:j,lib:_}=Ni(Ra,Di),E=pa(g),D=(0,e.useRef)();!function(t){const n=Ui();(0,e.useEffect)(()=>{const e=()=>{if(!t.current)return!1;const e=fo(t.current);var r,o;0!==e.height&&0!==e.width||null===(r=(o=n.getState()).onError)||void 0===r||r.call(o,"004",cr()),n.setState({width:e.width||500,height:e.height||500})};if(t.current){e(),window.addEventListener("resize",e);const n=new ResizeObserver(()=>e());return n.observe(t.current),()=>{window.removeEventListener("resize",e),n&&t.current&&n.unobserve(t.current)}}},[])}(C);const M=(0,e.useCallback)(e=>{null===b||void 0===b||b({x:e[0],y:e[1],zoom:e[2]}),w||k.setState({transform:e})},[b,w]);return(0,e.useEffect)(()=>{if(C.current){D.current=di({domNode:C.current,minZoom:h,maxZoom:f,translateExtent:p,viewport:u,paneClickDistance:S,onDraggingChange:e=>k.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{const{onViewportChangeStart:n,onMoveStart:r}=k.getState();null===r||void 0===r||r(e,t),null===n||void 0===n||n(t)},onPanZoom:(e,t)=>{const{onViewportChange:n,onMove:r}=k.getState();null===r||void 0===r||r(e,t),null===n||void 0===n||n(t)},onPanZoomEnd:(e,t)=>{const{onViewportChangeEnd:n,onMoveEnd:r}=k.getState();null===r||void 0===r||r(e,t),null===n||void 0===n||n(t)}});const{x:e,y:t,zoom:n}=D.current.getViewport();return k.setState({panZoom:D.current,transform:[e,t,n],domNode:C.current.closest(".react-flow")}),()=>{var e;null===(e=D.current)||void 0===e||e.destroy()}}},[]),(0,e.useEffect)(()=>{var e;null===(e=D.current)||void 0===e||e.update({onPaneContextMenu:n,zoomOnScroll:r,zoomOnPinch:o,panOnScroll:i,panOnScrollSpeed:a,panOnScrollMode:s,zoomOnDoubleClick:l,panOnDrag:d,zoomActivationKeyPressed:E,preventScrolling:m,noPanClassName:x,userSelectionActive:j,noWheelClassName:y,lib:_,onTransformChange:M})},[n,r,o,i,a,s,l,d,E,m,x,j,y,_,M]),(0,c.jsx)("div",{className:"react-flow__renderer",ref:C,style:Oa,children:v})}const Fa=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Pa(){const{userSelectionActive:e,userSelectionRect:t}=Ni(Fa,Di);return e&&t?(0,c.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}}):null}const Ba=(e,t)=>n=>{n.target===t.current&&(null===e||void 0===e||e(n))},La=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Na(t){let{isSelecting:n,selectionKeyPressed:r,selectionMode:o=Cr.Full,panOnDrag:i,selectionOnDrag:a,onSelectionStart:s,onSelectionEnd:l,onPaneClick:u,onPaneContextMenu:p,onPaneScroll:h,onPaneMouseEnter:f,onPaneMouseMove:g,onPaneMouseLeave:m,children:v}=t;const y=Ui(),{userSelectionActive:x,elementsSelectable:b,dragging:w,connectionInProgress:S}=Ni(La,Di),k=b&&(n||x),C=(0,e.useRef)(null),j=(0,e.useRef)(),_=(0,e.useRef)(new Set),E=(0,e.useRef)(new Set),D=(0,e.useRef)(!1),M=(0,e.useRef)(!1),T=e=>{D.current||S?D.current=!1:(null===u||void 0===u||u(e),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1}))},I=h?e=>h(e):void 0,A=!0===i||Array.isArray(i)&&i.includes(0);return(0,c.jsxs)("div",{className:d(["react-flow__pane",{draggable:A,dragging:w,selection:n}]),onClick:k?void 0:Ba(T,C),onContextMenu:Ba(e=>{Array.isArray(i)&&null!==i&&void 0!==i&&i.includes(2)?e.preventDefault():null===p||void 0===p||p(e)},C),onWheel:Ba(I,C),onPointerEnter:k?void 0:f,onPointerDown:k?e=>{var t,r;const{resetSelectedElements:o,domNode:i}=y.getState();if(j.current=null===i||void 0===i?void 0:i.getBoundingClientRect(),!b||!n||0!==e.button||e.target!==C.current||!j.current)return;null===(t=e.target)||void 0===t||null===(r=t.setPointerCapture)||void 0===r||r.call(t,e.pointerId),M.current=!0,D.current=!1;const{x:a,y:l}=xo(e.nativeEvent,j.current);o(),y.setState({userSelectionRect:{width:0,height:0,startX:a,startY:l,x:a,y:l}}),null===s||void 0===s||s(e)}:g,onPointerMove:k?e=>{var t;const{userSelectionRect:n,transform:r,nodeLookup:i,edgeLookup:a,connectionLookup:s,triggerNodeChanges:l,triggerEdgeChanges:c,defaultEdgeOptions:d}=y.getState();if(!j.current||!n)return;D.current=!0;const{x:u,y:p}=xo(e.nativeEvent,j.current),{startX:h,startY:f}=n,g={startX:h,startY:f,x:u<h?u:h,y:p<f?p:f,width:Math.abs(u-h),height:Math.abs(p-f)},m=_.current,v=E.current;_.current=new Set(zr(i,g,r,o===Cr.Partial,!0).map(e=>e.id)),E.current=new Set;const x=null===(t=null===d||void 0===d?void 0:d.selectable)||void 0===t||t;for(const o of _.current){const e=s.get(o);if(e)for(const{edgeId:t}of e.values()){var b;const e=a.get(t);e&&(null!==(b=e.selectable)&&void 0!==b?b:x)&&E.current.add(t)}}if(!uo(m,_.current)){l(ba(i,_.current,!0))}if(!uo(v,E.current)){c(ba(a,E.current))}y.setState({userSelectionRect:g,userSelectionActive:!0,nodesSelectionActive:!1})}:g,onPointerUp:k?e=>{var t,n;if(0!==e.button||!M.current)return;null===(t=e.target)||void 0===t||null===(n=t.releasePointerCapture)||void 0===n||n.call(t,e.pointerId);const{userSelectionRect:o}=y.getState();!x&&o&&e.target===C.current&&(null===T||void 0===T||T(e)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:_.current.size>0}),null===l||void 0===l||l(e),(r||a)&&(D.current=!1),M.current=!1}:void 0,onPointerLeave:m,ref:C,style:Oa,children:[v,(0,c.jsx)(Pa,{})]})}function Ua(e){let{id:t,store:n,unselect:r=!1,nodeRef:o}=e;const{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:s,nodeLookup:l,onError:c}=n.getState(),d=l.get(t);d?(n.setState({nodesSelectionActive:!1}),d.selected?(r||d.selected&&s)&&(a({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var e;return null===o||void 0===o||null===(e=o.current)||void 0===e?void 0:e.blur()})):i([t])):null===c||void 0===c||c("012",mr(t))}function Va(t){let{nodeRef:n,disabled:r=!1,noDragClassName:o,handleSelector:i,nodeId:a,isSelectable:s,nodeClickDistance:l}=t;const c=Ui(),[d,u]=(0,e.useState)(!1),p=(0,e.useRef)();return(0,e.useEffect)(()=>{p.current=$o({getStoreItems:()=>c.getState(),onNodeMouseDown:e=>{Ua({id:e,store:c,nodeRef:n})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),(0,e.useEffect)(()=>{var e;if(r)null===(e=p.current)||void 0===e||e.destroy();else if(n.current){var t;return null===(t=p.current)||void 0===t||t.update({noDragClassName:o,handleSelector:i,domNode:n.current,isSelectable:s,nodeId:a,nodeClickDistance:l}),()=>{var e;null===(e=p.current)||void 0===e||e.destroy()}}},[o,i,r,s,n,a]),d}function Wa(){const t=Ui(),n=(0,e.useCallback)(e=>{const{nodeExtent:n,snapToGrid:r,snapGrid:o,nodesDraggable:i,onError:a,updateNodePositions:s,nodeLookup:l,nodeOrigin:c}=t.getState(),d=new Map,u=(e=>t=>t.selected&&(t.draggable||e&&"undefined"===typeof t.draggable))(i),p=r?o[0]:5,h=r?o[1]:5,f=e.direction.x*p*e.factor,g=e.direction.y*h*e.factor;for(const[,t]of l){if(!u(t))continue;let e={x:t.internals.positionAbsolute.x+f,y:t.internals.positionAbsolute.y+g};r&&(e=eo(e,o));const{position:i,positionAbsolute:s}=Pr({nodeId:t.id,nextPosition:e,nodeLookup:l,nodeExtent:n,nodeOrigin:c,onError:a});t.position=i,t.internals.positionAbsolute=s,d.set(t.id,t)}s(d)},[]);return n}const Ha=(0,e.createContext)(null),Ga=Ha.Provider;Ha.Consumer;const Xa=()=>(0,e.useContext)(Ha),Ya=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId});const qa=(0,e.memo)(Ca(function(e,t){let{type:n="source",position:r=Dr.Top,isValidConnection:o,isConnectable:i=!0,isConnectableStart:a=!0,isConnectableEnd:u=!0,id:p,onConnect:h,children:f,className:g,onMouseDown:m,onTouchStart:v}=e,y=l(e,Ii);const x=p||null,b="target"===n,w=Ui(),S=Xa(),{connectOnClick:k,noPanClassName:C,rfId:j}=Ni(Ya,Di),{connectingFrom:_,connectingTo:E,clickConnecting:D,isPossibleEndHandle:M,connectionInProcess:T,clickConnectionInProcess:I,valid:A}=Ni(((e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:i,connection:a}=r,{fromHandle:s,toHandle:l,isValid:c}=a,d=(null===l||void 0===l?void 0:l.nodeId)===e&&(null===l||void 0===l?void 0:l.id)===t&&(null===l||void 0===l?void 0:l.type)===n;return{connectingFrom:(null===s||void 0===s?void 0:s.nodeId)===e&&(null===s||void 0===s?void 0:s.id)===t&&(null===s||void 0===s?void 0:s.type)===n,connectingTo:d,clickConnecting:(null===o||void 0===o?void 0:o.nodeId)===e&&(null===o||void 0===o?void 0:o.id)===t&&(null===o||void 0===o?void 0:o.type)===n,isPossibleEndHandle:i===Sr.Strict?(null===s||void 0===s?void 0:s.type)!==n:e!==(null===s||void 0===s?void 0:s.nodeId)||t!==(null===s||void 0===s?void 0:s.id),connectionInProcess:!!s,clickConnectionInProcess:!!o,valid:d&&c}})(S,x,n),Di);var O,R;S||null===(O=(R=w.getState()).onError)||void 0===O||O.call(R,"010",fr());const z=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=w.getState(),o=s(s({},t),e);if(r){const{edges:e,setEdges:t}=w.getState();t(((e,t)=>{if(!e.source||!e.target)return Qr(0,ur()),t;let n;return n=Ir(e)?s({},e):s(s({},e),{},{id:Eo(e)}),((e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)))(n,t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))})(o,e))}null===n||void 0===n||n(o),null===h||void 0===h||h(o)},F=e=>{if(!S)return;const t=yo(e.nativeEvent);if(a&&(t&&0===e.button||!t)){const t=w.getState();ni.onPointerDown(e.nativeEvent,{autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:b,handleId:x,nodeId:S,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:z,isValidConnection:o||t.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?null===m||void 0===m||m(e):null===v||void 0===v||v(e)};return(0,c.jsx)("div",s(s({"data-handleid":x,"data-nodeid":S,"data-handlepos":r,"data-id":"".concat(j,"-").concat(S,"-").concat(x,"-").concat(n),className:d(["react-flow__handle","react-flow__handle-".concat(r),"nodrag",C,g,{source:!b,target:b,connectable:i,connectablestart:a,connectableend:u,clickconnecting:D,connectingfrom:_,connectingto:E,valid:A,connectionindicator:i&&(!T||M)&&(T||I?u:a)}]),onMouseDown:F,onTouchStart:F,onClick:k?e=>{const{onClickConnectStart:t,onClickConnectEnd:r,connectionClickStartHandle:i,connectionMode:s,isValidConnection:l,lib:c,rfId:d,nodeLookup:u,connection:p}=w.getState();if(!S||!i&&!a)return;if(!i)return null===t||void 0===t||t(e.nativeEvent,{nodeId:S,handleId:x,handleType:n}),void w.setState({connectionClickStartHandle:{nodeId:S,type:n,id:x}});const h=go(e.target),f=o||l,{connection:g,isValid:m}=ni.isValid(e.nativeEvent,{handle:{nodeId:S,id:x,type:n},connectionMode:s,fromNodeId:i.nodeId,fromHandleId:i.id||null,fromType:i.type,isValidConnection:f,flowId:d,doc:h,lib:c,nodeLookup:u});m&&g&&z(g);const v=structuredClone(p);delete v.inProgress,v.toPosition=v.toHandle?v.toHandle.position:null,null===r||void 0===r||r(e,v),w.setState({connectionClickStartHandle:null})}:void 0,ref:t},y),{},{children:f}))}));const Za={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},$a={input:function(e){let{data:t,isConnectable:n,sourcePosition:r=Dr.Bottom}=e;return(0,c.jsxs)(c.Fragment,{children:[null===t||void 0===t?void 0:t.label,(0,c.jsx)(qa,{type:"source",position:r,isConnectable:n})]})},default:function(e){let{data:t,isConnectable:n,targetPosition:r=Dr.Top,sourcePosition:o=Dr.Bottom}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qa,{type:"target",position:r,isConnectable:n}),null===t||void 0===t?void 0:t.label,(0,c.jsx)(qa,{type:"source",position:o,isConnectable:n})]})},output:function(e){let{data:t,isConnectable:n,targetPosition:r=Dr.Top}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qa,{type:"target",position:r,isConnectable:n}),null===t||void 0===t?void 0:t.label]})},group:function(){return null}};const Ka=e=>{const{width:t,height:n,x:r,y:o}=Rr(e.nodeLookup,{filter:e=>!!e.selected});return{width:Jr(t)?t:null,height:Jr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],") translate(").concat(r,"px,").concat(o,"px)")}};function Ja(t){let{onSelectionContextMenu:n,noPanClassName:r,disableKeyboardA11y:o}=t;const i=Ui(),{width:a,height:s,transformString:l,userSelectionActive:u}=Ni(Ka,Di),p=Wa(),h=(0,e.useRef)(null);if((0,e.useEffect)(()=>{var e;o||(null===(e=h.current)||void 0===e||e.focus({preventScroll:!0}))},[o]),Va({nodeRef:h}),u||!a||!s)return null;const f=n?e=>{const t=i.getState().nodes.filter(e=>e.selected);n(e,t)}:void 0;return(0,c.jsx)("div",{className:d(["react-flow__nodesselection","react-flow__container",r]),style:{transform:l},children:(0,c.jsx)("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:o?void 0:-1,onKeyDown:o?void 0:e=>{Object.prototype.hasOwnProperty.call(Za,e.key)&&(e.preventDefault(),p({direction:Za[e.key],factor:e.shiftKey?4:1}))},style:{width:a,height:s}})})}const Qa="undefined"!==typeof window?window:void 0,es=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ts(t){let{children:n,onPaneClick:r,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,paneClickDistance:d,deleteKeyCode:u,selectionKeyCode:p,selectionOnDrag:h,selectionMode:f,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:C,panOnScrollMode:j,zoomOnDoubleClick:_,panOnDrag:E,defaultViewport:D,translateExtent:M,minZoom:T,maxZoom:I,preventScrolling:A,onSelectionContextMenu:O,noWheelClassName:R,noPanClassName:z,disableKeyboardA11y:F,onViewportChange:P,isControlledViewport:B}=t;const{nodesSelectionActive:L,userSelectionActive:N}=Ni(es),U=pa(p,{target:Qa}),V=pa(y,{target:Qa}),W=V||E,H=V||k,G=h&&!0!==W,X=U||N||G;return function(t){let{deleteKeyCode:n,multiSelectionKeyCode:r}=t;const o=Ui(),{deleteElements:i}=Ta(),a=pa(n,{actInsideInputWithModifier:!1}),s=pa(r,{target:Aa});(0,e.useEffect)(()=>{if(a){const{edges:e,nodes:t}=o.getState();i({nodes:t.filter(Ia),edges:e.filter(Ia)}),o.setState({nodesSelectionActive:!1})}},[a]),(0,e.useEffect)(()=>{o.setState({multiSelectionActive:s})},[s])}({deleteKeyCode:u,multiSelectionKeyCode:v}),(0,c.jsx)(za,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:H,panOnScrollSpeed:C,panOnScrollMode:j,zoomOnDoubleClick:_,panOnDrag:!U&&W,defaultViewport:D,translateExtent:M,minZoom:T,maxZoom:I,zoomActivationKeyCode:x,preventScrolling:A,noWheelClassName:R,noPanClassName:z,onViewportChange:P,isControlledViewport:B,paneClickDistance:d,children:(0,c.jsxs)(Na,{onSelectionStart:g,onSelectionEnd:m,onPaneClick:r,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:W,isSelecting:!!X,selectionMode:f,selectionKeyPressed:U,selectionOnDrag:G,children:[n,L&&(0,c.jsx)(Ja,{onSelectionContextMenu:O,noPanClassName:z,disableKeyboardA11y:F})]})})}ts.displayName="FlowRenderer";const ns=(0,e.memo)(ts);function rs(t){const n=Ni((0,e.useCallback)((e=>t=>e?zr(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(e=>e.id):Array.from(t.nodeLookup.keys()))(t),[t]),Di);return n}const is=e=>e.updateNodeInternals;function as(t){var n,r,o;let{id:i,onClick:a,onMouseEnter:l,onMouseMove:u,onMouseLeave:p,onContextMenu:h,onDoubleClick:f,nodesDraggable:g,elementsSelectable:m,nodesConnectable:v,nodesFocusable:y,resizeObserver:x,noDragClassName:b,noPanClassName:w,disableKeyboardA11y:S,rfId:k,nodeTypes:C,nodeClickDistance:j,onError:_}=t;const{node:E,internals:D,isParent:M}=Ni(e=>{const t=e.nodeLookup.get(i),n=e.parentLookup.has(i);return{node:t,internals:t.internals,isParent:n}},Di);let T=E.type||"default",I=(null===C||void 0===C?void 0:C[T])||$a[T];void 0===I&&(null===_||void 0===_||_("003",lr(T)),T="default",I=$a.default);const A=!!(E.draggable||g&&"undefined"===typeof E.draggable),O=!!(E.selectable||m&&"undefined"===typeof E.selectable),R=!!(E.connectable||v&&"undefined"===typeof E.connectable),z=!!(E.focusable||y&&"undefined"===typeof E.focusable),F=Ui(),P=lo(E),B=function(t){let{node:n,nodeType:r,hasDimensions:o,resizeObserver:i}=t;const a=Ui(),s=(0,e.useRef)(null),l=(0,e.useRef)(null),c=(0,e.useRef)(n.sourcePosition),d=(0,e.useRef)(n.targetPosition),u=(0,e.useRef)(r),p=o&&!!n.internals.handleBounds;return(0,e.useEffect)(()=>{!s.current||n.hidden||p&&l.current===s.current||(l.current&&(null===i||void 0===i||i.unobserve(l.current)),null===i||void 0===i||i.observe(s.current),l.current=s.current)},[p,n.hidden]),(0,e.useEffect)(()=>()=>{l.current&&(null===i||void 0===i||i.unobserve(l.current),l.current=null)},[]),(0,e.useEffect)(()=>{if(s.current){const e=u.current!==r,t=c.current!==n.sourcePosition,o=d.current!==n.targetPosition;(e||t||o)&&(u.current=r,c.current=n.sourcePosition,d.current=n.targetPosition,a.getState().updateNodeInternals(new Map([[n.id,{id:n.id,nodeElement:s.current,force:!0}]])))}},[n.id,r,n.sourcePosition,n.targetPosition]),s}({node:E,nodeType:T,hasDimensions:P,resizeObserver:x}),L=Va({nodeRef:B,disabled:E.hidden||!A,noDragClassName:b,handleSelector:E.dragHandle,nodeId:i,isSelectable:O,nodeClickDistance:j}),N=Wa();if(E.hidden)return null;const U=so(E),V=function(e){var t,n,r,o,i,a,s,l,c,d;return void 0===e.internals.handleBounds?{width:null!==(i=null!==(a=e.width)&&void 0!==a?a:e.initialWidth)&&void 0!==i?i:null===(s=e.style)||void 0===s?void 0:s.width,height:null!==(l=null!==(c=e.height)&&void 0!==c?c:e.initialHeight)&&void 0!==l?l:null===(d=e.style)||void 0===d?void 0:d.height}:{width:null!==(t=e.width)&&void 0!==t?t:null===(n=e.style)||void 0===n?void 0:n.width,height:null!==(r=e.height)&&void 0!==r?r:null===(o=e.style)||void 0===o?void 0:o.height}}(E),W=O||A||a||l||u||p,H=l?e=>l(e,s({},D.userNode)):void 0,G=u?e=>u(e,s({},D.userNode)):void 0,X=p?e=>p(e,s({},D.userNode)):void 0,Y=h?e=>h(e,s({},D.userNode)):void 0,q=f?e=>f(e,s({},D.userNode)):void 0;return(0,c.jsx)("div",s(s({className:d(["react-flow__node","react-flow__node-".concat(T),{[w]:A},E.className,{selected:E.selected,selectable:O,parent:M,draggable:A,dragging:L}]),ref:B,style:s(s({zIndex:D.z,transform:"translate(".concat(D.positionAbsolute.x,"px,").concat(D.positionAbsolute.y,"px)"),pointerEvents:W?"all":"none",visibility:P?"visible":"hidden"},E.style),V),"data-id":i,"data-testid":"rf__node-".concat(i),onMouseEnter:H,onMouseMove:G,onMouseLeave:X,onContextMenu:Y,onClick:e=>{const{selectNodesOnDrag:t,nodeDragThreshold:n}=F.getState();O&&(!t||!A||n>0)&&Ua({id:i,store:F,nodeRef:B}),a&&a(e,s({},D.userNode))},onDoubleClick:q,onKeyDown:z?e=>{if(!vo(e.nativeEvent)&&!S)if(br.includes(e.key)&&O){const t="Escape"===e.key;Ua({id:i,store:F,unselect:t,nodeRef:B})}else if(A&&E.selected&&Object.prototype.hasOwnProperty.call(Za,e.key)){e.preventDefault();const{ariaLabelConfig:t}=F.getState();F.setState({ariaLiveMessage:t["node.a11yDescription.ariaLiveMessage"]({direction:e.key.replace("Arrow","").toLowerCase(),x:~~D.positionAbsolute.x,y:~~D.positionAbsolute.y})}),N({direction:Za[e.key],factor:e.shiftKey?4:1})}}:void 0,tabIndex:z?0:void 0,onFocus:z?()=>{var e;if(S||null===(e=B.current)||void 0===e||!e.matches(":focus-visible"))return;const{transform:t,width:n,height:r,autoPanOnNodeFocus:o,setCenter:a}=F.getState();if(!o)return;zr(new Map([[i,E]]),{x:0,y:0,width:n,height:r},t,!0).length>0||a(E.position.x+U.width/2,E.position.y+U.height/2,{zoom:t[2]})}:void 0,role:null!==(n=E.ariaRole)&&void 0!==n?n:z?"group":void 0,"aria-roledescription":"node","aria-describedby":S?void 0:"".concat(Hi,"-").concat(k),"aria-label":E.ariaLabel},E.domAttributes),{},{children:(0,c.jsx)(Ga,{value:i,children:(0,c.jsx)(I,s({id:i,data:E.data,type:T,positionAbsoluteX:D.positionAbsolute.x,positionAbsoluteY:D.positionAbsolute.y,selected:null!==(r=E.selected)&&void 0!==r&&r,selectable:O,draggable:A,deletable:null===(o=E.deletable)||void 0===o||o,isConnectable:R,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:L,dragHandle:E.dragHandle,zIndex:D.z,parentId:E.parentId},U))})}))}const ss=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function ls(t){const{nodesDraggable:n,nodesConnectable:r,nodesFocusable:o,elementsSelectable:i,onError:a}=Ni(ss,Di),s=rs(t.onlyRenderVisibleElements),l=function(){const t=Ni(is),[n]=(0,e.useState)(()=>"undefined"===typeof ResizeObserver?null:new ResizeObserver(e=>{const n=new Map;e.forEach(e=>{const t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),t(n)}));return(0,e.useEffect)(()=>()=>{null===n||void 0===n||n.disconnect()},[n]),n}();return(0,c.jsx)("div",{className:"react-flow__nodes",style:Oa,children:s.map(e=>(0,c.jsx)(as,{id:e,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:l,nodesDraggable:n,nodesConnectable:r,nodesFocusable:o,elementsSelectable:i,nodeClickDistance:t.nodeClickDistance,onError:a},e))})}ls.displayName="NodeRenderer";const cs=(0,e.memo)(ls);const ds={[Er.Arrow]:e=>{let{color:t="none",strokeWidth:n=1}=e;return(0,c.jsx)("polyline",{style:{stroke:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"})},[Er.ArrowClosed]:e=>{let{color:t="none",strokeWidth:n=1}=e;return(0,c.jsx)("polyline",{style:{stroke:t,fill:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}};const us=t=>{let{id:n,type:r,color:o,width:i=12.5,height:a=12.5,markerUnits:s="strokeWidth",strokeWidth:l,orient:d="auto-start-reverse"}=t;const u=function(t){const n=Ui();return(0,e.useMemo)(()=>{var e,r;return Object.prototype.hasOwnProperty.call(ds,t)?ds[t]:(null===(e=(r=n.getState()).onError)||void 0===e||e.call(r,"009",pr(t)),null)},[t])}(r);return u?(0,c.jsx)("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(i),markerHeight:"".concat(a),viewBox:"-10 -10 20 20",markerUnits:s,orient:d,refX:"0",refY:"0",children:(0,c.jsx)(u,{color:o,strokeWidth:l})}):null},ps=t=>{let{defaultColor:n,rfId:r}=t;const o=Ni(e=>e.edges),i=Ni(e=>e.defaultEdgeOptions),a=(0,e.useMemo)(()=>{const e=function(e,t){let{id:n,defaultColor:r,defaultMarkerStart:o,defaultMarkerEnd:i}=t;const a=new Set;return e.reduce((e,t)=>([t.markerStart||o,t.markerEnd||i].forEach(t=>{if(t&&"object"===typeof t){const o=Po(t,n);a.has(o)||(e.push(s({id:o,color:t.color||r},t)),a.add(o))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}(o,{id:r,defaultColor:n,defaultMarkerStart:null===i||void 0===i?void 0:i.markerStart,defaultMarkerEnd:null===i||void 0===i?void 0:i.markerEnd});return e},[o,i,r,n]);return a.length?(0,c.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,c.jsx)("defs",{children:a.map(e=>(0,c.jsx)(us,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};ps.displayName="MarkerDefinitions";var hs=(0,e.memo)(ps);function fs(t){let{x:n,y:r,label:o,labelStyle:i,labelShowBg:a=!0,labelBgStyle:u,labelBgPadding:p=[2,4],labelBgBorderRadius:h=2,children:f,className:g}=t,m=l(t,Ai);const[v,y]=(0,e.useState)({x:1,y:0,width:0,height:0}),x=d(["react-flow__edge-textwrapper",g]),b=(0,e.useRef)(null);return(0,e.useEffect)(()=>{if(b.current){const e=b.current.getBBox();y({x:e.x,y:e.y,width:e.width,height:e.height})}},[o]),o?(0,c.jsxs)("g",s(s({transform:"translate(".concat(n-v.width/2," ").concat(r-v.height/2,")"),className:x,visibility:v.width?"visible":"hidden"},m),{},{children:[a&&(0,c.jsx)("rect",{width:v.width+2*p[0],x:-p[0],y:-p[1],height:v.height+2*p[1],className:"react-flow__edge-textbg",style:u,rx:h,ry:h}),(0,c.jsx)("text",{className:"react-flow__edge-text",y:v.height/2,dy:"0.3em",ref:b,style:i,children:o}),f]})):null}fs.displayName="EdgeText";const gs=(0,e.memo)(fs);function ms(e){let{path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h,interactionWidth:f=20}=e,g=l(e,Oi);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("path",s(s({},g),{},{d:t,fill:"none",className:d(["react-flow__edge-path",g.className])})),f&&(0,c.jsx)("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),o&&Jr(n)&&Jr(r)?(0,c.jsx)(gs,{x:n,y:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h}):null]})}function vs(e){let{pos:t,x1:n,y1:r,x2:o,y2:i}=e;return t===Dr.Left||t===Dr.Right?[.5*(n+o),r]:[n,.5*(r+i)]}function ys(e){let{sourceX:t,sourceY:n,sourcePosition:r=Dr.Bottom,targetX:o,targetY:i,targetPosition:a=Dr.Top}=e;const[s,l]=vs({pos:r,x1:t,y1:n,x2:o,y2:i}),[c,d]=vs({pos:a,x1:o,y1:i,x2:t,y2:n}),[u,p,h,f]=wo({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:d});return["M".concat(t,",").concat(n," C").concat(s,",").concat(l," ").concat(c,",").concat(d," ").concat(o,",").concat(i),u,p,h,f]}function xs(t){return(0,e.memo)(e=>{let{id:n,sourceX:r,sourceY:o,targetX:i,targetY:a,sourcePosition:s,targetPosition:l,label:d,labelStyle:u,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:v,markerStart:y,interactionWidth:x}=e;const[b,w,S]=ys({sourceX:r,sourceY:o,sourcePosition:s,targetX:i,targetY:a,targetPosition:l}),k=t.isInternal?void 0:n;return(0,c.jsx)(ms,{id:k,path:b,labelX:w,labelY:S,label:d,labelStyle:u,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:v,markerStart:y,interactionWidth:x})})}const bs=xs({isInternal:!1}),ws=xs({isInternal:!0});function Ss(t){return(0,e.memo)(e=>{let{id:n,sourceX:r,sourceY:o,targetX:i,targetY:a,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h,style:f,sourcePosition:g=Dr.Bottom,targetPosition:m=Dr.Top,markerEnd:v,markerStart:y,pathOptions:x,interactionWidth:b}=e;const[w,S,k]=Ao({sourceX:r,sourceY:o,sourcePosition:g,targetX:i,targetY:a,targetPosition:m,borderRadius:null===x||void 0===x?void 0:x.borderRadius,offset:null===x||void 0===x?void 0:x.offset}),C=t.isInternal?void 0:n;return(0,c.jsx)(ms,{id:C,path:w,labelX:S,labelY:k,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:v,markerStart:y,interactionWidth:b})})}bs.displayName="SimpleBezierEdge",ws.displayName="SimpleBezierEdgeInternal";const ks=Ss({isInternal:!1}),Cs=Ss({isInternal:!0});function js(t){return(0,e.memo)(n=>{var r;let{id:o}=n,i=l(n,Ri);const a=t.isInternal?void 0:o;return(0,c.jsx)(ks,s(s({},i),{},{id:a,pathOptions:(0,e.useMemo)(()=>{var e;return{borderRadius:0,offset:null===(e=i.pathOptions)||void 0===e?void 0:e.offset}},[null===(r=i.pathOptions)||void 0===r?void 0:r.offset])}))})}ks.displayName="SmoothStepEdge",Cs.displayName="SmoothStepEdgeInternal";const _s=js({isInternal:!1}),Es=js({isInternal:!0});function Ds(t){return(0,e.memo)(e=>{let{id:n,sourceX:r,sourceY:o,targetX:i,targetY:a,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:v}=e;const[y,x,b]=Do({sourceX:r,sourceY:o,targetX:i,targetY:a}),w=t.isInternal?void 0:n;return(0,c.jsx)(ms,{id:w,path:y,labelX:x,labelY:b,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:u,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:v})})}_s.displayName="StepEdge",Es.displayName="StepEdgeInternal";const Ms=Ds({isInternal:!1}),Ts=Ds({isInternal:!0});function Is(t){return(0,e.memo)(e=>{let{id:n,sourceX:r,sourceY:o,targetX:i,targetY:a,sourcePosition:s=Dr.Bottom,targetPosition:l=Dr.Top,label:d,labelStyle:u,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:v,markerStart:y,pathOptions:x,interactionWidth:b}=e;const[w,S,k]=Co({sourceX:r,sourceY:o,sourcePosition:s,targetX:i,targetY:a,targetPosition:l,curvature:null===x||void 0===x?void 0:x.curvature}),C=t.isInternal?void 0:n;return(0,c.jsx)(ms,{id:C,path:w,labelX:S,labelY:k,label:d,labelStyle:u,labelShowBg:p,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:v,markerStart:y,interactionWidth:b})})}Ms.displayName="StraightEdge",Ts.displayName="StraightEdgeInternal";const As=Is({isInternal:!1}),Os=Is({isInternal:!0});As.displayName="BezierEdge",Os.displayName="BezierEdgeInternal";const Rs={default:Os,straight:Ts,step:Es,smoothstep:Cs,simplebezier:ws},zs={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Fs=(e,t,n)=>n===Dr.Left?e-t:n===Dr.Right?e+t:e,Ps=(e,t,n)=>n===Dr.Top?e-t:n===Dr.Bottom?e+t:e,Bs="react-flow__edgeupdater";function Ls(e){let{position:t,centerX:n,centerY:r,radius:o=10,onMouseDown:i,onMouseEnter:a,onMouseOut:s,type:l}=e;return(0,c.jsx)("circle",{onMouseDown:i,onMouseEnter:a,onMouseOut:s,className:d([Bs,"".concat(Bs,"-").concat(l)]),cx:Fs(n,o,t),cy:Ps(r,o,t),r:o,stroke:"transparent",fill:"transparent"})}function Ns(e){let{isReconnectable:t,reconnectRadius:n,edge:r,sourceX:o,sourceY:i,targetX:a,targetY:s,sourcePosition:l,targetPosition:d,onReconnect:u,onReconnectStart:p,onReconnectEnd:h,setReconnecting:f,setUpdateHover:g}=e;const m=Ui(),v=(e,t)=>{if(0!==e.button)return;const{autoPanOnConnect:n,domNode:o,isValidConnection:i,connectionMode:a,connectionRadius:s,lib:l,onConnectStart:c,onConnectEnd:d,cancelConnection:g,nodeLookup:v,rfId:y,panBy:x,updateConnection:b}=m.getState(),w="target"===t.type;ni.onPointerDown(e.nativeEvent,{autoPanOnConnect:n,connectionMode:a,connectionRadius:s,domNode:o,handleId:t.id,nodeId:t.nodeId,nodeLookup:v,isTarget:w,edgeUpdaterType:t.type,lib:l,flowId:y,cancelConnection:g,panBy:x,isValidConnection:i,onConnect:e=>null===u||void 0===u?void 0:u(r,e),onConnectStart:(n,o)=>{f(!0),null===p||void 0===p||p(e,r,t.type),null===c||void 0===c||c(n,o)},onConnectEnd:d,onReconnectEnd:(e,n)=>{f(!1),null===h||void 0===h||h(e,r,t.type,n)},updateConnection:b,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold})},y=()=>g(!0),x=()=>g(!1);return(0,c.jsxs)(c.Fragment,{children:[(!0===t||"source"===t)&&(0,c.jsx)(Ls,{position:l,centerX:o,centerY:i,radius:n,onMouseDown:e=>{var t;return v(e,{nodeId:r.target,id:null!==(t=r.targetHandle)&&void 0!==t?t:null,type:"target"})},onMouseEnter:y,onMouseOut:x,type:"source"}),(!0===t||"target"===t)&&(0,c.jsx)(Ls,{position:d,centerX:a,centerY:s,radius:n,onMouseDown:e=>{var t;return v(e,{nodeId:r.source,id:null!==(t=r.sourceHandle)&&void 0!==t?t:null,type:"source"})},onMouseEnter:y,onMouseOut:x,type:"target"})]})}function Us(t){var n,r;let{id:o,edgesFocusable:i,edgesReconnectable:a,elementsSelectable:l,onClick:u,onDoubleClick:p,onContextMenu:h,onMouseEnter:f,onMouseMove:g,onMouseLeave:m,reconnectRadius:v,onReconnect:y,onReconnectStart:x,onReconnectEnd:b,rfId:w,edgeTypes:S,noPanClassName:k,onError:C,disableKeyboardA11y:j}=t,_=Ni(e=>e.edgeLookup.get(o));const E=Ni(e=>e.defaultEdgeOptions);_=E?s(s({},E),_):_;let D=_.type||"default",M=(null===S||void 0===S?void 0:S[D])||Rs[D];void 0===M&&(null===C||void 0===C||C("011",gr(D)),D="default",M=Rs.default);const T=!!(_.focusable||i&&"undefined"===typeof _.focusable),I="undefined"!==typeof y&&(_.reconnectable||a&&"undefined"===typeof _.reconnectable),A=!!(_.selectable||l&&"undefined"===typeof _.selectable),O=(0,e.useRef)(null),[R,z]=(0,e.useState)(!1),[F,P]=(0,e.useState)(!1),B=Ui(),{zIndex:L,sourceX:N,sourceY:U,targetX:V,targetY:W,sourcePosition:H,targetPosition:G}=Ni((0,e.useCallback)(e=>{const t=e.nodeLookup.get(_.source),n=e.nodeLookup.get(_.target);if(!t||!n)return s({zIndex:_.zIndex},zs);const r=function(e){var t,n,r,o;const{sourceNode:i,targetNode:a}=e;if(!Oo(i)||!Oo(a))return null;const s=i.internals.handleBounds||Ro(i.handles),l=a.internals.handleBounds||Ro(a.handles),c=Fo(null!==(t=null===s||void 0===s?void 0:s.source)&&void 0!==t?t:[],e.sourceHandle),d=Fo(e.connectionMode===Sr.Strict?null!==(n=null===l||void 0===l?void 0:l.target)&&void 0!==n?n:[]:(null!==(r=null===l||void 0===l?void 0:l.target)&&void 0!==r?r:[]).concat(null!==(o=null===l||void 0===l?void 0:l.source)&&void 0!==o?o:[]),e.targetHandle);var u;if(!c||!d)return null===(u=e.onError)||void 0===u||u.call(e,"008",hr(c?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const p=(null===c||void 0===c?void 0:c.position)||Dr.Bottom,h=(null===d||void 0===d?void 0:d.position)||Dr.Top,f=zo(i,c,p),g=zo(a,d,h);return{sourceX:f.x,sourceY:f.y,targetX:g.x,targetY:g.y,sourcePosition:p,targetPosition:h}}({id:o,sourceNode:t,targetNode:n,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:e.connectionMode,onError:C}),i=function(e){let{sourceNode:t,targetNode:n,selected:r=!1,zIndex:o,elevateOnSelect:i=!1}=e;return void 0!==o?o:(i&&r?1e3:0)+Math.max(t.parentId?t.internals.z:0,n.parentId?n.internals.z:0)}({selected:_.selected,zIndex:_.zIndex,sourceNode:t,targetNode:n,elevateOnSelect:e.elevateEdgesOnSelect});return s({zIndex:i},r||zs)},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),Di),X=(0,e.useMemo)(()=>_.markerStart?"url('#".concat(Po(_.markerStart,w),"')"):void 0,[_.markerStart,w]),Y=(0,e.useMemo)(()=>_.markerEnd?"url('#".concat(Po(_.markerEnd,w),"')"):void 0,[_.markerEnd,w]);if(_.hidden||null===N||null===U||null===V||null===W)return null;const q=p?e=>{p(e,s({},_))}:void 0,Z=h?e=>{h(e,s({},_))}:void 0,$=f?e=>{f(e,s({},_))}:void 0,K=g?e=>{g(e,s({},_))}:void 0,J=m?e=>{m(e,s({},_))}:void 0;return(0,c.jsx)("svg",{style:{zIndex:L},children:(0,c.jsxs)("g",s(s({className:d(["react-flow__edge","react-flow__edge-".concat(D),_.className,k,{selected:_.selected,animated:_.animated,inactive:!A&&!u,updating:R,selectable:A}]),onClick:e=>{const{addSelectedEdges:t,unselectNodesAndEdges:n,multiSelectionActive:r}=B.getState();var i;A&&(B.setState({nodesSelectionActive:!1}),_.selected&&r?(n({nodes:[],edges:[_]}),null===(i=O.current)||void 0===i||i.blur()):t([o]));u&&u(e,_)},onDoubleClick:q,onContextMenu:Z,onMouseEnter:$,onMouseMove:K,onMouseLeave:J,onKeyDown:T?e=>{if(!j&&br.includes(e.key)&&A){const{unselectNodesAndEdges:n,addSelectedEdges:r}=B.getState();var t;if("Escape"===e.key)null===(t=O.current)||void 0===t||t.blur(),n({edges:[_]});else r([o])}}:void 0,tabIndex:T?0:void 0,role:null!==(n=_.ariaRole)&&void 0!==n?n:T?"group":"img","aria-roledescription":"edge","data-id":o,"data-testid":"rf__edge-".concat(o),"aria-label":null===_.ariaLabel?void 0:_.ariaLabel||"Edge from ".concat(_.source," to ").concat(_.target),"aria-describedby":T?"".concat(Gi,"-").concat(w):void 0,ref:O},_.domAttributes),{},{children:[!F&&(0,c.jsx)(M,{id:o,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:A,deletable:null===(r=_.deletable)||void 0===r||r,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:N,sourceY:U,targetX:V,targetY:W,sourcePosition:H,targetPosition:G,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:X,markerEnd:Y,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),I&&(0,c.jsx)(Ns,{edge:_,isReconnectable:I,reconnectRadius:v,onReconnect:y,onReconnectStart:x,onReconnectEnd:b,sourceX:N,sourceY:U,targetX:V,targetY:W,sourcePosition:H,targetPosition:G,setUpdateHover:z,setReconnecting:P})]}))})}const Vs=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Ws(t){let{defaultMarkerColor:n,onlyRenderVisibleElements:r,rfId:o,edgeTypes:i,noPanClassName:a,onReconnect:s,onEdgeContextMenu:l,onEdgeMouseEnter:d,onEdgeMouseMove:u,onEdgeMouseLeave:p,onEdgeClick:h,reconnectRadius:f,onEdgeDoubleClick:g,onReconnectStart:m,onReconnectEnd:v,disableKeyboardA11y:y}=t;const{edgesFocusable:x,edgesReconnectable:b,elementsSelectable:w,onError:S}=Ni(Vs,Di),k=function(t){const n=Ni((0,e.useCallback)(e=>{if(!t)return e.edges.map(e=>e.id);const n=[];if(e.width&&e.height)for(const t of e.edges){const r=e.nodeLookup.get(t.source),o=e.nodeLookup.get(t.target);r&&o&&_o({sourceNode:r,targetNode:o,width:e.width,height:e.height,transform:e.transform})&&n.push(t.id)}return n},[t]),Di);return n}(r);return(0,c.jsxs)("div",{className:"react-flow__edges",children:[(0,c.jsx)(hs,{defaultColor:n,rfId:o}),k.map(e=>(0,c.jsx)(Us,{id:e,edgesFocusable:x,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:s,onContextMenu:l,onMouseEnter:d,onMouseMove:u,onMouseLeave:p,onClick:h,reconnectRadius:f,onDoubleClick:g,onReconnectStart:m,onReconnectEnd:v,rfId:o,onError:S,edgeTypes:i,disableKeyboardA11y:y},e))]})}Ws.displayName="EdgeRenderer";const Hs=(0,e.memo)(Ws),Gs=e=>"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")");function Xs(e){let{children:t}=e;const n=Ni(Gs);return(0,c.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:n},children:t})}const Ys=e=>{var t;return null===(t=e.panZoom)||void 0===t?void 0:t.syncViewport};function qs(e){return e.connection.inProgress?s(s({},e.connection),{},{to:to(e.connection.to,e.transform)}):s({},e.connection)}function Zs(e){const t=function(e){if(e){const t=t=>{const n=qs(t);return e(n)};return t}return qs}(e);return Ni(t,Di)}const $s=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ks(e){let{containerStyle:t,style:n,type:r,component:o}=e;const{nodesConnectable:i,width:a,height:s,isValid:l,inProgress:u}=Ni($s,Di);return!!(a&&i&&u)?(0,c.jsx)("svg",{style:t,width:a,height:s,className:"react-flow__connectionline react-flow__container",children:(0,c.jsx)("g",{className:d(["react-flow__connection",Tr(l)]),children:(0,c.jsx)(Js,{style:n,type:r,CustomComponent:o,isValid:l})})}):null}const Js=e=>{let{style:t,type:n=_r.Bezier,CustomComponent:r,isValid:o}=e;const{inProgress:i,from:a,fromNode:l,fromHandle:d,fromPosition:u,to:p,toNode:h,toHandle:f,toPosition:g}=Zs();if(!i)return;if(r)return(0,c.jsx)(r,{connectionLineType:n,connectionLineStyle:t,fromNode:l,fromHandle:d,fromX:a.x,fromY:a.y,toX:p.x,toY:p.y,fromPosition:u,toPosition:g,connectionStatus:Tr(o),toNode:h,toHandle:f});let m="";const v={sourceX:a.x,sourceY:a.y,sourcePosition:u,targetX:p.x,targetY:p.y,targetPosition:g};switch(n){case _r.Bezier:[m]=Co(v);break;case _r.SimpleBezier:[m]=ys(v);break;case _r.Step:[m]=Ao(s(s({},v),{},{borderRadius:0}));break;case _r.SmoothStep:[m]=Ao(v);break;default:[m]=Do(v)}return(0,c.jsx)("path",{d:m,fill:"none",className:"react-flow__connection-path",style:t})};Js.displayName="ConnectionLine";const Qs={};function el(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qs;(0,e.useRef)(t),Ui();(0,e.useEffect)(()=>{},[t])}function tl(t){let{nodeTypes:n,edgeTypes:r,onInit:o,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:u,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:f,onSelectionStart:g,onSelectionEnd:m,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:x,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:S,selectionMode:k,multiSelectionKeyCode:C,panActivationKeyCode:j,zoomActivationKeyCode:_,deleteKeyCode:E,onlyRenderVisibleElements:D,elementsSelectable:M,defaultViewport:T,translateExtent:I,minZoom:A,maxZoom:O,preventScrolling:R,defaultMarkerColor:z,zoomOnScroll:F,zoomOnPinch:P,panOnScroll:B,panOnScrollSpeed:L,panOnScrollMode:N,zoomOnDoubleClick:U,panOnDrag:V,onPaneClick:W,onPaneMouseEnter:H,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneScroll:Y,onPaneContextMenu:q,paneClickDistance:Z,nodeClickDistance:$,onEdgeContextMenu:K,onEdgeMouseEnter:J,onEdgeMouseMove:Q,onEdgeMouseLeave:ee,reconnectRadius:te,onReconnect:ne,onReconnectStart:re,onReconnectEnd:oe,noDragClassName:ie,noWheelClassName:ae,noPanClassName:se,disableKeyboardA11y:le,nodeExtent:ce,rfId:de,viewport:ue,onViewportChange:pe}=t;return el(n),el(r),Ui(),(0,e.useRef)(!1),(0,e.useEffect)(()=>{},[]),function(t){const n=Ta(),r=(0,e.useRef)(!1);(0,e.useEffect)(()=>{!r.current&&n.viewportInitialized&&t&&(setTimeout(()=>t(n),1),r.current=!0)},[t,n.viewportInitialized])}(o),function(t){const n=Ni(Ys),r=Ui();(0,e.useEffect)(()=>{t&&(null===n||void 0===n||n(t),r.setState({transform:[t.x,t.y,t.zoom]}))},[t,n])}(ue),(0,c.jsx)(ns,{onPaneClick:W,onPaneMouseEnter:H,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneContextMenu:q,onPaneScroll:Y,paneClickDistance:Z,deleteKeyCode:E,selectionKeyCode:w,selectionOnDrag:S,selectionMode:k,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:C,panActivationKeyCode:j,zoomActivationKeyCode:_,elementsSelectable:M,zoomOnScroll:F,zoomOnPinch:P,zoomOnDoubleClick:U,panOnScroll:B,panOnScrollSpeed:L,panOnScrollMode:N,panOnDrag:V,defaultViewport:T,translateExtent:I,minZoom:A,maxZoom:O,onSelectionContextMenu:f,preventScrolling:R,noDragClassName:ie,noWheelClassName:ae,noPanClassName:se,disableKeyboardA11y:le,onViewportChange:pe,isControlledViewport:!!ue,children:(0,c.jsxs)(Xs,{children:[(0,c.jsx)(Hs,{edgeTypes:r,onEdgeClick:a,onEdgeDoubleClick:l,onReconnect:ne,onReconnectStart:re,onReconnectEnd:oe,onlyRenderVisibleElements:D,onEdgeContextMenu:K,onEdgeMouseEnter:J,onEdgeMouseMove:Q,onEdgeMouseLeave:ee,reconnectRadius:te,defaultMarkerColor:z,noPanClassName:se,disableKeyboardA11y:le,rfId:de}),(0,c.jsx)(Ks,{style:y,type:v,component:x,containerStyle:b}),(0,c.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,c.jsx)(cs,{nodeTypes:n,onNodeClick:i,onNodeDoubleClick:s,onNodeMouseEnter:d,onNodeMouseMove:u,onNodeMouseLeave:p,onNodeContextMenu:h,nodeClickDistance:$,onlyRenderVisibleElements:D,noPanClassName:se,noDragClassName:ie,disableKeyboardA11y:le,nodeExtent:ce,rfId:de}),(0,c.jsx)("div",{className:"react-flow__viewport-portal"})]})})}tl.displayName="GraphView";const nl=(0,e.memo)(tl),rl=function(){var e,t;let{nodes:n,edges:r,defaultNodes:o,defaultEdges:i,width:a,height:l,fitView:c,fitViewOptions:d,minZoom:u=.5,maxZoom:p=2,nodeOrigin:h,nodeExtent:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const g=new Map,m=new Map,v=new Map,y=new Map,x=null!==(e=null!==i&&void 0!==i?i:r)&&void 0!==e?e:[],b=null!==(t=null!==o&&void 0!==o?o:n)&&void 0!==t?t:[],w=null!==h&&void 0!==h?h:[0,0],S=null!==f&&void 0!==f?f:xr;Xo(v,y,x);const k=Uo(b,g,m,{nodeOrigin:w,nodeExtent:S,elevateNodesOnSelect:!1});let C=[0,0,1];if(c&&a&&l){var j;const e=Rr(g,{filter:e=>!(!e.width&&!e.initialWidth||!e.height&&!e.initialHeight)}),{x:t,y:n,zoom:r}=oo(e,a,l,u,p,null!==(j=null===d||void 0===d?void 0:d.padding)&&void 0!==j?j:.1);C=[t,n,r]}return{rfId:"1",width:0,height:0,transform:C,nodes:b,nodesInitialized:k,nodeLookup:g,parentLookup:m,edges:x,edgeLookup:y,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==o,hasDefaultEdges:void 0!==i,panZoom:null,minZoom:u,maxZoom:p,translateExtent:xr,nodeExtent:S,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Sr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:w,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:null!==c&&void 0!==c&&c,fitViewOptions:d,fitViewResolver:null,connection:s({},jr),connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Qr,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:wr}},ol=e=>{let{nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:a,fitView:l,fitViewOptions:c,minZoom:d,maxZoom:u,nodeOrigin:p,nodeExtent:h}=e;return((e,t)=>e?Ei(e,t):Ei)((e,f)=>{async function g(){const{nodeLookup:t,panZoom:n,fitViewOptions:r,fitViewResolver:o,width:i,height:a,minZoom:s,maxZoom:l}=f();n&&(await Fr({nodes:t,width:i,height:a,panZoom:n,minZoom:s,maxZoom:l},r),null===o||void 0===o||o.resolve(!0),e({fitViewResolver:null}))}return s(s({},rl({nodes:t,edges:n,width:i,height:a,fitView:l,fitViewOptions:c,minZoom:d,maxZoom:u,nodeOrigin:p,nodeExtent:h,defaultNodes:r,defaultEdges:o})),{},{setNodes:t=>{const{nodeLookup:n,parentLookup:r,nodeOrigin:o,elevateNodesOnSelect:i,fitViewQueued:a}=f(),s=Uo(t,n,r,{nodeOrigin:o,nodeExtent:h,elevateNodesOnSelect:i,checkEquality:!0});a&&s?(g(),e({nodes:t,nodesInitialized:s,fitViewQueued:!1,fitViewOptions:void 0})):e({nodes:t,nodesInitialized:s})},setEdges:t=>{const{connectionLookup:n,edgeLookup:r}=f();Xo(n,r,t),e({edges:t})},setDefaultNodesAndEdges:(t,n)=>{if(t){const{setNodes:n}=f();n(t),e({hasDefaultNodes:!0})}if(n){const{setEdges:t}=f();t(n),e({hasDefaultEdges:!0})}},updateNodeInternals:t=>{const{triggerNodeChanges:n,nodeLookup:r,parentLookup:o,domNode:i,nodeOrigin:a,nodeExtent:l,debug:c,fitViewQueued:d}=f(),{changes:u,updatedInternals:p}=function(e,t,n,r,o,i){const a=null===r||void 0===r?void 0:r.querySelector(".xyflow__viewport");let l=!1;if(!a)return{changes:[],updatedInternals:l};const c=[],d=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(d.transform),p=[];for(const h of e.values()){const e=t.get(h.id);if(!e)continue;if(e.hidden){t.set(e.id,s(s({},e),{},{internals:s(s({},e.internals),{},{handleBounds:void 0})})),l=!0;continue}const r=fo(h.nodeElement),a=e.measured.width!==r.width||e.measured.height!==r.height;if(r.width&&r.height&&(a||!e.internals.handleBounds||h.force)){const d=h.nodeElement.getBoundingClientRect(),f=ao(e.extent)?e.extent:i;let{positionAbsolute:g}=e.internals;e.parentId&&"parent"===e.extent?g=Ur(g,r,t.get(e.parentId)):f&&(g=Nr(g,f,r));const m=s(s({},e),{},{measured:r,internals:s(s({},e.internals),{},{positionAbsolute:g,handleBounds:{source:bo("source",h.nodeElement,d,u,e.id),target:bo("target",h.nodeElement,d,u,e.id)}})});t.set(e.id,m),e.parentId&&Vo(m,t,n,{nodeOrigin:o}),l=!0,a&&(c.push({id:e.id,type:"dimensions",dimensions:r}),e.expandParent&&e.parentId&&p.push({id:e.id,parentId:e.parentId,rect:Yr(m,o)}))}}if(p.length>0){const e=Ho(p,t,n,o);c.push(...e)}return{changes:c,updatedInternals:l}}(t,r,o,i,a,l);p&&(!function(e,t,n){const r=No(Bo,n);for(const o of e.values())if(o.parentId)Vo(o,e,t,r);else{const e=Or(o,r.nodeOrigin),t=ao(o.extent)?o.extent:r.nodeExtent,n=Nr(e,t,so(o));o.internals.positionAbsolute=n}}(r,o,{nodeOrigin:a,nodeExtent:l}),d?(g(),e({fitViewQueued:!1,fitViewOptions:void 0})):e({}),(null===u||void 0===u?void 0:u.length)>0&&(c&&console.log("React Flow: trigger node changes",u),null===n||void 0===n||n(u)))},updateNodePositions:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[],r=[],{nodeLookup:o,triggerNodeChanges:i}=f();for(const[c,d]of e){const e=o.get(c),i=!!(null!==e&&void 0!==e&&e.expandParent&&null!==e&&void 0!==e&&e.parentId&&null!==d&&void 0!==d&&d.position),u={id:c,type:"position",position:i?{x:Math.max(0,d.position.x),y:Math.max(0,d.position.y)}:d.position,dragging:t};var a,l;if(i&&e.parentId)n.push({id:c,parentId:e.parentId,rect:s(s({},d.internals.positionAbsolute),{},{width:null!==(a=d.measured.width)&&void 0!==a?a:0,height:null!==(l=d.measured.height)&&void 0!==l?l:0})});r.push(u)}if(n.length>0){const{parentLookup:e,nodeOrigin:t}=f(),i=Ho(n,o,e,t);r.push(...i)}i(r)},triggerNodeChanges:e=>{const{onNodesChange:t,setNodes:n,nodes:r,hasDefaultNodes:o,debug:i}=f();if(null!==e&&void 0!==e&&e.length){if(o){n(va(e,r))}i&&console.log("React Flow: trigger node changes",e),null===t||void 0===t||t(e)}},triggerEdgeChanges:e=>{const{onEdgesChange:t,setEdges:n,edges:r,hasDefaultEdges:o,debug:i}=f();if(null!==e&&void 0!==e&&e.length){if(o){n(ya(e,r))}i&&console.log("React Flow: trigger edge changes",e),null===t||void 0===t||t(e)}},addSelectedNodes:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:r,triggerNodeChanges:o,triggerEdgeChanges:i}=f();if(t){return void o(e.map(e=>xa(e,!0)))}o(ba(r,new Set([...e]),!0)),i(ba(n))},addSelectedEdges:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:r,triggerNodeChanges:o,triggerEdgeChanges:i}=f();if(t){return void i(e.map(e=>xa(e,!0)))}i(ba(n,new Set([...e]))),o(ba(r,new Set,!0))},unselectNodesAndEdges:function(){let{nodes:e,edges:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{edges:n,nodes:r,nodeLookup:o,triggerNodeChanges:i,triggerEdgeChanges:a}=f(),s=t||n,l=(e||r).map(e=>{const t=o.get(e.id);return t&&(t.selected=!1),xa(e.id,!1)}),c=s.map(e=>xa(e.id,!1));i(l),a(c)},setMinZoom:t=>{const{panZoom:n,maxZoom:r}=f();null===n||void 0===n||n.setScaleExtent([t,r]),e({minZoom:t})},setMaxZoom:t=>{const{panZoom:n,minZoom:r}=f();null===n||void 0===n||n.setScaleExtent([r,t]),e({maxZoom:t})},setTranslateExtent:t=>{var n;null===(n=f().panZoom)||void 0===n||n.setTranslateExtent(t),e({translateExtent:t})},setPaneClickDistance:e=>{var t;null===(t=f().panZoom)||void 0===t||t.setClickDistance(e)},resetSelectedElements:()=>{const{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:r,elementsSelectable:o}=f();if(!o)return;const i=t.reduce((e,t)=>t.selected?[...e,xa(t.id,!1)]:e,[]),a=e.reduce((e,t)=>t.selected?[...e,xa(t.id,!1)]:e,[]);n(i),r(a)},setNodeExtent:t=>{const{nodes:n,nodeLookup:r,parentLookup:o,nodeOrigin:i,elevateNodesOnSelect:a,nodeExtent:s}=f();t[0][0]===s[0][0]&&t[0][1]===s[0][1]&&t[1][0]===s[1][0]&&t[1][1]===s[1][1]||(Uo(n,r,o,{nodeOrigin:i,nodeExtent:t,elevateNodesOnSelect:a,checkEquality:!1}),e({nodeExtent:t}))},panBy:e=>{const{transform:t,width:n,height:r,panZoom:o,translateExtent:i}=f();return async function(e){let{delta:t,panZoom:n,transform:r,translateExtent:o,width:i,height:a}=e;if(!n||!t.x&&!t.y)return Promise.resolve(!1);const s=await n.setViewportConstrained({x:r[0]+t.x,y:r[1]+t.y,zoom:r[2]},[[0,0],[i,a]],o),l=!!s&&(s.x!==r[0]||s.y!==r[1]||s.k!==r[2]);return Promise.resolve(l)}({delta:e,panZoom:o,transform:t,translateExtent:i,width:n,height:r})},setCenter:async(e,t,n)=>{const{width:r,height:o,maxZoom:i,panZoom:a}=f();if(!a)return Promise.resolve(!1);const s="undefined"!==typeof(null===n||void 0===n?void 0:n.zoom)?n.zoom:i;return await a.setViewport({x:r/2-e*s,y:o/2-t*s,zoom:s},{duration:null===n||void 0===n?void 0:n.duration,ease:null===n||void 0===n?void 0:n.ease,interpolate:null===n||void 0===n?void 0:n.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{e({connection:s({},jr)})},updateConnection:t=>{e({connection:t})},reset:()=>e(s({},rl()))})},Object.is)};function il(t){let{initialNodes:n,initialEdges:r,defaultNodes:o,defaultEdges:i,initialWidth:a,initialHeight:s,initialMinZoom:l,initialMaxZoom:d,initialFitViewOptions:u,fitView:p,nodeOrigin:h,nodeExtent:f,children:g}=t;const[m]=(0,e.useState)(()=>ol({nodes:n,edges:r,defaultNodes:o,defaultEdges:i,width:a,height:s,fitView:p,minZoom:l,maxZoom:d,fitViewOptions:u,nodeOrigin:h,nodeExtent:f}));return(0,c.jsx)(Bi,{value:m,children:(0,c.jsx)(Da,{children:g})})}function al(t){let{children:n,nodes:r,edges:o,defaultNodes:i,defaultEdges:a,width:s,height:l,fitView:d,fitViewOptions:u,minZoom:p,maxZoom:h,nodeOrigin:f,nodeExtent:g}=t;return(0,e.useContext)(Pi)?(0,c.jsx)(c.Fragment,{children:n}):(0,c.jsx)(il,{initialNodes:r,initialEdges:o,defaultNodes:i,defaultEdges:a,initialWidth:s,initialHeight:l,fitView:d,initialFitViewOptions:u,initialMinZoom:p,initialMaxZoom:h,nodeOrigin:f,nodeExtent:g,children:n})}const sl={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var ll=Ca(function(t,n){let{nodes:r,edges:o,defaultNodes:i,defaultEdges:a,className:u,nodeTypes:p,edgeTypes:h,onNodeClick:f,onEdgeClick:g,onInit:m,onMove:v,onMoveStart:y,onMoveEnd:x,onConnect:b,onConnectStart:w,onConnectEnd:S,onClickConnectStart:k,onClickConnectEnd:C,onNodeMouseEnter:j,onNodeMouseMove:_,onNodeMouseLeave:E,onNodeContextMenu:D,onNodeDoubleClick:M,onNodeDragStart:T,onNodeDrag:I,onNodeDragStop:A,onNodesDelete:O,onEdgesDelete:R,onDelete:z,onSelectionChange:F,onSelectionDragStart:P,onSelectionDrag:B,onSelectionDragStop:L,onSelectionContextMenu:N,onSelectionStart:U,onSelectionEnd:V,onBeforeDelete:W,connectionMode:H,connectionLineType:G=_r.Bezier,connectionLineStyle:X,connectionLineComponent:Y,connectionLineContainerStyle:q,deleteKeyCode:Z="Backspace",selectionKeyCode:$="Shift",selectionOnDrag:K=!1,selectionMode:J=Cr.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:ee=(io()?"Meta":"Control"),zoomActivationKeyCode:te=(io()?"Meta":"Control"),snapToGrid:ne,snapGrid:re,onlyRenderVisibleElements:oe=!1,selectNodesOnDrag:ie,nodesDraggable:ae,autoPanOnNodeFocus:se,nodesConnectable:le,nodesFocusable:ce,nodeOrigin:de=oa,edgesFocusable:ue,edgesReconnectable:pe,elementsSelectable:he=!0,defaultViewport:fe=ia,minZoom:ge=.5,maxZoom:me=2,translateExtent:ve=xr,preventScrolling:ye=!0,nodeExtent:xe,defaultMarkerColor:be="#b1b1b7",zoomOnScroll:we=!0,zoomOnPinch:Se=!0,panOnScroll:ke=!1,panOnScrollSpeed:Ce=.5,panOnScrollMode:je=kr.Free,zoomOnDoubleClick:_e=!0,panOnDrag:Ee=!0,onPaneClick:De,onPaneMouseEnter:Me,onPaneMouseMove:Te,onPaneMouseLeave:Ie,onPaneScroll:Ae,onPaneContextMenu:Oe,paneClickDistance:Re=0,nodeClickDistance:ze=0,children:Fe,onReconnect:Pe,onReconnectStart:Be,onReconnectEnd:Le,onEdgeContextMenu:Ne,onEdgeDoubleClick:Ue,onEdgeMouseEnter:Ve,onEdgeMouseMove:We,onEdgeMouseLeave:He,reconnectRadius:Ge=10,onNodesChange:Xe,onEdgesChange:Ye,noDragClassName:qe="nodrag",noWheelClassName:Ze="nowheel",noPanClassName:$e="nopan",fitView:Ke,fitViewOptions:Je,connectOnClick:Qe,attributionPosition:et,proOptions:tt,defaultEdgeOptions:nt,elevateNodesOnSelect:rt,elevateEdgesOnSelect:ot,disableKeyboardA11y:it=!1,autoPanOnConnect:at,autoPanOnNodeDrag:st,autoPanSpeed:lt,connectionRadius:ct,isValidConnection:dt,onError:ut,style:pt,id:ht,nodeDragThreshold:ft,connectionDragThreshold:gt,viewport:mt,onViewportChange:vt,width:yt,height:xt,colorMode:bt="light",debug:wt,onScroll:St,ariaLabelConfig:kt}=t,Ct=l(t,zi);const jt=ht||"1",_t=function(t){var n;const[r,o]=(0,e.useState)("system"===t?null:t);return(0,e.useEffect)(()=>{if("system"!==t)return void o(t);const e=da(),n=()=>o(null!==e&&void 0!==e&&e.matches?"dark":"light");return n(),null===e||void 0===e||e.addEventListener("change",n),()=>{null===e||void 0===e||e.removeEventListener("change",n)}},[t]),null!==r?r:null!==(n=da())&&void 0!==n&&n.matches?"dark":"light"}(bt),Et=(0,e.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),null===St||void 0===St||St(e)},[St]);return(0,c.jsx)("div",s(s({"data-testid":"rf__wrapper"},Ct),{},{onScroll:Et,style:s(s({},pt),sl),ref:n,className:d(["react-flow",u,_t]),id:ht,role:"application",children:(0,c.jsxs)(al,{nodes:r,edges:o,width:yt,height:xt,fitView:Ke,fitViewOptions:Je,minZoom:ge,maxZoom:me,nodeOrigin:de,nodeExtent:xe,children:[(0,c.jsx)(nl,{onInit:m,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:j,onNodeMouseMove:_,onNodeMouseLeave:E,onNodeContextMenu:D,onNodeDoubleClick:M,nodeTypes:p,edgeTypes:h,connectionLineType:G,connectionLineStyle:X,connectionLineComponent:Y,connectionLineContainerStyle:q,selectionKeyCode:$,selectionOnDrag:K,selectionMode:J,deleteKeyCode:Z,multiSelectionKeyCode:ee,panActivationKeyCode:Q,zoomActivationKeyCode:te,onlyRenderVisibleElements:oe,defaultViewport:fe,translateExtent:ve,minZoom:ge,maxZoom:me,preventScrolling:ye,zoomOnScroll:we,zoomOnPinch:Se,zoomOnDoubleClick:_e,panOnScroll:ke,panOnScrollSpeed:Ce,panOnScrollMode:je,panOnDrag:Ee,onPaneClick:De,onPaneMouseEnter:Me,onPaneMouseMove:Te,onPaneMouseLeave:Ie,onPaneScroll:Ae,onPaneContextMenu:Oe,paneClickDistance:Re,nodeClickDistance:ze,onSelectionContextMenu:N,onSelectionStart:U,onSelectionEnd:V,onReconnect:Pe,onReconnectStart:Be,onReconnectEnd:Le,onEdgeContextMenu:Ne,onEdgeDoubleClick:Ue,onEdgeMouseEnter:Ve,onEdgeMouseMove:We,onEdgeMouseLeave:He,reconnectRadius:Ge,defaultMarkerColor:be,noDragClassName:qe,noWheelClassName:Ze,noPanClassName:$e,rfId:jt,disableKeyboardA11y:it,nodeExtent:xe,viewport:mt,onViewportChange:vt}),(0,c.jsx)(ca,{nodes:r,edges:o,defaultNodes:i,defaultEdges:a,onConnect:b,onConnectStart:w,onConnectEnd:S,onClickConnectStart:k,onClickConnectEnd:C,nodesDraggable:ae,autoPanOnNodeFocus:se,nodesConnectable:le,nodesFocusable:ce,edgesFocusable:ue,edgesReconnectable:pe,elementsSelectable:he,elevateNodesOnSelect:rt,elevateEdgesOnSelect:ot,minZoom:ge,maxZoom:me,nodeExtent:xe,onNodesChange:Xe,onEdgesChange:Ye,snapToGrid:ne,snapGrid:re,connectionMode:H,translateExtent:ve,connectOnClick:Qe,defaultEdgeOptions:nt,fitView:Ke,fitViewOptions:Je,onNodesDelete:O,onEdgesDelete:R,onDelete:z,onNodeDragStart:T,onNodeDrag:I,onNodeDragStop:A,onSelectionDrag:B,onSelectionDragStart:P,onSelectionDragStop:L,onMove:v,onMoveStart:y,onMoveEnd:x,noPanClassName:$e,nodeOrigin:de,rfId:jt,autoPanOnConnect:at,autoPanOnNodeDrag:st,autoPanSpeed:lt,onError:ut,connectionRadius:ct,isValidConnection:dt,selectNodesOnDrag:ie,nodeDragThreshold:ft,connectionDragThreshold:gt,onBeforeDelete:W,paneClickDistance:Re,debug:wt,ariaLabelConfig:kt}),(0,c.jsx)(ra,{onSelectionChange:F}),Fe,(0,c.jsx)(Ki,{proOptions:tt,position:et}),(0,c.jsx)(Zi,{rfId:jt,disableKeyboardA11y:it})]})}))});const cl=e=>{var t;return null===(t=e.domNode)||void 0===t?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function dl(e){let{children:t}=e;const n=Ni(cl);return n?(0,Mi.createPortal)(t,n):null}vr();function ul(e){let{dimensions:t,lineWidth:n,variant:r,className:o}=e;return(0,c.jsx)("path",{strokeWidth:n,d:"M".concat(t[0]/2," 0 V").concat(t[1]," M0 ").concat(t[1]/2," H").concat(t[0]),className:d(["react-flow__background-pattern",r,o])})}function pl(e){let{radius:t,className:n}=e;return(0,c.jsx)("circle",{cx:t,cy:t,r:t,className:d(["react-flow__background-pattern","dots",n])})}var hl;!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(hl||(hl={}));const fl={[hl.Dots]:1,[hl.Lines]:1,[hl.Cross]:6},gl=e=>({transform:e.transform,patternId:"pattern-".concat(e.rfId)});function ml(t){let{id:n,variant:r=hl.Dots,gap:o=20,size:i,lineWidth:a=1,offset:l=0,color:u,bgColor:p,style:h,className:f,patternClassName:g}=t;const m=(0,e.useRef)(null),{transform:v,patternId:y}=Ni(gl,Di),x=i||fl[r],b=r===hl.Dots,w=r===hl.Cross,S=Array.isArray(o)?o:[o,o],k=[S[0]*v[2]||1,S[1]*v[2]||1],C=x*v[2],j=Array.isArray(l)?l:[l,l],_=w?[C,C]:k,E=[j[0]*v[2]||1+_[0]/2,j[1]*v[2]||1+_[1]/2],D="".concat(y).concat(n||"");return(0,c.jsxs)("svg",{className:d(["react-flow__background",f]),style:s(s(s({},h),Oa),{},{"--xy-background-color-props":p,"--xy-background-pattern-color-props":u}),ref:m,"data-testid":"rf__background",children:[(0,c.jsx)("pattern",{id:D,x:v[0]%k[0],y:v[1]%k[1],width:k[0],height:k[1],patternUnits:"userSpaceOnUse",patternTransform:"translate(-".concat(E[0],",-").concat(E[1],")"),children:b?(0,c.jsx)(pl,{radius:C/2,className:g}):(0,c.jsx)(ul,{dimensions:_,lineWidth:a,variant:r,className:g})}),(0,c.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(D,")")})]})}ml.displayName="Background";const vl=(0,e.memo)(ml);function yl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,c.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function xl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,c.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function bl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,c.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function wl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,c.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Sl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,c.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function kl(e){let{children:t,className:n}=e,r=l(e,Fi);return(0,c.jsx)("button",s(s({type:"button",className:d(["react-flow__controls-button",n])},r),{},{children:t}))}const Cl=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function jl(e){let{style:t,showZoom:n=!0,showFitView:r=!0,showInteractive:o=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:s,onFitView:l,onInteractiveChange:u,className:p,children:h,position:f="bottom-left",orientation:g="vertical","aria-label":m}=e;const v=Ui(),{isInteractive:y,minZoomReached:x,maxZoomReached:b,ariaLabelConfig:w}=Ni(Cl,Di),{zoomIn:S,zoomOut:k,fitView:C}=Ta(),j="horizontal"===g?"horizontal":"vertical";return(0,c.jsxs)($i,{className:d(["react-flow__controls",j,p]),position:f,style:t,"data-testid":"rf__controls","aria-label":null!==m&&void 0!==m?m:w["controls.ariaLabel"],children:[n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(kl,{onClick:()=>{S(),null===a||void 0===a||a()},className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:b,children:(0,c.jsx)(yl,{})}),(0,c.jsx)(kl,{onClick:()=>{k(),null===s||void 0===s||s()},className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:x,children:(0,c.jsx)(xl,{})})]}),r&&(0,c.jsx)(kl,{className:"react-flow__controls-fitview",onClick:()=>{C(i),null===l||void 0===l||l()},title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:(0,c.jsx)(bl,{})}),o&&(0,c.jsx)(kl,{className:"react-flow__controls-interactive",onClick:()=>{v.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),null===u||void 0===u||u(!y)},title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:y?(0,c.jsx)(Sl,{}):(0,c.jsx)(wl,{})}),h]})}jl.displayName="Controls";const _l=(0,e.memo)(jl);const El=(0,e.memo)(function(e){let{id:t,x:n,y:r,width:o,height:i,style:a,color:s,strokeColor:l,strokeWidth:u,className:p,borderRadius:h,shapeRendering:f,selected:g,onClick:m}=e;const{background:v,backgroundColor:y}=a||{},x=s||v||y;return(0,c.jsx)("rect",{className:d(["react-flow__minimap-node",{selected:g},p]),x:n,y:r,rx:h,ry:h,width:o,height:i,style:{fill:x,stroke:l,strokeWidth:u},shapeRendering:f,onClick:m?e=>m(e,t):void 0})}),Dl=e=>e.nodes.map(e=>e.id),Ml=e=>e instanceof Function?e:()=>e;const Tl=(0,e.memo)(function(e){let{id:t,nodeColorFunc:n,nodeStrokeColorFunc:r,nodeClassNameFunc:o,nodeBorderRadius:i,nodeStrokeWidth:a,shapeRendering:s,NodeComponent:l,onClick:d}=e;const{node:u,x:p,y:h,width:f,height:g}=Ni(e=>{const{internals:n}=e.nodeLookup.get(t),r=n.userNode,{x:o,y:i}=n.positionAbsolute,{width:a,height:s}=so(r);return{node:r,x:o,y:i,width:a,height:s}},Di);return u&&!u.hidden&&lo(u)?(0,c.jsx)(l,{x:p,y:h,width:f,height:g,style:u.style,selected:!!u.selected,className:o(u),color:n(u),borderRadius:i,strokeColor:r(u),strokeWidth:a,shapeRendering:s,onClick:d,id:u.id}):null});var Il=(0,e.memo)(function(e){let{nodeStrokeColor:t,nodeColor:n,nodeClassName:r="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:a=El,onClick:s}=e;const l=Ni(Dl,Di),d=Ml(n),u=Ml(t),p=Ml(r),h="undefined"===typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,c.jsx)(c.Fragment,{children:l.map(e=>(0,c.jsx)(Tl,{id:e,nodeColorFunc:d,nodeStrokeColorFunc:u,nodeClassNameFunc:p,nodeBorderRadius:o,nodeStrokeWidth:i,NodeComponent:a,onClick:s,shapeRendering:h},e))})});const Al=e=>!e.hidden,Ol=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Zr(Rr(e.nodeLookup,{filter:Al}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}};function Rl(t){var n,r;let{style:o,className:i,nodeStrokeColor:a,nodeColor:l,nodeClassName:u="",nodeBorderRadius:p=5,nodeStrokeWidth:h,nodeComponent:f,bgColor:g,maskColor:m,maskStrokeColor:v,maskStrokeWidth:y,position:x="bottom-right",onClick:b,onNodeClick:w,pannable:S=!1,zoomable:k=!1,ariaLabel:C,inversePan:j,zoomStep:_=10,offsetScale:E=5}=t;const D=Ui(),M=(0,e.useRef)(null),{boundingRect:T,viewBB:I,rfId:A,panZoom:O,translateExtent:R,flowWidth:z,flowHeight:F,ariaLabelConfig:P}=Ni(Ol,Di),B=null!==(n=null===o||void 0===o?void 0:o.width)&&void 0!==n?n:200,L=null!==(r=null===o||void 0===o?void 0:o.height)&&void 0!==r?r:150,N=T.width/B,U=T.height/L,V=Math.max(N,U),W=V*B,H=V*L,G=E*V,X=T.x-(W-T.width)/2-G,Y=T.y-(H-T.height)/2-G,q=W+2*G,Z=H+2*G,$="".concat("react-flow__minimap-desc","-").concat(A),K=(0,e.useRef)(0),J=(0,e.useRef)();K.current=V,(0,e.useEffect)(()=>{if(M.current&&O)return J.current=function(e){let{domNode:t,panZoom:n,getTransform:r,getViewScale:o}=e;const i=Te(t);return{update:function(e){let{translateExtent:t,width:a,height:s,zoomStep:l=10,pannable:c=!0,zoomable:d=!0,inversePan:u=!1}=e,p=[0,0];const h=er().on("start",e=>{var t,n;"mousedown"!==e.sourceEvent.type&&"touchstart"!==e.sourceEvent.type||(p=[null!==(t=e.sourceEvent.clientX)&&void 0!==t?t:e.sourceEvent.touches[0].clientX,null!==(n=e.sourceEvent.clientY)&&void 0!==n?n:e.sourceEvent.touches[0].clientY])}).on("zoom",c?e=>{var i,l;const c=r();if("mousemove"!==e.sourceEvent.type&&"touchmove"!==e.sourceEvent.type||!n)return;const d=[null!==(i=e.sourceEvent.clientX)&&void 0!==i?i:e.sourceEvent.touches[0].clientX,null!==(l=e.sourceEvent.clientY)&&void 0!==l?l:e.sourceEvent.touches[0].clientY],h=[d[0]-p[0],d[1]-p[1]];p=d;const f=o()*Math.max(c[2],Math.log(c[2]))*(u?-1:1),g={x:c[0]-h[0]*f,y:c[1]-h[1]*f},m=[[0,0],[a,s]];n.setViewportConstrained({x:g.x,y:g.y,zoom:c[2]},m,t)}:null).on("zoom.wheel",d?e=>{const t=r();if("wheel"!==e.sourceEvent.type||!n)return;const o=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*l,i=t[2]*Math.pow(2,o);n.scaleTo(i)}:null);i.call(h,{})},destroy:function(){i.on("zoom",null)},pointer:Ie}}({domNode:M.current,panZoom:O,getTransform:()=>D.getState().transform,getViewScale:()=>K.current}),()=>{var e;null===(e=J.current)||void 0===e||e.destroy()}},[O]),(0,e.useEffect)(()=>{var e;null===(e=J.current)||void 0===e||e.update({translateExtent:R,width:z,height:F,inversePan:j,pannable:S,zoomStep:_,zoomable:k})},[S,k,j,_,R,z,F]);const Q=b?e=>{var t;const[n,r]=(null===(t=J.current)||void 0===t?void 0:t.pointer(e))||[0,0];b(e,{x:n,y:r})}:void 0,ee=w?(0,e.useCallback)((e,t)=>{const n=D.getState().nodeLookup.get(t).internals.userNode;w(e,n)},[]):void 0,te=null!==C&&void 0!==C?C:P["minimap.ariaLabel"];return(0,c.jsx)($i,{position:x,style:s(s({},o),{},{"--xy-minimap-background-color-props":"string"===typeof g?g:void 0,"--xy-minimap-mask-background-color-props":"string"===typeof m?m:void 0,"--xy-minimap-mask-stroke-color-props":"string"===typeof v?v:void 0,"--xy-minimap-mask-stroke-width-props":"number"===typeof y?y*V:void 0,"--xy-minimap-node-background-color-props":"string"===typeof l?l:void 0,"--xy-minimap-node-stroke-color-props":"string"===typeof a?a:void 0,"--xy-minimap-node-stroke-width-props":"number"===typeof h?h:void 0}),className:d(["react-flow__minimap",i]),"data-testid":"rf__minimap",children:(0,c.jsxs)("svg",{width:B,height:L,viewBox:"".concat(X," ").concat(Y," ").concat(q," ").concat(Z),className:"react-flow__minimap-svg",role:"img","aria-labelledby":$,ref:M,onClick:Q,children:[te&&(0,c.jsx)("title",{id:$,children:te}),(0,c.jsx)(Il,{onClick:ee,nodeColor:l,nodeStrokeColor:a,nodeBorderRadius:p,nodeClassName:u,nodeStrokeWidth:h,nodeComponent:f}),(0,c.jsx)("path",{className:"react-flow__minimap-mask",d:"M".concat(X-G,",").concat(Y-G,"h").concat(q+2*G,"v").concat(Z+2*G,"h").concat(-q-2*G,"z\n        M").concat(I.x,",").concat(I.y,"h").concat(I.width,"v").concat(I.height,"h").concat(-I.width,"z"),fillRule:"evenodd",pointerEvents:"none"})]})})}Rl.displayName="MiniMap";const zl=(0,e.memo)(Rl),Fl={[ui.Line]:"right",[ui.Handle]:"bottom-right"};(0,e.memo)(function(t){let{nodeId:n,position:r,variant:o=ui.Handle,className:i,style:a,children:l,color:u,minWidth:p=10,minHeight:h=10,maxWidth:f=Number.MAX_VALUE,maxHeight:g=Number.MAX_VALUE,keepAspectRatio:m=!1,resizeDirection:v,autoScale:y=!0,shouldResize:x,onResizeStart:b,onResize:w,onResizeEnd:S}=t;const k=Xa(),C="string"===typeof n?n:k,j=Ui(),_=(0,e.useRef)(null),E=o===ui.Handle,D=Ni((0,e.useCallback)((M=E&&y,e=>M?"".concat(Math.max(1/e.transform[2],1)):void 0),[E,y]),Di);var M;const T=(0,e.useRef)(null),I=null!==r&&void 0!==r?r:Fl[o];(0,e.useEffect)(()=>{if(_.current&&C)return T.current||(T.current=xi({domNode:_.current,nodeId:C,getStoreItems:()=>{const{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:r,nodeOrigin:o,domNode:i}=j.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:r,nodeOrigin:o,paneDomNode:i}},onChange:(e,t)=>{const{triggerNodeChanges:n,nodeLookup:r,parentLookup:o,nodeOrigin:i}=j.getState(),a=[],l={x:e.x,y:e.y},c=r.get(C);if(c&&c.expandParent&&c.parentId){var d,u,p,h,f,g,m;const t=null!==(d=c.origin)&&void 0!==d?d:i,n=null!==(u=null!==(p=e.width)&&void 0!==p?p:c.measured.width)&&void 0!==u?u:0,v=null!==(h=null!==(f=e.height)&&void 0!==f?f:c.measured.height)&&void 0!==h?h:0,y=Ho([{id:c.id,parentId:c.parentId,rect:s({width:n,height:v},co({x:null!==(g=e.x)&&void 0!==g?g:c.position.x,y:null!==(m=e.y)&&void 0!==m?m:c.position.y},{width:n,height:v},c.parentId,r,t))}],r,o,i);a.push(...y),l.x=e.x?Math.max(t[0]*n,e.x):void 0,l.y=e.y?Math.max(t[1]*v,e.y):void 0}if(void 0!==l.x&&void 0!==l.y){const e={id:C,type:"position",position:s({},l)};a.push(e)}if(void 0!==e.width&&void 0!==e.height){const t={id:C,type:"dimensions",resizing:!0,setAttributes:!v||("horizontal"===v?"width":"height"),dimensions:{width:e.width,height:e.height}};a.push(t)}for(const v of t){const e=s(s({},v),{},{type:"position"});a.push(e)}n(a)},onEnd:e=>{let{width:t,height:n}=e;const r={id:C,type:"dimensions",resizing:!1,dimensions:{width:t,height:n}};j.getState().triggerNodeChanges([r])}})),T.current.update({controlPosition:I,boundaries:{minWidth:p,minHeight:h,maxWidth:f,maxHeight:g},keepAspectRatio:m,resizeDirection:v,onResizeStart:b,onResize:w,onResizeEnd:S,shouldResize:x}),()=>{var e;null===(e=T.current)||void 0===e||e.destroy()}},[I,p,h,f,g,m,b,w,S,x]);const A=I.split("-");return(0,c.jsx)("div",{className:d(["react-flow__resize-control","nodrag",...A,o,i]),ref:_,style:s(s({},a),{},{scale:D},u&&{[E?"backgroundColor":"borderColor"]:u}),children:l})});var Pl=n(3577),Bl=n.n(Pl);const Ll=(e,t,n,r,o)=>{const i=1-e;return Math.pow(i,3)*t+3*Math.pow(i,2)*e*n+3*i*Math.pow(e,2)*r+Math.pow(e,3)*o},Nl=t=>{let{id:n,sourceX:r,sourceY:o,targetX:i,targetY:a,sourcePosition:l,targetPosition:d,style:u={},data:p,source:h,target:f}=t;const g=(null===p||void 0===p?void 0:p.siblingIndex)||0,m=(null===p||void 0===p?void 0:p.siblingCount)||1,v=h===f,y=(null===p||void 0===p?void 0:p.offsetY)||0,x="#2563eb",b=null===p||void 0===p?void 0:p.text,w=(null===p||void 0===p?void 0:p.effectsText)&&""!==p.effectsText.trim(),S=b||w,{path:k,labelX:C,labelY:j}=(0,e.useMemo)(()=>{const e=50*(g-(m-1)/2),[t,n,s]=(e=>{let{sourceX:t,sourceY:n,sourcePosition:r,targetX:o,targetY:i,targetPosition:a,offset:s=0,isSelfLoop:l=!1,loopIndex:c=0}=e;if(l){const e=350+60*c,r={x:t+e,y:n+100},a={x:o+e,y:i-100};return["M".concat(t,",").concat(n," C").concat(r.x,",").concat(r.y," ").concat(a.x,",").concat(a.y," ").concat(o,",").concat(i),Ll(.5,t,r.x,a.x,o),Ll(.5,n,r.y,a.y,i)]}const d=o-t,u=i-n,p=Math.abs(d),h=Math.abs(u),f=p>h,g=.4*(f?p:h);let m={x:t,y:n},v={x:o,y:i};switch(r){case"top":m.y-=g;break;case"bottom":m.y+=g;break;case"left":m.x-=g;break;case"right":m.x+=g}switch(a){case"top":v.y-=g;break;case"bottom":v.y+=g;break;case"left":v.x-=g;break;case"right":v.x+=g}return f?(m.y+=s,v.y+=s):(m.x+=s,v.x+=s),["M".concat(t,",").concat(n," C").concat(m.x,",").concat(m.y," ").concat(v.x,",").concat(v.y," ").concat(o,",").concat(i),Ll(.5,t,m.x,v.x,o),Ll(.5,n,m.y,v.y,i)]})({sourceX:r,sourceY:o,sourcePosition:l,targetX:i,targetY:a,targetPosition:d,offset:e,isSelfLoop:v,loopIndex:g});return{path:t,labelX:n,labelY:s}},[r,o,i,a,l,d,g,m,v]),_=(0,e.useMemo)(()=>s(s({},u),{},{strokeWidth:3,stroke:x,strokeDasharray:"none",animation:"none",transition:"none",fill:"none"}),[u,x]),E={position:"absolute",transform:"translate(-50%, -50%) translate(".concat(Math.round(C),"px,").concat(Math.round(j+y),"px)"),background:w?"#dbeafe":"#f1f5f9",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",textAlign:"center",color:"#0f172a",pointerEvents:"all",zIndex:10,border:"1px solid #cbd5e1",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",maxWidth:"150px",willChange:"transform"};return console.log("Edge render:",n),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ms,{id:n,path:k,style:_,markerEnd:"url(#global-arrow-blue)"}),S&&(0,c.jsx)(dl,{children:(0,c.jsxs)("div",{style:E,className:"nodrag nopan edge-label-container",children:[b&&(0,c.jsx)("div",{style:{fontWeight:600},children:p.text}),w&&(0,c.jsx)("div",{style:{fontSize:"10px",color:"#475569",marginTop:"4px",borderTop:"1px solid #cbd5e1",paddingTop:"2px"},className:"edge-effects-list",children:p.effectsText.split(",").map((e,t)=>(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"3px"},children:[(0,c.jsx)("span",{style:{fontSize:"6px",color:"#2563eb"},children:"\u25cf"}),(0,c.jsx)("span",{children:e.trim()})]},t))})]})})]})},Ul=(0,e.memo)(Nl);async function Vl(e){const t=await fetch("/api/stories/".concat(e));if(!t.ok)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u0442\u043e\u0440\u0438\u0439");return await t.json()}async function Wl(e,t){const n=await fetch("/api/stories/".concat(e,"/").concat(t,"/delete"),{method:"DELETE"});if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e")}return await n.json()}async function Hl(e,t,n,r){try{await fetch("/api/html_story_settings/".concat(t,"/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(o){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430",o)}}async function Gl(e,t,n){try{const e=await fetch("/api/html/saves/".concat(t,"/").concat(n));return e.ok?await e.json():{}}catch(r){return console.error("Error loading saves",r),{}}}async function Xl(e,t,n,r){console.log("[apiUpdateFragmentText] Posting text:",JSON.stringify(r)),await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/text"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})})}async function Yl(e,t){try{const n=await fetch("/api/story/".concat(e,"/").concat(t,"/effects"));if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u0438")}return await n.json()}catch(n){return console.error("[apiGetStoryEffects] \u041e\u0448\u0438\u0431\u043a\u0430:",n),[]}}async function ql(e,t,n,r){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/media"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:r})});if(!o.ok){const e=await o.json();throw new Error(e.error||"Failed to update media")}return await o.json()}async function Zl(e,t){const n=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks"));return n.ok?await n.json():(console.error("Could not load bookmarks"),{})}async function $l(e,t,n,r,o){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/choice"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s({source:n,choiceIndex:r},o))});if(!i.ok){const{error:e}=await i.json();throw new Error(e)}return await i.json()}const Kl=t=>{let{id:n,data:r,selected:o}=t;const[i,a]=(0,e.useState)(!1),[s,l]=(0,e.useState)(!1),{cleanMainText:d,idLine:u,firstPhotoSrc:p}=(0,e.useMemo)(()=>{const[e,...t]=(r.label||"").split("\n"),n=t.join("\n");let o=(i=n)?i.replace(/<[^>]+>/g,"").replace(/<\/?[^>]+(>|$)/g,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"):"";var i;o.length>1500&&(o=o.substring(0,1500)+"...\n(\u0442\u0435\u043a\u0441\u0442 \u043e\u0431\u0440\u0435\u0437\u0430\u043d)");const a=(r.media||[]).find(e=>"photo"===e.type);let s=null;return a&&(a.url?s=a.url:a.file_id&&(s="/api/tgfile/".concat(a.file_id))),{cleanMainText:o,idLine:e,firstPhotoSrc:s}},[r.label,r.media]),h=(0,e.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),a(!1),!r.userId||!r.storyId||!r.updateNodeInternal)return alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u0423 \u043d\u043e\u0434\u044b \u043d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 (userId/storyId) \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."),void console.error("Missing context in node data:",r);const t=r.media||[];if(t.length>=10)return void alert("\u041b\u0438\u043c\u0438\u0442: \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 10 \u043c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u043e\u0432.");const o=Array.from(e.dataTransfer.files);if(0===o.length)return;const i=o.slice(0,10-t.length);l(!0);try{const e=[];for(const t of i){const n=new FormData;n.append("file",t),n.append("user_id",r.userId);const o=await fetch("/api/upload_media",{method:"POST",body:n}),i=await o.json();o.ok&&i.file_id?e.push(i):console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438:",i.error)}if(e.length>0){const o=[...t,...e];await ql(r.userId,r.storyId,n,o),r.updateNodeInternal(n,{media:o})}}catch(s){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 Drop \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435:",s),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u043e\u0432.")}finally{l(!1)}},[r,n]);return(0,c.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),i||a(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),a(!1)},onDrop:h,style:{backgroundColor:r.bgColor||"#ffffff",color:"black",padding:10,borderRadius:10,minWidth:300,maxWidth:300,textAlign:"center",boxShadow:i?"0 0 0 4px #10b981, 0 4px 12px rgba(0,0,0,0.3)":"0 4px 12px rgba(0, 0, 0, 0.3)",border:o?"2px solid #3b82f6":i?"2px solid #10b981":"none",transition:"all 0.2s",whiteSpace:"normal",wordBreak:"break-word",overflowWrap:"break-word",position:"relative"},children:[s&&(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",color:"#2563eb",fontWeight:"bold"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),i&&!s&&(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(16, 185, 129, 0.15)",zIndex:9,pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)("span",{style:{background:"#10b981",color:"white",padding:"6px 12px",borderRadius:6,fontWeight:"bold",fontSize:"14px"},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430"})}),(0,c.jsx)("div",{style:{backgroundColor:"rgba(31, 41, 55, 0.8)",color:"white",padding:"4px 8px",borderRadius:6,marginBottom:8,fontWeight:"bold",fontSize:"20px"},children:u}),(0,c.jsx)("div",{style:{whiteSpace:"pre-wrap",textAlign:"left",wordBreak:"break-word",fontSize:18,marginBottom:p?8:0},children:d}),p&&(0,c.jsx)("img",{src:p,alt:"media",style:{width:"100%",height:"auto",objectFit:"cover",borderRadius:6,display:"block"},onError:e=>e.target.style.display="none"}),(0,c.jsx)(qa,{type:"target",position:Dr.Top,style:{visibility:"hidden"}}),(0,c.jsxs)("div",{style:{position:"absolute",bottom:"-10px",left:"50%",transform:"translateX(-50%)",width:60,height:60,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,c.jsx)(qa,{type:"source",position:Dr.Bottom,style:{width:"70px",height:"70px",borderRadius:"50%",opacity:0,position:"absolute",top:"5px"}}),(0,c.jsx)("div",{style:{width:34,height:34,borderRadius:"50%",background:"#3b82f6",border:"3px solid white",boxShadow:"0 0 5px 3px rgba(59,130,246,.7)",pointerEvents:"none",zIndex:2,transform:"translateY(50px)"}})]})]})},Jl=(0,e.memo)(t=>{let{data:n,id:r}=t;const{getNode:o}=Ta(),i=(0,e.useCallback)(e=>{e.preventDefault();const t=o(r);t&&window.dispatchEvent(new CustomEvent("noteRightClick",{detail:{event:e,node:t}}))},[r,o]),a=n.text||"",s=a.length>1e3?"".concat(a.slice(0,1e3),"..."):a;return(0,c.jsx)("div",{style:{background:"#fffacd",border:"1px solid #f0e68c",borderRadius:"5px",padding:"10px",fontSize:"18px",color:"#333",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)",width:400,height:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word"},onContextMenu:i,dangerouslySetInnerHTML:{__html:s}})}),Ql=Jl;function ec(t){let{x:n,y:r}=t;const o=(0,e.useRef)(null),[i,a]=(0,e.useState)({position:"fixed",top:r,left:n,opacity:0,pointerEvents:"none",zIndex:9999});return(0,e.useLayoutEffect)(()=>{const e=o.current;if(!e)return;const t=()=>{const t=e.getBoundingClientRect(),{innerWidth:o,innerHeight:i}=window;let s=n,l=r;t.width>0&&t.height>0&&(n+t.width>o&&(s=n-t.width),s<10&&(s=10),r+t.height>i&&(l=r-t.height),l<10&&(l=10)),a({position:"fixed",top:l,left:s,opacity:1,pointerEvents:"auto",transition:"opacity 0.1s ease-in",zIndex:9999})};t();const i=new ResizeObserver(()=>{t()});return i.observe(e),()=>i.disconnect()},[n,r]),{ref:o,style:i}}var tc=n(9461);function nc(e){this.content=e}nc.prototype={constructor:nc,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new nc(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new nc(n)},addToStart:function(e,t){return new nc([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new nc(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new nc(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=nc.from(e)).size?new nc(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=nc.from(e)).size?new nc(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=nc.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},nc.from=function(e){if(e instanceof nc)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new nc(t)};const rc=nc;function oc(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let e=0;o.text[e]==i.text[e];e++)n++;return n}if(o.content.size||i.content.size){let e=oc(o.content,i.content,n+1);if(null!=e)return e}n+=o.nodeSize}else n+=o.nodeSize}}function ic(e,t,n,r){for(let o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let a=e.child(--o),s=t.child(--i),l=a.nodeSize;if(a!=s){if(!a.sameMarkup(s))return{a:n,b:r};if(a.isText&&a.text!=s.text){let e=0,t=Math.min(a.text.length,s.text.length);for(;e<t&&a.text[a.text.length-e-1]==s.text[s.text.length-e-1];)e++,n--,r--;return{a:n,b:r}}if(a.content.size||s.content.size){let e=ic(a.content,s.content,n-1,r-1);if(e)return e}n-=l,r-=l}else n-=l,r-=l}}class ac{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;for(let i=0,a=0;a<t;i++){let s=this.content[i],l=a+s.nodeSize;if(l>e&&!1!==n(s,r+a,o||null,i)&&s.content.size){let o=a+1;s.nodesBetween(Math.max(0,e-o),Math.min(s.content.size,t-o),n,r+o)}a=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(a,s)=>{let l=a.isText?a.text.slice(Math.max(e,s)-s,t-s):a.isLeaf?r?"function"===typeof r?r(a):r:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&l||a.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new ac(r,this.size+e.size)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let a=this.content[o],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),n.push(a),r+=a.nodeSize),i=s}return new ac(n,r)}cutByIndex(e,t){return e==t?ac.empty:0==e&&t==this.content.length?this:new ac(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new ac(r,o)}addToStart(e){return new ac([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ac(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e){return oc(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}findDiffEnd(e){return ic(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size)}findIndex(e){if(0==e)return lc(0,e);if(e==this.size)return lc(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let t=0,n=0;;t++){let r=n+this.child(t).nodeSize;if(r>=e)return r==e?lc(t+1,r):lc(t,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return ac.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new ac(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ac.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new ac(t||e,n)}static from(e){if(!e)return ac.empty;if(e instanceof ac)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ac([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ac.empty=new ac([],0);const sc={index:0,offset:0};function lc(e,t){return sc.index=e,sc.offset=t,sc}function cc(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!cc(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!cc(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class dc{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&cc(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return dc.none;if(e instanceof dc)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}dc.none=[];class uc extends Error{}class pc{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=fc(this.content,e+this.openStart,t);return n&&new pc(n,this.openStart,this.openEnd)}removeBetween(e,t){return new pc(hc(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return pc.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new pc(ac.fromJSON(e,t.content),n,r)}static maxOpen(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,r=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)r++;return new pc(e,n,r)}}function hc(e,t,n){let{index:r,offset:o}=e.findIndex(t),i=e.maybeChild(r),{index:a,offset:s}=e.findIndex(n);if(o==t||i.isText){if(s!=n&&!e.child(a).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=a)throw new RangeError("Removing non-flat range");return e.replaceChild(r,i.copy(hc(i.content,t-o-1,n-o-1)))}function fc(e,t,n,r){let{index:o,offset:i}=e.findIndex(t),a=e.maybeChild(o);if(i==t||a.isText)return r&&!r.canReplace(o,o,n)?null:e.cut(0,t).append(n).append(e.cut(t));let s=fc(a.content,t-i-1,n,a);return s&&e.replaceChild(o,a.copy(s))}function gc(e,t,n){if(n.openStart>e.depth)throw new uc("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new uc("Inconsistent open depths");return mc(e,t,n,0)}function mc(e,t,n,r){let o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){let a=mc(e,t,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){let{start:o,end:a}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let o=n-1;o>=0;o--)r=t.node(o).copy(ac.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return wc(i,Sc(e,o,a,t,r))}{let r=e.parent,o=r.content;return wc(r,o.cut(0,e.parentOffset).append(n.content).append(o.cut(t.parentOffset)))}}return wc(i,kc(e,t,r))}function vc(e,t){if(!t.type.compatibleContent(e.type))throw new uc("Cannot join "+t.type.name+" onto "+e.type.name)}function yc(e,t,n){let r=e.node(n);return vc(r,t.node(n)),r}function xc(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function bc(e,t,n,r){let o=(t||e).node(n),i=0,a=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(xc(e.nodeAfter,r),i++));for(let s=i;s<a;s++)xc(o.child(s),r);t&&t.depth==n&&t.textOffset&&xc(t.nodeBefore,r)}function wc(e,t){return e.type.checkContent(t),e.copy(t)}function Sc(e,t,n,r,o){let i=e.depth>o&&yc(e,t,o+1),a=r.depth>o&&yc(n,r,o+1),s=[];return bc(null,e,o,s),i&&a&&t.index(o)==n.index(o)?(vc(i,a),xc(wc(i,Sc(e,t,n,r,o+1)),s)):(i&&xc(wc(i,kc(e,t,o+1)),s),bc(t,n,o,s),a&&xc(wc(a,kc(n,r,o+1)),s)),bc(r,null,o,s),new ac(s)}function kc(e,t,n){let r=[];if(bc(null,e,n,r),e.depth>n){xc(wc(yc(e,t,n+1),kc(e,t,n+1)),r)}return bc(t,null,n,r),new ac(r)}pc.empty=new pc(ac.empty,0,0);class Cc{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let o=0;o<e;o++)r+=n.child(o).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return dc.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new Dc(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(o),a=o-t;if(n.push(i,e,r+t),!a)break;if(i=i.child(e),i.isText)break;o=a-1,r+=t+1}return new Cc(t,n,o)}static resolveCached(e,t){let n=Ec.get(e);if(n)for(let o=0;o<n.elts.length;o++){let e=n.elts[o];if(e.pos==t)return e}else Ec.set(e,n=new jc);let r=n.elts[n.i]=Cc.resolve(e,t);return n.i=(n.i+1)%_c,r}}class jc{constructor(){this.elts=[],this.i=0}}const _c=12,Ec=new WeakMap;class Dc{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Mc=Object.create(null);class Tc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:dc.none;this.type=e,this.attrs=t,this.marks=r,this.content=n||ac.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&cc(this.attrs,t||e.defaultAttrs||Mc)&&dc.sameSet(this.marks,n||dc.none)}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e==this.content?this:new Tc(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Tc(this.type,this.attrs,this.content,e)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return pc.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),a=r.start(i),s=r.node(i).content.cut(r.pos-a,o.pos-a);return new pc(s,r.depth-i,o.depth-i)}replace(e,t,n){return gc(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return Cc.resolveCached(this,e)}resolveNoCache(e){return Cc.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Ac(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ac.empty,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.childCount,i=this.contentMatchAt(e).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let s=r;s<o;s++)if(!this.type.allowsMarks(n.child(s).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=dc.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!dc.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(e=>e.type.name)));this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=ac.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,n);return o.type.checkAttrs(o.attrs),o}}Tc.prototype.text=void 0;class Ic extends Tc{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ac(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ic(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ic(this.type,this.attrs,e,this.marks)}cut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Ac(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class Oc{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new Rc(e,t);if(null==n.next)return Oc.empty;let r=zc(n);n.next&&n.err("Unexpected trailing text");let o=function(e){let t=Object.create(null);return n(Uc(e,0));function n(r){let o=[];r.forEach(t=>{e[t].forEach(t=>{let n,{term:r,to:i}=t;if(r){for(let e=0;e<o.length;e++)o[e][0]==r&&(n=o[e][1]);Uc(e,i).forEach(e=>{n||o.push([r,n=[]]),-1==n.indexOf(e)&&n.push(e)})}})});let i=t[r.join(",")]=new Oc(r.indexOf(e.length-1)>-1);for(let e=0;e<o.length;e++){let r=o[e][1].sort(Nc);i.next.push({type:o[e][0],next:t[r.join(",")]||n(r)})}return i}}(function(e){let t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}function i(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(i(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let a=n();return r(t,a),o(i(e.expr,a),a),[r(a)]}if("plus"==e.type){let a=n();return o(i(e.expr,t),a),o(i(e.expr,a),a),[r(a)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){let a=t;for(let t=0;t<e.min;t++){let t=n();o(i(e.expr,a),t),a=t}if(-1==e.max)o(i(e.expr,a),a);else for(let t=e.min;t<e.max;t++){let t=n();r(a,t),o(i(e.expr,a),t),a=t}return[r(a)]}if("name"==e.type)return[r(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let a=i(e.exprs[r],t);if(r==e.exprs.length-1)return a;o(a,t=n())}}}(r));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:a}=e.next[t];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(a)&&r.push(a)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[this];return function o(i,a){let s=i.matchFragment(e,n);if(s&&(!t||s.validEnd))return ac.from(a.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let e=o(n,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:a}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!a.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let o=0;o<t.next.length;o++)r+=(o?", ":"")+t.next[o].type.name+"->"+e.indexOf(t.next[o].next);return r}).join("\n")}}Oc.empty=new Oc(!0);class Rc{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function zc(e){let t=[];do{t.push(Fc(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Fc(e){let t=[];do{t.push(Pc(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Pc(e){let t=function(e){if(e.eat("(")){let t=zc(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let i in n){let e=n[i];e.isInGroup(t)&&o.push(e)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Lc(e,t)}return t}function Bc(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function Lc(e,t){let n=Bc(e),r=n;return e.eat(",")&&(r="}"!=e.next?Bc(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Nc(e,t){return t-e}function Uc(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(Nc)}function Vc(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function Wc(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=t.default}n[r]=o}return n}function Hc(e,t,n,r){for(let o in t)if(!(o in e))throw new RangeError("Unsupported attribute ".concat(o," for ").concat(n," of type ").concat(o));for(let o in e){let n=e[o];n.validate&&n.validate(t[o])}}function Gc(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new Yc(e,r,t[r]);return n}class Xc{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Gc(e,n.attrs),this.defaultAttrs=Vc(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Oc.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Wc(this.attrs,e)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Tc(this,this.computeAttrs(e),ac.from(t),dc.setFrom(n))}createChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return t=ac.from(t),this.checkContent(t),new Tc(this,this.computeAttrs(e),t,dc.setFrom(n))}createAndFill(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=ac.from(t),t.size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(ac.empty,!0);return o?new Tc(this,e,t.append(o),dc.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}checkAttrs(e){Hc(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:dc.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new Xc(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class Yc{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError("Expected value of type ".concat(r," for attribute ").concat(t," on type ").concat(e,", got ").concat(o))}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class qc{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=Gc(e,r.attrs),this.excluded=null;let o=Vc(this.attrs);this.instance=o?new dc(this,o):null}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new dc(this,Wc(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new qc(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Hc(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Zc{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=rc.from(e.nodes),t.marks=rc.from(e.marks||{}),this.nodes=Xc.compile(this.spec.nodes,this),this.marks=qc.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let e=this.nodes[r],t=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=Oc.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?$c(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let r in this.marks){let e=this.marks[r],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:$c(this,t.split(" "))}this.nodeFromJSON=e=>Tc.fromJSON(this,e),this.markFromJSON=e=>dc.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Xc))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new Ic(n,n.defaultAttrs,e,dc.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function $c(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],a=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(a=r)}if(!a)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class Kc{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new rd(this,t,!1);return n.addAll(e,dc.none,t.from,t.to),n.finish()}parseSlice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new rd(this,t,!0);return n.addAll(e,dc.none,t.from,t.to),pc.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(od(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(e)||r.context&&!n.matchesContext(r.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let r in e.marks){let t=e.marks[r].spec.parseDOM;t&&t.forEach(e=>{n(e=id(e)),e.mark||e.ignore||e.clearMark||(e.mark=r)})}for(let r in e.nodes){let t=e.nodes[r].spec.parseDOM;t&&t.forEach(e=>{n(e=id(e)),e.node||e.ignore||e.mark||(e.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Kc(e,Kc.schemaRules(e)))}}const Jc={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Qc={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ed={ol:!0,ul:!0};function td(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class nd{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=dc.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(ac.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=ac.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(ac.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Jc.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class rd{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=t.topNode,i=td(null,t.preserveWhitespace,0)|(n?4:0);r=o?new nd(o.type,o.attrs,dc.none,!0,t.topMatch||o.type.contentMatch,i):new nd(n?null:e.schema.topNodeType,null,dc.none,!0,null,i),this.nodes=[r],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,{schema:i}=this.parser;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(i.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,a=e.nodeName.toLowerCase();ed.hasOwnProperty(a)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&ed.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));e:if(s?s.ignore:Qc.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let n,r=this.needsBlock;if(Jc.hasOwnProperty(a))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=s&&s.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,s,n,!1===s.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let e=this.parser.matchedStyles[r],o=n.getPropertyValue(e);if(o)for(let n;;){let r=this.parser.matchStyle(e,o,this,n);if(!r)break;if(r.ignore)return null;if(t=r.clearMark?t.filter(e=>!r.clearMark(e)):t.concat(this.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming)break;n=r}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,a=null==r?null:e.childNodes[r];i!=a;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let i=this.open,a=0;i>=0;i--){let t=this.nodes[i],s=t.findWrapping(e);if(s&&(!r||r.length>s.length+a)&&(r=s,o=t,!s.length))break;if(t.solid){if(n)break;a+=2}}if(!r)return null;this.sync(o);for(let i=0;i<r.length;i++)t=this.enterInner(r[i],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=dc.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):ad(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let a=td(e,o,i.options);4&i.options&&0==i.content.length&&(a|=4);let s=dc.none;return n=n.filter(t=>!(i.type?i.type.allowsMarkType(t.type):ad(t.type,e))||(s=t.addToSet(s),!1)),this.nodes.push(new nd(e,t,s,r,null,a)),this.open++,n}closeExtra(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)){t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(e,a)=>{for(;e>=0;e--){let s=t[e];if(""==s){if(e==t.length-1||0==e)continue;for(;a>=o;a--)if(i(e-1,a))return!0;return!1}{let e=a>0||0==a&&r?this.nodes[a].type:n&&a>=o?n.node(a-o).type:null;if(!e||e.name!=s&&!e.isInGroup(s))return!1;a--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function od(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function id(e){let t={};for(let n in e)t[n]=e[n];return t}function ad(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],a=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t)return!0;if(i.indexOf(o)<0&&a(o))return!0}};if(a(o.contentMatch))return!0}}class sd{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;n||(n=cd(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],a=this.serializeMark(n,e.isInline,t);a&&(o.push([n,r]),r.appendChild(a.dom),r=a.contentDOM||a.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=pd(cd(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.marks[e.type.name];return r&&pd(cd(n),r(e,t),null,e.attrs)}static renderSpec(e,t){return pd(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new sd(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=ld(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return ld(e.marks)}}function ld(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function cd(e){return e.document||window.document}const dd=new WeakMap;function ud(e){let t=dd.get(e);return void 0===t&&dd.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function pd(e,t,n,r){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let o,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=ud(r))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a,s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let l=n?e.createElementNS(n,i):e.createElement(i),c=t[1],d=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){d=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let u=d;u<t.length;u++){let o=t[u];if(0===o){if(u<t.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=pd(e,o,n,r);if(l.appendChild(t),i){if(a)throw new RangeError("Multiple content holes");a=i}}}return{dom:l,contentDOM:a}}const hd=Math.pow(2,16);function fd(e,t){return e+t*hd}function gd(e){return 65535&e}class md{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class vd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges=e,this.inverted=t,!e.length&&vd.empty)return vd.empty}recover(e){let t=0,n=gd(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/hd}(e)}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}_map(e,t,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let s=this.ranges[a]-(this.inverted?r:0);if(s>e)break;let l=this.ranges[a+o],c=this.ranges[a+i],d=s+l;if(e<=d){let o=s+r+((l?e==s?-1:e==d?1:t:t)<0?0:c);if(n)return o;let i=e==(t<0?s:d)?null:fd(a/3,e-s),u=e==s?2:e==d?1:4;return(t<0?e!=s:e!=d)&&(u|=8),new md(o,u,i)}r+=c-l}return n?e+r:new md(e+r,0,null)}touches(e,t){let n=0,r=gd(t),o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let t=this.ranges[a]-(this.inverted?n:0);if(t>e)break;let s=this.ranges[a+o];if(e<=t+s&&a==3*r)return!0;n+=this.ranges[a+i]-s}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],a=i-(this.inverted?o:0),s=i+(this.inverted?0:o),l=this.ranges[r+t],c=this.ranges[r+n];e(a,a+l,s,s+c),o+=c-l}}invert(){return new vd(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?vd.empty:new vd(e<0?[0,-e,0]:[0,0,e])}}vd.empty=new vd([]);class yd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e?e.length:0;this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new yd(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new yd;return e.appendMappingInverted(this),e}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let o=this.from;o<this.to;o++){let n=this._maps[o].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(o);if(null!=t&&t>o&&t<this.to){o=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return n?e:new md(e,r,null)}}const xd=Object.create(null);class bd{getMap(){return vd.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=xd[t.stepType];if(!n)throw new RangeError("No step type ".concat(t.stepType," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in xd)throw new RangeError("Duplicate use of step JSON ID "+e);return xd[e]=t,t.prototype.jsonID=e,t}}class wd{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new wd(e,null)}static fail(e){return new wd(null,e)}static fromReplace(e,t,n,r){try{return wd.ok(e.replace(t,n,r))}catch(o){if(o instanceof uc)return wd.fail(o.message);throw o}}}function Sd(e,t,n){let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.size&&(i=i.copy(Sd(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return ac.fromArray(r)}class kd extends bd{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new pc(Sd(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return wd.fromReplace(e,this.from,this.to,o)}invert(){return new Cd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new kd(t.pos,n.pos,this.mark)}merge(e){return e instanceof kd&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new kd(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new kd(t.from,t.to,e.markFromJSON(t.mark))}}bd.jsonID("addMark",kd);class Cd extends bd{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new pc(Sd(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return wd.fromReplace(e,this.from,this.to,n)}invert(){return new kd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Cd(t.pos,n.pos,this.mark)}merge(e){return e instanceof Cd&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Cd(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Cd(t.from,t.to,e.markFromJSON(t.mark))}}bd.jsonID("removeMark",Cd);class jd extends bd{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return wd.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return wd.fromReplace(e,this.pos,this.pos+1,new pc(ac.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new jd(this.pos,t.marks[n]);return new jd(this.pos,this.mark)}}return new _d(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new jd(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new jd(t.pos,e.markFromJSON(t.mark))}}bd.jsonID("addNodeMark",jd);class _d extends bd{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return wd.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return wd.fromReplace(e,this.pos,this.pos+1,new pc(ac.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new jd(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _d(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new _d(t.pos,e.markFromJSON(t.mark))}}bd.jsonID("removeNodeMark",_d);class Ed extends bd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&Md(e,this.from,this.to)?wd.fail("Structure replace would overwrite content"):wd.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new vd([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ed(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new Ed(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ed)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?pc.empty:new pc(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ed(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?pc.empty:new pc(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ed(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ed(t.from,t.to,pc.fromJSON(e,t.slice),!!t.structure)}}bd.jsonID("replace",Ed);class Dd extends bd{constructor(e,t,n,r,o,i){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=a}apply(e){if(this.structure&&(Md(e,this.from,this.gapFrom)||Md(e,this.gapTo,this.to)))return wd.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return wd.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?wd.fromReplace(e,this.from,this.to,n):wd.fail("Content does not fit in gap")}getMap(){return new vd([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Dd(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new Dd(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Dd(t.from,t.to,t.gapFrom,t.gapTo,pc.fromJSON(e,t.slice),t.insert,!!t.structure)}}function Md(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function Td(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.contentMatch,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=e.doc.nodeAt(t),a=[],s=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=s+t.nodeSize,d=r.matchType(t.type);if(d){r=d;for(let r=0;r<t.marks.length;r++)n.allowsMarkType(t.marks[r].type)||e.step(new Cd(s,c,t.marks[r]));if(o&&t.isText&&"pre"!=n.whitespace){let e,r,o=/\r?\n|\r/g;for(;e=o.exec(t.text);)r||(r=new pc(ac.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),a.push(new Ed(s+e.index,s+e.index+e[0].length,r))}}else a.push(new Ed(s,c,pc.empty));s=c}if(!r.validEnd){let t=r.fillBefore(ac.empty,!0);e.replace(s,s,new pc(t,0,0))}for(let l=a.length-1;l>=0;l--)e.step(a[l])}function Id(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function Ad(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,r=0,o=0;;--n){let i=e.$from.node(n),a=e.$from.index(n)+r,s=e.$to.indexAfter(n)-o;if(n<e.depth&&i.canReplace(a,s,t))return n;if(0==n||i.type.spec.isolating||!Id(i,a,s))break;a&&(r=1),s<i.childCount&&(o=1)}return null}function Od(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let a=i.length?i[0]:t;return n.canReplaceWith(r,o,a)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),a=t.contentMatch.findWrapping(i.type);if(!a)return null;let s=(a.length?a[a.length-1]:t).contentMatch;for(let l=r;s&&l<o;l++)s=s.matchType(n.child(l).type);return s&&s.validEnd?a:null}(r,t);return i?o.map(Rd).concat({type:t,attrs:n}).concat(i.map(Rd)):null}function Rd(e){return{type:e,attrs:null}}function zd(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let a,s=/\r?\n|\r/g;for(;a=s.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+a.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function Fd(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function Pd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=e.resolve(t),i=o.depth-n,a=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,d=n-2;c>i;c--,d--){let e=o.node(c),t=o.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),i=r&&r[d+1];i&&(n=n.replaceChild(0,i.type.create(i.attrs)));let a=r&&r[d]||e;if(!e.canReplace(t+1,e.childCount)||!a.type.validContent(n))return!1}let s=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(s,s,l?l.type:o.node(i+1).type)}function Bd(e,t){let n=e.resolve(t),r=n.index();return Ld(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Ld(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),a=i.type==r?e.type.schema.nodes.text:i.type;if(n=n.matchType(a),!n)return!1;if(!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function Nd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=e.resolve(t);for(let o=r.depth;;o--){let e,i,a=r.index(o);if(o==r.depth?(e=r.nodeBefore,i=r.nodeAfter):n>0?(e=r.node(o+1),a++,i=r.node(o).maybeChild(a)):(e=r.node(o).maybeChild(a-1),i=r.node(o+1)),e&&!e.isTextblock&&Ld(e,i)&&r.node(o).canReplace(a,a+1))return t;if(0==o)break;t=n<0?r.before(o):r.after(o)}}function Ud(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let i=0;i<n.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(0==n.openStart&&n.size?2:1);i++)for(let e=r.depth;e>=0;e--){let t=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,n=r.index(e)+(t>0?1:0),a=r.node(e),s=!1;if(1==i)s=a.canReplace(n,n,o);else{let e=a.contentMatchAt(n).findWrapping(o.firstChild.type);s=e&&a.canReplaceWith(n,n,e[0])}if(s)return 0==t?r.pos:t<0?r.before(e+1):r.after(e+1)}return null}function Vd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pc.empty;if(t==n&&!r.size)return null;let o=e.resolve(t),i=e.resolve(n);return Wd(o,i,r)?new Ed(t,n,r):new Hd(o,i,r).fit()}function Wd(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}bd.jsonID("replaceAround",Dd);class Hd{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=ac.empty;for(let r=0;r<=e.depth;r++){let t=e.node(r);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=ac.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,i=n.depth,a=r.depth;for(;i&&a&&1==o.childCount;)o=o.firstChild.content,i--,a--;let s=new pc(o,i,a);return e>-1?new Dd(n.pos,e,this.$to.pos,this.$to.end(),s,t):s.size||n.pos!=this.$to.pos?new Ed(n.pos,r.pos,s):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null;n?(r=Yd(this.unplaced.content,n-1).firstChild,e=r.content):e=this.unplaced.content;let o=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:a,match:s}=this.frontier[i],l=null;if(1==t&&(o?s.matchType(o.type)||(l=s.fillBefore(ac.from(o),!1)):r&&a.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:i,parent:r,inject:l};if(2==t&&o&&(e=s.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:i,parent:r,wrap:e};if(r&&s.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Yd(e,t);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new pc(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Yd(e,t);if(r.childCount<=1&&t>0){let o=e.size-t<=t+r.size;this.unplaced=new pc(Gd(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new pc(Gd(e,t,1),t,n)}placeNodes(e){let{sliceDepth:t,frontierDepth:n,parent:r,inject:o,wrap:i}=e;for(;this.depth>n;)this.closeFrontierNode();if(i)for(let g=0;g<i.length;g++)this.openFrontierNode(i[g]);let a=this.unplaced,s=r?r.content:a.content,l=a.openStart-t,c=0,d=[],{match:u,type:p}=this.frontier[n];if(o){for(let e=0;e<o.childCount;e++)d.push(o.child(e));u=u.matchFragment(o)}let h=s.size+t-(a.content.size-a.openEnd);for(;c<s.childCount;){let e=s.child(c),t=u.matchType(e.type);if(!t)break;c++,(c>1||0==l||e.content.size)&&(u=t,d.push(qd(e.mark(p.allowedMarks(e.marks)),1==c?l:0,c==s.childCount?h:-1)))}let f=c==s.childCount;f||(h=-1),this.placed=Xd(this.placed,n,ac.from(d)),this.frontier[n].match=u,f&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=s;g<h;g++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=f?0==t?pc.empty:new pc(Gd(a.content,t-1,1),t-1,h<0?a.openEnd:t-1):new pc(Gd(a.content,t,c),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Zd(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=Zd(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=Zd(e,n,r,t,!0);if(!o||o.childCount)continue e}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Xd(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Xd(this.placed,this.depth,ac.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(ac.empty,!0);e.childCount&&(this.placed=Xd(this.placed,this.frontier.length,e))}}function Gd(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(Gd(e.firstChild.content,t-1,n)))}function Xd(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Xd(e.lastChild.content,t-1,n)))}function Yd(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function qd(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,qd(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(ac.empty,!0)))),e.copy(r)}function Zd(e,t,n,r,o){let i=e.node(t),a=o?e.indexAfter(t):e.index(t);if(a==i.childCount&&!n.compatibleContent(i.type))return null;let s=r.fillBefore(i.content,!0,a);return s&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,a)?s:null}function $d(e){return e.spec.defining||e.spec.definingForContent}function Kd(e,t,n,r,o){if(t<n){let o=e.firstChild;e=e.replaceChild(0,o.copy(Kd(o.content,t+1,n,r,o)))}if(t>r){let t=o.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(ac.empty,!0))}return e}function Jd(e,t){let n=[];for(let r=Math.min(e.depth,t.depth);r>=0;r--){let o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}class Qd extends bd{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return wd.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return wd.fromReplace(e,this.pos,this.pos+1,new pc(ac.from(r),0,t.isLeaf?0:1))}getMap(){return vd.empty}invert(e){return new Qd(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Qd(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Qd(t.pos,t.attr,t.value)}}bd.jsonID("attr",Qd);class eu extends bd{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return wd.ok(n)}getMap(){return vd.empty}invert(e){return new eu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new eu(t.attr,t.value)}}bd.jsonID("docAttr",eu);let tu=class extends Error{};tu=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(tu.prototype=Object.create(Error.prototype)).constructor=tu,tu.prototype.name="TransformError";class nu{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new yd}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new tu(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pc.empty,r=Vd(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new pc(ac.from(n),0,0))}delete(e,t){return this.replace(e,t,pc.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let o=e.doc.resolve(t),i=e.doc.resolve(n);if(Wd(o,i,r))return e.step(new Ed(t,n,r));let a=Jd(o,i);0==a[a.length-1]&&a.pop();let s=-(o.depth+1);a.unshift(s);for(let p=o.depth,h=o.pos-1;p>0;p--,h--){let e=o.node(p).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;a.indexOf(p)>-1?s=p:o.before(p)==h&&a.splice(1,0,-p)}let l=a.indexOf(s),c=[],d=r.openStart;for(let p=r.content,h=0;;h++){let e=p.firstChild;if(c.push(e),h==r.openStart)break;p=e.content}for(let p=d-1;p>=0;p--){let e=c[p],t=$d(e.type);if(t&&!e.sameMarkup(o.node(Math.abs(s)-1)))d=p;else if(t||!e.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let t=(p+d+1)%(r.openStart+1),s=c[t];if(s)for(let c=0;c<a.length;c++){let d=a[(c+l)%a.length],u=!0;d<0&&(u=!1,d=-d);let p=o.node(d-1),h=o.index(d-1);if(p.canReplaceWith(h,h,s.type,s.marks))return e.replace(o.before(d),u?i.after(d):n,new pc(Kd(r.content,0,r.openStart,t),t,r.openEnd))}}let u=e.steps.length;for(let p=a.length-1;p>=0&&(e.replace(t,n,r),!(e.steps.length>u));p--){let e=a[p];e<0||(t=o.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let o=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let o=r.depth-1;o>=0;o--){let e=r.index(o);if(r.node(o).canReplaceWith(e,e,n))return r.before(o+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let e=r.indexAfter(o);if(r.node(o).canReplaceWith(e,e,n))return r.after(o+1);if(e<r.node(o).childCount)return null}return null}(e.doc,t,r.type);null!=o&&(t=n=o)}e.replaceRange(t,n,new pc(ac.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=Jd(r,o);for(let a=0;a<i.length;a++){let t=i[a],n=a==i.length-1;if(n&&0==t||r.node(t).type.contentMatch.validEnd)return e.delete(r.start(t),o.end(t));if(t>0&&(n||r.node(t-1).canReplace(r.index(t-1),o.indexAfter(t-1))))return e.delete(r.before(t),o.after(t))}for(let a=1;a<=r.depth&&a<=o.depth;a++)if(t-r.start(a)==r.depth-a&&n>r.end(a)&&o.end(a)-n!=o.depth-a&&r.start(a-1)==o.start(a-1)&&r.node(a-1).canReplace(r.index(a-1),o.index(a-1)))return e.delete(r.before(a),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:o,depth:i}=t,a=r.before(i+1),s=o.after(i+1),l=a,c=s,d=ac.empty,u=0;for(let f=i,g=!1;f>n;f--)g||r.index(f)>0?(g=!0,d=ac.from(r.node(f).copy(d)),u++):l--;let p=ac.empty,h=0;for(let f=i,g=!1;f>n;f--)g||o.after(f+1)<o.end(f)?(g=!0,p=ac.from(o.node(f).copy(p)),h++):c++;e.step(new Dd(l,c,a,s,new pc(d.append(p),u,h),d.size-u,!0))}(this,e,t),this}join(e){return function(e,t,n){let r=null,{linebreakReplacement:o}=e.doc.type.schema,i=e.doc.resolve(t-n),a=i.node().type;if(o&&a.inlineContent){let e="pre"==a.whitespace,t=!!a.contentMatch.matchType(o);e&&!t?r=!1:!e&&t&&(r=!0)}let s=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);Fd(e,r.node(),r.before(),s)}a.inlineContent&&Td(e,t+n-1,a,i.node().contentMatchAt(i.index()),null==r);let l=e.mapping.slice(s),c=l.map(t-n);if(e.step(new Ed(c,l.map(t+n,-1),pc.empty,!0)),!0===r){let t=e.doc.resolve(c);zd(e,t.node(),t.before(),e.steps.length)}}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}wrap(e,t){return function(e,t,n){let r=ac.empty;for(let a=n.length-1;a>=0;a--){if(r.size){let e=n[a].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ac.from(n[a].type.create(n[a].attrs,r))}let o=t.start,i=t.end;e.step(new Dd(o,i,o,i,new pc(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e){return function(e,t,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let a="function"==typeof o?o(t):o;if(t.isTextblock&&!t.hasMarkup(r,a)&&function(e,t,n){let r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(e.doc,e.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&Fd(e,t,n,i),Td(e,e.mapping.slice(i).map(n,1),r,void 0,null===o);let s=e.mapping.slice(i),l=s.map(n,1),c=s.map(n+t.nodeSize,1);return e.step(new Dd(l,c,l+1,c-1,new pc(ac.from(r.create(a,null,t.marks)),0,0),1,!0)),!0===o&&zd(e,t,n,i),!1}})}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}setNodeMarkup(e,t){return function(e,t,n,r,o){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let a=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,a);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new Dd(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new pc(ac.from(a),0,0),1,!0))}(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}setNodeAttribute(e,t,n){return this.step(new Qd(e,t,n)),this}setDocAttribute(e,t){return this.step(new eu(e,t)),this}addNodeMark(e,t){return this.step(new jd(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof dc)t.isInSet(n.marks)&&this.step(new _d(e,t));else{let r,o=n.marks,i=[];for(;r=t.isInSet(o);)i.push(new _d(e,r)),o=r.removeFromSet(o);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=e.doc.resolve(t),i=ac.empty,a=ac.empty;for(let s=o.depth,l=o.depth-n,c=n-1;s>l;s--,c--){i=ac.from(o.node(s).copy(i));let e=r&&r[c];a=ac.from(e?e.type.create(e.attrs,a):o.node(s).copy(a))}e.step(new Ed(t,t,new pc(i.append(a),n,n),!0))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}addMark(e,t,n){return function(e,t,n,r){let o,i,a=[],s=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let d=e.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,t),u=Math.min(l+e.nodeSize,n),p=r.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(p)||(o&&o.to==c&&o.mark.eq(d[e])?o.to=u:a.push(o=new Cd(c,u,d[e])));i&&i.to==c?i.to=u:s.push(i=new kd(c,u,r))}}),a.forEach(t=>e.step(t)),s.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,r){let o=[],i=0;e.doc.nodesBetween(t,n,(e,a)=>{if(!e.isInline)return;i++;let s=null;if(r instanceof qc){let t,n=e.marks;for(;t=r.isInSet(n);)(s||(s=[])).push(t),n=t.removeFromSet(n)}else r?r.isInSet(e.marks)&&(s=[r]):s=e.marks;if(s&&s.length){let r=Math.min(a+e.nodeSize,n);for(let e=0;e<s.length;e++){let n,l=s[e];for(let e=0;e<o.length;e++){let t=o[e];t.step==i-1&&l.eq(o[e].style)&&(n=t)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(a,t),to:r,step:i})}}}),o.forEach(t=>e.step(new Cd(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return Td(this,e,t,n),this}}const ru=Object.create(null);class ou{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new iu(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pc.empty,n=t.content.lastChild,r=null;for(let a=0;a<t.openEnd;a++)r=n,n=n.lastChild;let o=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:l}=i[a],c=e.mapping.slice(o);e.replaceRange(c.map(s.pos),c.map(l.pos),a?pc.empty:t),0==a&&gu(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:a}=r[o],s=e.mapping.slice(n),l=s.map(i.pos),c=s.map(a.pos);o?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),gu(e,n,t.isInline?-1:1))}}static findFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.parent.inlineContent?new lu(e):fu(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let o=e.depth-1;o>=0;o--){let r=t<0?fu(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):fu(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(r)return r}return null}static near(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new pu(e.node(0))}static atStart(e){return fu(e,e,0,0,1)||new pu(e)}static atEnd(e){return fu(e,e,e.content.size,e.childCount,-1)||new pu(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ru[t.type];if(!n)throw new RangeError("No selection type ".concat(t.type," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in ru)throw new RangeError("Duplicate use of selection JSON ID "+e);return ru[e]=t,t.prototype.jsonID=e,t}getBookmark(){return lu.between(this.$anchor,this.$head).getBookmark()}}ou.prototype.visible=!0;class iu{constructor(e,t){this.$from=e,this.$to=t}}let au=!1;function su(e){au||e.parent.inlineContent||(au=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class lu extends ou{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;su(e),su(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return ou.near(n);let r=e.resolve(t.map(this.anchor));return new lu(r.parent.inlineContent?r:n,n)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pc.empty;if(super.replace(e,t),t==pc.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof lu&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new cu(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new lu(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if(n&&!r||(n=r>=0?1:-1),!t.parent.inlineContent){let e=ou.findFrom(t,n,!0)||ou.findFrom(t,-n,!0);if(!e)return ou.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r||(e=(ou.findFrom(e,-n,!0)||ou.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0)&&(e=t),new lu(e,t)}}ou.jsonID("text",lu);class cu{constructor(e,t){this.anchor=e,this.head=t}map(e){return new cu(e.map(this.anchor),e.map(this.head))}resolve(e){return lu.between(e.resolve(this.anchor),e.resolve(this.head))}}class du extends ou{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?ou.near(o):new du(o)}content(){return new pc(ac.from(this.node),0,0)}eq(e){return e instanceof du&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new uu(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new du(e.resolve(t.anchor))}static create(e,t){return new du(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}du.prototype.visible=!1,ou.jsonID("node",du);class uu{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new cu(n,n):new uu(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&du.isSelectable(n)?new du(t):ou.near(t)}}class pu extends ou{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pc.empty;if(t==pc.empty){e.delete(0,e.doc.content.size);let t=ou.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new pu(e)}map(e){return new pu(e)}eq(e){return e instanceof pu}getBookmark(){return hu}}ou.jsonID("all",pu);const hu={map(){return this},resolve:e=>new pu(e)};function fu(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return lu.create(e,n);for(let a=r-(o>0?0:1);o>0?a<t.childCount:a>=0;a+=o){let r=t.child(a);if(r.isAtom){if(!i&&du.isSelectable(r))return du.create(e,n-(o<0?r.nodeSize:0))}else{let t=fu(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function gu(e,t,n){let r=e.steps.length-1;if(r<t)return;let o,i=e.steps[r];(i instanceof Ed||i instanceof Dd)&&(e.mapping.maps[r].forEach((e,t,n,r)=>{null==o&&(o=r)}),e.setSelection(ou.near(e.doc.resolve(o),n)))}class mu extends nu{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return dc.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||dc.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection(ou.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function vu(e,t){return t&&e?e.bind(t):e}class yu{constructor(e,t,n){this.name=e,this.init=vu(t.init,n),this.apply=vu(t.apply,n)}}const xu=[new yu("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new yu("selection",{init:(e,t)=>e.selection||ou.atStart(t.doc),apply:e=>e.selection}),new yu("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new yu("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class bu{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=xu.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new yu(e.key,e.spec.state,e))})}}class wu{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let s=r?r[i].n:0,l=r?r[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new wu(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new mu(this)}static create(e){let t=new bu(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new wu(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new bu(this.schema,e.plugins),n=t.fields,r=new wu(t);for(let o=0;o<n.length;o++){let t=n[o].name;r[t]=this.hasOwnProperty(t)?this[t]:n[o].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new bu(e.schema,e.plugins),o=new wu(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=Tc.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=ou.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let a=n[i],s=a.spec.state;if(a.key==r.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=s.fromJSON.call(a,e,t[i],o))}o[r.name]=r.init(e,o)}}),o}}function Su(e,t,n){for(let r in e){let o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=Su(o,t,{})),n[r]=o}return n}class ku{constructor(e){this.spec=e,this.props={},e.props&&Su(e.props,this,this.props),this.key=e.key?e.key.key:ju("plugin")}getState(e){return e[this.key]}}const Cu=Object.create(null);function ju(e){return e in Cu?e+"$"+ ++Cu[e]:(Cu[e]=0,e+"$")}class _u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";this.key=ju(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Eu=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function Du(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const Mu=(e,t,n)=>{let r=Du(e,n);if(!r)return!1;let o=Ou(r);if(!o){let n=r.blockRange(),o=n&&Ad(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(Gu(e,o,t,-1))return!0;if(0==r.parent.content.size&&(Iu(i,"end")||du.isSelectable(i)))for(let a=r.depth;;a--){let n=Vd(e.doc,r.before(a),r.after(a),pc.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Iu(i,"end")?ou.findFrom(r.doc.resolve(r.mapping.map(o.pos,-1)),-1):du.create(r.doc,o.pos-i.nodeSize)),t(r.scrollIntoView())}return!0}if(1==a||r.node(a-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)};function Tu(e,t,n){let r=t.nodeBefore,o=t.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let i=t.nodeAfter,a=t.pos+1;for(;!i.isTextblock;a++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let s=Vd(e.doc,o,a,pc.empty);if(!s||s.from!=o||s instanceof Ed&&s.slice.size>=a-o)return!1;if(n){let t=e.tr.step(s);t.setSelection(lu.create(t.doc,o)),n(t.scrollIntoView())}return!0}function Iu(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const Au=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=Ou(r)}let a=i&&i.nodeBefore;return!(!a||!du.isSelectable(a))&&(t&&t(e.tr.setSelection(du.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)};function Ou(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Ru(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const zu=(e,t,n)=>{let r=Ru(e,n);if(!r)return!1;let o=Pu(r);if(!o)return!1;let i=o.nodeAfter;if(Gu(e,o,t,1))return!0;if(0==r.parent.content.size&&(Iu(i,"start")||du.isSelectable(i))){let n=Vd(e.doc,r.before(),r.after(),pc.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Iu(i,"start")?ou.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):du.create(r.doc,r.mapping.map(o.pos))),t(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},Fu=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=Pu(r)}let a=i&&i.nodeAfter;return!(!a||!du.isSelectable(a))&&(t&&t(e.tr.setSelection(du.create(e.doc,i.pos)).scrollIntoView()),!0)};function Pu(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const Bu=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function Lu(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Nu=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),a=Lu(o.contentMatchAt(i));if(!a||!o.canReplaceWith(i,i,a))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,a.createAndFill());o.setSelection(ou.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0},Uu=(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof pu||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=Lu(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(n,i.createAndFill());a.setSelection(lu.create(a.doc,n+1)),t(a.scrollIntoView())}return!0},Vu=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(Pd(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&Ad(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)};const Wu=(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof du&&e.selection.node.isBlock)return!(!n.parentOffset||!Pd(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o,i,a=[],s=!1,l=!1;for(let p=n.depth;;p--){if(n.node(p).isBlock){s=n.end(p)==n.pos+(n.depth-p),l=n.start(p)==n.pos-(n.depth-p),i=Lu(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let e=Hu&&Hu(r.parent,s,n);a.unshift(e||(s&&i?{type:i}:null)),o=p;break}if(1==p)return!1;a.unshift(null)}let c=e.tr;(e.selection instanceof lu||e.selection instanceof pu)&&c.deleteSelection();let d=c.mapping.map(n.pos),u=Pd(c.doc,d,a.length,a);if(u||(a[0]=i?{type:i}:null,u=Pd(c.doc,d,a.length,a)),!u)return!1;if(c.split(d,a.length,a),!s&&l&&n.node(o).type!=i){let e=c.mapping.map(n.before(o)),t=c.doc.resolve(e);i&&n.node(o-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return t&&t(c.scrollIntoView()),!0};var Hu;function Gu(e,t,n,r){let o,i,a=t.nodeBefore,s=t.nodeAfter,l=a.type.spec.isolating||s.type.spec.isolating;if(!l&&function(e,t,n){let r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!!(r&&o&&r.type.compatibleContent(o.type))&&(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(i,i+1)||!o.isTextblock&&!Bd(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(i=a.contentMatchAt(a.childCount)).findWrapping(s.type))&&i.matchType(o[0]||s.type).validEnd){if(n){let r=t.pos+s.nodeSize,i=ac.empty;for(let e=o.length-1;e>=0;e--)i=ac.from(o[e].create(null,i));i=ac.from(a.copy(i));let l=e.tr.step(new Dd(t.pos-1,r,t.pos,r,new pc(i,1,0),o.length,!0)),c=l.doc.resolve(r+2*o.length);c.nodeAfter&&c.nodeAfter.type==a.type&&Bd(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let d=s.type.spec.isolating||r>0&&l?null:ou.findFrom(t,1),u=d&&d.$from.blockRange(d.$to),p=u&&Ad(u);if(null!=p&&p>=t.depth)return n&&n(e.tr.lift(u,p).scrollIntoView()),!0;if(c&&Iu(s,"start",!0)&&Iu(a,"end")){let r=a,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=s,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=ac.empty;for(let e=o.length-1;e>=0;e--)r=ac.from(o[e].copy(r));n(e.tr.step(new Dd(t.pos-o.length,t.pos+s.nodeSize,t.pos+l,t.pos+s.nodeSize-l,new pc(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Xu(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(lu.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}const Yu=Xu(-1),qu=Xu(1);function Zu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let o=!1;for(let i=0;i<n.selection.ranges.length&&!o;i++){let{$from:{pos:r},$to:{pos:a}}=n.selection.ranges[i];n.doc.nodesBetween(r,a,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:a}}=n.selection.ranges[r];o.setBlockType(i,a,e,t)}r(o.scrollIntoView())}return!0}}function $u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,r){for(let o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}let Ku=$u(Eu,Mu,Au),Ju=$u(Eu,zu,Fu);const Qu={Enter:$u(Bu,Uu,Vu,Wu),"Mod-Enter":Nu,Backspace:Ku,"Mod-Backspace":Ku,"Shift-Backspace":Ku,Delete:Ju,"Mod-Delete":Ju,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new pu(e.doc))),!0)},ep={"Ctrl-h":Qu.Backspace,"Alt-Backspace":Qu["Mod-Backspace"],"Ctrl-d":Qu.Delete,"Ctrl-Alt-Backspace":Qu["Mod-Delete"],"Alt-Delete":Qu["Mod-Delete"],"Alt-d":Qu["Mod-Delete"],"Ctrl-a":Yu,"Ctrl-e":qu};for(let n in Qu)ep[n]=Qu[n];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function tp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let{$from:o,$to:i}=n.selection,a=o.blockRange(i);if(!a)return!1;let s=r?n.tr:null;return!!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!1,i=t,a=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=a.resolve(t.start-2);i=new Dc(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new Dc(t.$from,a.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let s=Od(i,n,r,t);if(!s)return!1;e&&function(e,t,n,r,o){let i=ac.empty;for(let d=n.length-1;d>=0;d--)i=ac.from(n[d].type.create(n[d].attrs,i));e.step(new Dd(t.start-(r?2:0),t.end,t.start,t.end,new pc(i,0,0),n.length,!0));let a=0;for(let d=0;d<n.length;d++)n[d].type==o&&(a=d+1);let s=n.length-a,l=t.start+n.length-(r?2:0),c=t.parent;for(let d=t.startIndex,u=t.endIndex,p=!0;d<u;d++,p=!1)!p&&Pd(e.doc,l,s)&&(e.split(l,s),l+=2*s),l+=c.child(d).nodeSize}(e,t,s,o,n);return!0}(s,a,e,t)&&(r&&r(s.scrollIntoView()),!0)}}function np(e){return function(t,n){let{$from:r,$to:o}=t.selection,i=r.blockRange(o,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(r.node(i.depth-1).type==e?function(e,t,n,r){let o=e.tr,i=r.end,a=r.$to.end(r.depth);i<a&&(o.step(new Dd(i-1,a,i,a,new pc(ac.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Dc(o.doc.resolve(r.$from.pos),o.doc.resolve(a),r.depth));const s=Ad(r);if(null==s)return!1;o.lift(r,s);let l=o.doc.resolve(o.mapping.map(i,-1)-1);Bd(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos);return t(o.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let r=e.tr,o=n.parent;for(let h=n.end,f=n.endIndex-1,g=n.startIndex;f>g;f--)h-=o.child(f).nodeSize,r.delete(h-1,h+1);let i=r.doc.resolve(n.start),a=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let s=0==n.startIndex,l=n.endIndex==o.childCount,c=i.node(-1),d=i.index(-1);if(!c.canReplace(d+(s?0:1),d+1,a.content.append(l?ac.empty:ac.from(o))))return!1;let u=i.pos,p=u+a.nodeSize;return r.step(new Dd(u-(s?1:0),p+(l?1:0),u+1,p-1,new pc((s?ac.empty:ac.from(o.copy(ac.empty))).append(l?ac.empty:ac.from(o.copy(ac.empty))),s?0:1,l?0:1),s?0:1)),t(r.scrollIntoView()),!0}(t,n,i)))}}const rp=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},op=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let ip=null;const ap=function(e,t,n){let r=ip||(ip=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},sp=function(e,t,n,r){return n&&(cp(e,t,n,r,-1)||cp(e,t,n,r,1))},lp=/^(img|br|input|textarea|hr)$/i;function cp(e,t,n,r,o){for(var i;;){if(e==n&&t==r)return!0;if(t==(o<0?0:dp(e))){let n=e.parentNode;if(!n||1!=n.nodeType||up(e)||lp.test(e.nodeName)||"false"==e.contentEditable)return!1;t=rp(e)+(o<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;t+=o}else e=n,t=o<0?dp(e):0}}}}function dp(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function up(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const pp=function(e){return e.focusNode&&sp(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function hp(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const fp="undefined"!=typeof navigator?navigator:null,gp="undefined"!=typeof document?document:null,mp=fp&&fp.userAgent||"",vp=/Edge\/(\d+)/.exec(mp),yp=/MSIE \d/.exec(mp),xp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(mp),bp=!!(yp||xp||vp),wp=yp?document.documentMode:xp?+xp[1]:vp?+vp[1]:0,Sp=!bp&&/gecko\/(\d+)/i.test(mp);Sp&&(/Firefox\/(\d+)/.exec(mp)||[0,0])[1];const kp=!bp&&/Chrome\/(\d+)/.exec(mp),Cp=!!kp,jp=kp?+kp[1]:0,_p=!bp&&!!fp&&/Apple Computer/.test(fp.vendor),Ep=_p&&(/Mobile\/\w+/.test(mp)||!!fp&&fp.maxTouchPoints>2),Dp=Ep||!!fp&&/Mac/.test(fp.platform),Mp=!!fp&&/Win/.test(fp.platform),Tp=/Android \d/.test(mp),Ip=!!gp&&"webkitFontSmoothing"in gp.documentElement.style,Ap=Ip?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Op(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Rp(e,t){return"number"==typeof e?e:e[t]}function zp(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Fp(e,t,n){let r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let a=n||e.dom;a;){if(1!=a.nodeType){a=op(a);continue}let e=a,n=e==i.body,s=n?Op(i):zp(e),l=0,c=0;if(t.top<s.top+Rp(r,"top")?c=-(s.top-t.top+Rp(o,"top")):t.bottom>s.bottom-Rp(r,"bottom")&&(c=t.bottom-t.top>s.bottom-s.top?t.top+Rp(o,"top")-s.top:t.bottom-s.bottom+Rp(o,"bottom")),t.left<s.left+Rp(r,"left")?l=-(s.left-t.left+Rp(o,"left")):t.right>s.right-Rp(r,"right")&&(l=t.right-s.right+Rp(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let o=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-o,top:t.top-i,right:t.right-o,bottom:t.bottom-i}}let d=n?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(d))break;a="absolute"==d?a.offsetParent:op(a)}}function Pp(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=op(r));return t}function Bp(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:o,left:i}=e[n];r.scrollTop!=o+t&&(r.scrollTop=o+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Lp=null;function Np(e,t){let n,r,o,i,a=2e8,s=0,l=t.top,c=t.top;for(let d=e.firstChild,u=0;d;d=d.nextSibling,u++){let e;if(1==d.nodeType)e=d.getClientRects();else{if(3!=d.nodeType)continue;e=ap(d).getClientRects()}for(let p=0;p<e.length;p++){let h=e[p];if(h.top<=l&&h.bottom>=c){l=Math.max(h.bottom,l),c=Math.min(h.top,c);let e=h.left>t.left?h.left-t.left:h.right<t.left?t.left-h.right:0;if(e<a){n=d,a=e,r=e&&3==n.nodeType?{left:h.right<t.left?h.right:h.left,top:t.top}:t,1==d.nodeType&&e&&(s=u+(t.left>=(h.left+h.right)/2?1:0));continue}}else h.top>t.top&&!o&&h.left<=t.left&&h.right>=t.left&&(o=d,i={left:Math.max(h.left,Math.min(h.right,t.left)),top:h.top});!n&&(t.left>=h.right&&t.top>=h.top||t.left>=h.left&&t.top>=h.bottom)&&(s=u+1)}}return!n&&o&&(n=o,r=i,a=0),n&&3==n.nodeType?function(e,t){let n,r=e.nodeValue.length,o=document.createRange();for(let i=0;i<r;i++){o.setEnd(e,i+1),o.setStart(e,i);let r=Gp(o,1);if(r.top!=r.bottom&&Up(t,r)){n={node:e,offset:i+(t.left>=(r.left+r.right)/2?1:0)};break}}return o.detach(),n||{node:e,offset:0}}(n,r):!n||a&&1==n.nodeType?{node:e,offset:s}:Np(n,r)}function Up(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Vp(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=e.childNodes[i];if(1==n.nodeType){let e=n.getClientRects();for(let r=0;r<e.length;r++){let o=e[r];if(Up(t,o))return Vp(n,t,o)}}if((i=(i+1)%r)==o)break}return e}function Wp(e,t){let n,r=e.dom.ownerDocument,o=0,i=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(dp(r.offsetNode),r.offset)}}catch(r){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(dp(r.startContainer),r.startOffset)}}}(r,t.left,t.top);i&&({node:n,offset:o}=i);let a,s=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!s||!e.dom.contains(1!=s.nodeType?s.parentNode:s)){let n=e.dom.getBoundingClientRect();if(!Up(t,n))return null;if(s=Vp(e.dom,t,n),!s)return null}if(_p)for(let c=s;n&&c;c=op(c))c.draggable&&(n=void 0);if(s=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(s,t),n){if(Sp&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let e,r=n.childNodes[o];"IMG"==r.nodeName&&(e=r.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&o++}let r;Ip&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(a=function(e,t,n,r){let o=-1;for(let i=t,a=!1;i!=e.dom;){let t,n=e.docView.nearestDesc(i,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!a&&t.left>r.left||t.top>r.top?o=n.posBefore:(!a&&t.right<r.left||t.bottom<r.top)&&(o=n.posAfter),a=!0),!n.contentDOM&&o<0&&!n.node.isText))return(n.node.isBlock?r.top<(t.top+t.bottom)/2:r.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;i=n.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,-1)}(e,n,o,t))}null==a&&(a=function(e,t,n){let{node:r,offset:o}=Np(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,o,i)}(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Hp(e){return e.top<e.bottom||e.left<e.right}function Gp(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(Hp(e))return e}return Array.prototype.find.call(n,Hp)||e.getBoundingClientRect()}const Xp=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Yp(e,t,n){let{node:r,offset:o,atom:i}=e.docView.domFromPos(t,n<0?-1:1),a=Ip||Sp;if(3==r.nodeType){if(!a||!Xp.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let e=o,t=o,i=n<0?1:-1;return n<0&&!o?(t++,i=-1):n>=0&&o==r.nodeValue.length?(e--,i=1):n<0?e--:t++,qp(Gp(ap(r,e,t),i),i<0)}{let e=Gp(ap(r,o,o),n);if(Sp&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let t=Gp(ap(r,o-1,o-1),-1);if(t.top==e.top){let n=Gp(ap(r,o,o+1),-1);if(n.top!=e.top)return qp(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==dp(r))){let e=r.childNodes[o-1];if(1==e.nodeType)return Zp(e.getBoundingClientRect(),!1)}if(null==i&&o<dp(r)){let e=r.childNodes[o];if(1==e.nodeType)return Zp(e.getBoundingClientRect(),!0)}return Zp(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==dp(r))){let e=r.childNodes[o-1],t=3==e.nodeType?ap(e,dp(e)-(a?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return qp(Gp(t,1),!1)}if(null==i&&o<dp(r)){let e=r.childNodes[o];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?ap(e,0,a?0:1):1==e.nodeType?e:null:null;if(t)return qp(Gp(t,-1),!0)}return qp(Gp(3==r.nodeType?ap(r):r,-n),n>=0)}function qp(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Zp(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function $p(e,t,n){let r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}const Kp=/[\u0590-\u08ac]/;let Jp=null,Qp=null,eh=!1;function th(e,t,n){return Jp==t&&Qp==n?eh:(Jp=t,Qp=n,eh="up"==n||"down"==n?function(e,t,n){let r=t.selection,o="up"==n?r.$from:r.$to;return $p(e,t,()=>{let{node:t}=e.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=Yp(e,o.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=ap(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let o=t[e];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,a=o==r.parent.content.size,s=e.domSelection();return s?Kp.test(r.parent.textContent)&&s.modify?$p(e,t,()=>{let{focusNode:t,focusOffset:o,anchorNode:i,anchorOffset:a}=e.domSelectionRange(),l=s.caretBidiLevel;s.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),p=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&o==u;try{s.collapse(i,a),t&&(t!=i||o!=a)&&s.extend&&s.extend(t,o)}catch(h){}return null!=l&&(s.caretBidiLevel=l),p}):"left"==n||"backward"==n?i:a:r.pos==r.start()||r.pos==r.end()}(e,t,n))}class nh{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(e==this.dom&&this.contentDOM)r=t>rp(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let n=!0,r=e;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let t=this.children[n],i=o+t.size;if(i>e||t instanceof ch){r=e-o;break}o=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof rh&&o.side>=0;n--);if(t<=0){let e,r=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?rp(e.dom)+1:0}}{let e,r=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?rp(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,a=0;;a++){let n=this.children[a],s=i+n.size;if(-1==r&&e<=s){let o=i+n.border;if(e>=o&&t<=s-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,o);e=i;for(let t=a;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=rp(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(s>t||a==this.children.length-1)){t=s;for(let e=a+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=rp(n.dom);break}t+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=s}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Math.min(e,t),i=Math.max(e,t);for(let h=0,f=0;h<this.children.length;h++){let a=this.children[h],s=f+a.size;if(o>f&&i<s)return a.setSelection(e-f-a.border,t-f-a.border,n,r);f=s}let a=this.domFromPos(e,e?-1:1),s=t==e?a:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((Sp||_p)&&e==t){let{node:e,offset:t}=a;if(3==e.nodeType){if(d=!(!t||"\n"!=e.nodeValue[t-1]),d&&t==e.nodeValue.length)for(let n,r=e;r;r=r.parentNode){if(n=r.nextSibling){"BR"==n.nodeName&&(a=s={node:n.parentNode,offset:rp(n)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(Sp&&c.focusNode&&c.focusNode!=s.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&_p)&&sp(a.node,a.offset,c.anchorNode,c.anchorOffset)&&sp(s.node,s.offset,c.focusNode,c.focusOffset))return;let u=!1;if((l.extend||e==t)&&(!d||!Sp)){l.collapse(a.node,a.offset);try{e!=t&&l.extend(s.node,s.offset),u=!0}catch(p){}}if(!u){if(e>t){let e=a;a=s,s=e}let n=document.createRange();n.setEnd(s.node,s.offset),n.setStart(a.node,a.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+o.border,a=i-o.border;if(e>=r&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=r||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-r,t-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class rh extends nh{constructor(e,t,n,r){let o,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class oh extends nh{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class ih extends nh{constructor(e,t,n,r,o){super(e,[],n,r),this.mark=t,this.spec=o}static create(e,t,n,r){let o=r.nodeViews[t.type.name],i=o&&o(t,r,n);return i&&i.dom||(i=sd.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new ih(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=ih.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;t<i&&(o=Sh(o,t,i,n)),e>0&&(o=Sh(o,0,e,n));for(let a=0;a<o.length;a++)o[a].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ah extends nh{constructor(e,t,n,r,o,i,a,s,l){super(e,[],o,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=a}static create(e,t,n,r,o,i){let a,s=o.nodeViews[t.type.name],l=s&&s(t,o,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:i,n,r),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=sd.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=vh(c,n,t),l?a=new dh(e,t,n,r,c,d||null,u,l,o,i+1):t.isText?new lh(e,t,n,r,c,u,o):new ah(e,t,n,r,c,d||null,u,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>ac.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&yh(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,a=o&&o.pos<0,s=new bh(this,i&&i.node,e);!function(e,t,n,r){let o=t.locals(e),i=0;if(0==o.length){for(let n=0;n<e.childCount;n++){let a=e.child(n);r(a,o,t.forChild(i,a),n),i+=a.nodeSize}return}let a=0,s=[],l=null;for(let c=0;;){let d,u,p,h;for(;a<o.length&&o[a].to==i;){let e=o[a++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d)if(u){u.sort(wh);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(d,c,!!l);if(l)h=-1,p=l,l=null;else{if(!(c<e.childCount))break;h=c,p=e.child(c++)}for(let e=0;e<s.length;e++)s[e].to<=i&&s.splice(e--,1);for(;a<o.length&&o[a].from<=i&&o[a].to>i;)s.push(o[a++]);let f=i+p.nodeSize;if(p.isText){let e=f;a<o.length&&o[a].from<e&&(e=o[a].from);for(let t=0;t<s.length;t++)s[t].to<e&&(e=s[t].to);e<f&&(l=p.cut(e-i),p=p.cut(0,e-i),f=e,h=-1)}else for(;a<o.length&&o[a].to<f;)a++;let g=p.isInline&&!p.isLeaf?s.filter(e=>!e.inline):s.slice();r(p,g,t.forChild(i,p),h),i=f}}(this.node,this.innerDeco,(t,o,i)=>{t.spec.marks?s.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&s.syncToMarks(o==this.node.childCount?dc.none:this.node.child(o).marks,n,e),s.placeWidget(t,e,r)},(t,i,l,c)=>{let d;s.syncToMarks(t.marks,n,e),s.findNodeMatch(t,i,l,c)||a&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=s.findIndexWithChild(o.node))>-1&&s.updateNodeAt(t,i,l,d,e)||s.updateNextNode(t,i,l,e,c,r)||s.addNode(t,i,l,e,r),r+=t.nodeSize}),s.syncToMarks([],n,e),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),uh(this.contentDOM,this.children,e),Ep&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof lu)||n<t||r>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let e=o.nodeValue,i=function(e,t,n,r){for(let o=0,i=0;o<e.childCount&&i<=r;){let a=e.child(o++),s=i;if(i+=a.nodeSize,!a.isText)continue;let l=a.text;for(;o<e.childCount;){let t=e.child(o++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=r&&l.slice(r-t.length-s,r-s)==t)return r-t.length;let e=s<r?l.lastIndexOf(t,r-s-1):-1;if(e>=0&&e+t.length+s>=n)return s+e;if(n==r&&l.length>=r+t.length-s&&l.slice(r-s,r-s+t.length)==t)return r}}return-1}(this.node.content,e,n-t,r-t);return i<0?null:{node:o,pos:i,text:e}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,t){let{node:n,pos:r,text:o}=t;if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let a=new oh(this,i,n,o);e.input.compositionNodes.push(a),this.children=Sh(this.children,r,r+o.length,e,a)}update(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(yh(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=gh(this.dom,this.nodeDOM,fh(this.outerDeco,this.node,t),fh(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function sh(e,t,n,r,o){vh(r,t,e);let i=new ah(void 0,e,t,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class lh extends ah{constructor(e,t,n,r,o,i,a){super(e,t,n,r,o,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),o=document.createTextNode(r.text);return new lh(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ch extends nh{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class dh extends ah{constructor(e,t,n,r,o,i,a,s,l,c){super(e,t,n,r,o,i,a,l,c),this.spec=s}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,r),o}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function uh(e,t,n){let r=e.firstChild,o=!1;for(let i=0;i<t.length;i++){let a=t[i],s=a.dom;if(s.parentNode==e){for(;s!=r;)r=xh(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(s,r);if(a instanceof ih){let t=r?r.previousSibling:e.lastChild;uh(a.contentDOM,a.children,n),r=t?t.nextSibling:e.firstChild}}for(;r;)r=xh(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}const ph=function(e){e&&(this.nodeName=e)};ph.prototype=Object.create(null);const hh=[new ph];function fh(e,t,n){if(0==e.length)return hh;let r=n?hh[0]:new ph,o=[r];for(let i=0;i<e.length;i++){let a=e[i].type.attrs;if(a){a.nodeName&&o.push(r=new ph(a.nodeName));for(let e in a){let i=a[e];null!=i&&(n&&1==o.length&&o.push(r=new ph(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}}return o}function gh(e,t,n,r){if(n==hh&&r==hh)return t;let o=t;for(let i=0;i<r.length;i++){let t=r[i],a=n[i];if(i){let n;a&&a.nodeName==t.nodeName&&o!=e&&(n=o.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(o),a=hh[0]),o=n}mh(o,a||hh[0],t)}return o}function mh(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.add(o[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function vh(e,t,n){return gh(e,e,hh,fh(t,n,1!=e.nodeType))}function yh(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function xh(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class bh{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,o=e.childCount,i=new Map,a=[];e:for(;o>0;){let s;for(;;)if(r){let e=n.children[r-1];if(!(e instanceof ih)){s=e,r--;break}n=e,r=e.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=s.node;if(l){if(l!=e.child(o-1))break;--o,i.set(s,o),a.push(s)}}return{index:o,matched:i,matches:a.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[o])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=ih.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,s=Math.min(this.top.children.length,a+5);a<s;a++){let r=this.top.children[a];if(r.matchesNode(e,t,n)&&!this.preMatch.matched.has(r)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,r,o,i){for(let a=this.index;a<this.top.children.length;a++){let s=this.top.children[a];if(s instanceof ah){let l=this.preMatch.matched.get(s);if(null!=l&&l!=o)return!1;let c,d=s.dom,u=this.isLocked(d)&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&yh(t,s.outerDeco));if(!u&&s.update(e,t,n,r))return this.destroyBetween(this.index,a),s.dom!=d&&(this.changed=!0),this.index++,!0;if(!u&&(c=this.recreateWrapper(s,e,t,n,r,i)))return this.destroyBetween(this.index,a),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!yh(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let a=ah.create(this.top,t,n,r,o,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let e of a.children)e.parent=a}return e.destroy(),a}addNode(e,t,n,r,o){let i=ah.create(this.top,e,t,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){let r=new rh(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ih;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof lh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((_p||Cp)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new ch(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function wh(e,t){return e.type.side-t.type.side}function Sh(e,t,n,r,o){let i=[];for(let a=0,s=0;a<e.length;a++){let l=e[a],c=s,d=s+=l.size;c>=n||d<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),o&&(i.push(o),o=void 0),d>n&&i.push(l.slice(n-c,l.size,r)))}return i}function kh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,a=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let s,l,c=r.resolve(a);if(pp(n)){for(s=a;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&du.isSelectable(e)&&o.parent&&(!e.isInline||!function(e,t,n){for(let r=0==t,o=t==dp(e);r||o;){if(e==n)return!0;let t=rp(e);if(!(e=e.parentNode))return!1;r=r&&0==t,o=o&&t==dp(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;l=new du(a==e?c:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=a,o=a;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[s,a]=o==e.state.selection.anchor?[o,t]:[t,o],c=r.resolve(a)}else s=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(s<0)return null}let d=r.resolve(s);if(!l){l=Ah(e,d,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function Ch(e){return e.editable?e.hasFocus():Rh(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function jh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.state.selection;if(Th(e,n),Ch(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Cp){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&sp(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?t.collapse(n.parentNode,rp(n)+1):t.collapse(n,0);!r&&!e.state.selection.visible&&bp&&wp<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let r,o,{anchor:i,head:a}=n;!_h||n instanceof lu||(n.$from.parent.inlineContent||(r=Eh(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=Eh(e,n.to))),e.docView.setSelection(i,a,e,t),_h&&(r&&Mh(r),o&&Mh(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{Ch(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const _h=_p||Cp&&jp<63;function Eh(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(_p&&o&&"false"==o.contentEditable)return Dh(o);if((!o||"false"==o.contentEditable)&&(!i||"false"==i.contentEditable)){if(o)return Dh(o);if(i)return Dh(i)}}function Dh(e){return e.contentEditable="true",_p&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Mh(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Th(e,t){if(t instanceof du){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(Ih(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else Ih(e)}function Ih(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Ah(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||lu.between(t,n,r)}function Oh(e){return!(e.editable&&!e.hasFocus())&&Rh(e)}function Rh(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function zh(e,t){let{$anchor:n,$head:r}=e.selection,o=t>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return i&&ou.findFrom(i,t)}function Fh(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Ph(e,t,n){let r=e.state.selection;if(!(r instanceof lu)){if(r instanceof du&&r.node.isInline)return Fh(e,new lu(t>0?r.$to:r.$from));{let n=zh(e.state,t);return!!n&&Fh(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return Fh(e,new lu(r.$anchor,i))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=zh(e.state,t);return!!(n&&n instanceof du)&&Fh(e,n)}if(!(Dp&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let a=t<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=e.docView.descAt(a))&&!n.contentDOM)&&(du.isSelectable(i)?Fh(e,new du(t<0?e.state.doc.resolve(o.pos-i.nodeSize):o)):!!Ip&&Fh(e,new lu(e.state.doc.resolve(t<0?a:a+i.nodeSize))))}}function Bh(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Lh(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function Nh(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,a=!1;Sp&&1==n.nodeType&&r<Bh(n)&&Lh(n.childNodes[r],-1)&&(a=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(Lh(e,-1))o=n,i=--r;else{if(3!=e.nodeType)break;n=e,r=n.nodeValue.length}}}else{if(Uh(n))break;{let t=n.previousSibling;for(;t&&Lh(t,-1);)o=n.parentNode,i=rp(t),t=t.previousSibling;if(t)n=t,r=Bh(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}a?Vh(e,n,r):o&&Vh(e,o,i)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,a=Bh(n);for(;;)if(r<a){if(1!=n.nodeType)break;if(!Lh(n.childNodes[r],1))break;o=n,i=++r}else{if(Uh(n))break;{let t=n.nextSibling;for(;t&&Lh(t,1);)o=t.parentNode,i=rp(t)+1,t=t.nextSibling;if(t)n=t,r=0,a=Bh(n);else{if(n=n.parentNode,n==e.dom)break;r=a=0}}}o&&Vh(e,o,i)}(e)}function Uh(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Vh(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!up(e);)t=rp(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!up(e);)t=rp(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(pp(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&jh(e)},50)}function Wh(e,t){let n=e.state.doc.resolve(t);if(!Cp&&!Mp&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function Hh(e,t,n){let r=e.state.selection;if(r instanceof lu&&!r.empty||n.indexOf("s")>-1)return!1;if(Dp&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=zh(e.state,t);if(n&&n instanceof du)return Fh(e,n)}if(!o.parent.inlineContent){let n=t<0?o:i,a=r instanceof pu?ou.near(n,t):ou.findFrom(n,t);return!!a&&Fh(e,a)}return!1}function Gh(e,t){if(!(e.state.selection instanceof lu))return!0;let{$head:n,$anchor:r,empty:o}=e.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function Xh(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function Yh(e,t){let n=t.keyCode,r=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||Dp&&72==n&&"c"==r)return Gh(e,-1)||Nh(e,-1);if(46==n&&!t.shiftKey||Dp&&68==n&&"c"==r)return Gh(e,1)||Nh(e,1);if(13==n||27==n)return!0;if(37==n||Dp&&66==n&&"c"==r){let t=37==n?"ltr"==Wh(e,e.state.selection.from)?-1:1:-1;return Ph(e,t,r)||Nh(e,t)}if(39==n||Dp&&70==n&&"c"==r){let t=39==n?"ltr"==Wh(e,e.state.selection.from)?1:-1:1;return Ph(e,t,r)||Nh(e,t)}return 38==n||Dp&&80==n&&"c"==r?Hh(e,-1,r)||Nh(e,-1):40==n||Dp&&78==n&&"c"==r?function(e){if(!_p||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;Xh(e,n,"true"),setTimeout(()=>Xh(e,n,"false"),20)}return!1}(e)||Hh(e,1,r)||Nh(e,1):r==(Dp?"m":"c")&&(66==n||73==n||89==n||90==n)}function qh(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:i}=t;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let a=e.someProp("clipboardSerializer")||sd.fromSchema(e.state.schema),s=of(),l=s.createElement("div");l.appendChild(a.serializeFragment(r,{document:s}));let c,d=l.firstChild,u=0;for(;d&&1==d.nodeType&&(c=nf[d.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=s.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}d=l.firstChild}d&&1==d.nodeType&&d.setAttribute("data-pm-slice","".concat(o," ").concat(i).concat(u?" -".concat(u):""," ").concat(JSON.stringify(n)));let p=e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n");return{dom:l,text:p,slice:t}}function Zh(e,t,n,r,o){let i,a,s=o.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(r||s||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,s||r,e)}),s)return a=new pc(ac.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{a=t(a,e,!0)}),a;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)a=n;else{let n=o.marks(),{schema:r}=e.state,a=sd.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(a.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,r=of().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&nf[o[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(r.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;af||(af=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return af.createHTML(e)}(e),n)for(let i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),Ip&&function(e){let t=e.querySelectorAll(Cp?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!a){let t=e.someProp("clipboardParser")||e.someProp("domParser")||Kc.fromSchema(e.state.schema);a=t.parseSlice(i,{preserveWhitespace:!(!l&&!d),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||$h.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(d)a=function(e,t){if(!e.size)return e;let n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(s){return e}let{content:o,openStart:i,openEnd:a}=e;for(let l=n.length-2;l>=0;l-=2){let e=r.nodes[n[l]];if(!e||e.hasRequiredAttrs())break;o=ac.from(e.create(n[l+1],o)),i++,a++}return new pc(o,i,a)}(tf(a,+d[1],+d[2]),d[4]);else if(a=pc.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,o=t.node(n).contentMatchAt(t.index(n)),i=[];if(e.forEach(e=>{if(!i)return;let t,n=o.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&r.length&&Jh(n,r,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=Qh(i[i.length-1],r.length));let t=Kh(e,n);i.push(t),o=o.matchType(t.type),r=n}}),i)return ac.from(i)}return e}(a.content,o),!0),a.openStart||a.openEnd){let e=0,t=0;for(let n=a.content.firstChild;e<a.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=a.content.lastChild;t<a.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);a=tf(a,e,t)}return e.someProp("transformPasted",t=>{a=t(a,e,l)}),a}const $h=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Kh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let r=t.length-1;r>=n;r--)e=t[r].create(null,ac.from(e));return e}function Jh(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let i=Jh(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(ac.from(Kh(n,e,o+1))))}}function Qh(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,Qh(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(ac.empty,!0);return e.copy(n.append(r))}function ef(e,t,n,r,o,i){let a=t<0?e.firstChild:e.lastChild,s=a.content;return e.childCount>1&&(i=0),o<r-1&&(s=ef(s,t,n,r,o+1,i)),o>=n&&(s=t<0?a.contentMatchAt(0).fillBefore(s,i<=o).append(s):s.append(a.contentMatchAt(a.childCount).fillBefore(ac.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(s))}function tf(e,t,n){return t<e.openStart&&(e=new pc(ef(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new pc(ef(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const nf={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let rf=null;function of(){return rf||(rf=document.implementation.createHTMLDocument("title"))}let af=null;const sf={},lf={},cf={touchstart:!0,touchmove:!0};class df{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function uf(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function pf(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>hf(e,t))})}function hf(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function ff(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function gf(e){return{left:e.clientX,top:e.clientY}}function mf(e,t,n,r,o){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let a=i.depth+1;a>0;a--)if(e.someProp(t,t=>a>i.depth?t(e,n,i.nodeAfter,i.before(a),o,!0):t(e,n,i.node(a),i.before(a),o,!1)))return!0;return!1}function vf(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function yf(e,t,n,r,o){return mf(e,"handleClickOn",t,n,r)||e.someProp("handleClick",n=>n(e,t,r))||(o?function(e,t){if(-1==t)return!1;let n,r,o=e.state.selection;o instanceof du&&(n=o.node);let i=e.state.doc.resolve(t);for(let a=i.depth+1;a>0;a--){let e=a>i.depth?i.nodeAfter:i.node(a);if(du.isSelectable(e)){r=n&&o.$from.depth>0&&a>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(a);break}}return null!=r&&(vf(e,du.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&du.isSelectable(r))&&(vf(e,new du(n),"pointer"),!0)}(e,n))}function xf(e,t,n,r){return mf(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}function bf(e,t,n,r){return mf(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(vf(e,lu.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(t);for(let i=o.depth+1;i>0;i--){let t=i>o.depth?o.nodeAfter:o.node(i),n=o.before(i);if(t.inlineContent)vf(e,lu.create(r,n+1,n+1+t.content.size),"pointer");else{if(!du.isSelectable(t))continue;vf(e,du.create(r,n),"pointer")}return!0}}(e,n,r)}function wf(e){return Mf(e)}lf.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!Cf(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!Tp||!Cp||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!Ep||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||Yh(e,n)?n.preventDefault():uf(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,hp(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},lf.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},lf.keypress=(e,t)=>{let n=t;if(Cf(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||Dp&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let r=e.state.selection;if(!(r instanceof lu)||!r.$from.sameParent(r.$to)){let t=String.fromCharCode(n.charCode),o=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,r.$from.pos,r.$to.pos,t,o))||e.dispatch(o()),n.preventDefault()}};const Sf=Dp?"metaKey":"ctrlKey";sf.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=wf(e),o=Date.now(),i="singleClick";o-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[Sf]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let a=e.posAtCoords(gf(n));a&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new kf(e,a,n,!!r)):("doubleClick"==i?xf:bf)(e,a.pos,a.inside,n)?n.preventDefault():uf(e,"pointer"))};class kf{constructor(e,t,n,r){let o,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Sf],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,i=n.depth?n.before():0}const a=r?null:n.target,s=a?e.docView.nearestDesc(a,!0):null;this.target=s&&1==s.nodeDOM.nodeType?s.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof du&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Sp||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),uf(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>jh(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(gf(e))),this.updateAllowDefault(e),this.allowDefault||!t?uf(this.view,"pointer"):yf(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||_p&&this.mightDrag&&!this.mightDrag.node.isAtom||Cp&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(vf(this.view,ou.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):uf(this.view,"pointer")}move(e){this.updateAllowDefault(e),uf(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Cf(e,t){return!!e.composing||!!(_p&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}sf.touchstart=e=>{e.input.lastTouch=Date.now(),wf(e),uf(e,"pointer")},sf.touchmove=e=>{e.input.lastTouch=Date.now(),uf(e,"pointer")},sf.contextmenu=e=>wf(e);const jf=Tp?5e3:-1;function _f(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>Mf(e),t))}function Ef(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Df(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=dp(e=e.childNodes[t-1])}else{if(!e.parentNode||up(e))return null;t=rp(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||up(e))return null;t=rp(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return r}}return n||r}function Mf(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(Tp&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Ef(e),t||e.docView&&e.docView.dirty){let n=kh(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}lf.compositionstart=lf.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof lu&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)||Cp&&Mp&&function(e){let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(!t||1!=t.nodeType||n>=t.childNodes.length)return!1;let r=t.childNodes[n];return 1==r.nodeType&&"false"==r.contentEditable}(e)))e.markCursor=e.state.storedMarks||n.marks(),Mf(e,!0),e.markCursor=null;else if(Mf(e,!t.selection.empty),Sp&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}_f(e,jf)},lf.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,_f(e,20))};const Tf=bp&&wp<15||Ep&&Ap<604;function If(e,t,n,r,o){let i=Zh(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,i||pc.empty)))return!0;if(!i)return!1;let a=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),s=a?e.state.tr.replaceSelectionWith(a,r):e.state.tr.replaceSelection(i);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Af(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}sf.copy=lf.cut=(e,t)=>{let n=t,r=e.state.selection,o="cut"==n.type;if(r.empty)return;let i=Tf?null:n.clipboardData,a=r.content(),{dom:s,text:l}=qh(e,a);i?(n.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,s),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},lf.paste=(e,t)=>{let n=t;if(e.composing&&!Tp)return;let r=Tf?null:n.clipboardData,o=e.input.shiftKey&&45!=e.input.lastKeyCode;r&&If(e,Af(r),r.getData("text/html"),o,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?If(e,r.value,null,o,t):If(e,r.textContent,r.innerHTML,o,t)},50)}(e,n)};class Of{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Rf=Dp?"altKey":"ctrlKey";function zf(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[Rf]}sf.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=e.state.selection,a=i.empty?null:e.posAtCoords(gf(n));if(a&&a.pos>=i.from&&a.pos<=(i instanceof du?i.to-1:i.to));else if(r&&r.mightDrag)o=du.create(e.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(o=du.create(e.state.doc,t.posBefore))}let s=(o||e.state.selection).content(),{dom:l,text:c,slice:d}=qh(e,s);(!n.dataTransfer.files.length||!Cp||jp>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Tf?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Tf||n.dataTransfer.setData("text/plain",c),e.dragging=new Of(d,zf(e,n),o)},sf.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},lf.dragover=lf.dragenter=(e,t)=>t.preventDefault(),lf.drop=(e,t)=>{try{!function(e,t,n){if(!t.dataTransfer)return;let r=e.posAtCoords(gf(t));if(!r)return;let o=e.state.doc.resolve(r.pos),i=n&&n.slice;i?e.someProp("transformPasted",t=>{i=t(i,e,!1)}):i=Zh(e,Af(t.dataTransfer),Tf?null:t.dataTransfer.getData("text/html"),!1,o);let a=!(!n||!zf(e,t));if(e.someProp("handleDrop",n=>n(e,t,i||pc.empty,a)))return void t.preventDefault();if(!i)return;t.preventDefault();let s=i?Ud(e.state.doc,o.pos,i):o.pos;null==s&&(s=o.pos);let l=e.state.tr;if(a){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(s),d=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,u=l.doc;d?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i);if(l.doc.eq(u))return;let p=l.doc.resolve(c);if(d&&du.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new du(p));else{let t=l.mapping.map(s);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,r,o)=>t=o),l.setSelection(Ah(e,p,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}(e,t,e.dragging)}finally{e.dragging=null}},sf.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&jh(e)},20))},sf.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},sf.beforeinput=(e,t)=>{if(Cp&&Tp&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,hp(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let n in lf)sf[n]=lf[n];function Ff(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class Pf{constructor(e,t){this.toDOM=e,this.spec=t||Vf,this.side=this.spec.side||0}map(e,t,n,r){let{pos:o,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new Nf(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Pf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ff(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Bf{constructor(e,t){this.attrs=e,this.spec=t||Vf}map(e,t,n,r){let o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new Nf(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Bf&&Ff(this.attrs,e.attrs)&&Ff(this.spec,e.spec)}static is(e){return e.type instanceof Bf}destroy(){}}class Lf{constructor(e,t){this.attrs=e,this.spec=t||Vf}map(e,t,n,r){let o=e.mapResult(t.from+r,1);if(o.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new Nf(o.pos-n,i.pos-n,this)}valid(e,t){let n,{index:r,offset:o}=e.content.findIndex(t.from);return o==t.from&&!(n=e.child(r)).isText&&o+n.nodeSize==t.to}eq(e){return this==e||e instanceof Lf&&Ff(this.attrs,e.attrs)&&Ff(this.spec,e.spec)}destroy(){}}class Nf{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Nf(e,t,this.type)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Nf(e,e,new Pf(t,n))}static inline(e,t,n,r){return new Nf(e,t,new Bf(n,r))}static node(e,t,n,r){return new Nf(e,t,new Lf(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Bf}get widget(){return this.type instanceof Pf}}const Uf=[],Vf={};class Wf{constructor(e,t){this.local=e.length?e:Uf,this.children=t.length?t:Uf}static create(e,t){return t.length?Zf(t,e,0,Vf):Hf}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,o){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,t-a,n,r+a,o)}}map(e,t,n){return this==Hf||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Vf)}mapInner(e,t,n,r,o){let i;for(let a=0;a<this.local.length;a++){let s=this.local[a].map(e,n,r);s&&s.type.valid(t,s)?(i||(i=[])).push(s):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?function(e,t,n,r,o,i,a){let s=e.slice();for(let c=0,d=i;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,r,o)=>{let i=o-r-(n-t);for(let a=0;a<s.length;a+=3){let r=s[a+1];if(r<0||t>r+d-e)continue;let o=s[a]+d-e;n>=o?s[a+1]=t<=o?-2:-1:t>=d&&i&&(s[a]+=i,s[a+1]+=i)}e+=i}),d=n.maps[c].map(d,-1)}let l=!1;for(let c=0;c<s.length;c+=3)if(s[c+1]<0){if(-2==s[c+1]){l=!0,s[c+1]=-1;continue}let t=n.map(e[c]+i),d=t-o;if(d<0||d>=r.content.size){l=!0;continue}let u=n.map(e[c+1]+i,-1)-o,{index:p,offset:h}=r.content.findIndex(d),f=r.maybeChild(p);if(f&&h==d&&h+f.nodeSize==u){let r=s[c+2].mapInner(n,f,t+1,e[c]+i+1,a);r!=Hf?(s[c]=d,s[c+1]=u,s[c+2]=r):(s[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,r,o,i,a){function s(e,t){for(let i=0;i<e.local.length;i++){let s=e.local[i].map(r,o,t);s?n.push(s):a.onRemove&&a.onRemove(e.local[i].spec)}for(let n=0;n<e.children.length;n+=3)s(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&s(e[l+2],t[l]+i+1);return n}(s,e,t,n,o,i,a),c=Zf(l,r,0,a);t=c.local;for(let e=0;e<s.length;e+=3)s[e+1]<0&&(s.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<s.length&&s[t]<n;)t+=3;s.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new Wf(t.sort($f),s)}(this.children,i||[],e,t,n,r,o):i?new Wf(i.sort($f),Uf):Hf}add(e,t){return t.length?this==Hf?Wf.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,o=0;e.forEach((e,i)=>{let a,s=i+n;if(a=Yf(t,e,s)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(e,a,s+1):r.splice(o,0,i,i+e.nodeSize,Zf(a,e,s+1,Vf)),o+=3}});let i=Xf(o?qf(t):t,-n);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new Wf(i.length?this.local.concat(i).sort($f):this.local,r||this.children)}remove(e){return 0==e.length||this==Hf?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let r,i=n[o]+t,a=n[o+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>i&&t.to<a&&(e[n]=null,(r||(r=[])).push(t));if(!r)continue;n==this.children&&(n=this.children.slice());let s=n[o+2].removeInner(r,i+1);s!=Hf?n[o+2]=s:(n.splice(o,3),o-=3)}if(r.length)for(let o,i=0;i<e.length;i++)if(o=e[i])for(let e=0;e<r.length;e++)r[e].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Wf(r,n):Hf}forChild(e,t){if(this==Hf)return this;if(t.isLeaf)return Wf.empty;let n,r;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(n=this.children[a+2]);break}let o=e+1,i=o+t.content.size;for(let a=0;a<this.local.length;a++){let e=this.local[a];if(e.from<i&&e.to>o&&e.type instanceof Bf){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let e=new Wf(r.sort($f),Uf);return n?new Gf([e,n]):e}return n||Hf}eq(e){if(this==e)return!0;if(!(e instanceof Wf)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Kf(this.localsInner(e))}localsInner(e){if(this==Hf)return Uf;if(e.inlineContent||!this.local.some(Bf.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Bf||t.push(this.local[n]);return t}forEachSet(e){e(this)}}Wf.empty=new Wf([],[]),Wf.removeOverlap=Kf;const Hf=Wf.empty;class Gf{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,Vf));return Gf.from(n)}forChild(e,t){if(t.isLeaf)return Wf.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,t);o!=Hf&&(o instanceof Gf?n=n.concat(o.members):n.push(o))}return Gf.from(n)}eq(e){if(!(e instanceof Gf)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<o.length;e++)t.push(o[e])}else t=o}return t?Kf(n?t:t.sort($f)):Uf}static from(e){switch(e.length){case 0:return Hf;case 1:return e[0];default:return new Gf(e.every(e=>e instanceof Wf)?e:e.reduce((e,t)=>e.concat(t instanceof Wf?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Xf(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let o=e[r];n.push(new Nf(o.from+t,o.to+t,o.type))}return n}function Yf(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,o=null;for(let i,a=0;a<e.length;a++)(i=e[a])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),e[a]=null);return o}function qf(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function Zf(e,t,n,r){let o=[],i=!1;t.forEach((t,a)=>{let s=Yf(e,t,a+n);if(s){i=!0;let e=Zf(s,t,n+a+1,r);e!=Hf&&o.push(a,a+t.nodeSize,e)}});let a=Xf(i?qf(e):e,-n).sort($f);for(let s=0;s<a.length;s++)a[s].type.valid(t,a[s])||(r.onRemove&&r.onRemove(a[s].spec),a.splice(s--,1));return a.length||o.length?new Wf(a,o):Hf}function $f(e,t){return e.from-t.from||e.to-t.to}function Kf(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let o=n+1;o<t.length;o++){let i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Jf(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Jf(t,o+1,i.copy(r.to,i.to)))}}return t}function Jf(e,t,n){for(;t<e.length&&$f(n,e[t])>0;)t++;e.splice(t,0,n)}function Qf(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=Hf&&t.push(r)}),e.cursorWrapper&&t.push(Wf.create(e.state.doc,[e.cursorWrapper.deco])),Gf.from(t)}const eg={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tg=bp&&wp<=11;class ng{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class rg{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ng,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);bp&&wp<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),tg&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,eg)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Oh(this.view)){if(this.suppressingSelectionUpdates)return jh(this.view);if(bp&&wp<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&sp(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let o=e.focusNode;o;o=op(o))n.add(o);for(let o=e.anchorNode;o;o=op(o))if(n.has(o)){t=o;break}let r=t&&this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Oh(e)&&!this.ignoreSelectionChange(n),o=-1,i=-1,a=!1,s=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],s);e&&(o=o<0?e.from:Math.min(e.from,o),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(a=!0))}if(Sp&&s.length){let t=s.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;!t||"LI"!=t.nodeName||n&&sg(e,n)==t||r.remove()}}}else if((Cp||_p)&&s.some(e=>"BR"==e.nodeName)&&(8==e.input.lastKeyCode||46==e.input.lastKeyCode))for(let c of s)if("BR"==c.nodeName&&c.parentNode){let e=c.nextSibling;e&&1==e.nodeType&&"false"==e.contentEditable&&c.parentNode.removeChild(c)}let l=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&pp(n)&&(l=kh(e))&&l.eq(ou.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,jh(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,i),function(e){if(og.has(e))return;if(og.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=Sp,ig)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),ig=!0}}(e)),this.handleDOMChange(o,i,a,s),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||jh(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if(bp&&wp<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==e.target?rp(r)+1:0,a=n.localPosFromDOM(e.target,i,-1),s=o&&o.parentNode==e.target?rp(o):e.target.childNodes.length;return{from:a,to:n.localPosFromDOM(e.target,s,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let og=new WeakMap,ig=!1;function ag(e,t){let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,a=e.domAtPos(e.state.selection.anchor);return sp(a.node,a.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function sg(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function lg(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(_p&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||_p&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const cg=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function dg(e,t,n,r,o){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=kh(e,t);if(n&&!e.state.selection.eq(n)){if(Cp&&Tp&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,hp(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),i&&r.setMeta("composition",i),e.dispatch(r)}return}let a=e.state.doc.resolve(t),s=a.sharedDepth(n);t=a.before(s+1),n=e.state.doc.resolve(n).after(s+1);let l,c,d=e.state.selection,u=function(e,t,n){let r,{node:o,fromOffset:i,toOffset:a,from:s,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:c.anchorOffset}],pp(c)||r.push({node:c.focusNode,offset:c.focusOffset})),Cp&&8===e.input.lastKeyCode)for(let m=a;m>i;m--){let e=o.childNodes[m-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){a=m;break}if(!t||t.size)break}let u=e.state.doc,p=e.someProp("domParser")||Kc.fromSchema(e.state.schema),h=u.resolve(s),f=null,g=p.parse(o,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:a,preserveWhitespace:"pre"!=h.parent.type.whitespace||"full",findPositions:r,ruleFromNode:lg,context:h});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+s,head:t+s}}return{doc:g,sel:f,from:s,to:l}}(e,t,n),p=e.state.doc,h=p.slice(u.from,u.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,r,o){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:a,b:s}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==o){r-=a+Math.max(0,i-Math.min(a,s))-i}if(a<i&&e.size<t.size){let e=r<=i&&r>=a?i-r:0;i-=e,i&&i<t.size&&hg(t.textBetween(i-1,i+1))&&(i+=e?1:-1),s=i+(s-a),a=i}else if(s<i){let t=r<=i&&r>=s?i-r:0;i-=t,i&&i<e.size&&hg(e.textBetween(i-1,i+1))&&(i+=t?1:-1),a=i+(a-s),s=i}return{start:i,endA:a,endB:s}}(h.content,u.doc.content,u.from,l,c);if(f&&e.input.domChangeCount++,(Ep&&e.input.lastIOSEnter>Date.now()-225||Tp)&&o.some(e=>1==e.nodeType&&!cg.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,hp(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(r&&d instanceof lu&&!d.empty&&d.$head.sameParent(d.$anchor))||e.composing||u.sel&&u.sel.anchor!=u.sel.head){if(u.sel){let t=ug(e,e.state.doc,u.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);i&&n.setMeta("composition",i),e.dispatch(n)}}return}f={start:d.from,endA:d.to,endB:d.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof lu&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),bp&&wp<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>u.from&&" \xa0"==u.doc.textBetween(f.start-u.from-1,f.start-u.from+1)&&(f.start--,f.endA--,f.endB--);let g=u.doc.resolveNoCache(f.start-u.from),m=u.doc.resolveNoCache(f.endB-u.from),v=p.resolve(f.start),y=g.sameParent(m)&&g.parent.inlineContent&&v.end()>=f.endA;if((Ep&&e.input.lastIOSEnter>Date.now()-225&&(!y||o.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!y&&g.pos<u.doc.content.size&&(!g.sameParent(m)||!g.parent.inlineContent)&&g.pos<m.pos&&!/\S/.test(u.doc.textBetween(g.pos,m.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,hp(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,r,o){if(n-t<=o.pos-r.pos||pg(r,!0,!1)<o.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let a=e.resolve(pg(i,!0,!0));return!(!a.parent.isTextblock||a.pos>n||pg(a,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(a.parent.content)}(p,f.start,f.endA,g,m)&&e.someProp("handleKeyDown",t=>t(e,hp(8,"Backspace"))))return void(Tp&&Cp&&e.domObserver.suppressSelectionUpdates());Cp&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),Tp&&!y&&g.start()!=m.start()&&0==m.parentOffset&&g.depth==m.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==f.endA&&(f.endB-=2,m=u.doc.resolveNoCache(f.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,hp(13,"Enter"))})},20));let x,b=f.start,w=f.endA,S=t=>{let n=t||e.state.tr.replace(b,w,u.doc.slice(f.start-u.from,f.endB-u.from));if(u.sel){let t=ug(e,n.doc,u.sel);t&&!(Cp&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==b||t.head==n.mapping.map(w)-1)||bp&&t.empty&&t.head==b)&&n.setSelection(t)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(y)if(g.pos==m.pos){bp&&wp<=11&&0==g.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>jh(e),20));let t=S(e.state.tr.delete(b,w)),n=p.resolve(f.start).marksAcross(p.resolve(f.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(f.endA==f.endB&&(x=function(e,t){let n,r,o,i=e.firstChild.marks,a=t.firstChild.marks,s=i,l=a;for(let d=0;d<a.length;d++)s=a[d].removeFromSet(s);for(let d=0;d<i.length;d++)l=i[d].removeFromSet(l);if(1==s.length&&0==l.length)r=s[0],n="add",o=e=>e.mark(r.addToSet(e.marks));else{if(0!=s.length||1!=l.length)return null;r=l[0],n="remove",o=e=>e.mark(r.removeFromSet(e.marks))}let c=[];for(let d=0;d<t.childCount;d++)c.push(o(t.child(d)));if(ac.from(c).eq(e))return{mark:r,type:n}}(g.parent.content.cut(g.parentOffset,m.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start())))){let t=S(e.state.tr);"add"==x.type?t.addMark(b,w,x.mark):t.removeMark(b,w,x.mark),e.dispatch(t)}else if(g.parent.child(g.index()).isText&&g.index()==m.index()-(m.textOffset?0:1)){let t=g.parent.textBetween(g.parentOffset,m.parentOffset),n=()=>S(e.state.tr.insertText(t,b,w));e.someProp("handleTextInput",r=>r(e,b,w,t,n))||e.dispatch(n())}else e.dispatch(S());else e.dispatch(S())}function ug(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:Ah(e,t.resolve(n.anchor),t.resolve(n.head))}function pg(e,t,n){let r=e.depth,o=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,o++}return o}function hg(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class fg{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new df,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(xg),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=vg(this),mg(this),this.nodeViews=yg(this),this.docView=sh(this.state.doc,gg(this),Qf(this),this.dom,this),this.domObserver=new rg(this,(e,t,n,r)=>dg(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in sf){let n=sf[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!ff(e,t)||hf(e,t)||!e.editable&&t.type in lf||n(e,t)},cf[t]?{passive:!0}:void 0)}_p&&e.dom.addEventListener("input",()=>null),pf(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&pf(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(xg),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(Ef(this),i=!0),this.state=e;let a=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=yg(this);(function(e,t){let n=0,r=0;for(let o in e){if(e[o]!=t[o])return!0;n++}for(let o in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&pf(this),this.editable=vg(this),mg(this);let s=Qf(this),l=gg(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",d=o||!this.docView.matchesNode(e.doc,l,s);!d&&e.selection.eq(r.selection)||(i=!0);let u="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,a=o+1;a<Math.min(innerHeight,r.bottom);a+=5){let r=e.root.elementFromPoint(i,a);if(!r||r==e.dom||!e.dom.contains(r))continue;let s=r.getBoundingClientRect();if(s.top>=o-20){t=r,n=s.top;break}}return{refDOM:t,refTop:n,stack:Pp(e.dom)}}(this);if(i){this.domObserver.stop();let t=d&&(bp||Cp)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(r.selection,e.selection);if(d){let n=Cp?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Df(this)),!o&&this.docView.update(e.doc,l,s,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=sh(e.doc,l,s,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return sp(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?jh(this,t):(Th(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():u&&function(e){let{refDOM:t,refTop:n,stack:r}=e,o=t?t.getBoundingClientRect().top:0;Bp(r,0==o?0:o-n)}(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof du){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Fp(this,t.getBoundingClientRect(),e)}else Fp(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new Of(e.slice,e.move,r<0?void 0:du.create(this.state.doc,r))}someProp(e,t){let n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(let i=0;i<this.directPlugins.length;i++){let r=this.directPlugins[i].props[e];if(null!=r&&(n=t?t(r):r))return n}let o=this.state.plugins;if(o)for(let i=0;i<o.length;i++){let r=o[i].props[e];if(null!=r&&(n=t?t(r):r))return n}}hasFocus(){if(bp){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Lp)return e.focus(Lp);let t=Pp(e);e.focus(null==Lp?{get preventScroll(){return Lp={preventScroll:!0},!0}}:void 0),Lp||(Lp=!1,Bp(t,0))}(this.dom),jh(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return Wp(this,e)}coordsAtPos(e){return Yp(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return th(this,t||this.state,e)}pasteHTML(e,t){return If(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return If(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return qh(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Qf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,ip=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){hf(e,t)||!sf[t.type]||!e.editable&&t.type in lf||sf[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?_p&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return ag(e,n)}let n;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?ag(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function gg(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[Nf.node(0,e.state.doc.content.size,t)]}function mg(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Nf.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function vg(e){return!e.someProp("editable",t=>!1===t(e.state))}function yg(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function xg(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}fg.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var bg={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},wg={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Sg="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),kg="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Cg=0;Cg<10;Cg++)bg[48+Cg]=bg[96+Cg]=String(Cg);for(Cg=1;Cg<=24;Cg++)bg[Cg+111]="F"+Cg;for(Cg=65;Cg<=90;Cg++)bg[Cg]=String.fromCharCode(Cg+32),wg[Cg]=String.fromCharCode(Cg);for(var jg in bg)wg.hasOwnProperty(jg)||(wg[jg]=bg[jg]);const _g="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Eg="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function Dg(e){let t,n,r,o,i=e.split(/-(?!$)/),a=i[i.length-1];"Space"==a&&(a=" ");for(let s=0;s<i.length-1;s++){let e=i[s];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);_g?o=!0:n=!0}}return t&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),r&&(a="Shift-"+a),a}function Mg(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function Tg(e){let t=function(e){let t=Object.create(null);for(let n in e)t[Dg(n)]=e[n];return t}(e);return function(e,n){let r,o=function(e){var t=!(Sg&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||kg&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?wg:bg)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=t[Mg(o,n)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[Mg(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Eg&&n.ctrlKey&&n.altKey)&&(r=bg[n.keyCode])&&r!=o){let o=t[Mg(r,n)];if(o&&o(e.state,e.dispatch,e))return!0}}return!1}}var Ig=Object.defineProperty,Ag=(e,t)=>{for(var n in t)Ig(e,n,{get:t[n],enumerable:!0})};function Og(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return s(s({},t),{},{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}})}var Rg=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var e=this;const{rawCommands:t,editor:n,state:r}=this,{view:o}=n,{tr:i}=r,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(t=>{let[n,r]=t;return[n,function(){const t=r(...arguments)(a);return i.getMeta("preventDispatch")||e.hasCustomState||o.dispatch(i),t}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:r,editor:o,state:i}=this,{view:a}=o,l=[],c=!!e,d=e||i.tr,u=s(s({},Object.fromEntries(Object.entries(r).map(e=>{let[r,o]=e;return[r,function(){const e=t.buildProps(d,n),r=o(...arguments)(e);return l.push(r),u}]}))),{},{run:()=>(c||!n||d.getMeta("preventDispatch")||this.hasCustomState||a.dispatch(d),l.every(e=>!0===e))});return u}createCan(e){const{rawCommands:t,state:n}=this,r=!1,o=e||n.tr,i=this.buildProps(o,r),a=Object.fromEntries(Object.entries(t).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(s(s({},i),{},{dispatch:void 0}))}]}));return s(s({},a),{},{chain:()=>this.createChain(o,r)})}buildProps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:r,state:o}=this,{view:i}=r,a={tr:e,editor:r,view:i,state:Og({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(a)}]}))}};return a}},zg={};Ag(zg,{blur:()=>Fg,clearContent:()=>Pg,clearNodes:()=>Bg,command:()=>Lg,createParagraphNear:()=>Ng,cut:()=>Ug,deleteCurrentNode:()=>Vg,deleteNode:()=>Hg,deleteRange:()=>Gg,deleteSelection:()=>Xg,enter:()=>Yg,exitCode:()=>qg,extendMarkRange:()=>tm,first:()=>nm,focus:()=>lm,forEach:()=>cm,insertContent:()=>dm,insertContentAt:()=>fm,joinBackward:()=>vm,joinDown:()=>mm,joinForward:()=>ym,joinItemBackward:()=>xm,joinItemForward:()=>bm,joinTextblockBackward:()=>wm,joinTextblockForward:()=>Sm,joinUp:()=>gm,keyboardShortcut:()=>Cm,lift:()=>_m,liftEmptyBlock:()=>Em,liftListItem:()=>Dm,newlineInCode:()=>Mm,resetAttributes:()=>Am,scrollIntoView:()=>Om,selectAll:()=>Rm,selectNodeBackward:()=>zm,selectNodeForward:()=>Fm,selectParentNode:()=>Pm,selectTextblockEnd:()=>Bm,selectTextblockStart:()=>Lm,setContent:()=>Um,setMark:()=>kv,setMeta:()=>Cv,setNode:()=>jv,setNodeSelection:()=>_v,setTextDirection:()=>Ev,setTextSelection:()=>Dv,sinkListItem:()=>Mv,splitBlock:()=>Iv,splitListItem:()=>Av,toggleList:()=>zv,toggleMark:()=>Fv,toggleNode:()=>Pv,toggleWrap:()=>Bv,undoInputRule:()=>Lv,unsetAllMarks:()=>Nv,unsetMark:()=>Uv,unsetTextDirection:()=>Vv,updateAttributes:()=>Wv,wrapIn:()=>Hv,wrapInList:()=>Gv});var Fg=()=>e=>{let{editor:t,view:n}=e;return requestAnimationFrame(()=>{var e;t.isDestroyed||(n.dom.blur(),null==(e=null==window?void 0:window.getSelection())||e.removeAllRanges())}),!0},Pg=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t=>{let{commands:n}=t;return n.setContent("",{emitUpdate:e})}},Bg=()=>e=>{let{state:t,tr:n,dispatch:r}=e;const{selection:o}=n,{ranges:i}=o;return!r||(i.forEach(e=>{let{$from:r,$to:o}=e;t.doc.nodesBetween(r.pos,o.pos,(e,t)=>{if(e.type.isText)return;const{doc:r,mapping:o}=n,i=r.resolve(o.map(t)),a=r.resolve(o.map(t+e.nodeSize)),s=i.blockRange(a);if(!s)return;const l=Ad(s);if(e.type.isTextblock){const{defaultType:e}=i.parent.contentMatchAt(i.index());n.setNodeMarkup(s.start,e)}(l||0===l)&&n.lift(s,l)})}),!0)},Lg=e=>t=>e(t),Ng=()=>e=>{let{state:t,dispatch:n}=e;return Uu(t,n)},Ug=(e,t)=>n=>{let{editor:r,tr:o}=n;const{state:i}=r,a=i.doc.slice(e.from,e.to);o.deleteRange(e.from,e.to);const s=o.mapping.map(t);return o.insert(s,a.content),o.setSelection(new lu(o.doc.resolve(Math.max(s-1,0)))),!0},Vg=()=>e=>{let{tr:t,dispatch:n}=e;const{selection:r}=t,o=r.$anchor.node();if(o.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1){if(i.node(a).type===o.type){if(n){const e=i.before(a),n=i.after(a);t.delete(e,n).scrollIntoView()}return!0}}return!1};function Wg(e,t){if("string"===typeof e){if(!t.nodes[e])throw Error("There is no node type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.nodes[e]}return e}var Hg=e=>t=>{let{tr:n,state:r,dispatch:o}=t;const i=Wg(e,r.schema),a=n.selection.$anchor;for(let e=a.depth;e>0;e-=1){if(a.node(e).type===i){if(o){const t=a.before(e),r=a.after(e);n.delete(t,r).scrollIntoView()}return!0}}return!1},Gg=e=>t=>{let{tr:n,dispatch:r}=t;const{from:o,to:i}=e;return r&&n.delete(o,i),!0},Xg=()=>e=>{let{state:t,dispatch:n}=e;return Eu(t,n)},Yg=()=>e=>{let{commands:t}=e;return t.keyboardShortcut("Enter")},qg=()=>e=>{let{state:t,dispatch:n}=e;return Nu(t,n)};function Zg(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function $g(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:Zg(t[r])?t[r].test(e[r]):t[r]===e[r])}function Kg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.find(e=>e.type===t&&$g(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function Jg(e,t){return!!Kg(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function Qg(e,t,n){var r;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if(o.node&&o.node.marks.some(e=>e.type===t)||(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(e=>e.type===t))return;n=n||(null==(r=o.node.marks[0])?void 0:r.attrs);if(!Kg([...o.node.marks],t,n))return;let i=o.index,a=e.start()+o.offset,s=i+1,l=a+o.node.nodeSize;for(;i>0&&Jg([...e.parent.child(i-1).marks],t,n);)i-=1,a-=e.parent.child(i).nodeSize;for(;s<e.parent.childCount&&Jg([...e.parent.child(s).marks],t,n);)l+=e.parent.child(s).nodeSize,s+=1;return{from:a,to:l}}function em(e,t){if("string"===typeof e){if(!t.marks[e])throw Error("There is no mark type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.marks[e]}return e}var tm=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;const a=em(e,o.schema),{doc:s,selection:l}=r,{$from:c,from:d,to:u}=l;if(i){const e=Qg(c,a,t);if(e&&e.from<=d&&e.to>=u){const t=lu.create(s,e.from,e.to);r.setSelection(t)}}return!0}},nm=e=>t=>{const n="function"===typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1};function rm(e){return e instanceof lu}function om(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(e,t),n)}function im(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return null;const n=ou.atStart(e),r=ou.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;const o=n.from,i=r.to;return"all"===t?lu.create(e,om(0,o,i),om(e.content.size,o,i)):lu.create(e,om(t,o,i),om(t,o,i))}function am(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function sm(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var lm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{editor:r,view:o,tr:i,dispatch:a}=n;t=s({scrollIntoView:!0},t);const l=()=>{(sm()||am())&&o.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(o.focus(),(null==t?void 0:t.scrollIntoView)&&r.commands.scrollIntoView())})};if(o.hasFocus()&&null===e||!1===e)return!0;if(a&&null===e&&!rm(r.state.selection))return l(),!0;const c=im(i.doc,e)||r.state.selection,d=r.state.selection.eq(c);return a&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0}},cm=(e,t)=>n=>e.every((e,r)=>t(e,s(s({},n),{},{index:r}))),dm=(e,t)=>n=>{let{tr:r,commands:o}=n;return o.insertContentAt({from:r.selection.from,to:r.selection.to},e,t)},um=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&um(r)}return e};function pm(e){if("undefined"===typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t="<body>".concat(e,"</body>"),n=(new window.DOMParser).parseFromString(t,"text/html").body;return um(n)}function hm(e,t,n){if(e instanceof Tc||e instanceof ac)return e;n=s({slice:!0,parseOptions:{}},n);const r="string"===typeof e;if("object"===typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return ac.fromArray(e.map(e=>t.nodeFromJSON(e)));const r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),hm("",t,n)}if(r){if(n.errorOnInvalidContent){let r=!1,o="";const i=new Zc({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,o="string"===typeof e?e:e.outerHTML,null)}]}})});if(n.slice?Kc.fromSchema(i).parseSlice(pm(e),n.parseOptions):Kc.fromSchema(i).parse(pm(e),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error("Invalid element found: ".concat(o))})}const r=Kc.fromSchema(t);return n.slice?r.parseSlice(pm(e),n.parseOptions).content:r.parse(pm(e),n.parseOptions)}return hm("",t,n)}var fm=(e,t,n)=>r=>{let{tr:o,dispatch:i,editor:a}=r;var l;if(i){let r;n=s({parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},n);const i=e=>{a.emit("contentError",{editor:a,error:e,disableCollaboration:()=>{"collaboration"in a.storage&&"object"===typeof a.storage.collaboration&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},d=s({preserveWhitespace:"full"},n.parseOptions);if(!n.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{hm(t,a.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(c){i(c)}try{r=hm(t,a.schema,{parseOptions:d,errorOnInvalidContent:null!=(l=n.errorOnInvalidContent)?l:a.options.enableContentCheck})}catch(c){return i(c),!1}let{from:u,to:p}="number"===typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,f=!0;if(("type"in r?[r]:r).forEach(e=>{e.check(),h=!!h&&(e.isText&&0===e.marks.length),f=!!f&&e.isBlock}),u===p&&f){const{parent:e}=o.doc.resolve(u);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(u-=1,p+=1)}let g;if(h){if(Array.isArray(t))g=t.map(e=>e.text||"").join("");else if(t instanceof ac){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),g=e}else g="object"===typeof t&&t&&t.text?t.text:t;o.insertText(g,u,p)}else{g=r;const e=o.doc.resolve(u),t=e.node(),n=0===e.parentOffset,i=t.isText||t.isTextblock,a=t.content.size>0;n&&i&&a&&(u=Math.max(0,u-1)),o.replaceWith(u,p,g)}n.updateSelection&&function(e,t,n){const r=e.steps.length-1;if(r<t)return;const o=e.steps[r];if(!(o instanceof Ed||o instanceof Dd))return;const i=e.mapping.maps[r];let a=0;i.forEach((e,t,n,r)=>{0===a&&(a=r)}),e.setSelection(ou.near(e.doc.resolve(a),n))}(o,o.steps.length-1,-1),n.applyInputRules&&o.setMeta("applyInputRules",{from:u,text:g}),n.applyPasteRules&&o.setMeta("applyPasteRules",{from:u,text:g})}return!0},gm=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,r=e.selection,o=r instanceof du;if(o){if(r.node.isTextblock||!Bd(e.doc,r.from))return!1;n=r.from}else if(n=Nd(e.doc,r.from,-1),null==n)return!1;if(t){let r=e.tr.join(n);o&&r.setSelection(du.create(r.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(r.scrollIntoView())}return!0})(t,n)},mm=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,r=e.selection;if(r instanceof du){if(r.node.isTextblock||!Bd(e.doc,r.to))return!1;n=r.to}else if(n=Nd(e.doc,r.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(t,n)},vm=()=>e=>{let{state:t,dispatch:n}=e;return Mu(t,n)},ym=()=>e=>{let{state:t,dispatch:n}=e;return zu(t,n)},xm=()=>e=>{let{state:t,dispatch:n,tr:r}=e;try{const e=Nd(t.doc,t.selection.$from.pos,-1);return null!==e&&void 0!==e&&(r.join(e,2),n&&n(r),!0)}catch(o){return!1}},bm=()=>e=>{let{state:t,dispatch:n,tr:r}=e;try{const e=Nd(t.doc,t.selection.$from.pos,1);return null!==e&&void 0!==e&&(r.join(e,2),n&&n(r),!0)}catch(o){return!1}},wm=()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let r=Du(e,n);if(!r)return!1;let o=Ou(r);return!!o&&Tu(e,o,t)})(t,n)},Sm=()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let r=Ru(e,n);if(!r)return!1;let o=Pu(r);return!!o&&Tu(e,o,t)})(t,n)};function km(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}var Cm=e=>t=>{let{editor:n,view:r,tr:o,dispatch:i}=t;const a=function(e){const t=e.split(/-(?!$)/);let n,r,o,i,a=t[t.length-1];"Space"===a&&(a=" ");for(let s=0;s<t.length-1;s+=1){const e=t[s];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))r=!0;else if(/^s(hift)?$/i.test(e))o=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: ".concat(e));sm()||km()?i=!0:r=!0}}return n&&(a="Alt-".concat(a)),r&&(a="Ctrl-".concat(a)),i&&(a="Meta-".concat(a)),o&&(a="Shift-".concat(a)),a}(e).split(/-(?!$)/),s=a.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),l=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(()=>{r.someProp("handleKeyDown",e=>e(r,l))});return null==c||c.steps.forEach(e=>{const t=e.map(o.mapping);t&&i&&o.maybeStep(t)}),!0};function jm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:r,to:o,empty:i}=e.selection,a=t?Wg(t,e.schema):null,s=[];e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText)return;const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s.push({node:e,from:n,to:i})});const l=o-r,c=s.filter(e=>!a||a.name===e.node.type.name).filter(e=>$g(e.node.attrs,n,{strict:!1}));if(i)return!!c.length;const d=c.reduce((e,t)=>e+t.to-t.from,0);return d>=l}var _m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return!!jm(r,Wg(e,r.schema),t)&&((e,t)=>{let{$from:n,$to:r}=e.selection,o=n.blockRange(r),i=o&&Ad(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)})(r,o)}},Em=()=>e=>{let{state:t,dispatch:n}=e;return Vu(t,n)},Dm=e=>t=>{let{state:n,dispatch:r}=t;return np(Wg(e,n.schema))(n,r)},Mm=()=>e=>{let{state:t,dispatch:n}=e;return Bu(t,n)};function Tm(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Im(e,t){const n="string"===typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}var Am=(e,t)=>n=>{let{tr:r,state:o,dispatch:i}=n,a=null,s=null;const l=Tm("string"===typeof e?e:e.name,o.schema);if(!l)return!1;"node"===l&&(a=Wg(e,o.schema)),"mark"===l&&(s=em(e,o.schema));let c=!1;return r.selection.ranges.forEach(e=>{o.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,n)=>{a&&a===e.type&&(c=!0,i&&r.setNodeMarkup(n,void 0,Im(e.attrs,t))),s&&e.marks.length&&e.marks.forEach(o=>{s===o.type&&(c=!0,i&&r.addMark(n,n+e.nodeSize,s.create(Im(o.attrs,t))))})})}),c},Om=()=>e=>{let{tr:t,dispatch:n}=e;return n&&t.scrollIntoView(),!0},Rm=()=>e=>{let{tr:t,dispatch:n}=e;if(n){const e=new pu(t.doc);t.setSelection(e)}return!0},zm=()=>e=>{let{state:t,dispatch:n}=e;return Au(t,n)},Fm=()=>e=>{let{state:t,dispatch:n}=e;return Fu(t,n)},Pm=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,{$from:r,to:o}=e.selection,i=r.sharedDepth(o);return 0!=i&&(n=r.before(i),t&&t(e.tr.setSelection(du.create(e.doc,n))),!0)})(t,n)},Bm=()=>e=>{let{state:t,dispatch:n}=e;return qu(t,n)},Lm=()=>e=>{let{state:t,dispatch:n}=e;return Yu(t,n)};function Nm(e,t){return hm(e,t,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}var Um=function(e){let{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:r={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{editor:i,tr:a,dispatch:s,commands:l}=o;const{doc:c}=a;if("full"!==r.preserveWhitespace){const o=Nm(e,i.schema,r,{errorOnInvalidContent:null!=t?t:i.options.enableContentCheck});return s&&a.replaceWith(0,c.content.size,o).setMeta("preventUpdate",!n),!0}return s&&a.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:c.content.size},e,{parseOptions:r,errorOnInvalidContent:null!=t?t:i.options.enableContentCheck})}};function Vm(e,t){const n=em(t,e.schema),{from:r,to:o,empty:i}=e.selection,a=[];i?(e.storedMarks&&a.push(...e.storedMarks),a.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,e=>{a.push(...e.marks)});const l=a.find(e=>e.type.name===n.name);return l?s({},l.attrs):{}}function Wm(e,t){const n=new nu(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function Hm(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}(t.$from,e)}function Gm(e,t,n){if(void 0===e.config[t]&&e.parent)return Gm(e.parent,t,n);if("function"===typeof e.config[t]){return e.config[t].bind(s(s({},n),{},{parent:e.parent?Gm(e.parent,t,n):null}))}return e.config[t]}function Xm(e){return e.map(e=>{const t=Gm(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...Xm(t())]:e}).flat(10)}function Ym(e,t){const n=sd.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function qm(e){return"function"===typeof e}function Zm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(qm(e)){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return t?e.bind(t)(...r):e(...r)}return e}function $m(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function Km(e){const t=[],{nodeExtensions:n,markExtensions:r}=$m(e),o=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=Gm(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:o});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(e=>{let[r,o]=e;t.push({type:n,name:r,attribute:s(s({},i),o)})})})})}),o.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Gm(e,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(n=>{let[r,o]=n;const a=s(s({},i),o);"function"===typeof(null==a?void 0:a.default)&&(a.default=a.default()),(null==a?void 0:a.isRequired)&&void 0===(null==a?void 0:a.default)&&delete a.default,t.push({type:e.name,name:r,attribute:a})})}),t}function Jm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>!!e).reduce((e,t)=>{const n=s({},e);return Object.entries(t).forEach(e=>{let[t,r]=e;if(n[t])if("class"===t){const e=r?String(r).split(" "):[],o=n[t]?n[t].split(" "):[],i=e.filter(e=>!o.includes(e));n[t]=[...o,...i].join(" ")}else if("style"===t){const e=r?r.split(";").map(e=>e.trim()).filter(Boolean):[],o=n[t]?n[t].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;o.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),e.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[t]=Array.from(i.entries()).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join("; ")}else n[t]=r;else n[t]=r}),n},{})}function Qm(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>Jm(e,t),{})}function ev(e,t){return"style"in e?e:s(s({},e),{},{getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const o=t.reduce((e,t)=>{const r=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!==typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null===r||void 0===r?e:s(s({},e),{},{[t.name]:r})},{});return s(s({},r),o)}})}function tv(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return("attrs"!==t||!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&e.constructor===Object}(n))&&(null!==n&&void 0!==n)}))}function nv(e){var t,n;const r={};return!(null==(t=null==e?void 0:e.attribute)?void 0:t.isRequired)&&"default"in((null==e?void 0:e.attribute)||{})&&(r.default=e.attribute.default),void 0!==(null==(n=null==e?void 0:e.attribute)?void 0:n.validate)&&(r.validate=e.attribute.validate),[e.name,r]}function rv(e,t){var n;const r=Km(e),{nodeExtensions:o,markExtensions:i}=$m(e),a=null==(n=o.find(e=>Gm(e,"topNode")))?void 0:n.name,l=Object.fromEntries(o.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},a=e.reduce((e,t)=>{const r=Gm(t,"extendNodeSchema",i);return s(s({},e),r?r(n):{})},{}),l=tv(s(s({},a),{},{content:Zm(Gm(n,"content",i)),marks:Zm(Gm(n,"marks",i)),group:Zm(Gm(n,"group",i)),inline:Zm(Gm(n,"inline",i)),atom:Zm(Gm(n,"atom",i)),selectable:Zm(Gm(n,"selectable",i)),draggable:Zm(Gm(n,"draggable",i)),code:Zm(Gm(n,"code",i)),whitespace:Zm(Gm(n,"whitespace",i)),linebreakReplacement:Zm(Gm(n,"linebreakReplacement",i)),defining:Zm(Gm(n,"defining",i)),isolating:Zm(Gm(n,"isolating",i)),attrs:Object.fromEntries(o.map(nv))})),c=Zm(Gm(n,"parseHTML",i));c&&(l.parseDOM=c.map(e=>ev(e,o)));const d=Gm(n,"renderHTML",i);d&&(l.toDOM=e=>d({node:e,HTMLAttributes:Qm(e,o)}));const u=Gm(n,"renderText",i);return u&&(l.toText=u),[n.name,l]})),c=Object.fromEntries(i.map(n=>{const o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},a=e.reduce((e,t)=>{const r=Gm(t,"extendMarkSchema",i);return s(s({},e),r?r(n):{})},{}),l=tv(s(s({},a),{},{inclusive:Zm(Gm(n,"inclusive",i)),excludes:Zm(Gm(n,"excludes",i)),group:Zm(Gm(n,"group",i)),spanning:Zm(Gm(n,"spanning",i)),code:Zm(Gm(n,"code",i)),attrs:Object.fromEntries(o.map(nv))})),c=Zm(Gm(n,"parseHTML",i));c&&(l.parseDOM=c.map(e=>ev(e,o)));const d=Gm(n,"renderHTML",i);return d&&(l.toDOM=e=>d({mark:e,HTMLAttributes:Qm(e,o)})),[n.name,l]}));return new Zc({topNode:a,nodes:l,marks:c})}function ov(e){return e.sort((e,t)=>{const n=Gm(e,"priority")||100,r=Gm(t,"priority")||100;return n>r?-1:n<r?1:0})}function iv(e){const t=ov(Xm(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name));return n.length&&console.warn("[tiptap warn]: Duplicate extension names found: [".concat(n.map(e=>"'".concat(e,"'")).join(", "),"]. This can lead to issues.")),t}function av(e,t,n){const{from:r,to:o}=t,{blockSeparator:i="\n\n",textSerializers:a={}}=n||{};let s="";return e.nodesBetween(r,o,(e,n,l,c)=>{var d;e.isBlock&&n>r&&(s+=i);const u=null==a?void 0:a[e.type.name];if(u)return l&&(s+=u({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(s+=null==(d=null==e?void 0:e.text)?void 0:d.slice(Math.max(r,n)-n,o-n))}),s}function sv(e,t){return av(e,{from:0,to:e.content.size},t)}function lv(e){return Object.fromEntries(Object.entries(e.nodes).filter(e=>{let[,t]=e;return t.spec.toText}).map(e=>{let[t,n]=e;return[t,n.spec.toText]}))}function cv(e,t){const n=Tm("string"===typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=Wg(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,e=>{i.push(e)});const a=i.reverse().find(e=>e.type.name===n.name);return a?s({},a.attrs):{}}(e,t):"mark"===n?Vm(e,t):{}}function dv(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify;const n={};return e.filter(e=>{const r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{const r=t.filter((e,t)=>t!==n);return!r.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}function uv(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((e,o)=>{const i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{const{from:e,to:t}=n[o];if(void 0===e||void 0===t)return;i.push({from:e,to:t})}i.forEach(e=>{let{from:n,to:i}=e;const a=t.slice(o).map(n,-1),s=t.slice(o).map(i),l=t.invert().map(a,-1),c=t.invert().map(s);r.push({oldRange:{from:l,to:c},newRange:{from:a,to:s}})})}),dv(r)}function pv(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(t=>{const o=Qg(n.resolve(e),t.type);o&&r.push(s({mark:t},o))}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null==e?void 0:e.nodeSize)&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function hv(e,t){return t.nodes[e]||t.marks[e]||null}function fv(e,t,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[r]=n;const o=e.find(e=>e.type===t&&e.name===r);return!!o&&o.attribute.keepOnSplit}))}function gv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:r,ranges:o}=e.selection,i=t?em(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>$g(e.attrs,n,{strict:!1}));let a=0;const s=[];if(o.forEach(t=>{let{$from:n,$to:r}=t;const o=n.pos,i=r.pos;e.doc.nodesBetween(o,i,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(o,t),r=Math.min(i,t+e.nodeSize);a+=r-n,s.push(...e.marks.map(e=>({mark:e,from:n,to:r})))})}),0===a)return!1;const l=s.filter(e=>!i||i.name===e.mark.type.name).filter(e=>$g(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=s.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=a}function mv(e,t){return Array.isArray(t)?t.some(t=>("string"===typeof t?t:t.name)===e.name):t}function vv(e,t){const{nodeExtensions:n}=$m(t),r=n.find(t=>t.name===e);if(!r)return!1;const o=Zm(Gm(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"===typeof o&&o.split(" ").includes("list")}function yv(e){let{checkChildren:t=!0,ignoreWhitespace:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(yv(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function xv(e){return e instanceof du}var bv=class e{constructor(e){this.position=e}static fromJSON(t){return new e(t.position)}toJSON(){return{position:this.position}}};function wv(e,t){const n=t.mapping.mapResult(e.position);return{position:new bv(n.pos),mapResult:n}}function Sv(e){return new bv(e)}var kv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;const{selection:a}=r,{empty:l,ranges:c}=a,d=em(e,o.schema);if(i)if(l){const e=Vm(o,d);r.addStoredMark(d.create(s(s({},e),t)))}else c.forEach(e=>{const n=e.$from.pos,i=e.$to.pos;o.doc.nodesBetween(n,i,(e,o)=>{const a=Math.max(o,n),l=Math.min(o+e.nodeSize,i);e.marks.find(e=>e.type===d)?e.marks.forEach(e=>{d===e.type&&r.addMark(a,l,d.create(s(s({},e.attrs),t)))}):r.addMark(a,l,d.create(t))})});return function(e,t,n){var r;const{selection:o}=t;let i=null;if(rm(o)&&(i=o.$cursor),i){const t=null!=(r=e.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(t)||!t.some(e=>e.type.excludes(n)))}const{ranges:a}=o;return a.some(t=>{let{$from:r,$to:o}=t,i=0===r.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(r.pos,o.pos,(e,t,r)=>{if(i)return!1;if(e.isInline){const t=!r||r.type.allowsMarkType(n),o=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));i=t&&o}return!i}),i})}(o,r,d)}},Cv=(e,t)=>n=>{let{tr:r}=n;return r.setMeta(e,t),!0},jv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o,chain:i}=n;const a=Wg(e,r.schema);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a.isTextblock?i().command(e=>{let{commands:n}=e;return!!Zu(a,s(s({},l),t))(r)||n.clearNodes()}).command(e=>{let{state:n}=e;return Zu(a,s(s({},l),t))(n,o)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},_v=e=>t=>{let{tr:n,dispatch:r}=t;if(r){const{doc:t}=n,r=om(e,0,t.content.size),o=du.create(t,r);n.setSelection(o)}return!0},Ev=(e,t)=>n=>{let{tr:r,state:o,dispatch:i}=n;const{selection:a}=o;let l,c;return"number"===typeof t?(l=t,c=t):t&&"from"in t&&"to"in t?(l=t.from,c=t.to):(l=a.from,c=a.to),i&&r.doc.nodesBetween(l,c,(t,n)=>{t.isText||r.setNodeMarkup(n,void 0,s(s({},t.attrs),{},{dir:e}))}),!0},Dv=e=>t=>{let{tr:n,dispatch:r}=t;if(r){const{doc:t}=n,{from:r,to:o}="number"===typeof e?{from:e,to:e}:e,i=lu.atStart(t).from,a=lu.atEnd(t).to,s=om(r,i,a),l=om(o,i,a),c=lu.create(t,s,l);n.setSelection(c)}return!0},Mv=e=>t=>{let{state:n,dispatch:r}=t;const o=Wg(e,n.schema);return(i=o,function(e,t){let{$from:n,$to:r}=e.selection,o=n.blockRange(r,e=>e.childCount>0&&e.firstChild.type==i);if(!o)return!1;let a=o.startIndex;if(0==a)return!1;let s=o.parent,l=s.child(a-1);if(l.type!=i)return!1;if(t){let n=l.lastChild&&l.lastChild.type==s.type,r=ac.from(n?i.create():null),a=new pc(ac.from(i.create(null,ac.from(s.type.create(null,r)))),n?3:1,0),c=o.start,d=o.end;t(e.tr.step(new Dd(c-(n?3:1),d,c,d,a,1,!0)).scrollIntoView())}return!0})(n,r);var i};function Tv(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}var Iv=function(){let{keepMarks:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{tr:n,state:r,dispatch:o,editor:i}=t;const{selection:a,doc:s}=n,{$from:l,$to:c}=a,d=fv(i.extensionManager.attributes,l.node().type.name,l.node().attrs);if(a instanceof du&&a.node.isBlock)return!(!l.parentOffset||!Pd(s,l.pos))&&(o&&(e&&Tv(r,i.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const u=c.parentOffset===c.parent.content.size,p=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=u&&p?[{type:p,attrs:d}]:void 0,f=Pd(n.doc,n.mapping.map(l.pos),1,h);if(h||f||!Pd(n.doc,n.mapping.map(l.pos),1,p?[{type:p}]:void 0)||(f=!0,h=p?[{type:p,attrs:d}]:void 0),o){if(f&&(a instanceof lu&&n.deleteSelection(),n.split(n.mapping.map(l.pos),1,h),p&&!u&&!l.parentOffset&&l.parent.type!==p)){const e=n.mapping.map(l.before()),t=n.doc.resolve(e);l.node(-1).canReplaceWith(t.index(),t.index()+1,p)&&n.setNodeMarkup(n.mapping.map(l.before()),p)}e&&Tv(r,i.extensionManager.splittableMarks),n.scrollIntoView()}return f}},Av=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i,editor:a}=n;var l;const c=Wg(e,o.schema),{$from:d,$to:u}=o.selection,p=o.selection.node;if(p&&p.isBlock||d.depth<2||!d.sameParent(u))return!1;const h=d.node(-1);if(h.type!==c)return!1;const f=a.extensionManager.attributes;if(0===d.parent.content.size&&d.node(-1).childCount===d.indexAfter(-1)){if(2===d.depth||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let e=ac.empty;const n=d.index(-1)?1:d.index(-2)?2:3;for(let t=d.depth-n;t>=d.depth-3;t-=1)e=ac.from(d.node(t).copy(e));const o=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,i=s(s({},fv(f,d.node().type.name,d.node().attrs)),t),a=(null==(l=c.contentMatch.defaultType)?void 0:l.createAndFill(i))||void 0;e=e.append(ac.from(c.createAndFill(null,a)||void 0));const u=d.before(d.depth-(n-1));r.replace(u,d.after(-o),new pc(e,4-n,0));let p=-1;r.doc.nodesBetween(u,r.doc.content.size,(e,t)=>{if(p>-1)return!1;e.isTextblock&&0===e.content.size&&(p=t+1)}),p>-1&&r.setSelection(lu.near(r.doc.resolve(p))),r.scrollIntoView()}return!0}const g=u.pos===d.end()?h.contentMatchAt(0).defaultType:null,m=s(s({},fv(f,h.type.name,h.attrs)),t),v=s(s({},fv(f,d.node().type.name,d.node().attrs)),t);r.delete(d.pos,u.pos);const y=g?[{type:c,attrs:m},{type:g,attrs:v}]:[{type:c,attrs:m}];if(!Pd(r.doc,d.pos,2))return!1;if(i){const{selection:e,storedMarks:t}=o,{splittableMarks:n}=a.extensionManager,s=t||e.$to.parentOffset&&e.$from.marks();if(r.split(d.pos,2,y).scrollIntoView(),!s||!i)return!0;const l=s.filter(e=>n.includes(e.type.name));r.ensureMarks(l)}return!0}},Ov=(e,t)=>{const n=Hm(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!Bd(e.doc,n.pos)||(e.join(n.pos),!0)},Rv=(e,t)=>{const n=Hm(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const o=e.doc.nodeAt(r);return n.node.type!==(null==o?void 0:o.type)||!Bd(e.doc,r)||(e.join(r),!0)},zv=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o=>{let{editor:i,tr:a,state:s,dispatch:l,chain:c,commands:d,can:u}=o;const{extensions:p,splittableMarks:h}=i.extensionManager,f=Wg(e,s.schema),g=Wg(t,s.schema),{selection:m,storedMarks:v}=s,{$from:y,$to:x}=m,b=y.blockRange(x),w=v||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const S=Hm(e=>vv(e.type.name,p))(m);if(b.depth>=1&&S&&b.depth-S.depth<=1){if(S.node.type===f)return d.liftListItem(g);if(vv(S.node.type.name,p)&&f.validContent(S.node.content)&&l)return c().command(()=>(a.setNodeMarkup(S.pos,f),!0)).command(()=>Ov(a,f)).command(()=>Rv(a,f)).run()}return n&&w&&l?c().command(()=>{const e=u().wrapInList(f,r),t=w.filter(e=>h.includes(e.type.name));return a.ensureMarks(t),!!e||d.clearNodes()}).wrapInList(f,r).command(()=>Ov(a,f)).command(()=>Rv(a,f)).run():c().command(()=>!!u().wrapInList(f,r)||d.clearNodes()).wrapInList(f,r).command(()=>Ov(a,f)).command(()=>Rv(a,f)).run()}},Fv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:o,commands:i}=r;const{extendEmptyMarkRange:a=!1}=n,s=em(e,o.schema);return gv(o,s,t)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,t)}},Pv=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:o,commands:i}=r;const a=Wg(e,o.schema),l=Wg(t,o.schema),c=jm(o,a,n);let d;return o.selection.$anchor.sameParent(o.selection.$head)&&(d=o.selection.$anchor.parent.attrs),c?i.setNode(l,d):i.setNode(a,s(s({},d),n))}},Bv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,commands:o}=n;const i=Wg(e,r.schema);return jm(r,i,t)?o.lift(i):o.wrapIn(i,t)}},Lv=()=>e=>{let{state:t,dispatch:n}=e;const r=t.plugins;for(let o=0;o<r.length;o+=1){const e=r[o];let i;if(e.spec.isInputRules&&(i=e.getState(t))){if(n){const e=t.tr,n=i.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(i.text){const n=e.doc.resolve(i.from).marks();e.replaceWith(i.from,i.to,t.schema.text(i.text,n))}else e.delete(i.from,i.to)}return!0}}return!1},Nv=()=>e=>{let{tr:t,dispatch:n}=e;const{selection:r}=t,{empty:o,ranges:i}=r;return o||n&&i.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},Uv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n;var a;const{extendEmptyMarkRange:s=!1}=t,{selection:l}=r,c=em(e,o.schema),{$from:d,empty:u,ranges:p}=l;if(!i)return!0;if(u&&s){let{from:e,to:t}=l;const n=null==(a=d.marks().find(e=>e.type===c))?void 0:a.attrs,o=Qg(d,c,n);o&&(e=o.from,t=o.to),r.removeMark(e,t,c)}else p.forEach(e=>{r.removeMark(e.$from.pos,e.$to.pos,c)});return r.removeStoredMark(c),!0}},Vv=e=>t=>{let{tr:n,state:r,dispatch:o}=t;const{selection:i}=r;let a,l;return"number"===typeof e?(a=e,l=e):e&&"from"in e&&"to"in e?(a=e.from,l=e.to):(a=i.from,l=i.to),o&&n.doc.nodesBetween(a,l,(e,t)=>{if(e.isText)return;const r=s({},e.attrs);delete r.dir,n.setNodeMarkup(t,void 0,r)}),!0},Wv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:o,dispatch:i}=n,a=null,l=null;const c=Tm("string"===typeof e?e:e.name,o.schema);if(!c)return!1;"node"===c&&(a=Wg(e,o.schema)),"mark"===c&&(l=em(e,o.schema));let d=!1;return r.selection.ranges.forEach(e=>{const n=e.$from.pos,c=e.$to.pos;let u,p,h,f;r.selection.empty?o.doc.nodesBetween(n,c,(e,t)=>{a&&a===e.type&&(d=!0,h=Math.max(t,n),f=Math.min(t+e.nodeSize,c),u=t,p=e)}):o.doc.nodesBetween(n,c,(e,o)=>{o<n&&a&&a===e.type&&(d=!0,h=Math.max(o,n),f=Math.min(o+e.nodeSize,c),u=o,p=e),o>=n&&o<=c&&(a&&a===e.type&&(d=!0,i&&r.setNodeMarkup(o,void 0,s(s({},e.attrs),t))),l&&e.marks.length&&e.marks.forEach(a=>{if(l===a.type&&(d=!0,i)){const i=Math.max(o,n),d=Math.min(o+e.nodeSize,c);r.addMark(i,d,l.create(s(s({},a.attrs),t)))}}))}),p&&(void 0!==u&&i&&r.setNodeMarkup(u,void 0,s(s({},p.attrs),t)),l&&p.marks.length&&p.marks.forEach(e=>{l===e.type&&i&&r.addMark(h,f,l.create(s(s({},e.attrs),t)))}))}),d}},Hv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let{$from:o,$to:i}=n.selection,a=o.blockRange(i),s=a&&Od(a,e,t);return!!s&&(r&&r(n.tr.wrap(a,s).scrollIntoView()),!0)}}(Wg(e,r.schema),t)(r,o)}},Gv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:o}=n;return tp(Wg(e,r.schema),t)(r,o)}},Xv=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const o=this.callbacks[e];return o&&o.forEach(e=>e.apply(this,n)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){var n=this;const r=function(){n.off(e,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];t.apply(n,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}},Yv=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=null==(t=e.undoable)||t}};function qv(e){var t;const{editor:n,from:r,to:o,text:i,rules:a,plugin:s}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let d=!1;const u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,o,i)=>{var a,s;const l=(null==(s=(a=e.type.spec).toText)?void 0:s.call(a,{node:e,pos:t,parent:o,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n}(c)+i;return a.forEach(e=>{if(d)return;const t=((e,t)=>{if(Zg(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(u,e.find);if(!t)return;const a=l.state.tr,c=Og({state:l.state,transaction:a}),p={from:r-(t[0].length-i.length),to:o},{commands:h,chain:f,can:g}=new Rg({editor:n,state:c});null!==e.handler({state:c,range:p,match:t,commands:h,chain:f,can:g})&&a.steps.length&&(e.undoable&&a.setMeta(s,{transform:a,from:r,to:o,text:i}),l.dispatch(a),d=!0)}),d}function Zv(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function $v(e,t){const n=s({},e);return Zv(e)&&Zv(t)&&Object.keys(t).forEach(r=>{Zv(t[r])&&Zv(e[r])?n[r]=$v(e[r],t[r]):n[r]=t[r]}),n}var Kv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=s(s({},this.config),e),this.name=this.config.name}get options(){return s({},Zm(Gm(this,"addOptions",{name:this.name}))||{})}get storage(){return s({},Zm(Gm(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend(s(s({},this.config),{},{addOptions:()=>$v(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new this.constructor(s(s({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Jv=class e extends Kv{constructor(){super(...arguments),this.type="mark"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}static handleExit(e){let{editor:t,mark:n}=e;const{tr:r}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){const e=o.marks(),i=!!e.find(e=>(null==e?void 0:e.type.name)===n.name);if(!i)return!1;const a=e.find(e=>(null==e?void 0:e.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",o.pos),t.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}};var Qv=class{constructor(e){this.find=e.find,this.handler=e.handler}};function ey(e){const{editor:t,state:n,from:r,to:o,rule:i,pasteEvent:a,dropEvent:s}=e,{commands:l,chain:c,can:d}=new Rg({editor:t,state:n}),u=[];n.doc.nodesBetween(r,o,(e,t)=>{var p,h,f,g,m;if((null==(h=null==(p=e.type)?void 0:p.spec)?void 0:h.code)||!(e.isText||e.isTextblock||e.isInline))return;const v=null!=(m=null!=(g=null==(f=e.content)?void 0:f.size)?g:e.nodeSize)?m:0,y=Math.max(r,t),x=Math.min(o,t+v);if(y>=x)return;((e,t,n)=>{if(Zg(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.isText?e.text||"":e.textBetween(y-t,x-t,void 0,"\ufffc"),i.find,a).forEach(e=>{if(void 0===e.index)return;const t=y+e.index+1,r=t+e[0].length,o={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},p=i.handler({state:n,range:o,match:e,commands:l,chain:c,can:d,pasteEvent:a,dropEvent:s});u.push(p)})});return u.every(e=>null!==e)}var ty=null;function ny(e){const{editor:t,rules:n}=e;let r,o=null,i=!1,a=!1,s="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(d){r=null}const l=e=>{let{state:n,from:o,to:i,rule:a,pasteEvt:l}=e;const c=n.tr,d=Og({state:n,transaction:c});if(ey({editor:t,state:d,from:Math.max(o-1,0),to:i.b-1,rule:a,pasteEvent:l,dropEvent:r})&&c.steps.length){try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(u){r=null}return s="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}},c=n.map(e=>new ku({view(e){const n=n=>{var r;o=(null==(r=e.dom.parentElement)?void 0:r.contains(n.target))?e.dom.parentElement:null,o&&(ty=t)},r=()=>{ty&&(ty=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(a=o===e.dom.parentElement,r=t,!a){const e=ty;(null==e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return s=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{const o=t[0],c="paste"===o.getMeta("uiEvent")&&!i,d="drop"===o.getMeta("uiEvent")&&!a,u=o.getMeta("applyPasteRules"),p=!!u;if(!c&&!d&&!p)return;if(p){let{text:t}=u;"string"===typeof t||(t=Ym(ac.from(t),r.schema));const{from:n}=u,o=n+t.length,i=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n})(t);return l({rule:e,state:r,from:n,to:{b:o},pasteEvt:i})}const h=n.doc.content.findDiffStart(r.doc.content),f=n.doc.content.findDiffEnd(r.doc.content);return function(e){return"number"===typeof e}(h)&&f&&h!==f.b?l({rule:e,state:r,from:h,to:f,pasteEvt:s}):void 0}}));return c}var ry=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=iv(e),this.schema=rv(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const n=Gm(t,"addCommands",{name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:hv(t.name,this.schema)});return n?s(s({},e),n()):e},{})}get plugins(){const{editor:e}=this,t=ov([...this.extensions].reverse()).flatMap(t=>{const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:hv(t.name,this.schema)},r=[],o=Gm(t,"addKeyboardShortcuts",n);let i={};if("mark"===t.type&&Gm(t,"exitable",n)&&(i.ArrowRight=()=>Jv.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(t=>{let[n,r]=t;return[n,()=>r({editor:e})]}));i=s(s({},i),t)}const a=new ku({props:{handleKeyDown:Tg(i)}});r.push(a);const l=Gm(t,"addInputRules",n);if(mv(t,e.options.enableInputRules)&&l){const t=l();if(t&&t.length){const n=function(e){const{editor:t,rules:n}=e,r=new ku({state:{init:()=>null,apply(e,o,i){const a=e.getMeta(r);if(a)return a;const s=e.getMeta("applyInputRules");return!!s&&setTimeout(()=>{let{text:e}=s;"string"===typeof e||(e=Ym(ac.from(e),i.schema));const{from:o}=s,a=o+e.length;qv({editor:t,from:o,to:a,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:o}},props:{handleTextInput:(e,o,i,a)=>qv({editor:t,from:o,to:i,text:a,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:o}=e.state.selection;o&&qv({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,o){if("Enter"!==o.key)return!1;const{$cursor:i}=e.state.selection;return!!i&&qv({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:t}),o=Array.isArray(n)?n:[n];r.push(...o)}}const c=Gm(t,"addPasteRules",n);if(mv(t,e.options.enablePasteRules)&&c){const t=c();if(t&&t.length){const n=ny({editor:e,rules:t});r.push(...n)}}const d=Gm(t,"addProseMirrorPlugins",n);if(d){const e=d();r.push(...e)}return r});return t}get attributes(){return Km(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=$m(this.extensions);return Object.fromEntries(t.filter(e=>!!Gm(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:Wg(t.name,this.schema)},o=Gm(t,"addNodeView",r);if(!o)return[];const i=o();if(!i)return[];return[t.name,(r,o,a,s,l)=>{const c=Qm(r,n);return i({node:r,view:o,getPos:a,decorations:s,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}get markViews(){const{editor:e}=this,{markExtensions:t}=$m(this.extensions);return Object.fromEntries(t.filter(e=>!!Gm(e,"addMarkView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:em(t.name,this.schema)},o=Gm(t,"addMarkView",r);if(!o)return[];return[t.name,(r,i,a)=>{const s=Qm(r,n);return o()({mark:r,view:i,inline:a,editor:e,extension:t,HTMLAttributes:s,updateAttributes:t=>{Ty(r,e,t)}})}]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(e=>[e.name,e.storage])),e.forEach(e=>{var t;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:hv(e.name,this.schema)};if("mark"===e.type){(null==(t=Zm(Gm(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name)}const r=Gm(e,"onBeforeCreate",n),o=Gm(e,"onCreate",n),i=Gm(e,"onUpdate",n),a=Gm(e,"onSelectionUpdate",n),s=Gm(e,"onTransaction",n),l=Gm(e,"onFocus",n),c=Gm(e,"onBlur",n),d=Gm(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),s&&this.editor.on("transaction",s),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}};ry.resolve=iv,ry.sort=ov,ry.flatten=Xm;Ag({},{ClipboardTextSerializer:()=>iy,Commands:()=>ay,Delete:()=>sy,Drop:()=>ly,Editable:()=>cy,FocusEvents:()=>uy,Keymap:()=>py,Paste:()=>hy,Tabindex:()=>fy,TextDirection:()=>gy,focusEventsPluginKey:()=>dy});var oy=class e extends Kv{constructor(){super(...arguments),this.type="extension"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}},iy=oy.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new ku({key:new _u("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{ranges:i}=o,a=Math.min(...i.map(e=>e.$from.pos)),l=Math.max(...i.map(e=>e.$to.pos)),c=lv(n);return av(r,{from:a,to:l},s(s({},void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{}),{},{textSerializers:c}))}}})]}}),ay=oy.create({name:"commands",addCommands:()=>s({},zg)}),sy=oy.create({name:"delete",onUpdate(e){let{transaction:t,appendedTransactions:n}=e;var r,o,i;const a=()=>{var e,r,o,i;if(null!=(i=null==(o=null==(r=null==(e=this.editor.options.coreExtensionOptions)?void 0:e.delete)?void 0:r.filterTransaction)?void 0:o.call(r,t))?i:t.getMeta("y-sync$"))return;const a=Wm(t.before,[t,...n]);uv(a).forEach(e=>{a.mapping.mapResult(e.oldRange.from).deletedAfter&&a.mapping.mapResult(e.oldRange.to).deletedBefore&&a.before.nodesBetween(e.oldRange.from,e.oldRange.to,(n,r)=>{const o=r+n.nodeSize-2,i=e.oldRange.from<=r&&o<=e.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:r,to:o,newFrom:a.mapping.map(r),newTo:a.mapping.map(o),deletedRange:e.oldRange,newRange:e.newRange,partial:!i,editor:this.editor,transaction:t,combinedTransform:a})})});const s=a.mapping;a.steps.forEach((e,n)=>{var r,o;if(e instanceof Cd){const i=s.slice(n).map(e.from,-1),l=s.slice(n).map(e.to),c=s.invert().map(i,-1),d=s.invert().map(l),u=null==(r=a.doc.nodeAt(i-1))?void 0:r.marks.some(t=>t.eq(e.mark)),p=null==(o=a.doc.nodeAt(l))?void 0:o.marks.some(t=>t.eq(e.mark));this.editor.emit("delete",{type:"mark",mark:e.mark,from:e.from,to:e.to,deletedRange:{from:c,to:d},newRange:{from:i,to:l},partial:Boolean(p||u),editor:this.editor,transaction:t,combinedTransform:a})}})};null==(i=null==(o=null==(r=this.editor.options.coreExtensionOptions)?void 0:r.delete)?void 0:o.async)||i?setTimeout(a,0):a()}}),ly=oy.create({name:"drop",addProseMirrorPlugins(){return[new ku({key:new _u("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),cy=oy.create({name:"editable",addProseMirrorPlugins(){return[new ku({key:new _u("editable"),props:{editable:()=>this.editor.options.editable}})]}}),dy=new _u("focusEvents"),uy=oy.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new ku({key:dy,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),py=oy.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.undoInputRule(),()=>t.command(e=>{let{tr:n}=e;const{selection:r,doc:o}=n,{empty:i,$anchor:a}=r,{pos:s,parent:l}=a,c=a.parent.isTextblock&&s>0?n.doc.resolve(s-1):a,d=c.parent.type.spec.isolating,u=a.pos-a.parentOffset,p=d&&1===c.parent.childCount?u===a.pos:ou.atStart(o).from===s;return!(!i||!l.type.isTextblock||l.textContent.length||!p||p&&"paragraph"===a.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]}),t=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]}),n={Enter:()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]}),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r=s({},n),o=s(s({},n),{},{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return sm()||km()?o:r},addProseMirrorPlugins(){return[new ku({key:new _u("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),o=e.some(e=>e.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:a,to:s}=t.selection,l=ou.atStart(t.doc).from,c=ou.atEnd(t.doc).to;if(i||!(a===l&&s===c))return;if(!yv(n.doc))return;const d=n.tr,u=Og({state:n,transaction:d}),{commands:p}=new Rg({editor:this.editor,state:u});return p.clearNodes(),d.steps.length?d:void 0}})]}}),hy=oy.create({name:"paste",addProseMirrorPlugins(){return[new ku({key:new _u("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),fy=oy.create({name:"tabindex",addProseMirrorPlugins(){return[new ku({key:new _u("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),gy=oy.create({name:"textDirection",addOptions:()=>({direction:void 0}),addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=$m(this.extensions);return[{types:e.filter(e=>"text"!==e.name).map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const t=e.getAttribute("dir");return!t||"ltr"!==t&&"rtl"!==t&&"auto"!==t?this.options.direction:t},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new ku({key:new _u("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),my=class e{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error("You can\u2019t set content on a block node. Tried to set content on ".concat(this.name," at ").concat(this.pos));t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new e(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new e(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new e(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const o=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,a=this.pos+r+(i?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const s=this.resolvedPos.doc.resolve(a);if(!o&&s.depth<=this.depth)return;const l=new e(s,this.editor,o,o?n:null);o&&(l.actualDepth=this.depth+1),t.push(new e(s,this.editor,o,o?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){const e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];if(e[o]!==t[o])break}}else n=r;r=r.parent}return n}querySelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];if(!this.children||0===this.children.length)return r;const o=Object.keys(t);return this.children.forEach(i=>{if(!(n&&r.length>0)){if(i.node.type.name===e){const e=o.every(e=>t[e]===i.node.attrs[e]);e&&r.push(i)}n&&r.length>0||(r=r.concat(i.querySelectorAll(e,t,n)))}}),r}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,s(s({},this.node.attrs),e)),this.editor.view.dispatch(t)}};var vy=class extends Xv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!==typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:e=>{let{error:t}=e;throw t},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:wv,createMappablePosition:Sv},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",e=>{let{event:t,slice:n,moved:r}=e;return this.options.onDrop(t,n,r)}),this.on("paste",e=>{let{event:t,slice:n}=e;return this.options.onPaste(t,n)}),this.on("delete",this.options.onDelete);const t=this.createDoc(),n=im(t,this.options.autofocus);this.editorState=wu.create({doc:t,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if("undefined"===typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(!1!==this.options.autofocus&&null!==this.options.autofocus&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;(null==e?void 0:e.editor)&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(".".concat(this.className)).length)try{"function"===typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!==typeof document&&(this.css=function(e,t,n){const r=document.querySelector("style[data-tiptap-style".concat(n?"-".concat(n):"","]"));if(null!==r)return r;const o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style".concat(n?"-".concat(n):""),""),o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o),o}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',this.options.injectNonce))}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=s(s({},this.options),e),this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if("state"===t)return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error("[tiptap error]: The editor view is not available. Cannot access view['".concat(t,"']. The editor may not be mounted yet."))}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const n=qm(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"===typeof e?"".concat(e,"$"):e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[cy,iy.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),ay,uy,py,fy,ly,hy,sy,gy.configure({direction:this.options.textDirection})].filter(e=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new ry(n,this)}createCommandManager(){this.commandManager=new Rg({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Nm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&"object"===typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=Nm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new fg(e,s(s({},this.options.editorProps),{},{attributes:s({role:"textbox"},null==(t=this.options.editorProps)?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className="".concat(this.className," ").concat(this.view.dom.className)}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)}):void(this.capturedTransaction=e);const{state:t,transactions:n}=this.state.applyTransaction(e),r=!this.state.selection.eq(t.selection),o=n.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const a=n.findLast(e=>e.getMeta("focus")||e.getMeta("blur")),s=null==a?void 0:a.getMeta("focus"),l=null==a?void 0:a.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:a}),l&&this.emit("blur",{editor:this,event:l.event,transaction:a}),e.getMeta("preventUpdate")||!n.some(e=>e.docChanged)||i.doc.eq(t.doc)||this.emit("update",{editor:this,transaction:e,appendedTransactions:n.slice(1)})}getAttributes(e){return cv(this.state,e)}isActive(e,t){const n="string"===typeof e?e:null,r="string"===typeof e?t:e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return jm(e,null,n)||gv(e,null,n);const r=Tm(t,e.schema);return"node"===r?jm(e,t,n):"mark"===r&&gv(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ym(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return sv(this.state.doc,{blockSeparator:t,textSerializers:s(s({},lv(this.schema)),n)})}get isEmpty(){return yv(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return null==(t=null==(e=this.editorView)?void 0:e.isDestroyed)||t}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new my(t,this)}get $doc(){return this.$pos(0)}};function yy(e){return new Yv({find:e.find,handler:t=>{let{state:n,range:r,match:o}=t;const i=Zm(e.getAttributes,void 0,o);if(!1===i||null===i)return null;const{tr:a}=n,s=o[o.length-1],l=o[0];if(s){const t=l.search(/\S/),o=r.from+l.indexOf(s),c=o+s.length;if(pv(r.from,r.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>o).length)return null;c<r.to&&a.delete(c,r.to),o>r.from&&a.delete(r.from+t,o);const d=r.from+t+s.length;a.addMark(r.from+t,d,e.type.create(i||{})),a.removeStoredMark(e.type)}},undoable:e.undoable})}function xy(e){return new Yv({find:e.find,handler:t=>{let{state:n,range:r,match:o}=t;const i=n.doc.resolve(r.from),a=Zm(e.getAttributes,void 0,o)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;n.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,a)},undoable:e.undoable})}function by(e){return new Yv({find:e.find,handler:t=>{let{state:n,range:r,match:o,chain:i}=t;const a=Zm(e.getAttributes,void 0,o)||{},s=n.tr.delete(r.from,r.to),l=s.doc.resolve(r.from).blockRange(),c=l&&Od(l,e.type,a);if(!c)return null;if(s.wrap(l,c),e.keepMarks&&e.editor){const{selection:t,storedMarks:r}=n,{splittableMarks:o}=e.editor.extensionManager,i=r||t.$to.parentOffset&&t.$from.marks();if(i){const e=i.filter(e=>o.includes(e.type.name));s.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,a).run()}const d=s.doc.resolve(r.from-1).nodeBefore;d&&d.type===e.type&&Bd(s.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(o,d))&&s.join(r.from-1)},undoable:e.undoable})}function wy(e){if(!(null==e?void 0:e.trim()))return{};const t={},n=[],r=e.replace(/["']([^"']*)["']/g,e=>(n.push(e),"__QUOTED_".concat(n.length-1,"__"))),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(o){const e=o.map(e=>e.trim().slice(1));t.class=e.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]);Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(e=>{let[,r,o]=e;var i;const a=parseInt((null==(i=o.match(/__QUOTED_(\d+)__/))?void 0:i[1])||"0",10),s=n[a];s&&(t[r]=s.slice(1,-1))});const a=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();if(a){a.split(/\s+/).filter(Boolean).forEach(e=>{e.match(/^[a-zA-Z][\w-]*$/)&&(t[e]=!0)})}return t}function Sy(e){if(!e||0===Object.keys(e).length)return"";const t=[];if(e.class){String(e.class).split(/\s+/).filter(Boolean).forEach(e=>t.push(".".concat(e)))}return e.id&&t.push("#".concat(e.id)),Object.entries(e).forEach(e=>{let[n,r]=e;"class"!==n&&"id"!==n&&(!0===r?t.push(n):!1!==r&&null!=r&&t.push("".concat(n,'="').concat(String(r),'"')))}),t.join(" ")}function ky(e){const{nodeName:t,name:n,parseAttributes:r=wy,serializeAttributes:o=Sy,defaultAttributes:i={},requiredAttributes:a=[],allowedAttributes:l}=e,c=n||t;return{parseMarkdown:(e,n)=>{const r=s(s({},i),e.attributes);return n.createNode(t,r,[])},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp("^:::".concat(c,"(?:\\s|$)"),"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,o){const i=new RegExp("^:::".concat(c,"(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)")),s=e.match(i);if(!s)return;const l=s[1]||"",d=r(l);return a.find(e=>!(e in d))?void 0:{type:t,raw:s[0],attributes:d}}},renderMarkdown:e=>{const t=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),n=o(t),r=n?" {".concat(n,"}"):"";return":::".concat(c).concat(r," :::")}}}function Cy(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=wy,serializeAttributes:i=Sy,defaultAttributes:a={},content:l="block",allowedAttributes:c}=e,d=n||t;return{parseMarkdown:(e,n)=>{let o;if(r){const t=r(e);o="string"===typeof t?[{type:"text",text:t}]:t}else o="block"===l?n.parseChildren(e.tokens||[]):n.parseInline(e.tokens||[]);const i=s(s({},a),e.attributes);return n.createNode(t,i,o)},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp("^:::".concat(d),"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,r){var i;const a=new RegExp("^:::".concat(d,"(?:\\s+\\{([^}]*)\\})?\\s*\\n")),s=e.match(a);if(!s)return;const[c,u=""]=s,p=o(u);let h=1;const f=c.length;let g="";const m=/^:::([\w-]*)(\s.*)?/gm,v=e.slice(f);for(m.lastIndex=0;;){const n=m.exec(v);if(null===n)break;const o=n.index,a=n[1];if(!(null==(i=n[2])?void 0:i.endsWith(":::")))if(a)h+=1;else if(h-=1,0===h){const i=v.slice(0,o);g=i.trim();const a=e.slice(0,f+o+n[0].length);let s=[];if(g)if("block"===l)for(s=r.blockTokens(i),s.forEach(e=>{!e.text||e.tokens&&0!==e.tokens.length||(e.tokens=r.inlineTokens(e.text))});s.length>0;){const e=s[s.length-1];if("paragraph"!==e.type||e.text&&""!==e.text.trim())break;s.pop()}else s=r.inlineTokens(g);return{type:t,raw:a,attributes:p,content:g,tokens:s}}}}},renderMarkdown:(e,t)=>{const n=(e=>{if(!c)return e;const t={};return c.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),r=i(n),o=r?" {".concat(r,"}"):"",a=t.renderChildren(e.content||[],"\n\n");return":::".concat(d).concat(o,"\n\n").concat(a,"\n\n:::")}}}function jy(e){if(!e.trim())return{};const t={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(e);for(;null!==r;){const[,o,i,a]=r;t[o]=i||a,r=n.exec(e)}return t}function _y(e){return Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t&&null!==t}).map(e=>{let[t,n]=e;return"".concat(t,'="').concat(n,'"')}).join(" ")}function Ey(e){const{nodeName:t,name:n,getContent:r,parseAttributes:o=jy,serializeAttributes:i=_y,defaultAttributes:a={},selfClosing:l=!1,allowedAttributes:c}=e,d=n||t,u=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(e,n)=>{const o=s(s({},a),e.attributes);if(l)return n.createNode(t,o);const i=r?r(e):e.content||"";return i?n.createNode(t,o,[n.createTextNode(i)]):n.createNode(t,o,[])},markdownTokenizer:{name:t,level:"inline",start(e){const t=l?new RegExp("\\[".concat(u,"\\s*[^\\]]*\\]")):new RegExp("\\[".concat(u,"\\s*[^\\]]*\\][\\s\\S]*?\\[\\/").concat(u,"\\]")),n=e.match(t),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize(e,n,r){const i=l?new RegExp("^\\[".concat(u,"\\s*([^\\]]*)\\]")):new RegExp("^\\[".concat(u,"\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/").concat(u,"\\]")),a=e.match(i);if(!a)return;let s="",c="";if(l){const[,e]=a;c=e}else{const[,e,t]=a;c=e,s=t||""}const d=o(c.trim());return{type:t,raw:a[0],content:s.trim(),attributes:d}}},renderMarkdown:e=>{let t="";r?t=r(e):e.content&&e.content.length>0&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""));const n=(e=>{if(!c)return e;const t={};return c.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),o=i(n),a=o?" ".concat(o):"";return l?"[".concat(d).concat(a,"]"):"[".concat(d).concat(a,"]").concat(t,"[/").concat(d,"]")}}}function Dy(e,t,n){var r,o,i,a;const s=e.split("\n"),l=[];let c="",d=0;const u=t.baseIndentSize||2;for(;d<s.length;){const e=s[d],p=e.match(t.itemPattern);if(!p){if(l.length>0)break;if(""===e.trim()){d+=1,c="".concat(c).concat(e,"\n");continue}return}const h=t.extractItemData(p),{indentLevel:f,mainContent:g}=h;c="".concat(c).concat(e,"\n");const m=[g];for(d+=1;d<s.length;){const e=s[d];if(""===e.trim()){const t=s.slice(d+1).findIndex(e=>""!==e.trim());if(-1===t)break;if(((null==(o=null==(r=s[d+1+t].match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>f){m.push(e),c="".concat(c).concat(e,"\n"),d+=1;continue}break}if(!(((null==(a=null==(i=e.match(/^(\s*)/))?void 0:i[1])?void 0:a.length)||0)>f))break;m.push(e),c="".concat(c).concat(e,"\n"),d+=1}let v;const y=m.slice(1);if(y.length>0){const e=y.map(e=>e.slice(f+u)).join("\n");e.trim()&&(v=t.customNestedParser?t.customNestedParser(e):n.blockTokens(e))}const x=t.createToken(h,v);l.push(x)}if(0!==l.length)return{items:l,raw:c}}function My(e,t,n,r){if(!e||!Array.isArray(e.content))return"";const o="function"===typeof n?n(r):n,[i,...a]=e.content,s=t.renderChildren([i]),l=["".concat(o).concat(s)];return a&&a.length>0&&a.forEach(e=>{const n=t.renderChildren([e]);if(n){const e=n.split("\n").map(e=>e?t.indent(e):"").join("\n");l.push(e)}}),l.join("\n")}function Ty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{state:r}=t,{doc:o,tr:i}=r,a=e;o.descendants((t,r)=>{const o=i.mapping.map(r),l=i.mapping.map(r)+t.nodeSize;let c=null;if(t.marks.forEach(e=>{if(e!==a)return!1;c=e}),!c)return;let d=!1;if(Object.keys(n).forEach(e=>{n[e]!==c.attrs[e]&&(d=!0)}),d){const t=e.type.create(s(s({},e.attrs),n));i.removeMark(o,l,e.type),i.addMark(o,l,t)}}),i.docChanged&&t.view.dispatch(i)}Ag({},{createAtomBlockMarkdownSpec:()=>ky,createBlockMarkdownSpec:()=>Cy,createInlineMarkdownSpec:()=>Ey,parseAttributes:()=>wy,parseIndentedBlocks:()=>Dy,renderNestedMarkdownContent:()=>My,serializeAttributes:()=>Sy});var Iy=class e extends Kv{constructor(){super(...arguments),this.type="node"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}};function Ay(e){return new Qv({find:e.find,handler:t=>{let{state:n,range:r,match:o,pasteEvent:i}=t;const a=Zm(e.getAttributes,void 0,o,i);if(!1===a||null===a)return null;const{tr:s}=n,l=o[o.length-1],c=o[0];let d=r.to;if(l){const t=c.search(/\S/),o=r.from+c.indexOf(l),i=o+l.length;if(pv(r.from,r.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>o).length)return null;i<r.to&&s.delete(i,r.to),o>r.from&&s.delete(r.from+t,o),d=r.from+t+l.length,s.addMark(r.from+t,d,e.type.create(a||{})),s.removeStoredMark(e.type)}}})}var Oy=Object.getOwnPropertyNames,Ry=Object.getOwnPropertySymbols,zy=Object.prototype.hasOwnProperty;function Fy(e,t){return function(n,r,o){return e(n,r,o)&&t(n,r,o)}}function Py(e){return function(t,n,r){if(!t||!n||"object"!==typeof t||"object"!==typeof n)return e(t,n,r);var o=r.cache,i=o.get(t),a=o.get(n);if(i&&a)return i===n&&a===t;o.set(t,n),o.set(n,t);var s=e(t,n,r);return o.delete(t),o.delete(n),s}}function By(e){return Oy(e).concat(Ry(e))}var Ly=Object.hasOwn||function(e,t){return zy.call(e,t)};function Ny(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Uy=Object.getOwnPropertyDescriptor,Vy=Object.keys;function Wy(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function Hy(e,t){return Ny(e.getTime(),t.getTime())}function Gy(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Xy(e,t){return e===t}function Yy(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var o,i,a=new Array(r),s=e.entries(),l=0;(o=s.next())&&!o.done;){for(var c=t.entries(),d=!1,u=0;(i=c.next())&&!i.done;)if(a[u])u++;else{var p=o.value,h=i.value;if(n.equals(p[0],h[0],l,u,e,t,n)&&n.equals(p[1],h[1],p[0],h[0],e,t,n)){d=a[u]=!0;break}u++}if(!d)return!1;l++}return!0}var qy=Ny;function Zy(e,t,n){var r=Vy(e),o=r.length;if(Vy(t).length!==o)return!1;for(;o-- >0;)if(!nx(e,t,n,r[o]))return!1;return!0}function $y(e,t,n){var r,o,i,a=By(e),s=a.length;if(By(t).length!==s)return!1;for(;s-- >0;){if(!nx(e,t,n,r=a[s]))return!1;if(o=Uy(e,r),i=Uy(t,r),(o||i)&&(!o||!i||o.configurable!==i.configurable||o.enumerable!==i.enumerable||o.writable!==i.writable))return!1}return!0}function Ky(e,t){return Ny(e.valueOf(),t.valueOf())}function Jy(e,t){return e.source===t.source&&e.flags===t.flags}function Qy(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var o,i,a=new Array(r),s=e.values();(o=s.next())&&!o.done;){for(var l=t.values(),c=!1,d=0;(i=l.next())&&!i.done;){if(!a[d]&&n.equals(o.value,i.value,o.value,i.value,e,t,n)){c=a[d]=!0;break}d++}if(!c)return!1}return!0}function ex(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function tx(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function nx(e,t,n,r){return!("_owner"!==r&&"__o"!==r&&"__v"!==r||!e.$$typeof&&!t.$$typeof)||Ly(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var rx=Array.isArray,ox="undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView:null,ix=Object.assign,ax=Object.prototype.toString.call.bind(Object.prototype.toString);function sx(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,o=e.areFunctionsEqual,i=e.areMapsEqual,a=e.areNumbersEqual,s=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,d=e.areSetsEqual,u=e.areTypedArraysEqual,p=e.areUrlsEqual,h=e.unknownTagComparators;return function(e,f,g){if(e===f)return!0;if(null==e||null==f)return!1;var m=typeof e;if(m!==typeof f)return!1;if("object"!==m)return"number"===m?a(e,f,g):"function"===m&&o(e,f,g);var v=e.constructor;if(v!==f.constructor)return!1;if(v===Object)return s(e,f,g);if(rx(e))return t(e,f,g);if(null!=ox&&ox(e))return u(e,f,g);if(v===Date)return n(e,f,g);if(v===RegExp)return c(e,f,g);if(v===Map)return i(e,f,g);if(v===Set)return d(e,f,g);var y=ax(e);if("[object Date]"===y)return n(e,f,g);if("[object RegExp]"===y)return c(e,f,g);if("[object Map]"===y)return i(e,f,g);if("[object Set]"===y)return d(e,f,g);if("[object Object]"===y)return"function"!==typeof e.then&&"function"!==typeof f.then&&s(e,f,g);if("[object URL]"===y)return p(e,f,g);if("[object Error]"===y)return r(e,f,g);if("[object Arguments]"===y)return s(e,f,g);if("[object Boolean]"===y||"[object Number]"===y||"[object String]"===y)return l(e,f,g);if(h){var x=h[y];if(!x){var b=function(e){return null!=e?e[Symbol.toStringTag]:void 0}(e);b&&(x=h[b])}if(x)return x(e,f,g)}return!1}}var lx=cx();cx({strict:!0}),cx({circular:!0}),cx({circular:!0,strict:!0}),cx({createInternalComparator:function(){return Ny}}),cx({strict:!0,createInternalComparator:function(){return Ny}}),cx({circular:!0,createInternalComparator:function(){return Ny}}),cx({circular:!0,createInternalComparator:function(){return Ny},strict:!0});function cx(e){void 0===e&&(e={});var t,n=e.circular,r=void 0!==n&&n,o=e.createInternalComparator,i=e.createState,a=e.strict,s=void 0!==a&&a,l=function(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,o={areArraysEqual:r?$y:Wy,areDatesEqual:Hy,areErrorsEqual:Gy,areFunctionsEqual:Xy,areMapsEqual:r?Fy(Yy,$y):Yy,areNumbersEqual:qy,areObjectsEqual:r?$y:Zy,arePrimitiveWrappersEqual:Ky,areRegExpsEqual:Jy,areSetsEqual:r?Fy(Qy,$y):Qy,areTypedArraysEqual:r?$y:ex,areUrlsEqual:tx,unknownTagComparators:void 0};if(n&&(o=ix({},o,n(o))),t){var i=Py(o.areArraysEqual),a=Py(o.areMapsEqual),s=Py(o.areObjectsEqual),l=Py(o.areSetsEqual);o=ix({},o,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:l})}return o}(e),c=sx(l),d=o?o(c):(t=c,function(e,n,r,o,i,a,s){return t(e,n,s)});return function(e){var t=e.circular,n=e.comparator,r=e.createState,o=e.equals,i=e.strict;if(r)return function(e,a){var s=r(),l=s.cache,c=void 0===l?t?new WeakMap:void 0:l,d=s.meta;return n(e,a,{cache:c,equals:o,meta:d,strict:i})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:o,meta:void 0,strict:i})};var a={cache:void 0,equals:o,meta:void 0,strict:i};return function(e,t){return n(e,t,a)}}({circular:r,comparator:c,createState:i,equals:d,strict:s})}const dx=["editor","innerRef"];var ux=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):t&&(t.current=e)})}},px=e=>{let{contentComponent:t}=e;const n=(0,tc.useSyncExternalStore)(t.subscribe,t.getSnapshot,t.getServerSnapshot);return(0,c.jsx)(c.Fragment,{children:Object.values(n)})};var hx=class extends e.Component{constructor(t){var n;super(t),this.editorContentRef=e.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null==(n=t.editor)?void 0:n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(e.view.dom),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t=s(s({},t),{},{[n]:Mi.createPortal(r.reactElement,r.element,n)}),e.forEach(e=>e())},removeRenderer(n){const r=s({},t);delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!(null==(e=t.view.dom)?void 0:e.firstChild))return;const n=document.createElement("div");n.append(t.view.dom),t.setOptions({element:n})}catch(n){}}}render(){const e=this.props,{editor:t,innerRef:n}=e,r=l(e,dx);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",s({ref:ux(n,this.editorContentRef)},r)),(null==t?void 0:t.contentComponent)&&(0,c.jsx)(px,{contentComponent:t.contentComponent})]})}},fx=(0,e.forwardRef)((t,n)=>{const r=e.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[t.editor]);return e.createElement(hx,s({key:r,innerRef:n},t))}),gx=e.memo(fx),mx="undefined"!==typeof window?e.useLayoutEffect:e.useEffect,vx=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}};var yx="undefined"===typeof window,xx=yx||Boolean("undefined"!==typeof window&&window.next),bx=class e{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?yx||xx?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){var e=this;const t=s(s({},this.options.current),{},{onBeforeCreate:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onBeforeCreate)?void 0:n.call(t,...o)},onBlur:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onBlur)?void 0:n.call(t,...o)},onCreate:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onCreate)?void 0:n.call(t,...o)},onDestroy:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onDestroy)?void 0:n.call(t,...o)},onFocus:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onFocus)?void 0:n.call(t,...o)},onSelectionUpdate:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onSelectionUpdate)?void 0:n.call(t,...o)},onTransaction:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onTransaction)?void 0:n.call(t,...o)},onUpdate:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onUpdate)?void 0:n.call(t,...o)},onContentError:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onContentError)?void 0:n.call(t,...o)},onDrop:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onDrop)?void 0:n.call(t,...o)},onPaste:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onPaste)?void 0:n.call(t,...o)},onDelete:function(){for(var t,n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return null==(n=(t=e.options.current).onDelete)?void 0:n.call(t,...o)}});return new vy(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null==(r=t.extensions)?void 0:r[n])}):e[n]===t[n]))}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===t.length?e.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions(s(s({},this.options.current),{},{editable:this.editor.isEditable})):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);const t=this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]);if(t)return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function wx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=(0,e.useRef)(t);r.current=t;const[o]=(0,e.useState)(()=>new bx(r)),i=(0,tc.useSyncExternalStore)(o.subscribe,o.getEditor,o.getServerSnapshot);return(0,e.useDebugValue)(i),(0,e.useEffect)(o.onRender(n)),function(t){var n;const[r]=(0,e.useState)(()=>new vx(t.editor)),o=(0,bi.useSyncExternalStoreWithSelector)(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,null!=(n=t.equalityFn)?n:lx);mx(()=>r.watch(t.editor),[t.editor,r]),(0,e.useDebugValue)(o)}({editor:i,selector:e=>{let{transactionNumber:n}=e;return!1===t.shouldRerenderOnTransaction||void 0===t.shouldRerenderOnTransaction?null:t.immediatelyRender&&0===n?0:n+1}}),i}var Sx=(0,e.createContext)({editor:null});Sx.Consumer;var kx=(0,e.createContext)({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Cx=()=>(0,e.useContext)(kx);e.forwardRef((e,t)=>{const{onDragStart:n}=Cx(),r=e.as||"div";return(0,c.jsx)(r,s(s({},e),{},{ref:t,"data-node-view-wrapper":"",onDragStart:n,style:s({whiteSpace:"normal"},e.style)}))});e.createContext({markViewContentRef:()=>{}});const jx=["children"];var _x=(e,t)=>{if("slot"===e)return 0;if(e instanceof Function)return e(t);const n=null!=t?t:{},{children:r}=n,o=l(n,jx);if("svg"===e)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,o,r]},Ex=/^\s*>\s$/,Dx=Iy.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return _x("blockquote",s(s({},Jm(this.options.HTMLAttributes,t)),{},{children:_x("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const n=[];return e.content.forEach(e=>{const r=t.renderChildren([e]).split("\n").map(e=>""===e.trim()?">":"".concat(">"," ").concat(e));n.push(r.join("\n"))}),n.join("\n".concat(">","\n"))},addCommands(){return{setBlockquote:()=>e=>{let{commands:t}=e;return t.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{commands:t}=e;return t.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[by({find:Ex,type:this.type})]}}),Mx=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Tx=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Ix=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Ax=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Ox=Jv.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML(e){let{HTMLAttributes:t}=e;return _x("strong",s(s({},Jm(this.options.HTMLAttributes,t)),{},{children:_x("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"**".concat(t.renderChildren(e),"**"),addCommands(){return{setBold:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleBold:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetBold:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[yy({find:Mx,type:this.type}),yy({find:Ix,type:this.type})]},addPasteRules(){return[Ay({find:Tx,type:this.type}),Ay({find:Ax,type:this.type})]}}),Rx=/(^|[^`])`([^`]+)`(?!`)$/,zx=/(^|[^`])`([^`]+)`(?!`)/g,Fx=Jv.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(e){let{HTMLAttributes:t}=e;return["code",Jm(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?"`".concat(t.renderChildren(e.content),"`"):"",addCommands(){return{setCode:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleCode:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetCode:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[yy({find:Rx,type:this.type})]},addPasteRules(){return[Ay({find:zx,type:this.type})]}}),Px=/^```([a-z]+)?[\s\n]$/,Bx=/^~~~([a-z]+)?[\s\n]$/,Lx=Iy.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options;if(!n)return null;const r=[...(null==(t=e.firstElementChild)?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["pre",Jm(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var n;return!1===(null==(n=e.raw)?void 0:n.startsWith("```"))&&"indented"!==e.codeBlockStyle?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var n;let r="";const o=(null==(n=e.attrs)?void 0:n.language)||"";if(e.content){r=["```".concat(o),t.renderChildren(e.content),"```"].join("\n")}else r="```".concat(o,"\n\n```");return r},addCommands(){return{setCodeBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:n}=t;return n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Tab:e=>{let{editor:t}=e;var n;if(!this.options.enableTabIndentation)return!1;const r=null!=(n=this.options.tabSize)?n:4,{state:o}=t,{selection:i}=o,{$from:a,empty:s}=i;if(a.parent.type!==this.type)return!1;const l=" ".repeat(r);return s?t.commands.insertContent(l):t.commands.command(e=>{let{tr:t}=e;const{from:n,to:r}=i,a=o.doc.textBetween(n,r,"\n","\n").split("\n").map(e=>l+e).join("\n");return t.replaceWith(n,r,o.schema.text(a)),!0})},"Shift-Tab":e=>{let{editor:t}=e;var n;if(!this.options.enableTabIndentation)return!1;const r=null!=(n=this.options.tabSize)?n:4,{state:o}=t,{selection:i}=o,{$from:a,empty:s}=i;return a.parent.type===this.type&&(s?t.commands.command(e=>{let{tr:t}=e;var n;const{pos:i}=a,s=a.start(),l=a.end(),c=o.doc.textBetween(s,l,"\n","\n").split("\n");let d=0,u=0;const p=i-s;for(let r=0;r<c.length;r+=1){if(u+c[r].length>=p){d=r;break}u+=c[r].length+1}const h=(null==(n=c[d].match(/^ */))?void 0:n[0])||"",f=Math.min(h.length,r);if(0===f)return!0;let g=s;for(let r=0;r<d;r+=1)g+=c[r].length+1;t.delete(g,g+f);return i-g<=f&&t.setSelection(lu.create(t.doc,g)),!0}):t.commands.command(e=>{let{tr:t}=e;const{from:n,to:a}=i,s=o.doc.textBetween(n,a,"\n","\n").split("\n").map(e=>{var t;const n=(null==(t=e.match(/^ */))?void 0:t[0])||"",o=Math.min(n.length,r);return e.slice(o)}).join("\n");return t.replaceWith(n,a,o.schema.text(s)),!0}))},Enter:e=>{let{editor:t}=e;if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:r}=n,{$from:o,empty:i}=r;if(!i||o.parent.type!==this.type)return!1;const a=o.parentOffset===o.parent.nodeSize-2,s=o.parent.textContent.endsWith("\n\n");return!(!a||!s)&&t.chain().command(e=>{let{tr:t}=e;return t.delete(o.pos-2,o.pos),!0}).exitCode().run()},ArrowDown:e=>{let{editor:t}=e;if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:r,doc:o}=n,{$from:i,empty:a}=r;if(!a||i.parent.type!==this.type)return!1;if(!(i.parentOffset===i.parent.nodeSize-2))return!1;const s=i.after();if(void 0===s)return!1;return o.nodeAt(s)?t.commands.command(e=>{let{tr:t}=e;return t.setSelection(ou.near(o.resolve(s))),!0}):t.commands.exitCode()}}},addInputRules(){return[xy({find:Px,type:this.type,getAttributes:e=>({language:e[1]})}),xy({find:Bx,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new ku({key:new _u("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=null==o?void 0:o.mode;if(!n||!i)return!1;const{tr:a,schema:s}=e.state,l=s.text(n.replace(/\r\n?/g,"\n"));return a.replaceSelectionWith(this.type.create({language:i},l)),a.selection.$from.parent.type!==this.type&&a.setSelection(lu.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),e.dispatch(a),!0}}})]}}),Nx=Iy.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n\n"):""}),Ux=Iy.create({name:"hardBreak",markdownTokenName:"br",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(e){let{HTMLAttributes:t}=e;return["br",Jm(this.options.HTMLAttributes,t)]},renderText:()=>"\n",renderMarkdown:()=>"  \n",parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>e=>{let{commands:t,chain:n,state:r,editor:o}=e;return t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:e,storedMarks:t}=r;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=o.extensionManager,s=t||e.$to.parentOffset&&e.$from.marks();return n().insertContent({type:this.name}).command(e=>{let{tr:t,dispatch:n}=e;if(n&&s&&i){const e=s.filter(e=>a.includes(e.type.name));t.ensureMarks(e)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Vx=Iy.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:"h".concat(e),attrs:{level:e}}))},renderHTML(e){let{node:t,HTMLAttributes:n}=e;const r=this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0];return["h".concat(r),Jm(this.options.HTMLAttributes,n),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.level)?parseInt(e.attrs.level,10):1,o="#".repeat(r);return e.content?"".concat(o," ").concat(t.renderChildren(e.content)):""},addCommands(){return{setHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.setNode(this.name,e)},toggleHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>s(s({},e),{["Mod-Alt-".concat(t)]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>xy({find:new RegExp("^(#{".concat(Math.min(...this.options.levels),",").concat(e,"})\\s$")),type:this.type,getAttributes:{level:e}}))}}),Wx=Iy.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{},nextNodeType:"paragraph"}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",Jm(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>e=>{let{chain:t,state:n}=e;if(!function(e,t){const{selection:n}=e,{$from:r}=n;if(n instanceof du){const e=r.index();return r.parent.canReplaceWith(e,e+1,t)}let o=r.depth;for(;o>=0;){const e=r.index(o);if(r.node(o).contentMatchAt(e).matchType(t))return!0;o-=1}return!1}(n,n.schema.nodes[this.name]))return!1;const{selection:r}=n,{$to:o}=r,i=t();return xv(r)?i.insertContentAt(o.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(e=>{let{state:t,tr:n,dispatch:r}=e;if(r){const{$to:e}=n.selection,r=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?n.setSelection(lu.create(n.doc,e.pos+1)):e.nodeAfter.isBlock?n.setSelection(du.create(n.doc,e.pos)):n.setSelection(lu.create(n.doc,e.pos));else{const o=t.schema.nodes[this.options.nextNodeType]||e.parent.type.contentMatch.defaultType,i=null==o?void 0:o.create();i&&(n.insert(r,i),n.setSelection(lu.create(n.doc,r+1)))}n.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(e={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new Yv({find:e.find,handler:t=>{let{state:n,range:r,match:o}=t;const i=Zm(e.getAttributes,void 0,o)||{},{tr:a}=n,s=r.from;let l=r.to;const c=e.type.create(i);if(o[1]){let e=s+o[0].lastIndexOf(o[1]);e>l?e=l:l=e+o[1].length;const t=o[0][o[0].length-1];a.insertText(t,s+o[0].length-1),a.replaceWith(e,l,c)}else if(o[0]){const t=e.type.isInline?s:s-1;a.insert(t,e.type.create(i)).delete(a.mapping.map(s),a.mapping.map(l))}a.scrollIntoView()},undoable:e.undoable}))];var e}}),Hx=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Gx=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Xx=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Yx=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,qx=Jv.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML(e){let{HTMLAttributes:t}=e;return["em",Jm(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleItalic:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetItalic:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"*".concat(t.renderChildren(e),"*"),addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[yy({find:Hx,type:this.type}),yy({find:Xx,type:this.type})]},addPasteRules(){return[Ay({find:Gx,type:this.type}),Ay({find:Yx,type:this.type})]}});const Zx="numeric",$x="ascii",Kx="alpha",Jx="asciinumeric",Qx="alphanumeric",eb="domain",tb="emoji",nb="scheme",rb="slashscheme",ob="whitespace";function ib(e,t){return e in t||(t[e]=[]),t[e]}function ab(e,t,n){t[Zx]&&(t[Jx]=!0,t[Qx]=!0),t[$x]&&(t[Jx]=!0,t[Kx]=!0),t[Jx]&&(t[Qx]=!0),t[Kx]&&(t[Qx]=!0),t[Qx]&&(t[eb]=!0),t[tb]&&(t[eb]=!0);for(const r in t){const t=ib(r,n);t.indexOf(e)<0&&t.push(e)}}function sb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.j={},this.jr=[],this.jd=null,this.t=e}sb.groups={},sb.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let r=0;r<t.jr.length;r++){const n=t.jr[r][0],o=t.jr[r][1];if(o&&n.test(e))return o}return t.jd},has(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let o=0;o<e.length;o++)this.tt(e[o],t,n,r)},tr(e,t,n,r){let o;return r=r||sb.groups,t&&t.j?o=t:(o=new sb(t),n&&r&&ab(t,n,r)),this.jr.push([e,o]),o},ts(e,t,n,r){let o=this;const i=e.length;if(!i)return o;for(let a=0;a<i-1;a++)o=o.tt(e[a]);return o.tt(e[i-1],t,n,r)},tt(e,t,n,r){r=r||sb.groups;const o=this;if(t&&t.j)return o.j[e]=t,t;const i=t;let a,s=o.go(e);if(s?(a=new sb,Object.assign(a.j,s.j),a.jr.push.apply(a.jr,s.jr),a.jd=s.jd,a.t=s.t):a=new sb,i){if(r)if(a.t&&"string"===typeof a.t){const e=Object.assign(function(e,t){const n={};for(const r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}(a.t,r),n);ab(i,e,r)}else n&&ab(i,n,r);a.t=i}return o.j[e]=a,a}};const lb=(e,t,n,r,o)=>e.ta(t,n,r,o),cb=(e,t,n,r,o)=>e.tr(t,n,r,o),db=(e,t,n,r,o)=>e.ts(t,n,r,o),ub=(e,t,n,r,o)=>e.tt(t,n,r,o),pb="WORD",hb="UWORD",fb="ASCIINUMERICAL",gb="ALPHANUMERICAL",mb="LOCALHOST",vb="TLD",yb="UTLD",xb="SCHEME",bb="SLASH_SCHEME",wb="NUM",Sb="WS",kb="NL",Cb="OPENBRACE",jb="CLOSEBRACE",_b="OPENBRACKET",Eb="CLOSEBRACKET",Db="OPENPAREN",Mb="CLOSEPAREN",Tb="OPENANGLEBRACKET",Ib="CLOSEANGLEBRACKET",Ab="FULLWIDTHLEFTPAREN",Ob="FULLWIDTHRIGHTPAREN",Rb="LEFTCORNERBRACKET",zb="RIGHTCORNERBRACKET",Fb="LEFTWHITECORNERBRACKET",Pb="RIGHTWHITECORNERBRACKET",Bb="FULLWIDTHLESSTHAN",Lb="FULLWIDTHGREATERTHAN",Nb="AMPERSAND",Ub="APOSTROPHE",Vb="ASTERISK",Wb="AT",Hb="BACKSLASH",Gb="BACKTICK",Xb="CARET",Yb="COLON",qb="COMMA",Zb="DOLLAR",$b="DOT",Kb="EQUALS",Jb="EXCLAMATION",Qb="HYPHEN",ew="PERCENT",tw="PIPE",nw="PLUS",rw="POUND",ow="QUERY",iw="QUOTE",aw="FULLWIDTHMIDDLEDOT",sw="SEMI",lw="SLASH",cw="TILDE",dw="UNDERSCORE",uw="EMOJI",pw="SYM";var hw=Object.freeze({__proto__:null,ALPHANUMERICAL:gb,AMPERSAND:Nb,APOSTROPHE:Ub,ASCIINUMERICAL:fb,ASTERISK:Vb,AT:Wb,BACKSLASH:Hb,BACKTICK:Gb,CARET:Xb,CLOSEANGLEBRACKET:Ib,CLOSEBRACE:jb,CLOSEBRACKET:Eb,CLOSEPAREN:Mb,COLON:Yb,COMMA:qb,DOLLAR:Zb,DOT:$b,EMOJI:uw,EQUALS:Kb,EXCLAMATION:Jb,FULLWIDTHGREATERTHAN:Lb,FULLWIDTHLEFTPAREN:Ab,FULLWIDTHLESSTHAN:Bb,FULLWIDTHMIDDLEDOT:aw,FULLWIDTHRIGHTPAREN:Ob,HYPHEN:Qb,LEFTCORNERBRACKET:Rb,LEFTWHITECORNERBRACKET:Fb,LOCALHOST:mb,NL:kb,NUM:wb,OPENANGLEBRACKET:Tb,OPENBRACE:Cb,OPENBRACKET:_b,OPENPAREN:Db,PERCENT:ew,PIPE:tw,PLUS:nw,POUND:rw,QUERY:ow,QUOTE:iw,RIGHTCORNERBRACKET:zb,RIGHTWHITECORNERBRACKET:Pb,SCHEME:xb,SEMI:sw,SLASH:lw,SLASH_SCHEME:bb,SYM:pw,TILDE:cw,TLD:vb,UNDERSCORE:dw,UTLD:yb,UWORD:hb,WORD:pb,WS:Sb});const fw=/[a-z]/,gw=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/,mw=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])/,vw=/\d/,yw=/\s/;let xw=null,bw=null;function ww(e,t){const n=function(e){const t=[],n=e.length;let r=0;for(;r<n;){let o,i=e.charCodeAt(r),a=i<55296||i>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(a),r+=a.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),r=n.length,o=[];let i=0,a=0;for(;a<r;){let s=e,l=null,c=0,d=null,u=-1,p=-1;for(;a<r&&(l=s.go(n[a]));)s=l,s.accepts()?(u=0,p=0,d=s):u>=0&&(u+=n[a].length,p++),c+=n[a].length,i+=n[a].length,a++;i-=u,a-=p,c-=u,o.push({t:d.t,v:t.slice(i-c,i),s:i-c,e:i})}return o}function Sw(e,t,n,r,o){let i;const a=t.length;for(let s=0;s<a-1;s++){const n=t[s];e.j[n]?i=e.j[n]:(i=new sb(r),i.jr=o.slice(),e.j[n]=i),e=i}return i=new sb(n),i.jr=o.slice(),e.j[t[a-1]]=i,i}function kw(e){const t=[],n=[];let r=0;for(;r<e.length;){let o=0;for(;"0123456789".indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let t=parseInt(e.substring(r,r+o),10);t>0;t--)n.pop();r+=o}else n.push(e[r]),r++}return t}const Cw={defaultProtocol:"http",events:null,format:_w,formatHref:_w,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function jw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object.assign({},Cw);e&&(n=Object.assign(n,e instanceof jw?e.o:e));const r=n.ignoreTags,o=[];for(let i=0;i<r.length;i++)o.push(r[i].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=o}function _w(e){return e}jw.prototype={o:Cw,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const r=null!=t;let o=this.o[e];return o?("object"===typeof o?(o=n.t in o?o[n.t]:Cw[e],"function"===typeof o&&r&&(o=o(t,n))):"function"===typeof o&&r&&(o=o(t,n.t,n)),o):o},getObj(e,t,n){let r=this.o[e];return"function"===typeof r&&null!=t&&(r=r(t,n.t,n)),r},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function Ew(e,t){this.t="token",this.v=e,this.tk=t}function Dw(e,t){class n extends Ew{constructor(t,n){super(t,n),this.t=e}}for(const r in t)n.prototype[r]=t[r];return n.t=e,n}Ew.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"\u2026":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cw.defaultProtocol;return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),r=e.get("formatHref",n,this),o=e.get("tagName",n,t),i=this.toFormattedString(e),a={},s=e.get("className",n,t),l=e.get("target",n,t),c=e.get("rel",n,t),d=e.getObj("attributes",n,t),u=e.getObj("events",n,t);return a.href=r,s&&(a.class=s),l&&(a.target=l),c&&(a.rel=c),d&&Object.assign(a,d),{tagName:o,attributes:a,content:i,eventListeners:u}}};const Mw=Dw("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Tw=Dw("text"),Iw=Dw("nl"),Aw=Dw("url",{isLink:!0,toHref(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cw.defaultProtocol;return this.hasProtocol()?this.v:"".concat(e,"://").concat(this.v)},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==mb&&e[1].t===Yb}});const Ow=e=>new sb(e);function Rw(e,t,n){const r=n[0].s,o=n[n.length-1].e;return new e(t.slice(r,o),n)}const zw="undefined"!==typeof console&&console&&console.warn||(()=>{}),Fw="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Pw={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Bw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Pw.initialized&&zw('linkifyjs: already initialized - will not register custom scheme "'.concat(e,'" ').concat(Fw)),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Pw.customSchemes.push([e,t])}function Lw(){Pw.scanner=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={};sb.groups=t;const n=new sb;null==xw&&(xw=kw("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==bw&&(bw=kw("\u03b5\u03bb1\u03c52\u0431\u04331\u0435\u043b3\u0434\u0435\u0442\u04384\u0435\u044e2\u043a\u0430\u0442\u043e\u043b\u0438\u043a6\u043e\u043c3\u043c\u043a\u04342\u043e\u043d1\u0441\u043a\u0432\u04306\u043e\u043d\u043b\u0430\u0439\u043d5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043a\u04403\u049b\u0430\u04373\u0570\u0561\u05753\u05d9\u05e9\u05e8\u05d0\u05dc5\u05e7\u05d5\u05dd3\u0627\u0628\u0648\u0638\u0628\u064a5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062f\u06464\u0628\u062d\u0631\u064a\u06465\u062c\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062f\u064a\u06296\u0639\u0644\u064a\u0627\u06465\u0645\u063a\u0631\u06285\u0645\u0627\u0631\u0627\u062a5\u06cc\u0631\u0627\u06465\u0628\u0627\u0631\u062a2\u0632\u0627\u06314\u064a\u062a\u06433\u06be\u0627\u0631\u062a5\u062a\u0648\u0646\u06334\u0633\u0648\u062f\u0627\u06463\u0631\u064a\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064a\u06466\u0642\u0637\u06313\u0643\u0627\u062b\u0648\u0644\u064a\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064a\u0633\u064a\u06275\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067e\u0627\u06a9\u0633\u062a\u0627\u06467\u0680\u0627\u0631\u062a4\u0915\u0949\u092e3\u0928\u0947\u091f3\u092d\u093e\u0930\u09240\u092e\u094d3\u094b\u09245\u0938\u0902\u0917\u0920\u09285\u09ac\u09be\u0982\u09b2\u09be5\u09ad\u09be\u09b0\u09a42\u09f0\u09a44\u0a2d\u0a3e\u0a30\u0a244\u0aad\u0abe\u0ab0\u0aa44\u0b2d\u0b3e\u0b30\u0b244\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe6\u0bb2\u0b99\u0bcd\u0b95\u0bc86\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd11\u0c2d\u0c3e\u0c30\u0c24\u0c4d5\u0cad\u0cbe\u0cb0\u0ca44\u0d2d\u0d3e\u0d30\u0d24\u0d025\u0dbd\u0d82\u0d9a\u0dcf4\u0e04\u0e2d\u0e213\u0e44\u0e17\u0e223\u0ea5\u0eb2\u0ea73\u10d2\u10d42\u307f\u3093\u306a3\u30a2\u30de\u30be\u30f34\u30af\u30e9\u30a6\u30c94\u30b0\u30fc\u30b0\u30eb4\u30b3\u30e02\u30b9\u30c8\u30a23\u30bb\u30fc\u30eb3\u30d5\u30a1\u30c3\u30b7\u30e7\u30f36\u30dd\u30a4\u30f3\u30c84\u4e16\u754c2\u4e2d\u4fe11\u56fd1\u570b1\u6587\u7f513\u4e9a\u9a6c\u900a3\u4f01\u4e1a2\u4f5b\u5c712\u4fe1\u606f2\u5065\u5eb72\u516b\u53662\u516c\u53f81\u76ca2\u53f0\u6e7e1\u70632\u5546\u57ce1\u5e971\u68072\u5609\u91cc0\u5927\u9152\u5e975\u5728\u7ebf2\u5927\u62ff2\u5929\u4e3b\u65593\u5a31\u4e502\u5bb6\u96fb2\u5e7f\u4e1c2\u5fae\u535a2\u6148\u55842\u6211\u7231\u4f603\u624b\u673a2\u62db\u80582\u653f\u52a11\u5e9c2\u65b0\u52a0\u57612\u95fb2\u65f6\u5c1a2\u66f8\u7c4d2\u673a\u67842\u6de1\u9a6c\u95213\u6e38\u620f2\u6fb3\u95802\u70b9\u770b2\u79fb\u52a82\u7ec4\u7ec7\u673a\u67844\u7f51\u57401\u5e971\u7ad91\u7edc2\u8054\u901a2\u8c37\u6b4c2\u8d2d\u72692\u901a\u8ca92\u96c6\u56e22\u96fb\u8a0a\u76c8\u79d14\u98de\u5229\u6d663\u98df\u54c12\u9910\u53852\u9999\u683c\u91cc\u62c93\u6e2f2\ub2f7\ub1371\ucef42\uc0bc\uc1312\ud55c\uad6d2")),ub(n,"'",Ub),ub(n,"{",Cb),ub(n,"}",jb),ub(n,"[",_b),ub(n,"]",Eb),ub(n,"(",Db),ub(n,")",Mb),ub(n,"<",Tb),ub(n,">",Ib),ub(n,"\uff08",Ab),ub(n,"\uff09",Ob),ub(n,"\u300c",Rb),ub(n,"\u300d",zb),ub(n,"\u300e",Fb),ub(n,"\u300f",Pb),ub(n,"\uff1c",Bb),ub(n,"\uff1e",Lb),ub(n,"&",Nb),ub(n,"*",Vb),ub(n,"@",Wb),ub(n,"`",Gb),ub(n,"^",Xb),ub(n,":",Yb),ub(n,",",qb),ub(n,"$",Zb),ub(n,".",$b),ub(n,"=",Kb),ub(n,"!",Jb),ub(n,"-",Qb),ub(n,"%",ew),ub(n,"|",tw),ub(n,"+",nw),ub(n,"#",rw),ub(n,"?",ow),ub(n,'"',iw),ub(n,"/",lw),ub(n,";",sw),ub(n,"~",cw),ub(n,"_",dw),ub(n,"\\",Hb),ub(n,"\u30fb",aw);const r=cb(n,vw,wb,{[Zx]:!0});cb(r,vw,r);const o=cb(r,fw,fb,{[Jx]:!0}),i=cb(r,gw,gb,{[Qx]:!0}),a=cb(n,fw,pb,{[$x]:!0});cb(a,vw,o),cb(a,fw,a),cb(o,vw,o),cb(o,fw,o);const s=cb(n,gw,hb,{[Kx]:!0});cb(s,fw),cb(s,vw,i),cb(s,gw,s),cb(i,vw,i),cb(i,fw),cb(i,gw,i);const l=ub(n,"\n",kb,{[ob]:!0}),c=ub(n,"\r",Sb,{[ob]:!0}),d=cb(n,yw,Sb,{[ob]:!0});ub(n,"\ufffc",d),ub(c,"\n",l),ub(c,"\ufffc",d),cb(c,yw,d),ub(d,"\r"),ub(d,"\n"),cb(d,yw,d),ub(d,"\ufffc",d);const u=cb(n,mw,uw,{[tb]:!0});ub(u,"#"),cb(u,mw,u),ub(u,"\ufe0f",u);const p=ub(u,"\u200d");ub(p,"#"),cb(p,mw,u);const h=[[fw,a],[vw,o]],f=[[fw,null],[gw,s],[vw,i]];for(let g=0;g<xw.length;g++)Sw(n,xw[g],vb,pb,h);for(let g=0;g<bw.length;g++)Sw(n,bw[g],yb,hb,f);ab(vb,{tld:!0,ascii:!0},t),ab(yb,{utld:!0,alpha:!0},t),Sw(n,"file",xb,pb,h),Sw(n,"mailto",xb,pb,h),Sw(n,"http",bb,pb,h),Sw(n,"https",bb,pb,h),Sw(n,"ftp",bb,pb,h),Sw(n,"ftps",bb,pb,h),ab(xb,{scheme:!0,ascii:!0},t),ab(bb,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let g=0;g<e.length;g++){const t=e[g][0],r=e[g][1]?{[nb]:!0}:{[rb]:!0};t.indexOf("-")>=0?r[eb]=!0:fw.test(t)?vw.test(t)?r[Jx]=!0:r[$x]=!0:r[Zx]=!0,db(n,t,t,r)}return db(n,"localhost",mb,{ascii:!0}),n.jd=new sb(pw),{start:n,tokens:Object.assign({groups:t},hw)}}(Pw.customSchemes);for(let e=0;e<Pw.tokenQueue.length;e++)Pw.tokenQueue[e][1]({scanner:Pw.scanner});Pw.parser=function(e){let{groups:t}=e;const n=t.domain.concat([Nb,Vb,Wb,Hb,Gb,Xb,Zb,Kb,Qb,wb,ew,tw,nw,rw,lw,pw,cw,dw]),r=[Ub,Yb,qb,$b,Jb,ew,ow,iw,sw,Tb,Ib,Cb,jb,Eb,_b,Db,Mb,Ab,Ob,Rb,zb,Fb,Pb,Bb,Lb],o=[Nb,Ub,Vb,Hb,Gb,Xb,Zb,Kb,Qb,Cb,jb,ew,tw,nw,rw,ow,lw,pw,cw,dw],i=Ow(),a=ub(i,cw);lb(a,o,a),lb(a,t.domain,a);const s=Ow(),l=Ow(),c=Ow();lb(i,t.domain,s),lb(i,t.scheme,l),lb(i,t.slashscheme,c),lb(s,o,a),lb(s,t.domain,s);const d=ub(s,Wb);ub(a,Wb,d),ub(l,Wb,d),ub(c,Wb,d);const u=ub(a,$b);lb(u,o,a),lb(u,t.domain,a);const p=Ow();lb(d,t.domain,p),lb(p,t.domain,p);const h=ub(p,$b);lb(h,t.domain,p);const f=Ow(Mw);lb(h,t.tld,f),lb(h,t.utld,f),ub(d,mb,f);const g=ub(p,Qb);ub(g,Qb,g),lb(g,t.domain,p),lb(f,t.domain,p),ub(f,$b,h),ub(f,Qb,g);const m=ub(f,Yb);lb(m,t.numeric,Mw);const v=ub(s,Qb),y=ub(s,$b);ub(v,Qb,v),lb(v,t.domain,s),lb(y,o,a),lb(y,t.domain,s);const x=Ow(Aw);lb(y,t.tld,x),lb(y,t.utld,x),lb(x,t.domain,s),lb(x,o,a),ub(x,$b,y),ub(x,Qb,v),ub(x,Wb,d);const b=ub(x,Yb),w=Ow(Aw);lb(b,t.numeric,w);const S=Ow(Aw),k=Ow();lb(S,n,S),lb(S,r,k),lb(k,n,S),lb(k,r,k),ub(x,lw,S),ub(w,lw,S);const C=ub(l,Yb),j=ub(c,Yb),_=ub(j,lw),E=ub(_,lw);lb(l,t.domain,s),ub(l,$b,y),ub(l,Qb,v),lb(c,t.domain,s),ub(c,$b,y),ub(c,Qb,v),lb(C,t.domain,S),ub(C,lw,S),ub(C,ow,S),lb(E,t.domain,S),lb(E,n,S),ub(E,lw,S);const D=[[Cb,jb],[_b,Eb],[Db,Mb],[Tb,Ib],[Ab,Ob],[Rb,zb],[Fb,Pb],[Bb,Lb]];for(let M=0;M<D.length;M++){const[e,t]=D[M],o=ub(S,e);ub(k,e,o),ub(o,t,S);const i=Ow(Aw);lb(o,n,i);const a=Ow();lb(o,r),lb(i,n,i),lb(i,r,a),lb(a,n,i),lb(a,r,a),ub(i,t,S),ub(a,t,S)}return ub(i,mb,x),ub(i,kb,Iw),{start:i,tokens:hw}}(Pw.scanner.tokens);for(let e=0;e<Pw.pluginQueue.length;e++)Pw.pluginQueue[e][1]({scanner:Pw.scanner,parser:Pw.parser});return Pw.initialized=!0,Pw}function Nw(e){return Pw.initialized||Lw(),function(e,t,n){let r=n.length,o=0,i=[],a=[];for(;o<r;){let s=e,l=null,c=null,d=0,u=null,p=-1;for(;o<r&&!(l=s.go(n[o].t));)a.push(n[o++]);for(;o<r&&(c=l||s.go(n[o].t));)l=null,s=c,s.accepts()?(p=0,u=s):p>=0&&p++,o++,d++;if(p<0)o-=d,o<r&&(a.push(n[o]),o++);else{a.length>0&&(i.push(Rw(Tw,t,a)),a=[]),o-=p,d-=p;const e=u.t,r=n.slice(o-d,o);i.push(Rw(e,t,r))}}return a.length>0&&i.push(Rw(Tw,t,a)),i}(Pw.parser.start,e,ww(Pw.scanner.start,e))}function Uw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t&&"object"===typeof t){if(n)throw Error("linkifyjs: Invalid link type ".concat(t,"; must be a string"));n=t,t=null}const r=new jw(n),o=Nw(e),i=[];for(let a=0;a<o.length;a++){const e=o[a];!e.isLink||t&&e.t!==t||!r.check(e)||i.push(e.toFormattedObject(r))}return i}Nw.scan=ww;var Vw="[\0- \xa0\u1680\u180e\u2000-\u2029\u205f\u3000]",Ww=new RegExp(Vw),Hw=new RegExp("".concat(Vw,"$")),Gw=new RegExp(Vw,"g");function Xw(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{const t="string"===typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(Gw,"").match(new RegExp("^(?:(?:".concat(n.join("|"),"):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))"),"i"))}var Yw=Jv.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{"string"!==typeof e?Bw(e.scheme,e.optionalSlashes):Bw(e)})},onDestroy(){sb.groups={},Pw.scanner=null,Pw.parser=null,Pw.tokenQueue=[],Pw.pluginQueue=[],Pw.customSchemes=[],Pw.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!Xw(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!Xw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML(e){let{HTMLAttributes:t}=e;return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Xw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Jm(this.options.HTMLAttributes,t),0]:["a",Jm(this.options.HTMLAttributes,s(s({},t),{},{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.href)||"",o=t.renderChildren(e);return"[".concat(o,"](").concat(r,")")},addCommands(){return{setLink:e=>t=>{let{chain:n}=t;const{href:r}=e;return!!this.options.isAllowedUri(r,{defaultValidate:e=>!!Xw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&n().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>t=>{let{chain:n}=t;const{href:r}=e||{};return!(r&&!this.options.isAllowedUri(r,{defaultValidate:e=>!!Xw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&n().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>e=>{let{chain:t}=e;return t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}},addPasteRules(){return[Ay({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,o=Uw(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!Xw(e,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(e=>{this.options.shouldAutoLink(e.value)&&t.push({text:e.value,data:{href:e.href},index:e.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:null==(t=e.data)?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(function(e){return new ku({key:new _u("autolink"),appendTransaction:(t,n,r)=>{const o=t.some(e=>e.docChanged)&&!n.doc.eq(r.doc),i=t.some(e=>e.getMeta("preventAutolink"));if(!o||i)return;const{tr:a}=r;return uv(Wm(n.doc,[...t])).forEach(t=>{let{newRange:n}=t;const o=function(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&r.push({node:e,pos:t})}),r}(r.doc,n,e=>e.isTextblock);let i,l;if(o.length>1)i=o[0],l=r.doc.textBetween(i.pos,i.pos+i.node.nodeSize,void 0," ");else if(o.length){const e=r.doc.textBetween(n.from,n.to," "," ");if(!Hw.test(e))return;i=o[0],l=r.doc.textBetween(i.pos,n.to,void 0," ")}if(i&&l){const t=l.split(Ww).filter(Boolean);if(t.length<=0)return!1;const n=t[t.length-1],o=i.pos+l.lastIndexOf(n);if(!n)return!1;const d=Nw(n).map(t=>t.toObject(e.defaultProtocol));if(!(1===(c=d).length?c[0].isLink:3===c.length&&c[1].isLink&&["()","[]"].includes(c[0].value+c[2].value)))return!1;d.filter(e=>e.isLink).map(e=>s(s({},e),{},{from:o+e.start+1,to:o+e.end+1})).filter(e=>!r.schema.marks.code||!r.doc.rangeHasMark(e.from,e.to,r.schema.marks.code)).filter(t=>e.validate(t.value)).filter(t=>e.shouldAutoLink(t.value)).forEach(t=>{pv(t.from,t.to,r.doc).some(t=>t.mark.type===e.type)||a.addMark(t.from,t.to,e.type.create({href:t.href}))})}var c}),a.steps.length?a:void 0}})}({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!Xw(e,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),!0===this.options.openOnClick&&e.push(function(e){return new ku({key:new _u("handleClickLink"),props:{handleClick:(t,n,r)=>{var o,i;if(0!==r.button)return!1;if(!t.editable)return!1;let a=null;if(r.target instanceof HTMLAnchorElement)a=r.target;else{let e=r.target;const t=[];for(;"DIV"!==e.nodeName;)t.push(e),e=e.parentNode;a=t.find(e=>"A"===e.nodeName)}if(!a)return!1;const s=cv(t.state,e.type.name),l=null!=(o=null==a?void 0:a.href)?o:s.href,c=null!=(i=null==a?void 0:a.target)?i:s.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),!(!a||!l)&&(window.open(l,c),!0)}}})}({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(function(e){return new ku({key:new _u("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{shouldAutoLink:o}=e,{state:i}=t,{selection:a}=i,{empty:s}=a;if(s)return!1;let l="";r.content.forEach(e=>{l+=e.textContent});const c=Uw(l,{defaultProtocol:e.defaultProtocol}).find(e=>e.isLink&&e.value===l);return!(!l||!c||void 0!==o&&!o(c.href))&&e.editor.commands.setMark(e.type,{href:c.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),qw=Yw;const Zw=["start"];var $w=Object.defineProperty,Kw="textStyle",Jw=/^\s*([-+*])\s$/,Qw=Iy.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},parseHTML:()=>[{tag:"ul"}],renderHTML(e){let{HTMLAttributes:t}=e;return["ul",Jm(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>"list"!==e.type||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Kw)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=by({find:Jw,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=by({find:Jw,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Kw),editor:this.editor})),[e]}}),eS=Iy.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(e){let{HTMLAttributes:t}=e;return["li",Jm(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if("list_item"!==e.type)return[];let n=[];if(e.tokens&&e.tokens.length>0){if(e.tokens.some(e=>"paragraph"===e.type))n=t.parseChildren(e.tokens);else{const r=e.tokens[0];if(r&&"text"===r.type&&r.tokens&&r.tokens.length>0){if(n=[{type:"paragraph",content:t.parseInline(r.tokens)}],e.tokens.length>1){const r=e.tokens.slice(1),o=t.parseChildren(r);n.push(...o)}}else n=t.parseChildren(e.tokens)}}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(e,t,n)=>My(e,t,e=>"bulletList"===e.parentType?"- ":"orderedList"===e.parentType?"".concat(e.index+1,". "):"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});((e,t)=>{for(var n in t)$w(e,n,{get:t[n],enumerable:!0})})({},{findListItemPos:()=>tS,getNextListDepth:()=>nS,handleBackspace:()=>aS,handleDelete:()=>cS,hasListBefore:()=>rS,hasListItemAfter:()=>dS,hasListItemBefore:()=>oS,listItemHasSubList:()=>iS,nextListIsDeeper:()=>sS,nextListIsHigher:()=>lS});var tS=(e,t)=>{const{$from:n}=t.selection,r=Wg(e,t.schema);let o=null,i=n.depth,a=n.pos,s=null;for(;i>0&&null===s;)o=n.node(i),o.type===r?s=i:(i-=1,a-=1);return null===s?null:{$pos:t.doc.resolve(a),depth:s}},nS=(e,t)=>{const n=tS(e,t);if(!n)return!1;const[,r]=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;const o=e.doc.resolve(n);let i=r,a=null;for(;i>0&&null===a;){const e=o.node(i);(null==e?void 0:e.type.name)===t?a=e:i-=1}return[a,i]}(t,e,n.$pos.pos+4);return r},rS=(e,t,n)=>{const{$anchor:r}=e.selection,o=Math.max(0,r.pos-2),i=e.doc.resolve(o).node();return!(!i||!n.includes(i.type.name))},oS=(e,t)=>{var n;const{$anchor:r}=t.selection,o=t.doc.resolve(r.pos-2);return 0!==o.index()&&(null==(n=o.nodeBefore)?void 0:n.type.name)===e},iS=(e,t,n)=>{if(!n)return!1;const r=Wg(e,t.schema);let o=!1;return n.descendants(e=>{e.type===r&&(o=!0)}),o},aS=(e,t,n)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!jm(e.state,t)&&rS(e.state,t,n)){const{$anchor:n}=e.state.selection,r=e.state.doc.resolve(n.before()-1),o=[];r.node().descendants((e,n)=>{e.type.name===t&&o.push({node:e,pos:n})});const i=o.at(-1);if(!i)return!1;const a=e.state.doc.resolve(r.start()+i.pos+1);return e.chain().cut({from:n.start()-1,to:n.end()+1},a.end()).joinForward().run()}if(!jm(e.state,t))return!1;if(!(e=>{const{$from:t,$to:n}=e.selection;return!(t.parentOffset>0||t.pos!==n.pos)})(e.state))return!1;const r=tS(t,e.state);if(!r)return!1;const o=e.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=iS(t,e.state,o);return oS(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},sS=(e,t)=>{const n=nS(e,t),r=tS(e,t);return!(!r||!n)&&n>r.depth},lS=(e,t)=>{const n=nS(e,t),r=tS(e,t);return!(!r||!n)&&n<r.depth},cS=(e,t)=>{if(!jm(e.state,t))return!1;if(!((e,t)=>{const{$from:n,$to:r,$anchor:o}=e.selection;if(t){const n=Hm(e=>e.type.name===t)(e.selection);if(!n)return!1;const r=e.doc.resolve(n.pos+1);return o.pos+1===r.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)})(e.state,t))return!1;const{selection:n}=e.state,{$from:r,$to:o}=n;return!(!n.empty&&r.sameParent(o))&&(sS(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():lS(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward())},dS=(e,t)=>{var n;const{$anchor:r}=t.selection,o=t.doc.resolve(r.pos-r.parentOffset-2);return o.index()!==o.parent.childCount-1&&(null==(n=o.nodeAfter)?void 0:n.type.name)===e},uS=oy.create({name:"listKeymap",addOptions:()=>({listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}),addKeyboardShortcuts(){return{Delete:e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:r}=e;void 0!==t.state.schema.nodes[r]&&cS(t,r)&&(n=!0)}),n},"Mod-Delete":e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:r}=e;void 0!==t.state.schema.nodes[r]&&cS(t,r)&&(n=!0)}),n},Backspace:e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:r,wrapperNames:o}=e;void 0!==t.state.schema.nodes[r]&&aS(t,r,o)&&(n=!0)}),n},"Mod-Backspace":e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:r,wrapperNames:o}=e;void 0!==t.state.schema.nodes[r]&&aS(t,r,o)&&(n=!0)}),n}}}}),pS=/^(\s*)(\d+)\.\s+(.*)$/,hS=/^\s/;function fS(e,t,n){var r;const o=[];let i=0;for(;i<e.length;){const a=e[i];if(a.indent===t){const s=a.content.split("\n"),l=(null==(r=s[0])?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const d=s.slice(1).join("\n").trim();if(d){const e=n.blockTokens(d);c.push(...e)}let u=i+1;const p=[];for(;u<e.length&&e[u].indent>t;)p.push(e[u]),u+=1;if(p.length>0){const e=Math.min(...p.map(e=>e.indent)),t=fS(p,e,n);c.push({type:"list",ordered:!0,start:p[0].number,items:t,raw:p.map(e=>e.raw).join("\n")})}o.push({type:"list_item",raw:a.raw,tokens:c}),i=u}else i+=1}return o}var gS="textStyle",mS=/^(\d+)\.\s$/,vS=Iy.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(e){let{HTMLAttributes:t}=e;const{start:n}=t,r=l(t,Zw);return 1===n?["ol",Jm(this.options.HTMLAttributes,r),0]:["ol",Jm(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if("list"!==e.type||!e.ordered)return[];const n=e.start||1,r=e.items?function(e,t){return e.map(e=>{if("list_item"!==e.type)return t.parseChildren([e])[0];const n=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(e=>{if("paragraph"===e.type||"list"===e.type||"blockquote"===e.type||"code"===e.type)n.push(...t.parseChildren([e]));else if("text"===e.type&&e.tokens){const r=t.parseChildren([e]);n.push({type:"paragraph",content:r})}else{const r=t.parseChildren([e]);r.length>0&&n.push(...r)}}),{type:"listItem",content:n}})}(e.items,t):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),n=null==t?void 0:t.index;return void 0!==n?n:-1},tokenize:(e,t,n)=>{var r;const o=e.split("\n"),[i,a]=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const o=e[n],i=o.match(pS);if(!i)break;const[,a,s,l]=i,c=a.length;let d=l,u=n+1;const p=[o];for(;u<e.length;){const t=e[u];if(t.match(pS))break;if(""===t.trim())p.push(t),d+="\n",u+=1;else{if(!t.match(hS))break;p.push(t),d+="\n".concat(t.slice(c+2)),u+=1}}t.push({indent:c,number:parseInt(s,10),content:d.trim(),raw:p.join("\n")}),r=u,n=u}return[t,r]}(o);if(0===i.length)return;const s=fS(i,0,n);if(0===s.length)return;return{type:"list",ordered:!0,start:(null==(r=i[0])?void 0:r.number)||1,items:s,raw:o.slice(0,a).join("\n")}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(gS)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=by({find:mS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=by({find:mS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>s({start:+e[1]},this.editor.getAttributes(gS)),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),yS=/^\s*(\[([( |x])?\])\s$/,xS=Iy.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return""===t||"true"===t},renderHTML:e=>({"data-checked":e.checked})}}),parseHTML(){return[{tag:'li[data-type="'.concat(this.name,'"]'),priority:51}]},renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["li",Jm(this.options.HTMLAttributes,n,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const n=[];if(e.tokens&&e.tokens.length>0?n.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?n.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):n.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const r=t.parseChildren(e.nestedTokens);n.push(...r)}return t.createNode("taskItem",{checked:e.checked||!1},n)},renderMarkdown:(e,t)=>{var n;const r=(null==(n=e.attrs)?void 0:n.checked)?"x":" ";return My(e,t,"- [".concat(r,"] "))},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?s(s({},e),{},{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return e=>{let{node:t,HTMLAttributes:n,getPos:r,editor:o}=e;const i=document.createElement("li"),a=document.createElement("label"),l=document.createElement("span"),c=document.createElement("input"),d=document.createElement("div"),u=e=>{var t,n;c.ariaLabel=(null==(n=null==(t=this.options.a11y)?void 0:t.checkboxLabel)?void 0:n.call(t,e,c.checked))||"Task item checkbox for ".concat(e.textContent||"empty task item")};return u(t),a.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",e=>e.preventDefault()),c.addEventListener("change",e=>{if(!o.isEditable&&!this.options.onReadOnlyChecked)return void(c.checked=!c.checked);const{checked:n}=e.target;o.isEditable&&"function"===typeof r&&o.chain().focus(void 0,{scrollIntoView:!1}).command(e=>{let{tr:t}=e;const o=r();if("number"!==typeof o)return!1;const i=t.doc.nodeAt(o);return t.setNodeMarkup(o,void 0,s(s({},null==i?void 0:i.attrs),{},{checked:n})),!0}).run(),!o.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,n)||(c.checked=!c.checked))}),Object.entries(this.options.HTMLAttributes).forEach(e=>{let[t,n]=e;i.setAttribute(t,n)}),i.dataset.checked=t.attrs.checked,c.checked=t.attrs.checked,a.append(c,l),i.append(a,d),Object.entries(n).forEach(e=>{let[t,n]=e;i.setAttribute(t,n)}),{dom:i,contentDOM:d,update:e=>e.type===this.type&&(i.dataset.checked=e.attrs.checked,c.checked=e.attrs.checked,u(e),!0)}}},addInputRules(){return[by({find:yS,type:this.type,getAttributes:e=>({checked:"x"===e[e.length-1]})})]}}),bS=Iy.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},parseHTML(){return[{tag:'ul[data-type="'.concat(this.name,'"]'),priority:51}]},renderHTML(e){let{HTMLAttributes:t}=e;return["ul",Jm(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const n=null==(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:t.index;return void 0!==n?n:-1},tokenize(e,t,n){const r=e=>{const t=Dy(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:r},n);return t?[{type:"taskList",raw:t.raw,items:t.items}]:n.blockTokens(e)},o=Dy(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:r},n);if(o)return{type:"taskList",raw:o.raw,items:o.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>e=>{let{commands:t}=e;return t.toggleList(this.name,this.options.itemTypeName)}}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),wS=(oy.create({name:"listKit",addExtensions(){const e=[];return!1!==this.options.bulletList&&e.push(Qw.configure(this.options.bulletList)),!1!==this.options.listItem&&e.push(eS.configure(this.options.listItem)),!1!==this.options.listKeymap&&e.push(uS.configure(this.options.listKeymap)),!1!==this.options.orderedList&&e.push(vS.configure(this.options.orderedList)),!1!==this.options.taskItem&&e.push(xS.configure(this.options.taskItem)),!1!==this.options.taskList&&e.push(bS.configure(this.options.taskList)),e}}),Iy.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(e){let{HTMLAttributes:t}=e;return["p",Jm(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>{const n=e.tokens||[];return 1===n.length&&"image"===n[0].type?t.parseChildren([n[0]]):t.createNode("paragraph",void 0,t.parseInline(n))},renderMarkdown:(e,t)=>e&&Array.isArray(e.content)?t.renderChildren(e.content):"",addCommands(){return{setParagraph:()=>e=>{let{commands:t}=e;return t.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}})),SS=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,kS=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,CS=Jv.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["s",Jm(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"~~".concat(t.renderChildren(e),"~~"),addCommands(){return{setStrike:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleStrike:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetStrike:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[yy({find:SS,type:this.type})]},addPasteRules(){return[Ay({find:kS,type:this.type})]}}),jS=Iy.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),_S=Jv.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["u",Jm(this.options.HTMLAttributes,t),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown:(e,t)=>"++".concat(t.renderChildren(e),"++"),markdownTokenizer:{name:"underline",level:"inline",start:e=>e.indexOf("++"),tokenize(e,t,n){const r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!r)return;const o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleUnderline:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetUnderline:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),ES=_S;function DS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ku({view:t=>new MS(t,e)})}class MS{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(e=>{let{name:t,handler:n}=e;return this.editorView.dom.removeEventListener(t,n)})}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r=this.editorView.dom,o=r.getBoundingClientRect(),i=o.width/r.offsetWidth,a=o.height/r.offsetHeight;if(n){let n=t.nodeBefore,r=t.nodeAfter;if(n||r){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let o=t.getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let s=this.width/2*a;e={left:o.left,right:o.right,top:i-s,bottom:i+s}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let s,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)s=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;s=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-s)/i+"px",this.element.style.top=(e.top-l)/a+"px",this.element.style.width=(e.right-e.left)/i+"px",this.element.style.height=(e.bottom-e.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=Ud(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class TS extends ou{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return TS.valid(n)?new TS(n):ou.near(n)}content(){return pc.empty}eq(e){return e instanceof TS&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new TS(e.resolve(t.pos))}getBookmark(){return new IS(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0!=n)for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||AS(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||AS(e.type))return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!n&&TS.valid(e))return e;let r=e.pos,o=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){o=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let a=e.doc.resolve(r);if(TS.valid(a))return a}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!du.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue e}break}o=i,r+=t;let a=e.doc.resolve(r);if(TS.valid(a))return a}return null}}}TS.prototype.visible=!1,TS.findFrom=TS.findGapCursorFrom,ou.jsonID("gapcursor",TS);class IS{constructor(e){this.pos=e}map(e){return new IS(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return TS.valid(t)?new TS(t):ou.near(t)}}function AS(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}const OS=Tg({ArrowLeft:RS("horiz",-1),ArrowRight:RS("horiz",1),ArrowUp:RS("vert",-1),ArrowDown:RS("vert",1)});function RS(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){let i=e.selection,a=t>0?i.$to:i.$from,s=i.empty;if(i instanceof lu){if(!o.endOfTextblock(n)||0==a.depth)return!1;s=!1,a=e.doc.resolve(t>0?a.after():a.before())}let l=TS.findGapCursorFrom(a,t,s);return!!l&&(r&&r(e.tr.setSelection(new TS(l))),!0)}}function zS(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!TS.valid(r))return!1;let o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&du.isSelectable(e.state.doc.nodeAt(o.inside)))&&(e.dispatch(e.state.tr.setSelection(new TS(r))),!0)}function FS(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof TS))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let o=ac.empty;for(let a=r.length-1;a>=0;a--)o=ac.from(r[a].createAndFill(null,o));let i=e.state.tr.replace(n.pos,n.pos,new pc(o,0,0));return i.setSelection(lu.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function PS(e){if(!(e.selection instanceof TS))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Wf.create(e.doc,[Nf.widget(e.selection.head,t,{key:"gapcursor"})])}var BS=200,LS=function(){};LS.prototype.append=function(e){return e.length?(e=LS.from(e),!this.length&&e||e.length<BS&&this.leafAppend(e)||this.length<BS&&e.leafPrepend(this)||this.appendInner(e)):this},LS.prototype.prepend=function(e){return e.length?LS.from(e).append(this):this},LS.prototype.appendInner=function(e){return new US(this,e)},LS.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?LS.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},LS.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},LS.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},LS.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},LS.from=function(e){return e instanceof LS?e:e&&e.length?new NS(e):LS.empty};var NS=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=BS)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=BS)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(LS);LS.empty=new NS([]);var US=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(LS);const VS=LS;class WS{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--){if(this.items.get(o-1).selection){--o;break}}t&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,a,s=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(o,t+1),r=n.maps.length),r--,void c.push(e);if(n){c.push(new HS(e.map));let t,o=e.step.map(n.slice(r));o&&s.maybeStep(o).doc&&(t=s.mapping.maps[s.mapping.maps.length-1],l.push(new HS(t,void 0,void 0,l.length+c.length))),r--,t&&n.appendMap(t,r)}else s.maybeStep(e.step);return e.selection?(i=n?e.selection.map(n.slice(r)):e.selection,a=new WS(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:a,transform:s,selection:i}}addTransform(e,t,n,r){let o=[],i=this.eventCount,a=this.items,s=!r&&a.length?a.get(a.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),d=new HS(e.mapping.maps[c],l,t);(n=s&&s.merge(d))&&(d=n,c?o.pop():a=a.slice(0,a.length-1)),o.push(d),t&&(i++,t=void 0),r||(s=d)}let l=i-n.depth;return l>XS&&(a=function(e,t){let n;return e.forEach((e,r)=>{if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}(a,l),i-=l),new WS(a.append(o),i)}remapping(e,t){let n=new yd;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new WS(this.items.append(e.map(e=>new HS(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(e=>{e.selection&&a--},r);let s=t;this.items.forEach(t=>{let r=o.getMirror(--s);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(s+1,r));c&&a++,n.push(new HS(l,i,c))}else n.push(new HS(l))},r);let l=[];for(let u=t;u<i;u++)l.push(new HS(o.maps[u]));let c=this.items.slice(0,r).append(l).append(n),d=new WS(c,a);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-n.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,a)=>{if(a>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),a=e&&e.getMap();if(n--,a&&t.appendMap(a,n),e){let s=i.selection&&i.selection.map(t.slice(n));s&&o++;let l,c=new HS(a.invert(),e,s),d=r.length-1;(l=r.length&&r[d].merge(c))?r[d]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new WS(VS.from(r.reverse()),o)}}WS.empty=new WS(VS.empty,0);class HS{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new HS(t.getMap().invert(),t,this.selection)}}}class GS{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const XS=20;function YS(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function qS(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let ZS=!1,$S=null;function KS(e){let t=e.plugins;if($S!=t){ZS=!1,$S=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){ZS=!0;break}}return ZS}const JS=new _u("history"),QS=new _u("closeHistory");function ek(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new ku({key:JS,state:{init:()=>new GS(WS.empty,WS.empty,null,0,-1),apply:(t,n,r)=>function(e,t,n,r){let o,i=n.getMeta(JS);if(i)return i.historyState;n.getMeta(QS)&&(e=new GS(e.done,e.undone,null,0,-1));let a=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(a&&a.getMeta(JS))return a.getMeta(JS).redo?new GS(e.done.addTransform(n,void 0,r,KS(t)),e.undone,YS(n.mapping.maps),e.prevTime,e.prevComposition):new GS(e.done,e.undone.addTransform(n,void 0,r,KS(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new GS(e.done.rebased(n,o),e.undone.rebased(n,o),qS(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new GS(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),qS(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!a&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),s=a?qS(e.prevRanges,n.mapping):YS(n.mapping.maps);return new GS(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,KS(t)),WS.empty,s,n.time,null==o?e.prevComposition:o)}}(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?nk:"historyRedo"==n?rk:null;return!(!r||!e.editable)&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function tk(e,t){return(n,r)=>{let o=JS.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=KS(t),o=JS.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let a=i.selection.resolve(i.transform.doc),s=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),l=new GS(n?s:i.remaining,n?i.remaining:s,null,0,-1);return i.transform.setSelection(a).setMeta(JS,{redo:n,historyState:l})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}const nk=tk(!1,!0),rk=tk(!0,!0);tk(!1,!1),tk(!0,!1);oy.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(e=>""!==e).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||this.options.mode)){const e=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(e)}return t.nodeSize},this.storage.words=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new ku({key:new _u("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;const o=this.options.limit;if(null===o||void 0===o||0===o)return void(e=!0);const i=this.storage.characters({node:r.doc});if(i>o){const t=0,n=i-o;console.warn("[CharacterCount] Initial content exceeded limit of ".concat(o," characters. Content was automatically trimmed."));const a=r.tr.deleteRange(t,n);return e=!0,a}e=!0},filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||0===n||null===n||void 0===n)return!0;const r=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=n)return!0;if(r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r)return!1;if(!e.getMeta("paste"))return!1;const i=e.selection.$head.pos,a=i-(o-n),s=i;e.deleteRange(a,s);return!(this.storage.characters({node:e.doc})>n)}})]}});var ok=oy.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[DS(this.options)]}}),ik=(oy.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new ku({key:new _u("focus"),props:{decorations:e=>{let{doc:t,selection:n}=e;const{isEditable:r,isFocused:o}=this.editor,{anchor:i}=n,a=[];if(!r||!o)return Wf.create(t,[]);let s=0;"deepest"===this.options.mode&&t.descendants((e,t)=>{if(e.isText)return;if(!(i>=t&&i<=t+e.nodeSize-1))return!1;s+=1});let l=0;return t.descendants((e,t)=>{if(e.isText)return!1;if(!(i>=t&&i<=t+e.nodeSize-1))return!1;l+=1;if("deepest"===this.options.mode&&s-l>0||"shallowest"===this.options.mode&&l>1)return"deepest"===this.options.mode;a.push(Nf.node(t,t+e.nodeSize,{class:this.options.className}))}),Wf.create(t,a)}}})]}}),oy.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ku({props:{decorations:PS,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&TS.valid(n)?new TS(n):null,handleClick:zS,handleKeyDown:OS,handleDOMEvents:{beforeinput:FS}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!=(t=Zm(Gm(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))?t:null}}}));oy.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new ku({key:new _u("placeholder"),props:{decorations:e=>{let{doc:t,selection:n}=e;const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:o}=n,i=[];if(!r)return null;const a=this.editor.isEmpty;return t.descendants((e,t)=>{const n=o>=t&&o<=t+e.nodeSize,r=!e.isLeaf&&yv(e);if((n||!this.options.showOnlyCurrent)&&r){const r=[this.options.emptyNodeClass];a&&r.push(this.options.emptyEditorClass);const o=Nf.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"===typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});i.push(o)}return this.options.includeChildren}),Wf.create(t,i)}}})]}}),oy.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new ku({key:new _u("selection"),props:{decorations:n=>n.selection.empty||e.isFocused||!e.isEditable||xv(n.selection)||e.view.dragging?null:Wf.create(n.doc,[Nf.inline(n.selection.from,n.selection.to,{class:t.className})])}})]}});function ak(e){let{types:t,node:n}=e;return n&&Array.isArray(t)&&t.includes(n.type)||(null==n?void 0:n.type)===t}var sk=oy.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var e;const t=new _u(this.name),n=this.options.node||(null==(e=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:e.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(e=>{let[,t]=e;return t}).filter(e=>(this.options.notAfter||[]).concat(n).includes(e.name));return[new ku({key:t,appendTransaction:(e,r,o)=>{const{doc:i,tr:a,schema:s}=o,l=t.getState(o),c=i.content.size,d=s.nodes[n];if(l)return a.insert(c,d.create())},state:{init:(e,t)=>!ak({node:t.tr.doc.lastChild,types:r}),apply:(e,t)=>{if(!e.docChanged)return t;if(e.getMeta("__uniqueIDTransaction"))return t;return!ak({node:e.doc.lastChild,types:r})}}})]}}),lk=oy.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>e=>{let{state:t,dispatch:n}=e;return nk(t,n)},redo:()=>e=>{let{state:t,dispatch:n}=e;return rk(t,n)}}),addProseMirrorPlugins(){return[ek(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),ck=oy.create({name:"starterKit",addExtensions(){var e,t,n,r;const o=[];return!1!==this.options.bold&&o.push(Ox.configure(this.options.bold)),!1!==this.options.blockquote&&o.push(Dx.configure(this.options.blockquote)),!1!==this.options.bulletList&&o.push(Qw.configure(this.options.bulletList)),!1!==this.options.code&&o.push(Fx.configure(this.options.code)),!1!==this.options.codeBlock&&o.push(Lx.configure(this.options.codeBlock)),!1!==this.options.document&&o.push(Nx.configure(this.options.document)),!1!==this.options.dropcursor&&o.push(ok.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&o.push(ik.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&o.push(Ux.configure(this.options.hardBreak)),!1!==this.options.heading&&o.push(Vx.configure(this.options.heading)),!1!==this.options.undoRedo&&o.push(lk.configure(this.options.undoRedo)),!1!==this.options.horizontalRule&&o.push(Wx.configure(this.options.horizontalRule)),!1!==this.options.italic&&o.push(qx.configure(this.options.italic)),!1!==this.options.listItem&&o.push(eS.configure(this.options.listItem)),!1!==this.options.listKeymap&&o.push(uS.configure(null==(e=this.options)?void 0:e.listKeymap)),!1!==this.options.link&&o.push(Yw.configure(null==(t=this.options)?void 0:t.link)),!1!==this.options.orderedList&&o.push(vS.configure(this.options.orderedList)),!1!==this.options.paragraph&&o.push(wS.configure(this.options.paragraph)),!1!==this.options.strike&&o.push(CS.configure(this.options.strike)),!1!==this.options.text&&o.push(jS.configure(this.options.text)),!1!==this.options.underline&&o.push(_S.configure(null==(n=this.options)?void 0:n.underline)),!1!==this.options.trailingNode&&o.push(sk.configure(null==(r=this.options)?void 0:r.trailingNode)),o}});const dk=n.p+"static/media/bold.41f57a00325fe3457fac406b73532012.svg";const uk=n.p+"static/media/italic.7182c2308f441a86b0dc3a98e1533b61.svg";const pk=n.p+"static/media/underlined.a806bdfbf788b60d9e145378f92e5c3a.svg";const hk=n.p+"static/media/strikethrough.d0ac6cdd85cad2db575fd6196c97d72f.svg";const fk=n.p+"static/media/code.4dbda37178ab9bbd5da645ae75e5f8a2.svg";const gk=n.p+"static/media/pre.3c753be7a3e519200f358b5269ef0e4f.svg";const mk=n.p+"static/media/hide.cc2e2d54e713af50ddb7137c3544c4cd.svg";const vk=n.p+"static/media/quote.c51d286ac2170fcc54fc5734e54e23bd.svg";const yk=n.p+"static/media/link.b95f85e137c81ff64bcb85d4a1a67d91.svg";const xk=n.p+"static/media/time.1934e893a0580554a6010e9ac3713999.svg";const bk=n.p+"static/media/tag.7efdb48cc9d7eed919d8a564aea65bf3.svg";const wk=n.p+"static/media/copy.2547677716b62f8338f4438c9c8b6a47.svg";const Sk=n.p+"static/media/select-all.e2e8e45942637c89e1fd8c8638f2dbd0.svg";const kk=n.p+"static/media/trash.e21cbc6753a20770bfaadd7d0bd540b4.svg";const Ck=n.p+"static/media/undo.f11ed93a09602429d1690c587c7a7c07.svg";const jk=n.p+"static/media/redo.dd9ea40512e26e9ae3c1f9daf412450a.svg";const _k=n.p+"static/media/save.78b437a882f7c4073c2304dd6c57e0ce.svg",Ek=e=>{let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return Math.abs(t)},Dk=/\{\{\{([A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u04510-9_]+)\}\}\}/g,Mk=/\{\{(?!\{)([A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u04510-9_]+):\s*([^}]+)\}\}/g,Tk=/\{\{(?!\{)([A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u04510-9_]+)\}\}(?!\})/g,Ik=oy.create({name:"attributeHighlight",addProseMirrorPlugins(){const e=e=>{const t=[],n=[],r=[];e.descendants((e,o)=>{if(!e.isText)return;const i=e.text;let a;for(Dk.lastIndex=0;null!==(a=Dk.exec(i));){const e=a[1],n=o+a.index,r=o+a.index+a[0].length,i=Ek(e)%7+1;t.push(Nf.inline(n,r,{class:"attr-c-".concat(i)}))}for(Mk.lastIndex=0;null!==(a=Mk.exec(i));)n.push({name:a[1],from:o+a.index,to:o+a.index+a[0].length});for(Tk.lastIndex=0;null!==(a=Tk.exec(i));)r.push({name:a[1],from:o+a.index,to:o+a.index+a[0].length})});const o=new Set;return n.forEach(e=>{const n=r.find(t=>t.name===e.name&&t.from>e.from&&!o.has(t));if(n){o.add(n);const r=Ek(e.name),i="attr-c-".concat(r%7+1);t.push(Nf.inline(e.from,n.to,{class:i}))}}),Wf.create(e,t)};let t=null;return t=new ku({state:{init(t,n){let{doc:r}=n;return e(r)},apply:(t,n)=>t.docChanged?e(t.doc):n.map(t.mapping,t.doc)},props:{decorations:e=>t.getState(e)}}),[t]}}),Ak=Ik;function Ok(t){let{onSubmit:n,onCancel:r,userId:o,storyId:i}=t;const[a,s]=(0,e.useState)(""),[l,d]=(0,e.useState)("="),[u,p]=(0,e.useState)(!1),[h,f]=(0,e.useState)(""),[g,m]=(0,e.useState)(""),[v,y]=(0,e.useState)([]),[x,b]=(0,e.useState)(!1),[w,S]=(0,e.useState)(!1),k="display"===l;(0,e.useEffect)(()=>{!async function(){b(!0);const e=await Yl(o,i);y(e||[]),b(!1)}()},[o,i]);return(0,c.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,c.jsxs)("div",{className:"modal-content small",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:k?"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u0442\u0440\u0438\u0431\u0443\u0442":"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430"}),(0,c.jsx)("p",{style:{color:"#777",fontSize:"13px",marginTop:"-4px",marginBottom:"12px"},children:k?"\u0412 \u044d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e.":"\u0422\u0435\u043a\u0441\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u043f\u043e\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0432\u043d\u0443\u0442\u0440\u044c \u044d\u0442\u043e\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430"}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"}),(0,c.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,c.jsx)("input",{type:"text",value:a,onChange:e=>{const t=e.target.value;s(t),S(""===t.trim())},placeholder:"\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0441\u0438\u043b\u0430",onFocus:()=>S(""===a.trim()),onBlur:()=>setTimeout(()=>S(!1),150)}),w&&v.length>0&&(0,c.jsx)("ul",{className:"suggestions-list",style:{position:"absolute",top:"100%",left:0,width:"100%",background:"#fff",border:"1px solid #ccc",borderRadius:"6px",maxHeight:"90px",overflowY:"auto",zIndex:1e3,fontSize:"13px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:x?(0,c.jsx)("li",{style:{padding:"6px 10px",color:"#555"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):v.map(e=>(0,c.jsx)("li",{style:{padding:"6px 10px",cursor:"pointer",borderBottom:"1px solid #eee",color:"#222",backgroundColor:"#fff"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",onMouseDown:()=>(e=>{s(e),S(!1)})(e),children:e},e))})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435:"})," ",(0,c.jsxs)("select",{value:l,onChange:e=>d(e.target.value),children:[(0,c.jsx)("option",{value:"=",children:"\u0420\u0430\u0432\u043d\u043e (=)"}),(0,c.jsx)("option",{value:"<",children:"\u041c\u0435\u043d\u044c\u0448\u0435 (<)"}),(0,c.jsx)("option",{value:">",children:"\u0411\u043e\u043b\u044c\u0448\u0435 (>)"}),(0,c.jsx)("option",{value:"display",children:"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c "})," "]})]}),!k&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"form-row checkbox",children:(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",checked:u,onChange:e=>p(e.target.checked)}),"\u0420\u0430\u043d\u0434\u043e\u043c"]})}),u?(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u041e\u0442:"}),(0,c.jsx)("input",{type:"number",value:h,onChange:e=>f(e.target.value)}),(0,c.jsx)("label",{children:"\u0414\u043e:"}),(0,c.jsx)("input",{type:"number",value:g,onChange:e=>m(e.target.value)})]}):(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435:"}),(0,c.jsx)("input",{type:"number",value:h,onChange:e=>f(e.target.value)})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{if(!a.trim())return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430");if(k)n({name:a.trim(),isDisplay:!0});else{let e="";if(u){if(""===h||""===g)return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0447\u0438\u0441\u0435\u043b");e="".concat(l).concat(h,"-").concat(g)}else{if(""===h)return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435");e="".concat(l).concat(h)}n({name:a.trim(),resultValue:e,isDisplay:!1})}},children:"OK"})]})]})})}function Rk(t){let{onSubmit:n,onCancel:r,existingText:o=""}=t;const[i,a]=(0,e.useState)("timer"),[s,l]=(0,e.useState)("add"),[d,u]=(0,e.useState)(""),[p,h]=(0,e.useState)(!1);(0,e.useEffect)(()=>{u(""),l("event"===i?"event":"add")},[i]);return(0,c.jsx)("div",{className:"modal-overlay",onPointerDown:r,children:(0,c.jsxs)("div",{className:"modal-content small",onPointerDown:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:"\u0412\u0441\u0442\u0430\u0432\u043a\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f"}),(0,c.jsx)("div",{onClick:()=>h(!p),style:{cursor:"pointer",color:"#888",fontSize:"13px",marginBottom:"8px",userSelect:"none"},children:"\u25b6 \u041f\u043e\u043c\u043e\u0449\u044c (\u0447\u0442\u043e \u044d\u0442\u043e?)"}),p&&(0,c.jsxs)("div",{style:{background:"var(--bg-hover)",padding:"10px",borderRadius:"6px",fontSize:"12px",lineHeight:"1.4",color:"var(--text-muted)",marginBottom:"15px"},children:[(0,c.jsxs)("p",{style:{marginBottom:"5px"},children:[(0,c.jsx)("strong",{children:"\u26a0\ufe0f \u0412\u0430\u0436\u043d\u043e:"})," \u0412 Telegram \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0431\u044b\u0447\u043d\u044b\u0439 ",(0,c.jsx)("b",{children:"\u0422\u0430\u0439\u043c\u0435\u0440"}),'. \u0420\u0435\u0436\u0438\u043c\u044b "\u041a\u043b\u0438\u043a" \u0438 "\u0421\u043e\u0431\u044b\u0442\u0438\u0435" \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f Web-\u0432\u0435\u0440\u0441\u0438\u0439 \u043d\u043e\u0432\u0435\u043b\u043b\u044b.']}),(0,c.jsxs)("ul",{style:{paddingLeft:"15px",margin:0},children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0422\u0430\u0439\u043c\u0435\u0440:"})," \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 N \u0441\u0435\u043a\u0443\u043d\u0434. (+) \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0442\u0435\u043a\u0441\u0442, (-) \u043e\u0447\u0438\u0449\u0430\u0435\u0442 \u044d\u043a\u0440\u0430\u043d."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u041a\u043b\u0438\u043a:"})," \u0422\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435, \u043d\u043e \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043f\u043e \u043a\u043b\u0438\u043a\u0443 \u0438\u0433\u0440\u043e\u043a\u0430, \u0430 \u043d\u0435 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0421\u043e\u0431\u044b\u0442\u0438\u0435:"})," \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0438\u0433\u043d\u0430\u043b \u0434\u0432\u0438\u0436\u043a\u0443 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, ",(0,c.jsx)("code",{children:"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436_\u0410_\u0423\u0448\u0435\u043b"}),"). \u041d\u0435 \u0434\u0443\u0431\u043b\u0438\u0440\u0443\u0439\u0442\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u0431\u043b\u043e\u043a\u0435."]})]})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{style:{minWidth:"70px"},children:"\u0422\u0438\u043f:"}),(0,c.jsxs)("select",{className:"prompt-input",value:i,onChange:e=>a(e.target.value),children:[(0,c.jsx)("option",{value:"timer",children:"\u23f1 \u0422\u0430\u0439\u043c\u0435\u0440 (Time)"}),(0,c.jsx)("option",{value:"click",children:"\ud83d\udc46 \u041a\u043b\u0438\u043a (Click)"}),(0,c.jsx)("option",{value:"event",children:"\u26a1 \u0421\u043e\u0431\u044b\u0442\u0438\u0435 (Event)"})]})]}),"event"!==i?(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{style:{minWidth:"70px"},children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435:"}),(0,c.jsxs)("select",{className:"prompt-input",value:s,onChange:e=>l(e.target.value),children:[(0,c.jsx)("option",{value:"add",children:"\u2795 \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsx)("option",{value:"clear",children:"\u26d4 \u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u044d\u043a\u0440\u0430\u043d"})]})]}):null,"click"!==i&&(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{style:{minWidth:"70px"},children:"timer"===i?"\u0421\u0435\u043a\u0443\u043d\u0434\u044b:":"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"}),(0,c.jsx)("input",{type:"timer"===i?"number":"text",className:"prompt-input",value:d,onChange:e=>u(e.target.value),placeholder:"timer"===i?"1, 2, 3...":"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: Start_Battle",autoFocus:!0})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{let e="";if("timer"===i){if(!d.trim())return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u043a\u0443\u043d\u0434");e="[[".concat("add"===s?"+":"-").concat(d.trim(),"]]")}else if("click"===i){e="[[click".concat("add"===s?"+":"-","]]")}else if("event"===i){if(!d.trim())return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f");let t=d.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z\u0430-\u044f\u0410-\u042f0-9_]/g,"");if(!t)return alert("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0438\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u044f");if(e="[[Event:".concat(t,"]]"),o.includes(e))return alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u0422\u0430\u043a\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u044d\u0442\u043e\u043c \u0442\u0435\u043a\u0441\u0442\u0435!")}n(e)},children:"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c"})]})]})})}const zk="\n/* \u041e\u041f\u0420\u0415\u0414\u0415\u041b\u0415\u041d\u0418\u0415 \u041f\u0415\u0420\u0415\u041c\u0415\u041d\u041d\u042b\u0425 (\u0421\u0432\u0435\u0442\u043b\u0430\u044f \u0442\u0435\u043c\u0430) */\n:root {\n  --bg-modal: #ffffff;\n  --bg-input: #ffffff;\n  --bg-hover: #f1f5f9;\n  --bg-editor: #f8fafc;\n  --bg-toolbar-btn: #ffffff;\n  --bg-toolbar-btn-hover: #f1f5f9;\n  --text-main: #0f172a;\n  --text-muted: #64748b;\n  --border-color: #e2e8f0;\n  --border-light: #cbd5e1;\n  --scroll-track: #f1f5f9;\n  --scroll-thumb: #94a3b8;\n  --shadow-color: rgba(0,0,0,0.1);\n  \n  --icon-filter: brightness(0); \n  \n  --accent-color: #2563eb;\n  --accent-hover: #1d4ed8;\n  --active-btn-bg: #eff6ff;\n  --active-btn-text: #2563eb;\n  --danger-color: #ef4444;\n}\n\n/* \ud83d\udd25 \u0422\u0415\u041c\u041d\u0410\u042f \u0422\u0415\u041c\u0410 */\nbody.dark-mode {\n  --bg-modal: #1f2937;\n  --bg-input: #111827;\n  --bg-hover: #374151;\n  --bg-editor: #111827;\n  --bg-toolbar-btn: #1f2937;      \n  --bg-toolbar-btn-hover: #374151;\n  --text-main: #f3f4f6;\n  --text-muted: #9ca3af;\n  --border-color: #374151;   \n  --border-light: #4b5563;   \n  --scroll-track: #111827;\n  --scroll-thumb: #4b5563;\n  --shadow-color: rgba(0,0,0,0.6);\n  --icon-filter: brightness(0) invert(1);\n  --accent-color: #60a5fa;\n  --accent-hover: #3b82f6;   \n  --active-btn-bg: #1e3a8a;\n  --active-btn-text: #60a5fa;\n  --danger-color: #f87171;\n}\n\n/* --- \u0413\u041b\u041e\u0411\u0410\u041b\u042c\u041d\u042b\u0415 \u0421\u0422\u0418\u041b\u0418 --- */\n.modal-overlay {\n  position: fixed; top: 0; left: 0; right: 0; bottom: 0;\n  background-color: rgba(0, 0, 0, 0.75);\n  display: flex; align-items: center; justify-content: center;\n  z-index: 1000; padding: 1rem;\n}\n\n\n\n/* --- \u041c\u041e\u0414\u0410\u041b\u042c\u041d\u041e\u0415 \u041e\u041a\u041d\u041e --- */\n.modal-content {\n  background: var(--bg-modal);\n  color: var(--text-main);\n  padding: 20px; \n  border-radius: 16px;\n  width: 100%; max-width: 1100px; max-height: 90vh;\n  box-shadow: 0 10px 25px rgba(0,0,0,0.5);\n  display: flex; flex-direction: column; gap: 15px;\n  border: 1px solid var(--border-color);\n}\n.modal-content.small { max-width: 400px; padding: 15px; }\n\n.modal-content h3 {\n  margin: 0 0 5px 0; font-size: 1.1rem;\n  color: var(--text-main); font-weight: 600;\n  text-transform: uppercase; letter-spacing: 0.5px;\n}\n\n.modal-actions {\n  display: flex; justify-content: space-between; align-items: center;\n  margin-top: auto; width: 100%; padding-top: 10px;\n}\n.modal-buttons-group { display: flex; gap: 12px; }\n\n.modal-button {\n  padding: 10px 24px; border: none; border-radius: 8px;\n  cursor: pointer; font-weight: 600; font-size: 0.95rem;\n  transition: filter 0.2s;\n}\n.modal-button.primary { background-color: var(--accent-color); color: white; }\n.modal-button.primary:hover { filter: brightness(1.1); }\n\n.modal-button.secondary { background-color: var(--bg-hover); color: var(--text-main); border: 1px solid var(--border-color); }\n.modal-button.secondary:hover { background-color: var(--bg-toolbar-btn-hover); }\n\n.modal-button.danger { background-color: var(--danger-color); color: white; }\n\n/* \u0410\u0414\u0410\u041f\u0422\u0418\u0412 \u041c\u041e\u0414\u0410\u041b\u041a\u0418 */\n@media (max-width: 360px) { .modal-content { padding: 10px; } }\n@media (max-width: 768px) { .modal-content { padding: 10px; gap: 8px; } }\n\n\n/* =========================================\n   \u0422\u0423\u041b\u0411\u0410\u0420 (\u0410\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u0430\u044f \u0441\u0435\u0442\u043a\u0430)\n   ========================================= */\n\n.toolbar-container {\n  display: flex; \n  flex-direction: column; /* Mobile First: \u043a\u043d\u043e\u043f\u043a\u0438 \u0432 2 \u0441\u0442\u0440\u043e\u043a\u0438 */\n  gap: 8px; \n  padding-bottom: 10px;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.toolbar-group {\n  display: flex; \n  flex-wrap: wrap; /* \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043d\u0430 \u043e\u0447\u0435\u043d\u044c \u0443\u0437\u043a\u0438\u0445 \u044d\u043a\u0440\u0430\u043d\u0430\u0445 */\n  gap: 4px; \n  align-items: center;\n}\n\n.toolbar-separator { width: 1px; height: 24px; background-color: var(--border-color); margin: 0 4px; flex-shrink: 0; }\n.group-separator { display: none; width: 1px; height: 28px; background-color: var(--border-color); margin: 0 8px; }\n\n/* \u041f\u043b\u0430\u043d\u0448\u0435\u0442\u044b \u0438 \u0414\u0435\u0441\u043a\u0442\u043e\u043f\u044b (>= 768px): \u0432\u044b\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c \u0432\u0441\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u043a\u0443 */\n@media (min-width: 768px) {\n    .toolbar-container {\n        flex-direction: row; align-items: center; justify-content: space-between; flex-wrap: wrap;\n    }\n    .toolbar-group { flex-wrap: nowrap; }\n    .group-separator { display: block; }\n    \n    .toolbar-button img {\n        width: 125% !important; height: 125% !important;\n    }\n}\n\n\n/* =========================================\n   \u041a\u041d\u041e\u041f\u041a\u0418 \u0422\u0423\u041b\u0411\u0410\u0420\u0410 (\u0410\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u044b\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u044b)\n   ========================================= */\n\n.toolbar-button {\n  /* \u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u0430\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 */\n  width: clamp(32px, 3.5vw, 40px);\n  height: clamp(32px, 3.5vw, 40px);\n  \n  background-color: var(--bg-toolbar-btn);\n  color: var(--text-main);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  \n  display: flex; align-items: center; justify-content: center;\n  cursor: pointer; transition: all 0.2s ease;\n  user-select: none; position: relative;\n}\n\n.toolbar-button img {\n    width: 85%; height: 85%; object-fit: contain; opacity: 0.9;\n    filter: var(--icon-filter);\n    transition: transform 0.2s;\n}\n\n.toolbar-button:hover { \n    background-color: var(--bg-hover); \n    border-color: var(--border-light);\n    transform: translateY(-1px);\n}\n.toolbar-button:hover img { opacity: 1; }\n\n.toolbar-button:active { transform: translateY(1px); }\n\n/* \u0410\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u043a\u043d\u043e\u043f\u043a\u0430 */\n.toolbar-button.active {\n  background-color: var(--active-btn-bg) !important;\n  border-color: var(--accent-color) !important;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.toolbar-button.active img {\n    filter: none !important; /* \u0423\u0431\u0438\u0440\u0430\u0435\u043c \u0438\u043d\u0432\u0435\u0440\u0441\u0438\u044e \u0442\u0435\u043c\u044b */\n    opacity: 1;\n}\n/* \u0425\u0430\u043a \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043a\u0440\u0430\u0441\u043a\u0438 SVG \u0432 \u0441\u0438\u043d\u0438\u0439 \u0432 \u0442\u0435\u043c\u043d\u043e\u0439 \u0442\u0435\u043c\u0435 */\nbody.dark-mode .toolbar-button.active img {\n    filter: invert(56%) sepia(63%) saturate(399%) hue-rotate(185deg) brightness(98%) contrast(92%) !important;\n}\n\n.toolbar-button:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }\n\n/* -- \u0420\u0410\u0417\u041c\u0415\u0420\u042b \u041a\u041d\u041e\u041f\u041e\u041a (\u0422\u041e\u041d\u041a\u0410\u042f \u041d\u0410\u0421\u0422\u0420\u041e\u0419\u041a\u0410) -- */\n\n/* 1) \u0412\u0415\u0420\u0425\u041d\u042f\u042f \u0413\u0420\u0423\u041f\u041f\u0410 (Formatting) - \u0414\u0435\u043b\u0430\u0435\u043c \u0438\u0445 \u041a\u0420\u0423\u041f\u041d\u0415\u0415 */\n.toolbar-container .toolbar-group:first-of-type .toolbar-button {\n    width: clamp(41px, 5vw, 46px); height: clamp(41px, 5vw, 46px);\n}\n\n/* 2) \u041d\u0418\u0416\u041d\u042f\u042f \u0413\u0420\u0423\u041f\u041f\u0410 (Actions) - \u0414\u0435\u043b\u0430\u0435\u043c \u0438\u0445 \u041c\u0415\u041d\u042c\u0428\u0415 */\n.toolbar-container .toolbar-group:last-of-type .toolbar-button {\n    width: clamp(35px, 3.5vw, 46px); height: clamp(35px, 3.5vw, 46px);\n}\n\n/* -- \u041c\u041e\u0411\u0418\u041b\u042c\u041d\u042b\u0415 \u0420\u0410\u0417\u041c\u0415\u0420\u042b \u041a\u041d\u041e\u041f\u041e\u041a -- */\n@media (max-width: 480px) {\n  .toolbar-button { width: 42px !important; height: 42px !important; }\n  \n  .toolbar-container .toolbar-group:first-of-type .toolbar-button {\n      width: 45px !important; height: 45px !important;\n  }\n  .toolbar-container .toolbar-group:last-of-type .toolbar-button {\n      width: 35px !important; height: 35px !important;\n  }\n  .toolbar-button img { width: 95% !important; height: 95% !important; }\n}\n\n@media (max-width: 360px) {\n  .toolbar-button { width: 34px; height: 34px; border-radius: 6px; }\n  \n  .toolbar-container .toolbar-group:first-of-type .toolbar-button {\n      width: 39px !important; height: 39px !important;\n  }\n  .toolbar-container .toolbar-group:last-of-type .toolbar-button {\n      width: 32px !important; height: 32px !important;\n  }  \n  .toolbar-separator { margin: 0 1px; }\n  .toolbar-button img { width: 110% !important; height: 110% !important; }\n}\n@media (min-width: 480px) and (max-width: 768px) {\n    .toolbar-button img { width: 100% !important; height: 100% !important; }\n}\n\n\n/* --- \u0420\u0415\u0414\u0410\u041a\u0422\u041e\u0420 (\u041a\u041e\u041d\u0422\u0415\u0419\u041d\u0415\u0420) --- */\n.editor-container {\n  background-color: var(--bg-editor);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 0; /* \u0423\u0431\u0438\u0440\u0430\u0435\u043c \u043f\u0430\u0434\u0434\u0438\u043d\u0433, \u043e\u043d \u0432\u043d\u0443\u0442\u0440\u0438 ProseMirror */\n  \n  flex-grow: 1; min-height: 200px; overflow-y: auto;\n  cursor: text; display: flex; flex-direction: column;\n  box-shadow: inset 0 2px 6px var(--shadow-color);\n}\n.editor-container > div {\n    flex-grow: 1; display: flex; flex-direction: column; min-height: 100%;\n}\n.editor-container::-webkit-scrollbar { width: 6px; }\n.editor-container::-webkit-scrollbar-track { background: var(--scroll-track); }\n.editor-container::-webkit-scrollbar-thumb { background: var(--scroll-thumb); border-radius: 4px; }\n.editor-container.limit-error { border-color: var(--danger-color) !important; box-shadow: 0 0 0 1px var(--danger-color) inset; }\n\n.char-counter {\n  margin: 0; font-family: 'Courier New', monospace;\n  font-size: 0.95rem; font-weight: 600; color: var(--text-muted);\n}\n.char-counter.warning { color: var(--danger-color); }\n\n/* \u0410\u0434\u0430\u043f\u0442\u0438\u0432 \u0432\u044b\u0441\u043e\u0442\u044b \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 */\n@media (max-width: 768px) {\n    .editor-container { max-height: 25vh; min-height: 120px; }\n}\n\n/* --- TIPTAP CONTENT --- */\n.ProseMirror {\n    outline: none; \n    color: var(--text-main);\n    font-size: 1rem; \n    line-height: 1.6; \n    padding: 15px; /* \u041f\u0430\u0434\u0434\u0438\u043d\u0433 \u0437\u0434\u0435\u0441\u044c */\n    flex-grow: 1; \n    min-height: 100%; \n    box-sizing: border-box;\n}\n.ProseMirror p { margin: 0.5em 0; }\n.ProseMirror a { color: var(--accent-color); text-decoration: underline; cursor: pointer; }\n.ProseMirror blockquote {\n    border-left: 4px solid var(--accent-color);\n    padding-left: 15px; margin: 10px 0;\n    color: var(--text-muted); font-style: italic;\n    background: var(--bg-hover); padding: 10px; border-radius: 4px;\n}\n.ProseMirror pre {\n    background-color: #0f172a; /* \u0422\u0435\u043c\u043d\u044b\u0439 \u0444\u043e\u043d \u0434\u043b\u044f \u043a\u043e\u0434\u0430 \u0432\u0441\u0435\u0433\u0434\u0430 */\n    color: #f8f8f2;\n    padding: 10px; border-radius: 6px;\n    font-family: 'Courier New', Courier, monospace; \n    white-space: pre-wrap; margin: 10px 0;\n    border: 1px solid var(--border-color);\n}\n.ProseMirror code {\n    background-color: var(--bg-hover);\n    color: #f15bb5; /* \u0420\u043e\u0437\u043e\u0432\u044b\u0439 \u0434\u043b\u044f \u0438\u043d\u043b\u0430\u0439\u043d \u043a\u043e\u0434\u0430 */\n    padding: 2px 6px; border-radius: 4px;\n    font-family: 'Courier New', monospace; font-size: 0.9em;\n}\n.tg-spoiler {\n    background-color: #454545; color: transparent;\n    text-shadow: 0 0 8px rgba(255,255,255,0.5);\n    border-radius: 4px; padding: 0 4px; cursor: help;\n    transition: all 0.2s;\n}\n.ProseMirror .tg-spoiler:hover, .ProseMirror:focus .tg-spoiler { \n    color: var(--text-main); text-shadow: none; background-color: var(--bg-hover); \n}\n\n/* --- \u0412\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b --- */\n.custom-tooltip {\n  position: fixed; background-color: #222; color: #fff;\n  padding: 5px 10px; border-radius: 4px; font-size: 0.75rem;\n  pointer-events: none; z-index: 9999; border: 1px solid #444;\n  white-space: nowrap; transform: translate(-50%, -100%); margin-top: -8px;\n  box-shadow: 0 4px 10px rgba(0,0,0,0.4);\n}\n.prompt-input {\n    width: 100%; padding: 10px; border-radius: 6px;\n    border: 1px solid var(--border-color);\n    background-color: var(--bg-input); color: var(--text-main);\n    outline: none;\n}\n.prompt-input:focus { border-color: var(--accent-color); }\n.form-row { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; }\n.form-row input, .form-row select { flex: 1; }\n.context-menu {\n  position: fixed; /* \u0412\u0430\u0436\u043d\u043e \u0434\u043b\u044f useSmartPosition */\n  z-index: 9999;\n  \n  /* 1. \u041e\u0431\u0449\u0438\u0439 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a (\u0444\u043e\u043d \u043c\u0435\u043d\u044e) */\n  background-color: var(--bg-modal);\n  border: 1px solid var(--border-color);\n  border-radius: 16px; /* \u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u0449\u0435\u0433\u043e \u043c\u0435\u043d\u044e */\n  box-shadow: 0 10px 30px var(--shadow-color);\n  \n  /* \u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043e\u0442\u0441\u0442\u0443\u043f\u044b \u0438 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0430 */\n  padding: 12px;\n  width: 240px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* \u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438 */\n  \n  /* \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f */\n  animation: fadeInMenu 0.15s ease-out;\n}\n\n@keyframes fadeInMenu {\n  from { opacity: 0; transform: scale(0.95); }\n  to { opacity: 1; transform: scale(1); }\n}\n\n/* \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0432\u043d\u0443\u0442\u0440\u0438 \u043c\u0435\u043d\u044e (\u0433\u0434\u0435 ID \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430) */\n.context-menu p {\n  margin: 0 0 4px 4px;\n  font-size: 0.8rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  color: var(--text-muted);\n  user-select: none;\n}\n\n.context-menu p strong {\n  color: var(--text-main);\n}\n\n/* 2. \u041c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0435 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u0438 */\n.context-menu button {\n  /* \u041e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u043d \u0434\u043b\u044f \u043a\u043d\u043e\u043f\u043a\u0438 */\n  background-color: var(--bg-hover); \n  border: 1px solid transparent; /* \u0413\u0440\u0430\u043d\u0438\u0446\u0430 \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u0430\u044f, \u043f\u0440\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043f\u0440\u0438 \u0445\u043e\u0432\u0435\u0440\u0435 */\n  \n  /* \u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u043a\u0440\u0430\u0435\u0432 \u043a\u043d\u043e\u043f\u043e\u043a */\n  border-radius: 8px; \n  \n  /* \u0422\u0435\u043a\u0441\u0442 \u0438 \u043e\u0442\u0441\u0442\u0443\u043f\u044b */\n  padding: 10px 12px;\n  color: var(--text-main);\n  font-size: 0.95rem;\n  font-weight: 500;\n  text-align: left;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  \n  /* \u0412\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0438\u043a\u043e\u043d\u043e\u043a (\u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c \u044d\u043c\u043e\u0434\u0437\u0438 \u0432 \u0442\u0435\u043a\u0441\u0442\u0435) */\n  display: flex;\n  align-items: center;\n  gap: 8px; \n}\n\n/* \u042d\u0444\u0444\u0435\u043a\u0442 \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443 */\n.context-menu button:hover {\n  background-color: var(--active-btn-bg); /* \u0421\u0438\u043d\u0435\u0432\u0430\u0442\u044b\u0439 \u0444\u043e\u043d (\u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439) */\n  color: var(--active-btn-text);          /* \u0426\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0442\u0435\u043c\u044b */\n  border-color: var(--accent-color);      /* \u0426\u0432\u0435\u0442\u043d\u0430\u044f \u0440\u0430\u043c\u043a\u0430 */\n  transform: translateY(-1px);            /* \u041b\u0435\u0433\u043a\u0438\u0439 \u043f\u043e\u0434\u044a\u0435\u043c */\n  box-shadow: 0 4px 12px rgba(0,0,0,0.05);\n}\n\n.context-menu button:active {\n  transform: translateY(0);\n}\n\n/* 3. \u0421\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0439 \u0441\u0442\u0438\u043b\u044c \u0434\u043b\u044f \u043a\u043d\u043e\u043f\u043a\u0438 \"\u0423\u0434\u0430\u043b\u0438\u0442\u044c\" */\n.context-menu button.delete {\n  margin-top: 4px; /* \u0427\u0443\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u0442 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 */\n  background-color: rgba(239, 68, 68, 0.08); /* \u041e\u0447\u0435\u043d\u044c \u0431\u043b\u0435\u0434\u043d\u044b\u0439 \u043a\u0440\u0430\u0441\u043d\u044b\u0439 */\n  color: var(--danger-color);\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.context-menu button.delete:hover {\n  background-color: var(--danger-color); /* \u042f\u0440\u043a\u043e-\u043a\u0440\u0430\u0441\u043d\u044b\u0439 \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 */\n  color: white;\n  border-color: var(--danger-color);\n  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n}\n\n.cm-tag {\n  display: inline-block;\n  border-radius: 4px;\n  padding: 0 4px;\n  font-family: 'Courier New', monospace;\n  font-weight: bold;\n  font-size: 0.9em;\n  border: 1px solid transparent;\n}\n\n/* 1. \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c (\u0422\u0430\u0439\u043c\u0435\u0440 + / \u041a\u043b\u0438\u043a +) - \u0417\u0435\u043b\u0435\u043d\u044b\u0439 */\n.cm-tag-add {\n  color: #15803d; /* green-700 */\n  background-color: #dcfce7; /* green-100 */\n  border-color: #86efac;\n}\nbody.dark-mode .cm-tag-add {\n  color: #4ade80; background-color: rgba(21, 128, 61, 0.2); border-color: rgba(74, 222, 128, 0.3);\n}\n\n/* 2. \u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c (\u0422\u0430\u0439\u043c\u0435\u0440 - / \u041a\u043b\u0438\u043a -) - \u041a\u0440\u0430\u0441\u043d\u044b\u0439 */\n.cm-tag-clear {\n  color: #b91c1c; /* red-700 */\n  background-color: #fee2e2; /* red-100 */\n  border-color: #fca5a5;\n}\nbody.dark-mode .cm-tag-clear {\n  color: #f87171; background-color: rgba(185, 28, 28, 0.2); border-color: rgba(248, 113, 113, 0.3);\n}\n\n/* 3. \u0421\u043e\u0431\u044b\u0442\u0438\u0435 (Event) - \u0424\u0438\u043e\u043b\u0435\u0442\u043e\u0432\u044b\u0439/\u0417\u043e\u043b\u043e\u0442\u043e\u0439 */\n.cm-tag-event {\n  color: #7e22ce; /* purple-700 */\n  background-color: #f3e8ff; /* purple-100 */\n  border-color: #d8b4fe;\n}\nbody.dark-mode .cm-tag-event {\n  color: #c084fc; background-color: rgba(126, 34, 206, 0.2); border-color: rgba(192, 132, 252, 0.3);\n}\n\n\n",Fk=Jv.create({name:"spoiler",addAttributes:()=>({class:{default:"tg-spoiler",renderHTML:()=>({class:"tg-spoiler"})}}),parseHTML:()=>[{tag:"span",getAttrs:e=>e.classList.contains("tg-spoiler")&&null}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",Jm(this.options.HTMLAttributes,t),0]}}),Pk=t=>{let{onClick:n,isActive:r,icon:o,label:i,onShowTooltip:a,onHideTooltip:s,disabled:l,style:d}=t;const u=(0,e.useRef)(null),p=(0,e.useRef)(!1);return(0,c.jsx)("button",{onMouseDown:e=>e.preventDefault(),onClick:e=>{p.current||l||n(e)},onTouchStart:e=>{p.current=!1,u.current=setTimeout(()=>{p.current=!0;const t=e.target.closest("button").getBoundingClientRect();a(i,t.left+t.width/2,t.top)},500)},onTouchEnd:e=>{clearTimeout(u.current),p.current&&(e.preventDefault(),setTimeout(()=>s(),1500))},onMouseEnter:e=>{const t=e.target.closest("button").getBoundingClientRect();a(i,t.left+t.width/2,t.top)},onMouseLeave:s,onContextMenu:e=>e.preventDefault(),disabled:l,className:"toolbar-button ".concat(r?"active":""),style:d,children:(0,c.jsx)("img",{src:o,alt:i,style:{pointerEvents:"none"}})})};function Bk(t){let{userId:n,onCancel:r,onSubmit:o}=t;const[i,a]=(0,e.useState)("manual"),[s,l]=(0,e.useState)([]),[d,u]=(0,e.useState)(!1),[p,h]=(0,e.useState)(""),[f,g]=(0,e.useState)("");(0,e.useEffect)(()=>{"next"===i&&0===s.length&&(u(!0),Vl(n).then(e=>{l(e),e.length>0&&h(e[0].id)}).catch(e=>console.error(e)).finally(()=>u(!1)))},[i,n,s.length]);return(0,c.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,c.jsxs)("div",{className:"modal-content small",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430/\u0441\u0435\u0439\u0432\u0430"}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{style:{minWidth:"100px"},children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435:"}),(0,c.jsxs)("select",{className:"prompt-input",value:i,onChange:e=>a(e.target.value),children:[(0,c.jsx)("option",{value:"manual",children:"\u0420\u0443\u0447\u043d\u043e\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 (\u041a\u043d\u043e\u043f\u043a\u0430)"}),(0,c.jsx)("option",{value:"auto",children:"\u0410\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 (\u0427\u0435\u043a\u043f\u043e\u0438\u043d\u0442)"}),(0,c.jsx)("option",{value:"next",children:"\u041f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0434\u0440\u0443\u0433\u043e\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0438"})]})]}),"next"===i&&(0,c.jsx)("div",{style:{marginTop:"15px",borderTop:"1px solid #444",paddingTop:"15px"},children:d?(0,c.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0426\u0435\u043b\u0435\u0432\u0430\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u044f:"}),(0,c.jsx)("select",{className:"prompt-input",value:p,onChange:e=>h(e.target.value),children:s.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.title," (ID: ",e.id,")"]},e.id))})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438:"}),(0,c.jsx)("input",{type:"text",className:"prompt-input",placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0414\u0430\u043b\u0435\u0435",value:f,onChange:e=>g(e.target.value)})]})]})}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{let e="";if("manual"===i)e="##-save-##";else if("auto"===i)e="##-checkpoint-##";else if("next"===i){if(!p)return void alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e");const t=f.trim()?"(".concat(f.trim(),")"):"";e="##-nextchapter_".concat(p).concat(t,"-##")}o(e)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})})}function Lk(t){let{title:n,children:r,onConfirm:o,onCancel:i,confirmText:a="\u041e\u041a",cancelText:s="\u041e\u0442\u043c\u0435\u043d\u0430",type:l="confirm"}=t;return(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,c.jsx)("div",{className:"modal-overlay",onClick:i,children:(0,c.jsxs)("div",{className:"modal-content small",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:n}),(0,c.jsx)("div",{children:r}),(0,c.jsxs)("div",{className:"modal-actions",children:[i&&(0,c.jsx)("button",{className:"modal-button secondary",onClick:i,children:s}),(0,c.jsx)("button",{className:"modal-button ".concat("danger"===l?"danger":"primary"),onClick:o,children:a})]})]})})}const Nk=oy.create({name:"controlTagHighlight",addProseMirrorPlugins(){const e=e=>{const t=[];return e.descendants((e,n)=>{if(!e.isText)return;const r=e.text;[{regex:/\[\[(\+\d+|click\+)\]\]/g,class:"cm-tag cm-tag-add"},{regex:/\[\[(\-\d+|click\-)\]\]/g,class:"cm-tag cm-tag-clear"},{regex:/\[\[Event:[a-zA-Z\u0430-\u044f\u0410-\u042f0-9_]+\]\]/g,class:"cm-tag cm-tag-event"}].forEach(e=>{let o,{regex:i,class:a}=e;for(;null!==(o=i.exec(r));)t.push(Nf.inline(n+o.index,n+o.index+o[0].length,{class:a}))})}),Wf.create(e,t)};return[new ku({state:{init:(t,n)=>{let{doc:r}=n;return e(r)},apply:(t,n)=>t.docChanged?e(t.doc):n},props:{decorations(e){return this.getState(e)}}})]}});function Uk(t){let{initialHtml:n,onSave:r,onCancel:o,userId:i,storyId:a}=t;(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const[l,d]=(0,e.useState)(!1),[u,p]=(0,e.useState)(!1),[h,f]=(0,e.useState)(!1),[g,m]=(0,e.useState)({current:0,limit:4e3,over:!1}),[v,y]=(0,e.useState)({visible:!1,text:"",x:0,y:0}),x=(e,t,n)=>y({visible:!0,text:e,x:t,y:n}),b=()=>y(e=>s(s({},e),{},{visible:!1})),w=e.useMemo(()=>oy.create({name:"customHotkeys",addKeyboardShortcuts:()=>({"Mod-Alt-t":()=>(d(!0),!0),"Mod-Alt-a":()=>(p(!0),!0),"Mod-s":()=>!0})}),[]),S=wx({extensions:[ck.configure({codeBlock:{HTMLAttributes:{class:"code-block"}}}),ES,qw.configure({openOnClick:!1,HTMLAttributes:{target:"_blank"}}),Fk,Ak,w,Nk],content:"(\u043f\u0443\u0441\u0442\u043e)"===n?"":n.replace(/\n/g,"<br>"),autofocus:!0});(0,e.useEffect)(()=>{if(!S)return;const e=()=>{const e=S.state.doc.textBetween(0,S.state.doc.content.size,"\n").replace(/\[\[-\d+\]\]/g,"");m({current:e.length,limit:4e3,over:e.length>4e3})};return S.on("update",e),e(),()=>{S.off("update",e)}},[S]);const k=e=>{if(!S)return;const t=S.isActive(e),{selection:n}=S.state;if(t&&n.empty&&0===n.$from.parent.content.size)return void S.chain().focus().lift(e).run();if(n.empty)return"blockquote"===e&&S.chain().focus().toggleBlockquote().run(),void("codeBlock"===e&&S.chain().focus().toggleCodeBlock().run());const r=S.state.doc.textBetween(n.from,n.to,"\n");S.chain().focus().deleteSelection().run();const o="blockquote"===e?"<blockquote><p>".concat(r,"</p></blockquote>"):"<pre><code>".concat(r,"</code></pre>");S.chain().focus().insertContent(o).run()},C=(0,e.useCallback)(()=>{if(!S)return;const e=S.getAttributes("link").href,t=window.prompt("URL \u0441\u0441\u044b\u043b\u043a\u0438:",e);if(null!==t)if(""!==t)if(S.state.selection.empty){const e=window.prompt("\u0422\u0435\u043a\u0441\u0442 \u0441\u0441\u044b\u043b\u043a\u0438:",t)||t;S.chain().focus().insertContent({type:"text",text:e,marks:[{type:"link",attrs:{href:t}}]}).insertContent(" ").unsetMark("link").run()}else S.chain().focus().extendMarkRange("link").setLink({href:t}).run();else S.chain().focus().unsetLink().run()},[S]),j=S&&!S.state.selection.empty;return S?(0,c.jsxs)("div",{className:"modal-overlay",onPointerDown:e=>{e.target===e.currentTarget&&window.confirm("\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0431\u0435\u0437 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f?")&&o()},children:[v.visible&&(0,c.jsx)("div",{className:"custom-tooltip",style:{left:v.x,top:v.y},children:v.text}),(0,c.jsxs)("div",{className:"modal-content nodrag",onContextMenu:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsxs)("div",{className:"toolbar-container",children:[(0,c.jsxs)("div",{className:"toolbar-group",children:[(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleBold().run(),isActive:S.isActive("bold"),icon:dk,label:"\u0416\u0438\u0440\u043d\u044b\u0439",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleItalic().run(),isActive:S.isActive("italic"),icon:uk,label:"\u041a\u0443\u0440\u0441\u0438\u0432",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleUnderline().run(),isActive:S.isActive("underline"),icon:pk,label:"\u041f\u043e\u0434\u0447\u0435\u0440\u043a\u043d\u0443\u0442\u044b\u0439",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleStrike().run(),isActive:S.isActive("strike"),icon:hk,label:"\u0417\u0430\u0447\u0435\u0440\u043a\u043d\u0443\u0442\u044b\u0439",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleCode().run(),isActive:S.isActive("code"),icon:fk,label:"\u041c\u043e\u043d\u043e\u0448\u0438\u0440\u0438\u043d\u043d\u044b\u0439",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(Pk,{onClick:()=>d(!0),icon:xk,label:"\u041a\u043b\u044e\u0447",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>p(!0),icon:bk,label:"\u0410\u0442\u0440\u0438\u0431\u0443\u0442",onShowTooltip:x,onHideTooltip:b})]}),(0,c.jsx)("div",{className:"group-separator"}),(0,c.jsxs)("div",{className:"toolbar-group",children:[(0,c.jsx)(Pk,{onClick:()=>f(!0),icon:_k,label:"\u0421\u0435\u0439\u0432/\u0433\u043b\u0430\u0432\u044b",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().undo().run(),disabled:!S.can().undo(),icon:Ck,label:"\u041d\u0430\u0437\u0430\u0434",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().redo().run(),disabled:!S.can().redo(),icon:jk,label:"\u0412\u043f\u0435\u0440\u0451\u0434",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(Pk,{onClick:()=>S.chain().focus().toggleMark("spoiler").run(),isActive:S.isActive("spoiler"),icon:mk,label:"\u0421\u043f\u043e\u0439\u043b\u0435\u0440",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>k("blockquote"),isActive:S.isActive("blockquote"),icon:vk,label:"\u0426\u0438\u0442\u0430\u0442\u0430",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>k("codeBlock"),isActive:S.isActive("codeBlock"),icon:gk,label:"\u041a\u043e\u0434",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:C,isActive:S.isActive("link"),icon:yk,label:"\u0421\u0441\u044b\u043b\u043a\u0430",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(Pk,{onClick:()=>navigator.clipboard.writeText(S.getText()),icon:wk,label:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c",onShowTooltip:x,onHideTooltip:b}),(0,c.jsx)(Pk,{onClick:()=>{j?window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435?")&&S.chain().focus().deleteSelection().run():S.chain().focus().selectAll().run()},icon:j?kk:Sk,label:j?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c":"\u0412\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u0432\u0441\u0451",onShowTooltip:x,onHideTooltip:b,style:j?{color:"var(--danger-color)",borderColor:"var(--danger-color)"}:{}})]})]}),(0,c.jsx)("div",{className:"editor-container ".concat(g.over?"limit-error":""),children:(0,c.jsx)(gx,{editor:S,style:{height:"100%",display:"flex",flexDirection:"column"}})}),h&&(0,c.jsx)(Bk,{userId:i,onCancel:()=>f(!1),onSubmit:e=>{S.chain().focus("end").insertContent("\n<p>".concat(e,"</p>")).run(),f(!1)}}),l&&(0,c.jsx)(Rk,{existingText:S?S.getText():"",onCancel:()=>d(!1),onSubmit:e=>{S.chain().focus().insertContent(" ".concat(e," ")).run(),d(!1)}}),u&&(0,c.jsx)(Ok,{userId:i,storyId:a,onCancel:()=>p(!1),onSubmit:e=>{let{name:t,resultValue:n,isDisplay:r}=e;if(r)S.chain().focus().insertContent(" {{{".concat(t,"}}} ")).run();else{const e="{{".concat(t,": ").concat(n,"}}{{").concat(t,"}}");if(S.state.selection.empty)S.chain().focus().insertContent(e).setTextSelection(S.state.selection.from-"{{".concat(t,"}}").length).run();else{const{from:e,to:r}=S.state.selection,o=S.state.doc.textBetween(e,r," ");S.chain().focus().insertContent("{{".concat(t,": ").concat(n,"}}").concat(o,"{{").concat(t,"}}")).run()}}p(!1)}}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsxs)("div",{className:"char-counter ".concat(g.over?"warning":""),children:[g.current,"/",g.limit]}),(0,c.jsxs)("div",{className:"modal-buttons-group",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:o,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{if(!S)return;let e=S.getHTML();if(!e||"<p></p>"===e)return r("(\u043f\u0443\u0441\u0442\u043e)");e=e.replace(/<\/p>/g,"\n").replace(/<p>/g,"").replace(/<br\s*\/?>/gi,"\n").replace(/&nbsp;/g," ").replace(/\u200B/g,"").replace(/<(?!\/?(b|strong|i|em|u|s|strike|del|code|pre|blockquote|a|span)(\s|>))[^>]+>/gi,"").replace(/\n+(?=<\/(blockquote|pre)>)/g,"").replace(/(<\/(blockquote|pre)>)\n+/g,"$1"),r(e.trim()||"(\u043f\u0443\u0441\u0442\u043e)")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})]})]}):null}const Vk=window.location.pathname,[Wk,Hk]=Vk.slice(1).split("_");const Gk=function(t){let{node:n,setNodes:r,onClose:o,top:i,left:a,autoOpenEditor:l=!1}=t;const[d,u]=(0,e.useState)(null),{ref:p,style:h}=ec({x:a,y:i});(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,e.useEffect)(()=>{l&&u("edit")},[l]);const f=(0,e.useCallback)(async e=>{try{await async function(e,t,n,r){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks/").concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})});if(!o.ok){const{error:e}=await o.json();throw new Error(e||"Server error on update")}return await o.json()}(Wk,Hk,n.id,e),r(t=>t.map(t=>t.id===n.id?s(s({},t),{},{data:s(s({},t.data),{},{text:e})}):t))}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(t.message))}finally{u(null),o()}},[n.id,r,o,Wk,Hk]),g=(0,e.useCallback)(async()=>{try{await async function(e,t,n){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks/").concat(n),{method:"DELETE"});if(!r.ok){const{error:e}=await r.json();throw new Error(e||"Server error on delete")}return await r.json()}(Wk,Hk,n.id),r(e=>e.filter(e=>e.id!==n.id))}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(e.message))}finally{u(null),o()}},[n.id,r,o,Wk,Hk]);return(0,c.jsxs)(c.Fragment,{children:[!d&&(0,c.jsxs)("div",{ref:p,className:"context-menu",style:h,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("p",{children:["\u0417\u0430\u043c\u0435\u0442\u043a\u0430: ",(0,c.jsx)("strong",{children:n.id})]}),(0,c.jsx)("button",{onClick:()=>u("edit"),children:"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,c.jsx)("button",{className:"delete",onClick:()=>u("delete"),children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),(0,c.jsx)("button",{onClick:o,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}),"edit"===d&&(0,c.jsx)(Uk,{initialHtml:n.data.text||"",onSave:f,onCancel:()=>{u(null),o()},userId:Wk,storyId:Hk}),"delete"===d&&(0,c.jsx)(Lk,{title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435",type:"danger",onConfirm:g,onCancel:()=>{u(null),o()},confirmText:"\u0414\u0430, \u0443\u0434\u0430\u043b\u0438\u0442\u044c",children:(0,c.jsx)("p",{children:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443?"})})]})};const Xk="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function Yk(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function qk(e){return"nodeType"in e}function Zk(e){var t,n;return e?Yk(e)?e:qk(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function $k(e){const{Document:t}=Zk(e);return e instanceof t}function Kk(e){return!Yk(e)&&e instanceof Zk(e).HTMLElement}function Jk(e){return e instanceof Zk(e).SVGElement}function Qk(e){return e?Yk(e)?e.document:qk(e)?$k(e)?e:Kk(e)||Jk(e)?e.ownerDocument:document:document:document}const eC=Xk?e.useLayoutEffect:e.useEffect;function tC(t){const n=(0,e.useRef)(t);return eC(()=>{n.current=t}),(0,e.useCallback)(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==n.current?void 0:n.current(...t)},[])}function nC(t,n){void 0===n&&(n=[t]);const r=(0,e.useRef)(t);return eC(()=>{r.current!==t&&(r.current=t)},n),r}function rC(t,n){const r=(0,e.useRef)();return(0,e.useMemo)(()=>{const e=t(r.current);return r.current=e,e},[...n])}function oC(t){const n=tC(t),r=(0,e.useRef)(null),o=(0,e.useCallback)(e=>{e!==r.current&&(null==n||n(e,r.current)),r.current=e},[]);return[r,o]}function iC(t){const n=(0,e.useRef)();return(0,e.useEffect)(()=>{n.current=t},[t]),n.current}let aC={};function sC(t,n){return(0,e.useMemo)(()=>{if(n)return n;const e=null==aC[t]?0:aC[t]+1;return aC[t]=e,t+"-"+e},[t,n])}function lC(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[o,i]of r){const n=t[o];null!=n&&(t[o]=n+e*i)}return t},s({},t))}}const cC=lC(1),dC=lC(-1);function uC(e){if(!e)return!1;const{KeyboardEvent:t}=Zk(e.target);return t&&e instanceof t}function pC(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=Zk(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const hC=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[hC.Translate.toString(e),hC.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),fC="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function gC(e){return e.matches(fC)?e:e.querySelector(fC)}const mC={display:"none"};function vC(t){let{id:n,value:r}=t;return e.createElement("div",{id:n,style:mC},r)}function yC(t){let{id:n,announcement:r,ariaLiveType:o="assertive"}=t;return e.createElement("div",{id:n,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":o,"aria-atomic":!0},r)}const xC=["transform"],bC=["id","accessibility","autoScroll","children","sensors","collisionDetection","measuring","modifiers"],wC=["active","dragOverlay","transform"],SC=(0,e.createContext)(null);const kC={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},CC={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function jC(t){let{announcements:n=CC,container:r,hiddenTextDescribedById:o,screenReaderInstructions:i=kC}=t;const{announce:a,announcement:s}=function(){const[t,n]=(0,e.useState)(""),r=(0,e.useCallback)(e=>{null!=e&&n(e)},[]);return{announce:r,announcement:t}}(),l=sC("DndLiveRegion"),[c,d]=(0,e.useState)(!1);if((0,e.useEffect)(()=>{d(!0)},[]),function(t){const n=(0,e.useContext)(SC);(0,e.useEffect)(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}((0,e.useMemo)(()=>({onDragStart(e){let{active:t}=e;a(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;n.onDragMove&&a(n.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;a(n.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;a(n.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;a(n.onDragCancel({active:t,over:r}))}}),[a,n])),!c)return null;const u=e.createElement(e.Fragment,null,e.createElement(vC,{id:o,value:i.draggable}),e.createElement(yC,{id:l,announcement:s}));return r?(0,Mi.createPortal)(u,r):u}var _C;function EC(){}function DC(t,n){return(0,e.useMemo)(()=>({sensor:t,options:null!=n?n:{}}),[t,n])}function MC(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(0,e.useMemo)(()=>[...n].filter(e=>null!=e),[...n])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(_C||(_C={}));const TC=Object.freeze({x:0,y:0});function IC(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function AC(e,t){const n=pC(e);if(!n)return"0 0";return(n.x-t.left)/t.width*100+"% "+(n.y-t.top)/t.height*100+"%"}function OC(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function RC(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function zC(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const FC=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=zC(t,t.left,t.top),i=[];for(const a of r){const{id:e}=a,t=n.get(e);if(t){const n=IC(zC(t),o);i.push({id:e,data:{droppableContainer:a,value:n}})}}return i.sort(OC)};function PC(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=o-r,s=i-n;if(r<o&&n<i){const n=t.width*t.height,r=e.width*e.height,o=a*s;return Number((o/(n+r-o)).toFixed(4))}return 0}const BC=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:e}=i,r=n.get(e);if(r){const n=PC(r,t);n>0&&o.push({id:e,data:{droppableContainer:i,value:n}})}}return o.sort(RC)};function LC(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:TC}function NC(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((t,n)=>s(s({},t),{},{top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),s({},t))}}const UC=NC(1);function VC(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const WC={ignoreTransform:!1};function HC(e,t){void 0===t&&(t=WC);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:r}=Zk(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=VC(t);if(!r)return e;const{scaleX:o,scaleY:i,x:a,y:s}=r,l=e.left-a-(1-o)*parseFloat(n),c=e.top-s-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,u=i?e.height/i:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}(n,t,r))}const{top:r,left:o,width:i,height:a,bottom:s,right:l}=n;return{top:r,left:o,width:i,height:a,bottom:s,right:l}}function GC(e){return HC(e,{ignoreTransform:!0})}function XC(e,t){const n=[];return e?function r(o){if(null!=t&&n.length>=t)return n;if(!o)return n;if($k(o)&&null!=o.scrollingElement&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Kk(o)||Jk(o))return n;if(n.includes(o))return n;const i=Zk(e).getComputedStyle(o);return o!==e&&function(e,t){void 0===t&&(t=Zk(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"===typeof r&&n.test(r)})}(o,i)&&n.push(o),function(e,t){return void 0===t&&(t=Zk(e).getComputedStyle(e)),"fixed"===t.position}(o,i)?n:r(o.parentNode)}(e):n}function YC(e){const[t]=XC(e,1);return null!=t?t:null}function qC(e){return Xk&&e?Yk(e)?e:qk(e)?$k(e)||e===Qk(e).scrollingElement?window:Kk(e)?e:null:null:null}function ZC(e){return Yk(e)?e.scrollX:e.scrollLeft}function $C(e){return Yk(e)?e.scrollY:e.scrollTop}function KC(e){return{x:ZC(e),y:$C(e)}}var JC;function QC(e){return!(!Xk||!e)&&e===document.scrollingElement}function ej(e){const t={x:0,y:0},n=QC(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(JC||(JC={}));const tj={x:.2,y:.2};function nj(e,t,n,r,o){let{top:i,left:a,right:s,bottom:l}=n;void 0===r&&(r=10),void 0===o&&(o=tj);const{isTop:c,isBottom:d,isLeft:u,isRight:p}=ej(e),h={x:0,y:0},f={x:0,y:0},g=t.height*o.y,m=t.width*o.x;return!c&&i<=t.top+g?(h.y=JC.Backward,f.y=r*Math.abs((t.top+g-i)/g)):!d&&l>=t.bottom-g&&(h.y=JC.Forward,f.y=r*Math.abs((t.bottom-g-l)/g)),!p&&s>=t.right-m?(h.x=JC.Forward,f.x=r*Math.abs((t.right-m-s)/m)):!u&&a<=t.left+m&&(h.x=JC.Backward,f.x=r*Math.abs((t.left+m-a)/m)),{direction:h,speed:f}}function rj(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function oj(e){return e.reduce((e,t)=>cC(e,KC(t)),TC)}function ij(e,t){if(void 0===t&&(t=HC),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);YC(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const aj=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ZC(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+$C(t),0)}]];class sj{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=XC(t),r=oj(n);this.rect=s({},e),this.width=e.width,this.height=e.height;for(const[o,i,a]of aj)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=a(n),i=r[o]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class lj{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function cj(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"===typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}var dj,uj;function pj(e){e.preventDefault()}function hj(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(dj||(dj={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(uj||(uj={}));const fj={start:[uj.Space,uj.Enter],cancel:[uj.Esc],end:[uj.Space,uj.Enter,uj.Tab]},gj=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case uj.Right:return s(s({},n),{},{x:n.x+25});case uj.Left:return s(s({},n),{},{x:n.x-25});case uj.Down:return s(s({},n),{},{y:n.y+25});case uj.Up:return s(s({},n),{},{y:n.y-25})}};class mj{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new lj(Qk(t)),this.windowListeners=new lj(Zk(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(dj.Resize,this.handleCancel),this.windowListeners.add(dj.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(dj.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&ij(n),t(TC)}handleKeyDown(e){if(uC(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:o=fj,coordinateGetter:i=gj,scrollBehavior:a="smooth"}=r,{code:s}=e;if(o.end.includes(s))return void this.handleEnd(e);if(o.cancel.includes(s))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:TC;this.referenceCoordinates||(this.referenceCoordinates=c);const d=i(e,{active:t,context:n.current,currentCoordinates:c});if(d){const t=dC(d,c),r={x:0,y:0},{scrollableAncestors:o}=n.current;for(const n of o){const o=e.code,{isTop:i,isRight:s,isLeft:l,isBottom:c,maxScroll:u,minScroll:p}=ej(n),h=rj(n),f={x:Math.min(o===uj.Right?h.right-h.width/2:h.right,Math.max(o===uj.Right?h.left:h.left+h.width/2,d.x)),y:Math.min(o===uj.Down?h.bottom-h.height/2:h.bottom,Math.max(o===uj.Down?h.top:h.top+h.height/2,d.y))},g=o===uj.Right&&!s||o===uj.Left&&!l,m=o===uj.Down&&!c||o===uj.Up&&!i;if(g&&f.x!==d.x){const e=n.scrollLeft+t.x,i=o===uj.Right&&e<=u.x||o===uj.Left&&e>=p.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:a});r.x=i?n.scrollLeft-e:o===uj.Right?n.scrollLeft-u.x:n.scrollLeft-p.x,r.x&&n.scrollBy({left:-r.x,behavior:a});break}if(m&&f.y!==d.y){const e=n.scrollTop+t.y,i=o===uj.Down&&e<=u.y||o===uj.Up&&e>=p.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:a});r.y=i?n.scrollTop-e:o===uj.Down?n.scrollTop-u.y:n.scrollTop-p.y,r.y&&n.scrollBy({top:-r.y,behavior:a});break}}this.handleMove(e,cC(dC(d,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function vj(e){return Boolean(e&&"distance"in e)}function yj(e){return Boolean(e&&"delay"in e)}mj.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=fj,onActivation:o}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const t=i.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==o||o({event:e.nativeEvent}),!0)}return!1}}];class xj{constructor(e,t,n){var r;void 0===n&&(n=function(e){const{EventTarget:t}=Zk(e);return e instanceof t?e:Qk(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:i}=o;this.props=e,this.events=t,this.document=Qk(i),this.documentListeners=new lj(this.document),this.listeners=new lj(n),this.windowListeners=new lj(Zk(i)),this.initialCoordinates=null!=(r=pC(o))?r:TC,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(dj.Resize,this.handleCancel),this.windowListeners.add(dj.DragStart,pj),this.windowListeners.add(dj.VisibilityChange,this.handleCancel),this.windowListeners.add(dj.ContextMenu,pj),this.documentListeners.add(dj.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(yj(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(vj(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(dj.Click,hj,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(dj.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:o}=this,{onMove:i,options:{activationConstraint:a}}=o;if(!r)return;const s=null!=(t=pC(e))?t:TC,l=dC(r,s);if(!n&&a){if(vj(a)){if(null!=a.tolerance&&cj(l,a.tolerance))return this.handleCancel();if(cj(l,a.distance))return this.handleStart()}return yj(a)&&cj(l,a.tolerance)?this.handleCancel():void this.handlePending(a,l)}e.cancelable&&e.preventDefault(),i(s)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===uj.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const bj={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class wj extends xj{constructor(e){const{event:t}=e,n=Qk(t.target);super(e,bj,n)}}wj.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button)&&(null==r||r({event:n}),!0)}}];const Sj={move:{name:"mousemove"},end:{name:"mouseup"}};var kj;!function(e){e[e.RightClick=2]="RightClick"}(kj||(kj={}));class Cj extends xj{constructor(e){super(e,Sj,Qk(e.event.target))}}Cj.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==kj.RightClick&&(null==r||r({event:n}),!0)}}];const jj={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class _j extends xj{constructor(e){super(e,jj)}static setup(){return window.addEventListener(jj.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(jj.move.name,e)};function e(){}}}var Ej,Dj;function Mj(t){let{acceleration:n,activator:r=Ej.Pointer,canScroll:o,draggingRect:i,enabled:a,interval:s=5,order:l=Dj.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:p,threshold:h}=t;const f=function(e){let{delta:t,disabled:n}=e;const r=iC(t);return rC(e=>{if(n||!r||!e)return Tj;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[JC.Backward]:e.x[JC.Backward]||-1===o.x,[JC.Forward]:e.x[JC.Forward]||1===o.x},y:{[JC.Backward]:e.y[JC.Backward]||-1===o.y,[JC.Forward]:e.y[JC.Forward]||1===o.y}}},[n,t,r])}({delta:p,disabled:!a}),[g,m]=function(){const t=(0,e.useRef)(null),n=(0,e.useCallback)((e,n)=>{t.current=setInterval(e,n)},[]);return[n,(0,e.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]}(),v=(0,e.useRef)({x:0,y:0}),y=(0,e.useRef)({x:0,y:0}),x=(0,e.useMemo)(()=>{switch(r){case Ej.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ej.DraggableRect:return i}},[r,i,c]),b=(0,e.useRef)(null),w=(0,e.useCallback)(()=>{const e=b.current;if(!e)return;const t=v.current.x*y.current.x,n=v.current.y*y.current.y;e.scrollBy(t,n)},[]),S=(0,e.useMemo)(()=>l===Dj.TreeOrder?[...d].reverse():d,[l,d]);(0,e.useEffect)(()=>{if(a&&d.length&&x){for(const e of S){if(!1===(null==o?void 0:o(e)))continue;const t=d.indexOf(e),r=u[t];if(!r)continue;const{direction:i,speed:a}=nj(e,r,x,n,h);for(const e of["x","y"])f[e][i[e]]||(a[e]=0,i[e]=0);if(a.x>0||a.y>0)return m(),b.current=e,g(w,s),v.current=a,void(y.current=i)}v.current={x:0,y:0},y.current={x:0,y:0},m()}else m()},[n,w,o,m,a,s,JSON.stringify(x),JSON.stringify(f),g,d,S,u,JSON.stringify(h)])}_j.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return!(o.length>1)&&(null==r||r({event:n}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(Ej||(Ej={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(Dj||(Dj={}));const Tj={x:{[JC.Backward]:!1,[JC.Forward]:!1},y:{[JC.Backward]:!1,[JC.Forward]:!1}};var Ij,Aj;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(Ij||(Ij={})),function(e){e.Optimized="optimized"}(Aj||(Aj={}));const Oj=new Map;function Rj(e,t){return rC(n=>e?n||("function"===typeof t?t(e):e):null,[t,e])}function zj(t){let{callback:n,disabled:r}=t;const o=tC(n),i=(0,e.useMemo)(()=>{if(r||"undefined"===typeof window||"undefined"===typeof window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(o)},[r]);return(0,e.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function Fj(e){return new sj(HC(e),e)}function Pj(t,n,r){void 0===n&&(n=Fj);const[o,i]=(0,e.useState)(null);function a(){i(e=>{if(!t)return null;var o;if(!1===t.isConnected)return null!=(o=null!=e?e:r)?o:null;const i=n(t);return JSON.stringify(e)===JSON.stringify(i)?e:i})}const s=function(t){let{callback:n,disabled:r}=t;const o=tC(n),i=(0,e.useMemo)(()=>{if(r||"undefined"===typeof window||"undefined"===typeof window.MutationObserver)return;const{MutationObserver:e}=window;return new e(o)},[o,r]);return(0,e.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(e){if(t)for(const n of e){const{type:e,target:r}=n;if("childList"===e&&r instanceof HTMLElement&&r.contains(t)){a();break}}}}),l=zj({callback:a});return eC(()=>{a(),t?(null==l||l.observe(t),null==s||s.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==s||s.disconnect())},[t]),o}const Bj=[];function Lj(t,n){void 0===n&&(n=[]);const r=(0,e.useRef)(null);return(0,e.useEffect)(()=>{r.current=null},n),(0,e.useEffect)(()=>{const e=t!==TC;e&&!r.current&&(r.current=t),!e&&r.current&&(r.current=null)},[t]),r.current?dC(t,r.current):TC}function Nj(t){return(0,e.useMemo)(()=>t?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(t):null,[t])}const Uj=[];function Vj(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Kk(t)?t:e}const Wj=[{sensor:wj,options:{}},{sensor:mj,options:{}}],Hj={current:{}},Gj={draggable:{measure:GC},droppable:{measure:GC,strategy:Ij.WhileDragging,frequency:Aj.Optimized},dragOverlay:{measure:HC}};class Xj extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const Yj={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Xj,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:EC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Gj,measureDroppableContainers:EC,windowRect:null,measuringScheduled:!1},qj={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:EC,draggableNodes:new Map,over:null,measureDroppableContainers:EC},Zj=(0,e.createContext)(qj),$j=(0,e.createContext)(Yj);function Kj(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Xj}}}function Jj(e,t){switch(t.type){case _C.DragStart:return s(s({},e),{},{draggable:s(s({},e.draggable),{},{initialCoordinates:t.initialCoordinates,active:t.active})});case _C.DragMove:return null==e.draggable.active?e:s(s({},e),{},{draggable:s(s({},e.draggable),{},{translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}})});case _C.DragEnd:case _C.DragCancel:return s(s({},e),{},{draggable:s(s({},e.draggable),{},{active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}})});case _C.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Xj(e.droppable.containers);return o.set(r,n),s(s({},e),{},{droppable:s(s({},e.droppable),{},{containers:o})})}case _C.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Xj(e.droppable.containers);return a.set(n,s(s({},i),{},{disabled:o})),s(s({},e),{},{droppable:s(s({},e.droppable),{},{containers:a})})}case _C.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new Xj(e.droppable.containers);return i.delete(n),s(s({},e),{},{droppable:s(s({},e.droppable),{},{containers:i})})}default:return e}}function Qj(t){let{disabled:n}=t;const{active:r,activatorEvent:o,draggableNodes:i}=(0,e.useContext)(Zj),a=iC(o),s=iC(null==r?void 0:r.id);return(0,e.useEffect)(()=>{if(!n&&!o&&a&&null!=s){if(!uC(a))return;if(document.activeElement===a.target)return;const e=i.get(s);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=gC(e);if(t){t.focus();break}}})}},[o,n,i,s,a]),null}function e_(e,t){let{transform:n}=t,r=l(t,xC);return null!=e&&e.length?e.reduce((e,t)=>t(s({transform:e},r)),n):n}const t_=(0,e.createContext)(s(s({},TC),{},{scaleX:1,scaleY:1}));var n_;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(n_||(n_={}));const r_=(0,e.memo)(function(t){var n,r,o,i;let{id:a,accessibility:c,autoScroll:d=!0,children:u,sensors:p=Wj,collisionDetection:h=BC,measuring:f,modifiers:g}=t,m=l(t,bC);const v=(0,e.useReducer)(Jj,void 0,Kj),[y,x]=v,[b,w]=function(){const[t]=(0,e.useState)(()=>new Set),n=(0,e.useCallback)(e=>(t.add(e),()=>t.delete(e)),[t]);return[(0,e.useCallback)(e=>{let{type:n,event:r}=e;t.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[t]),n]}(),[S,k]=(0,e.useState)(n_.Uninitialized),C=S===n_.Initialized,{draggable:{active:j,nodes:_,translate:E},droppable:{containers:D}}=y,M=null!=j?_.get(j):null,T=(0,e.useRef)({initial:null,translated:null}),I=(0,e.useMemo)(()=>{var e;return null!=j?{id:j,data:null!=(e=null==M?void 0:M.data)?e:Hj,rect:T}:null},[j,M]),A=(0,e.useRef)(null),[O,R]=(0,e.useState)(null),[z,F]=(0,e.useState)(null),P=nC(m,Object.values(m)),B=sC("DndDescribedBy",a),L=(0,e.useMemo)(()=>D.getEnabled(),[D]),N=(U=f,(0,e.useMemo)(()=>({draggable:s(s({},Gj.draggable),null==U?void 0:U.draggable),droppable:s(s({},Gj.droppable),null==U?void 0:U.droppable),dragOverlay:s(s({},Gj.dragOverlay),null==U?void 0:U.dragOverlay)}),[null==U?void 0:U.draggable,null==U?void 0:U.droppable,null==U?void 0:U.dragOverlay]));var U;const{droppableRects:V,measureDroppableContainers:W,measuringScheduled:H}=function(t,n){let{dragging:r,dependencies:o,config:i}=n;const[a,s]=(0,e.useState)(null),{frequency:l,measure:c,strategy:d}=i,u=(0,e.useRef)(t),p=function(){switch(d){case Ij.Always:return!1;case Ij.BeforeDragging:return r;default:return!r}}(),h=nC(p),f=(0,e.useCallback)(function(e){void 0===e&&(e=[]),h.current||s(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[h]),g=(0,e.useRef)(null),m=rC(e=>{if(p&&!r)return Oj;if(!e||e===Oj||u.current!==t||null!=a){const e=new Map;for(let n of t){if(!n)continue;if(a&&a.length>0&&!a.includes(n.id)&&n.rect.current){e.set(n.id,n.rect.current);continue}const t=n.node.current,r=t?new sj(c(t),t):null;n.rect.current=r,r&&e.set(n.id,r)}return e}return e},[t,a,r,p,c]);return(0,e.useEffect)(()=>{u.current=t},[t]),(0,e.useEffect)(()=>{p||f()},[r,p]),(0,e.useEffect)(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),(0,e.useEffect)(()=>{p||"number"!==typeof l||null!==g.current||(g.current=setTimeout(()=>{f(),g.current=null},l))},[l,p,f,...o]),{droppableRects:m,measureDroppableContainers:f,measuringScheduled:null!=a}}(L,{dragging:C,dependencies:[E.x,E.y],config:N.droppable}),G=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return rC(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(_,j),X=(0,e.useMemo)(()=>z?pC(z):null,[z]),Y=function(){const e=!1===(null==O?void 0:O.autoScrollEnabled),t="object"===typeof d?!1===d.enabled:!1===d,n=C&&!e&&!t;if("object"===typeof d)return s(s({},d),{},{enabled:n});return{enabled:n}}(),q=function(e,t){return Rj(e,t)}(G,N.draggable.measure);!function(t){let{activeNode:n,measure:r,initialRect:o,config:i=!0}=t;const a=(0,e.useRef)(!1),{x:s,y:l}="boolean"===typeof i?{x:i,y:i}:i;eC(()=>{if(!s&&!l||!n)return void(a.current=!1);if(a.current||!o)return;const e=null==n?void 0:n.node.current;if(!e||!1===e.isConnected)return;const t=LC(r(e),o);if(s||(t.x=0),l||(t.y=0),a.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const n=YC(e);n&&n.scrollBy({top:t.y,left:t.x})}},[n,s,l,o,r])}({activeNode:null!=j?_.get(j):null,config:Y.layoutShiftCompensation,initialRect:q,measure:N.draggable.measure});const Z=Pj(G,N.draggable.measure,q),$=Pj(G?G.parentElement:null),K=(0,e.useRef)({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:V,draggableNodes:_,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),J=D.getNodeFor(null==(n=K.current.over)?void 0:n.id),Q=function(t){let{measure:n}=t;const[r,o]=(0,e.useState)(null),i=zj({callback:(0,e.useCallback)(e=>{for(const{target:t}of e)if(Kk(t)){o(e=>{const r=n(t);return e?s(s({},e),{},{width:r.width,height:r.height}):r});break}},[n])}),a=(0,e.useCallback)(e=>{const t=Vj(e);null==i||i.disconnect(),t&&(null==i||i.observe(t)),o(t?n(t):null)},[n,i]),[l,c]=oC(a);return(0,e.useMemo)(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}({measure:N.dragOverlay.measure}),ee=null!=(r=Q.nodeRef.current)?r:G,te=C?null!=(o=Q.rect)?o:Z:null,ne=Boolean(Q.nodeRef.current&&Q.rect),re=LC(oe=ne?null:Z,Rj(oe));var oe;const ie=Nj(ee?Zk(ee):null),ae=function(t){const n=(0,e.useRef)(t),r=rC(e=>t?e&&e!==Bj&&t&&n.current&&t.parentNode===n.current.parentNode?e:XC(t):Bj,[t]);return(0,e.useEffect)(()=>{n.current=t},[t]),r}(C?null!=J?J:G:null),se=function(t,n){void 0===n&&(n=HC);const[r]=t,o=Nj(r?Zk(r):null),[i,a]=(0,e.useState)(Uj);function s(){a(()=>t.length?t.map(e=>QC(e)?o:new sj(n(e),e)):Uj)}const l=zj({callback:s});return eC(()=>{null==l||l.disconnect(),s(),t.forEach(e=>null==l?void 0:l.observe(e))},[t]),i}(ae),le=e_(g,{transform:{x:E.x-re.x,y:E.y-re.y,scaleX:1,scaleY:1},activatorEvent:z,active:I,activeNodeRect:Z,containerNodeRect:$,draggingNodeRect:te,over:K.current.over,overlayNodeRect:Q.rect,scrollableAncestors:ae,scrollableAncestorRects:se,windowRect:ie}),ce=X?cC(X,E):null,de=function(t){const[n,r]=(0,e.useState)(null),o=(0,e.useRef)(t),i=(0,e.useCallback)(e=>{const t=qC(e.target);t&&r(e=>e?(e.set(t,KC(t)),new Map(e)):null)},[]);return(0,e.useEffect)(()=>{const e=o.current;if(t!==e){n(e);const a=t.map(e=>{const t=qC(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,KC(t)]):null}).filter(e=>null!=e);r(a.length?new Map(a):null),o.current=t}return()=>{n(t),n(e)};function n(e){e.forEach(e=>{const t=qC(e);null==t||t.removeEventListener("scroll",i)})}},[i,t]),(0,e.useMemo)(()=>t.length?n?Array.from(n.values()).reduce((e,t)=>cC(e,t),TC):oj(t):TC,[t,n])}(ae),ue=Lj(de),pe=Lj(de,[Z]),he=cC(le,ue),fe=te?UC(te,le):null,ge=I&&fe?h({active:I,collisionRect:fe,droppableRects:V,droppableContainers:L,pointerCoordinates:ce}):null,me=function(e,t){if(!e||0===e.length)return null;const[n]=e;return t?n[t]:n}(ge,"id"),[ve,ye]=(0,e.useState)(null),xe=function(e,t,n){return s(s({},e),{},{scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1})}(ne?le:cC(le,pe),null!=(i=null==ve?void 0:ve.rect)?i:null,Z),be=(0,e.useRef)(null),we=(0,e.useCallback)((e,t)=>{let{sensor:n,options:r}=t;if(null==A.current)return;const o=_.get(A.current);if(!o)return;const i=e.nativeEvent,a=new n({active:A.current,activeNode:o,event:i,options:r,context:K,onAbort(e){if(!_.get(e))return;const{onDragAbort:t}=P.current,n={id:e};null==t||t(n),b({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!_.get(e))return;const{onDragPending:o}=P.current,i={id:e,constraint:t,initialCoordinates:n,offset:r};null==o||o(i),b({type:"onDragPending",event:i})},onStart(e){const t=A.current;if(null==t)return;const n=_.get(t);if(!n)return;const{onDragStart:r}=P.current,o={activatorEvent:i,active:{id:t,data:n.data,rect:T}};(0,Mi.unstable_batchedUpdates)(()=>{null==r||r(o),k(n_.Initializing),x({type:_C.DragStart,initialCoordinates:e,active:t}),b({type:"onDragStart",event:o}),R(be.current),F(i)})},onMove(e){x({type:_C.DragMove,coordinates:e})},onEnd:s(_C.DragEnd),onCancel:s(_C.DragCancel)});function s(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:o}=K.current;let a=null;if(t&&o){const{cancelDrop:s}=P.current;if(a={activatorEvent:i,active:t,collisions:n,delta:o,over:r},e===_C.DragEnd&&"function"===typeof s){await Promise.resolve(s(a))&&(e=_C.DragCancel)}}A.current=null,(0,Mi.unstable_batchedUpdates)(()=>{x({type:e}),k(n_.Uninitialized),ye(null),R(null),F(null),be.current=null;const t=e===_C.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=P.current[t];null==e||e(a),b({type:t,event:a})}})}}be.current=a},[_]),Se=(0,e.useCallback)((e,t)=>(n,r)=>{const o=n.nativeEvent,i=_.get(r);if(null!==A.current||!i||o.dndKit||o.defaultPrevented)return;const a={active:i};!0===e(n,t.options,a)&&(o.dndKit={capturedBy:t.sensor},A.current=r,we(n,t))},[_,we]),ke=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{const{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:n(e.handler,t)}))]},[]),[t,n])}(p,Se);!function(t){(0,e.useEffect)(()=>{if(!Xk)return;const e=t.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const t of e)null==t||t()}},t.map(e=>{let{sensor:t}=e;return t}))}(p),eC(()=>{Z&&S===n_.Initializing&&k(n_.Initialized)},[Z,S]),(0,e.useEffect)(()=>{const{onDragMove:e}=P.current,{active:t,activatorEvent:n,collisions:r,over:o}=K.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:r,delta:{x:he.x,y:he.y},over:o};(0,Mi.unstable_batchedUpdates)(()=>{null==e||e(i),b({type:"onDragMove",event:i})})},[he.x,he.y]),(0,e.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:o}=K.current;if(!e||null==A.current||!t||!o)return;const{onDragOver:i}=P.current,a=r.get(me),s=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:o.x,y:o.y},over:s};(0,Mi.unstable_batchedUpdates)(()=>{ye(s),null==i||i(l),b({type:"onDragOver",event:l})})},[me]),eC(()=>{K.current={activatorEvent:z,active:I,activeNode:G,collisionRect:fe,collisions:ge,droppableRects:V,draggableNodes:_,draggingNode:ee,draggingNodeRect:te,droppableContainers:D,over:ve,scrollableAncestors:ae,scrollAdjustedTranslate:he},T.current={initial:te,translated:fe}},[I,G,ge,fe,_,ee,te,V,D,ve,ae,he]),Mj(s(s({},Y),{},{delta:E,draggingRect:fe,pointerCoordinates:ce,scrollableAncestors:ae,scrollableAncestorRects:se}));const Ce=(0,e.useMemo)(()=>({active:I,activeNode:G,activeNodeRect:Z,activatorEvent:z,collisions:ge,containerNodeRect:$,dragOverlay:Q,draggableNodes:_,droppableContainers:D,droppableRects:V,over:ve,measureDroppableContainers:W,scrollableAncestors:ae,scrollableAncestorRects:se,measuringConfiguration:N,measuringScheduled:H,windowRect:ie}),[I,G,Z,z,ge,$,Q,_,D,V,ve,W,ae,se,N,H,ie]),je=(0,e.useMemo)(()=>({activatorEvent:z,activators:ke,active:I,activeNodeRect:Z,ariaDescribedById:{draggable:B},dispatch:x,draggableNodes:_,over:ve,measureDroppableContainers:W}),[z,ke,I,Z,x,B,_,ve,W]);return e.createElement(SC.Provider,{value:w},e.createElement(Zj.Provider,{value:je},e.createElement($j.Provider,{value:Ce},e.createElement(t_.Provider,{value:xe},u)),e.createElement(Qj,{disabled:!1===(null==c?void 0:c.restoreFocus)})),e.createElement(jC,s(s({},c),{},{hiddenTextDescribedById:B})))}),o_=(0,e.createContext)(null),i_="button";function a_(t){let{id:n,data:r,disabled:o=!1,attributes:i}=t;const a=sC("Draggable"),{activators:s,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:p,over:h}=(0,e.useContext)(Zj),{role:f=i_,roleDescription:g="draggable",tabIndex:m=0}=null!=i?i:{},v=(null==c?void 0:c.id)===n,y=(0,e.useContext)(v?t_:o_),[x,b]=oC(),[w,S]=oC(),k=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{let{eventName:r,handler:o}=t;return e[r]=e=>{o(e,n)},e},{}),[t,n])}(s,n),C=nC(r);eC(()=>(p.set(n,{id:n,key:a,node:x,activatorNode:w,data:C}),()=>{const e=p.get(n);e&&e.key===a&&p.delete(n)}),[p,n]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:(0,e.useMemo)(()=>({role:f,tabIndex:m,"aria-disabled":o,"aria-pressed":!(!v||f!==i_)||void 0,"aria-roledescription":g,"aria-describedby":u.draggable}),[o,f,m,v,g,u.draggable]),isDragging:v,listeners:o?void 0:k,node:x,over:h,setNodeRef:b,setActivatorNodeRef:S,transform:y}}function s_(){return(0,e.useContext)($j)}const l_={timeout:25};function c_(t){let{data:n,disabled:r=!1,id:o,resizeObserverConfig:i}=t;const a=sC("Droppable"),{active:l,dispatch:c,over:d,measureDroppableContainers:u}=(0,e.useContext)(Zj),p=(0,e.useRef)({disabled:r}),h=(0,e.useRef)(!1),f=(0,e.useRef)(null),g=(0,e.useRef)(null),{disabled:m,updateMeasurementsFor:v,timeout:y}=s(s({},l_),i),x=nC(null!=v?v:o),b=zj({callback:(0,e.useCallback)(()=>{h.current?(null!=g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(x.current)?x.current:[x.current]),g.current=null},y)):h.current=!0},[y]),disabled:m||!l}),w=(0,e.useCallback)((e,t)=>{b&&(t&&(b.unobserve(t),h.current=!1),e&&b.observe(e))},[b]),[S,k]=oC(w),C=nC(n);return(0,e.useEffect)(()=>{b&&S.current&&(b.disconnect(),h.current=!1,b.observe(S.current))},[S,b]),(0,e.useEffect)(()=>(c({type:_C.RegisterDroppable,element:{id:o,key:a,disabled:r,node:S,rect:f,data:C}}),()=>c({type:_C.UnregisterDroppable,key:a,id:o})),[o]),(0,e.useEffect)(()=>{r!==p.current.disabled&&(c({type:_C.SetDroppableDisabled,id:o,key:a,disabled:r}),p.current.disabled=r)},[o,a,r,c]),{active:l,rect:f,isOver:(null==d?void 0:d.id)===o,node:S,over:d,setNodeRef:k}}function d_(t){let{animation:n,children:r}=t;const[o,i]=(0,e.useState)(null),[a,s]=(0,e.useState)(null),l=iC(r);return r||o||!l||i(l),eC(()=>{if(!a)return;const e=null==o?void 0:o.key,t=null==o?void 0:o.props.id;null!=e&&null!=t?Promise.resolve(n(t,a)).then(()=>{i(null)}):i(null)},[n,o,a]),e.createElement(e.Fragment,null,r,o?(0,e.cloneElement)(o,{ref:s}):null)}const u_={x:0,y:0,scaleX:1,scaleY:1};function p_(t){let{children:n}=t;return e.createElement(Zj.Provider,{value:qj},e.createElement(t_.Provider,{value:u_},n))}const h_={position:"fixed",touchAction:"none"},f_=e=>uC(e)?"transform 250ms ease":void 0,g_=(0,e.forwardRef)((t,n)=>{let{as:r,activatorEvent:o,adjustScale:i,children:a,className:l,rect:c,style:d,transform:u,transition:p=f_}=t;if(!c)return null;const h=i?u:s(s({},u),{},{scaleX:1,scaleY:1}),f=s(s({},h_),{},{width:c.width,height:c.height,top:c.top,left:c.left,transform:hC.Transform.toString(h),transformOrigin:i&&o?AC(o,c):void 0,transition:"function"===typeof p?p(o):p},d);return e.createElement(r,{className:l,style:f,ref:n},a)}),m_=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:i,className:a}=e;if(null!=i&&i.active)for(const[e,s]of Object.entries(i.active))void 0!==s&&(o[e]=n.node.style.getPropertyValue(e),n.node.style.setProperty(e,s));if(null!=i&&i.dragOverlay)for(const[e,s]of Object.entries(i.dragOverlay))void 0!==s&&r.node.style.setProperty(e,s);return null!=a&&a.active&&n.node.classList.add(a.active),null!=a&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[e,t]of Object.entries(o))n.node.style.setProperty(e,t);null!=a&&a.active&&n.node.classList.remove(a.active)}},v_={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:n}}=e;return[{transform:hC.Transform.toString(t)},{transform:hC.Transform.toString(n)}]},sideEffects:m_({styles:{active:{opacity:"0"}}})};function y_(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return tC((e,i)=>{if(null===t)return;const a=n.get(e);if(!a)return;const c=a.node.current;if(!c)return;const d=Vj(i);if(!d)return;const{transform:u}=Zk(i).getComputedStyle(i),p=VC(u);if(!p)return;const h="function"===typeof t?t:function(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}=s(s({},v_),e);return e=>{let{active:i,dragOverlay:a,transform:c}=e,d=l(e,wC);if(!t)return;const u={x:a.rect.left-i.rect.left,y:a.rect.top-i.rect.top},p={scaleX:1!==c.scaleX?i.rect.width*c.scaleX/a.rect.width:1,scaleY:1!==c.scaleY?i.rect.height*c.scaleY/a.rect.height:1},h=s({x:c.x-u.x,y:c.y-u.y},p),f=o(s(s({},d),{},{active:i,dragOverlay:a,transform:{initial:c,final:h}})),[g]=f,m=f[f.length-1];if(JSON.stringify(g)===JSON.stringify(m))return;const v=null==r?void 0:r(s({active:i,dragOverlay:a},d)),y=a.node.animate(f,{duration:t,easing:n,fill:"forwards"});return new Promise(e=>{y.onfinish=()=>{null==v||v(),e()}})}}(t);return ij(c,o.draggable.measure),h({active:{id:e,data:a.data,node:c,rect:o.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:i,rect:o.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:o,transform:p})})}let x_=0;function b_(t){return(0,e.useMemo)(()=>{if(null!=t)return x_++,x_},[t])}const w_=e.memo(t=>{let{adjustScale:n=!1,children:r,dropAnimation:o,style:i,transition:a,modifiers:l,wrapperElement:c="div",className:d,zIndex:u=999}=t;const{activatorEvent:p,active:h,activeNodeRect:f,containerNodeRect:g,draggableNodes:m,droppableContainers:v,dragOverlay:y,over:x,measuringConfiguration:b,scrollableAncestors:w,scrollableAncestorRects:S,windowRect:k}=s_(),C=(0,e.useContext)(t_),j=b_(null==h?void 0:h.id),_=e_(l,{activatorEvent:p,active:h,activeNodeRect:f,containerNodeRect:g,draggingNodeRect:y.rect,over:x,overlayNodeRect:y.rect,scrollableAncestors:w,scrollableAncestorRects:S,transform:C,windowRect:k}),E=Rj(f),D=y_({config:o,draggableNodes:m,droppableContainers:v,measuringConfiguration:b}),M=E?y.setRef:void 0;return e.createElement(p_,null,e.createElement(d_,{animation:D},h&&j?e.createElement(g_,{key:j,id:h.id,ref:M,as:c,activatorEvent:p,adjustScale:n,className:d,transition:a,rect:E,style:s({zIndex:u},i),transform:_},r):null))});function S_(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function k_(e,t){return e.reduce((e,n,r)=>{const o=t.get(n);return o&&(e[r]=o),e},Array(e.length))}function C_(e){return null!==e&&e>=0}const j_=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=S_(t,r,n),a=t[o],s=i[o];return s&&a?{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}:null},__={scaleX:1,scaleY:1},E_=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:i,overIndex:a}=e;const l=null!=(t=i[n])?t:r;if(!l)return null;if(o===n){const e=i[a];return e?s({x:0,y:n<a?e.top+e.height-(l.top+l.height):e.top-l.top},__):null}const c=function(e,t,n){const r=e[t],o=e[t-1],i=e[t+1];if(!r)return 0;if(n<t)return o?r.top-(o.top+o.height):i?i.top-(r.top+r.height):0;return i?i.top-(r.top+r.height):o?r.top-(o.top+o.height):0}(i,o,n);return s(o>n&&o<=a?{x:0,y:-l.height-c}:o<n&&o>=a?{x:0,y:l.height+c}:{x:0,y:0},__)};const D_="Sortable",M_=e.createContext({activeIndex:-1,containerId:D_,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:j_,disabled:{draggable:!1,droppable:!1}});function T_(t){let{children:n,id:r,items:o,strategy:i=j_,disabled:a=!1}=t;const{active:s,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=s_(),p=sC(D_,r),h=Boolean(null!==l.rect),f=(0,e.useMemo)(()=>o.map(e=>"object"===typeof e&&"id"in e?e.id:e),[o]),g=null!=s,m=s?f.indexOf(s.id):-1,v=d?f.indexOf(d.id):-1,y=(0,e.useRef)(f),x=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(f,y.current),b=-1!==v&&-1===m||x,w=function(e){return"boolean"===typeof e?{draggable:e,droppable:e}:e}(a);eC(()=>{x&&g&&u(f)},[x,f,g,u]),(0,e.useEffect)(()=>{y.current=f},[f]);const S=(0,e.useMemo)(()=>({activeIndex:m,containerId:p,disabled:w,disableTransforms:b,items:f,overIndex:v,useDragOverlay:h,sortedRects:k_(f,c),strategy:i}),[m,p,w.draggable,w.droppable,b,f,v,c,h,i]);return e.createElement(M_.Provider,{value:S},n)}const I_=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return S_(n,r,o).indexOf(t)},A_=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:a,previousItems:s,previousContainerId:l,transition:c}=e;return!(!c||!r)&&((s===i||o!==a)&&(!!n||a!==o&&t===l))},O_={duration:200,easing:"ease"},R_="transform",z_=hC.Transition.toString({property:R_,duration:0,easing:"linear"}),F_={roleDescription:"sortable"};function P_(t){let{animateLayoutChanges:n=A_,attributes:r,disabled:o,data:i,getNewIndex:a=I_,id:l,strategy:c,resizeObserverConfig:d,transition:u=O_}=t;const{items:p,containerId:h,activeIndex:f,disabled:g,disableTransforms:m,sortedRects:v,overIndex:y,useDragOverlay:x,strategy:b}=(0,e.useContext)(M_),w=function(e,t){var n,r;if("boolean"===typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(o,g),S=p.indexOf(l),k=(0,e.useMemo)(()=>s({sortable:{containerId:h,index:S,items:p}},i),[h,i,S,p]),C=(0,e.useMemo)(()=>p.slice(p.indexOf(l)),[p,l]),{rect:j,node:_,isOver:E,setNodeRef:D}=c_({id:l,data:k,disabled:w.droppable,resizeObserverConfig:s({updateMeasurementsFor:C},d)}),{active:M,activatorEvent:T,activeNodeRect:I,attributes:A,setNodeRef:O,listeners:R,isDragging:z,over:F,setActivatorNodeRef:P,transform:B}=a_({id:l,data:k,attributes:s(s({},F_),r),disabled:w.draggable}),L=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(0,e.useMemo)(()=>e=>{n.forEach(t=>t(e))},n)}(D,O),N=Boolean(M),U=N&&!m&&C_(f)&&C_(y),V=!x&&z,W=V&&U?B:null,H=U?null!=W?W:(null!=c?c:b)({rects:v,activeNodeRect:I,activeIndex:f,overIndex:y,index:S}):null,G=C_(f)&&C_(y)?a({id:l,items:p,activeIndex:f,overIndex:y}):S,X=null==M?void 0:M.id,Y=(0,e.useRef)({activeId:X,items:p,newIndex:G,containerId:h}),q=p!==Y.current.items,Z=n({active:M,containerId:h,isDragging:z,isSorting:N,id:l,index:S,items:p,newIndex:Y.current.newIndex,previousItems:Y.current.items,previousContainerId:Y.current.containerId,transition:u,wasDragging:null!=Y.current.activeId}),$=function(t){let{disabled:n,index:r,node:o,rect:i}=t;const[a,s]=(0,e.useState)(null),l=(0,e.useRef)(r);return eC(()=>{if(!n&&r!==l.current&&o.current){const e=i.current;if(e){const t=HC(o.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&s(n)}}r!==l.current&&(l.current=r)},[n,r,o,i]),(0,e.useEffect)(()=>{a&&s(null)},[a]),a}({disabled:!Z,index:S,node:_,rect:j});return(0,e.useEffect)(()=>{N&&Y.current.newIndex!==G&&(Y.current.newIndex=G),h!==Y.current.containerId&&(Y.current.containerId=h),p!==Y.current.items&&(Y.current.items=p)},[N,G,h,p]),(0,e.useEffect)(()=>{if(X===Y.current.activeId)return;if(null!=X&&null==Y.current.activeId)return void(Y.current.activeId=X);const e=setTimeout(()=>{Y.current.activeId=X},50);return()=>clearTimeout(e)},[X]),{active:M,activeIndex:f,attributes:A,data:k,rect:j,index:S,newIndex:G,items:p,isOver:E,isSorting:N,isDragging:z,listeners:R,node:_,overIndex:y,over:F,setNodeRef:L,setActivatorNodeRef:P,setDroppableNodeRef:D,setDraggableNodeRef:O,transform:null!=$?$:H,transition:function(){if($||q&&Y.current.newIndex===S)return z_;if(V&&!uC(T)||!u)return;if(N||Z)return hC.Transition.toString(s(s({},u),{},{property:R_}));return}()}}uj.Down,uj.Right,uj.Up,uj.Left;function B_(e){let{userId:t,onUpload:n,onUploadStart:r,onUploadEnd:o}=e;return(0,c.jsxs)("label",{className:"modal-button primary",style:{cursor:"pointer",display:"inline-block"},children:["\ud83d\udcce \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430",(0,c.jsx)("input",{type:"file",style:{display:"none"},onChange:async e=>{const i=e.target.files[0];if(!i)return;const a=new FormData;a.append("file",i),a.append("user_id",t),r&&r();try{const e=await fetch("/api/upload_media",{method:"POST",body:a}),t=await e.json();e.ok&&t.file_id?n(t):alert(t.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 Telegram")}catch(s){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430:",s),alert("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430. \u0421\u043c. \u043a\u043e\u043d\u0441\u043e\u043b\u044c.")}finally{o&&o(),e.target.value=null}},accept:"image/*,video/*,audio/*,.gif"})]})}const L_=t=>{let{item:n}=t;const r=(0,e.useMemo)(()=>"/api/tgfile/".concat(n.file_id),[n.file_id]),o={width:"60px",height:"60px",borderRadius:"4px",objectFit:"cover",backgroundColor:"#2a2a2a",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"};switch(n.type){case"photo":return(0,c.jsx)("img",{src:r,alt:"preview",style:o});case"video":return(0,c.jsx)("video",{src:r,style:o,playsInline:!0,muted:!0,loop:!0});case"animation":return(0,c.jsx)("video",{src:r,style:o,autoPlay:!0,playsInline:!0,muted:!0,loop:!0});case"audio":return(0,c.jsx)("div",{style:o,children:"\ud83c\udfb5"});default:return(0,c.jsx)("div",{style:o,children:"\u2753"})}};function N_(e){let{item:t,onDelete:n}=e;const{attributes:r,listeners:o,setNodeRef:i,transform:a,transition:l}=P_({id:t.file_id}),d={transform:hC.Transform.toString(a),transition:l,display:"flex",alignItems:"center",justifyContent:"space-between",background:"#3a3a3a",padding:"10px",borderRadius:"8px",gap:"15px",touchAction:"none"};return(0,c.jsxs)("li",s(s({ref:i,style:d},r),{},{children:[(0,c.jsx)("span",s(s({},o),{},{style:{cursor:"grab",color:"white",padding:"0 5px",userSelect:"none"},title:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a",children:"\u2630"})),(0,c.jsx)("div",s(s({},o),{},{style:{cursor:"grab"},children:(0,c.jsx)(L_,{item:t})})),(0,c.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",gap:"5px"},children:[(0,c.jsx)("span",{style:{textTransform:"capitalize",fontWeight:"bold"},children:t.type}),(0,c.jsx)("span",{style:{fontFamily:"monospace",fontSize:"0.8rem",color:"#aaa",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:t.file_id})]}),(0,c.jsx)("button",{className:"modal-button danger",style:{padding:"5px 10px"},onClick:n,children:"\ud83d\uddd1\ufe0f"})]}))}function U_(t){let{node:n,onUpdate:r,onClose:o,userId:i,storyId:a}=t;const[l,d]=(0,e.useState)(n.data.fragment.media||[]),[u,p]=(0,e.useState)(!1),[h,f]=(0,e.useState)(!1),[g,m]=(0,e.useState)(!1),[v,y]=(0,e.useState)([]),[x,b]=(0,e.useState)(!1),w=(0,e.useCallback)(async e=>{try{await ql(i,a,n.id,e),r(e)}catch(t){console.error("Failed to save media order:",t),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043c\u0435\u0434\u0438\u0430: ".concat(t.message)),d(l)}},[i,a,n.id,r,l]),S=(0,e.useCallback)(async e=>{if(l.length>=10)return void alert("\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 10 \u043c\u0435\u0434\u0438\u0430.");const t=s({},e),o=[...l,t];try{await ql(i,a,n.id,o),d(o),r(o),g&&m(!1)}catch(c){console.error("Failed to add media:",c),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430: ".concat(c.message))}},[l,i,a,n.id,r,g]),k=(0,e.useCallback)(async e=>{const t=l.filter((t,n)=>n!==e);try{await ql(i,a,n.id,t),d(t),r(t)}catch(o){console.error("Failed to delete media:",o),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430: ".concat(o.message))}},[l,i,a,n.id,r]),C=l.map(e=>e.file_id);return(0,c.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault(),g||f(!0)},onDragLeave:()=>f(!1),onDrop:async e=>{if(e.preventDefault(),f(!1),g)return;const t=Array.from(e.dataTransfer.files).slice(0,10-l.length);for(const r of t){if(l.length>=10)return void alert("\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 10 \u043c\u0435\u0434\u0438\u0430.");const e=new FormData;e.append("file",r),e.append("user_id",i),p(!0);try{const t=await fetch("/api/upload_media",{method:"POST",body:e}),n=await t.json();t.ok&&n.file_id?await S(n):alert(n.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 Telegram")}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430:",n),alert("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430. \u0421\u043c. \u043a\u043e\u043d\u0441\u043e\u043b\u044c.")}finally{p(!1)}}},style:{gap:"20px",border:h?"2px dashed #888":"none",maxWidth:"600px",width:"90%"},children:[(0,c.jsx)("h3",{children:g?"\u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 \u043c\u0435\u0434\u0438\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430":'\u041c\u0435\u0434\u0438\u0430 \u0434\u043b\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 "'.concat(n.id,'"')}),(0,c.jsx)("div",{style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"5px"},children:g?(0,c.jsx)("div",{children:0===v.length?(0,c.jsx)("p",{children:"\u0412 \u044d\u0442\u043e\u043c \u043f\u0440\u043e\u0435\u043a\u0442\u0435 \u0435\u0449\u0435 \u043d\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u043e\u0432."}):(0,c.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"10px"},children:v.map(e=>(0,c.jsx)("div",{onClick:()=>S(e),style:{border:"1px solid #ccc",borderRadius:"8px",overflow:"hidden",cursor:"pointer",position:"relative",aspectRatio:"1 / 1",background:"#f9fafb"},title:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c",children:"video"===e.type||"animation"===e.type?(0,c.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",color:"#666",flexDirection:"column"},children:[(0,c.jsx)("span",{children:"\u25b6"}),(0,c.jsx)("span",{style:{fontSize:"10px"},children:e.type})]}):(0,c.jsx)("img",{src:"/api/tgfile/".concat(e.file_id),alt:"media",style:{width:"100%",height:"100%",objectFit:"cover"},loading:"lazy",onError:e=>{e.target.onerror=null,e.target.style.display="none",e.target.parentElement.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#666;font-size:10px">\u041e\u0448\u0438\u0431\u043a\u0430</div>'}})},e.file_id))})}):(0,c.jsx)(c.Fragment,{children:0===l.length?(0,c.jsx)("p",{children:"\u041c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442. \u0412\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u044d\u0442\u043e \u043e\u043a\u043d\u043e."}):(0,c.jsx)(r_,{collisionDetection:FC,onDragEnd:e=>{const{active:t,over:n}=e;t.id!==n.id&&d(e=>{const r=e.findIndex(e=>e.file_id===t.id),o=e.findIndex(e=>e.file_id===n.id),i=S_(e,r,o);return w(i),i})},children:(0,c.jsx)(T_,{items:C,strategy:E_,children:(0,c.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"10px"},children:l.map((e,t)=>(0,c.jsx)(N_,{item:e,onDelete:()=>k(t)},e.file_id))})})})})}),(0,c.jsxs)("div",{className:"modal-actions",style:{justifyContent:"space-between",flexWrap:"wrap",gap:"10px"},children:[(0,c.jsx)("div",{style:{display:"flex",gap:"10px"},children:g?(0,c.jsx)("button",{className:"modal-button secondary",onClick:()=>m(!1),children:"\u2190 \u041d\u0430\u0437\u0430\u0434"}):(0,c.jsx)("button",{className:"modal-button secondary",onClick:o,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})}),!g&&(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[x?(0,c.jsx)("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,c.jsx)("button",{className:"modal-button secondary",onClick:async()=>{b(!0);try{const e=await fetch("/api/story/".concat(i,"/").concat(a));if(!e.ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u0430");const t=(await e.json()).fragments||{},n=new Map;Object.values(t).forEach(e=>{e.media&&Array.isArray(e.media)&&e.media.forEach(e=>{e.file_id&&!n.has(e.file_id)&&n.set(e.file_id,e)})}),y(Array.from(n.values())),m(!0)}catch(e){console.error(e),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430\u0442\u0435\u043a\u0443 \u043f\u0440\u043e\u0435\u043a\u0442\u0430: "+e.message)}finally{b(!1)}},disabled:u,style:{background:"#e0f2fe",color:"#0284c7",border:"1px solid #bae6fd"},children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0435"}),u?(0,c.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,c.jsx)(B_,{userId:i,onUpload:S,onUploadStart:()=>p(!0),onUploadEnd:()=>p(!1)})]})]})]})})}const V_=function(t){var n;let{node:r,onClose:o,onUpdateMedia:i,onUpdateChoices:a}=t;const{fragment:s}=r.data,[l,d]=(0,e.useState)(s.media||[]),[u,p]=(0,e.useState)(s.choices||[]),h=(0,e.useRef)(null),f=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText="\n.preview-modal-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.preview-modal-content {\n    background: #282c34;\n    color: white;\n    padding: 20px;\n    border-radius: 8px;\n    width: 90%;\n    max-width: 500px;\n    max-height: 90vh;\n    overflow-y: auto;\n    border: 1px solid #444;\n}\n\n.preview-modal-content h3, .preview-modal-content h4 {\n    margin-top: 0;\n    border-bottom: 1px solid #555;\n    padding-bottom: 8px;\n    margin-bottom: 12px;\n}\n\n.preview-section {\n    margin-bottom: 20px;\n}\n\n.draggable-list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.draggable-item {\n    display: flex;\n    align-items: center;\n    padding: 8px;\n    background-color: #3a3f4a;\n    border: 1px solid #555;\n    border-radius: 4px;\n    cursor: grab;\n    user-select: none;\n    justify-content: space-between; /* \u041d\u043e\u0432\u043e\u0435 */\n}\n\n.draggable-content {\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n    gap: 10px;\n}\n\n.sort-hint {\n    font-size: 0.85em;\n    color: #aaa;\n    white-space: nowrap;\n    margin-left: 10px;\n}\n\n.draggable-item.dragging {\n    opacity: 0.5;\n    border: 1px dashed #fff;\n}\n\n.drag-handle {\n    margin-right: 12px;\n    font-size: 1.2em;\n    color: #888;\n}\n\n.media-preview-img {\n    width: 40px;\n    height: 40px;\n    object-fit: cover;\n    border-radius: 4px;\n    margin-right: 10px;\n}\n\n.text-preview {\n    background-color: #1e1e1e;\n    padding: 10px;\n    border-radius: 4px;\n    white-space: pre-wrap; /* \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u044b \u0441\u0442\u0440\u043e\u043a */\n    word-wrap: break-word;\n    max-height: 200px;\n    overflow-y: auto;\n    border: 1px solid #555;\n    line-height: 1.5; /* \u0423\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0447\u0438\u0442\u0430\u0435\u043c\u043e\u0441\u0442\u044c */\n}\n\n/* \u2728 \u041d\u0410\u0427\u0410\u041b\u041e: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u2728 */\n.text-preview a {\n  color: #87CEFA; /* Light Sky Blue */\n  text-decoration: none;\n}\n.text-preview a:hover {\n  text-decoration: underline;\n}\n\n.text-preview code {\n  font-family: 'Courier New', Courier, monospace;\n  background-color: #3a3f4a;\n  padding: 2px 5px;\n  border-radius: 4px;\n  font-size: 0.9em;\n  border: 1px solid #555;\n}\n\n.text-preview pre {\n  background-color: #1a1c20;\n  border: 1px solid #555;\n  padding: 10px;\n  border-radius: 4px;\n  white-space: pre-wrap;\n  word-break: break-all;\n  margin: 8px 0;\n  font-family: 'Courier New', Courier, monospace;\n  font-size: 0.9em;\n}\n\n.text-preview blockquote {\n  margin: 8px 0 8px 10px;\n  padding-left: 12px;\n  border-left: 3px solid #666;\n  color: #ccc;\n}\n\n.text-preview .tg-spoiler {\n    background-color: #888;\n    color: #888;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: all 0.15s ease-in-out;\n}\n\n.text-preview .tg-spoiler:hover {\n    background-color: #999;\n    color: #999;\n}\n\n.text-preview .tg-spoiler.revealed {\n    background-color: transparent;\n    color: inherit; /* \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u0446\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f */\n}\n/* \u2728 \u041a\u041e\u041d\u0415\u0426: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u2728 */\n\n.telegram-button-preview {\n    width: 100%;\n    padding: 10px;\n    text-align: center;\n    background-color: #4a76a8;\n    color: white;\n    border-radius: 5px;\n    font-size: 1em;\n    border: none;\n}\n\n.modal-actions {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 20px;\n}\n",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const g=e=>{e.currentTarget.classList.remove("dragging"),h.current=null,i(l)},m=e=>{e.currentTarget.classList.remove("dragging"),f.current=null,a(u)},v=(e,t)=>{switch(e.type){case"photo":return(0,c.jsx)("img",{src:"/api/tgfile/".concat(e.file_id),alt:"preview",className:"media-preview-img"});case"video":return(0,c.jsxs)("span",{children:["\ud83c\udfac \u0412\u0438\u0434\u0435\u043e_",t+1]});case"animation":return(0,c.jsxs)("span",{children:["\ud83c\udf9e\ufe0f \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f_",t+1]});case"audio":return(0,c.jsxs)("span",{children:["\ud83c\udfb5 \u0410\u0443\u0434\u0438\u043e_",t+1]});default:return(0,c.jsx)("span",{children:"\u2753 \u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0442\u0438\u043f"})}};return(0,c.jsx)("div",{className:"preview-modal-overlay",onClick:o,children:(0,c.jsxs)("div",{className:"preview-modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h3",{children:["\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440: ",r.id]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u041c\u0435\u0434\u0438\u0430"}),(0,c.jsxs)("div",{className:"draggable-list",children:[l.map((e,t)=>(0,c.jsxs)("div",{className:"draggable-item",draggable:!0,onDragStart:e=>((e,t)=>{h.current=t,e.dataTransfer.effectAllowed="move",e.currentTarget.classList.add("dragging")})(e,t),onDragEnter:e=>((e,t)=>{if(h.current===t)return;const n=[...l],r=n.splice(h.current,1)[0];n.splice(t,0,r),h.current=t,d(n)})(0,t),onDragEnd:g,onDragOver:e=>e.preventDefault(),children:[(0,c.jsxs)("div",{className:"draggable-content",children:[(0,c.jsx)("span",{className:"drag-handle",children:"\u283f"}),v(e,t)]}),(0,c.jsx)("span",{className:"sort-hint",children:"\u0423\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u043b\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438"})]},e.file_id)),0===l.length&&(0,c.jsx)("p",{children:(0,c.jsx)("i",{children:"\u041c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442."})})]})]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u0422\u0435\u043a\u0441\u0442"}),(0,c.jsx)("div",{className:"text-preview",onClick:e=>{const t=e.target.closest(".tg-spoiler");t&&t.classList.toggle("revealed")},dangerouslySetInnerHTML:{__html:(null===(n=s.text)||void 0===n?void 0:n.replace(/\n/g,"<br />"))||"<i>\u0422\u0435\u043a\u0441\u0442 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442.</i>"}})]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u041a\u043d\u043e\u043f\u043a\u0438"}),(0,c.jsxs)("div",{className:"draggable-list",children:[u.map((e,t)=>(0,c.jsx)("div",{className:"draggable-item",draggable:!0,onDragStart:e=>((e,t)=>{f.current=t,e.dataTransfer.effectAllowed="move",e.currentTarget.classList.add("dragging")})(e,t),onDragEnter:e=>((e,t)=>{if(f.current===t)return;const n=[...u],r=n.splice(f.current,1)[0];n.splice(t,0,r),f.current=t,p(n)})(0,t),onDragEnd:m,onDragOver:e=>e.preventDefault(),children:(0,c.jsxs)("div",{className:"draggable-content",children:[(0,c.jsx)("span",{className:"drag-handle",children:"\u283f"}),(0,c.jsx)("div",{className:"telegram-button-preview",children:e.text})]})},"".concat(e.target,"-").concat(e.text))),0===u.length&&(0,c.jsx)("p",{children:(0,c.jsx)("i",{children:"\u041a\u043d\u043e\u043f\u043a\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442."})})]})]}),(0,c.jsx)("div",{className:"modal-actions",children:(0,c.jsx)("button",{onClick:o,className:"modal-button primary",children:"\u0413\u043e\u0442\u043e\u0432\u043e"})})]})})},W_=window.location.pathname.slice(1).split("_"),H_=W_[0],G_=W_[1];const X_=function(t){let{id:n,top:r,left:o,onClick:i,node:a,setNodes:l,setEdges:d}=t;const[u,p]=(0,e.useState)(null),h=H_,f=G_,{ref:g,style:m}=ec({x:o,y:r}),v=(e,t)=>{const n=t.text||"(\u043f\u0443\u0441\u0442\u043e)",r=t.media||[],o={photo:["\u0444\u043e\u0442\u043e","\u0444\u043e\u0442\u043e","\u0444\u043e\u0442\u043e"],video:["\u0432\u0438\u0434\u0435\u043e","\u0432\u0438\u0434\u0435\u043e","\u0432\u0438\u0434\u0435\u043e"],audio:["\u0430\u0443\u0434\u0438\u043e","\u0430\u0443\u0434\u0438\u043e","\u0430\u0443\u0434\u0438\u043e"],animation:["\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f","\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438","\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0439"]};let i="";if(r.length>0){const e=r.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{});i=Object.entries(e).map(e=>{let[t,n]=e;return"".concat({photo:"\ud83d\udcf7",video:"\ud83c\udfac",audio:"\ud83c\udfb5",animation:"\ud83c\udf9e\ufe0f"}[t]||"\u2753"," ").concat(n," ").concat(function(e,t){let[n,r,o]=t;return e%10===1&&e%100!==11?n:[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?r:o}(n,o[t]||[t,t,t]))}).join(" ")}return"".concat(e,"\n").concat(n.replace(/<[^>]+>/g,"").substring(0,1500)).concat(n.length>1500?"...":"").concat(i?"\n"+i:"")},y=(0,e.useCallback)(async e=>{if(e!==a.data.fragment.text)try{await Xl(h,f,n,e),l(t=>t.map(t=>{if(t.id===n){const r=s(s({},t.data.fragment),{},{text:e});return s(s({},t),{},{data:s(s({},t.data),{},{fragment:r,label:v(n,r),bgColor:TE(n,r)})})}return t}))}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(t.message))}p(null),i()},[n,a,h,f,l,i]),x=(0,e.useCallback)(async e=>{try{await ql(h,f,n,e),l(t=>t.map(t=>{if(t.id===n){const r=e.map(e=>s(s({},e),{},{url:"/api/tgfile/".concat(e.file_id)})),o=s(s({},t.data.fragment),{},{media:e});return s(s({},t),{},{data:s(s({},t.data),{},{fragment:o,media:r,label:v(n,o),bgColor:TE(n,o)})})}return t}))}catch(t){console.error(t)}},[n,h,f,l]),b=(0,e.useCallback)(async e=>{if("main_1"===n)return alert("main_1 \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c."),p(null),void i();if(e&&e!==n)try{const{story:t}=await async function(e,t,n,r){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newName:r})});if(!o.ok){const{error:e}=await o.json();throw new Error(e)}return await o.json()}(h,f,n,e);l(r=>r.map(r=>r.id===n?s(s({},r),{},{id:e,data:s(s({},r.data),{},{label:"".concat(e,"\n").concat(t.fragments[e].text)})}):r)),d(t=>t.map(t=>(t.source===n&&(t.source=e),t.target===n&&(t.target=e),t)))}catch(t){console.error(t)}p(null),i()},[n,h,f,l,d,i]),w=(0,e.useCallback)(async()=>{try{await async function(e,t,n){return(await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n),{method:"DELETE"})).ok}(h,f,n),l(e=>e.filter(e=>e.id!==n)),d(e=>e.filter(e=>e.source!==n&&e.target!==n))}catch(e){console.error(e)}p(null),i()},[n,h,f,l,d,i]);return(0,c.jsxs)(c.Fragment,{children:[!u&&(0,c.jsxs)("div",{ref:g,style:m,className:"context-menu",children:[(0,c.jsxs)("p",{children:["\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442: ",(0,c.jsx)("strong",{children:n})]}),(0,c.jsx)("button",{onClick:()=>p("preview"),children:"\ud83d\udc41\ufe0f \u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"}),(0,c.jsx)("button",{onClick:()=>p("rename"),children:"\u270f\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442. \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),(0,c.jsx)("button",{onClick:()=>p("edit"),children:"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442. \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsx)("button",{onClick:()=>p("media"),children:"\ud83d\uddbc\ufe0f \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c/\u0420\u0435\u0434\u0430\u043a\u0442. \u043c\u0435\u0434\u0438\u0430"}),(0,c.jsx)("button",{className:"delete",onClick:()=>p("delete"),children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"}),(0,c.jsx)("button",{onClick:i,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}),"edit"===u&&(0,c.jsx)(Uk,{initialHtml:a.data.fragment.text||"",onSave:y,onCancel:()=>{p(null),i()},userId:h,storyId:f}),"rename"===u&&(0,c.jsx)(Lk,{title:'\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c "'.concat(n,'"'),onConfirm:()=>b(document.getElementById("rename-input").value),onCancel:()=>{p(null),i()},confirmText:"\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c",children:(0,c.jsx)("input",{id:"rename-input",type:"text",defaultValue:n,className:"prompt-input",autoFocus:!0})}),"delete"===u&&(0,c.jsx)(Lk,{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c?",type:"danger",onConfirm:w,onCancel:()=>{p(null),i()},confirmText:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:(0,c.jsxs)("p",{children:["\u0422\u043e\u0447\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c ",(0,c.jsxs)("strong",{children:['"',n,'"']}),"?"]})}),"media"===u&&(0,c.jsx)(U_,{node:a,userId:h,storyId:f,onUpdate:x,onClose:()=>{p(null),i()}}),"preview"===u&&(0,c.jsx)(V_,{node:a,onClose:()=>{p(null),i()},onUpdateMedia:x})]})},Y_=e=>{let{isOpen:t,onClose:n}=e;return t?(0,c.jsxs)("div",{className:"modal-overlay",children:[" ",(0,c.jsxs)("div",{className:"modal-content help-modal-content",children:[(0,c.jsx)("h3",{children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"}),(0,c.jsxs)("p",{children:['1) \u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u0443, \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0443, \u043e\u0434\u043d\u043e \u043d\u0438\u0436\u043d\u0435\u0435 \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u0435 \u0438 \u0447\u0438\u0441\u043b\u043e. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: "\u0418\u0434\u0442\u0438\u041f\u0440\u044f\u043c\u043e_2", "\u0412\u0441\u0442\u0430\u0442\u044c_8"',"\n","2) \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 17 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432","\n","3) \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0435 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0447\u0438\u0441\u043b\u043e \u2014 \u043e\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438","\n","4) \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0435 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0438\u043c\u044f \u2014 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0438\u043c\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0441 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u043c \u043d\u0435\u0437\u0430\u043d\u044f\u0442\u044b\u043c \u043d\u043e\u043c\u0435\u0440\u043e\u043c","\n",'5) \u0415\u0441\u043b\u0438 \u0432\u043c\u0435\u0441\u0442\u043e \u0442\u0435\u043a\u0441\u0442\u0430 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e \u0447\u0438\u0441\u043b\u043e, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 4, \u0442\u043e \u043a\u043d\u043e\u043f\u043a\u0438 \u0443 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438 \u043e\u043d \u0441\u043c\u0435\u043d\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0432\u043d\u043e\u0435 \u044d\u0442\u043e\u043c\u0443 \u0447\u0438\u0441\u043b\u0443 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445 6) \u0412\u0430\u0440\u0438\u0430\u043d\u0442 "\u0431\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0438" \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0432\u0435\u0431 \u0432\u0435\u0440\u0441\u0438\u0438 \u0438\u0433\u0440\u044b. \u041a\u043b\u0438\u043a \u0432 \u043b\u044e\u0431\u043e\u0439 \u0437\u043e\u043d\u0435 \u044d\u043a\u0440\u0430\u043d\u0430 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0441\u043f\u0440\u0438\u043d\u044f\u0442 \u043a\u0430\u043a \u043d\u0430\u0436\u0430\u0442\u0438\u0435 \u043d\u0430 \u044d\u0442\u0443 \u043a\u043d\u043e\u043f\u043a\u0443']}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"15px"},children:(0,c.jsx)("button",{onClick:n,className:"button-base ok-button",children:"\u041f\u043e\u043d\u044f\u0442\u043d\u043e"})})]})]}):null},q_=t=>{let{isOpen:n,onClose:r,onSubmit:o,defaultName:i,sourceNodeName:a,generateUniqueFragmentId:s,existingIds:l,sourceHasNoBtn:d}=t;const[u,p]=(0,e.useState)(""),[h,f]=(0,e.useState)(""),[g,m]=(0,e.useState)(""),[v,y]=(0,e.useState)(!1),[x,b]=(0,e.useState)(!1),[w,S]=(0,e.useState)(!1);(0,e.useEffect)(()=>{n&&(p(""),f(""),m(""),y(!1),S(!1))},[n]);return n?(0,c.jsx)("div",{className:"modal-overlay",children:(0,c.jsxs)("div",{className:"modal-content",children:[(0,c.jsxs)("h3",{children:['\u041d\u043e\u0432\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u043e\u0442 "',a,'"']}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"fragmentName",style:{display:"block",marginBottom:"5px"},children:"\u0418\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:"}),(0,c.jsx)("input",{id:"fragmentName",type:"text",value:u,onChange:e=>{p(e.target.value),g&&m("")},placeholder:i||"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0421\u0446\u0435\u043d\u0430_1",className:"input-field"}),(0,c.jsx)("div",{className:"error-text",children:g})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"choiceText",style:{display:"block",marginBottom:"5px"},children:"\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430:"}),(0,c.jsx)("div",{style:{marginBottom:"8px"},children:(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:d?"not-allowed":"pointer",opacity:d?.6:1,fontSize:"14px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:w,onChange:e=>{const t=e.target.checked;S(t),t?(f("{No_btn}"),"\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c."===g&&m("")):f("")},disabled:d,style:{marginRight:"8px"}}),"\u0411\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0438 ",d&&"(\u0443\u0436\u0435 \u0435\u0441\u0442\u044c)"]})}),(0,c.jsx)("input",{id:"choiceText",type:"text",value:h,onChange:e=>{w||f(e.target.value)},disabled:w,placeholder:w?"{No_btn}":"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0418\u0434\u0442\u0438 \u0434\u0430\u043b\u044c\u0448\u0435",className:"input-field",style:{backgroundColor:w?"#f3f4f6":"white",color:w?"#6b7280":"inherit"}})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"15px"},children:[(0,c.jsx)("button",{onClick:r,className:"button-base cancel-button",disabled:v,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:async()=>{if(v)return;let e,t=u.trim();if(t||(t=null===i||void 0===i?void 0:i.trim()),!t)return void m("\u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c.");if(/_\d+$/.test(t))e=t;else{e=s(t,l,!1).id}const n=s(e,l,!0);if(n.error)return void m(n.error);const r=w?"{No_btn}":h.trim();if(r){y(!0),m("");try{await o(e,r)}catch(a){m(a.message||"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430")}finally{y(!1)}}else m("\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c.")},className:"button-base ok-button",disabled:v,children:v?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u041e\u041a"})]}),(0,c.jsx)("button",{onClick:()=>b(!0),className:"help-button",children:"\u041f\u043e\u043c\u043e\u0449\u044c"}),(0,c.jsx)(Y_,{isOpen:x,onClose:()=>b(!1)})]})}):null};const Z_=function(t){let{top:n,left:r,edge:o,onClick:i,onEditEffects:a,setEdges:l,userId:d,storyId:u,onCopyEffects:p,onPasteEffects:h,hasCopiedEffects:f}=t;const{source:g,target:m,data:v}=o,{ref:y,style:x}=ec({x:r,y:n}),b=v.originalEffects&&v.originalEffects.length>0;return(0,e.useLayoutEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,c.jsxs)("div",{ref:y,className:"context-menu",style:x,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("p",{children:["\u0421\u0432\u044f\u0437\u044c: ",(0,c.jsx)("strong",{children:g})," \u2192 ",(0,c.jsx)("strong",{children:m})]}),(0,c.jsx)("button",{onClick:async()=>{const e=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u0442\u0435\u043a\u0441\u0442 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432\u044b\u0431\u043e\u0440\u0430:",v.text);if(null!==e&&e!==v.text)try{await fetch("/api/story/".concat(d,"/").concat(u,"/choice"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:g,choiceIndex:v.choiceIndex,text:e})}),l(t=>t.map(t=>t.id===o.id?s(s({},t),{},{data:s(s({},t.data),{},{text:e})}):t))}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430: ".concat(t.message))}finally{i()}else i()},children:"\u270f\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsx)("button",{onClick:a,children:"\u2699\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),b&&(0,c.jsx)("button",{onClick:()=>{p(v.originalEffects||[])},children:"\ud83d\udccb \u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),f&&(0,c.jsx)("button",{onClick:()=>{h(o)},children:"\ud83d\udce5 \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,c.jsx)("button",{className:"delete",onClick:async()=>{if(window.confirm('\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c \u043e\u0442 "'.concat(g,'" \u043a "').concat(m,'"?')))try{if(!(await fetch("/api/story/".concat(d,"/").concat(u,"/choice"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:g,choiceIndex:v.choiceIndex})})).ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u0432\u0435\u0442\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");l(e=>e.filter(e=>e.id!==o.id))}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u044f\u0437\u0438: ".concat(e.message))}i()},children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c"}),(0,c.jsx)("button",{onClick:i,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})};const $_=function(t){let{top:n,left:r,onClose:o,onCreateFragment:i,onAddNote:a}=t;const{ref:s,style:l}=ec({x:r,y:n});return(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,c.jsxs)("div",{ref:s,className:"context-menu",style:l,onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("p",{children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043e\u0431\u043b\u0430\u0441\u0442\u044c\u044e"}),(0,c.jsx)("button",{onClick:()=>{i(),o()},children:"\ud83d\udcdd \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"}),(0,c.jsx)("button",{onClick:()=>{a(),o()},children:"\ud83d\udd16 \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443"}),(0,c.jsx)("button",{onClick:o,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})},K_={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},J_={background:"white",padding:"25px",borderRadius:"8px",width:"90%",maxWidth:"450px",maxHeight:"70vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"15px"},Q_={display:"grid",gridTemplateColumns:"1fr 3fr 80px",gap:"10px",alignItems:"center"},eE={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"};const tE=function(t){let{isOpen:n,onClose:r,from:o,to:i,modifiers:a,onSave:l}=t;const[d,u]=(0,e.useState)({});if((0,e.useEffect)(()=>{const e={},t=parseInt(o,10),n=parseInt(i,10);if(!isNaN(t)&&!isNaN(n)&&n>=t)for(let r=t;r<=n;r++){const t=a.find(e=>e.value===r);e[r]=t?t.prob:0}u(e)},[n,o,i,a]),!n)return null;const p=(e,t)=>{u(n=>s(s({},n),{},{[e]:parseInt(t,10)||0}))},h=Object.keys(d);return(0,c.jsx)("div",{style:K_,onClick:r,children:(0,c.jsxs)("div",{style:J_,onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h4",{style:{marginTop:0},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439"}),h.length>0?h.map(e=>(0,c.jsxs)("div",{style:Q_,children:[(0,c.jsxs)("strong",{children:["\u0427\u0438\u0441\u043b\u043e: ",e]}),(0,c.jsx)("input",{type:"range",min:"-100",max:"100",value:d[e],onChange:t=>p(e,t.target.value)}),(0,c.jsx)("input",{type:"number",min:"-100",max:"100",value:d[e],onChange:t=>p(e,t.target.value),style:{width:"70px",textAlign:"center"}})]},e)):(0,c.jsx)("p",{style:{color:"#666"},children:'\u0417\u0430\u0434\u0430\u0439\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d "\u041e\u0442" \u0438 "\u0414\u043e", \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438.'}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[(0,c.jsx)("button",{style:s(s({},eE),{},{background:"#e2e3e5"}),onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{style:s(s({},eE),{},{background:"#d4edda",color:"#155724"}),onClick:()=>{const e=Object.entries(d).filter(e=>{let[t,n]=e;return 0!==n}).map(e=>{let[t,n]=e;return{value:parseInt(t,10),prob:n}});l(e)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})};var nE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},rE=e.createContext&&e.createContext(nE),oE=["attr","size","title"];function iE(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function aE(){return aE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aE.apply(this,arguments)}function sE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sE(Object(n),!0).forEach(function(t){cE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function cE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dE(t){return t&&t.map((t,n)=>e.createElement(t.tag,lE({key:n},t.attr),dE(t.child)))}function uE(t){return n=>e.createElement(pE,aE({attr:lE({},t.attr)},n),dE(t.child))}function pE(t){var n=n=>{var r,{attr:o,size:i,title:a}=t,s=iE(t,oE),l=i||n.size||"1em";return n.className&&(r=n.className),t.className&&(r=(r?r+" ":"")+t.className),e.createElement("svg",aE({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,s,{className:r,style:lE(lE({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&e.createElement("title",null,a),t.children)};return void 0!==rE?e.createElement(rE.Consumer,null,e=>n(e)):n(nE)}function hE(e){return uE({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function fE(e){return uE({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}const gE={display:"flex",flexDirection:"column",gap:"10px",border:"1px solid #ccc",padding:"10px",borderRadius:"8px",background:"#f9f9f9"},mE={padding:"8px",borderRadius:"4px",border:"1px solid #ddd",width:"100%",boxSizing:"border-box"},vE=s({},mE),yE={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"},xE=s(s({},yE),{},{padding:"4px 8px",fontSize:"12px",maxWidth:"100px",whiteSpace:"normal",textAlign:"center",lineHeight:"1.2"});const bE=function(t){let{effect:n,onChange:r,onDelete:o,availableStats:i=[]}=t;const[a,l]=(0,e.useState)(!1),d=String(n.id).replace(/\./g,"-"),u="stats-list-".concat(d),p=(e,t)=>{r(s(s({},n),{},{[e]:t}))};return(0,c.jsxs)("div",{style:gE,children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:2},children:[(0,c.jsx)("input",{type:"text",placeholder:"\u0410\u0442\u0440\u0438\u0431\u0443\u0442 (\u0441\u0438\u043b\u0430, \u0443\u0434\u0430\u0447\u0430...)",value:n.stat,onChange:e=>p("stat",e.target.value),list:u,autoComplete:"off",style:mE}),i&&i.length>0&&(0,c.jsx)("datalist",{id:u,children:i.map((e,t)=>{const n="object"===typeof e&&null!==e?e.stat||e.name||e.id||JSON.stringify(e):e;return(0,c.jsx)("option",{value:n},"".concat(u,"-").concat(t))})})]}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsxs)("select",{style:vE,value:n.type,onChange:e=>p("type",e.target.value),children:[(0,c.jsx)("option",{value:"set",children:"\u0417\u0430\u0434\u0430\u0442\u044c"}),(0,c.jsx)("option",{value:"modify",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"check",children:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430"}),(0,c.jsx)("option",{value:"range",children:"\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d"}),(0,c.jsx)("option",{value:"modifyRange",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d"})]})}),"modifyRange"===n.type&&(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsxs)("select",{style:vE,value:n.modifyType||"increase",onChange:e=>p("modifyType",e.target.value),children:[(0,c.jsx)("option",{value:"increase",children:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"decrease",children:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c"})]})})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flex:1},children:(()=>{switch(n.type){case"set":return(0,c.jsx)("input",{type:"number",style:mE,placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",value:n.value||"",onChange:e=>p("value",e.target.value)});case"modify":return(0,c.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,c.jsxs)("select",{style:vE,value:n.modifyType||"increase",onChange:e=>p("modifyType",e.target.value),children:[(0,c.jsx)("option",{value:"increase",children:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"decrease",children:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c"})]}),(0,c.jsx)("input",{type:"number",style:mE,placeholder:"\u041d\u0430...",value:n.value||"",onChange:e=>p("value",e.target.value)})]});case"check":return(0,c.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,c.jsxs)("select",{style:vE,value:n.checkType||"equal",onChange:e=>p("checkType",e.target.value),children:[(0,c.jsxs)("option",{value:"greater",children:[">"," (\u0411\u043e\u043b\u044c\u0448\u0435)"]}),(0,c.jsxs)("option",{value:"less",children:["<"," (\u041c\u0435\u043d\u044c\u0448\u0435)"]}),(0,c.jsxs)("option",{value:"equal",children:["="," (\u0420\u0430\u0432\u043d\u043e)"]})]}),(0,c.jsx)("input",{type:"number",style:mE,placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",value:n.value||"",onChange:e=>p("value",e.target.value)})]});case"range":case"modifyRange":return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"number",style:mE,placeholder:"\u041e\u0442",value:n.from||"",onChange:e=>p("from",e.target.value)}),(0,c.jsx)("span",{children:"-"}),(0,c.jsx)("input",{type:"number",style:mE,placeholder:"\u0414\u043e",value:n.to||"",onChange:e=>p("to",e.target.value)}),(0,c.jsx)("button",{style:s(s({},xE),{},{background:"#e0e0e0"}),onClick:()=>l(!0),children:"\ud83c\udfb2 \u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438"})]});default:return null}})()}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsxs)("label",{title:n.hide?"\u042d\u0444\u0444\u0435\u043a\u0442 \u0441\u043a\u0440\u044b\u0442":"\u042d\u0444\u0444\u0435\u043a\u0442 \u0432\u0438\u0434\u0435\u043d \u0438\u0433\u0440\u043e\u043a\u0443",style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer",fontSize:"18px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!n.hide,onChange:e=>p("hide",e.target.checked),style:{display:"none"}}),(0,c.jsx)("span",{style:{fontSize:20},children:n.hide?(0,c.jsx)(hE,{}):(0,c.jsx)(fE,{})})]}),(0,c.jsx)("button",{style:s(s({},yE),{},{background:"#f8d7da",color:"#721c24"}),onClick:o,children:"\ud83d\uddd1\ufe0f"})]})]}),a&&(0,c.jsx)(tE,{isOpen:a,onClose:()=>l(!1),from:n.from,to:n.to,modifiers:n.modifiers||[],onSave:e=>{p("modifiers",e),l(!1)}})]})};const wE={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},SE={background:"white",padding:"20px",borderRadius:"8px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"15px",position:"relative"},kE={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"},CE=s(s({},kE),{},{background:"#f0f0f0",color:"#333",border:"1px solid #ccc"});const jE=function(t){let{isOpen:n,onClose:r,onSave:o,edge:i,availableStats:a=[]}=t;const[l,d]=(0,e.useState)([]);return(0,e.useEffect)(()=>{var e;if(n&&null!==i&&void 0!==i&&null!==(e=i.data)&&void 0!==e&&e.originalEffects){const e=i.data.originalEffects.map(e=>s(s(s({},e),function(e){"string"!==typeof e&&(e=String(e||""));const t=e.match(/^([+-])\((\-?\d+)-(\-?\d+)\)$/);if(t)return{type:"modifyRange",modifyType:"+"===t[1]?"increase":"decrease",from:t[2],to:t[3]};const n=e.match(/^(\-?\d+)-(\-?\d+)$/);if(n)return{type:"range",from:n[1],to:n[2]};const r=e.match(/^([+-><=])(\-?\d+)$/);if(r){const e=r[1],t=r[2];if("+"===e||"-"===e)return{type:"modify",modifyType:"+"===e?"increase":"decrease",value:t};if(">"===e||"<"===e||"="===e)return{type:"check",checkType:{">":"greater","<":"less","=":"equal"}[e],value:t}}return{type:"set",value:e}}(e.value)),{},{id:Math.random()}));d(e)}else d([])},[n,i]),n?(0,c.jsx)("div",{style:wE,onClick:r,children:(0,c.jsxs)("div",{style:SE,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h3",{style:{marginTop:0,borderBottom:"1px solid #eee",paddingBottom:"10px"},children:["\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ",i.source," \u2192 ",i.target]}),(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:l.map((e,t)=>(0,c.jsx)(bE,{effect:e,availableStats:a,onChange:e=>((e,t)=>{const n=[...l];n[e]=t,d(n)})(t,e),onDelete:()=>(e=>{d(l.filter((t,n)=>n!==e))})(t)},e.id))}),(0,c.jsx)("button",{style:s(s({},kE),{},{background:"#cce5ff",color:"#004085",marginTop:"15px"}),onClick:()=>{d([...l,{id:Math.random(),stat:"",hide:!1,type:"set",value:"",modifiers:[],modifyType:"increase",checkType:"equal"}])},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442"}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px",marginTop:"20px"},children:[(0,c.jsx)("button",{style:CE,onClick:()=>alert('- \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043b\u044e\u0431\u044b\u043c, \u043d\u043e \u0441\u043b\u0435\u0434\u0438\u0442\u0435 \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u044b\u043b\u043e \u043e\u0434\u043d\u0438\u043c \u0438 \u0442\u0435\u043c \u0436\u0435 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430\u0445, \u043b\u044e\u0431\u0430\u044f \u043e\u043f\u0435\u0447\u0430\u0442\u043a\u0430 \u0441\u043b\u043e\u043c\u0430\u0435\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435/\u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439.\n\n- \u0427\u0438\u0441\u043b\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0435\u043b\u044b\u0435.\n\n- \u041a\u043d\u043e\u043f\u043a\u0430 "\u0441\u043a\u0440\u044b\u0442\u044c"(\u0433\u043b\u0430\u0437) \u0431\u0443\u0434\u0435\u0442 \u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432. \u0410 \u0442\u0430\u043a \u0436\u0435 \u043a\u043d\u043e\u043f\u043a\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u044f\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u043f\u0440\u0438 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0441\u043a\u0440\u044b\u0442\u0438\u044f \u0442\u0430\u043a\u0438\u0435 \u043a\u043d\u043e\u043f\u043a\u0438 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u0432 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0435.'),title:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043f\u0440\u0430\u0432\u043a\u0443",children:"? \u041f\u043e\u043c\u043e\u0449\u044c"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{style:s(s({},kE),{},{background:"#e2e3e5"}),onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{style:s(s({},kE),{},{background:"#d4edda",color:"#155724"}),onClick:()=>{const e=l.map(e=>{if(!e.stat.trim())return null;const{value:t,modifiers:n}=function(e){let t="",n=e.modifiers||[];switch(e.type){case"set":t=String(e.value||"0");break;case"modify":const n="increase"===e.modifyType?"+":"-";t="".concat(n).concat(e.value||"0");break;case"check":const r={greater:">",less:"<",equal:"="}[e.checkType];t="".concat(r).concat(e.value||"0");break;case"range":t="".concat(e.from||"0","-").concat(e.to||"0");break;case"modifyRange":const o="increase"===e.modifyType?"+":"-";t="".concat(o,"(").concat(e.from||"0","-").concat(e.to||"0",")");break;default:t=""}return"range"!==e.type&&"modifyRange"!==e.type&&(n=[]),{value:t,modifiers:n}}(e);return{stat:e.stat,hide:e.hide,value:t,modifiers:n}}).filter(Boolean);e.length===l.filter(e=>e.stat.trim()).length?o(e):alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u043f\u043e\u043b\u044f.")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"})]})]})]})}):null},_E=t=>{let{top:n,left:r,onClose:o,nodes:i,onDeleteAll:a,onCalculate:s}=t;const{ref:l,style:d}=ec({x:r,y:n});(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);return(0,c.jsxs)("div",{ref:l,className:"context-menu",style:d,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("p",{children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: ",(0,c.jsx)("strong",{children:i.length})]}),(0,c.jsx)("button",{onClick:()=>{s(i)},children:"\ud83c\udf9b \u041f\u0440\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c"}),(0,c.jsxs)("button",{className:"delete",onClick:()=>{a(i)},children:["\ud83d\uddd1 \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0451 (",i.length,")"]}),(0,c.jsx)("button",{onClick:o,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e"})]})},EE=(e,t)=>{t&&0!==t.length&&t.forEach(t=>{const n=(e=>{if((e=e.trim()).startsWith(">")||e.startsWith("<")||e.startsWith("="))return null;const t=e.match(/^(-?\d+)$/);if(t){const e=parseInt(t[1],10);return{min:e,max:e,type:"set"}}const n=e.match(/^(-?\d+)-(-?\d+)$/);if(n){const e=parseInt(n[1],10),t=parseInt(n[2],10);return{min:Math.min(e,t),max:Math.max(e,t),type:"set"}}const r=e.match(/^([+-])(\d+)$/);if(r){const e=r[1],t=parseInt(r[2],10);return{min:t,max:t,type:"+"===e?"add":"subtract"}}const o=e.match(/^([+-])\((\d+)-(\d+)\)$/);if(o){const e=o[1],t=parseInt(o[2],10),n=parseInt(o[3],10);return{min:Math.min(t,n),max:Math.max(t,n),type:"+"===e?"add":"subtract"}}return null})(t.value);if(!n)return;const r=t.stat;e[r]||(e[r]={min:0,max:0});const o=e[r];switch(n.type){case"set":o.min=n.min,o.max=n.max;break;case"add":o.min+=n.min,o.max+=n.max;break;case"subtract":o.min-=n.max,o.max-=n.min}})},DE=new(Bl().graphlib.Graph);DE.setDefaultEdgeLabel(()=>({}));const ME=e=>({photo:"\u0444\u043e\u0442\u043e",video:"\u0432\u0438\u0434\u0435\u043e",animation:"\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438",audio:"\u0430\u0443\u0434\u0438\u043e"}[e]||e),TE=(e,t)=>{var n;const r=!(null===(n=t.text)||void 0===n||!n.trim())&&"(\u043f\u0443\u0441\u0442\u043e)"!==t.text,o=Array.isArray(t.media)&&t.media.length>0;return r||o?t.choices&&0!==t.choices.length?"main_1"===e?"#86efac":/_1$/.test(e)&&"main_1"!==e?"#bbf7d0":"#e0f2fe":"#fef3c7":"#fecaca"},IE=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.match(/^(.*?)(?:_(\d+))?$/);if(!r)return{error:'\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0438\u043c\u0435\u043d\u0438: "'.concat(e,'"')};const o=r[1],i=r[2]?parseInt(r[2],10):0,a=new Set([...t].map(e=>e.toLowerCase()));if(n)return a.has(e.toLowerCase())?{error:'\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c "'.concat(e,'" \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442.')}:e.trim()?{id:e}:{error:"\u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c."};let s=i+1;for(;a.has("".concat(o.toLowerCase(),"_").concat(s));)s++;return{id:"".concat(o,"_").concat(s)}},AE=(e,t,n)=>{if(null===e||void 0===e||!e.fragments)return{nodes:[],edges:[]};let r=[];const o=[];Object.entries(e.fragments).forEach(e=>{let[t,n]=e;const i=(n.media||[]).reduce((e,t)=>{let{type:n}=t;return s(s({},e),{},{[n]:(e[n]||0)+1})},{}),a=Object.entries(i).map(e=>{let[t,n]=e;return"".concat(n," ").concat(ME(t))}).join(", "),l=[t,n.text||"(\u043f\u0443\u0441\u0442\u043e)",a&&"\ud83d\udcce ".concat(a)].filter(Boolean).join("\n"),c=(n.media||[]).map(e=>s(s({},e),{},{url:"/api/tgfile/".concat(e.file_id)}));r.push({id:t,type:"custom",position:{x:0,y:0},data:{label:l,bgColor:TE(t,n),media:c,fragment:n}}),n.choices&&n.choices.forEach((e,n)=>{var r;const i=null!==(r=e.effects)&&void 0!==r&&r.length?e.effects.map(e=>"".concat(e.stat,": ").concat(e.value)).join(", "):"";o.push({id:"".concat(t,"->").concat(e.target,"_").concat(n),source:t,target:e.target,type:"custom",animated:!0,style:{stroke:"#2563eb"},data:{text:e.text,effectsText:i,originalEffects:e.effects||[],choiceIndex:n}})})}),t&&Object.entries(t).forEach(e=>{let[t,n]=e;r.push({id:t,type:"note",position:n.position,data:{text:n.text},draggable:!0,selectable:!0})});const i=new Set;o.forEach(e=>{i.add("".concat(e.source,"|").concat(e.target))}),o.forEach(e=>{const t="".concat(e.target,"|").concat(e.source);i.has(t)?e.source<e.target?e.data.offsetY=-20:e.data.offsetY=20:e.data.offsetY=0});if(n&&Object.keys(n).length>0)return r.forEach(e=>{n[e.id]&&(e.position=n[e.id])}),{nodes:r,edges:o};{const e=r.filter(e=>"note"!==e.type),t=r.filter(e=>"note"===e.type),{nodes:n,edges:i}=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TB";DE.setGraph({rankdir:n,nodesep:100,ranksep:150}),e.forEach(e=>{DE.setNode(e.id,{width:700,height:36})}),t.forEach(e=>{DE.setEdge(e.source,e.target)}),Bl().layout(DE);const r=DE.node("main_1"),o=(null===r||void 0===r?void 0:r.x)||0,i=(null===r||void 0===r?void 0:r.y)||0;return e.forEach(e=>{const t=DE.node(e.id);e.targetPosition="top",e.sourcePosition="bottom",e.position={x:t.x-o,y:t.y-i}}),{nodes:e,edges:t}}(e,o);return{nodes:[...n,...t],edges:i}}},OE=e=>{const t={};return e.forEach(e=>{const n="".concat(e.source,"-").concat(e.target);t[n]||(t[n]=[]),t[n].push(e)}),Object.values(t).forEach(e=>{e.sort((e,t)=>{var n,r;return((null===(n=e.data)||void 0===n?void 0:n.choiceIndex)||0)-((null===(r=t.data)||void 0===r?void 0:r.choiceIndex)||0)})}),e.map(e=>{var n,r;const o="".concat(e.source,"-").concat(e.target),i=t[o],a=i.findIndex(t=>t.id===e.id),l=i.length;return(null===(n=e.data)||void 0===n?void 0:n.siblingIndex)===a&&(null===(r=e.data)||void 0===r?void 0:r.siblingCount)===l?e:s(s({},e),{},{data:s(s({},e.data),{},{siblingIndex:a,siblingCount:l})})})};const RE=t=>{let{title:n,children:r,defaultOpen:o=!1}=t;const[i,a]=(0,e.useState)(o);return(0,c.jsxs)("div",{style:{marginBottom:"8px",border:"1px solid #e0e0e0",borderRadius:"6px",overflow:"hidden"},children:[(0,c.jsxs)("button",{onClick:()=>a(!i),style:{width:"100%",textAlign:"left",padding:"12px 16px",background:i?"#f0f4f8":"#f9f9f9",border:"none",cursor:"pointer",fontWeight:"bold",fontSize:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"background 0.2s",color:"#333"},children:[(0,c.jsx)("span",{children:n}),(0,c.jsx)("span",{style:{transform:i?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"},children:"\u25bc"})]}),i&&(0,c.jsx)("div",{style:{padding:"16px",background:"#fff",borderTop:"1px solid #e0e0e0",lineHeight:"1.5"},children:r})]})},zE=e=>{let{onClose:t}=e;return(0,c.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxWidth:"600px",height:"80vh",backgroundColor:"white",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",zIndex:1001,display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#fff",borderRadius:"8px 8px 0 0"},children:[(0,c.jsx)("h2",{style:{margin:0,fontSize:"20px"},children:"\u041f\u043e\u043c\u043e\u0449\u044c \u043f\u043e \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0443"}),(0,c.jsx)("button",{onClick:t,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#666",lineHeight:"1"},children:"\xd7"})]}),(0,c.jsxs)("div",{style:{padding:"16px",overflowY:"auto",flexGrow:1,background:"#fafafa"},children:[(0,c.jsxs)(RE,{title:"\u2728 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b",defaultOpen:!0,children:[(0,c.jsxs)("p",{style:{marginTop:0},children:["- ",(0,c.jsx)("strong",{children:"\u041d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f:"})," \u041f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u0439\u0442\u0435 \u043a\u0430\u0440\u0442\u0443 \u0438\u043b\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u044b \u043c\u044b\u0448\u044c\u044e/\u043f\u0430\u043b\u044c\u0446\u0435\u043c. \u041f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438.",(0,c.jsx)("br",{}),"- \u041a\u043d\u043e\u043f\u043a\u0430 ",(0,c.jsx)("strong",{children:'"\u0418\u0433\u0440\u0430\u0442\u044c"'})," \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0432 \u0431\u043e\u0442\u0435."]}),(0,c.jsxs)("div",{style:{margin:"10px 0",padding:"10px",backgroundColor:"#fff3cd",borderLeft:"4px solid #ffc107",color:"#856404",fontSize:"0.9em"},children:[(0,c.jsx)("strong",{children:"\u0412\u0430\u0436\u043d\u043e:"})," \u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u043d\u0435\u0441\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0431\u043e\u0442\u0435, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u043b\u0438\u0441\u044c \u043d\u0430 \u0432\u0435\u0431-\u043a\u0430\u0440\u0442\u0435."]}),(0,c.jsxs)("div",{style:{margin:"10px 0",padding:"10px",backgroundColor:"#f8d7da",borderLeft:"4px solid #dc3545",color:"#721c24",fontSize:"0.9em"},children:[(0,c.jsx)("strong",{children:"\u041e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u043d\u043e:"})," \u041d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0439\u0442\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u044b \u0432 \u0431\u043e\u0442\u0435, \u0435\u0441\u043b\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435! \u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 ",(0,c.jsx)("code",{children:"/restart"})," \u0432 \u0431\u043e\u0442\u0435. \u0412 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u0431\u043e\u0442 \u043c\u043e\u0436\u0435\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432\u0430\u0448\u0443 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d\u043d\u0443\u044e \u0432 \u0432\u0435\u0431-\u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438."]})]}),(0,c.jsx)(RE,{title:"\ud83d\udd1d \u0412\u0435\u0440\u0445\u043d\u0435\u0435 \u043c\u0435\u043d\u044e",children:(0,c.jsxs)("p",{style:{margin:0},children:["- ",(0,c.jsx)("strong",{children:"\u26f6 \u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c:"})," \u0420\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440.",(0,c.jsx)("br",{}),"- ",(0,c.jsx)("strong",{children:"\u2195 \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0441\u0432\u0430\u0439\u043f\u043e\u0432:"})," \u0417\u0430\u0449\u0438\u0442\u0430 \u043e\u0442 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0445.",(0,c.jsx)("br",{}),"- ",(0,c.jsx)("strong",{children:"\u2610 \u041c\u0430\u0441\u0441\u043e\u0432\u043e\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435:"})," \u0420\u0435\u0436\u0438\u043c \u0432\u044b\u0431\u043e\u0440\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."]})}),(0,c.jsxs)(RE,{title:"\ud83e\udde9 \u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0438 \u0441\u0432\u044f\u0437\u044f\u043c\u0438",children:[(0,c.jsx)(RE,{title:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430",children:(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:"\u041f\u0440\u043e\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u0438\u043d\u0438\u044e \u043e\u0442 \u0442\u043e\u0447\u043a\u0438 \u0432\u043d\u0438\u0437\u0443 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0432 \u043f\u0443\u0441\u0442\u043e\u0435 \u043c\u0435\u0441\u0442\u043e."}),(0,c.jsx)("li",{children:'\u0418\u043b\u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u041f\u041a\u041c (\u0434\u043e\u043b\u0433\u043e\u0435 \u043d\u0430\u0436\u0430\u0442\u0438\u0435) \u043d\u0430 \u043f\u0443\u0441\u0442\u043e\u043c \u043c\u0435\u0441\u0442\u0435 -> "\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442".'})]})}),(0,c.jsxs)(RE,{title:"\u0421\u0432\u044f\u0437\u044b\u0432\u0430\u043d\u0438\u0435 (\u043f\u0435\u0440\u0435\u0445\u043e\u0434\u044b)",children:["\u0427\u0442\u043e\u0431\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0434\u0432\u0430 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u0438\u043d\u0438\u044e \u043e\u0442 \u043a\u0440\u0443\u0433\u043b\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 ",(0,c.jsx)("strong",{children:"\u0432\u043d\u0438\u0437\u0443"})," \u043e\u0434\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043a ",(0,c.jsx)("strong",{children:"\u0432\u0435\u0440\u0445\u043d\u0435\u0439 \u0447\u0430\u0441\u0442\u0438"})," \u0434\u0440\u0443\u0433\u043e\u0433\u043e."]})]}),(0,c.jsxs)(RE,{title:"\ud83d\udcda \u041a\u043d\u043e\u043f\u043a\u0438 \u0432 \u043c\u0435\u043d\u044e",children:[(0,c.jsx)(RE,{title:"\u041c\u0435\u043d\u044e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430",children:(0,c.jsxs)("ul",{style:{paddingLeft:"20px",margin:0},children:[(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"})," \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430. \u0422\u0443\u0442 \u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043c\u0435\u0434\u0438\u0430 \u0438\u043b\u0438 \u043a\u043d\u043e\u043f\u043e\u043a."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0420\u0435\u0434\u0430\u043a\u0442. \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"})," \u2014 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 (\u043d\u0443\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u0434\u0430, \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u043d\u0435 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f)."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0420\u0435\u0434\u0430\u043a\u0442. \u0422\u0435\u043a\u0441\u0442"})," \u2014 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u0442\u0435\u043a\u0441\u0442\u0430 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430. \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u043a\u043d\u043e\u043f\u043a\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0430\u0439\u043c\u0435\u0440\u043e\u0432, \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432 \u0438 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0432 \u0438\u043d\u0443\u044e \u0433\u043b\u0430\u0432\u0443."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c/\u0440\u0435\u0434\u0430\u043a\u0442. \u041c\u0435\u0434\u0438\u0430"})," \u2014 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c, \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u043b\u0438 \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 \u0438 \u0438\u043d\u044b\u0435 \u043c\u0435\u0434\u0438\u0430 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"})," \u2014 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})," \u2014 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e."]})]})}),(0,c.jsxs)(RE,{title:"\u041c\u0435\u043d\u044e \u0441\u0432\u044f\u0437\u0435\u0439",children:[(0,c.jsx)("p",{style:{marginTop:0,marginBottom:"10px"},children:"\u041c\u0435\u043d\u044e \u0441\u0432\u044f\u0437\u0435\u0439 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043d\u0430\u0436\u0430\u0442\u0438\u0438 \u043d\u0430 \u0442\u0435\u043a\u0441\u0442 \u0441\u0432\u044f\u0437\u0438 (\u044d\u0442\u043e\u0442 \u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u043d\u043e\u043f\u043a\u0430\u0445 \u043f\u0440\u0438 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438)."}),(0,c.jsxs)("ul",{style:{paddingLeft:"20px",margin:0},children:[(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"})," \u2014 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u0441\u0432\u044f\u0437\u0438 (\u043a\u043d\u043e\u043f\u043a\u0438)."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"})," \u2014 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0438 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u044b\u0431\u043e\u0440\u0430."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c"})," \u2014 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c/\u043a\u043d\u043e\u043f\u043a\u0443."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})," \u2014 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043c\u0435\u043d\u044e."]})]})]}),(0,c.jsxs)(RE,{title:"\u041c\u0435\u043d\u044e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f",children:[(0,c.jsx)("p",{style:{marginTop:0,marginBottom:"10px"},children:"\u042d\u0442\u043e \u043c\u0435\u043d\u044e \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043d\u0430\u0436\u0430\u0442\u0438\u0438 \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u043c\u044b\u0448\u0438, \u043b\u0438\u0431\u043e \u0434\u043e\u043b\u0433\u043e\u043c \u0442\u0430\u043f\u0435 \u043f\u0430\u043b\u044c\u0446\u0435\u043c \u043d\u0430 \u043b\u044e\u0431\u043e\u0435 \u043f\u0443\u0441\u0442\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e."}),(0,c.jsxs)("ul",{style:{paddingLeft:"20px",margin:0},children:[(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"})," \u2014 \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u043d\u043e\u0432\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443"})," \u2014 \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u043d\u043e\u0432\u0443\u044e \u0437\u0430\u043c\u0435\u0442\u043a\u0443 \u0432 \u044d\u0442\u043e\u043c \u043c\u0435\u0441\u0442\u0435."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})," \u2014 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e."]})]})]}),(0,c.jsxs)(RE,{title:"\u041c\u0435\u043d\u044e \u0437\u0430\u043c\u0435\u0442\u043e\u043a",children:[(0,c.jsx)("p",{style:{marginTop:0,marginBottom:"10px"},children:"\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043d\u0443\u0436\u043d\u044b \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u043d\u0438\u0445 \u043b\u044e\u0431\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043d\u0443\u0436\u043d\u0443\u044e \u0432\u0430\u043c \u0434\u043b\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f. \u0412 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0439 \u043e\u043d\u0438 \u043d\u0435 \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u044e\u0442 \u043d\u0438\u043a\u0430\u043a."}),(0,c.jsxs)("ul",{style:{paddingLeft:"20px",margin:0},children:[(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})," \u2014 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443."]}),(0,c.jsxs)("li",{style:{marginBottom:"6px"},children:[(0,c.jsx)("strong",{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})," \u2014 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})," \u2014 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e."]})]})]})]}),(0,c.jsxs)(RE,{title:"\ud83d\udcbe \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u0432 \u0438\u043d\u0443\u044e \u0433\u043b\u0430\u0432\u0443",children:[(0,c.jsxs)("p",{style:{marginTop:0},children:["1. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 ",(0,c.jsx)("strong",{children:"\u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439"})," \u043d\u0430 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442.",(0,c.jsx)("br",{}),"2. \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 ",(0,c.jsx)("strong",{children:'"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442. \u0442\u0435\u043a\u0441\u0442"'}),".",(0,c.jsx)("br",{}),"3. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 ",(0,c.jsx)("strong",{children:'"\u0421\u0435\u0439\u0432/\u0433\u043b\u0430\u0432\u044b"'})," \u0438 \u0432\u044b\u0441\u0442\u0430\u0432\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b."]}),(0,c.jsx)("div",{style:{padding:"10px",backgroundColor:"#e3f2fd",borderLeft:"4px solid #2196f3",color:"#0d47a1",fontSize:"0.9em"},children:"\u2139\ufe0f \u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430\u0445 \u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430\u0445 \u0432\u0441\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u0438 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u0438\u0433\u0440\u043e\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f."})]}),(0,c.jsx)(RE,{title:"\ud83d\ude80 \u041c\u0430\u0441\u0441\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",children:(0,c.jsxs)("p",{style:{margin:0},children:["\u0417\u0430\u0436\u043c\u0438\u0442\u0435 ",(0,c.jsx)("code",{children:"Shift"})," \u0438\u043b\u0438 ",(0,c.jsx)("code",{children:"Ctrl"})," \u0438 \u043a\u043b\u0438\u043a\u0430\u0439\u0442\u0435 \u043f\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c \u0434\u043b\u044f \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f. \u041b\u0438\u0431\u043e \u043d\u0430 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0435 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0440\u0435\u0436\u0438\u043c ",(0,c.jsx)("strong",{children:"\u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0433\u043e \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f"})," (\u0441\u043c. \u0432\u0435\u0440\u0445\u043d\u0435\u0435 \u043c\u0435\u043d\u044e).",(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),"\u0417\u0430\u0442\u0435\u043c \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u041f\u041a\u041c \u043d\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c, \u043b\u0438\u0431\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u043e\u043b\u0433\u0438\u0439 \u0442\u0430\u043f \u043f\u0430\u043b\u044c\u0446\u0435\u043c, \u0447\u0442\u043e\u0431\u044b \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u0438\u043b\u0438 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b."]})})]})]})},FE=()=>(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:0,height:0,pointerEvents:"none"},children:(0,c.jsx)("defs",{children:(0,c.jsx)("marker",{id:"global-arrow-blue",viewBox:"0 0 10 10",refX:"9",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",children:(0,c.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#2563eb"})})})}),PE=t=>{let{text:n}=t;const[r,o]=(0,e.useState)(!1),i=(0,e.useRef)(null),[a,s]=(0,e.useState)({}),[l,d]=(0,e.useState)({});(0,e.useLayoutEffect)(()=>{if(r&&i.current){const e=i.current.getBoundingClientRect(),t=250,n=10;let r=e.left+e.width/2-t/2;r<n&&(r=n),r+t>window.innerWidth-n&&(r=window.innerWidth-t-n);let o=e.bottom+10,a=!1;e.bottom+100>window.innerHeight&&(o=e.top-10,a=!0),s({position:"fixed",top:o,left:r,width:"".concat(t,"px"),transform:a?"translateY(-100%)":"none",zIndex:9999,background:"#333",border:"1px solid #555",color:"#ddd",padding:"10px",borderRadius:"6px",fontSize:"12px",lineHeight:"1.4",boxShadow:"0 4px 15px rgba(0,0,0,0.5)",fontWeight:"normal",textAlign:"left"});const l=e.left+e.width/2;d({position:"absolute",left:"".concat(l-r,"px"),top:a?"100%":"-6px",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:a?"6px solid #555":"none",borderBottom:a?"none":"6px solid #555",transform:"translateX(-50%)"})}},[r]);const u=(0,c.jsxs)("div",{style:a,onClick:e=>e.stopPropagation(),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[n,(0,c.jsx)("div",{style:l})]});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{ref:i,style:{position:"relative",display:"inline-block",marginLeft:"8px",verticalAlign:"middle"},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:e=>{e.stopPropagation(),o(!r)},children:(0,c.jsx)("div",{style:{width:"18px",height:"18px",borderRadius:"50%",border:"1px solid #aaa",color:"#aaa",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontStyle:"italic",fontFamily:"serif",cursor:"pointer",background:r?"#fff":"transparent",color:r?"#000":"#aaa"},children:"i"})}),r&&Mi.createPortal(u,document.body)]})};(new(Bl().graphlib.Graph)).setDefaultEdgeLabel(()=>({}));function BE(t){var n,r,o,i;let{realUserId:a}=t;const[l,d,u]=function(t){const[n,r]=(0,e.useState)(t),o=(0,e.useCallback)(e=>r(t=>va(e,t)),[]);return[n,r,o]}([]),[p,h,f]=function(t){const[n,r]=(0,e.useState)(t),o=(0,e.useCallback)(e=>r(t=>ya(e,t)),[]);return[n,r,o]}([]),[g,m]=(0,e.useState)(null),[v,y]=(0,e.useState)(null),[x,b]=(0,e.useState)(null),[w,S]=(0,e.useState)([]),[k,C]=(0,e.useState)({isOpen:!1,edge:null}),[j,_]=(0,e.useState)(!1),[E,D]=(0,e.useState)(!1),M=(0,e.useRef)(!1),[T,I]=(0,e.useState)(null),A=(0,e.useRef)(null),O=(0,e.useRef)(null),{screenToFlowPosition:R,getNodes:z}=Ta(),[F,P]=(0,e.useState)(null),B=(t=>{const[n,r]=(0,e.useState)(()=>window.matchMedia(t).matches);return(0,e.useEffect)(()=>{const e=window.matchMedia(t),n=e=>r(e.matches);return e.addEventListener("change",n),()=>{e.removeEventListener("change",n)}},[t]),n})("(max-width: 768px)"),[L,N]=(0,e.useState)(!1),[U,V]=(0,e.useState)(!1),[W,H]=(0,e.useState)(!1),[G,X]=(0,e.useState)(!0),[Y,q]=(0,e.useState)(!1),[Z,$]=(0,e.useState)(!1),[K,J]=(0,e.useState)("unknown"),[Q,ee]=(0,e.useState)(null),[te,ne]=(0,e.useState)(0),[re,oe]=(0,e.useState)(null),ie=(0,e.useCallback)((e,t)=>{d(n=>n.map(n=>{if(n.id===e){const e=s(s({},n.data.fragment),{},{media:t.media});return s(s({},n),{},{data:s(s({},n.data),{},{fragment:e,media:t.media})})}return n}))},[d]);(0,e.useLayoutEffect)(()=>{const e=document.createElement("style");return e.innerText=zk,document.head.appendChild(e),()=>{document.head.contains(e)&&document.head.removeChild(e)}},[]),(0,e.useEffect)(()=>{G?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")},[G]);(0,e.useEffect)(()=>{console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 Telegram ID:",a)},[a]),(0,e.useEffect)(()=>{var e;const t=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(t){var n;ee(t);const e=parseFloat(t.version||"0");ne(e),t.ready(),null===(n=t.expand)||void 0===n||n.call(t)}else console.log("\u0417\u0430\u043f\u0443\u0449\u0435\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u2014 Telegram API \u043e\u0442\u043a\u043b\u044e\u0447\u0451\u043d \u2757")},[]),(0,e.useEffect)(()=>{if(!Q)return;Q.ready(),Q.expand(),Q&&te>=8&&Q.checkHomeScreenStatus&&Q.checkHomeScreenStatus(e=>J(e));const e=()=>J("added");return Q.onEvent("homeScreenAdded",e),void 0!==Q.isFullscreen&&q(Q.isFullscreen),()=>{Q.offEvent("homeScreenAdded",e)}},[Q]);const ae={background:G?"#1f2937":"#fff",border:G?"1px solid #374151":"1px solid #ccc",color:G?"#f3f4f6":"#000",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",width:"40px",height:"40px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",padding:0,fontSize:"20px",lineHeight:1,transition:"all 0.2s"},se={background:G?"#1f2937":"#fff",border:G?"1px solid #374151":"1px solid #ccc",color:G?"#f3f4f6":"#000",borderRadius:"6px",padding:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",gap:"5px",transition:"background 0.3s, color 0.3s"},le=s(s({},ae),{},{background:"#e0f2fe",borderColor:"#2563eb",color:"#2563eb"});G&&(le.background="#1e3a8a",le.color="#60a5fa");const{userId:ce,storyId:de}=(0,e.useMemo)(()=>{const e=window.location.pathname,[t,n]=e.slice(1).split("_");return{userId:t,storyId:n}},[]),[ue,pe]=(0,e.useState)({isOpen:!1,sourceNodeId:null,position:null,defaultName:""});(0,e.useEffect)(()=>{!async function(){var e,t;const n=k.edge;if(k.isOpen&&null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&e.storyId&&null!==n&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.userId){const e=await Yl(n.data.userId,n.data.storyId);S(e)}}()},[k]),(0,e.useEffect)(()=>{var e,t,n;if(null!==(e=window.Telegram)&&void 0!==e&&null!==(t=e.WebApp)&&void 0!==t&&null!==(n=t.initDataUnsafe)&&void 0!==n&&n.user){const e=window.Telegram.WebApp.initDataUnsafe.user;console.log("\ud83d\udc64 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b WebApp:",e)}else console.warn("WebApp \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043d\u0435 \u0438\u0437 Telegram \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 initDataUnsafe")},[]);const he=(0,e.useCallback)(async e=>{if(!ce||!de||!e.length)return;const t=e.reduce((e,t)=>(e[t.id]=t.position,e),{});try{await fetch("/api/story/".concat(ce,"/").concat(de,"/positions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),console.log("\u2705 \u041f\u043e\u0437\u0438\u0446\u0438\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435")}catch(n){console.error("\u0421\u0435\u0442\u0435\u0432\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u043e\u0437\u0438\u0446\u0438\u0439:",n)}},[ce,de]),fe=(0,e.useMemo)(()=>function(e,t){let n;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];const a=this;clearTimeout(n),n=setTimeout(()=>e.apply(a,o),t)}}(e=>{he(e)},2e3),[he]);(0,e.useEffect)(()=>{(async()=>{if(ce&&de)try{const[e,t,n]=await Promise.all([fetch("/api/story/".concat(ce,"/").concat(de)),fetch("/api/story/".concat(ce,"/").concat(de,"/positions")),Zl(ce,de)]),r=await e.json();if(r.error)throw new Error(r.error);let o={};t.ok&&(o=await t.json());const{nodes:i,edges:a}=AE(r,n,o),l=i.map(e=>"custom"===e.type?s(s({},e),{},{data:s(s({},e.data),{},{userId:ce,storyId:de,updateNodeInternal:ie})}):e),c=OE(a);d(l),h(c)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445:",e),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u043b\u0438 \u0435\u0435 \u043a\u0430\u0440\u0442\u0443.")}})()},[ce,de,d,h,ie]),(0,e.useEffect)(()=>{var e;const t=null===(e=A.current)||void 0===e?void 0:e.querySelector(".react-flow__renderer"),n=e=>{if(e.target.classList.contains("react-flow__pane"))return;const t=z().filter(e=>e.selected);t.length>1&&(e.preventDefault(),m(null),I(null),y(null),b(null),P({top:e.clientY,left:e.clientX,nodes:t}))};return null===t||void 0===t||t.addEventListener("contextmenu",n),()=>null===t||void 0===t?void 0:t.removeEventListener("contextmenu",n)},[z]);const ge=(0,e.useCallback)((e,t)=>{let{nodeId:n}=t;O.current=n,M.current=!1},[]),me=(0,e.useCallback)(async e=>{if(!e.source||!e.target)return;M.current=!0;const t=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0434\u043b\u044f \u043a\u043d\u043e\u043f\u043a\u0438 \u044d\u0442\u043e\u0433\u043e \u0432\u044b\u0431\u043e\u0440\u0430:");if(t)try{let n;await async function(e,t,n,r,o){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:n,target:r,text:o})});return await i.json()}(ce,de,e.source,e.target,t),d(r=>r.map(r=>{if(r.id===e.source){const o={target:e.target,text:t,effects:[]};n=r.data.fragment.choices?r.data.fragment.choices.length:0;const i=r.data.fragment.choices?[...r.data.fragment.choices,o]:[o];return s(s({},r),{},{data:s(s({},r.data),{},{fragment:s(s({},r.data.fragment),{},{choices:i})})})}return r}));const r=p.some(t=>t.source===e.target&&t.target===e.source);let o=0;r&&(o=e.source<e.target?-20:20,h(t=>t.map(t=>t.source===e.target&&t.target===e.source?s(s({},t),{},{data:s(s({},t.data),{},{offsetY:e.source<e.target?20:-20})}):t)));const i={id:"".concat(e.source,"->").concat(e.target,"_").concat(n),source:e.source,target:e.target,type:"custom",animated:!1,style:{stroke:"#2563eb"},data:{text:t,effectsText:"",originalEffects:[],choiceIndex:n,offsetY:o}};h(e=>{const t=e.concat(i);return OE(t)})}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u0432\u044f\u0437\u0438: ".concat(n.message))}},[ce,de,h,d,p]),ve=(0,e.useCallback)(e=>{var t;if(M.current)return void(M.current=!1);const n=O.current;if(O.current=null,!n)return;let r=e.clientX,o=e.clientY;if("touchend"===e.type&&(null===(t=e.changedTouches)||void 0===t?void 0:t.length)>0&&(r=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY),"number"!==typeof r||"number"!==typeof o)return;const i=new Set(z().map(e=>e.id)),{id:a}=IE(n,i);pe({isOpen:!0,sourceNodeId:n,position:R({x:r,y:o}),defaultName:a||""})},[R,z,IE]),ye=(0,e.useCallback)((e,t,n)=>{const r=z();fe(r)},[z,fe]),xe=(0,e.useCallback)(async e=>{const t=e.filter(e=>"note"!==e.type);if(0===t.length)return void P(null);const n=t.map(e=>e.id);if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ".concat(n.length," \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442(\u0430)? \u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e.")))try{await async function(e,t,n){return(await fetch("/api/story/".concat(e,"/").concat(t,"/fragments/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fragment_ids:n})})).ok}(ce,de,n),d(e=>e.filter(e=>!n.includes(e.id))),h(e=>e.filter(e=>!n.includes(e.source)&&!n.includes(e.target))),console.log("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u043e ".concat(n.length," \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."))}catch(r){alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0433\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f:",r)}finally{P(null)}},[ce,de,d,h]),be=(0,e.useCallback)(()=>{m(null),y(null),b(null),I(null),P(null)},[]),we=(0,e.useCallback)(e=>{oe(e||[]),console.log("\u042d\u0444\u0444\u0435\u043a\u0442\u044b \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u044b:",e),be()},[be]),Se=(0,e.useCallback)(async e=>{if(re)try{await $l(ce,de,e.source,e.data.choiceIndex,{effects:re});const t=re.length?re.map(e=>"".concat(e.stat,": ").concat(e.value)).join(", "):"";h(n=>n.map(n=>n.id===e.id?s(s({},n),{},{data:s(s({},n.data),{},{originalEffects:[...re],effectsText:t})}):n)),be()}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u0441\u0442\u0430\u0432\u043a\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ".concat(t.message))}},[re,ce,de,h,be]),ke=(0,e.useCallback)(e=>{const t=(e=>{if(!e||0===e.length)return"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u0447\u0435\u0442\u0430.";const t=new Set(e.map(e=>e.id)),n=new Map(e.map(e=>[e.id,e])),r=new Set;e.forEach(e=>{var n;null===(n=e.data.fragment.choices)||void 0===n||n.forEach(e=>{t.has(e.target)&&r.add(e.target)})});const o=e.filter(e=>!r.has(e.id)),i=[],a=(e,r)=>{var o;const s=(null===(o=n.get(e).data.fragment.choices)||void 0===o?void 0:o.filter(e=>t.has(e.target)))||[];0!==s.length?s.forEach(t=>{a(t.target,[...r,e])}):i.push([...r,e])};o.forEach(e=>a(e.id,[]));let s="\u26a0\ufe0f \u0415\u0441\u043b\u0438 \u0432\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u043b\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u044b, \u0442\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0441\u0447\u0451\u0442\u0430.\n\n";return i.forEach((e,t)=>{const r={};for(let i=0;i<e.length;i++){const t=e[i],o=n.get(t);if(EE(r,o.data.fragment.effects),i<e.length-1){const t=e[i+1],n=o.data.fragment.choices.find(e=>e.target===t);n&&EE(r,n.effects)}}s+="".concat(t+1,'. "').concat(e.join(" -> "),'"\n\u042d\u0444\u0444\u0435\u043a\u0442\u044b:\n');const o=Object.keys(r);0===o.length?s+="- (\u043d\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432)\n":o.forEach(e=>{const{min:t,max:n}=r[e],o=t===n?t:"".concat(t," - ").concat(n);s+="  - ".concat(e,": ").concat(o,"\n")}),s+="\n"}),0===i.length?"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0446\u0435\u043f\u043e\u0447\u0435\u043a \u043c\u0435\u0436\u0434\u0443 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438. \u041a\u0430\u0436\u0434\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d.":s})(e);alert(t),P(null)},[]),Ce=(0,e.useCallback)((e,t)=>{e.preventDefault();const n=z().filter(e=>e.selected);n.length>1?n.find(e=>e.id===t.id)&&(m(null),I(null),P({top:e.clientY,left:e.clientX,nodes:n})):(P(null),"note"===t.type?I({id:t.id,node:t,top:e.clientY,left:e.clientX}):m({id:t.id,top:e.clientY,left:e.clientX,node:t}))},[z,m,I,P]),je=(0,e.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),y({id:t.id,top:e.clientY,left:e.clientX,edge:t})},[y]),_e=(0,e.useCallback)(()=>{be()},[be]),Ee=(0,e.useCallback)(()=>{be()},[be]),De=(0,e.useCallback)(e=>{e.preventDefault(),be(),b({top:e.clientY,left:e.clientX,flowPosition:R({x:e.clientX,y:e.clientY})})},[R,be]),Me=(0,e.useCallback)(async e=>{let t=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0421\u0446\u0435\u043d\u0430_1):");if(!t)return;const n=new Set(z().map(e=>e.id)),{id:r,error:o}=IE(t.trim(),n,!0);if(o)alert(o);else try{const{story:t}=await async function(e,t,n){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/create_fragment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newName:n})});if(!r.ok){const{error:e}=await r.json();throw new Error(e)}return await r.json()}(ce,de,r),n=t.fragments[r];if(!n)throw new Error("\u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u0432\u0435\u0440\u043d\u0443\u043b \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.");const o={id:r,type:"custom",position:e,data:{label:"".concat(r,"\n(\u043f\u0443\u0441\u0442\u043e)"),bgColor:TE(r,n),media:[],fragment:n,userId:ce,storyId:de,updateNodeInternal:ie}};d(e=>{const t=e.concat(o);return fe(t),t})}catch(i){i.response?i.response.json().then(e=>{alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(e.error||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"))}).catch(()=>{alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(i.message))}):alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430: ".concat(i.message)),console.error(i)}},[ce,de,z,d,fe,IE,ie]),Te=(0,e.useCallback)(async(e,t)=>{const{sourceNodeId:n,position:r}=ue;if(!n||!r||!e||!t)throw new Error("\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.");try{const{story:o}=await async function(e,t,n,r,o){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/create_and_connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:n,newName:r,choiceText:o})});if(!i.ok){const{error:e}=await i.json();throw new Error(e)}return await i.json()}(ce,de,n,e,t),i=o.fragments[n].choices.findIndex(t=>t.target===e);if(-1===i)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0432\u044b\u0431\u043e\u0440 \u0432 \u043e\u0442\u0432\u0435\u0442\u0435 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.");const a={id:e,type:"custom",position:r,data:{label:"".concat(e,"\n(\u043f\u0443\u0441\u0442\u043e)"),bgColor:"#fecaca",media:[],fragment:o.fragments[e],userId:ce,storyId:de,updateNodeInternal:ie}},l={id:"".concat(n,"->").concat(e,"_").concat(i),source:n,target:e,type:"custom",animated:!1,style:{stroke:"#2563eb"},data:{text:t,effectsText:"",originalEffects:[],choiceIndex:i}};d(e=>{const t=e.map(e=>{if(e.id===n){const t=o.fragments[n],r=(t.media||[]).reduce((e,t)=>{let{type:n}=t;return s(s({},e),{},{[n]:(e[n]||0)+1})},{}),i=Object.entries(r).map(e=>{let[t,n]=e;return"".concat(n," ").concat(ME(t))}).join(", "),a=[n,t.text||"(\u043f\u0443\u0441\u0442\u043e)",i&&"\ud83d\udcce ".concat(i)].filter(Boolean).join("\n");return s(s({},e),{},{data:s(s({},e.data),{},{fragment:t,label:a,bgColor:TE(n,t)})})}return e}),r=[...t,a];return fe(r),r}),h(e=>{const t=e.concat(l);return OE(t)}),pe({isOpen:!1,sourceNodeId:null,position:null,defaultName:""})}catch(o){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 API \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:",o),o}},[ce,de,d,h,fe,ue]),Ie=(0,e.useCallback)(async e=>{try{const{status:t,bookmark:n}=await async function(e,t,n,r){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,position:r})});if(!o.ok){const{error:e}=await o.json();throw new Error(e||"Server error")}return await o.json()}(ce,de,"(\u043f\u0443\u0441\u0442\u043e)",e);if("ok"!==t||!n)throw new Error("\u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u0432\u0435\u0440\u043d\u0443\u043b \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0437\u0430\u043c\u0435\u0442\u043a\u0435.");{const e={id:n.id,type:"note",position:n.position,data:{text:n.text},draggable:!0,selectable:!0};d(t=>{const n=t.concat(e);return fe(n),n}),I({node:e,top:window.innerHeight/2,left:window.innerWidth/2,autoOpenEditor:!0})}}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(t.message))}},[ce,de,d,fe]),Ae=(0,e.useCallback)(async e=>{const{edge:t}=k;if(t){console.log("Saving effects for:",t.data.userId,t.data.storyId);try{await $l(ce,de,t.source,t.data.choiceIndex,{effects:e}),h(n=>n.map(n=>{if(n.id===t.id){const t=e.length?e.map(e=>"".concat(e.stat,": ").concat(e.value)).join(", "):"";return s(s({},n),{},{data:s(s({},n.data),{},{originalEffects:e,effectsText:t})})}return n})),C({isOpen:!1,edge:null})}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ".concat(n.message))}}},[k,ce,de,h]),Oe=(0,e.useMemo)(()=>({custom:Kl,note:Ql}),[]),Re=(0,e.useMemo)(()=>({custom:Ul}),[]),ze=(0,e.useRef)(null),Fe=(0,e.useCallback)((e,t)=>{ze.current&&(t.zoom<.7?ze.current.classList.add("zoomed-out"):ze.current.classList.remove("zoomed-out"))},[]);return(0,c.jsxs)("div",{ref:ze,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:G?"#121212":"#ffffff",touchAction:L?"none":"pan-y",WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},ref:A,onContextMenu:e=>e.preventDefault(),className:"react-flow-wrapper",children:[(0,c.jsxs)("div",{style:{position:"absolute",top:Y?90:10,left:10,zIndex:200,display:"flex",alignItems:"center",gap:"2px",transition:"top 0.3s ease"},children:[(0,c.jsx)("button",{onClick:()=>{const e=window.location.pathname.split("_")[0].replace("/","");window.location.href="/".concat(e)},style:{background:"#10b981",border:"none",borderRadius:"8px 0 0 8px",color:"white",cursor:"pointer",width:"40px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",fontWeight:"bold",zIndex:2},title:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0441\u043f\u0438\u0441\u043a\u0443",children:"\u2630"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",overflow:"hidden",maxWidth:U?"350px":"0px",paddingLeft:U?"8px":"0px",paddingRight:U?"8px":"0px",opacity:U?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:"40px"},children:[(0,c.jsx)("button",{onClick:()=>X(!G),style:ae,title:G?"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0432\u0435\u0442\u043b\u0443\u044e \u0442\u0435\u043c\u0443":"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0451\u043c\u043d\u0443\u044e \u0442\u0435\u043c\u0443",children:G?"\u2600":"\ud83c\udf19"}),(null===Q||void 0===Q?void 0:Q.requestFullscreen)&&(0,c.jsx)("button",{onClick:()=>{Q&&(Y?Q.exitFullscreen&&Q.exitFullscreen():Q.requestFullscreen&&Q.requestFullscreen(),q(!Y))},style:Y?le:ae,title:"\u041d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d",children:Y?"\u2715":"\u26f6"}),B&&(null===Q||void 0===Q?void 0:Q.disableVerticalSwipes)&&(0,c.jsx)("button",{onClick:()=>{Q&&(Z?(Q.enableVerticalSwipes&&Q.enableVerticalSwipes(),$(!1)):(Q.disableVerticalSwipes&&Q.disableVerticalSwipes(),$(!0)))},style:Z?le:ae,title:Z?"\u0421\u0432\u0430\u0439\u043f\u044b \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u044b":"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u0430\u0439\u043f\u044b",children:(0,c.jsxs)("div",{style:{position:"relative"},children:[(0,c.jsx)("span",{children:"\u2195"}),Z&&(0,c.jsx)("div",{style:{position:"absolute",top:"50%",left:"-2px",right:"-2px",height:"2px",background:"#2563eb",transform:"rotate(-45deg)"}})]})}),(0,c.jsx)("button",{onClick:()=>N(!L),style:L?le:ae,title:"\u0420\u0435\u0436\u0438\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f",children:(0,c.jsx)("span",{style:{fontSize:"22px",fontWeight:"bold"},children:L?"\u2611":"\u2610"})})]}),(0,c.jsx)("button",{onClick:()=>V(!U),style:{background:"#10b981",border:"none",color:"white",width:"32px",height:"40px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"0.25s",borderRadius:"0 8px 8px 0"},title:"\u0421\u043a\u0440\u044b\u0442\u044c/\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044e",children:U?"\u25c0":"\u25b6"})]}),(0,c.jsxs)(ll,{nodes:l,edges:p,onNodesChange:u,onEdgesChange:f,nodeTypes:Oe,edgeTypes:Re,onConnect:me,onConnectStart:ge,onConnectEnd:ve,onPaneClick:Ee,onPaneContextMenu:De,onNodeDragStop:ye,onNodeClick:Ce,onNodeContextMenu:Ce,onEdgeClick:je,onEdgeContextMenu:je,onMoveStart:_e,fitView:!0,minZoom:.1,maxZoom:2,connectionRadius:70,panOnScroll:!1,panOnDrag:!L,zoomOnPinch:!L,zoomOnScroll:!L,zoomOnDoubleClick:!L,selectionOnDrag:L,selectionMode:Cr.Partial,onMove:Fe,children:[(0,c.jsx)(FE,{})," ",(0,c.jsx)(_l,{}),(0,c.jsxs)("div",{style:{position:"absolute",bottom:10,right:10,zIndex:100,display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",overflow:"hidden",maxHeight:W?"150px":"0px",opacity:W?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",marginBottom:W?"8px":"0px",width:"140px"},children:[(0,c.jsxs)("button",{onClick:()=>window.location.href="/".concat(ce,"_").concat(de,"/html"),style:se,children:["HTML Editor",(0,c.jsx)(PE,{text:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440. \u041d\u0443\u0436\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0435 \u043e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0432\u0430\u0448\u0443 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u0433\u0440\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0435\u0439 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (\u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u0435\u0440\u0435\u043f\u0430\u043a\u043e\u0432\u0430\u0442\u044c \u0432 .exe, .apk \u0438 \u043f\u0440\u043e\u0447\u0435\u0435). \u0415\u0441\u043b\u0438 \u0432\u0430\u0448\u0430 \u0446\u0435\u043b\u044c - \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u0435 \u0442\u043e \u044d\u0442\u043e\u0442 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u0432\u0430\u043c \u041d\u0415 \u043d\u0443\u0436\u0435\u043d"})]}),(0,c.jsx)("button",{onClick:()=>_(!j),style:se,children:j?"\u0421\u043a\u0440\u044b\u0442\u044c \u043a\u0430\u0440\u0442\u0443":"\u041c\u0438\u043d\u0438\u043a\u0430\u0440\u0442\u0430"}),(0,c.jsx)("button",{onClick:()=>D(!0),style:se,children:"\u041f\u043e\u043c\u043e\u0449\u044c"})]}),(0,c.jsx)("button",{onClick:()=>H(!W),style:{width:"140px",height:"24px",background:"#10b981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",marginBottom:"5px",transition:"background 0.2s"},children:W?"\u25bc":"\u25b2"}),(0,c.jsx)("button",{onClick:()=>window.open("https://t.me/FoxNovel_bot?start=".concat(de),"_blank"),style:{padding:"8px 14px",fontSize:"16px",fontWeight:"bold",borderRadius:"6px",background:"#10b981",color:"white",border:"none",cursor:"pointer",width:"140px",height:"40px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"\u25b6 \u0418\u0433\u0440\u0430\u0442\u044c"})]}),(0,c.jsx)(vl,{variant:"dots",gap:20,size:1,color:G?"#525252":"#e5e7eb",bgColor:G?"#121212":"#ffffff"}),j&&(0,c.jsx)(zl,{nodeColor:e=>e.data.bgColor,pannable:!0,zoomable:!0,style:{position:"absolute",top:10,right:10,width:B?150:200,height:B?100:150,borderRadius:8,background:"rgba(255,255,255,0.95)",boxShadow:"0 4px 10px rgba(0,0,0,0.15)",zIndex:120}}),g&&(0,c.jsx)(X_,s({onClick:Ee,setNodes:d,setEdges:h},g)),v&&(0,c.jsx)(Z_,s(s({},v),{},{userId:ce,storyId:de,onClick:()=>y(null),onEditEffects:()=>{C({isOpen:!0,edge:s(s({},v.edge),{},{data:s(s({},v.edge.data),{},{userId:ce,storyId:de})})}),y(null)},setEdges:h,onCopyEffects:we,onPasteEffects:Se,hasCopiedEffects:null!==re})),x&&(0,c.jsx)($_,s(s({},x),{},{onClose:()=>b(null),onCreateFragment:()=>Me(x.flowPosition),onAddNote:()=>Ie(x.flowPosition)})),T&&(0,c.jsx)(Gk,{node:T.node,setNodes:d,onClose:()=>I(null),top:T.top,left:T.left,autoOpenEditor:T.autoOpenEditor}),F&&(0,c.jsx)(_E,{top:F.top,left:F.left,nodes:F.nodes,onClose:()=>P(null),onDeleteAll:xe,onCalculate:ke})]}),(0,c.jsx)(jE,{isOpen:k.isOpen,edge:k.edge,onClose:()=>C({isOpen:!1,edge:null}),onSave:Ae,availableStats:w}),(0,c.jsx)(q_,{isOpen:ue.isOpen,onClose:()=>pe({isOpen:!1,sourceNodeId:null,position:null,defaultName:""}),onSubmit:Te,sourceNodeName:ue.sourceNodeId,defaultName:ue.defaultName,generateUniqueFragmentId:IE,existingIds:new Set(z().map(e=>e.id)),sourceHasNoBtn:(null===(n=l.find(e=>e.id===ue.sourceNodeId))||void 0===n||null===(r=n.data)||void 0===r||null===(o=r.fragment)||void 0===o||null===(i=o.choices)||void 0===i?void 0:i.some(e=>"{No_btn}"===e.text))||!1}),E&&(0,c.jsx)(zE,{onClose:()=>D(!1)})]})}const LE=function(e){return(0,c.jsx)(il,{children:(0,c.jsx)(BE,s({},e))})},NE={fontSize:"11px",background:"#333",padding:"2px 6px",borderRadius:"4px",color:"#aaa",border:"1px solid #444"},UE={padding:"8px 16px",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"opacity 0.2s"},VE={position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},WE={background:"#2b2b2b",width:"90%",maxWidth:"500px",padding:"25px",borderRadius:"12px",color:"#fff"},HE={display:"block",marginBottom:"15px",color:"#aaa",fontSize:"14px"},GE={width:"100%",padding:"10px",marginTop:"5px",borderRadius:"6px",border:"1px solid #444",background:"#1e1e1e",color:"#fff",fontSize:"14px"},XE=()=>{const t=(()=>{const e=window.location.pathname,t=e.split("_");return t.length>0&&t[0].length>1?t[0].replace("/",""):e.replace("/","")})(),n="6217936347"===t,[r,o]=(0,e.useState)([]),[i,a]=(0,e.useState)(!0),[l,d]=(0,e.useState)(null),[u,p]=(0,e.useState)(!1),[h,f]=(0,e.useState)([]),[g,m]=(0,e.useState)({storyId:"",title:"",description:"",modes:{logic:!0,visual:!0}});(0,e.useEffect)(()=>{v()},[]);const v=async()=>{try{const e=await async function(){const e=await fetch("/api/tutorials");if(!e.ok)throw new Error("Failed to fetch tutorials");return await e.json()}();o(e)}catch(e){console.error("Error loading tutorials:",e)}finally{a(!1)}},y=async e=>{if(window.confirm('\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e "'.concat(e.title,'" \u0432 \u0432\u0430\u0448 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u0442\u043e\u0440\u0438\u0439 \u0434\u043b\u044f \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f?'))){d(e.id);try{const n=await async function(e,t){const n=await fetch("/api/tutorials/clone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,tutorial_id:t})});if(!n.ok)throw new Error("Failed to clone tutorial");return await n.json()}(t,e.id);"ok"===n.status&&alert('\u2705 \u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430! \u0422\u0435\u043f\u0435\u0440\u044c \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0430\u0439\u0442\u0438 "'.concat(e.title,'" \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0435 "\u041c\u043e\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438".'))}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438: "+n.message)}finally{d(null)}}},x=async e=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0442\u0443\u0442\u043e\u0440\u0438\u0430\u043b \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430? (\u0421\u0430\u043c\u0430 \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043d\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u0441\u044f)")){d(e);try{await async function(e,t){const n=await fetch("/api/tutorials/".concat(t,"?admin_id=").concat(e),{method:"DELETE"});if(!n.ok)throw new Error("Failed to delete");return await n.json()}(t,e),o(t=>t.filter(t=>t.id!==e))}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f: "+n.message)}finally{d(null)}}};return i?(0,c.jsx)("div",{style:{padding:20,textAlign:"center"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f..."}):(0,c.jsxs)("div",{style:{padding:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{style:{margin:0,color:"#fff"},children:"\ud83c\udf93 \u041a\u0430\u0442\u0430\u043b\u043e\u0433 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f"}),(0,c.jsx)("p",{style:{margin:"5px 0 0 0",color:"#aaa",fontSize:"14px"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0435\u043c\u0443, \u0438 \u043a\u043e\u043f\u0438\u044f \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432 \u0432\u0430\u0448 \u043b\u0438\u0447\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a."})]}),n&&(0,c.jsx)("button",{onClick:async()=>{if(p(!0),0===h.length)try{const e=await Vl(t);f(e),e.length>0&&m(t=>s(s({},t),{},{storyId:e[0].id,title:e[0].title}))}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432\u0430\u0448\u0438\u0445 \u0438\u0441\u0442\u043e\u0440\u0438\u0439")}},style:{background:"#28a745",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0440\u043e\u043a"})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:[r.map(e=>{var t,r;return(0,c.jsxs)("div",{style:{background:"#2a2a2a",borderRadius:"12px",border:"1px solid #333",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{padding:"20px",flex:1},children:[(0,c.jsx)("h4",{style:{margin:"0 0 10px 0",fontSize:"18px",color:"#fff"},children:e.title}),(0,c.jsx)("p",{style:{color:"#ccc",fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:e.description||"\u0411\u0435\u0437 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f"}),(0,c.jsxs)("div",{style:{marginTop:"15px",display:"flex",gap:"10px"},children:[(null===(t=e.modes)||void 0===t?void 0:t.logic)&&(0,c.jsx)("span",{style:NE,children:"\ud83d\udee0 \u041b\u043e\u0433\u0438\u043a\u0430"}),(null===(r=e.modes)||void 0===r?void 0:r.visual)&&(0,c.jsx)("span",{style:NE,children:"\ud83c\udfa8 \u0412\u0438\u0437\u0443\u0430\u043b"})]})]}),(0,c.jsxs)("div",{style:{background:"#232323",padding:"15px",borderTop:"1px solid #333",display:"flex",gap:"10px",justifyContent:"flex-end"},children:[n&&(0,c.jsx)("button",{onClick:()=>x(e.id),disabled:l===e.id,style:s(s({},UE),{},{background:"transparent",border:"1px solid #d9534f",color:"#d9534f"}),children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),(0,c.jsx)("button",{onClick:()=>y(e),disabled:l===e.id,style:s(s({},UE),{},{background:"#007bff",color:"white",flex:1}),children:l===e.id?"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435...":"\ud83d\udce5 \u041d\u0430\u0447\u0430\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435"})]})]},e.id)}),0===r.length&&(0,c.jsx)("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",color:"#666"},children:"\u0423\u0440\u043e\u043a\u043e\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442, \u043d\u043e \u043e\u043d\u0438 \u0441\u043a\u043e\u0440\u043e \u043f\u043e\u044f\u0432\u044f\u0442\u0441\u044f."})]}),u&&(0,c.jsx)("div",{style:VE,children:(0,c.jsxs)("div",{style:WE,children:[(0,c.jsx)("h2",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0440\u043e\u043a"}),(0,c.jsxs)("label",{style:HE,children:["\u0418\u0441\u0445\u043e\u0434\u043d\u0430\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u044f:",(0,c.jsx)("select",{style:GE,value:g.storyId,onChange:e=>{const t=h.find(t=>t.id===e.target.value);m(s(s({},g),{},{storyId:e.target.value,title:(null===t||void 0===t?void 0:t.title)||""}))},children:h.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.title," (ID: ",e.id,")"]},e.id))})]}),(0,c.jsxs)("label",{style:HE,children:["\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0434\u043b\u044f \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430:",(0,c.jsx)("input",{style:GE,value:g.title,onChange:e=>m(s(s({},g),{},{title:e.target.value}))})]}),(0,c.jsxs)("label",{style:HE,children:["\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 (\u0447\u0435\u043c\u0443 \u043d\u0430\u0443\u0447\u0438\u0442):",(0,c.jsx)("textarea",{style:s(s({},GE),{},{minHeight:"80px",resize:"vertical"}),value:g.description,onChange:e=>m(s(s({},g),{},{description:e.target.value}))})]}),(0,c.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,c.jsx)("p",{style:{marginBottom:"5px",color:"#aaa"},children:"\u0427\u0442\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0443\u0440\u043e\u043a?"}),(0,c.jsxs)("label",{style:{marginRight:"15px",color:"white",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:g.modes.logic,onChange:e=>m(s(s({},g),{},{modes:s(s({},g.modes),{},{logic:e.target.checked})}))})," \u041b\u043e\u0433\u0438\u043a\u0430 (Nodes)"]}),(0,c.jsxs)("label",{style:{color:"white",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:g.modes.visual,onChange:e=>m(s(s({},g),{},{modes:s(s({},g.modes),{},{visual:e.target.checked})}))})," \u0412\u0438\u0437\u0443\u0430\u043b (HTML)"]})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,c.jsx)("button",{onClick:()=>p(!1),style:s(s({},UE),{},{background:"#444"}),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:async()=>{if(!g.storyId||!g.title)return alert("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438 \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435");try{await async function(e,t,n,r,o){const i=await fetch("/api/tutorials/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({admin_id:e,story_id:t,title:n,description:r,modes:o})});if(!i.ok)throw new Error("Failed to publish");return await i.json()}(t,g.storyId,g.title,g.description,g.modes),p(!1),m({storyId:"",title:"",description:"",modes:{logic:!0,visual:!0}}),v()}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438: "+e.message)}},style:s(s({},UE),{},{background:"#28a745"}),children:"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c"})]})]})})]})},YE=()=>(0,c.jsxs)("div",{className:"info-block",children:[(0,c.jsx)("h3",{children:"\u2753 FAQ"}),(0,c.jsx)("p",{children:"\u041e\u0442\u0432\u0435\u0442\u044b \u043d\u0430 \u0447\u0430\u0441\u0442\u043e \u0437\u0430\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u044b."}),(0,c.jsxs)("details",{style:{background:"#333",padding:"12px",borderRadius:"8px",marginBottom:"10px"},children:[(0,c.jsx)("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"\u041a\u0430\u043a \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0438\u0433\u0440\u0443 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0439?"}),(0,c.jsx)("p",{style:{marginTop:"10px",fontSize:"14px",color:"#ccc",lineHeight:"1.4"},children:'\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 "\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f" \u0432 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0438 \u043f\u043e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0433\u0430\u043b\u043e\u0447\u043a\u0443 "\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0439".'})]}),(0,c.jsxs)("details",{style:{background:"#333",padding:"12px",borderRadius:"8px"},children:[(0,c.jsx)("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"\u0412 \u0447\u0435\u043c \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u043e\u0432?"}),(0,c.jsxs)("p",{style:{marginTop:"10px",fontSize:"14px",color:"#ccc",lineHeight:"1.4"},children:[(0,c.jsx)("strong",{children:"\u041b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439:"})," \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0442\u0435\u043a\u0441\u0442 \u0438 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0441\u044e\u0436\u0435\u0442\u0430 (Telegram \u0431\u043e\u0442\u044b).",(0,c.jsx)("br",{}),(0,c.jsx)("strong",{children:"\u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439:"})," \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a\u0443, \u043c\u0443\u0437\u044b\u043a\u0443 \u0438 \u0441\u043e\u0437\u0434\u0430\u0442\u044c Web-\u043d\u043e\u0432\u0435\u043b\u043b\u0443."]})]})]}),qE=()=>(0,c.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,c.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),ZE=()=>(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("path",{d:"M22 2L11 13"}),(0,c.jsx)("path",{d:"M22 2L15 22L11 13L2 9L22 2z"})]}),$E=()=>(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,c.jsx)("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),(0,c.jsx)("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),KE=()=>(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,c.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),JE=()=>(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,c.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,c.jsx)("polyline",{points:"21 15 16 10 5 21"})]}),QE=e=>{let{active:t,label:n,onClick:r}=e;return(0,c.jsx)("button",{onClick:r,style:{flex:1,padding:"12px",background:t?"#2b2b2b":"transparent",border:"none",borderBottom:t?"2px solid #007bff":"2px solid transparent",color:t?"#fff":"#888",cursor:"pointer",fontWeight:t?"bold":"normal",transition:"all 0.3s"},children:n})},eD=e=>{let{title:t,tooltip:n}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",marginTop:"15px",color:"#aaa",fontSize:"12px",textTransform:"uppercase",letterSpacing:"1px"},children:[(0,c.jsx)("span",{children:t}),n&&(0,c.jsx)(PE,{text:n})]})},tD=t=>{let{userId:n}=t;const[r,o]=(0,e.useState)("stories"),[i,a]=(0,e.useState)(!1),[l,d]=(0,e.useState)(!0),[u,p]=(0,e.useState)([]),[h,f]=(0,e.useState)(!0),[g,m]=(0,e.useState)(null),[v,y]=(0,e.useState)([]),[x,b]=(0,e.useState)(null),[w,S]=(0,e.useState)(!1),[k,C]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{const e=new URLSearchParams(window.location.search).get("secret"),t=localStorage.getItem("secret_".concat(n)),r=e||t;if(!r)return d(!1),void a(!1);const o=await async function(e,t){try{const n=await fetch("/api/auth/validate_access",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,secret_key:t})});return!!n.ok&&!0===(await n.json()).valid}catch(n){return console.error("Auth check failed:",n),!1}}(n,r);if(o){if(e){localStorage.setItem("secret_".concat(n),e);const t=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({path:t},"",t)}a(!0)}else a(!1);d(!1)})()},[n]),(0,e.useEffect)(()=>{if(!i||l)return;if("stories"!==r)return;(async()=>{try{f(!0);const e=await Vl(n);p(e),m(null)}catch(e){m(e.message)}finally{f(!1)}})()},[n,i,l,r]);const j=()=>C(null),_=e=>{navigator.clipboard.writeText(e)};return l?(0,c.jsx)("div",{className:"loading-screen",children:"\ud83d\udd10 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430..."}):i?(0,c.jsxs)("div",{className:"app-container",children:[(0,c.jsx)("style",{children:'\n            /* \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u044f \u0431\u0435\u043b\u043e\u0433\u043e \u0444\u043e\u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b */\n            body {\n                background-color: #1e1e1e;\n                margin: 0;\n            }\n\n            .app-container {\n                max-width: 800px;\n                margin: 0 auto;\n                background-color: #1e1e1e;\n                color: #e0e0e0;\n                min-height: 100vh;\n                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n            }\n            .loading-screen, .error-screen {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                height: 100vh;\n                color: #fff;\n                text-align: center;\n            }\n            .bot-link {\n                margin-top: 20px;\n                background: #0088cc;\n                color: white;\n                padding: 10px 20px;\n                border-radius: 8px;\n                text-decoration: none;\n            }\n            \n            /* Tabs */\n            .tabs-header {\n                display: flex;\n                background: #232323;\n                border-bottom: 1px solid #333;\n                position: sticky;\n                top: 0;\n                z-index: 100;\n            }\n\n            /* Content Area */\n            .content-area {\n                padding: 20px;\n            }\n\n            /* Filters */\n            .filters-bar {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 20px;\n            }\n            .filter-label {\n                font-size: 14px;\n                color: #aaa;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                cursor: pointer;\n            }\n\n            /* Story Card */\n            .story-card {\n                background: #2a2a2a;\n                border-radius: 12px;\n                margin-bottom: 15px;\n                border: 1px solid #333;\n                overflow: hidden;\n                transition: border-color 0.2s;\n            }\n            .story-card:hover {\n                border-color: #444;\n            }\n            .story-header {\n                padding: 15px;\n                display: flex;\n                align-items: center;\n                cursor: pointer;\n            }\n            .story-title-row {\n                flex: 1;\n                margin: 0 10px;\n                font-weight: 500;\n                font-size: 16px;\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n            }\n            .neural-badge {\n                font-size: 10px;\n                background: rgba(179, 136, 255, 0.2);\n                color: #b388ff;\n                border: 1px solid #b388ff;\n                padding: 1px 4px;\n                border-radius: 4px;\n                margin-left: 6px;\n            }\n            .settings-btn {\n                background: none;\n                border: none;\n                color: #666;\n                cursor: pointer;\n                padding: 5px;\n                border-radius: 50%;\n                transition: color 0.2s, background 0.2s;\n            }\n            .settings-btn:hover {\n                color: #fff;\n                background: rgba(255,255,255,0.1);\n            }\n\n            /* Expanded Area */\n            .story-body {\n                border-top: 1px solid #333;\n                background: #252525;\n                padding: 15px;\n                animation: slideDown 0.3s ease;\n            }\n            @keyframes slideDown {\n                from { opacity: 0; transform: translateY(-5px); }\n                to { opacity: 1; transform: translateY(0); }\n            }\n            .content-substrate {\n                background-color: #252525;\n                border: 1px solid #333;\n                border-radius: 12px;\n                padding: 25px;\n                box-shadow: 0 4px 15px rgba(0,0,0,0.3);\n            }\n            /* Action Grids */\n            .action-grid {\n                display: grid;\n                grid-template-columns: 1fr 1fr;\n                gap: 15px;\n                margin-bottom: 15px;\n            }\n            @media (max-width: 500px) {\n                .action-grid { grid-template-columns: 1fr; }\n            }\n\n            .card-section {\n                background: #2e2e2e;\n                padding: 12px;\n                border-radius: 8px;\n                border: 1px solid #3a3a3a;\n                display: flex;\n                flex-direction: column;\n                gap: 10px;\n            }\n\n            .main-btn {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 8px;\n                padding: 10px;\n                border-radius: 6px;\n                border: none;\n                font-weight: 500;\n                cursor: pointer;\n                text-decoration: none;\n                font-size: 14px;\n                transition: opacity 0.2s;\n            }\n            .main-btn:hover { opacity: 0.9; }\n\n            .btn-logic { background: #007bff; color: white; }\n            .btn-visual { background: #6f42c1; color: white; }\n            \n            .play-links {\n                display: flex;\n                gap: 10px;\n            }\n            .play-link {\n                flex: 1;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 6px;\n                padding: 8px;\n                background: #333;\n                color: #ccc;\n                text-decoration: none;\n                border-radius: 6px;\n                font-size: 13px;\n                transition: background 0.2s;\n            }\n            .play-link:hover { background: #444; color: #fff; }\n            .play-link.web:hover { color: #b388ff; }\n            .play-link.tg:hover { color: #0088cc; }\n\n            /* Footer Actions */\n            .card-footer {\n                display: flex;\n                justify-content: flex-end;\n                gap: 10px;\n                margin-top: 10px;\n                padding-top: 10px;\n                border-top: 1px solid #333;\n            }\n            .footer-btn {\n                background: transparent;\n                border: 1px solid #444;\n                color: #aaa;\n                padding: 6px 12px;\n                border-radius: 4px;\n                font-size: 12px;\n                cursor: pointer;\n            }\n            .footer-btn:hover { border-color: #666; color: #fff; }\n            .footer-btn.delete:hover { border-color: #d9534f; color: #d9534f; }\n\n            /* Modal */\n            .modal-overlay {\n                position: fixed; inset: 0; background: rgba(0,0,0,0.8);\n                display: flex; align-items: center; justify-content: center; z-index: 1000;\n            }\n            .modal-content {\n                background: #2b2b2b; width: 90%; max-width: 450px; padding: 25px; border-radius: 12px;\n            }\n            .link-box {\n                background: #1e1e1e; padding: 10px; border-radius: 6px; display: flex; justify-content: space-between;\n                margin-bottom: 10px; font-family: monospace; font-size: 12px;\n            }\n            .primary-btn {\n                width: 100%; background: #28a745; color: white; border: none; padding: 12px;\n                border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 20px;\n            }\n            .bulk-btn {\n                background: #d9534f; margin-top: 10px;\n            }\n            \n            /* Text blocks */\n            .info-block {\n                line-height: 1.6; color: #ccc; margin-bottom: 20px;\n            }\n            .info-block h3 { color: #fff; margin-bottom: 10px; }\n        '}),(0,c.jsxs)("div",{className:"tabs-header",children:[(0,c.jsx)(QE,{active:"stories"===r,label:"\u041c\u043e\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438",onClick:()=>o("stories")}),(0,c.jsx)(QE,{active:"tutorial"===r,label:"\u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435",onClick:()=>o("tutorial")}),(0,c.jsx)(QE,{active:"faq"===r,label:"FAQ",onClick:()=>o("faq")})]}),(0,c.jsxs)("div",{className:"content-area",children:["stories"===r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"filters-bar",children:[(0,c.jsxs)("label",{className:"filter-label",title:"\u0424\u0438\u043b\u044c\u0442\u0440 \u043d\u0435\u0439\u0440\u043e-\u0438\u0441\u0442\u043e\u0440\u0438\u0439",children:[(0,c.jsx)("input",{type:"checkbox",checked:w,onChange:e=>S(e.target.checked)}),"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0435\u0439\u0440\u043e-\u0438\u0441\u0442\u043e\u0440\u0438\u0438"]}),v.length>0&&(0,c.jsxs)("button",{className:"footer-btn delete",onClick:async()=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 (".concat(v.length,")?")))try{await Promise.all(v.map(e=>Wl(n,e))),p(e=>e.filter(e=>!v.includes(e.id))),y([])}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.message))}},children:["\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 (",v.length,")"]})]}),h?(0,c.jsx)("p",{style:{textAlign:"center",color:"#666"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,c.jsxs)("div",{className:"stories-list",children:[u.filter(e=>!!w||!e.neural).map(e=>{const t=x===e.id;return(0,c.jsxs)("div",{className:"story-card",children:[(0,c.jsxs)("div",{className:"story-header",onClick:()=>b(t?null:e.id),children:[(0,c.jsx)("input",{type:"checkbox",checked:v.includes(e.id),onChange:()=>y(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id]),onClick:e=>e.stopPropagation(),style:{transform:"scale(1.2)",cursor:"pointer"}}),(0,c.jsxs)("div",{className:"story-title-row",children:[e.title,e.neural&&(0,c.jsx)("span",{className:"neural-badge",children:"AI"})]}),(0,c.jsx)("button",{className:"settings-btn",children:(0,c.jsx)(qE,{})})]}),t&&(0,c.jsxs)("div",{className:"story-body",children:[(0,c.jsxs)("div",{className:"action-grid",children:[(0,c.jsxs)("div",{className:"card-section",children:[(0,c.jsx)(eD,{title:"\u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439",tooltip:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsxs)("a",{href:"/".concat(n,"_").concat(e.id),className:"main-btn btn-logic",children:[(0,c.jsx)(KE,{})," \u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u041b\u043e\u0433\u0438\u043a\u0438"]}),(0,c.jsxs)("a",{href:"https://t.me/FoxNovel_bot?start=".concat(e.id),target:"_blank",rel:"noopener noreferrer",className:"play-link tg",children:[(0,c.jsx)(ZE,{})," \u0418\u0433\u0440\u0430\u0442\u044c \u0432 Telegram"]})]}),(0,c.jsxs)("div",{className:"card-section",children:[(0,c.jsx)(eD,{title:"\u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f",tooltip:"\u0413\u0440\u0430\u0444\u0438\u043a\u0430 \u0438 Web"}),(0,c.jsxs)("button",{id:"visual-btn-".concat(e.id),onClick:()=>(async e=>{const t=document.getElementById("visual-btn-".concat(e)),r=t?t.innerText:"";t&&(t.innerText="\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430...");try{const t=await fetch("/api/html/prepare/".concat(n,"/").concat(e),{method:"POST"}),r=await t.json();"ok"===r.status?window.location.href="/".concat(n,"_").concat(e,"/html"):alert("\u041e\u0448\u0438\u0431\u043a\u0430: "+r.error)}catch(o){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0442\u0438: "+o.message)}finally{t&&(t.innerText=r)}})(e.id),className:"main-btn btn-visual",children:[(0,c.jsx)(JE,{})," \u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440"]}),(0,c.jsxs)("a",{href:"https://novel-qg4c.onrender.com/".concat(n,"/").concat(e.id,"/html/play"),target:"_blank",rel:"noopener noreferrer",className:"play-link web",children:[(0,c.jsx)($E,{})," \u0418\u0433\u0440\u0430\u0442\u044c \u0432 Web"]})]})]}),(0,c.jsxs)("div",{className:"card-footer",children:[(0,c.jsx)("button",{className:"footer-btn",onClick:()=>(e=>C(e))(e),children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"}),(0,c.jsx)("button",{className:"footer-btn delete",onClick:()=>(async(e,t)=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \xab".concat(t,"\xbb? \u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e.")))try{await Wl(n,e),p(t=>t.filter(t=>t.id!==e))}catch(r){alert("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(r.message))}})(e.id,e.title),children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e"})]})]})]},e.id)}),0===u.length&&!h&&(0,c.jsx)("p",{style:{textAlign:"center",color:"#666",marginTop:"40px"},children:"\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u0439"})]}),(0,c.jsx)("button",{onClick:async()=>{var e,t,r;const o=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0438:");if(!o||!o.trim())return;const i=null===(e=window.Telegram)||void 0===e||null===(t=e.WebApp)||void 0===t||null===(r=t.initDataUnsafe)||void 0===r?void 0:r.user,a=(null===i||void 0===i?void 0:i.username)||"unknown_user",s=(null===i||void 0===i?void 0:i.first_name)||a;try{const e=await async function(e,t,n,r){const o=await fetch("/api/stories/".concat(e,"/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,user_name:n,author_name:r})});if(!o.ok){const e=await o.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e")}return await o.json()}(n,o.trim(),a,s);window.location.href="/".concat(n,"_").concat(e.story_id)}catch(l){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f: ".concat(l.message))}},className:"primary-btn",children:"+ \u041d\u043e\u0432\u0430\u044f \u0418\u0441\u0442\u043e\u0440\u0438\u044f"})]}),"tutorial"===r&&(0,c.jsx)("div",{className:"content-substrate",children:(0,c.jsx)(XE,{})}),"faq"===r&&(0,c.jsx)("div",{className:"content-substrate",children:(0,c.jsx)(YE,{})})]}),k&&(0,c.jsx)("div",{className:"modal-overlay",onClick:j,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h2",{style:{marginTop:0},children:["\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \xab",k.title,"\xbb"]}),(0,c.jsx)("p",{style:{fontSize:"12px",color:"#aaa",marginBottom:"5px"},children:"\u041f\u0440\u044f\u043c\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 (Telegram):"}),(0,c.jsxs)("div",{className:"link-box",children:[(0,c.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"10px"},children:"t.me/FoxNovel_bot?start=".concat(k.id)}),(0,c.jsx)("button",{onClick:()=>_("https://t.me/FoxNovel_bot?start=".concat(k.id)),style:{border:"none",background:"none",cursor:"pointer"},children:"\ud83d\udccb"})]}),(0,c.jsx)("p",{style:{fontSize:"12px",color:"#aaa",marginBottom:"5px"},children:"Web \u0432\u0435\u0440\u0441\u0438\u044f:"}),(0,c.jsxs)("div",{className:"link-box",children:[(0,c.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"10px"},children:".../html/play"}),(0,c.jsx)("button",{onClick:()=>_("https://novel-qg4c.onrender.com/".concat(n,"/").concat(k.id,"/html/play")),style:{border:"none",background:"none",cursor:"pointer"},children:"\ud83d\udccb"})]}),(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"20px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!k.public,onChange:async e=>{const t=e.target.checked;let r=k.user_name||"";if(!t||(r=prompt("\u0418\u043c\u044f \u0430\u0432\u0442\u043e\u0440\u0430 \u0434\u043b\u044f \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430:",r)||r,r))try{const e=await async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=await fetch("/api/story/".concat(e,"/").concat(t,"/public"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({public:n,user_name:r})});if(!o.ok){const e=await o.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0441\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u0438")}return await o.json()}(n,k.id,t,r);C(s(s({},k),{},{public:t,user_name:e.user_name})),p(n=>n.map(n=>n.id===k.id?s(s({},n),{},{public:t,user_name:e.user_name}):n))}catch(o){alert(o.message)}}}),"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c \u0432 \u043e\u0431\u0449\u0435\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435"]}),(0,c.jsx)("button",{onClick:j,style:{width:"100%",padding:"10px",marginTop:"20px",background:"#444",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})})]}):(0,c.jsxs)("div",{className:"error-screen",children:[(0,c.jsx)("h1",{children:"\u26d4 \u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d"}),(0,c.jsx)("p",{children:"\u0421\u0441\u044b\u043b\u043a\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430. \u0417\u0430\u0439\u0434\u0438\u0442\u0435 \u0447\u0435\u0440\u0435\u0437 \u0431\u043e\u0442\u0430."}),(0,c.jsx)("a",{href:"https://t.me/FoxNovel_bot",className:"bot-link",children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c @FoxNovel_bot"})]})},nD=["sri"],rD=["page"],oD=["page","matches"],iD=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],aD=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],sD=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];function lD(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function cD(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function dD(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function uD(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}new WeakMap;function pD(e,t){return hD(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function hD(e,t,n,r){let o=DD(("string"===typeof t?uD(t):t).pathname||"/",n);if(null==o)return null;let i=fD(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let a=null;for(let s=0;null==a&&s<i.length;++s){let e=ED(o);a=CD(i[s],e,r)}return a}function fD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=function(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,s=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&a)return;lD(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=OD([r,l.relativePath]),d=n.concat(l);e.children&&e.children.length>0&&(lD(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),fD(e.children,t,d,c,a)),(null!=e.path||e.index)&&t.push({path:c,score:kD(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of gD(e.path))i(e,t,!0,r);else i(e,t)}),t}function gD(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return o?[i,""]:[i];let a=gD(r.join("/")),s=[];return s.push(...a.map(e=>""===e?i:[i,e].join("/"))),o&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var mD=/^:[\w-]+$/,vD=3,yD=2,xD=1,bD=10,wD=-2,SD=e=>"*"===e;function kD(e,t){let n=e.split("/"),r=n.length;return n.some(SD)&&(r+=wD),t&&(r+=yD),n.filter(e=>!SD(e)).reduce((e,t)=>e+(mD.test(t)?vD:""===t?xD:bD),r)}function CD(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===i?t:t.slice(i.length)||"/",d=jD({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=jD({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:OD([i,d.pathname]),pathnameBase:RD(OD([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=OD([i,d.pathnameBase]))}return a}function jD(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=_D(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:o}=t;if("*"===r){let e=s[n]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=o&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:i,pathnameBase:a,pattern:e}}function _D(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];cD("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function ED(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return cD(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function DD(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function MD(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function TD(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function ID(e){let t=TD(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function AD(e,t,n){let r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=uD(e):(r=s({},e),lD(!r.pathname||!r.pathname.includes("?"),MD("?","pathname","search",r)),lD(!r.pathname||!r.pathname.includes("#"),MD("#","pathname","hash",r)),lD(!r.search||!r.search.includes("#"),MD("#","search","hash",r)));let i,a=""===e||""===r.pathname,l=a?"/":r.pathname;if(null==l)i=n;else{let e=t.length-1;if(!o&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:o=""}="string"===typeof e?uD(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:zD(r),hash:FD(o)}}(r,i),d=l&&"/"!==l&&l.endsWith("/"),u=(a||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!d&&!u||(c.pathname+="/"),c}var OD=e=>e.join("/").replace(/\/\/+/g,"/"),RD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),zD=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",FD=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function PD(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var BD=["POST","PUT","PATCH","DELETE"],LD=(new Set(BD),["GET",...BD]);new Set(LD),Symbol("ResetLoaderData");var ND=e.createContext(null);ND.displayName="DataRouter";var UD=e.createContext(null);UD.displayName="DataRouterState";var VD=e.createContext(!1);var WD=e.createContext({isTransitioning:!1});WD.displayName="ViewTransition";var HD=e.createContext(new Map);HD.displayName="Fetchers";var GD=e.createContext(null);GD.displayName="Await";var XD=e.createContext(null);XD.displayName="Navigation";var YD=e.createContext(null);YD.displayName="Location";var qD=e.createContext({outlet:null,matches:[],isDataRoute:!1});qD.displayName="Route";var ZD=e.createContext(null);ZD.displayName="RouteError";function $D(){return null!=e.useContext(YD)}function KD(){return lD($D(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(YD).location}var JD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function QD(t){e.useContext(XD).static||e.useLayoutEffect(t)}function eM(){let{isDataRoute:t}=e.useContext(qD);return t?function(){let{router:t}=dM("useNavigate"),n=pM("useNavigate"),r=e.useRef(!1);QD(()=>{r.current=!0});let o=e.useCallback(async function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};cD(r.current,JD),r.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,s({fromRouteId:n},o)))},[t,n]);return o}():function(){lD($D(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(ND),{basename:n,navigator:r}=e.useContext(XD),{matches:o}=e.useContext(qD),{pathname:i}=KD(),a=JSON.stringify(ID(o)),s=e.useRef(!1);QD(()=>{s.current=!0});let l=e.useCallback(function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(cD(s.current,JD),!s.current)return;if("number"===typeof e)return void r.go(e);let l=AD(e,JSON.parse(a),i,"path"===o.relative);null==t&&"/"!==n&&(l.pathname="/"===l.pathname?n:OD([n,l.pathname])),(o.replace?r.replace:r.push)(l,o.state,o)},[n,r,a,i,t]);return l}()}e.createContext(null);function tM(){let{matches:t}=e.useContext(qD),n=t[t.length-1];return n?n.params:{}}function nM(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:r}=e.useContext(qD),{pathname:o}=KD(),i=JSON.stringify(ID(r));return e.useMemo(()=>AD(t,JSON.parse(i),o,"path"===n),[t,i,o,n])}function rM(t,n,r,o,i){lD($D(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=e.useContext(XD),{matches:l}=e.useContext(qD),c=l[l.length-1],d=c?c.params:{},u=c?c.pathname:"/",p=c?c.pathnameBase:"/",h=c&&c.route;{let e=h&&h.path||"";gM(u,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,g=KD();if(n){var m;let e="string"===typeof n?uD(n):n;lD("/"===p||(null===(m=e.pathname)||void 0===m?void 0:m.startsWith(p)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(p,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=g;let v=f.pathname||"/",y=v;if("/"!==p){let e=p.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=pD(t,{pathname:y});cD(h||null!=x,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),cD(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let b=lM(x&&x.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:OD([p,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:OD([p,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),l,r,o,i);return n&&b?e.createElement(YD.Provider,{value:{location:s({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},b):b}function oM(){let t=hM(),n=PD(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o},a={padding:"2px 4px",backgroundColor:o},s=null;return console.error("Error handled by React Router default ErrorBoundary:",t),s=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:a},"ErrorBoundary")," or"," ",e.createElement("code",{style:a},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),r?e.createElement("pre",{style:i},r):null,s)}var iM=e.createElement(oM,null),aM=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?e.createElement(qD.Provider,{value:this.props.routeContext},e.createElement(ZD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sM(t){let{routeContext:n,match:r,children:o}=t,i=e.useContext(ND);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(qD.Provider,{value:n},o)}function lM(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!r)return null;if(r.errors)t=r.matches;else{if(0!==n.length||r.initialized||!(r.matches.length>0))return null;t=r.matches}}let i=t,a=null===r||void 0===r?void 0:r.errors;if(null!=a){let e=i.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));lD(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let s=!1,l=-1;if(r)for(let e=0;e<i.length;e++){let t=i[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=r,o=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||o){s=!0,i=l>=0?i.slice(0,l+1):[i[0]];break}}}return i.reduceRight((t,c,d)=>{let u,p=!1,h=null,f=null;r&&(u=a&&c.route.id?a[c.route.id]:void 0,h=c.route.errorElement||iM,s&&(l<0&&0===d?(gM("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,f=null):l===d&&(p=!0,f=c.route.hydrateFallbackElement||null)));let g=n.concat(i.slice(0,d+1)),m=()=>{let n;return n=u?h:p?f:c.route.Component?e.createElement(c.route.Component,null):c.route.element?c.route.element:t,e.createElement(sM,{match:c,routeContext:{outlet:t,matches:g,isDataRoute:null!=r},children:n})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===d)?e.createElement(aM,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0},unstable_onError:o}):m()},null)}function cM(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function dM(t){let n=e.useContext(ND);return lD(n,cM(t)),n}function uM(t){let n=e.useContext(UD);return lD(n,cM(t)),n}function pM(t){let n=function(t){let n=e.useContext(qD);return lD(n,cM(t)),n}(t),r=n.matches[n.matches.length-1];return lD(r.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),r.route.id}function hM(){var t;let n=e.useContext(ZD),r=uM("useRouteError"),o=pM("useRouteError");return void 0!==n?n:null===(t=r.errors)||void 0===t?void 0:t[o]}var fM={};function gM(e,t,n){t||fM[e]||(fM[e]=!0,cD(!1,n))}var mM={};function vM(e,t){e||mM[t]||(mM[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:o}=e;return rM(t,void 0,r,o,n)});e.Component;var yM="get",xM="application/x-www-form-urlencoded";function bM(e){return null!=e&&"string"===typeof e.tagName}var wM=null;var SM=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function kM(e){return null==e||SM.has(e)?e:(cD(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(xM,'"')),null)}function CM(e,t){let n,r,o,i,a;if(function(e){return bM(e)&&"form"===e.tagName.toLowerCase()}(e)){let a=e.getAttribute("action");r=a?DD(a,t):null,n=e.getAttribute("method")||yM,o=kM(e.getAttribute("enctype"))||xM,i=new FormData(e)}else if(function(e){return bM(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return bM(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?DD(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||yM,o=kM(e.getAttribute("formenctype"))||kM(a.getAttribute("enctype"))||xM,i=new FormData(a,e),!function(){if(null===wM)try{new FormData(document.createElement("form"),0),wM=!1}catch(e){wM=!0}return wM}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,r)}}else{if(bM(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=yM,r=null,o=xM,a=e}return i&&"text/plain"===o&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function jM(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function _M(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===DD(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function EM(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function DM(e){return null!=e&&"string"===typeof e.page}function MM(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function TM(e,t,n,r,o,i){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===i?t.filter((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,i)||s(t,i))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function IM(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o}).flat(1),[...new Set(r)];var r}function AM(e,t){let n=new Set,r=new Set(t);return e.reduce((e,o)=>{if(t&&!DM(o)&&"script"===o.as&&o.href&&r.has(o.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(o));return n.has(i)||(n.add(i),e.push({key:i,link:o})),e},[])}function OM(e,t){return"lazy"===e.mode&&!0===t}function RM(){let t=e.useContext(ND);return jM(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function zM(){let t=e.useContext(UD);return jM(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var FM=e.createContext(void 0);function PM(){let t=e.useContext(FM);return jM(t,"You must render this element inside a <HydratedRouter> element"),t}function BM(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function LM(e,t,n){if(n&&!WM)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}FM.displayName="FrameworkContext";function NM(t){let{page:n}=t,r=l(t,rD),{router:o}=RM(),i=e.useMemo(()=>pD(o.routes,n,o.basename),[o.routes,n,o.basename]);return i?e.createElement(VM,s({page:n,matches:i},r)):null}function UM(t){let{manifest:n,routeModules:r}=PM(),[o,i]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,n){return AM((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await EM(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(MM).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?s(s({},e),{},{rel:"prefetch",as:"style"}):s(s({},e),{},{rel:"prefetch"})))}(t,n,r).then(t=>{e||i(t)}),()=>{e=!0}},[t,n,r]),o}function VM(t){let{page:n,matches:r}=t,o=l(t,oD),i=KD(),{manifest:a,routeModules:c}=PM(),{basename:d}=RM(),{loaderData:u,matches:p}=zM(),h=e.useMemo(()=>TM(n,r,p,a,i,"data"),[n,r,p,a,i]),f=e.useMemo(()=>TM(n,r,p,a,i,"assets"),[n,r,p,a,i]),g=e.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let e=new Set,t=!1;if(r.forEach(n=>{var r;let o=a.routes[n.route.id];o&&o.hasLoader&&(!h.some(e=>e.route.id===n.route.id)&&n.route.id in u&&null!==(r=c[n.route.id])&&void 0!==r&&r.shouldRevalidate||o.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let o=_M(n,d,"data");return t&&e.size>0&&o.searchParams.set("_routes",r.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[o.pathname+o.search]},[d,u,i,a,h,r,n,c]),m=e.useMemo(()=>IM(f,a),[f,a]),v=UM(f);return e.createElement(e.Fragment,null,g.map(t=>e.createElement("link",s({key:t,rel:"prefetch",as:"fetch",href:t},o))),m.map(t=>e.createElement("link",s({key:t,rel:"modulepreload",href:t},o))),v.map(t=>{let{key:n,link:r}=t;return e.createElement("link",s({key:n,nonce:o.nonce},r))}))}var WM=!1;function HM(t){let{manifest:n,serverHandoffString:r,isSpaMode:o,renderMeta:i,routeDiscovery:a,ssr:c}=PM(),{router:d,static:u,staticContext:p}=RM(),{matches:h}=zM(),f=e.useContext(VD),g=OM(a,c);i&&(i.didRenderScripts=!0);let m=LM(h,null,o);e.useEffect(()=>{0},[]);let v=e.useMemo(()=>{var o;if(f)return null;let i=p?"window.__reactRouterContext = ".concat(r,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",a=u?"".concat(null!==n.hmr&&void 0!==o&&o.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(m.map((e,t)=>{let r="route".concat(t),o=n.routes[e.route.id];jM(o,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:l,module:c}=o,d=[...i?[{module:i,varName:"".concat(r,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(r,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===d.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=l(e,nD),o=new Set(t.state.matches.map(e=>e.route.id)),i=t.state.location.pathname.split("/").filter(Boolean),a=["/"];for(i.pop();i.length>0;)a.push("/".concat(i.join("/"))),i.pop();a.forEach(e=>{let n=pD(t.routes,e,t.basename);n&&n.forEach(e=>o.add(e.route.id))});let c=[...o].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return s(s({},r),{},{routes:c,sri:!!n||void 0})}(n,d),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(m.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",s(s({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:i},type:void 0})),e.createElement("script",s(s({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:"module",async:!0})))},[]),y=WM||f?[]:function(e){return[...new Set(e)]}(n.entry.imports.concat(IM(m,n,{includeHydrateFallback:!0}))),x="object"===typeof n.sri?n.sri:{};return vM(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),WM||f?null:e.createElement(e.Fragment,null,"object"===typeof n.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:x})}}):null,g?null:e.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:t.crossOrigin,integrity:x[n.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:t.crossOrigin,integrity:x[n.entry.module],suppressHydrationWarning:!0}),y.map(n=>e.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:t.crossOrigin,integrity:x[n],suppressHydrationWarning:!0})),v)}function GM(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function XM(t){let{error:n,isOutsideRemixApp:r}=t;console.error(n);let o,i=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(PD(n))return e.createElement(YM,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),i);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return e.createElement(YM,{title:"Application Error!",isOutsideRemixApp:r},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},o.stack),i)}function YM(t){var n;let{title:r,renderScripts:o,isOutsideRemixApp:i,children:a}=t,{routeModules:s}=PM();return null!==s.root&&void 0!==n&&n.Layout&&!i?a:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,r)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,o?e.createElement(HM,null):null)))}var qM="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{qM&&(window.__reactRouterVersion="7.9.5")}catch(M2){}var ZM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$M=e.forwardRef(function(t,n){let r,{onClick:o,discover:i="render",prefetch:a="none",relative:c,reloadDocument:d,replace:u,state:p,target:h,to:f,preventScrollReset:g,viewTransition:m}=t,v=l(t,iD),{basename:y}=e.useContext(XD),x="string"===typeof f&&ZM.test(f),b=!1;if("string"===typeof f&&x&&(r=f,qM))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=DD(t.pathname,y);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:b=!0}catch(M2){cD(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let w=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};lD($D(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:o}=e.useContext(XD),{hash:i,pathname:a,search:s}=nM(t,{relative:n}),l=a;return"/"!==r&&(l="/"===a?r:OD([r,a])),o.createHref({pathname:l,search:s,hash:i})}(f,{relative:c}),[S,k,C]=function(t,n){let r=e.useContext(FM),[o,i]=e.useState(!1),[a,s]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:p}=n,h=e.useRef(null);e.useEffect(()=>{if("render"===t&&s(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(o){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[o]);let f=()=>{i(!0)},g=()=>{i(!1),s(!1)};return r?"intent"!==t?[a,h,{}]:[a,h,{onFocus:BM(l,f),onBlur:BM(c,g),onMouseEnter:BM(d,f),onMouseLeave:BM(u,g),onTouchStart:BM(p,f)}]:[!1,h,{}]}(a,v),j=function(t){let{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=eM(),c=KD(),d=nM(t,{relative:a});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,n)){e.preventDefault();let n=void 0!==r?r:dD(c)===dD(d);l(t,{replace:n,state:o,preventScrollReset:i,relative:a,viewTransition:s})}},[c,l,d,r,o,n,t,i,a,s])}(f,{replace:u,state:p,target:h,preventScrollReset:g,relative:c,viewTransition:m});let _=e.createElement("a",s(s(s({},v),C),{},{href:r||w,onClick:b||d?o:function(e){o&&o(e),e.defaultPrevented||j(e)},ref:GM(n,k),target:h,"data-discover":x||"render"!==i?void 0:"true"}));return S&&!x?e.createElement(e.Fragment,null,_,e.createElement(NM,{page:w})):_});$M.displayName="Link";var KM=e.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:o=!1,className:i="",end:a=!1,style:c,to:d,viewTransition:u,children:p}=t,h=l(t,aD),f=nM(d,{relative:h.relative}),g=KD(),m=e.useContext(UD),{navigator:v,basename:y}=e.useContext(XD),x=null!=m&&function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.useContext(WD);lD(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=eT("useViewTransitionState"),i=nM(t,{relative:n});if(!r.isTransitioning)return!1;let a=DD(r.currentLocation.pathname,o)||r.currentLocation.pathname,s=DD(r.nextLocation.pathname,o)||r.nextLocation.pathname;return null!=jD(i.pathname,s)||null!=jD(i.pathname,a)}(f)&&!0===u,b=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,w=g.pathname,S=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;o||(w=w.toLowerCase(),S=S?S.toLowerCase():null,b=b.toLowerCase()),S&&y&&(S=DD(S,y)||S);const k="/"!==b&&b.endsWith("/")?b.length-1:b.length;let C,j=w===b||!a&&w.startsWith(b)&&"/"===w.charAt(k),_=null!=S&&(S===b||!a&&S.startsWith(b)&&"/"===S.charAt(b.length)),E={isActive:j,isPending:_,isTransitioning:x},D=j?r:void 0;C="function"===typeof i?i(E):[i,j?"active":null,_?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M="function"===typeof c?c(E):c;return e.createElement($M,s(s({},h),{},{"aria-current":D,className:C,ref:n,style:M,to:d,viewTransition:u}),"function"===typeof p?p(E):p)});KM.displayName="NavLink";var JM=e.forwardRef((t,n)=>{let{discover:r="render",fetcherKey:o,navigate:i,reloadDocument:a,replace:c,state:d,method:u=yM,action:p,onSubmit:h,relative:f,preventScrollReset:g,viewTransition:m}=t,v=l(t,sD),y=rT(),x=function(t){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:r}=e.useContext(XD),o=e.useContext(qD);lD(o,"useFormAction must be used inside a RouteContext");let[i]=o.matches.slice(-1),a=s({},nM(t||".",{relative:n})),l=KD();if(null==t){a.search=l.search;let e=new URLSearchParams(a.search),t=e.getAll("index"),n=t.some(e=>""===e);if(n){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();a.search=n?"?".concat(n):""}}t&&"."!==t||!i.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(a.pathname="/"===a.pathname?r:OD([r,a.pathname]));return dD(a)}(p,{relative:f}),b="get"===u.toLowerCase()?"get":"post",w="string"===typeof p&&ZM.test(p);return e.createElement("form",s(s({ref:n,method:b,action:x,onSubmit:a?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;y(t||e.currentTarget,{fetcherKey:o,method:n,navigate:i,replace:c,state:d,relative:f,preventScrollReset:g,viewTransition:m})}},v),{},{"data-discover":w||"render"!==r?void 0:"true"}))});function QM(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function eT(t){let n=e.useContext(ND);return lD(n,QM(t)),n}JM.displayName="Form";var tT=0,nT=()=>"__".concat(String(++tT),"__");function rT(){let{router:t}=eT("useSubmit"),{basename:n}=e.useContext(XD),r=pM("useRouteId");return e.useCallback(async function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:a,encType:s,formData:l,body:c}=CM(e,n);if(!1===o.navigate){let e=o.fetcherKey||nT();await t.fetch(e,r,o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await t.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,n,r])}var oT=n(1276);function iT(e,t){for(var n=e.length,r=0;r<n;++r)if(t(e[r],r))return!0;return!1}function aT(e,t){for(var n=e.length,r=0;r<n;++r)if(t(e[r],r))return e[r];return null}function sT(e){var t=e;if("undefined"===typeof t){if("undefined"===typeof navigator||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function lT(e,t){try{return new RegExp(e,"g").exec(t)}catch(M2){return null}}function cT(){if("undefined"===typeof navigator||!navigator||!navigator.userAgentData)return!1;var e=navigator.userAgentData,t=e.brands||e.uaList;return!(!t||!t.length)}function dT(e){return e.replace(/_/g,".")}function uT(e,t){var n=null,r="-1";return iT(e,function(e){var o=lT("("+e.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",t);return!(!o||e.brand)&&(n=e,r=o[3]||"-1",e.versionAlias?r=e.versionAlias:e.versionTest&&(r=function(e,t){var n=lT("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return n?n[3]:""}(e.versionTest.toLowerCase(),t)||r),r=dT(r),!0)}),{preset:n,version:r}}function pT(e,t){var n={brand:"",version:"-1"};return iT(e,function(e){var r=hT(t,e);return!!r&&(n.brand=e.id,n.version=e.versionAlias||r.version,"-1"!==n.version)}),n}function hT(e,t){return aT(e,function(e){var n=e.brand;return lT(""+t.test,n.toLowerCase())})}var fT=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],gT=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],mT=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],vT=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],yT=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function xT(e){return!!uT(vT,e).preset}function bT(e){var t=navigator.userAgentData,n=(t.uaList||t.brands).slice(),r=e&&e.fullVersionList,o=t.mobile||!1,i=n[0],a=(e&&e.platform||t.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!pT(vT,n).brand||xT(sT())},l={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&iT(mT,function(e){return hT(n,e)});var c=pT(gT,n);if(s.chromium=!!c.brand,s.chromiumVersion=c.version||"-1",!s.chromium){var d=pT(mT,n);s.webkit=!!d.brand,s.webkitVersion=d.version||"-1"}var u=aT(yT,function(e){return new RegExp(""+e.test,"g").exec(a)});if(l.name=u?u.id:"",e&&(l.version=e.platformVersion||"-1"),r&&r.length){var p=pT(fT,r);s.name=p.brand||s.name,s.version=p.version||s.version}else{var h=pT(fT,n);s.name=h.brand||s.name,s.version=h.brand&&e?e.uaFullVersion:h.version}return s.webkit&&(l.name=o?"ios":"mac"),"ios"===l.name&&s.webview&&(s.version="-1"),l.version=dT(l.version),s.version=dT(s.version),l.majorVersion=parseInt(l.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:l,isMobile:o,isHints:!0}}function wT(e){return"undefined"===typeof e&&cT()?bT():function(e){var t=sT(e),n=!!/mobi/g.exec(t),r={name:"unknown",version:"-1",majorVersion:-1,webview:xT(t),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},o={name:"unknown",version:"-1",majorVersion:-1},i=uT(fT,t),a=i.preset,s=i.version,l=uT(yT,t),c=l.preset,d=l.version,u=uT(gT,t);if(r.chromium=!!u.preset,r.chromiumVersion=u.version,!r.chromium){var p=uT(mT,t);r.webkit=!!p.preset,r.webkitVersion=p.version}return c&&(o.name=c.id,o.version=d,o.majorVersion=parseInt(d,10)),a&&(r.name=a.id,r.version=s,r.webview&&"ios"===o.name&&"safari"!==r.name&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:o,isMobile:n,isHints:!1}}(e)}const ST=wT;function kT(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(t){return t.split(" ").map(function(t){return t?""+e+t:""}).join(" ")}).join(" ")}function CT(e,t){return function(n){n&&(e[t]=n)}}function jT(e,t,n){return function(r){r&&(e[t][n]=r)}}var _T="undefined",ET=typeof window!==_T,DT=typeof document!==_T&&document,MT=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],TT=1e-7,IT={cm:function(e){return 96*e/2.54},mm:function(e){return 96*e/254},in:function(e){return 96*e},pt:function(e){return 96*e/72},pc:function(e){return 96*e/6},"%":function(e,t){return e*t/100},vw:function(e,t){return void 0===t&&(t=window.innerWidth),e/100*t},vh:function(e,t){return void 0===t&&(t=window.innerHeight),e/100*t},vmax:function(e,t){return void 0===t&&(t=Math.max(window.innerWidth,window.innerHeight)),e/100*t},vmin:function(e,t){return void 0===t&&(t=Math.min(window.innerWidth,window.innerHeight)),e/100*t}};function AT(e,t,n,r){return(e*r+t*n)/(n+r)}function OT(e){return typeof e===_T}function RT(e){return e&&"object"===typeof e}function zT(e){return Array.isArray(e)}function FT(e){return"string"===typeof e}function PT(e){return"number"===typeof e}function BT(e){return"function"===typeof e}function LT(e,t,n,r,o){return NT(e,t,n)?n:function(e,t,n,r,o){for(var i,a=function(n){var a=t[n].trim();if(a===e.close&&!NT(e,t,n))return{value:n};var s=n,l=qT(o,function(e){return e.open===a});if(l&&(s=LT(l,t,n,r,o)),-1===s)return i=n,"break";i=n=s},s=n;s<r;++s){var l=a(s);if(s=i,"object"===typeof l)return l.value;if("break"===l)break}return-1}(e,t,n+1,r,o)}function NT(e,t,n){if(!e.ignore)return null;var r=t.slice(Math.max(n-3,0),n+3).join("");return new RegExp(e.ignore).exec(r)}function UT(e,t){var n=FT(t)?{separator:t}:t,r=n.separator,o=void 0===r?",":r,i=n.isSeparateFirst,a=n.isSeparateOnlyOpenClose,s=n.isSeparateOpenClose,l=void 0===s?a:s,c=n.openCloseCharacters,d=void 0===c?MT:c,u=d.map(function(e){var t=e.open,n=e.close;return t===n?t:t+"|"+n}).join("|"),p=new RegExp("(\\s*"+o+"\\s*|"+u+"|\\s+)","g"),h=e.split(p).filter(function(e){return e&&"undefined"!==e}),f=h.length,g=[],m=[];function v(){return!!m.length&&(g.push(m.join("")),m=[],!0)}for(var y,x=function(t){var n=h[t].trim(),r=t,s=qT(d,function(e){return e.open===n}),c=qT(d,function(e){return e.close===n});if(s){if(-1!==(r=LT(s,h,t,f,d))&&l)return v()&&i?(y=t,"break"):(g.push(h.slice(t,r+1).join("")),t=r,i?(y=t,"break"):(y=t,"continue"))}else{if(c&&!NT(c,h,t)){var u=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}(d);return u.splice(d.indexOf(c),1),{value:UT(e,{separator:o,isSeparateFirst:i,isSeparateOnlyOpenClose:a,isSeparateOpenClose:l,openCloseCharacters:u})}}if(function(e,t){return(""===t||" "==t)&&(""===e||" "==e)||e===t}(n,o)&&!a)return v(),i?(y=t,"break"):(y=t,"continue")}-1===r&&(r=f-1),m.push(h.slice(t,r+1).join("")),y=t=r},b=0;b<f;++b){var w=x(b);if(b=y,"object"===typeof w)return w.value;if("break"===w)break}return m.length&&g.push(m.join("")),g}function VT(e){return UT(e,"")}function WT(e){return UT(e,",")}function HT(e){var t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!t||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function GT(e){var t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);if(!t)return{prefix:"",unit:"",value:NaN};var n=t[1],r=t[2];return{prefix:n,unit:t[3],value:parseFloat(r)}}function XT(){return Date.now?Date.now():(new Date).getTime()}function YT(e,t,n){void 0===n&&(n=-1);for(var r=e.length,o=0;o<r;++o)if(t(e[o],o,e))return o;return n}function qT(e,t,n){var r=YT(e,t);return r>-1?e[r]:n}var ZT=function(){var e=XT(),t=ET&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return t?t.bind(window):function(t){var n=XT();return setTimeout(function(){t(n-e)},1e3/60)}}(),$T=function(){var e=ET&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return e?e.bind(window):function(e){clearTimeout(e)}}();function KT(e){return Object.keys(e)}function JT(e,t){var n=GT(e),r=n.value,o=n.unit;if(RT(t)){var i=t[o];if(i){if(BT(i))return i(r);if(IT[o])return IT[o](r,i)}}else if("%"===o)return r*t/100;return IT[o]?IT[o](r):r}function QT(e,t,n){return Math.max(t,Math.min(e,n))}function eI(e,t,n,r){return void 0===r&&(r=e[0]/e[1]),[[aI(t[0],TT),aI(t[0]/r,TT)],[aI(t[1]*r,TT),aI(t[1],TT)]].filter(function(e){return e.every(function(e,r){var o=t[r],i=aI(o,TT);return n?e<=o||e<=i:e>=o||e>=i})})[0]||e}function tI(e,t,n,r){if(!r)return e.map(function(e,r){return QT(e,t[r],n[r])});var o=e[0],i=e[1],a=!0===r?o/i:r,s=eI(e,t,!1,a),l=s[0],c=s[1],d=eI(e,n,!0,a),u=d[0],p=d[1];return o<l||i<c?(o=l,i=c):(o>u||i>p)&&(o=u,i=p),[o,i]}function nI(e){for(var t=e.length,n=0,r=t-1;r>=0;--r)n+=e[r];return t?n/t:0}function rI(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=Math.atan2(r,n);return o>=0?o:o+2*Math.PI}function oI(e){var t=function(e){return[0,1].map(function(t){return nI(e.map(function(e){return e[t]}))})}(e),n=rI(t,e[0]),r=rI(t,e[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function iI(e,t){return Math.sqrt(Math.pow((t?t[0]:0)-e[0],2)+Math.pow((t?t[1]:0)-e[1],2))}function aI(e,t){if(!t)return e;var n=1/t;return Math.round(e/t)/n}function sI(e,t){return e.forEach(function(n,r){e[r]=aI(e[r],t)}),e}function lI(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function cI(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function dI(e,t){if(e.classList)e.classList.remove(t);else{var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function uI(e,t,n,r){e.addEventListener(t,n,r)}function pI(e,t,n,r){e.removeEventListener(t,n,r)}function hI(e){return(null===e||void 0===e?void 0:e.ownerDocument)||DT}function fI(e){return hI(e).documentElement}function gI(e){return hI(e).body}function mI(e){var t;return(null===(t=null===e||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||window}function vI(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}function yI(e){return RT(e)&&e.nodeName&&e.nodeType&&"ownerDocument"in e}function xI(e,t,n,r,o,i){for(var a=0;a<o;++a){var s=n+a*o,l=r+a*o;e[s]+=e[l]*i,t[s]+=t[l]*i}}function bI(e,t,n,r,o){for(var i=0;i<o;++i){var a=n+i*o,s=r+i*o,l=e[a],c=t[a];e[a]=e[s],e[s]=l,t[a]=t[s],t[s]=c}}function wI(e,t,n,r,o){for(var i=0;i<r;++i){var a=n+i*r;e[a]/=o,t[a]/=o}}function SI(e,t,n){void 0===n&&(n=Math.sqrt(e.length));for(var r=e.slice(),o=0;o<n;++o)r[o*n+t-1]=0,r[(t-1)*n+o]=0;return r[(t-1)*(n+1)]=1,r}function kI(e,t){void 0===t&&(t=Math.sqrt(e.length));for(var n=e.slice(),r=VI(t),o=0;o<t;++o){var i=t*o+o;if(!aI(n[i],TT))for(var a=o+1;a<t;++a)if(n[t*o+a]){bI(n,r,o,a,t);break}if(!aI(n[i],TT))return[];wI(n,r,o,t,n[i]);for(a=0;a<t;++a){var s=a,l=n[a+o*t];aI(l,TT)&&o!==a&&xI(n,r,s,o,t,-l)}}return r}function CI(e,t){void 0===t&&(t=Math.sqrt(e.length));for(var n=[],r=e[t*t-1],o=0;o<t-1;++o)n[o]=e[t*(t-1)+o]/r;return n[t-1]=0,n}function jI(e,t){for(var n=e.slice(),r=e.length;r<t-1;++r)n[r]=0;return n[t-1]=1,n}function _I(e,t,n){if(void 0===t&&(t=Math.sqrt(e.length)),t===n)return e;for(var r=VI(n),o=Math.min(t,n),i=0;i<o-1;++i){for(var a=0;a<o-1;++a)r[i*n+a]=e[i*t+a];r[(i+1)*n-1]=e[(i+1)*t-1],r[(n-1)*n+i]=e[(t-1)*t+i]}return r[n*n-1]=e[t*t-1],r}function EI(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=VI(e);return t.forEach(function(t){r=DI(r,t,e)}),r}function DI(e,t,n){void 0===n&&(n=Math.sqrt(e.length));var r=[],o=e.length/n,i=t.length/o;if(!o)return t;if(!i)return e;for(var a=0;a<n;++a)for(var s=0;s<i;++s){r[s*n+a]=0;for(var l=0;l<o;++l)r[s*n+a]+=e[l*n+a]*t[s*o+l]}return r}function MI(e,t){for(var n=Math.min(e.length,t.length),r=e.slice(),o=0;o<n;++o)r[o]=r[o]+t[o];return r}function TI(e,t){for(var n=Math.min(e.length,t.length),r=e.slice(),o=0;o<n;++o)r[o]=r[o]-t[o];return r}function II(e,t){return void 0===t&&(t=6===e.length),t?[e[0],e[1],0,e[2],e[3],0,e[4],e[5],1]:e}function AI(e,t){return void 0===t&&(t=9===e.length),t?[e[0],e[1],e[3],e[4],e[6],e[7]]:e}function OI(e,t,n){void 0===n&&(n=t.length);var r=DI(e,t,n),o=r[n-1];return r.map(function(e){return e/o})}function RI(e,t){return DI(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function zI(e,t){return DI(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function FI(e,t){return DI(e,UI(t,4))}function PI(e,t){var n=t[0],r=void 0===n?1:n,o=t[1],i=void 0===o?1:o,a=t[2];return DI(e,[r,0,0,0,0,i,0,0,0,0,void 0===a?1:a,0,0,0,0,1],4)}function BI(e,t){return OI(UI(t,3),jI(e,3))}function LI(e,t){var n=t[0],r=void 0===n?0:n,o=t[1],i=void 0===o?0:o,a=t[2];return DI(e,[1,0,0,0,0,1,0,0,0,0,1,0,r,i,void 0===a?0:a,1],4)}function NI(e,t){return DI(e,t,4)}function UI(e,t){var n=Math.cos(e),r=Math.sin(e),o=VI(t);return o[0]=n,o[1]=r,o[t]=-r,o[t+1]=n,o}function VI(e){for(var t=e*e,n=[],r=0;r<t;++r)n[r]=r%(e+1)?0:1;return n}function WI(e,t){for(var n=VI(t),r=Math.min(e.length,t-1),o=0;o<r;++o)n[(t+1)*o]=e[o];return n}function HI(e,t){for(var n=VI(t),r=Math.min(e.length,t-1),o=0;o<r;++o)n[t*(t-1)+o]=e[o];return n}function GI(e,t,n,r,o,i,a,s){var l=e[0],c=e[1],d=t[0],u=t[1],p=n[0],h=n[1],f=r[0],g=r[1],m=o[0],v=o[1],y=i[0],x=i[1],b=a[0],w=a[1],S=s[0],k=s[1],C=kI([l,0,d,0,p,0,f,0,c,0,u,0,h,0,g,0,1,0,1,0,1,0,1,0,0,l,0,d,0,p,0,f,0,c,0,u,0,h,0,g,0,1,0,1,0,1,0,1,-m*l,-v*l,-y*d,-x*d,-b*p,-w*p,-S*f,-k*f,-m*c,-v*c,-y*u,-x*u,-b*h,-w*h,-S*g,-k*g],8);if(!C.length)return[];var j=DI(C,[m,v,y,x,b,w,S,k],8);return j[8]=1,_I(function(e,t){void 0===t&&(t=Math.sqrt(e.length));for(var n=[],r=0;r<t;++r)for(var o=0;o<t;++o)n[o*t+r]=e[t*r+o];return n}(j),3,4)}var XI=function(){return XI=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},XI.apply(this,arguments)};function YI(e,t){return void 0===t&&(t=0),qI(ZI(e,t))}function qI(e){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return e.forEach(function(e){var n=e.matrixFunction,r=e.functionValue;n&&(t=n(t,r))}),t}function ZI(e,t){return void 0===t&&(t=0),(zT(e)?e:VT(e)).map(function(e){var n=HT(e),r=n.prefix,o=n.value,i=null,a=r,s="";if("translate"===r||"translateX"===r||"translate3d"===r){var l=RT(t)?XI(XI({},t),{"o%":t["%"]}):{"%":t,"o%":t},c=WT(o).map(function(e,n){return l["%"]=0===n&&"x%"in l?t["x%"]:1===n&&"y%"in l?t["y%"]:t["o%"],JT(e,l)}),d=c[0],u=c[1],p=void 0===u?0:u,h=c[2];i=LI,s=[d,p,void 0===h?0:h]}else if("translateY"===r){i=LI,s=[0,p=JT(o,RT(t)?XI({"%":t["y%"]},t):{"%":t}),0]}else if("translateZ"===r){i=LI,s=[0,0,parseFloat(o)]}else if("scale"===r||"scale3d"===r){var f=WT(o).map(function(e){return parseFloat(e)}),g=f[0],m=f[1],v=void 0===m?g:m,y=f[2];i=PI,s=[g,v,void 0===y?1:y]}else if("scaleX"===r){i=PI,s=[g=parseFloat(o),1,1]}else if("scaleY"===r){i=PI,s=[1,v=parseFloat(o),1]}else if("scaleZ"===r){i=PI,s=[1,1,parseFloat(o)]}else if("rotate"===r||"rotateZ"===r||"rotateX"===r||"rotateY"===r){var x=GT(o),b=x.unit,w=x.value;"rotate"===r||"rotateZ"===r?(a="rotateZ",i=FI):"rotateX"===r?i=RI:"rotateY"===r&&(i=zI),s="rad"===b?w:w*Math.PI/180}else if("matrix3d"===r)i=NI,s=WT(o).map(function(e){return parseFloat(e)});else if("matrix"===r){var S=WT(o).map(function(e){return parseFloat(e)});i=NI,s=[S[0],S[1],0,0,S[2],S[3],0,0,0,0,1,0,S[4],S[5],0,1]}else a="";return{name:r,functionName:a,value:o,matrixFunction:i,functionValue:s}})}var $I=function(){function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(e){return this.values[this.keys.indexOf(e)]},t.set=function(e,t){var n=this.keys,r=this.values,o=n.indexOf(e),i=-1===o?n.length:o;n[i]=e,r[i]=t},e}(),KI=function(){function e(){this.object={}}var t=e.prototype;return t.get=function(e){return this.object[e]},t.set=function(e,t){this.object[e]=t},e}(),JI="function"===typeof Map,QI=function(){function e(){}var t=e.prototype;return t.connect=function(e,t){this.prev=e,this.next=t,e&&(e.next=this),t&&(t.prev=this)},t.disconnect=function(){var e=this.prev,t=this.next;e&&(e.next=t),t&&(t.prev=e)},t.getIndex=function(){for(var e=this,t=-1;e;)e=e.prev,++t;return t},e}();var eA=function(){function e(e,t,n,r,o,i,a,s){this.prevList=e,this.list=t,this.added=n,this.removed=r,this.changed=o,this.maintained=i,this.changedBeforeAdded=a,this.fixed=s}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var e=function(e,t){var n=[],r=[];return e.forEach(function(e){var t=e[0],o=e[1],i=new QI;n[t]=i,r[o]=i}),n.forEach(function(e,t){e.connect(n[t-1])}),e.filter(function(e,n){return!t[n]}).map(function(e,t){var o=e[0],i=e[1];if(o===i)return[0,0];var a=n[o],s=r[i-1],l=a.getIndex();return a.disconnect(),s?a.connect(s,s.next):a.connect(void 0,n[0]),[l,a.getIndex()]})}(this.changedBeforeAdded,this.fixed),t=this.changed,n=[];this.cacheOrdered=e.filter(function(e,r){var o=e[0],i=e[1],a=t[r],s=a[0],l=a[1];if(o!==i)return n.push([s,l]),!0}),this.cachePureChanged=n},e}();function tA(e,t,n){var r=JI?Map:n?KI:$I,o=n||function(e){return e},i=[],a=[],s=[],l=e.map(o),c=t.map(o),d=new r,u=new r,p=[],h=[],f={},g=[],m=0,v=0;return l.forEach(function(e,t){d.set(e,t)}),c.forEach(function(e,t){u.set(e,t)}),l.forEach(function(e,t){var n=u.get(e);"undefined"===typeof n?(++v,a.push(t)):f[n]=v}),c.forEach(function(e,t){var n=d.get(e);"undefined"===typeof n?(i.push(t),++m):(s.push([n,t]),v=f[t]||0,p.push([n-v,t-m]),h.push(t===n),n!==t&&g.push([n,t]))}),a.reverse(),new eA(e,t,i,a,g,s,p,h)}var nA=function(){function e(e,t){void 0===e&&(e=[]),this.findKeyCallback=t,this.list=[].slice.call(e)}return e.prototype.update=function(e){var t=[].slice.call(e),n=tA(this.list,t,this.findKeyCallback);return this.list=t,n},e}();const rA=nA;var oA=function(e,t){return oA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},oA(e,t)};var iA="function"===typeof Map?void 0:function(){var e=0;return function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++e)}}(),aA=function(e){function t(t){return void 0===t&&(t=[]),e.call(this,t,iA)||this}return function(e,t){function n(){this.constructor=e}oA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(rA);const sA=aA;var lA=function(){return lA=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},lA.apply(this,arguments)};var cA=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(e,t){if(RT(e))for(var n in e)this.on(n,e[n]);else this._addEvent(e,t,{});return this},t.off=function(e,t){if(e)if(RT(e))for(var n in e)this.off(n);else if(t){var r=this._events[e];if(r){var o=YT(r,function(e){return e.listener===t});o>-1&&r.splice(o,1)}}else this._events[e]=[];else this._events={};return this},t.once=function(e,t){var n=this;return t&&this._addEvent(e,t,{once:!0}),new Promise(function(t){n._addEvent(e,t,{once:!0})})},t.emit=function(e,t){var n=this;void 0===t&&(t={});var r=this._events[e];if(!e||!r)return!0;var o=!1;return t.eventType=e,t.stop=function(){o=!0},t.currentTarget=this,function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}(r).forEach(function(r){r.listener(t),r.once&&n.off(e,r.listener)}),!o},t.trigger=function(e,t){return void 0===t&&(t={}),this.emit(e,t)},t._addEvent=function(e,t,n){var r=this._events;r[e]=r[e]||[],r[e].push(lA({listener:t},n))},e}();const dA=cA;var uA=function(e,t){return uA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},uA(e,t)};var pA=function(){return pA=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},pA.apply(this,arguments)};function hA(e){var t=e.container;return t===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function fA(e,t){return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}function gA(e){return e?FT(e)?document.querySelector(e):BT(e)?e():e instanceof Element?e:"current"in e?e.current:"value"in e?e.value:void 0:null}var mA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._startRect=null,t._startPos=[],t._prevTime=0,t._timer=0,t._prevScrollPos=[0,0],t._isWait=!1,t._flag=!1,t._currentOptions=null,t._lock=!1,t._unregister=null,t._onScroll=function(){var e=t._currentOptions;!t._lock&&e&&t.emit("scrollDrag",{next:function(n){t.checkScroll({container:e.container,inputEvent:n})}})},t}!function(e,t){function n(){this.constructor=e}uA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e);var n=t.prototype;return n.dragStart=function(e,t){var n=gA(t.container);if(n){var r=0,o=0,i=0,a=0;if(n===document.body)i=window.innerWidth,a=window.innerHeight;else{var s=n.getBoundingClientRect();r=s.top,o=s.left,i=s.width,a=s.height}this._flag=!0,this._startPos=[e.clientX,e.clientY],this._startRect={top:r,left:o,width:i,height:a},this._prevScrollPos=this._getScrollPosition([0,0],t),this._currentOptions=t,this._registerScrollEvent(t)}else this._flag=!1},n.drag=function(e,t){if(clearTimeout(this._timer),this._flag){var n=e.clientX,r=e.clientY,o=t.threshold,i=void 0===o?0:o,a=this._startRect,s=this._startPos;this._currentOptions=t;var l=[0,0];return a.top>r-i?(s[1]>a.top||r<s[1])&&(l[1]=-1):a.top+a.height<r+i&&(s[1]<a.top+a.height||r>s[1])&&(l[1]=1),a.left>n-i?(s[0]>a.left||n<s[0])&&(l[0]=-1):a.left+a.width<n+i&&(s[0]<a.left+a.width||n>s[0])&&(l[0]=1),!(!l[0]&&!l[1])&&this._continueDrag(pA(pA({},t),{direction:l,inputEvent:e,isDrag:!0}))}},n.checkScroll=function(e){var t=this;if(this._isWait)return!1;var n=e.prevScrollPos,r=void 0===n?this._prevScrollPos:n,o=e.direction,i=e.throttleTime,a=void 0===i?0:i,s=e.inputEvent,l=e.isDrag,c=this._getScrollPosition(o||[0,0],e),d=c[0]-r[0],u=c[1]-r[1],p=o||[d?Math.abs(d)/d:0,u?Math.abs(u)/u:0];return this._prevScrollPos=c,this._lock=!1,!(!d&&!u)&&(this.emit("move",{offsetX:p[0]?d:0,offsetY:p[1]?u:0,inputEvent:s}),a&&l&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){t._continueDrag(e)},a)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(e,t){var n=t.container,r=t.getScrollPosition;return(void 0===r?hA:r)({container:gA(n),direction:e})},n._continueDrag=function(e){var t,n=this,r=e.container,o=e.direction,i=e.throttleTime,a=e.useScroll,s=e.isDrag,l=e.inputEvent;if(!(!this._flag||s&&this._isWait)){var c=XT(),d=Math.max(i+this._prevTime-c,0);if(d>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){n._continueDrag(e)},d),!1;this._prevTime=c;var u=this._getScrollPosition(o,e);this._prevScrollPos=u,s&&(this._isWait=!0),a||(this._lock=!0);var p={container:gA(r),direction:o,inputEvent:l};return null===(t=e.requestScroll)||void 0===t||t.call(e,p),this.emit("scroll",p),this._isWait=!1,a||this.checkScroll(pA(pA({},e),{prevScrollPos:u,direction:o,inputEvent:l}))}},n._registerScrollEvent=function(e){this._unregisterScrollEvent();var t=e.checkScrollEvent;if(t){var n=!0===t?fA:t,r=gA(e.container);!0!==t||r!==document.body&&r!==document.documentElement?this._unregister=n(r,this._onScroll):this._unregister=fA(window,this._onScroll)}},n._unregisterScrollEvent=function(){var e;null===(e=this._unregister)||void 0===e||e.call(this),this._unregister=null},t}(dA);const vA=mA;function yA(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}function xA(e){return aI(e,TT)}function bA(e){return e.length<3?0:Math.abs(function(e){for(var t=0,n=e.length-1;n>=0;--n)t+=e[n];return t}(e.map(function(t,n){var r=e[n+1]||e[0];return t[0]*r[1]-r[0]*t[1]})))/2}function wA(e,t){var n=t.width,r=t.height,o=t.left,i=t.top,a=SA(e),s=a.minX,l=a.minY,c=a.maxX,d=a.maxY,u=n/(c-s),p=r/(d-l);return e.map(function(e){return[o+(e[0]-s)*u,i+(e[1]-l)*p]})}function SA(e){var t=e.map(function(e){return e[0]}),n=e.map(function(e){return e[1]});return{minX:Math.min.apply(Math,t),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,t),maxY:Math.max.apply(Math,n)}}function kA(e,t,n){var r=e[0],o=e[1],i=SA(t),a=i.minX,s=i.maxX,l=[[a,o],[s,o]],c=CA(l[0],l[1]),d=EA(t),u=[];if(d.forEach(function(t){var n,r=CA(t[0],t[1]),i=t[0];(n=r,c.every(function(e,t){return 0===xA(e-n[t])}))?u.push({pos:e,line:t,type:"line"}):_A(jA(c,r),[l,t]).forEach(function(e){t.some(function(t){return r=e,!xA((n=t)[0]-r[0])&&!xA(n[1]-r[1]);var n,r})?u.push({pos:e,line:t,type:"point"}):0!==xA(i[1]-o)&&u.push({pos:e,line:t,type:"intersection"})})}),!n&&qT(u,function(e){return e[0]===r}))return!0;var p=0,h={};return u.forEach(function(e){var t=e.pos,n=e.type,i=e.line;if(!(t[0]>r))if("intersection"===n)++p;else{if("line"===n)return;if("point"===n){var a=qT(i,function(e){return e[1]!==o}),s=h[t[0]],l=a[1]>o?1:-1;s?s!==l&&++p:h[t[0]]=l}}}),p%2===1}function CA(e,t){var n=e[0],r=e[1],o=t[0]-n,i=t[1]-r;Math.abs(o)<TT&&(o=0),Math.abs(i)<TT&&(i=0);var a=0,s=0,l=0;return o?i?(s=1,l=-(a=-i/o)*n-r):(s=1,l=-r):i&&(a=-1,l=n),[a,s,l]}function jA(e,t){var n=e[0],r=e[1],o=e[2],i=t[0],a=t[1],s=t[2],l=0===n&&0===i,c=0===r&&0===a,d=[];if(l&&c)return[];if(l){var u=-o/r;return u!==-s/a?[]:[[-1/0,u],[1/0,u]]}if(c){var p=-o/n;return p!==-s/i?[]:[[p,-1/0],[p,1/0]]}if(0===n)d=[[h=-(a*(f=-o/r)+s)/i,f]];else if(0===i){d=[[h=-(r*(f=-s/a)+o)/n,f]]}else if(0===r){d=[[h=-o/n,f=-(i*h+s)/a]]}else if(0===a){d=[[h=-s/i,f=-(n*h+o)/r]]}else{var h,f;d=[[h=(r*s-a*o)/(a*n-r*i),f=-(n*h+o)/r]]}return d.map(function(e){return[e[0],e[1]]})}function _A(e,t){var n=t.map(function(e){return[0,1].map(function(t){return[Math.min(e[0][t],e[1][t]),Math.max(e[0][t],e[1][t])]})}),r=[];if(2===e.length){var o=e[0],i=o[0],a=o[1];if(xA(i-e[1][0])){if(!xA(a-e[1][1])){var s=Math.max.apply(Math,n.map(function(e){return e[0][0]})),l=Math.min.apply(Math,n.map(function(e){return e[0][1]}));if(xA(s-l)>0)return[];r=[[s,a],[l,a]]}}else{var c=Math.max.apply(Math,n.map(function(e){return e[1][0]})),d=Math.min.apply(Math,n.map(function(e){return e[1][1]}));if(xA(c-d)>0)return[];r=[[i,c],[i,d]]}}return r.length||(r=e.filter(function(e){var t=e[0],r=e[1];return n.every(function(e){return 0<=xA(t-e[0][0])&&0<=xA(e[0][1]-t)&&0<=xA(r-e[1][0])&&0<=xA(e[1][1]-r)})})),r.map(function(e){return[xA(e[0]),xA(e[1])]})}function EA(e){return yA(e.slice(1),[e[0]]).map(function(t,n){return[e[n],t]})}function DA(e,t){var n=e.slice(),r=t.slice();-1===oI(n)&&n.reverse(),-1===oI(r)&&r.reverse();var o=EA(n),i=EA(r),a=o.map(function(e){return CA(e[0],e[1])}),s=i.map(function(e){return CA(e[0],e[1])}),l=[];a.forEach(function(e,t){var n=o[t],a=[];s.forEach(function(r,o){var s=_A(jA(e,r),[n,i[o]]);a.push.apply(a,s.map(function(e){return{index1:t,index2:o,pos:e,type:"intersection"}}))}),a.sort(function(e,t){return iI(n[0],e.pos)-iI(n[0],t.pos)}),l.push.apply(l,a),kA(n[1],r)&&l.push({index1:t,index2:-1,pos:n[1],type:"inside"})}),i.forEach(function(e,t){if(kA(e[1],n)){var r=!1,o=YT(l,function(e){return e.index2===t?(r=!0,!1):!!r});-1===o&&(r=!1,o=YT(l,function(e){var n=e.index1,o=e.index2;return-1===n&&o+1===t?(r=!0,!1):!!r})),-1===o?l.push({index1:-1,index2:t,pos:e[1],type:"inside"}):l.splice(o,0,{index1:-1,index2:t,pos:e[1],type:"inside"})}});var c={};return l.filter(function(e){var t=e.pos,n=t[0]+"x"+t[1];return!c[n]&&(c[n]=!0,!0)})}function MA(e,t){var n=function(e,t){return DA(e,t).map(function(e){return e.pos})}(e,t);return bA(n)}var TA=function(e,t){return TA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},TA(e,t)};var IA=function(){return IA=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},IA.apply(this,arguments)};function AA(e){return function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=Math.atan2(r,n);return o>=0?o:o+2*Math.PI}([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function OA(e){return e?e.touches?function(e){for(var t=Math.min(e.length,2),n=[],r=0;r<t;++r)n.push(FA(e[r]));return n}(e.touches):[FA(e)]:[]}function RA(e,t,n){var r=n.length,o=PA(e,r),i=o.clientX,a=o.clientY,s=o.originalClientX,l=o.originalClientY,c=PA(t,r),d=c.clientX,u=c.clientY,p=PA(n,r);return{clientX:s,clientY:l,deltaX:i-d,deltaY:a-u,distX:i-p.clientX,distY:a-p.clientY}}function zA(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function FA(e){return{clientX:e.clientX,clientY:e.clientY}}function PA(e,t){void 0===t&&(t=e.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(e.length,t),o=0;o<r;++o){var i=e[o];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return t?{clientX:n.clientX/t,clientY:n.clientY/t,originalClientX:n.originalClientX/t,originalClientY:n.originalClientY/t}:n}var BA=function(){function e(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return e.prototype.getAngle=function(e){return void 0===e&&(e=this.prevClients),AA(e)},e.prototype.getRotation=function(e){return void 0===e&&(e=this.prevClients),AA(e)-AA(this.startClients)},e.prototype.getPosition=function(e,t){void 0===e&&(e=this.prevClients);var n=RA(e||this.prevClients,this.prevClients,this.startClients),r=n.deltaX,o=n.deltaY;return this.movement+=Math.sqrt(r*r+o*o),this.prevClients=e,n},e.prototype.getPositions=function(e){void 0===e&&(e=this.prevClients);for(var t=this.prevClients,n=this.startClients,r=Math.min(this.length,t.length),o=[],i=0;i<r;++i)o[i]=RA([e[i]],[t[i]],[n[i]]);return o},e.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var n=PA(e,this.length),r=PA(this.prevClients,this.length),o=n.clientX-r.clientX,i=n.clientY-r.clientY;return Math.sqrt(o*o+i*i)+t},e.prototype.getDistance=function(e){return void 0===e&&(e=this.prevClients),zA(e)},e.prototype.getScale=function(e){return void 0===e&&(e=this.prevClients),zA(e)/zA(this.startClients)},e.prototype.move=function(e,t){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=t}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=t})},e}(),LA=["textarea","input"],NA=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;r.options={},r.flag=!1,r.pinchFlag=!1,r.data={},r.isDrag=!1,r.isPinch=!1,r.clientStores=[],r.targets=[],r.prevTime=0,r.doubleFlag=!1,r._useMouse=!1,r._useTouch=!1,r._useDrag=!1,r._dragFlag=!1,r._isTrusted=!1,r._isMouseEvent=!1,r._isSecondaryButton=!1,r._preventMouseEvent=!1,r._prevInputEvent=null,r._isDragAPI=!1,r._isIdle=!0,r._preventMouseEventId=0,r._window=window,r.onDragStart=function(e,t){if(void 0===t&&(t=!0),r.flag||!1!==e.cancelable){var n=e.type.indexOf("drag")>=-1;if(!r.flag||!n){r._isDragAPI=!0;var o=r.options,i=o.container,a=o.pinchOutside,s=o.preventWheelClick,l=o.preventRightClick,c=o.preventDefault,d=o.checkInput,u=o.dragFocusedInput,p=o.preventClickEventOnDragStart,h=o.preventClickEventOnDrag,f=o.preventClickEventByCondition,g=r._useTouch,m=!r.flag;if(r._isSecondaryButton=3===e.which||2===e.button,s&&(2===e.which||1===e.button)||l&&(3===e.which||2===e.button))return r.stop(),!1;if(m){var v=r._window.document.activeElement,y=e.target;if(y){var x=y.tagName.toLowerCase(),b=LA.indexOf(x)>-1,w=y.isContentEditable;if(b||w){if(d||!u&&v===y)return!1;if(v&&(v===y||w&&v.isContentEditable&&v.contains(y))){if(!u)return!1;y.blur()}}else if((c||"touchstart"===e.type)&&v){var S=v.tagName.toLowerCase();(v.isContentEditable||LA.indexOf(S)>-1)&&v.blur()}(p||h||f)&&uI(r._window,"click",r._onClick,!0)}r.clientStores=[new BA(OA(e))],r._isIdle=!1,r.flag=!0,r.isDrag=!1,r._isTrusted=t,r._dragFlag=!0,r._prevInputEvent=e,r.data={},r.doubleFlag=XT()-r.prevTime<200,r._isMouseEvent=function(e){return e&&(e.type.indexOf("mouse")>-1||"button"in e)}(e),!r._isMouseEvent&&r._preventMouseEvent&&r._allowMouseEvent(),!1===(r._preventMouseEvent||r.emit("dragStart",IA(IA({data:r.data,datas:r.data,inputEvent:e,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,isTrusted:t,isDouble:r.doubleFlag},r.getCurrentStore().getPosition()),{preventDefault:function(){e.preventDefault()},preventDrag:function(){r._dragFlag=!1}})))&&r.stop(),r._isMouseEvent&&r.flag&&c&&e.preventDefault()}if(!r.flag)return!1;var k=0;if(m?(r._attchDragEvent(),g&&a&&(k=setTimeout(function(){uI(i,"touchstart",r.onDragStart,{passive:!1})}))):g&&a&&pI(i,"touchstart",r.onDragStart),r.flag&&function(e){return e.touches&&e.touches.length>=2}(e)){if(clearTimeout(k),m&&e.touches.length!==e.changedTouches.length)return;r.pinchFlag||r.onPinchStart(e)}}}},r.onDrag=function(e,t){if(r.flag){var n=r.options.preventDefault;!r._isMouseEvent&&n&&e.preventDefault(),r._prevInputEvent=e;var o=OA(e),i=r.moveClients(o,e,!1);if(r._dragFlag){if(r.pinchFlag||i.deltaX||i.deltaY)if(!1===(r._preventMouseEvent||r.emit("drag",IA(IA({},i),{isScroll:!!t,inputEvent:e}))))return void r.stop();r.pinchFlag&&r.onPinch(e,o)}r.getCurrentStore().getPosition(o,!0)}},r.onDragEnd=function(e){if(r.flag){var t=r.options,n=t.pinchOutside,o=t.container,i=t.preventClickEventOnDrag,a=t.preventClickEventOnDragStart,s=t.preventClickEventByCondition,l=r.isDrag;(i||a||s)&&requestAnimationFrame(function(){r._allowClickEvent()}),s||a||!i||l||r._allowClickEvent(),r._useTouch&&n&&pI(o,"touchstart",r.onDragStart),r.pinchFlag&&r.onPinchEnd(e);var c=(null===e||void 0===e?void 0:e.touches)?OA(e):[];0!==c.length&&r.options.keepDragging?r._addStore(new BA(c)):r.flag=!1;var d=r._getPosition(),u=XT(),p=!l&&r.doubleFlag;r._prevInputEvent=null,r.prevTime=l||p?0:u,r.flag||(r._dettachDragEvent(),r._preventMouseEvent||r.emit("dragEnd",IA({data:r.data,datas:r.data,isDouble:p,isDrag:l,isClick:!l,isMouseEvent:r._isMouseEvent,isSecondaryButton:r._isSecondaryButton,inputEvent:e,isTrusted:r._isTrusted},d)),r.clientStores=[],r._isMouseEvent||(r._preventMouseEvent=!0,clearTimeout(r._preventMouseEventId),r._preventMouseEventId=setTimeout(function(){r._preventMouseEvent=!1},200)),r._isIdle=!0)}},r.onBlur=function(){r.onDragEnd()},r._allowClickEvent=function(){pI(r._window,"click",r._onClick,!0)},r._onClick=function(e){r._allowClickEvent(),r._allowMouseEvent();var t=r.options.preventClickEventByCondition;(null===t||void 0===t?void 0:t(e))||(e.stopPropagation(),e.preventDefault())},r._onContextMenu=function(e){r.options.preventRightClick?r.onDragEnd(e):e.preventDefault()},r._passCallback=function(){};var o=[].concat(t),i=o[0];r._window=vI(i)?i:mI(i),r.options=IA({checkInput:!1,container:i&&!("document"in i)?mI(i):i,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var a=r.options,s=a.container,l=a.events,c=a.checkWindowBlur;if(r._useDrag=l.indexOf("drag")>-1,r._useTouch=l.indexOf("touch")>-1,r._useMouse=l.indexOf("mouse")>-1,r.targets=o,r._useDrag&&o.forEach(function(e){uI(e,"dragstart",r.onDragStart)}),r._useMouse&&(o.forEach(function(e){uI(e,"mousedown",r.onDragStart),uI(e,"mousemove",r._passCallback)}),uI(s,"contextmenu",r._onContextMenu)),c&&uI(mI(),"blur",r.onBlur),r._useTouch){var d={passive:!1};o.forEach(function(e){uI(e,"touchstart",r.onDragStart,d),uI(e,"touchmove",r._passCallback,d)})}return r}return function(e,t){function n(){this.constructor=e}TA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},t.prototype.getMovement=function(e){return this.getCurrentStore().getMovement(e)+this.clientStores.slice(1).reduce(function(e,t){return e+t.movement},0)},t.prototype.isDragging=function(){return this.isDrag},t.prototype.isIdle=function(){return this._isIdle},t.prototype.isFlag=function(){return this.flag},t.prototype.isPinchFlag=function(){return this.pinchFlag},t.prototype.isDoubleFlag=function(){return this.doubleFlag},t.prototype.isPinching=function(){return this.isPinch},t.prototype.scrollBy=function(e,t,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(e,t),r&&this.onDrag(n,!0))},t.prototype.move=function(e,t){var n=e[0],r=e[1],o=this.getCurrentStore().prevClients;return this.moveClients(o.map(function(e){var t=e.clientX,o=e.clientY;return{clientX:t+n,clientY:o+r,originalClientX:t,originalClientY:o}}),t,!0)},t.prototype.triggerDragStart=function(e){this.onDragStart(e,!1)},t.prototype.setEventData=function(e){var t=this.data;for(var n in e)t[n]=e[n];return this},t.prototype.setEventDatas=function(e){return this.setEventData(e)},t.prototype.getCurrentEvent=function(e){return void 0===e&&(e=this._prevInputEvent),IA(IA({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},t.prototype.getEventData=function(){return this.data},t.prototype.getEventDatas=function(){return this.data},t.prototype.unset=function(){var e=this,t=this.targets,n=this.options.container;this.off(),pI(this._window,"blur",this.onBlur),this._useDrag&&t.forEach(function(t){pI(t,"dragstart",e.onDragStart)}),this._useMouse&&(t.forEach(function(t){pI(t,"mousedown",e.onDragStart)}),pI(n,"contextmenu",this._onContextMenu)),this._useTouch&&(t.forEach(function(t){pI(t,"touchstart",e.onDragStart)}),pI(n,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},t.prototype.onPinchStart=function(e){var t=this,n=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>n)){var r=new BA(OA(e));this.pinchFlag=!0,this._addStore(r),!1===this.emit("pinchStart",IA(IA({data:this.data,datas:this.data,angle:r.getAngle(),touches:this.getCurrentStore().getPositions()},r.getPosition()),{inputEvent:e,isTrusted:this._isTrusted,preventDefault:function(){e.preventDefault()},preventDrag:function(){t._dragFlag=!1}}))&&(this.pinchFlag=!1)}},t.prototype.onPinch=function(e,t){if(this.flag&&this.pinchFlag&&!(t.length<2)){var n=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",IA(IA({data:this.data,datas:this.data,movement:this.getMovement(t),angle:n.getAngle(t),rotation:n.getRotation(t),touches:n.getPositions(t),scale:n.getScale(t),distance:n.getDistance(t)},n.getPosition(t)),{inputEvent:e,isTrusted:this._isTrusted}))}},t.prototype.onPinchEnd=function(e){if(this.pinchFlag){var t=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.getCurrentStore();this.emit("pinchEnd",IA(IA({data:this.data,datas:this.data,isPinch:t,touches:n.getPositions()},n.getPosition()),{inputEvent:e}))}},t.prototype.getCurrentStore=function(){return this.clientStores[0]},t.prototype.moveClients=function(e,t,n){var r=this._getPosition(e,n),o=this.isDrag;(r.deltaX||r.deltaY)&&(this.isDrag=!0);var i=!1;return!o&&this.isDrag&&(i=!0),IA(IA({data:this.data,datas:this.data},r),{movement:this.getMovement(e),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:t,isTrusted:this._isTrusted,isFirstDrag:i})},t.prototype._addStore=function(e){this.clientStores.splice(0,0,e)},t.prototype._getPosition=function(e,t){var n=this.getCurrentStore().getPosition(e,t),r=this.clientStores.slice(1).reduce(function(e,t){var n=t.getPosition();return e.distX+=n.distX,e.distY+=n.distY,e},n),o=r.distX,i=r.distY;return IA(IA({},n),{distX:o,distY:i})},t.prototype._attchDragEvent=function(){var e=this._window,t=this.options.container,n={passive:!1};this._isDragAPI&&(uI(t,"dragover",this.onDrag,n),uI(e,"dragend",this.onDragEnd)),this._useMouse&&(uI(t,"mousemove",this.onDrag),uI(e,"mouseup",this.onDragEnd)),this._useTouch&&(uI(t,"touchmove",this.onDrag,n),uI(e,"touchend",this.onDragEnd,n),uI(e,"touchcancel",this.onDragEnd,n))},t.prototype._dettachDragEvent=function(){var e=this._window,t=this.options.container;this._isDragAPI&&(pI(t,"dragover",this.onDrag),pI(e,"dragend",this.onDragEnd)),this._useMouse&&(pI(t,"mousemove",this.onDrag),pI(e,"mouseup",this.onDragEnd)),this._useTouch&&(pI(t,"touchstart",this.onDragStart),pI(t,"touchmove",this.onDrag),pI(e,"touchend",this.onDragEnd),pI(e,"touchcancel",this.onDragEnd))},t.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},t}(dA);var UA=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0};function VA(e,t,n,r,o){var i=hI(r),a=i.createElement("style");return a.setAttribute("type","text/css"),a.setAttribute("data-styled-id",e),a.setAttribute("data-styled-count","1"),n.nonce&&a.setAttribute("nonce",n.nonce),a.innerHTML=function(e,t,n){return n.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(t,n){var r=n.trim();return(r?WT(r):[""]).map(function(t){var n=t.trim();return 0===n.indexOf("@")?n:n.indexOf(":global")>-1?n.replace(/\:global/g,""):n.indexOf(":host")>-1?"".concat(n.replace(/\:host/g,".".concat(e))):n?".".concat(e," ").concat(n):".".concat(e)}).join(", ")+" {"})}(e,t,n),(o||i.head||i.body).appendChild(a),a}const WA=function(e){var t="rCS"+UA(e).toString(36);return{className:t,inject:function(n,r){void 0===r&&(r={});var o=function(e){if(e&&e.getRootNode){var t=e.getRootNode();if(11===t.nodeType)return t}}(n),i=(o||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(t,'"]'));if(i){var a=parseFloat(i.getAttribute("data-styled-count"))||0;i.setAttribute("data-styled-count","".concat(a+1))}else i=VA(t,e,r,n,o);return{destroy:function(){var e,t=parseFloat(i.getAttribute("data-styled-count"))||0;t<=1?(i.remove?i.remove():null===(e=i.parentNode)||void 0===e||e.removeChild(i),i=null):i.setAttribute("data-styled-count","".concat(t-1))}}}}};var HA=function(){return HA=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},HA.apply(this,arguments)};function GA(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function XA(t,n){var r=WA(n),o=r.className;return(0,e.forwardRef)(function(n,i){var a=n.className,s=void 0===a?"":a,l=(n.cspNonce,GA(n,["className","cspNonce"])),c=(0,e.useRef)();return(0,e.useImperativeHandle)(i,function(){return c.current},[]),(0,e.useEffect)(function(){var e=r.inject(c.current,{nonce:n.cspNonce});return function(){e.destroy()}},[]),(0,e.createElement)(t,HA({ref:c,"data-styled-id":o,className:"".concat(s," ").concat(o)},l))})}var YA=function(e,t){return YA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},YA(e,t)};function qA(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}YA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ZA=function(){return ZA=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ZA.apply(this,arguments)};function $A(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function KA(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function JA(e,t){return ZA({events:[],props:[],name:e},t)}var QA=["n","w","s","e"],eO=["n","w","s","e","nw","ne","sw","se"];var tO=ST(),nO=tO.browser.webkit,rO=nO&&function(){var e="undefined"===typeof window?{userAgent:""}:window.navigator,t=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase());return!!t&&parseFloat(t[1])<605}(),oO=tO.browser.name,iO=parseInt(tO.browser.version,10),aO="chrome"===oO,sO=tO.browser.chromium,lO=parseInt(tO.browser.chromiumVersion,10)||0,cO=aO&&iO>=109||sO&&lO>=109,dO="firefox"===oO,uO=parseInt(tO.browser.webkitVersion,10)>=612||iO>=15,pO="moveable-",hO=eO.map(function(e){var t="",n="",r="center",o="center",i="calc(var(--moveable-control-padding, 20) * -1px)";return e.indexOf("n")>-1&&(t="top: ".concat(i,";"),o="bottom"),e.indexOf("s")>-1&&(t="top: 0px;",o="top"),e.indexOf("w")>-1&&(n="left: ".concat(i,";"),r="right"),e.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(e,'"] {\n        ').concat(n).concat(t,"\n        transform-origin: ").concat(r," ").concat(o,";\n    }")}).join("\n"),fO="\n{\nposition: absolute;\nwidth: 1px;\nheight: 1px;\nleft: 0;\ntop: 0;\nz-index: 3000;\n--moveable-color: #4af;\n--zoom: 1;\n--zoompx: 1px;\n--moveable-line-padding: 0;\n--moveable-control-padding: 0;\nwill-change: transform;\noutline: 1px solid transparent;\n}\n.control-box {\nz-index: 0;\n}\n.line, .control {\nposition: absolute;\nleft: 0;\ntop: 0;\nwill-change: transform;\n}\n.control {\nwidth: 14px;\nheight: 14px;\nborder-radius: 50%;\nborder: 2px solid #fff;\nbox-sizing: border-box;\nbackground: #4af;\nbackground: var(--moveable-color);\nmargin-top: -7px;\nmargin-left: -7px;\nborder: 2px solid #fff;\nz-index: 10;\n}\n.around-control {\nposition: absolute;\nwill-change: transform;\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\nheight: calc(var(--moveable-control-padding, 20) * 1px);\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\nbox-sizing: border-box;\nbackground: transparent;\nz-index: 8;\ncursor: alias;\ntransform-origin: center center;\n}\n".concat(hO,"\n.padding {\nposition: absolute;\ntop: 0px;\nleft: 0px;\nwidth: 100px;\nheight: 100px;\ntransform-origin: 0 0;\n}\n.line {\nwidth: 1px;\nheight: 1px;\nbackground: #4af;\nbackground: var(--moveable-color);\ntransform-origin: 0px 50%;\n}\n.line.edge {\nz-index: 1;\nbackground: transparent;\n}\n.line.dashed {\nbox-sizing: border-box;\nbackground: transparent;\n}\n.line.dashed.horizontal {\nborder-top: 1px dashed #4af;\nborder-top-color: #4af;\nborder-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\nborder-left: 1px dashed #4af;\nborder-left-color: #4af;\nborder-left-color: var(--moveable-color);\n}\n.line.vertical {\ntransform: translateX(-50%);\n}\n.line.horizontal {\ntransform: translateY(-50%);\n}\n.line.vertical.bold {\nwidth: 2px;\n}\n.line.horizontal.bold {\nheight: 2px;\n}\n\n.control.origin {\nborder-color: #f55;\nbackground: #fff;\nwidth: 12px;\nheight: 12px;\nmargin-top: -6px;\nmargin-left: -6px;\npointer-events: none;\n}\n").concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return'\n.direction[data-rotation="'.concat(e,'"], :global .view-control-rotation').concat(e," {\n").concat(function(e){var t=function(e,t){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(t,'deg);transform-origin: 16px 16px"></path></svg>')}(1,e),n=45*Math.round(e/45)%180,r="ns-resize";return 135===n?r="nwse-resize":45===n?r="nesw-resize":90===n&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(t,"') 16 16, ").concat(r,";")}(e),"\n}\n")}).join("\n"),'\n\n.line.direction:before {\ncontent: "";\nposition: absolute;\nwidth: 100%;\nheight: calc(var(--moveable-line-padding, 0) * 1px);\nbottom: 0;\nleft: 0;\n}\n.group {\nz-index: -1;\n}\n.area {\nposition: absolute;\n}\n.area-pieces {\nposition: absolute;\ntop: 0;\nleft: 0;\ndisplay: none;\n}\n.area.avoid, .area.pass {\npointer-events: none;\n}\n.area.avoid+.area-pieces {\ndisplay: block;\n}\n.area-piece {\nposition: absolute;\n}\n\n').concat(rO?':global svg *:before {\ncontent:"";\ntransform-origin: inherit;\n}':"","\n"),gO=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],mO=1e-4,vO=1e-7,yO=1e-9,xO=Math.pow(10,10),bO=-xO,wO={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},SO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},kO={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},CO=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function jO(e,t,n,r,o,i){var a,s;void 0===i&&(i="draggable");var l=null!==(s=null===(a=t.gestos[i])||void 0===a?void 0:a.move(n,e.inputEvent))&&void 0!==s?s:{},c=l.originalDatas||l.datas,d=c[i]||(c[i]={});return ZA(ZA({},o?zF(t,l):l),{isPinch:!!r,parentEvent:!0,datas:d,originalDatas:e.originalDatas})}var _O=function(){function e(e){var t;void 0===e&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=((t={})[e]={},t)}return e.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var n=t.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),ZA(ZA({},this.move(e,t.inputEvent)),{type:"dragstart"})},e.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},e.prototype.move=function(e,t){var n,r,o=!1;if(this.isFlag){var i=this.isDrag;n=this.prevX+e[0],r=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!i&&this.isDrag&&(o=!0)}else this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],r=e[1],this.isFlag=!0;return this.prevX=n,this.prevY=r,{type:"drag",clientX:n,clientY:r,inputEvent:t,isFirstDrag:o,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e}();function EO(e,t,n,r){var o=16===e.length?4:3,i=$A(nF(e,n,r,o),4),a=$A(i[0],2),s=a[0],l=a[1],c=$A(i[1],2),d=c[0],u=c[1],p=$A(i[2],2),h=p[0],f=p[1],g=$A(i[3],2),m=g[0],v=g[1],y=$A(tF(e,t,o),2),x=y[0],b=y[1],w=Math.min(s,d,h,m),S=Math.min(l,u,f,v),k=Math.max(s,d,h,m);return s=s-w||0,{left:w,top:S,right:k,bottom:Math.max(l,u,f,v),origin:[x=x-w||0,b=b-S||0],pos1:[s,l=l-S||0],pos2:[d=d-w||0,u=u-S||0],pos3:[h=h-w||0,f=f-S||0],pos4:[m=m-w||0,v=v-S||0],direction:$F(e[0]*e[o+1])}}function DO(e,t){var n=t.clientX,r=t.clientY,o=t.datas,i=e.state,a=i.moveableClientRect,s=i.rootMatrix,l=i.is3d,c=i.pos1,d=$A(TI(RF(s,[n-a.left,r-a.top],l?4:3),c),2),u=$A(zO({datas:o,distX:d[0],distY:d[1]}),2);return[u[0],u[1]]}function MO(e,t){var n=t.datas,r=e.state,o=r.allMatrix,i=r.beforeMatrix,a=r.is3d,s=r.left,l=r.top,c=r.origin,d=r.offsetMatrix,u=r.targetMatrix,p=r.transformOrigin,h=a?4:3;n.is3d=a,n.matrix=o,n.targetMatrix=u,n.beforeMatrix=i,n.offsetMatrix=d,n.transformOrigin=p,n.inverseMatrix=kI(o,h),n.inverseBeforeMatrix=kI(i,h),n.absoluteOrigin=jI(MI([s,l],c),h),n.startDragBeforeDist=OI(n.inverseBeforeMatrix,n.absoluteOrigin,h),n.startDragDist=OI(n.inverseMatrix,n.absoluteOrigin,h)}function TO(e,t,n){var r=t.datas,o=t.originalDatas.beforeRenderable,i=r.transformIndex,a=o.nextTransforms,s=a.length,l=o.nextTransformAppendedIndexes,c=-1;-1===i?("translate"===n?c=0:"rotate"===n&&(c=YT(a,function(e){return e.match(/scale\(/g)})),-1===c&&(c=a.length),r.transformIndex=c):c=qT(l,function(e){return e.index===i&&e.functionName===n})?i:i+l.filter(function(e){return e.index<i}).length;var d=function(e,t,n){var r,o=ZI(e,{"x%":function(e){return e/100*t.offsetWidth},"y%":function(e){return e/100*t.offsetHeight}}),i=e.slice(0,n<0?void 0:n),a=e.slice(0,n<0?void 0:n+1),s=e[n]||"",l=n<0?[]:e.slice(n),c=n<0?[]:e.slice(n+1),d=o.slice(0,n<0?void 0:n),u=o.slice(0,n<0?void 0:n+1),p=null!==(r=o[n])&&void 0!==r?r:ZI([""])[0],h=n<0?[]:o.slice(n),f=n<0?[]:o.slice(n+1),g=p?[p]:[],m=qI(d),v=qI(u),y=qI(h),x=qI(f),b=DI(m,y,4);return{transforms:e,beforeFunctionMatrix:m,beforeFunctionMatrix2:v,targetFunctionMatrix:qI(g),afterFunctionMatrix:y,afterFunctionMatrix2:x,allFunctionMatrix:b,beforeFunctions:d,beforeFunctions2:u,targetFunction:g[0],afterFunctions:h,afterFunctions2:f,beforeFunctionTexts:i,beforeFunctionTexts2:a,targetFunctionText:s,afterFunctionTexts:l,afterFunctionTexts2:c}}(a,e.state,c),u=d.targetFunction,p="rotate"===n?"rotateZ":n;r.beforeFunctionTexts=d.beforeFunctionTexts,r.afterFunctionTexts=d.afterFunctionTexts,r.beforeTransform=d.beforeFunctionMatrix,r.beforeTransform2=d.beforeFunctionMatrix2,r.targetTansform=d.targetFunctionMatrix,r.afterTransform=d.afterFunctionMatrix,r.afterTransform2=d.afterFunctionMatrix2,r.targetAllTransform=d.allFunctionMatrix,u.functionName===p?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):s>c&&(r.isAppendTransform=!0,o.nextTransformAppendedIndexes=KA(KA([],$A(l),!1),[{functionName:n,index:c,isAppend:!0}],!1))}function IO(e,t,n){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?n:t," ").concat(e.afterFunctionTexts.join(" "))}function AO(e){var t=e.datas,n=$A(RO({datas:t,distX:e.distX,distY:e.distY}),2),r=OO(t,function(e,t){for(var n=VI(t),r=0;r<t-1;++r)n[t*(t-1)+r]=e[r]||0;return n}([n[0],n[1]],4));return OI(r,jI([0,0,0],4),4)}function OO(e,t,n){var r=e.beforeTransform,o=e.afterTransform,i=e.beforeTransform2,a=e.afterTransform2,s=e.targetAllTransform,l=n?DI(s,t,4):DI(t,s,4),c=DI(kI(n?i:r,4),l,4);return DI(c,kI(n?a:o,4),4)}function RO(e){var t=e.datas,n=e.distX,r=e.distY,o=t.inverseBeforeMatrix,i=t.is3d,a=t.startDragBeforeDist,s=i?4:3;return TI(OI(o,MI(t.absoluteOrigin,[n,r]),s),a)}function zO(e,t){var n=e.datas,r=e.distX,o=e.distY,i=n.inverseBeforeMatrix,a=n.inverseMatrix,s=n.is3d,l=n.startDragBeforeDist,c=n.startDragDist,d=s?4:3;return TI(OI(t?i:a,MI(n.absoluteOrigin,[r,o]),d),t?l:c)}function FO(e){var t=[];return e[1]>=0&&(e[0]>=0&&t.push(3),e[0]<=0&&t.push(2)),e[1]<=0&&(e[0]>=0&&t.push(1),e[0]<=0&&t.push(0)),t}function PO(e,t){var n=(t+1)/2;return[AT(e[0][0],e[1][0],n,1-n),AT(e[0][1],e[1][1],n,1-n)]}function BO(e,t){var n=PO([e[0],e[1]],t[0]),r=PO([e[2],e[3]],t[0]);return PO([n,r],t[1])}function LO(e,t,n,r){return DI(e,Wz(t,r,n),r)}function NO(e,t){var n=HO(t);return{setTransform:function(r,o){void 0===o&&(o=-1),n.startTransforms=zT(r)?r:VT(r),VO(e,t,o)},setTransformIndex:function(n){VO(e,t,n)}}}function UO(e,t,n){VO(e,t,YT(HO(t).startTransforms,function(e){return 0===e.indexOf("".concat(n,"("))}))}function VO(e,t,n){var r=HO(t),o=t.datas;if(o.transformIndex=n,-1!==n){var i=r.startTransforms[n];if(i){var a=e.state,s=ZI([i],{"x%":function(e){return e/100*a.offsetWidth},"y%":function(e){return e/100*a.offsetHeight}});o.startValue=s[0].functionValue}}}function WO(e,t){HO(e).nextTransforms=VT(t)}function HO(e){return e.originalDatas.beforeRenderable}function GO(e){return e.originalDatas.beforeRenderable.nextTransforms}function XO(e){return(GO(e)||[]).join(" ")}function YO(e){return HO(e).nextStyle}function qO(e,t,n,r,o){WO(o,t);var i=az.drag(e,jO(o,e.state,n,r,!1)),a=i?i.transform:t;return ZA(ZA({transform:t,drag:i},wF({transform:a},o)),{afterTransform:a})}function ZO(e,t,n,r,o,i){var a=function(e,t,n,r){var o,i=e.transformOrigin,a=e.offsetMatrix,s=e.is3d?4:3;if(FT(n)){var l=t.beforeTransform,c=t.afterTransform;o=_I(r?YI(n):DI(DI(l,YI([n]),4),c,4),4,s)}else o=n;return LO(a,o,i,s)}(e.state,o,t,i),s=function(e,t,n,r){void 0===r&&(r=e.state.allMatrix);var o=e.state,i=o.width,a=o.height,s=o.is3d?4:3,l=[i/2*(1+t[0])+n[0],a/2*(1+t[1])+n[1]];return tF(r,l,s)}(e,n,r,a);return s}function $O(e,t,n,r,o,i,a){var s=ZO(e,t,n,o,i,a),l=e.state,c=l.left,d=l.top,u=e.props.groupable,p=u?c:0,h=u?d:0,f=TI(r,s);return TI(f,[p,h])}function KO(e,t,n,r,o,i){var a=e.props.groupable,s=e.state,l=s.transformOrigin,c=s.offsetMatrix,d=s.is3d,u=s.width,p=s.height,h=s.left,f=s.top,g=i.fixedDirection,m=i.nextTargetMatrix||s.targetMatrix,v=d?4:3,y=function(e,t,n,r,o,i){return void 0===r&&(r=t),void 0===o&&(o=n),void 0===i&&(i=[0,0]),e?e.map(function(e,a){var s=GT(e),l=s.value,c=s.unit,d=a?o:r,u=a?n:t;return"%"===e||isNaN(l)?u*(d?i[a]/d:0):"%"!==c?l:u*l/100}):i}(o,t,n,u,p,l),x=a?h:0,b=a?f:0,w=function(e,t,n,r,o,i){var a=BO(nF(t,n,r,o),i);return[e[0]-a[0],e[1]-a[1]]}(r,LO(c,m,y,v),t,n,v,g);return TI(w,[x,b])}function JO(e){if(e&&e.getRootNode){var t=e.getRootNode();if(11===t.nodeType)return t}}function QO(e){var t=e("scale"),n=e("rotate"),r=e("translate"),o=[];return r&&"0px"!==r&&"none"!==r&&o.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&"1"!==n&&"none"!==n&&o.push("rotate(".concat(n,")")),t&&"1"!==t&&"none"!==t&&o.push("scale(".concat(t.split(/\s+/).join(","),")")),o}function eR(e,t,n){for(var r,o,i,a=e,s=[],l=fI(e)||gI(e),c=!n&&e===t||e===l,d=c,u=!1,p=3,h=!1,f=Yz(t,t,!0).offsetParent,g=1;a&&!d;){d=c;var m=iR(a),v=m("position"),y=Xz(a),x="fixed"===v,b=QO(m),w=II(Vz(y)),S=void 0,k=!1,C=!1,j=0,_=0,E=0,D=0,M={hasTransform:!1,fixedContainer:null};x&&(h=!0,f=(M=Kz(a)).fixedContainer);var T=w.length;u||16!==T&&!b.length||(u=!0,p=4,$z(s),i&&(i=_I(i,3,4))),u&&9===T&&(w=_I(w,3,4));var I=qz(a,e),A=I.tagName,O=I.hasOffset,R=I.isSVG,z=I.origin,F=I.targetOrigin,P=$A(I.offset,2),B=P[0],L=P[1];"svg"===A&&!a.ownerSVGElement&&i&&(s.push({type:"target",target:a,matrix:eF(a,p)}),s.push({type:"offset",target:a,matrix:VI(p)}));var N=parseFloat(m("zoom"))||1;if(x)S=M.fixedContainer,k=!0;else{var U=Yz(a,t,!1,!0,m),V=U.offsetZoom;if(S=U.offsetParent,k=U.isEnd,C=U.isStatic,g*=V,(U.isCustomElement||1!==V)&&C)B-=S.offsetLeft,L-=S.offsetTop;else if(dO||cO){if(U.parentSlotElement){for(var W=S,H=0,G=0;W&&JO(W);)H+=W.offsetLeft,G+=W.offsetTop,W=W.offsetParent;B-=H,L-=G}}}if(!nO||uO||!O||R||!C||"relative"!==v&&"static"!==v||(B-=S.offsetLeft,L-=S.offsetTop,c=c||k),x)O&&M.hasTransform&&(E=S.clientLeft,D=S.clientTop);else if(O&&f!==S&&(j=S.clientLeft,_=S.clientTop),O&&S===l){var X=Zz(a,!1);B+=X[0],L+=X[1]}if(s.push({type:"target",target:a,matrix:Wz(w,p,z)}),b.length&&(s.push({type:"offset",target:a,matrix:VI(p)}),s.push({type:"target",target:a,matrix:Wz(YI(b),p,z)})),O){var Y=a===e,q=Y?0:a.scrollLeft,Z=Y?0:a.scrollTop;s.push({type:"offset",target:a,matrix:HI([B-q+j-E,L-Z+_-D],p)})}else s.push({type:"offset",target:a,origin:z});if(1!==N&&s.push({type:"zoom",target:a,matrix:Wz(WI([N,N],p),p,[0,0])}),i||(i=w),r||(r=z),o||(o=F),d||x)break;a=S,c=k,n&&a!==l||(d=c)}return i||(i=VI(p)),r||(r=[0,0]),o||(o=[0,0]),{zoom:g,offsetContainer:f,matrixes:s,targetMatrix:i,transformOrigin:r,targetOrigin:o,is3d:u,hasFixed:h}}var tR=null,nR=null,rR=null;function oR(e){e?(window.Map&&(tR=new Map,nR=new Map),rR=[]):(tR=null,rR=null,nR=null)}function iR(e){var t=null===tR||void 0===tR?void 0:tR.get(e);if(!t){var n=mI(e).getComputedStyle(e);if(!tR)return function(e){return n[e]};t={style:n,cached:{}},tR.set(e,t)}var r=t.cached,o=t.style;return function(e){return e in r||(r[e]=o[e]),r[e]}}function aR(e,t,n){var r=n.originalDatas;r.groupable=r.groupable||{};var o=r.groupable;o.childDatas=o.childDatas||[];var i=o.childDatas;return e.moveables.map(function(e,r){return i[r]=i[r]||{},i[r][t]=i[r][t]||{},ZA(ZA({},n),{isRequestChild:!0,datas:i[r][t],originalDatas:i[r]})})}function sR(e,t,n,r,o,i,a){var s=!!n.match(/Start$/g),l=!!n.match(/End$/g),c=o.isPinch,d=o.datas,u=aR(e,t.name,o),p=e.moveables,h=[],f=u.map(function(e,o){var u=p[o],f=u.state,g=f.gestos,m=e;if(s)m=new _O(a).dragStart(r,e),h.push(m);else{if(g[a]||(g[a]=d.childGestos[o]),!g[a])return;m=jO(e,f,r,c,i,a),h.push(m)}var v=t[n](u,ZA(ZA({},m),{parentFlag:!0}));return l&&(g[a]=null),v});return s&&(d.childGestos=p.map(function(e){return e.state.gestos[a]})),{eventParams:f,childEvents:h}}function lR(e,t,n,r,o,i){void 0===o&&(o=function(e,t){return t});var a=!!n.match(/End$/g),s=aR(e,t.name,r),l=e.moveables,c=s.map(function(e,r){var s,c=l[r];s=o(c,e);var d=t[n](c,ZA(ZA({},s),{parentFlag:!0}));return d&&i&&i(c,e,d,r),a&&(c.state.gestos={}),d});return c}function cR(e,t,n,r){var o=n.fixedDirection,i=n.fixedPosition,a=BO(r.datas.startPositions||yF(t.state),o),s=$A(OI(UI(-e.rotation/180*Math.PI,3),[a[0]-i[0],a[1]-i[1],1],3),2),l=s[0],c=s[1];return r.datas.originalX=l,r.datas.originalY=c,r}function dR(e,t,n,r){var o=e.getState(),i=o.renderPoses,a=o.rotation,s=o.direction,l=cF(e.props,t).zoom,c=Az(a/Math.PI*180),d={},u=e.renderState;u.renderDirectionMap||(u.renderDirectionMap={});var p=u.renderDirectionMap;n.forEach(function(e){var t=e.dir;d[t]=!0});var h=$F(s);return n.map(function(e){var n=e.data,o=e.classNames,s=e.dir,u=SO[s];if(!u||!d[s])return null;p[s]=!0;var f=(aI(c,15)+h*kO[s]+720)%180,g={};return KT(n).forEach(function(e){g["data-".concat(e)]=n[e]}),r.createElement("div",ZA({className:Nz.apply(void 0,KA(["control","direction",s,t],$A(o),!1)),"data-rotation":f,"data-direction":s},g,{key:"direction-".concat(s),style:lF.apply(void 0,KA([a,l],$A(u.map(function(e){return i[e]})),!1))}))})}function uR(e,t,n,r){var o=cF(e.props,n),i=o.renderDirections,a=void 0===i?t:i,s=o.displayAroundControls;if(!a)return[];var l=!0===a?eO:a;return KA(KA([],$A(s?mR(e,r,n,l):[]),!1),$A(dR(e,n,l.map(function(e){return{data:{},classNames:[],dir:e}}),r)),!1)}function pR(e,t,n,r,o,i){for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];var l=rI(n,r),c=t?aI(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(i),className:Nz.apply(void 0,KA(["line","direction",t?"edge":"",t],$A(a),!1)),"data-rotation":c,"data-line-key":i,"data-direction":t,style:sF(n,r,o,l)})}function hR(e,t,n,r,o){return(!0===n?QA:n).map(function(n,i){var a=$A(SO[n],2),s=a[0],l=a[1];if(null!=l)return pR(e,n,r[s],r[l],o,"".concat(t,"Edge").concat(i),t)}).filter(Boolean)}function fR(e){return function(t,n){var r=cF(t.props,e).edge;return r&&(!0===r||r.length)?KA(KA([],$A(hR(n,e,r,t.getState().renderPoses,t.props.zoom)),!1),$A(function(e,t,n){return uR(e,["nw","ne","sw","se"],t,n)}(t,e,n)),!1):gR(t,e,n)}}function gR(e,t,n){return uR(e,eO,t,n)}function mR(e,t,n,r){var o=e.renderState;o.renderDirectionMap||(o.renderDirectionMap={});var i=e.getState(),a=i.renderPoses,s=i.rotation,l=i.direction,c=o.renderDirectionMap,d=e.props.zoom,u=$F(l),p=s/Math.PI*180;return(r||KT(c)).map(function(e){var r=SO[e];if(!r)return null;var o=(aI(p,15)+u*kO[e]+720)%180,i=["around-control"];return n&&i.push("direction",n),t.createElement("div",{className:Nz.apply(void 0,KA([],$A(i),!1)),"data-rotation":o,"data-direction":e,key:"direction-around-".concat(e),style:lF.apply(void 0,KA([s,d],$A(r.map(function(e){return a[e]})),!1))})})}function vR(e,t,n){var r=e||{},o=r.position,i=void 0===o?"client":o,a=r.left,s=void 0===a?-1/0:a,l=r.top,c=void 0===l?-1/0:l,d=r.right,u=void 0===d?1/0:d,p=r.bottom,h={position:i,left:s,top:c,right:u,bottom:void 0===p?1/0:p};return{vertical:xR(h,t,!0),horizontal:xR(h,n,!1)}}function yR(e,t){var n=e.state,r=n.containerClientRect,o=r.clientHeight,i=r.clientWidth,a=r.clientLeft,s=r.clientTop,l=n.snapOffset,c=l.left,d=l.top,u=l.right,p=l.bottom,h=t||e.props.bounds||{},f="css"===(h.position||"client"),g=h.left,m=void 0===g?-1/0:g,v=h.top,y=void 0===v?-1/0:v,x=h.right,b=void 0===x?f?-1/0:1/0:x,w=h.bottom,S=void 0===w?f?-1/0:1/0:w;return f&&(b=i+u-c-b,S=o+p-d-S),{left:m+c-a,right:b+c-a,top:y+d-s,bottom:S+d-s}}function xR(e,t,n){var r=e[n?"left":"top"],o=e[n?"right":"bottom"],i=Math.min.apply(Math,KA([],$A(t),!1)),a=Math.max.apply(Math,KA([],$A(t),!1)),s=[];return r+1>i&&s.push({direction:"start",isBound:!0,offset:i-r,pos:r}),o-1<a&&s.push({direction:"end",isBound:!0,offset:a-o,pos:o}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(e,t){return KF(t.offset)-KF(e.offset)})}function bR(e,t,n){return(n?e.map(function(e){return BI(e,n)}):e).some(function(e){return e[0]<t.left&&KF(e[0]-t.left)>.1||e[0]>t.right&&KF(e[0]-t.right)>.1||e[1]<t.top&&KF(e[1]-t.top)>.1||e[1]>t.bottom&&KF(e[1]-t.bottom)>.1})}function wR(e,t,n,r,o){if(!e.props.bounds)return[];var i=o*Math.PI/180,a=yR(e),s=a.left,l=a.top,c=a.right,d=a.bottom,u=s-r[0],p=c-r[0],h=l-r[1],f=d-r[1],g={left:u,top:h,right:p,bottom:f};if(!bR(n,g,0))return[];var m=[];return[[u,0],[p,0],[h,1],[f,1]].forEach(function(e){var r=$A(e,2),o=r[0],a=r[1];n.forEach(function(e){var n=rI([0,0],e);m.push.apply(m,KA([],$A(function(e,t,n){var r=iF(e),o=Math.sqrt(r*r-t*t)||0;return[o,-o].sort(function(t,r){return KF(t-e[n?0:1])-KF(r-e[n?0:1])}).map(function(e){return rI([0,0],n?[e,t]:[t,e])})}(e,o,a).map(function(e){return i+e-n}).filter(function(e){return!bR(t,g,e)}).map(function(e){return aI(180*e/Math.PI,vO)})),!1))})}),m}var SR=["left","right","center"],kR=["top","bottom","middle"],CR={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},jR={start:"left",end:"right",center:"center"},_R={start:"top",end:"bottom",center:"middle"};function ER(e,t){var n=e.props,r=n.snappable,o=n.bounds,i=n.innerBounds,a=n.verticalGuidelines,s=n.horizontalGuidelines,l=n.snapGridWidth,c=n.snapGridHeight,d=e.state,u=d.guidelines,p=d.enableSnap;return!(!r||!p||t&&!0!==r&&r.indexOf(t)<0)&&!!(l||c||o||i||u&&u.length||a&&a.length||s&&s.length)}function DR(e){return!1===e?{}:!0!==e&&e?e:{left:!0,right:!0,top:!0,bottom:!0}}function MR(e,t){var n=function(e,t){var n=DR(e),r={};for(var o in n)o in t&&n[o]&&(r[o]=t[o]);return r}(e,t),r=kR.filter(function(e){return e in n}),o=SR.filter(function(e){return e in n});return{horizontalNames:r,verticalNames:o,horizontal:r.map(function(e){return n[e]}),vertical:o.map(function(e){return n[e]})}}var TR="snapRotationThreshold",IR="snapRotationDegrees",AR="snapHorizontalThreshold",OR="snapVerticalThreshold";function RR(e,t,n,r,o,i,a){var s;void 0===r&&(r=[]),void 0===o&&(o=[]);var l=e.props,c=(null===(s=e.state.snapThresholdInfo)||void 0===s?void 0:s.multiples)||[1,1],d=TF(a,l[AR],5),u=TF(i,l[OR],5);return zR(e.state.guidelines,t,n,r,o,d,u,c)}function zR(e,t,n,r,o,i,a,s){return{vertical:LR(e,"vertical",t,a*s[0],r),horizontal:LR(e,"horizontal",n,i*s[1],o)}}function FR(e){var t="";return-1===e||"top"===e||"left"===e?t="start":0===e||"center"===e||"middle"===e?t="center":1!==e&&"right"!==e&&"bottom"!==e||(t="end"),t}function PR(e,t,n,r){var o=MR(e.props.snapDirections,t),i=RR(e,o.vertical,o.horizontal,o.verticalNames.map(function(e){return FR(e)}),o.horizontalNames.map(function(e){return FR(e)}),n,r),a=FR(o.horizontalNames[i.horizontal.index]),s=FR(o.verticalNames[i.vertical.index]);return{vertical:ZA(ZA({},i.vertical),{direction:s}),horizontal:ZA(ZA({},i.horizontal),{direction:a})}}function BR(e){var t=e.isSnap;if(!t)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=e.posInfos[0],r=n.guidelineInfos[0],o=r.offset,i=r.dist,a=r.guideline;return{isSnap:t,offset:o,dist:i,pos:n.pos,guideline:a}}function LR(e,t,n,r,o){var i,a;if(void 0===o&&(o=[]),!e||!e.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var s="vertical"===t?0:1,l=n.map(function(n,i){var a=o[i]||"",l=e.map(function(e){var t=e.pos,r=n-t[s];return{offset:r,dist:KF(r),guideline:e,direction:a}}).filter(function(e){var n=e.guideline,o=e.dist;return!(n.type!==t||o>r)}).sort(function(e,t){return e.dist-t.dist});return{pos:n,index:i,guidelineInfos:l,direction:a}}).filter(function(e){return e.guidelineInfos.length>0}).sort(function(e,t){return e.guidelineInfos[0].dist-t.guidelineInfos[0].dist}),c=l.length>0;return{isSnap:c,index:c?l[0].index:-1,direction:null!==(a=null===(i=l[0])||void 0===i?void 0:i.direction)&&void 0!==a?a:"",posInfos:l}}function NR(e,t,n,r,o){var i=[];n[0]&&n[1]?i=[n,[-n[0],n[1]],[n[0],-n[1]]]:n[0]||n[1]?e.props.keepRatio?i.push([-1,-1],[-1,1],[1,-1],[1,1],n):(i.push.apply(i,KA([],$A(function(e,t){return FO(t).map(function(t){return e[t]})}([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),i.length>1&&i.push([(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2])):[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(e,t,n){var r=n[t+1]||n[0];i.push(e),i.push([(e[0]+r[0])/2,(e[1]+r[1])/2])});var a=i.map(function(e){return BO(t,e)}),s=RR(e,a.map(function(e){return e[0]}),a.map(function(e){return e[1]}),i.map(function(e){return FR(e[0])}),i.map(function(e){return FR(e[1])}),r,o),l=FR(i.map(function(e){return e[0]})[s.vertical.index]),c=FR(i.map(function(e){return e[1]})[s.horizontal.index]);return{vertical:ZA(ZA({},s.vertical),{direction:l}),horizontal:ZA(ZA({},s.horizontal),{direction:c})}}function UR(e,t){var n=KF(e.offset),r=KF(t.offset);return e.isBound&&t.isBound?r-n:e.isBound?-1:t.isBound?1:e.isSnap&&t.isSnap?r-n:e.isSnap?-1:t.isSnap||n<vO?1:r<vO?-1:n-r}function VR(e,t){return e.slice().sort(function(e,n){var r=e.sign[t],o=n.sign[t],i=e.offset[t],a=n.offset[t];return r?o?UR({isBound:e.isBound,isSnap:e.isSnap,offset:i},{isBound:n.isBound,isSnap:n.isSnap,offset:a}):-1:1})[0]}function WR(e,t){var n=nI([t[0][0],t[1][0]]),r=nI([t[0][1],t[1][1]]);return{vertical:n<=e[0],horizontal:r<=e[1]}}function HR(e,t){var n,r,o=$A(t,2),i=o[0],a=o[1],s=a[0]-i[0],l=a[1]-i[1];if(KF(s)<vO&&(s=0),KF(l)<vO&&(l=0),s)if(l){n=l/s*(e[0]-i[0])+i[1],r=e[1]}else n=i[1],r=e[1];else n=i[0],r=e[0];return n-r}function GR(e,t,n,r){return void 0===r&&(r=vO),e.every(function(e){var o=HR(e,t);return o<=0===n||KF(o)<=r})}function XR(e,t,n,r,o){return void 0===o&&(o=0),r&&t-o<=e||!r&&e<=n+o?{isBound:!0,offset:r?t-e:n-e}:{isBound:!1,offset:0}}function YR(e,t,n,r,o,i){var a,s,l=$A(t,2),c=l[0],d=l[1],u=e[0],p=n[0],h=n[1],f=BF(h[1]-p[1]),g=d,m=c,v=-c/d;return BF(h[0]-p[0])?f||i&&!g?{isBound:!1,offset:0}:m?XR((p[1]-u[1])/v+u[0],p[0],h[0],r,o):{isBound:s=KF(a=p[1]-u[1])<=(o||0),offset:s?a:0}:i&&!m?{isBound:!1,offset:0}:g?XR(v*(p[0]-u[0])+u[1],p[1],h[1],r,o):{isBound:s=KF(a=p[0]-u[0])<=(o||0),offset:s?a:0}}function qR(e,t,n){return t.map(function(t){var r=function(e,t){var n=t.line,r=t.centerSign,o=t.verticalSign,i=t.horizontalSign,a=t.lineConstants,s=e.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,c=s.top,d=s.width,u=s.height,p=[[l,c],[l,c+u]],h=[[l,c],[l+d,c]],f=[[l+d,c],[l+d,c+u]],g=[[l,c+u],[l+d,c+u]];if(GR([[l,c],[l+d,c],[l,c+u],[l+d,c+u]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var m=YR(n,a,h,o),v=YR(n,a,g,o),y=YR(n,a,p,i),x=YR(n,a,f,i),b=m.isBound&&v.isBound,w=m.isBound||v.isBound,S=y.isBound&&x.isBound,k=y.isBound||x.isBound,C=OF(m.offset,v.offset),j=OF(y.offset,x.offset),_=[0,0],E=!1,D=!1;return KF(j)<KF(C)?(_=[C,0],E=w,D=b):(_=[0,j],E=k,D=S),{isAllBound:D,isVerticalBound:w,isHorizontalBound:k,isBound:E,offset:_}}(e,t),o=r.isBound,i=r.offset,a=r.isVerticalBound,s=r.isHorizontalBound,l=t.multiple,c=zO({datas:n,distX:i[0],distY:i[1]}).map(function(e,t){return e*(l[t]?2/l[t]:0)});return{sign:l,isBound:o,isVerticalBound:a,isHorizontalBound:s,isSnap:!1,offset:c}})}function ZR(e,t,n){var r,o=qR(e,$R(e,t,[0,0],!1).map(function(e){return ZA(ZA({},e),{multiple:e.multiple.map(function(e){return 2*KF(e)})})}),n),i=VR(o,0),a=VR(o,1),s=0,l=0,c=i.isVerticalBound||a.isVerticalBound,d=i.isHorizontalBound||a.isHorizontalBound;return(c||d)&&(r=$A(function(e,t){var n=e.datas,r=e.distX,o=e.distY,i=n.beforeMatrix,a=n.matrix,s=n.is3d,l=n.startDragBeforeDist,c=n.startDragDist,d=n.absoluteOrigin,u=s?4:3;return TI(OI(t?i:a,MI(t?l:c,[r,o]),u),d)}({datas:n,distX:-i.offset[0],distY:-a.offset[1]}),2),s=r[0],l=r[1]),{vertical:{isBound:c,offset:s},horizontal:{isBound:d,offset:l}}}function $R(e,t,n,r){var o=e.state,i=nF(o.allMatrix,100,100,o.is3d?4:3),a=BO(i,[0,0]);return function(e,t){var n=[],r=e[0],o=e[1];return r&&o?n.push([[0,2*o],e,[-r,o]],[[2*r,0],e,[r,-o]]):r?(n.push([[2*r,0],[r,1],[r,-1]]),t&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):o?(n.push([[0,2*o],[1,o],[-1,o]]),t&&n.push([[-1,0],[-1,o],[-1,-o]],[[1,0],[1,o],[1,-o]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}(n,r).map(function(e){var n=$A(e,3),r=n[0],o=n[1],s=n[2],l=[BO(i,o),BO(i,s)],c=function(e){var t=$A(e,2),n=t[0],r=t[1],o=r[0]-n[0],i=r[1]-n[1];Math.abs(o)<TT&&(o=0),Math.abs(i)<TT&&(i=0);var a=0,s=0,l=0;return o?i?(s=1,l=(a=-i/o)*n[0]-n[1]):(s=1,l=-n[1]):(a=-1,l=n[0]),[a,s,l].map(function(e){return aI(e,TT)})}(l),d=WR(a,l),u=d.vertical,p=d.horizontal;return{multiple:r,centerSign:HR(a,l)<=0,verticalSign:u,horizontalSign:p,lineConstants:c,line:[BO(t,o),BO(t,s)]}})}function KR(e,t,n,r){var o=r?e.map(function(e){return BI(e,r)}):e;return[[o[0],o[1]],[o[1],o[3]],[o[3],o[2]],[o[2],o[0]]].some(function(e){var r=HR(n,e)<=0;return!GR(t,e,r)})}function JR(e,t,n,r,o){var i=e.props.innerBounds,a=o*Math.PI/180;if(!i)return[];var s=i.left,l=i.top,c=i.width,d=i.height,u=s-r[0],p=s+c-r[0],h=l-r[1],f=l+d-r[1],g=[[u,h],[p,h],[u,f],[p,f]],m=BO(n,[0,0]);if(!KR(n,g,m,0))return[];var v=[],y=g.map(function(e){return[iF(e),rI([0,0],e)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(e){var n=rI([0,0],function(e){var t=$A(e,2),n=t[0],r=t[1],o=r[0]-n[0],i=r[1]-n[1];if(!o)return[n[0],0];if(!i)return[0,n[1]];var a=i/o,s=-a*n[0]+n[1];return[-s/(a+1/a),s/(a*a+1)]}(e)),r=function(e){var t=$A(e,2),n=t[0],r=t[1],o=r[0]-n[0],i=r[1]-n[1];if(!o)return KF(n[0]);if(!i)return KF(n[1]);var a=i/o;return KF((-a*n[0]+n[1])/Math.sqrt(Math.pow(a,2)+1))}(e);v.push.apply(v,KA([],$A(y.filter(function(e){var t=$A(e,1)[0];return t&&r<=t}).map(function(e){var t=$A(e,2),o=t[0],i=t[1],s=Math.acos(o?r/o:0);return[a+(i+s)-n,a+(i-s)-n]}).reduce(function(e,t){return e.push.apply(e,KA([],$A(t),!1)),e},[]).filter(function(e){return!KR(t,g,m,e)}).map(function(e){return aI(180*e/Math.PI,vO)})),!1))}),v}function QR(e,t,n,r,o){var i=function(e,t,n,r){var o=t[0]-e[0],i=t[1]-e[1];if(KF(o)<TT&&(o=0),KF(i)<TT&&(i=0),!o)return r?[0,0]:[0,n];if(!i)return r?[n,0]:[0,0];var a=i/o,s=e[1]-a*e[0];return r?[n,a*(t[0]+n)+s-t[1]]:[(t[1]+n-s)/a-t[0],n]}(e,t,n,r);if(!i)return{isOutside:!1,offset:[0,0]};var a=iI(e,t),s=iI(i,e),l=iI(i,t),c=s>a||l>a,d=$A(zO({datas:o,distX:i[0],distY:i[1]}),2);return{offset:[d[0],d[1]],isOutside:c}}function ez(e,t){return e.isBound?e.offset:t.isSnap?BR(t).offset:0}function tz(e,t,n,r,o,i){if(!ER(e,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var a=vF(i.absolutePoses,[t,n]),s=rF(a),l=s.left,c=s.right,d=s.top,u=s.bottom,p={horizontal:a.map(function(e){return e[1]}),vertical:a.map(function(e){return e[0]})},h=nz(e,o,MR(DR(e.props.snapDirections),{left:l,right:c,top:d,bottom:u,center:(l+c)/2,middle:(d+u)/2}),p),f=h.vertical,g=h.horizontal,m=ZR(e,a,i),v=m.vertical,y=m.horizontal,x=f.isSnap,b=g.isSnap,w=f.isBound||v.isBound,S=g.isBound||y.isBound,k=$A(function(e,t,n,r,o){var i=$A(t,2),a=i[0],s=i[1],l=$A(n,2),c=l[0],d=l[1],u=$A(r,2),p=u[0],h=u[1],f=$A(o,2),g=f[0],m=f[1],v=-g,y=-m;if(e&&a&&s){v=0,y=0;var x=[];if(c&&d?x.push([0,m],[g,0]):c?x.push([g,0]):d?x.push([0,m]):p&&h?x.push([0,m],[g,0]):p?x.push([g,0]):h&&x.push([0,m]),x.length){x.sort(function(e,t){return iF(TI([a,s],e))-iF(TI([a,s],t))});var b=x[0];if(b[0]&&KF(a)>TT)v=-b[0],y=s*KF(a+v)/KF(a)-s;else if(b[1]&&KF(s)>TT){var w=s;y=-b[1],v=a*KF(s+y)/KF(w)-a}if(e&&d&&c)if(KF(v)>TT&&KF(v)<KF(g))v*=S=KF(g)/KF(v),y*=S;else if(KF(y)>TT&&KF(y)<KF(m)){var S;v*=S=KF(m)/KF(y),y*=S}else v=OF(-g,v),y=OF(-m,y)}}else v=a||c?-g:0,y=s||d?-m:0;return[v,y]}(r,[t,n],[w,S],[x,b],[OF(f.offset,v.offset),OF(g.offset,y.offset)]),2);return[{isBound:w,isSnap:x,offset:k[0]},{isBound:S,isSnap:b,offset:k[1]}]}function nz(e,t,n,r){void 0===r&&(r=n);var o=vR(yR(e),r.vertical,r.horizontal),i=o.horizontal,a=o.vertical,s=t?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:RR(e,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),l=s.horizontal,c=s.vertical,d=ez(i[0],l),u=ez(a[0],c),p=KF(d),h=KF(u);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:d,dist:p,bounds:i,snap:l},vertical:{isBound:a[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:u,dist:h,bounds:a,snap:c}}}function rz(e,t,n,r,o,i,a){void 0===a&&(a=[1,1]);var s=vR(t,n,r),l=s.horizontal,c=s.vertical,d=zR(e,n,r,[],[],o,i,a),u=d.horizontal,p=d.vertical,h=ez(l[0],u),f=ez(c[0],p),g=KF(h),m=KF(f);return{horizontal:{isBound:l[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:g,bounds:l,snap:u},vertical:{isBound:c[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:f,dist:m,bounds:c,snap:p}}}function oz(e,t,n,r,o,i){return n.map(function(n){var a=$A(n,2),s=a[0],l=a[1],c=BO(t,s),d=BO(t,l),u=r?function(e,t,n,r){var o=function(e,t,n){var r=yR(e),o=r.left,i=r.top,a=r.right,s=r.bottom,l=$A(n,2),c=l[0],d=l[1],u=$A(TI(n,t),2),p=u[0],h=u[1];KF(p)<vO&&(p=0),KF(h)<vO&&(h=0);var f=h>0,g=p>0,m={isBound:!1,offset:0,pos:0},v={isBound:!1,offset:0,pos:0};if(0===p&&0===h)return{vertical:m,horizontal:v};if(0===p)f?s<d&&(v.pos=s,v.offset=d-s):i>d&&(v.pos=i,v.offset=d-i);else if(0===h)g?a<c&&(m.pos=a,m.offset=c-a):o>c&&(m.pos=o,m.offset=c-o);else{var y=h/p,x=n[1]-y*c,b=0,w=0,S=!1;g&&a<=c?(b=y*a+x,w=a,S=!0):!g&&c<=o&&(b=y*o+x,w=o,S=!0),S&&(b<i||b>s)&&(S=!1),S||(f&&s<=d?(w=((b=s)-x)/y,S=!0):!f&&d<=i&&(w=((b=i)-x)/y,S=!0)),S&&(m.isBound=!0,m.pos=w,m.offset=c-w,v.isBound=!0,v.pos=b,v.offset=d-b)}return{vertical:m,horizontal:v}}(e,t,n),i=o.horizontal,a=o.vertical,s=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(e,t,n){var r=$A(n,2),o=r[0],i=r[1],a=$A(t,2),s=a[0],l=a[1],c=$A(TI(n,t),2),d=c[0],u=c[1],p=u>0,h=d>0;d=BF(d),u=BF(u);var f={isSnap:!1,offset:0,pos:0},g={isSnap:!1,offset:0,pos:0};if(0===d&&0===u)return{vertical:f,horizontal:g};var m=RR(e,d?[o]:[],u?[i]:[],[],[],void 0,void 0),v=m.vertical,y=m.horizontal;v.posInfos.filter(function(e){var t=e.pos;return h?t>=s:t<=s}),y.posInfos.filter(function(e){var t=e.pos;return p?t>=l:t<=l}),v.isSnap=v.posInfos.length>0,y.isSnap=y.posInfos.length>0;var x=BR(v),b=x.isSnap,w=x.guideline,S=BR(y),k=S.isSnap,C=S.guideline,j=k?C.pos[1]:0,_=b?w.pos[0]:0;if(0===d)k&&(g.isSnap=!0,g.pos=C.pos[1],g.offset=i-g.pos);else if(0===u)b&&(f.isSnap=!0,f.pos=_,f.offset=o-_);else{var E=u/d,D=n[1]-E*o,M=0,T=0,I=!1;b?(M=E*(T=_)+D,I=!0):k&&(T=((M=j)-D)/E,I=!0),I&&(f.isSnap=!0,f.pos=T,f.offset=o-T,g.isSnap=!0,g.pos=M,g.offset=i-M)}return{vertical:f,horizontal:g}}(e,t,n),l=s.horizontal,c=s.vertical,d=iz(i,l),u=iz(a,c),p=KF(d),h=KF(u);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:d,dist:p},vertical:{isBound:a.isBound,isSnap:c.isSnap,offset:u,dist:h}}}(e,c,d,o):nz(e,o,{vertical:[d[0]],horizontal:[d[1]]}),p=u.horizontal,h=p.offset,f=p.isBound,g=p.isSnap,m=u.vertical,v=m.offset,y=m.isBound,x=m.isSnap,b=TI(l,s);if(!v&&!h)return{isBound:y||f,isSnap:x||g,sign:b,offset:[0,0]};var w=function(e,t,n,r){var o=rI(e,t)/Math.PI*180,i=n.vertical,a=i.isBound,s=i.isSnap,l=i.dist,c=n.horizontal,d=c.isBound,u=c.isSnap,p=o%180,h=p<3||p>177,f=p>87&&p<93;return c.dist<l&&(a||s&&!f&&(!r||!h))?"vertical":!d&&(!u||h||r&&f)?"":"horizontal"}(c,d,u,r);if(!w)return{sign:b,isBound:!1,isSnap:!1,offset:[0,0]};var S="vertical"===w,k=[0,0];return k=(k=r||1!==KF(l[0])||1!==KF(l[1])||s[0]===l[0]||s[1]===l[1]?QR(c,d,-(S?v:h),S,i).offset:zO({datas:i,distX:-v,distY:-h})).map(function(e,t){return e*(b[t]?2/b[t]:0)}),{sign:b,isBound:S?y:f,isSnap:S?x:g,offset:k}})}function iz(e,t){return e.isBound?e.offset:t.isSnap?t.offset:0}var az={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(e,t){var n=e.props,r=n.hideThrottleDragRotateLine,o=n.throttleDragRotate,i=n.zoom,a=e.getState(),s=a.dragInfo,l=a.beforeOrigin;if(r||!o||!s)return[];var c=s.dist;if(!c[0]&&!c[1])return[];var d=iF(c),u=rI(c,[0,0]);return[t.createElement("div",{className:Nz("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(d,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(u,"rad) scaleY(").concat(i,")")}})]},dragStart:function(e,t){var n=t.datas,r=t.parentEvent,o=t.parentGesto,i=e.state,a=i.gestos,s=i.style;if(a.draggable)return!1;a.draggable=o||e.targetGesto,n.datas={},n.left=parseFloat(s.left||"")||0,n.top=parseFloat(s.top||"")||0,n.bottom=parseFloat(s.bottom||"")||0,n.right=parseFloat(s.right||"")||0,n.startValue=[0,0],MO(e,t),UO(e,t,"translate"),function(e,t){t.absolutePoses=yF(e.state)}(e,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var l=kF(e,t,ZA({set:function(e){n.startValue=e}},NO(e,t)));return!1!==(r||_F(e,"onDragStart",l))?(n.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(a.draggable=null,n.isPinch=!1),!!n.isDrag&&l},drag:function(e,t){if(t){TO(e,t,"translate");var n=t.datas,r=t.parentEvent,o=t.parentFlag,i=t.isPinch,a=t.deltaOffset,s=t.useSnap,l=t.isRequest,c=t.isGroup,d=t.parentThrottleDrag,u=t.distX,p=t.distY,h=n.isDrag,f=n.prevDist,g=n.prevBeforeDist,m=n.startValue;if(h){a&&(u+=a[0],p+=a[1]);var v=e.props,y=v.parentMoveable,x=c?0:v.throttleDrag||d||0,b=r?0:v.throttleDragRotate||0,w=0,S=!1,k=!1,C=!1,j=!1;if(!r&&b>0&&(u||p)){var _=v.startDragRotate||0,E=aI(_+180*rI([0,0],[u,p])/Math.PI,b)-_,D=p*Math.abs(Math.cos((E-90)/180*Math.PI)),M=iF([u*Math.abs(Math.cos(E/180*Math.PI)),D]);w=E*Math.PI/180,u=M*Math.cos(w),p=M*Math.sin(w)}if(!i&&!r&&!o){var T=$A(tz(e,u,p,b,!s&&l||a,n),2),I=T[0],A=T[1];S=I.isSnap,k=I.isBound,C=A.isSnap,j=A.isBound,u+=I.offset,p+=A.offset}var O=MI(RO({datas:n,distX:u,distY:p}),m),R=MI(AO({datas:n,distX:u,distY:p}),m);sI(R,vO),sI(O,vO),b||(S||k||(R[0]=aI(R[0],x),O[0]=aI(O[0],x)),C||j||(R[1]=aI(R[1],x),O[1]=aI(O[1],x)));var z=TI(O,m),F=TI(R,m),P=TI(F,f),B=TI(z,g);n.prevDist=F,n.prevBeforeDist=z,n.passDelta=P,n.passDist=F;var L=n.left+z[0],N=n.top+z[1],U=n.right-z[0],V=n.bottom-z[1],W=IO(n,"translate(".concat(R[0],"px, ").concat(R[1],"px)"),"translate(".concat(F[0],"px, ").concat(F[1],"px)"));if(WO(t,W),e.state.dragInfo.dist=r?[0,0]:F,r||y||!P.every(function(e){return!e})||!B.some(function(e){return!e})){var H=e.state,G=H.width,X=H.height,Y=kF(e,t,ZA({transform:W,dist:F,delta:P,translate:R,beforeDist:z,beforeDelta:B,beforeTranslate:O,left:L,top:N,right:U,bottom:V,width:G,height:X,isPinch:i},wF({transform:W},t)));return!r&&_F(e,"onDrag",Y),Y}}}},dragAfter:function(e,t){var n=t.datas,r=n.deltaOffset;return!(!r[0]&&!r[1])&&(n.deltaOffset=[0,0],this.drag(e,ZA(ZA({},t),{deltaOffset:r})))},dragEnd:function(e,t){var n=t.parentEvent,r=t.datas;if(e.state.dragInfo=null,r.isDrag){r.isDrag=!1;var o=CF(e,t,{});return!n&&_F(e,"onDragEnd",o),o}},dragGroupStart:function(e,t){var n,r,o=t.datas,i=t.clientX,a=t.clientY,s=this.dragStart(e,t);if(!s)return!1;var l=sR(e,this,"dragStart",[i||0,a||0],t,!1,"draggable"),c=l.childEvents,d=l.eventParams,u=_F(e,"onDragGroupStart",ZA(ZA({},s),{targets:e.props.targets,events:d}));o.isDrag=!1!==u;var p=null!==(r=null===(n=c[0])||void 0===n?void 0:n.datas.startValue)&&void 0!==r?r:[0,0];return o.throttleOffset=[p[0]%1,p[1]%1],!!o.isDrag&&s},dragGroup:function(e,t){if(t.datas.isDrag){var n=this.drag(e,ZA(ZA({},t),{parentThrottleDrag:e.props.throttleDrag})),r=sR(e,this,"drag",t.datas.passDelta,t,!1,"draggable").eventParams;if(n){var o=ZA({targets:e.props.targets,events:r},n);return _F(e,"onDragGroup",o),o}}},dragGroupEnd:function(e,t){var n=t.isDrag;if(t.datas.isDrag){this.dragEnd(e,t);var r=sR(e,this,"dragEnd",[0,0],t,!1,"draggable").eventParams;return _F(e,"onDragGroupEnd",CF(e,t,{targets:e.props.targets,events:r})),n}},request:function(e){var t={},n=e.getRect(),r=0,o=0,i=!1;return{isControl:!1,requestStart:function(e){return i=e.useSnap,{datas:t,useSnap:i}},request:function(e){return"x"in e?r=e.x-n.left:"deltaX"in e&&(r+=e.deltaX),"y"in e?o=e.y-n.top:"deltaY"in e&&(o+=e.deltaY),{datas:t,distX:r,distY:o,useSnap:i}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:i}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}};function sz(e,t){return{fixedPosition:BO(e,t),fixedDirection:t,fixedOffset:[0,0]}}function lz(e,t){var n=e.allMatrix,r=e.is3d,o=e.width,i=e.height,a=r?4:3,s=function(e,t,n){return[t?e[0]/(t/2)-1:0,n?e[1]/(n/2)-1:0]}(t,o,i);return{fixedPosition:tF(n,t,a),fixedDirection:s,fixedOffset:[o?0:t[0],i?0:t[1]]}}var cz=NF("resizable"),dz={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:fR("resizable"),dragControlCondition:cz,viewClassName:LF("resizable"),dragControlStart:function(e,t){var n,r=t.inputEvent,o=t.isPinch,i=t.isGroup,a=t.parentDirection,s=t.parentGesto,l=t.datas,c=t.parentFixedDirection,d=t.parentEvent,u=gF(a,o,r,l),p=e.state,h=p.target,f=p.width,g=p.height,m=p.gestos;if(!u||!h)return!1;if(m.resizable)return!1;m.resizable=s||e.controlGesto,!o&&MO(e,t),l.datas={},l.direction=u,l.startOffsetWidth=f,l.startOffsetHeight=g,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=p.inlineCSSWidth||p.cssWidth,l.startHeight=p.inlineCSSHeight||p.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[p.minOffsetWidth,p.minOffsetHeight],l.maxSize=[p.maxOffsetWidth,p.maxOffsetHeight]);var v=e.props.transformOrigin||"% %";function y(e){l.ratio=e&&isFinite(e)?e:0}function x(e){var t=sz(l.startPositions,e);l.fixedDirection=t.fixedDirection,l.fixedPosition=t.fixedPosition,l.fixedOffset=t.fixedOffset}function b(t){var n=lz(e.state,t);l.fixedDirection=n.fixedDirection,l.fixedPosition=n.fixedPosition,l.fixedOffset=n.fixedOffset}function w(e){l.minSize=[JT("".concat(e[0]),0)||0,JT("".concat(e[1]),0)||0]}function S(e){var t=[e[0]||1/0,e[1]||1/0];PT(t[0])&&!isFinite(t[0])||(t[0]=JT("".concat(t[0]),0)||1/0),PT(t[1])&&!isFinite(t[1])||(t[1]=JT("".concat(t[1]),0)||1/0),l.maxSize=t}l.transformOrigin=v&&FT(v)?v.split(" "):v,l.startOffsetMatrix=p.offsetMatrix,l.startTransformOrigin=p.transformOrigin,l.isWidth=null!==(n=null===t||void 0===t?void 0:t.parentIsWidth)&&void 0!==n?n:!u[0]&&!u[1]||u[0]||!u[1],l.startPositions=yF(e.state),y(f/g),x(c||[-u[0],-u[1]]),l.setFixedDirection=x,l.setFixedPosition=b,l.setMin=w,l.setMax=S;var k=kF(e,t,{direction:u,startRatio:l.ratio,set:function(e){var t=$A(e,2),n=t[0],r=t[1];l.startWidth=n,l.startHeight=r},setMin:w,setMax:S,setRatio:y,setFixedDirection:x,setFixedPosition:b,setOrigin:function(e){l.transformOrigin=e},dragStart:az.dragStart(e,(new _O).dragStart([0,0],t))}),C=d||_F(e,"onResizeStart",k);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,!1!==C&&(l.isResize=!0,e.state.snapRenderInfo={request:t.isRequest,direction:u}),!!l.isResize&&k},dragControl:function(e,t){var n,r=t.datas,o=t.parentFlag,i=t.isPinch,a=t.parentKeepRatio,s=t.dragClient,l=t.parentDist,c=t.useSnap,d=t.isRequest,u=t.isGroup,p=t.parentEvent,h=t.resolveMatrix,f=r.isResize,g=r.transformOrigin,m=r.startWidth,v=r.startHeight,y=r.prevWidth,x=r.prevHeight,b=r.minSize,w=r.maxSize,S=r.ratio,k=r.startOffsetWidth,C=r.startOffsetHeight,j=r.isWidth;if(f){if(h){var _=e.state.is3d,E=r.startOffsetMatrix,D=r.startTransformOrigin,M=_?4:3,T=YI(GO(t)),I=Math.sqrt(T.length);M!==I&&(T=_I(T,I,M));var A=LO(E,T,D,M),O=nF(A,k,C,M);r.startPositions=O,r.nextTargetMatrix=T,r.nextAllMatrix=A}var R=cF(e.props,"resizable"),z=R.resizeFormat,F=R.throttleResize,P=void 0===F?o?0:1:F,B=R.parentMoveable,L=R.keepRatioFinally,N=r.direction,U=N,V=0,W=0;N[0]||N[1]||(U=[1,1]);var H=S&&(null!=a?a:R.keepRatio)||!1,G=$A(oe(),2),X=G[0],Y=G[1];p||(r.setFixedDirection(r.fixedDirection),_F(e,"onBeforeResize",kF(e,t,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(e){var t;return r.setFixedDirection(e),t=$A(oe(),2),X=t[0],Y=t[1],[X,Y]},setFixedPosition:function(e){var t;return r.setFixedPosition(e),t=$A(oe(),2),X=t[0],Y=t[1],[X,Y]},boundingWidth:X,boundingHeight:Y,setSize:function(e){var t;t=$A(e,2),X=t[0],Y=t[1]}},!0)));var q=s;s||(q=!o&&i?function(e,t){return BO(yF(e.state),t)}(e,[0,0]):r.fixedPosition);var Z=[0,0];if(i||(Z=function(e,t,n,r,o,i,a){if(!ER(e,"resizable"))return[0,0];var s=a.fixedDirection,l=a.nextAllMatrix,c=e.state,d=c.allMatrix,u=c.is3d;return Iz(e,function(e,r){return Dz(l||d,t+e,n+r,s,o,u)},t,n,r,o,i,a)}(e,X,Y,N,q,!c&&d,r)),l&&(!l[0]&&(Z[0]=0),!l[1]&&(Z[1]=0)),H){U[0]&&U[1]&&Z[0]&&Z[1]&&(KF(Z[0])>KF(Z[1])?Z[1]=0:Z[0]=0);var $=!Z[0]&&!Z[1];$&&ie(),U[0]&&!U[1]||Z[0]&&!Z[1]||$&&j?(X+=Z[0],Y=X/S):(!U[0]&&U[1]||!Z[0]&&Z[1]||$&&!j)&&(Y+=Z[1],X=Y*S)}else X+=Z[0],Y+=Z[1],X=Math.max(0,X),Y=Math.max(0,Y);n=$A(tI([X,Y],b,w,!!H&&S),2),X=n[0],Y=n[1],ie(),H&&(u||L)&&(j?Y=X/S:X=Y*S);var K=[(V=X-k)-y,(W=Y-C)-x];r.prevWidth=V,r.prevHeight=W;var J=KO(e,X,Y,q,g,r);if(B||!K.every(function(e){return!e})||!J.every(function(e){return!e})){var Q=az.drag(e,jO(t,e.state,J,!!i,!1,"draggable")),ee=Q.transform,te=m+V,ne=v+W,re=kF(e,t,ZA({width:te,height:ne,offsetWidth:Math.round(X),offsetHeight:Math.round(Y),startRatio:S,boundingWidth:X,boundingHeight:Y,direction:N,dist:[V,W],delta:K,isPinch:!!i,drag:Q},SF({style:{width:"".concat(te,"px"),height:"".concat(ne,"px")},transform:ee},Q,t)));return!p&&_F(e,"onResize",re),re}}function oe(){var e=r.fixedDirection,n=GF(U,H,r,t);V=n.distWidth,W=n.distHeight;var o=U[0]-e[0]||H?Math.max(k+V,vO):k,i=U[1]-e[1]||H?Math.max(C+W,vO):C;return H&&k&&C&&(j?i=o/S:o=i*S),[o,i]}function ie(){var e;z&&(e=$A(z([X,Y]),2),X=e[0],Y=e[1]),X=aI(X,P),Y=aI(Y,P)}},dragControlAfter:function(e,t){var n=t.datas,r=n.isResize,o=n.startOffsetWidth,i=n.startOffsetHeight,a=n.prevWidth,s=n.prevHeight;if(r&&!1!==e.props.checkResizableError){var l=e.state,c=l.width-(o+a),d=l.height-(i+s),u=KF(c)>3,p=KF(d)>3;return u&&(n.startWidth+=c,n.startOffsetWidth+=c,n.prevWidth+=c),p&&(n.startHeight+=d,n.startOffsetHeight+=d,n.prevHeight+=d),u||p?this.dragControl(e,t):void 0}},dragControlEnd:function(e,t){var n=t.datas,r=t.parentEvent;if(n.isResize){n.isResize=!1;var o=CF(e,t,{});return!r&&_F(e,"onResizeEnd",o),o}},dragGroupControlCondition:cz,dragGroupControlStart:function(e,t){var n=t.datas,r=this.dragControlStart(e,ZA(ZA({},t),{isGroup:!0}));if(!r)return!1;var o=aR(e,"resizable",t),i=n.startOffsetWidth,a=n.startOffsetHeight;function s(){var e=n.minSize;o.forEach(function(t){var n=t.datas,r=n.minSize,o=n.startOffsetWidth,s=n.startOffsetHeight,l=i*(o?r[0]/o:0),c=a*(s?r[1]/s:0);e[0]=Math.max(e[0],l),e[1]=Math.max(e[1],c)})}function l(){var e=n.maxSize;o.forEach(function(t){var n=t.datas,r=n.maxSize,o=n.startOffsetWidth,s=n.startOffsetHeight,l=i*(o?r[0]/o:0),c=a*(s?r[1]/s:0);e[0]=Math.min(e[0],l),e[1]=Math.min(e[1],c)})}var c=lR(e,this,"dragControlStart",t,function(t,r){return cR(e,t,n,r)});s(),l();var d=function(t){r.setFixedDirection(t),c.forEach(function(r,i){r.setFixedDirection(t),cR(e,r.moveable,n,o[i])})};n.setFixedDirection=d;var u=ZA(ZA({},r),{targets:e.props.targets,events:c.map(function(e){return ZA(ZA({},e),{setMin:function(t){e.setMin(t),s()},setMax:function(t){e.setMax(t),l()}})}),setFixedDirection:d,setMin:function(e){r.setMin(e),s()},setMax:function(e){r.setMax(e),l()}}),p=_F(e,"onResizeGroupStart",u);return n.isResize=!1!==p,!!n.isResize&&r},dragGroupControl:function(e,t){var n=t.datas;if(n.isResize){var r=cF(e.props,"resizable");jF(e,"onBeforeResize",function(n){_F(e,"onBeforeResizeGroup",kF(e,t,ZA(ZA({},n),{targets:r.targets}),!0))});var o=this.dragControl(e,ZA(ZA({},t),{isGroup:!0}));if(o){var i=o.boundingWidth,a=o.boundingHeight,s=o.dist,l=r.keepRatio,c=[i/(i-s[0]),a/(a-s[1])],d=n.fixedPosition,u=lR(e,this,"dragControl",t,function(t,n){var r=$A(OI(UI(e.rotation/180*Math.PI,3),[n.datas.originalX*c[0],n.datas.originalY*c[1],1],3),2),o=r[0],i=r[1];return ZA(ZA({},n),{parentDist:null,parentScale:c,dragClient:MI(d,[o,i]),parentKeepRatio:l})}),p=ZA({targets:r.targets,events:u},o);return _F(e,"onResizeGroup",p),p}}},dragGroupControlEnd:function(e,t){var n=t.isDrag;if(t.datas.isResize){this.dragControlEnd(e,t);var r=lR(e,this,"dragControlEnd",t);return _F(e,"onResizeGroupEnd",CF(e,t,{targets:e.props.targets,events:r})),n}},request:function(e){var t={},n=0,r=0,o=!1,i=e.getRect();return{isControl:!0,requestStart:function(e){var n;return o=e.useSnap,{datas:t,parentDirection:e.direction||[1,1],parentIsWidth:null===(n=null===e||void 0===e?void 0:e.horizontal)||void 0===n||n,useSnap:o}},request:function(e){return"offsetWidth"in e?n=e.offsetWidth-i.offsetWidth:"deltaWidth"in e&&(n+=e.deltaWidth),"offsetHeight"in e?r=e.offsetHeight-i.offsetHeight:"deltaHeight"in e&&(r+=e.deltaHeight),{datas:t,parentDist:[n,r],parentKeepRatio:e.keepRatio,useSnap:o}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:o}}}},unset:function(e){e.state.gestos.resizable=null}};function uz(e,t,n,r,o){var i=e.props.groupable,a=e.state,s=a.is3d?4:3,l=t.origin,c=tF(e.state.rootMatrix,TI([l[0],l[1]],i?[0,0]:[a.left,a.top]),s),d=MI([o.left,o.top],c);t.startAbsoluteOrigin=d,t.prevDeg=rI(d,[n,r])/Math.PI*180,t.defaultDeg=t.prevDeg,t.prevSnapDeg=0,t.loop=0,t.startDist=iI(d,[n,r])}function pz(e,t,n){var r=n.defaultDeg,o=n.prevDeg,i=o%360,a=Math.floor(o/360);i<0&&(i+=360),i>e&&i>270&&e<90?++a:i<e&&i<90&&e>270&&--a;var s=t*(360*a+e-r);return n.prevDeg=r+s,s}function hz(e,t,n,r){return pz(rI(r.startAbsoluteOrigin,[e,t])/Math.PI*180,n,r)}function fz(e,t,n,r,o,i){var a=e.props.throttleRotate,s=void 0===a?0:a,l=n.prevSnapDeg,c=0,d=!1;if(i){var u=function(e,t,n,r){var o,i=e.props,a=null!==(o=i[TR])&&void 0!==o?o:5,s=i[IR];if(ER(e,"rotatable")){var l=t.pos1,c=t.pos2,d=t.pos3,u=t.pos4,p=t.origin,h=n*Math.PI/180,f=[l,c,d,u].map(function(e){return TI(e,p)}),g=f.map(function(e){return BI(e,h)}),m=KA(KA([],$A(wR(e,f,g,p,n)),!1),$A(JR(e,f,g,p,n)),!1);m.sort(function(e,t){return KF(e-n)-KF(t-n)});var v=m.length>0;if(v)return{isSnap:v,dist:v?m[0]:n}}if((null===s||void 0===s?void 0:s.length)&&a){var y=s.slice().sort(function(e,t){return Rz(e,r)-Rz(t,r)}),x=y[0];if(Rz(x,r)<=a)return{isSnap:!0,dist:n+Oz(r,x)-r}}return{isSnap:!1,dist:n}}(e,t,r,o+r);d=u.isSnap,c=o+u.dist}d||(c=aI(o+r,s));var p=c-o;return n.prevSnapDeg=p,[p-l,p,c]}function gz(e,t,n){var r=$A(t,4),o=r[0],i=r[1],a=r[2],s=r[3];if("none"===e)return[];if(zT(e))return e.map(function(e){return gz(e,[o,i,a,s],n)[0]});var l=$A((e||"top").split("-"),2),c=l[0],d=l[1],u=[o,i];"left"===c?u=[a,o]:"right"===c?u=[i,s]:"bottom"===c&&(u=[s,a]);var p=[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2],h=uF(u,n);if(d){var f="top"===d||"left"===d,g="bottom"===c||"left"===c;p=u[f&&!g||!f&&g?0:1]}return[[p,h]]}function mz(e,t){if(t.isRequest)return"rotatable"===t.requestAble;var n=t.inputEvent.target;if(lI(n,Nz("rotation-control"))||e.props.rotateAroundControls&&lI(n,Nz("around-control"))||lI(n,Nz("control"))&&lI(n,Nz("rotatable")))return!0;var r=e.props.rotationTarget;return!!r&&VF(r,!0).some(function(e){return!!e&&(n===e||n.contains(e))})}var vz={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[".rotation {\nposition: absolute;\nheight: 40px;\nwidth: 1px;\ntransform-origin: 50% 100%;\nheight: calc(40px * var(--zoom));\ntop: auto;\nleft: 0;\nbottom: 100%;\nwill-change: transform;\n}\n.rotation .rotation-line {\ndisplay: block;\nwidth: 100%;\nheight: 100%;\ntransform-origin: 50% 50%;\n}\n.rotation .rotation-control {\nborder-color: #4af;\nborder-color: var(--moveable-color);\nbackground:#fff;\ncursor: alias;\n}\n:global .view-rotation-dragging, .rotatable.direction.control {\ncursor: alias;\n}\n.rotatable.direction.control.move {\ncursor: move;\n}\n"],viewClassName:function(e){return e.isDragging("rotatable")?Nz("view-rotation-dragging"):""},render:function(e,t){var n=cF(e.props,"rotatable"),r=n.rotatable,o=n.rotationPosition,i=n.zoom,a=n.renderDirections,s=n.rotateAroundControls,l=n.resolveAblesWithRotatable,c=e.getState(),d=c.renderPoses,u=c.direction;if(!r)return null;var p=gz(o,d,u),h=[];if(p.forEach(function(e,n){var r=$A(e,2),o=r[0],a=r[1];h.push(t.createElement("div",{key:"rotation".concat(n),className:Nz("rotation"),style:{transform:"translate(-50%) translate(".concat(o[0],"px, ").concat(o[1],"px) rotate(").concat(a,"rad)")}},t.createElement("div",{className:Nz("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),t.createElement("div",{className:Nz("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),a){var f=KT(l||{}),g={};f.forEach(function(e){l[e].forEach(function(t){g[t]=e})});var m=[];zT(a)&&(m=a.map(function(e){var t=g[e];return{data:t?{resolve:t}:{},classNames:t?["move"]:[],dir:e}})),h.push.apply(h,KA([],$A(dR(e,"rotatable",m,t)),!1))}return s&&h.push.apply(h,KA([],$A(mR(e,t)),!1)),h},dragControlCondition:mz,dragControlStart:function(e,t){var n,r,o=t.datas,i=t.clientX,a=t.clientY,s=t.parentRotate,l=t.parentFlag,c=t.isPinch,d=t.isRequest,u=e.state,p=u.target,h=u.left,f=u.top,g=u.direction,m=u.beforeDirection,v=u.targetTransform,y=u.moveableClientRect,x=u.offsetMatrix,b=u.targetMatrix,w=u.allMatrix,S=u.width,k=u.height;if(!d&&!p)return!1;var C=e.getRect();o.rect=C,o.transform=v,o.left=h,o.top=f;var j=function(t){var n=lz(e.state,t);o.fixedDirection=n.fixedDirection,o.fixedOffset=n.fixedOffset,o.fixedPosition=n.fixedPosition,P&&P.setFixedPosition(t)},_=function(t){var n=function(e,t){var n=e.allMatrix,r=e.is3d,o=e.width,i=e.height,a=r?4:3;return{fixedPosition:tF(n,[o/2*(1+t[0]),i/2*(1+t[1])],a),fixedDirection:t,fixedOffset:[0,0]}}(e.state,t);o.fixedDirection=n.fixedDirection,o.fixedOffset=n.fixedOffset,o.fixedPosition=n.fixedPosition,P&&P.setFixedDirection(t)},E=i,D=a;if(d||c||l){var M=s||0;o.beforeInfo={origin:C.beforeOrigin,prevDeg:M,defaultDeg:M,prevSnapDeg:0,startDist:0},o.afterInfo=ZA(ZA({},o.beforeInfo),{origin:C.origin}),o.absoluteInfo=ZA(ZA({},o.beforeInfo),{origin:C.origin,startValue:M})}else{var T=null===(r=t.inputEvent)||void 0===r?void 0:r.target;if(T){var I=T.getAttribute("data-direction")||"",A=wO[I];if(A){o.isControl=!0,o.isAroundControl=lI(T,Nz("around-control")),o.controlDirection=A;var O=T.getAttribute("data-resolve");O&&(o.resolveAble=O);var R=function(e,t,n){var r=16===e.length?4:3,o=t.map(function(t){return tF(e,t,r)}),i=n.left,a=n.top;return o.map(function(e){return[e[0]+i,e[1]+a]})}(u.rootMatrix,u.renderPoses,y);n=$A(BO(R,A),2),E=n[0],D=n[1]}}o.beforeInfo={origin:C.beforeOrigin},o.afterInfo={origin:C.origin},o.absoluteInfo={origin:C.origin,startValue:C.rotation};var z=j;j=function(t){var n=u.is3d?4:3,r=$A(MI(CI(b,n),t),2),i=r[0],a=r[1],s=OI(x,jI([i,a],n)),l=OI(w,jI([t[0],t[1]],n));z(t);var c=u.posDelta;o.beforeInfo.origin=TI(s,c),o.afterInfo.origin=TI(l,c),o.absoluteInfo.origin=TI(l,c),uz(e,o.beforeInfo,E,D,y),uz(e,o.afterInfo,E,D,y),uz(e,o.absoluteInfo,E,D,y)},_=function(e){var t=BO([[0,0],[S,0],[0,k],[S,k]],e);j(t)}}o.startClientX=E,o.startClientY=D,o.direction=g,o.beforeDirection=m,o.startValue=0,o.datas={},UO(e,t,"rotate");var F=!1,P=!1;o.isControl&&o.resolveAble&&("resizable"===o.resolveAble&&(P=dz.dragControlStart(e,ZA(ZA({},new _O("resizable").dragStart([0,0],t)),{parentPosition:o.controlPosition,parentFixedPosition:o.fixedPosition}))));P||(F=az.dragStart(e,(new _O).dragStart([0,0],t))),j(function(e){var t=e.props,n=t.groupable,r=t.svgOrigin,o=e.getState(),i=o.offsetWidth,a=o.offsetHeight,s=o.svg,l=o.transformOrigin;if(!n&&s&&r)return YF(r,i,a);return l}(e));var B=kF(e,t,ZA(ZA({set:function(e){o.startValue=e*Math.PI/180},setFixedDirection:_,setFixedPosition:j},NO(e,t)),{dragStart:F,resizeStart:P})),L=_F(e,"onRotateStart",B);return o.isRotate=!1!==L,u.snapRenderInfo={request:t.isRequest},!!o.isRotate&&B},dragControl:function(e,t){var n,r,o,i=t.datas,a=t.clientDistX,s=t.clientDistY,l=t.parentRotate,c=t.parentFlag,d=t.isPinch,u=t.groupDelta,p=t.resolveMatrix,h=i.beforeDirection,f=i.beforeInfo,g=i.afterInfo,m=i.absoluteInfo,v=i.isRotate,y=i.startValue,x=i.rect,b=i.startClientX,w=i.startClientY;if(v){TO(e,t,"rotate");var S,k,C,j,_,E,D,M,T,I=function(e){return EO(e.datas.beforeTransform,[50,50],100,100).direction}(t),A=h*I,O=e.props.parentMoveable,R=180/Math.PI*y,z=m.startValue,F=!1,P=b+a,B=w+s;if(!c&&"parentDist"in t){var L=t.parentDist;k=L,_=L,M=L}else d||c?(k=pz(l,h,f),_=pz(l,A,g),M=pz(l,A,m)):(k=hz(P,B,h,f),_=hz(P,B,A,g),M=hz(P,B,A,m),F=!0);if(_F(e,"onBeforeRotate",kF(e,t,{beforeRotation:C=R+k,rotation:E=R+_,absoluteRotation:T=z+M,setRotation:function(e){k=_=e-R,M=_}},!0)),S=(n=$A(fz(e,x,f,k,R,F),3))[0],k=n[1],C=n[2],j=(r=$A(fz(e,x,g,_,R,F),3))[0],_=r[1],E=r[2],D=(o=$A(fz(e,x,m,M,z,F),3))[0],M=o[1],T=o[2],D||j||S||O||p){var N=IO(i,"rotate(".concat(E,"deg)"),"rotate(".concat(_,"deg)"));p&&(i.fixedPosition=ZO(e,i.targetAllTransform,i.fixedDirection,i.fixedOffset,i));var U=function(e,t,n){var r=n.fixedDirection,o=n.fixedPosition,i=n.fixedOffset;return $O(e,"rotate(".concat(t,"deg)"),r,o,i,n)}(e,_,i),V=TI(MI(u||[0,0],U),i.prevInverseDist||[0,0]);i.prevInverseDist=U,i.requestValue=null;var W=qO(e,N,V,d,t),H=W,G=iI([P,B],m.startAbsoluteOrigin)-m.startDist,X=void 0;if("resizable"===i.resolveAble){var Y=dz.dragControl(e,ZA(ZA({},jO(t,e.state,[t.deltaX,t.deltaY],!!d,!1,"resizable")),{resolveMatrix:!0,parentDistance:G}));Y&&(X=Y,H=SF(H,Y,t))}var q=kF(e,t,ZA(ZA({delta:j,dist:_,rotate:E,rotation:E,beforeDist:k,beforeDelta:S,beforeRotate:C,beforeRotation:C,absoluteDist:M,absoluteDelta:D,absoluteRotate:T,absoluteRotation:T,isPinch:!!d,resize:X},W),H));return _F(e,"onRotate",q),q}}},dragControlEnd:function(e,t){var n=t.datas;if(n.isRotate){n.isRotate=!1;var r=CF(e,t,{});return _F(e,"onRotateEnd",r),r}},dragGroupControlCondition:mz,dragGroupControlStart:function(e,t){var n=t.datas,r=e.state,o=r.left,i=r.top,a=r.beforeOrigin,s=this.dragControlStart(e,t);if(!s)return!1;s.set(n.beforeDirection*e.rotation);var l=lR(e,this,"dragControlStart",t,function(e,t){var n=e.state,r=n.left,s=n.top,l=n.beforeOrigin,c=MI(TI([r,s],[o,i]),TI(l,a));return t.datas.startGroupClient=c,t.datas.groupClient=c,ZA(ZA({},t),{parentRotate:0})}),c=_F(e,"onRotateGroupStart",ZA(ZA({},s),{targets:e.props.targets,events:l}));return n.isRotate=!1!==c,!!n.isRotate&&s},dragGroupControl:function(e,t){var n=t.datas;if(n.isRotate){jF(e,"onBeforeRotate",function(n){_F(e,"onBeforeRotateGroup",kF(e,t,ZA(ZA({},n),{targets:e.props.targets}),!0))});var r=this.dragControl(e,t);if(r){var o=n.beforeDirection,i=r.beforeDist,a=i/180*Math.PI,s=lR(e,this,"dragControl",t,function(e,t){var n=t.datas.startGroupClient,r=$A(t.datas.groupClient,2),s=r[0],l=r[1],c=$A(BI(n,a*o),2),d=c[0],u=c[1],p=[d-s,u-l];return t.datas.groupClient=[d,u],ZA(ZA({},t),{parentRotate:i,groupDelta:p})});e.rotation=o*r.beforeRotation;var l=ZA({targets:e.props.targets,events:s,set:function(t){e.rotation=t},setGroupRotation:function(t){e.rotation=t}},r);return _F(e,"onRotateGroup",l),l}}},dragGroupControlEnd:function(e,t){var n=t.isDrag;if(t.datas.isRotate){this.dragControlEnd(e,t);var r=lR(e,this,"dragControlEnd",t);return _F(e,"onRotateGroupEnd",CF(e,t,{targets:e.props.targets,events:r})),n}},request:function(e){var t={},n=0,r=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:t}},request:function(e){return"deltaRotate"in e?n+=e.deltaRotate:"rotate"in e&&(n=e.rotate-r),{datas:t,parentDist:n}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function yz(e,t){return function(e,t){var n,r=e.direction,o=e.classNames,i=e.size,a=e.pos,s=e.zoom,l=e.key,c="horizontal"===r,d=c?"Y":"X";return t.createElement("div",{key:l,className:o.join(" "),style:(n={},n[c?"width":"height"]="".concat(i),n.transform="translate(".concat(a[0],", ").concat(a[1],") translate").concat(d,"(-50%) scale").concat(d,"(").concat(s,")"),n)})}(ZA(ZA({},e),{classNames:KA([Nz("line","guideline",e.direction)],$A(e.classNames),!1).filter(function(e){return e}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(e){return"".concat(aI(e,.1),"px")})}),t)}function xz(e,t,n,r,o,i,a,s){var l=e.props.zoom;return n.map(function(e,n){var c=e.type,d=e.pos,u=[0,0];return u[a]=r,u[a?0:1]=-o+d,yz({key:"".concat(t,"TargetGuideline").concat(n),classNames:[Nz("target","bold",c)],posValue:u,sizeValue:i,zoom:l,direction:t},s)})}function bz(e,t,n,r,o,i){var a=e.props,s=a.zoom,l=a.isDisplayInnerSnapDigit,c="horizontal"===t?jR:_R,d=o[c.start],u=o[c.end];return n.filter(function(e){var t=e.hide,n=e.elementRect;if(t)return!1;if(l&&n){var r=n.rect;if(r[c.start]<=d&&u<=r[c.end])return!1}return!0}).map(function(e,n){var o=e.pos,a=e.size,l=e.element,c=e.className,d=[-r[0]+o[0],-r[1]+o[1]];return yz({key:"".concat(t,"-default-guideline-").concat(n),classNames:l?[Nz("bold"),c]:[Nz("normal"),c],direction:t,posValue:d,sizeValue:a,zoom:s},i)})}function wz(e,t,n,r,o,i,a,s){var l,c=e.props,d=c.snapDigit,u=void 0===d?0:d,p=c.isDisplaySnapDigit,h=void 0===p||p,f=c.snapDistFormat,g=void 0===f?function(e,t){return e}:f,m=c.zoom,v="horizontal"===t?"X":"Y",y="vertical"===t?"height":"width",x=Math.abs(o),b=h?parseFloat(x.toFixed(u)):0;return s.createElement("div",{key:"".concat(t,"-").concat(n,"-guideline-").concat(r),className:Nz("guideline-group",t),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[y]="".concat(x,"px"),l)},yz({direction:t,classNames:[Nz(n),a],size:"100%",posValue:[0,0],sizeValue:x,zoom:m},s),s.createElement("div",{className:Nz("size-value","gap"),style:{transform:"translate".concat(v,"(-50%) scale(").concat(m,")")}},b>0?g(b,t):""))}function Sz(e,t,n,r,o){var i=e.props.isDisplayInnerSnapDigit,a=[];return["vertical","horizontal"].forEach(function(s){var l=t.filter(function(e){return e.type===s}),c="vertical"===s?1:0,d=c?0:1,u=function(e,t,n,r){var o="vertical"===e?0:1,i="vertical"===e?1:0,a=o?jR:_R,s=n[a.start],l=n[a.end];return IF(t,function(e){return e.pos[o]}).map(function(t){var n=[],c=[];return t.forEach(function(t){var d,u,p=t.element,h=t.elementRect.rect;if(h[a.end]<s)n.push(t);else if(l<h[a.start])c.push(t);else if(h[a.start]<=s&&l<=h[a.end]&&r){var f=t.pos,g={element:p,rect:ZA(ZA({},h),(d={},d[a.end]=h[a.start],d))},m={element:p,rect:ZA(ZA({},h),(u={},u[a.start]=h[a.end],u))},v=[0,0],y=[0,0];v[o]=f[o],v[i]=f[i],y[o]=f[o],y[i]=f[i]+t.size,n.push({type:e,pos:v,size:0,elementRect:g,direction:"",elementDirection:"end"}),c.push({type:e,pos:y,size:0,elementRect:m,direction:"",elementDirection:"start"})}}),n.sort(function(e,t){return t.pos[i]-e.pos[i]}),c.sort(function(e,t){return e.pos[i]-t.pos[i]}),{total:t,start:n,end:c,inner:[]}})}(s,l,r,i),p=c?_R:jR,h=c?jR:_R,f=r[p.start],g=r[p.end];u.forEach(function(t){var i=t.total,l=t.start,u=t.end,m=t.inner,v=n[d]+i[0].pos[d]-r[h.start],y=r;l.forEach(function(t){var r=t.elementRect.rect,i=y[p.start]-r[p.end];if(i>0){var l=[0,0];l[c]=n[c]+y[p.start]-f-i,l[d]=v,a.push(wz(e,s,"dashed",a.length,i,l,t.className,o))}y=r}),y=r,u.forEach(function(t){var r=t.elementRect.rect,i=r[p.start]-y[p.end];if(i>0){var l=[0,0];l[c]=n[c]+y[p.end]-f,l[d]=v,a.push(wz(e,s,"dashed",a.length,i,l,t.className,o))}y=r}),m.forEach(function(t){var r=t.elementRect.rect,i=f-r[p.start],l=r[p.end]-g,u=[0,0],h=[0,0];u[c]=n[c]-i,u[d]=v,h[c]=n[c]+g-f,h[d]=v,a.push(wz(e,s,"dashed",a.length,i,u,t.className,o)),a.push(wz(e,s,"dashed",a.length,l,h,t.className,o))})})}),a}function kz(e){var t,n,r=e.state,o=r.containerClientRect,i=r.hasFixed,a=o.overflow,s=o.scrollHeight,l=o.scrollWidth,c=o.clientHeight,d=o.clientWidth,u=o.clientLeft,p=o.clientTop,h=e.props,f=h.snapGap,g=void 0===f||f,m=h.verticalGuidelines,v=h.horizontalGuidelines,y=h.snapThreshold,x=void 0===y?5:y,b=h.maxSnapElementGuidelineDistance,w=void 0===b?1/0:b,S=h.isDisplayGridGuidelines,k=rF(yF(e.state)),C=k.top,j=k.left,_=k.bottom,E=k.right,D={top:C,left:j,bottom:_,right:E,center:(j+E)/2,middle:(C+_)/2},M=function(e){var t=e.state,n=e.props.elementGuidelines,r=void 0===n?[]:n;if(!r.length)return t.elementRects=[],[];var o=(t.elementRects||[]).filter(function(e){return!e.refresh}),i=r.map(function(e){return RT(e)&&"element"in e?ZA(ZA({},e),{element:UF(e.element,!0)}):{element:UF(e,!0)}}).filter(function(e){return e.element}),a=(d=o.map(function(e){return e.element}),u=i.map(function(e){return e.element}),tA(d,u,iA)),s=a.maintained,l=a.added,c=[];var d,u;s.forEach(function(e){var t=$A(e,2),n=t[0],r=t[1];c[r]=o[n]}),function(e,t){if(!t.length)return[];var n=e.props.groupable,r=e.state,o=r.containerClientRect,i=r.rootMatrix,a=r.is3d,s=r.offsetDelta,l=a?4:3,c=$A(function(e,t,n){var r=tF(e,[t.clientLeft,t.clientTop],n);return[t.left+r[0],t.top+r[1]]}(i,o,l),2),d=c[0],u=c[1],p=n?0:s[0],h=n?0:s[1];return t.map(function(e){var t=e.element.getBoundingClientRect(),n=t.left-d-p,r=t.top-u-h,o=r+t.height,a=n+t.width,s=$A(RF(i,[n,r],l),2),c=s[0],f=s[1],g=$A(RF(i,[a,o],l),2),m=g[0],v=g[1];return ZA(ZA({},e),{rect:{left:c,right:m,top:f,bottom:v,center:(c+m)/2,middle:(f+v)/2}})})}(e,l.map(function(e){return i[e]})).map(function(e,t){c[l[t]]=e}),t.elementRects=c;var p=DR(e.props.elementSnapDirections),h=[];return c.forEach(function(e){var t=e.element,n=e.top,r=void 0===n?p.top:n,o=e.left,i=void 0===o?p.left:o,a=e.right,s=void 0===a?p.right:a,l=e.bottom,c=void 0===l?p.bottom:l,d=e.center,u=void 0===d?p.center:d,f=e.middle,g=void 0===f?p.middle:f,m=e.className,v=e.rect,y=MR({top:r,right:s,left:i,bottom:c,center:u,middle:g},v),x=y.horizontal,b=y.vertical,w=y.horizontalNames,S=y.verticalNames,k=v.top,C=v.left,j=v.right-C,_=v.bottom-k,E=[j,_];b.forEach(function(n,r){h.push({type:"vertical",element:t,pos:[aI(n,.1),k],size:_,sizes:E,className:m,elementRect:e,elementDirection:CR[S[r]]||S[r],direction:""})}),x.forEach(function(n,r){h.push({type:"horizontal",element:t,pos:[C,aI(n,.1)],size:j,sizes:E,className:m,elementRect:e,elementDirection:CR[w[r]]||w[r],direction:""})})}),h}(e),T=KA([],$A(M),!1),I=(null!==(n=null===(t=r.snapThresholdInfo)||void 0===t?void 0:t.multiples)&&void 0!==n?n:[1,1]).map(function(e){return e*x});g&&T.push.apply(T,KA([],$A(function(e,t,n){var r=e.props,o=r.maxSnapElementGuidelineDistance,i=void 0===o?1/0:o,a=r.maxSnapElementGapDistance,s=void 0===a?1/0:a,l=e.state.elementRects,c=[];return[["vertical",jR,_R],["horizontal",_R,jR]].forEach(function(e){var r=$A(e,3),o=r[0],a=r[1],d=r[2],u=t[a.start],p=t[a.end],h=t[a.center],f=t[d.start],g=t[d.end],m={left:n[0],top:n[1]};function v(e){var t=e.rect,n=m[a.start];return t[a.end]<u+n?u-t[a.end]:p-n<t[a.start]?t[a.start]-p:-1}var y=l.filter(function(e){var t=e.rect;return!(t[d.start]>g||t[d.end]<f)&&v(e)>0}).sort(function(e,t){return v(e)-v(t)}),x=[];y.forEach(function(e){y.forEach(function(t){if(e!==t){var n=e.rect,r=t.rect,o=n[d.start],i=n[d.end],a=r[d.start];o>r[d.end]||a>i||x.push([e,t])}})}),x.forEach(function(e){var n=$A(e,2),r=n[0],l=n[1],d=r.rect,f=l.rect,g=d[a.start],v=d[a.end],y=f[a.start],x=f[a.end],b=m[a.start],w=0,S=0,k=!1,C=!1,j=!1;if(v<=u&&p<=y){if(C=!0,KF((S=v+(w=(y-v-(p-u))/2)+(p-u)/2)-h)>b)return}else if(v<y&&x<u+b){if(k=!0,KF((S=x+(w=y-v))-u)>b)return}else{if(!(v<y&&p-b<g))return;if(j=!0,KF((S=g-(w=y-v))-p)>b)return}w&&Cz(t,f,o,i)&&(w>s||c.push({type:o,pos:"vertical"===o?[S,0]:[0,S],element:l.element,size:0,className:l.className,isStart:k,isCenter:C,isEnd:j,gap:w,hide:!0,gapRects:[r,l],direction:"",elementDirection:""}))})}),c}(e,D,I)),!1));var A=ZA({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(T.push.apply(T,KA([],$A(function(e,t,n,r,o,i,a){void 0===r&&(r=0);void 0===o&&(o=0);var s=e.props,l=e.state,c=s.snapGridWidth,d=void 0===c?0:c,u=s.snapGridHeight,p=void 0===u?0:u,h=[],f=i.left,g=i.top,m=[0,0];!function(e,t,n,r){var o,i,a=e.props,s=e.state,l=a.snapGridAll,c=a.snapGridWidth,d=void 0===c?0:c,u=a.snapGridHeight,p=void 0===u?0:u,h=s.snapRenderInfo,f=h&&((null===(o=h.direction)||void 0===o?void 0:o[0])||(null===(i=h.direction)||void 0===i?void 0:i[1])),g=e.moveables;if(l&&g&&f&&(d||p)){if(s.snapThresholdInfo)return;s.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var m=e.getRect(),v=m.children,y=h.direction;if(v){var x=y.map(function(e,o){var i=0===o?{snapSize:d,posName:"left",sizeName:"width",clientOffset:r.left-t}:{snapSize:p,posName:"top",sizeName:"height",clientOffset:r.top-n},a=i.snapSize,s=i.posName,l=i.sizeName,c=i.clientOffset;if(!a)return{dir:e,multiple:1,snapSize:a,snapOffset:0};var u,h=m[l],f=m[s],g=(u=v.map(function(e){return[e[s]-f,e[l],h-e[l]-e[s]+f]}),u.reduce(function(e,t){return e.concat(t)},[])).filter(function(e){return e}).sort(function(e,t){return e-t}),y=g[0],x=g.map(function(e){return aI(e/y,.1)*a}),b=1,w=aI(h/y,.1);for(b=1;b<=10&&!x.every(function(e){return e*b%1===0});++b);var S=(1-e)/2,k=AT(f-c,f-c+h,S,1-S);return{multiple:w*b,dir:e,snapSize:a,snapOffset:Math.round(k/a)}}),b=x.map(function(e){return e.multiple||1});s.snapThresholdInfo.multiples=b,s.snapThresholdInfo.offset=x.map(function(e){return e.snapOffset}),x.forEach(function(e,t){e.snapSize})}}else s.snapThresholdInfo=null}(e,r,o,i);var v=l.snapThresholdInfo,y=d,x=p;v&&(d*=v.multiples[0]||1,p*=v.multiples[1]||1,m=v.offset);if(p){for(var b=function(e){h.push({type:"horizontal",pos:[f,aI(m[1]*x+e-o+g,.1)],className:Nz("grid-guideline"),size:t,hide:!a,direction:"",grid:!0})},w=0;w<=2*n;w+=p)b(w);for(w=-p;w>=-n;w-=p)b(w)}if(d){for(b=function(e){h.push({type:"vertical",pos:[aI(m[0]*y+e-r+f,.1),g],className:Nz("grid-guideline"),size:n,hide:!a,direction:"",grid:!0})},w=0;w<=2*t;w+=d)b(w);for(w=-d;w>=-t;w-=d)b(w)}return h}(e,a?l:d,a?s:c,u,p,A,S)),!1)),i){var O=o.left,R=o.top;A.left+=O,A.top+=R,A.right+=O,A.bottom+=R}return T.push.apply(T,KA([],$A(_z(v||!1,m||!1,a?l:d,a?s:c,u,p,A)),!1)),T=T.filter(function(e){var t=e.element,n=e.elementRect,r=e.type;if(!t||!n)return!0;var o=n.rect;return Cz(D,o,r,w)}),T}function Cz(e,t,n,r){return"horizontal"===n?KF(e.right-t.left)<=r||KF(e.left-t.right)<=r||e.left<=t.right&&t.left<=e.right:"vertical"!==n||(KF(e.bottom-t.top)<=r||KF(e.top-t.bottom)<=r||e.top<=t.bottom&&t.top<=e.bottom)}function jz(e,t){return e?e.map(function(e){var n=RT(e)?e:{pos:e},r=n.pos;return PT(r)?n:ZA(ZA({},n),{pos:JT(r,t)})}):[]}function _z(e,t,n,r,o,i,a){void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a={left:0,top:0,right:0,bottom:0});var s=[],l=a.left,c=a.top,d=a.bottom,u=n+a.right-l,p=r+d-c;return jz(e,p).forEach(function(e){s.push({type:"horizontal",pos:[l,aI(e.pos-i+c,.1)],size:u,className:e.className,direction:""})}),jz(t,u).forEach(function(e){s.push({type:"vertical",pos:[aI(e.pos-o+l,.1),c],size:p,className:e.className,direction:""})}),s}function Ez(e){var t=e.state,n=t.container,r=e.props.snapContainer||n;if(t.snapContainer===r&&t.guidelines&&t.guidelines.length)return!1;var o=t.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(n!==r){var a=UF(r,!0);if(a){var s=fF(a),l=WF(t,[s.left-o.left,s.top-o.top]),c=WF(t,[s.right-o.right,s.bottom-o.bottom]);i.left=aI(l[0],1e-5),i.top=aI(l[1],1e-5),i.right=aI(c[0],1e-5),i.bottom=aI(c[1],1e-5)}}return t.snapContainer=r,t.snapOffset=i,t.guidelines=kz(e),t.enableSnap=!0,!0}function Dz(e,t,n,r,o,i){var a=nF(e,t,n,i?4:3);return vF(a,TI(o,BO(a,r)))}function Mz(e){return e?e/KF(e):0}function Tz(e,t,n,r,o,i){var a=function(e,t,n){var r=[];if(n)1!==KF(t[0])||1!==KF(t[1])?r.push([t,[-1,-1]],[t,[-1,1]],[t,[1,-1]],[t,[1,1]]):r.push([t,[e[0],-e[1]]],[t,[-e[0],e[1]]]),r.push([t,e]);else if(e[0]&&e[1]||!e[0]&&!e[1]){var o=e[0]?e:[1,1];[1,-1].forEach(function(e){[1,-1].forEach(function(n){var i=[e*o[0],n*o[1]];t[0]===i[0]&&t[1]===i[1]||r.push([t,i])})})}else e[0]?(1===KF(t[0])?[1]:[1,-1]).forEach(function(n){r.push([[t[0],-1],[n*e[0],-1]],[[t[0],0],[n*e[0],0]],[[t[0],1],[n*e[0],1]])}):e[1]&&(1===KF(t[1])?[1]:[1,-1]).forEach(function(n){r.push([[-1,t[1]],[-1,n*e[1]]],[[0,t[1]],[0,n*e[1]]],[[1,t[1]],[1,n*e[1]]])});return r}(n,i.fixedDirection,r),s=$R(e,t,n,r),l=KA(KA([],$A(oz(e,t,a,r,o,i)),!1),$A(qR(e,s,i)),!1),c=VR(l,0),d=VR(l,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function Iz(e,t,n,r,o,i,a,s){for(var l=yF(e.state),c=e.props.keepRatio,d=0,u=0,p=0;p<2;++p){var h=Tz(e,t(d,u),o,c,a,s),f=h.width,g=h.height,m=f.isBound,v=g.isBound,y=f.offset,x=g.offset;if(1===p&&(m||(y=0),v||(x=0)),0===p&&a&&!m&&!v)return[0,0];if(c){var b=KF(y)*(n?1/n:1),w=KF(x)*(r?1/r:1);(m&&v?b<w:v||!m&&b<w)?y=n*x/r:x=r*y/n}d+=y,u+=x}if(!c&&o[0]&&o[1]){var S=function(e,t,n,r,o){var i=[-n[0],-n[1]],a=e.state,s=a.width,l=a.height,c=e.props.bounds,d=1/0,u=1/0;if(c){var p=[[n[0],-n[1]],[-n[0],n[1]]],h=c.left,f=void 0===h?-1/0:h,g=c.top,m=void 0===g?-1/0:g,v=c.right,y=void 0===v?1/0:v,x=c.bottom,b=void 0===x?1/0:x;p.forEach(function(e){var n=e[0]!==i[0],a=e[1]!==i[1],c=BO(t,e),p=360*rI(r,c)/Math.PI;if(a){var h=c.slice();(KF(p-360)<2||KF(p-180)<2)&&(h[1]=r[1]);var g=QR(r,h,(r[1]<c[1]?b:m)-c[1],!1,o),v=$A(g.offset,2)[1],x=g.isOutside;isNaN(v)||(u=l+(x?1:-1)*KF(v))}if(n){h=c.slice(),(KF(p-90)<2||KF(p-270)<2)&&(h[0]=r[0]);var w=QR(r,h,(r[0]<c[0]?y:f)-c[0],!0,o),S=$A(w.offset,1)[0],k=w.isOutside;isNaN(S)||(d=s+(k?1:-1)*KF(S))}})}return{maxWidth:d,maxHeight:u}}(e,l,o,i,s),k=S.maxWidth,C=S.maxHeight,j=$A(function(e,t,n,r,o,i,a,s,l){var c=BO(t,a),d=nz(e,s,{vertical:[c[0]],horizontal:[c[1]]}),u=d.horizontal.offset,p=d.vertical.offset;if(aI(p,mO)||aI(u,mO)){var h=$A(zO({datas:l,distX:-p,distY:-u}),2),f=h[0],g=h[1];return[Math.min(o||1/0,n+a[0]*f)-n,Math.min(i||1/0,r+a[1]*g)-r]}return[0,0]}(e,t(d,u).map(function(e){return e.map(function(e){return aI(e,mO)})}),n+d,r+u,k,C,o,a,s),2);d+=y=j[0],u+=x=j[1]}return[d,u]}function Az(e){return e<0&&(e=e%360+360),e%=360}function Oz(e,t){t=Az(t);var n=Math.floor(e/360),r=360*n+360-t,o=360*n+t;return KF(e-r)<KF(e-o)?r:o}function Rz(e,t){e=Az(e),t=Az(t);var n=Az(e-t);return Math.min(n,360-n)}function zz(e,t,n,r,o){if(!ER(e,"scalable"))return[0,0];var i=o.startOffsetWidth,a=o.startOffsetHeight,s=o.fixedPosition,l=o.fixedDirection,c=o.is3d,d=Iz(e,function(e,n){return Dz(function(e,t){var n=e.transformOrigin,r=e.offsetMatrix,o=e.is3d,i=e.targetMatrix,a=o?4:3;return LO(r,DI(e.targetAllTransform||i,WI(t,a),a),n,a)}(o,MI(t,[e/i,n/a])),i,a,l,s,c)},i,a,n,s,r,o);return[d[0]/i,d[1]/a]}function Fz(e){var t=[];return e.forEach(function(e){e.guidelineInfos.forEach(function(n){var r=n.guideline;qT(t,function(e){return e.guideline===r})||(r.direction="",t.push({guideline:r,posInfo:e}))})}),t.map(function(e){var t=e.guideline,n=e.posInfo;return ZA(ZA({},t),{direction:n.direction})})}function Pz(e,t,n,r,o,i){var a=vR(yR(e,i),t,n),s=a.vertical,l=a.horizontal,c={left:!1,top:!1,right:!1,bottom:!1};s.forEach(function(e){e.isBound&&("start"===e.direction&&(c.left=!0),"end"===e.direction&&(c.right=!0),r.push({type:"bounds",pos:e.pos}))}),l.forEach(function(e){e.isBound&&("start"===e.direction&&(c.top=!0),"end"===e.direction&&(c.bottom=!0),o.push({type:"bounds",pos:e.pos}))});var d=function(e){var t=e.props.innerBounds,n={left:!1,top:!1,right:!1,bottom:!1};if(!t)return{boundMap:n,vertical:[],horizontal:[]};var r=e.getRect(),o=[r.pos1,r.pos2,r.pos3,r.pos4],i=BO(o,[0,0]),a=t.left,s=t.top,l=t.width,c=t.height,d=[[a,s],[a,s+c]],u=[[a,s],[a+l,s]],p=[[a+l,s],[a+l,s+c]],h=[[a,s+c],[a+l,s+c]],f=$R(e,o,[0,0],!1),g=[],m=[];return f.forEach(function(e){var t=e.line,r=e.lineConstants,o=WR(i,t),f=o.horizontal,v=o.vertical,y=YR(t,r,u,v,1,!0),x=YR(t,r,h,v,1,!0),b=YR(t,r,d,f,1,!0),w=YR(t,r,p,f,1,!0);y.isBound&&!n.top&&(g.push(s),n.top=!0),x.isBound&&!n.bottom&&(g.push(s+c),n.bottom=!0),b.isBound&&!n.left&&(m.push(a),n.left=!0),w.isBound&&!n.right&&(m.push(a+l),n.right=!0)}),{boundMap:n,horizontal:g,vertical:m}}(e),u=d.boundMap,p=d.vertical,h=d.horizontal;return p.forEach(function(e){YT(r,function(t){var n=t.type,r=t.pos;return"bounds"===n&&r===e})>=0||r.push({type:"bounds",pos:e})}),h.forEach(function(e){YT(o,function(t){var n=t.type,r=t.pos;return"bounds"===n&&r===e})>=0||o.push({type:"bounds",pos:e})}),{boundMap:c,innerBoundMap:u}}var Bz=NF("",["resizable","scalable"]),Lz={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",TR,IR,AR,OR,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[":host {\n--bounds-color: #d66;\n}\n.guideline {\npointer-events: none;\nz-index: 2;\n}\n.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}\n.guideline-group {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.guideline-group .size-value {\nposition: absolute;\ncolor: #f55;\nfont-size: 12px;\nfont-size: calc(12px * var(--zoom));\nfont-weight: bold;\n}\n.guideline-group.horizontal .size-value {\ntransform-origin: 50% 100%;\ntransform: translateX(-50%);\nleft: 50%;\nbottom: 5px;\nbottom: calc(2px + 3px * var(--zoom));\n}\n.guideline-group.vertical .size-value {\ntransform-origin: 0% 50%;\ntop: 50%;\ntransform: translateY(-50%);\nleft: 5px;\nleft: calc(2px + 3px * var(--zoom));\n}\n.guideline.gap {\nbackground: #f55;\n}\n.size-value.gap {\ncolor: #f55;\n}\n"],render:function(e,t){var n=e.state,r=n.top,o=n.left,i=n.pos1,a=n.pos2,s=n.pos3,l=n.pos4,c=n.snapRenderInfo,d=e.props.snapRenderThreshold,u=void 0===d?1:d;if(!c||!c.render||!ER(e,""))return ZF(e,"boundMap",{left:!1,top:!1,right:!1,bottom:!1},function(e){return JSON.stringify(e)}),ZF(e,"innerBoundMap",{left:!1,top:!1,right:!1,bottom:!1},function(e){return JSON.stringify(e)}),[];n.guidelines=kz(e);var p=Math.min(i[0],a[0],s[0],l[0]),h=Math.min(i[1],a[1],s[1],l[1]),f=c.externalPoses||[],g=yF(e.state),m=[],v=[],y=[],x=[],b=[],w=rF(g),S=w.width,k=w.height,C=w.top,j=w.left,_=w.bottom,E=w.right,D={left:j,right:E,top:C,bottom:_,center:(j+E)/2,middle:(C+_)/2},M=f.length>0,T=M?rF(f):{};if(!c.request){if(c.direction&&b.push(NR(e,g,c.direction,u,u)),c.snap){var I=rF(g);c.center&&(I.middle=(I.top+I.bottom)/2,I.center=(I.left+I.right)/2),b.push(PR(e,I,u,u))}M&&(c.center&&(T.middle=(T.top+T.bottom)/2,T.center=(T.left+T.right)/2),b.push(PR(e,T,u,u))),b.forEach(function(e){var t=e.vertical.posInfos,n=e.horizontal.posInfos;m.push.apply(m,KA([],$A(t.filter(function(e){return e.guidelineInfos.some(function(e){return!e.guideline.hide})}).map(function(e){return{type:"snap",pos:e.pos}})),!1)),v.push.apply(v,KA([],$A(n.filter(function(e){return e.guidelineInfos.some(function(e){return!e.guideline.hide})}).map(function(e){return{type:"snap",pos:e.pos}})),!1)),y.push.apply(y,KA([],$A(Fz(t)),!1)),x.push.apply(x,KA([],$A(Fz(n)),!1))})}var A=Pz(e,[j,E],[C,_],m,v),O=A.boundMap,R=A.innerBoundMap;M&&Pz(e,[T.left,T.right],[T.top,T.bottom],m,v,c.externalBounds);var z=KA(KA([],$A(y),!1),$A(x),!1),F=z.filter(function(e){return e.element&&!e.gapRects}),P=z.filter(function(e){return e.gapRects}).sort(function(e,t){return e.gap-t.gap});_F(e,"onSnap",{guidelines:z.filter(function(e){return!e.element}),elements:F,gaps:P},!0);var B=ZF(e,"boundMap",O,function(e){return JSON.stringify(e)},{left:!1,top:!1,right:!1,bottom:!1}),L=ZF(e,"innerBoundMap",R,function(e){return JSON.stringify(e)},{left:!1,top:!1,right:!1,bottom:!1});return O!==B&&R!==L||_F(e,"onBound",{bounds:O,innerBounds:R},!0),KA(KA(KA(KA(KA(KA([],$A(Sz(e,F,[p,h],D,t)),!1),$A(function(e,t,n,r,o){var i=[];return["horizontal","vertical"].forEach(function(a){var s=t.filter(function(e){return e.type===a}).slice(0,1),l="vertical"===a?0:1,c=l?0:1,d=l?_R:jR,u=l?jR:_R,p=r[d.start],h=r[d.end],f=r[u.start],g=r[u.end];s.forEach(function(t){var r=t.gap,a=t.gapRects,s=Math.max.apply(Math,KA([f],$A(a.map(function(e){return e.rect[u.start]})),!1)),m=Math.min.apply(Math,KA([g],$A(a.map(function(e){return e.rect[u.end]})),!1)),v=(s+m)/2;s!==m&&v!==(f+g)/2&&a.forEach(function(t){var a=t.rect,s=t.className,u=[n[0],n[1]];if(a[d.end]<p)u[l]+=a[d.end]-p;else{if(!(h<a[d.start]))return;u[l]+=a[d.start]-p-r}u[c]+=v-f,i.push(wz(e,l?"vertical":"horizontal","gap",i.length,r,u,s,o))})})}),i}(e,P,[p,h],D,t)),!1),$A(bz(e,"horizontal",x,[o,r],D,t)),!1),$A(bz(e,"vertical",y,[o,r],D,t)),!1),$A(xz(e,"horizontal",v,p,r,S,0,t)),!1),$A(xz(e,"vertical",m,h,o,k,1,t)),!1)},dragStart:function(e,t){e.state.snapRenderInfo={request:t.isRequest,snap:!0,center:!0},Ez(e)},drag:function(e){var t=e.state;Ez(e)||(t.guidelines=kz(e)),t.snapRenderInfo&&(t.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,t){return!(!Bz(e,t)&&!mz(e,t))||(!t.isRequest&&t.inputEvent?lI(t.inputEvent.target,Nz("snap-control")):void 0)},dragControlStart:function(e){e.state.snapRenderInfo=null,Ez(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,t){this.dragStart(e,t)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,Ez(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){var t=e.state;t.enableSnap=!1,t.guidelines=[],t.snapRenderInfo=null,t.elementRects=[]}};function Nz(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return kT.apply(void 0,KA([pO],$A(e),!1))}function Uz(e){e()}function Vz(e){return e&&"none"!==e?RT(e)?e:YI(e):[1,0,0,1,0,0]}function Wz(e,t,n){return EI(t,HI(n,t),e,HI(n.map(function(e){return-e}),t))}function Hz(e){var t=function(e){return Gz(e.transformOrigin)}(EF(e,":before"));return t.map(function(t,n){var r=GT(t),o=r.value,i=r.unit;return o*function(e,t,n){return"%"===t?Qz(e.ownerSVGElement)[n?"width":"height"]/100:1}(e,i,0===n)})}function Gz(e){return e?e.split(" "):["0","0"]}function Xz(e){var t=iR(e)("transform");if(t&&"none"!==t)return t;if("transform"in e){var n=e.transform.baseVal;if(!n)return"";var r=n.length;if(!r)return"";for(var o=[],i=function(e){var t=n[e].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(e){return t[e]}).join(", "),")"))},a=0;a<r;++a)i(a);return o.join(" ")}return""}function Yz(e,t,n,r,o){var i,a,s,l,c=fI(e)||gI(e),d=!1;if(!e||n)s=e;else{var u=null===(i=null===e||void 0===e?void 0:e.assignedSlot)||void 0===i?void 0:i.parentElement,p=e.parentElement;u?(d=!0,l=p,s=u):s=p}for(var h=!1,f=e===t||s===t,g="relative",m=1,v=parseFloat(null===o||void 0===o?void 0:o("zoom"))||1,y=null===o||void 0===o?void 0:o("position");s&&s!==c;){t===s&&(f=!0);var x=iR(s),b=s.tagName.toLowerCase(),w=Xz(s),S=x("willChange"),k=parseFloat(x("zoom"))||1;if(g=x("position"),r&&1!==k){m=k;break}if(!n&&r&&1!==v&&y&&"absolute"!==y||"svg"===b||"foreignobject"===b||"static"!==g||w&&"none"!==w||"transform"===S)break;var C=null===(a=null===e||void 0===e?void 0:e.assignedSlot)||void 0===a?void 0:a.parentNode,j=s.parentNode;C&&(d=!0,l=j);var _=j;if(_&&11===_.nodeType){h=!0,g=iR(s=_.host)("position");break}s=_,g="relative"}return{offsetZoom:m,hasSlot:d,parentSlotElement:l,isCustomElement:h,isStatic:"static"===g,isEnd:f||!s||s===c,offsetParent:s||c}}function qz(e,t){var n,r,o,i=e.tagName.toLowerCase(),a=e.offsetLeft,s=e.offsetTop,l=iR(e),c=OT(a),d=!c;return d||"svg"===i&&!e.ownerSVGElement?o=(r=Gz(l("transformOrigin")).map(function(e){return parseFloat(e)})).slice():(o=(r=rO?Hz(e):Gz(l("transformOrigin")).map(function(e){return parseFloat(e)})).slice(),d=!0,"svg"===i?(a=0,s=0):(n=$A(function(e,t,n){var r=e.tagName.toLowerCase();if(!e.getBBox||!n&&"g"===r)return[0,0,0,0];var o=iR(e),i="fill-box"===o("transform-box"),a=e.getBBox(),s=Qz(e.ownerSVGElement),l=a.x,c=a.y;"foreignobject"!==r||l||c||(l=parseFloat(e.getAttribute("x"))||0,c=parseFloat(e.getAttribute("y"))||0);var d=l-s.x,u=c-s.y,p=i?t[0]:t[0]-d,h=i?t[1]:t[1]-u;return[d,u,p,h]}(e,r,e===t&&"g"===t.tagName.toLowerCase()),4),a=n[0],s=n[1],r[0]=n[2],r[1]=n[3])),{tagName:i,isSVG:c,hasOffset:d,offset:[a||0,s||0],origin:r,targetOrigin:o}}function Zz(e,t){var n=iR(e),r=iR(gI(e)),o=r("position");if(!t&&(!o||"static"===o))return[0,0];var i=parseInt(r("marginLeft"),10),a=parseInt(r("marginTop"),10);return"absolute"===n("position")&&("auto"===n("top")&&"auto"===n("bottom")||(a=0),"auto"===n("left")&&"auto"===n("right")||(i=0)),[i,a]}function $z(e){e.forEach(function(e){var t=e.matrix;t&&(e.matrix=_I(t,3,4))})}function Kz(e){for(var t=e.parentElement,n=!1,r=gI(e);t;){var o=EF(t).transform;if(o&&"none"!==o){n=!0;break}if(t===r)break;t=t.parentElement}return{fixedContainer:t||r,hasTransform:n}}function Jz(e,t){return void 0===t&&(t=e.length>9),"".concat(t?"matrix3d":"matrix","(").concat(AI(e,!t).join(","),")")}function Qz(e){var t=e.clientWidth,n=e.clientHeight;if(!e)return{x:0,y:0,width:0,height:0,clientWidth:t,clientHeight:n};var r=e.viewBox,o=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:o.x,y:o.y,width:o.width||t,height:o.height||n,clientWidth:t,clientHeight:n}}function eF(e,t){var n,r=Qz(e),o=r.width,i=r.height,a=r.clientWidth,s=r.clientHeight,l=a/o,c=s/i,d=e.preserveAspectRatio.baseVal,u=d.align,p=d.meetOrSlice,h=[0,0],f=[l,c],g=[0,0];if(1!==u){var m=(u-2)%3,v=Math.floor((u-2)/3);h[0]=o*m/2,h[1]=i*v/2;var y=2===p?Math.max(c,l):Math.min(l,c);f[0]=y,f[1]=y,g[0]=(a-o)/2*m,g[1]=(s-i)/2*v}var x=WI(f,t);return n=$A(g,2),x[t*(t-1)]=n[0],x[t*(t-1)+1]=n[1],Wz(x,t,h)}function tF(e,t,n){return OI(e,jI(t,n),n)}function nF(e,t,n,r){return[[0,0],[t,0],[0,n],[t,n]].map(function(t){return tF(e,t,r)})}function rF(e){var t=e.map(function(e){return e[0]}),n=e.map(function(e){return e[1]}),r=Math.min.apply(Math,KA([],$A(t),!1)),o=Math.min.apply(Math,KA([],$A(n),!1)),i=Math.max.apply(Math,KA([],$A(t),!1)),a=Math.max.apply(Math,KA([],$A(n),!1));return{left:r,top:o,right:i,bottom:a,width:i-r,height:a-o}}function oF(e,t,n,r){return rF(nF(e,t,n,r))}function iF(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function aF(e,t){return iF([t[0]-e[0],t[1]-e[1]])}function sF(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=rI(e,t));var o=aF(e,t);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(o,"px")}}function lF(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=n.length,i=n.reduce(function(e,t){return e+t[0]},0)/o,a=n.reduce(function(e,t){return e+t[1]},0)/o;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(a,"px) rotate(").concat(e,"rad) scale(").concat(t,")")}}function cF(e,t){var n=e[t];return RT(n)?ZA(ZA({},e),n):e}function dF(e){var t=e&&!OT(e.offsetWidth),n=0,r=0,o=0,i=0,a=0,s=0,l=0,c=0,d=0,u=0,p=0,h=0,f=1/0,g=1/0,m=1/0,v=1/0,y=0,x=0,b=!1;if(e)if(!t&&e.ownerSVGElement){var w=e.getBBox();b=!0,a=n=w.width,s=r=w.height,l=n,c=r,o=n,i=r}else{var S=iR(e),k=e.style,C="border-box"===S("boxSizing"),j=parseFloat(S("borderLeftWidth"))||0,_=parseFloat(S("borderRightWidth"))||0,E=parseFloat(S("borderTopWidth"))||0,D=parseFloat(S("borderBottomWidth"))||0,M=(parseFloat(S("paddingLeft"))||0)+(parseFloat(S("paddingRight"))||0),T=(parseFloat(S("paddingTop"))||0)+(parseFloat(S("paddingBottom"))||0),I=M+(j+_),A=T+(E+D),O=S("position"),R=0,z=0;if("clientLeft"in e){var F=null;if("absolute"===O)F=Yz(e,gI(e)).offsetParent;else F=e.parentElement;if(F){var P=iR(F);R=parseFloat(P("width")),z=parseFloat(P("height"))}}d=Math.max(M,JT(S("minWidth"),R)||0),u=Math.max(T,JT(S("minHeight"),z)||0),f=JT(S("maxWidth"),R),g=JT(S("maxHeight"),z),isNaN(f)&&(f=1/0),isNaN(g)&&(g=1/0),y=JT(k.width,0)||0,x=JT(k.height,0)||0,a=parseFloat(S("width"))||0,s=parseFloat(S("height"))||0,n=l=KF(a-y)<1?QT(d,y||a,f):a,r=c=KF(s-x)<1?QT(u,x||s,g):s,o=l,i=c,C?(m=f,v=g,p=d,h=u,l=n-I,c=r-A):(m=f+I,v=g+A,p=d+I,h=u+A,n=l+I,r=c+A),o=l+M,i=c+T}return{svg:b,offsetWidth:n,offsetHeight:r,clientWidth:o,clientHeight:i,contentWidth:l,contentHeight:c,inlineCSSWidth:y,inlineCSSHeight:x,cssWidth:a,cssHeight:s,minWidth:d,minHeight:u,maxWidth:f,maxHeight:g,minOffsetWidth:p,minOffsetHeight:h,maxOffsetWidth:m,maxOffsetHeight:v}}function uF(e,t){return rI(t>0?e[0]:e[1],t>0?e[1]:e[0])}function pF(e,t){var n=e===gI(e)||e===fI(e),r={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(t.height,r.clientHeight),r.scrollHeight=Math.max(t.height,r.scrollHeight)),r.overflow="visible"!==iR(e)("overflow"),ZA(ZA({},t),r)}function hF(e,t,n,r){var o=e.left,i=e.right,a=e.top,s=e.bottom,l=t.top,c=t.left,d={left:c+o,top:l+a,right:c+i,bottom:l+s,width:i-o,height:s-a};return n&&r?pF(n,d):d}function fF(e,t){var n=0,r=0,o=0,i=0;if(e){var a=e.getBoundingClientRect();n=a.left,r=a.top,o=a.width,i=a.height}var s={left:n,top:r,width:o,height:i,right:n+o,bottom:r+i};return e&&t?pF(e,s):s}function gF(e,t,n,r){var o;if(e)o=e;else if(t)o=[0,0];else{o=mF(n.target,r)}return o}function mF(e,t){if(e){var n=e.getAttribute("data-rotation")||"",r=e.getAttribute("data-direction");if(t.deg=n,r){var o=[0,0];return r.indexOf("w")>-1&&(o[0]=-1),r.indexOf("e")>-1&&(o[0]=1),r.indexOf("n")>-1&&(o[1]=-1),r.indexOf("s")>-1&&(o[1]=1),o}}}function vF(e,t){return[MI(t,e[0]),MI(t,e[1]),MI(t,e[2]),MI(t,e[3])]}function yF(e){var t=e.left,n=e.top;return vF([e.pos1,e.pos2,e.pos3,e.pos4],[t,n])}function xF(e,t){e[t?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(e)})}function bF(e,t){var n=t?"controlGesto":"targetGesto",r=e[n];!1===(null===r||void 0===r?void 0:r.isIdle())&&xF(e,t),null===r||void 0===r||r.unset(),e[n]=null}function wF(e,t){if(t){var n=HO(t);n.nextStyle=ZA(ZA({},n.nextStyle),e)}return{style:e,cssText:KT(e).map(function(t){return"".concat((n=t,r="-",void 0===r&&(r="-"),n.replace(/([a-z])([A-Z])/g,function(e,t,n){return""+t+r+n.toLowerCase()})),": ").concat(e[t],";");var n,r}).join("")}}function SF(e,t,n){var r=t.afterTransform||t.transform;return ZA(ZA({},wF(ZA(ZA(ZA({},e.style),t.style),{transform:r}),n)),{afterTransform:r,transform:e.transform})}function kF(e,t,n,r){var o=t.datas;o.datas||(o.datas={});var i=ZA(ZA({},n),{target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,moveable:e,datas:o.datas,isRequest:t.isRequest,isRequestChild:t.isRequestChild,isFirstDrag:!!t.isFirstDrag,isTrusted:!1!==t.isTrusted,stopAble:function(){o.isEventStart=!1},stopDrag:function(){var e;null===(e=t.stop)||void 0===e||e.call(t)}});return o.isStartEvent?r||(o.lastEvent=i):o.isStartEvent=!0,i}function CF(e,t,n){var r=t.datas,o="isDrag"in n?n.isDrag:t.isDrag;return r.datas||(r.datas={}),ZA(ZA({isDrag:o},n),{moveable:e,target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,lastEvent:r.lastEvent,isDouble:t.isDouble,datas:r.datas,isFirstDrag:!!t.isFirstDrag})}function jF(e,t,n){e._emitter.on(t,n)}function _F(e,t,n,r,o){return e.triggerEvent(t,n,r,o)}function EF(e,t){return mI(e).getComputedStyle(e,t)}function DF(e,t,n){var r={},o={};return e.filter(function(e){var i=e.name;if(r[i]||!t.some(function(t){return e[t]}))return!1;if(!n&&e.ableGroup){if(o[e.ableGroup])return!1;o[e.ableGroup]=!0}return r[i]=!0,!0})}function MF(e,t){return e===t||null==e&&null==t}function TF(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.length-1,r=0;r<n;++r){var o=e[r];if(!OT(o))return o}return e[n]}function IF(e,t){var n=[],r=[];return e.forEach(function(o,i){var a=t(o,i,e),s=r.indexOf(a),l=n[s]||[];-1===s&&(r.push(a),n.push(l)),l.push(o)}),n}function AF(e){return e.reduce(function(e,t){return e.concat(t)},[])}function OF(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(e,t){return KF(t)-KF(e)}),e[0]}function RF(e,t,n){return OI(kI(e,n),jI(t,n),n)}function zF(e,t){var n,r=e.is3d?4:3;return n=$A(RF(e.rootMatrix,[t.distX,t.distY],r),2),t.distX=n[0],t.distY=n[1],t}function FF(e,t,n,r){if(!n[0]&&!n[1])return t;var o=tF(e,[Mz(n[0]||1),0],r),i=tF(e,[0,Mz(n[1]||1)],r);return MI(t,tF(e,[n[0]/iF(o),n[1]/iF(i)],r))}function PF(e,t,n){return n?"".concat(e/t*100,"%"):"".concat(e,"px")}function BF(e){return KF(e)<=vO?0:e}function LF(e){return function(t){if(!t.isDragging(e))return"";var n=function(e,t){var n,r=e.targetGesto,o=e.controlGesto;return(null===r||void 0===r?void 0:r.isFlag())&&(n=r.getEventData()[t]),!n&&(null===o||void 0===o?void 0:o.isFlag())&&(n=o.getEventData()[t]),n||{}}(t,e),r=n.deg;return r?Nz("view-control-rotation".concat(r)):""}}function NF(e,t){return void 0===t&&(t=[e]),function(n,r){if(r.isRequest)return!!t.some(function(e){return r.requestAble===e})&&r.parentDirection;var o=r.inputEvent.target;return lI(o,Nz("direction"))&&(!e||lI(o,Nz(e)))}}function UF(e,t){return e?yI(e)?e:FT(e)?t?document.querySelector(e):e:BT(e)?e():vI(e)?e:"current"in e?e.current:e:null}function VF(e,t){return e?((n=e)&&RT(n)&&!yI(n)&&(zT(n)||"length"in n)?[].slice.call(e):[e]).reduce(function(e,n){return FT(n)&&t?KA(KA([],$A(e),!1),$A([].slice.call(document.querySelectorAll(n))),!1):(zT(n)?e.push(VF(n,t)):e.push(UF(n,t)),e)},[]):[];var n}function WF(e,t){var n=e.rootMatrix,r=e.is3d,o=kI(n,r?4:3);return r||(o=_I(o,3,4)),o[12]=0,o[13]=0,o[14]=0,function(e,t){var n=OI(e,[t[0],t[1]||0,t[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}(o,t)}function HF(e,t,n,r,o){var i=$A(e,2),a=i[0],s=i[1],l=0,c=0;if(o&&a&&s){var d=rI([0,0],t),u=rI([0,0],r),p=iF(t),h=Math.cos(d-u)*p;if(r[0])if(r[1]){var f=r[0]*a,g=r[1]*s,m=Math.atan2(f+t[0],g+t[1]),v=Math.atan2(f,g);m<0&&(m+=2*Math.PI),v<0&&(v+=2*Math.PI);var y=0;(y=KF(m-v)<Math.PI/2||KF(m-v)>Math.PI/2*3?m-v:m-(v+=Math.PI))>2*Math.PI?y-=2*Math.PI:y>Math.PI?y=2*Math.PI-y:y<-Math.PI&&(y=-2*Math.PI-y);var x=iF([f+t[0],g+t[1]])*Math.cos(y);l=x*Math.sin(v)-f,c=x*Math.cos(v)-g,r[0]<0&&(l*=-1),r[1]<0&&(c*=-1)}else c=(l=h)/n;else l=(c=h)*n}else l=r[0]*t[0],c=r[1]*t[1];return[l,c]}function GF(e,t,n,r){var o,i=n.ratio,a=n.startOffsetWidth,s=n.startOffsetHeight,l=0,c=0,d=r.distX,u=r.distY,p=r.pinchScale,h=r.parentDistance,f=r.parentDist,g=r.parentScale,m=n.fixedDirection,v=[0,1].map(function(t){return KF(e[t]-m[t])}),y=[0,1].map(function(e){var t=v[e];return 0!==t&&(t=2/t),t});if(f)l=f[0],c=f[1],t&&(l?c||(c=l/i):l=c*i);else if(PT(p))l=(p-1)*a,c=(p-1)*s;else if(g)l=(g[0]-1)*a,c=(g[1]-1)*s;else if(h){var x=a*v[0],b=s*v[1],w=iF([x,b]);l=h/w*x*y[0],c=h/w*b*y[1]}else{var S=zO({datas:n,distX:d,distY:u});S=y.map(function(e,t){return S[t]*e}),l=(o=$A(HF([a,s],S,i,e,t),2))[0],c=o[1]}return{distWidth:l,distHeight:c}}function XF(e,t){if(t){if("left"===e)return{x:"0%",y:"50%"};if("top"===e)return{x:"50%",y:"50%"};if("center"===e)return{x:"50%",y:"50%"};if("right"===e)return{x:"100%",y:"50%"};if("bottom"===e)return{x:"50%",y:"100%"};var n=$A(e.split(" "),2),r=n[0],o=n[1],i=XF(r||""),a=XF(o||""),s=ZA(ZA({},i),a),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return"left"===e?{x:"0%"}:"right"===e?{x:"100%"}:"top"===e?{y:"0%"}:"bottom"===e?{y:"100%"}:e?"center"===e?{value:"50%"}:{value:e}:{}}function YF(e,t,n){var r=XF(e,!0),o=r.x,i=r.y;return[JT(o,t)||0,JT(i,n)||0]}function qF(e,t){return e.length===t.length&&e.every(function(e,n){var r=t[n],o=zT(e),i=zT(r);return o&&i?qF(e,r):!o&&!i&&e===r})}function ZF(e,t,n,r,o){var i=e._store,a=i[t];if(!(t in i)){if(null==o)return i[t]=n,n;i[t]=o,a=o}return a===n||r(a)===r(n)?a:(i[t]=n,n)}function $F(e){return e>=0?1:-1}function KF(e){return Math.abs(e)}function JF(e,t){return function(e){for(var t=[],n=0;n<e;++n)t.push(n);return t}(e).map(function(e){return t(e)})}function QF(e){return PT(e)?{top:e,left:e,right:e,bottom:e}:{left:e.left||0,top:e.top||0,right:e.right||0,bottom:e.bottom||0}}var eP=JA("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(e,t){var n=t.datas,r=t.targets,o=t.angle,i=t.originalDatas,a=e.props,s=a.pinchable,l=a.ables;if(!s)return!1;var c="onPinch".concat(r?"Group":"","Start"),d="drag".concat(r?"Group":"","ControlStart"),u=(!0===s?e.controlAbles:l.filter(function(e){return s.indexOf(e.name)>-1})).filter(function(e){return e.canPinch&&e[d]}),p=kF(e,t,{});r&&(p.targets=r);var h=_F(e,c,p);n.isPinch=!1!==h,n.ables=u;var f=n.isPinch;return!!f&&(u.forEach(function(n){if(i[n.name]=i[n.name]||{},n[d]){var r=ZA(ZA({},t),{datas:i[n.name],parentRotate:o,isPinch:!0});n[d](e,r)}}),e.state.snapRenderInfo={request:t.isRequest,direction:[0,0]},f)},pinch:function(e,t){var n=t.datas,r=t.scale,o=t.distance,i=t.originalDatas,a=t.inputEvent,s=t.targets,l=t.angle;if(n.isPinch){var c=o*(1-1/r),d=kF(e,t,{});s&&(d.targets=s);var u="onPinch".concat(s?"Group":"");_F(e,u,d);var p=n.ables,h="drag".concat(s?"Group":"","Control");return p.forEach(function(n){n[h]&&n[h](e,ZA(ZA({},t),{datas:i[n.name],inputEvent:a,resolveMatrix:!0,pinchScale:r,parentDistance:c,parentRotate:l,isPinch:!0}))}),d}},pinchEnd:function(e,t){var n=t.datas,r=t.isPinch,o=t.inputEvent,i=t.targets,a=t.originalDatas;if(n.isPinch){var s="onPinch".concat(i?"Group":"","End"),l=CF(e,t,{isDrag:r});i&&(l.targets=i),_F(e,s,l);var c=n.ables,d="drag".concat(i?"Group":"","ControlEnd");return c.forEach(function(n){n[d]&&n[d](e,ZA(ZA({},t),{isDrag:r,datas:a[n.name],inputEvent:o,isPinch:!0}))}),r}},pinchGroupStart:function(e,t){return this.pinchStart(e,ZA(ZA({},t),{targets:e.props.targets}))},pinchGroup:function(e,t){return this.pinch(e,ZA(ZA({},t),{targets:e.props.targets}))},pinchGroupEnd:function(e,t){return this.pinchEnd(e,ZA(ZA({},t),{targets:e.props.targets}))}}),tP=NF("scalable"),nP={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:fR("scalable"),dragControlCondition:tP,viewClassName:LF("scalable"),dragControlStart:function(e,t){var n=t.datas,r=t.isPinch,o=t.inputEvent,i=gF(t.parentDirection,r,o,n),a=e.state,s=a.width,l=a.height,c=a.targetTransform,d=a.target,u=a.pos1,p=a.pos2,h=a.pos4;if(!i||!d)return!1;r||MO(e,t),n.datas={},n.transform=c,n.prevDist=[1,1],n.direction=i,n.startOffsetWidth=s,n.startOffsetHeight=l,n.startValue=[1,1];var f=!i[0]&&!i[1]||i[0]||!i[1];function g(e){n.ratio=e&&isFinite(e)?e:0}function m(e){var t=sz(n.startPositions,e);n.fixedDirection=t.fixedDirection,n.fixedPosition=t.fixedPosition,n.fixedOffset=t.fixedOffset}UO(e,t,"scale"),n.isWidth=f,n.startPositions=yF(e.state),n.setFixedDirection=m,g(iI(u,p)/iI(p,h)),m([-i[0],-i[1]]);var v=function(e){n.minScaleSize=e},y=function(e){n.maxScaleSize=e};v([-1/0,-1/0]),y([1/0,1/0]);var x=kF(e,t,ZA(ZA({direction:i,set:function(e){n.startValue=e},setRatio:g,setFixedDirection:m,setMinScaleSize:v,setMaxScaleSize:y},NO(e,t)),{dragStart:az.dragStart(e,(new _O).dragStart([0,0],t))})),b=_F(e,"onScaleStart",x);return n.startFixedDirection=n.fixedDirection,!1!==b&&(n.isScale=!0,e.state.snapRenderInfo={request:t.isRequest,direction:i}),!!n.isScale&&x},dragControl:function(e,t){TO(e,t,"scale");var n=t.datas,r=t.parentKeepRatio,o=t.parentFlag,i=t.isPinch,a=t.dragClient,s=t.isRequest,l=t.useSnap,c=t.resolveMatrix,d=n.prevDist,u=n.direction,p=n.startOffsetWidth,h=n.startOffsetHeight,f=n.isScale,g=n.startValue,m=n.isWidth,v=n.ratio;if(!f)return!1;var y=e.props,x=y.throttleScale,b=y.parentMoveable,w=u;u[0]||u[1]||(w=[1,1]);var S=v&&(null!=r?r:y.keepRatio)||!1,k=e.state,C=[g[0],g[1]];function j(){var e=GF(w,S,n,t),r=e.distWidth,o=e.distHeight,i=p?(p+r)/p:1,a=h?(h+o)/h:1;g[0]||(C[0]=r/p),g[1]||(C[1]=o/h);var s=(w[0]||S?i:1)*C[0],l=(w[1]||S?a:1)*C[1];return 0===s&&(s=$F(d[0])*yO),0===l&&(l=$F(d[1])*yO),[s,l]}var _=j();if(!i&&e.props.groupable){var E=(k.snapRenderInfo||{}).direction;zT(E)&&(E[0]||E[1])&&(k.snapRenderInfo={direction:u,request:t.isRequest})}_F(e,"onBeforeScale",kF(e,t,{scale:_,setFixedDirection:function(e){return n.setFixedDirection(e),_=j()},startFixedDirection:n.startFixedDirection,setScale:function(e){_=e}},!0));var D,M,T=[_[0]/C[0],_[1]/C[1]],I=a,A=[0,0],O=$F(T[0]*T[1]),R=!a&&!o&&i;if(R||c?I=ZO(e,n.targetAllTransform,[0,0],[0,0],n):a||(I=n.fixedPosition),i||(A=zz(e,T,u,!l&&s,n)),S){w[0]&&w[1]&&A[0]&&A[1]&&(Math.abs(A[0]*p)>Math.abs(A[1]*h)?A[1]=0:A[0]=0);var z=!A[0]&&!A[1];if(z&&(m?T[0]=aI(T[0]*C[0],x)/C[0]:T[1]=aI(T[1]*C[1],x)/C[1]),w[0]&&!w[1]||A[0]&&!A[1]||z&&m){T[0]+=A[0];var F=p*T[0]*C[0]/v;T[1]=$F(O*T[0])*KF(F/h/C[1])}else if(!w[0]&&w[1]||!A[0]&&A[1]||z&&!m){T[1]+=A[1];var P=h*T[1]*C[1]*v;T[0]=$F(O*T[1])*KF(P/p/C[0])}}else T[0]+=A[0],T[1]+=A[1],A[0]||(T[0]=aI(T[0]*C[0],x)/C[0]),A[1]||(T[1]=aI(T[1]*C[1],x)/C[1]);0===T[0]&&(T[0]=$F(d[0])*yO),0===T[1]&&(T[1]=$F(d[1])*yO),D=T,M=[C[0],C[1]],_=[D[0]*M[0],D[1]*M[1]];var B=[p,h],L=[p*_[0],h*_[1]];L=tI(L,n.minScaleSize,n.maxScaleSize,!!S&&v),_=JF(2,function(e){return B[e]?L[e]/B[e]:L[e]}),T=JF(2,function(e){return _[e]/C[e]});var N=JF(2,function(e){return d[e]?T[e]/d[e]:T[e]}),U="scale(".concat(T.join(", "),")"),V="scale(".concat(_.join(", "),")"),W=IO(n,V,U),H=!g[0]||!g[1],G=function(e,t,n,r,o,i,a){return $O(e,t,n,r,o,i,a)}(e,H?V:U,n.fixedDirection,I,n.fixedOffset,n,H),X=R?G:TI(G,n.prevInverseDist||[0,0]);if(n.prevDist=T,n.prevInverseDist=G,_[0]===d[0]&&_[1]===d[1]&&X.every(function(e){return!e})&&!b&&!R)return!1;var Y=kF(e,t,ZA({offsetWidth:p,offsetHeight:h,direction:u,scale:_,dist:T,delta:N,isPinch:!!i},qO(e,W,X,i,t)));return _F(e,"onScale",Y),Y},dragControlEnd:function(e,t){var n=t.datas;if(!n.isScale)return!1;n.isScale=!1;var r=CF(e,t,{});return _F(e,"onScaleEnd",r),r},dragGroupControlCondition:tP,dragGroupControlStart:function(e,t){var n=t.datas,r=this.dragControlStart(e,t);if(!r)return!1;var o=aR(e,"resizable",t);n.moveableScale=e.scale;var i=lR(e,this,"dragControlStart",t,function(t,r){return cR(e,t,n,r)}),a=function(t){r.setFixedDirection(t),i.forEach(function(r,i){r.setFixedDirection(t),cR(e,r.moveable,n,o[i])})};n.setFixedDirection=a;var s=ZA(ZA({},r),{targets:e.props.targets,events:i,setFixedDirection:a}),l=_F(e,"onScaleGroupStart",s);return n.isScale=!1!==l,!!n.isScale&&s},dragGroupControl:function(e,t){var n=t.datas;if(n.isScale){jF(e,"onBeforeScale",function(n){_F(e,"onBeforeScaleGroup",kF(e,t,ZA(ZA({},n),{targets:e.props.targets}),!0))});var r=this.dragControl(e,t);if(r){var o=r.dist,i=n.moveableScale;e.scale=[o[0]*i[0],o[1]*i[1]];var a=e.props.keepRatio,s=n.fixedPosition,l=lR(e,this,"dragControl",t,function(t,n){var r=$A(OI(UI(e.rotation/180*Math.PI,3),[n.datas.originalX*o[0],n.datas.originalY*o[1],1],3),2),i=r[0],l=r[1];return ZA(ZA({},n),{parentDist:null,parentScale:o,parentKeepRatio:a,dragClient:MI(s,[i,l])})}),c=ZA({targets:e.props.targets,events:l},r);return _F(e,"onScaleGroup",c),c}}},dragGroupControlEnd:function(e,t){var n=t.isDrag;if(t.datas.isScale){this.dragControlEnd(e,t);var r=lR(e,this,"dragControlEnd",t);return _F(e,"onScaleGroupEnd",CF(e,t,{targets:e.props.targets,events:r})),n}},request:function(){var e={},t=0,n=0,r=!1;return{isControl:!0,requestStart:function(t){return r=t.useSnap,{datas:e,parentDirection:t.direction||[1,1],useSnap:r}},request:function(o){return t+=o.deltaWidth,n+=o.deltaHeight,{datas:e,parentDist:[t,n],parentKeepRatio:o.keepRatio,useSnap:r}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:r}}}}};function rP(e,t){return e.map(function(e,n){return AT(e,t[n],1,2)})}function oP(e,t,n){var r=rI(e,t),o=rI(e,n)-r;return o>=0?o:o+2*Math.PI}var iP={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:LF("warpable"),render:function(e,t){var n=e.props,r=n.resizable,o=n.scalable,i=n.warpable,a=n.zoom;if(r||o||!i)return[];var s=e.state,l=s.pos1,c=s.pos2,d=s.pos3,u=s.pos4,p=rP(l,c),h=rP(c,l),f=rP(l,d),g=rP(d,l),m=rP(d,u),v=rP(u,d),y=rP(c,u),x=rP(u,c);return KA([t.createElement("div",{className:Nz("line"),key:"middeLine1",style:sF(p,m,a)}),t.createElement("div",{className:Nz("line"),key:"middeLine2",style:sF(h,v,a)}),t.createElement("div",{className:Nz("line"),key:"middeLine3",style:sF(f,y,a)}),t.createElement("div",{className:Nz("line"),key:"middeLine4",style:sF(g,x,a)})],$A(gR(e,"warpable",t)),!1)},dragControlCondition:function(e,t){if(t.isRequest)return!1;var n=t.inputEvent.target;return lI(n,Nz("direction"))&&lI(n,Nz("warpable"))},dragControlStart:function(e,t){var n=t.datas,r=t.inputEvent,o=e.props.target,i=mF(r.target,n);if(!i||!o)return!1;var a=e.state,s=a.transformOrigin,l=a.is3d,c=a.targetTransform,d=a.targetMatrix,u=a.width,p=a.height,h=a.left,f=a.top;return n.datas={},n.targetTransform=c,n.warpTargetMatrix=l?d:_I(d,3,4),n.targetInverseMatrix=SI(kI(n.warpTargetMatrix,4),3,4),n.direction=i,n.left=h,n.top=f,n.poses=[[0,0],[u,0],[0,p],[u,p]].map(function(e){return TI(e,s)}),n.nextPoses=n.poses.map(function(e){var t=$A(e,2),r=t[0],o=t[1];return OI(n.warpTargetMatrix,[r,o,0,1],4)}),n.startValue=VI(4),n.prevMatrix=VI(4),n.absolutePoses=yF(a),n.posIndexes=FO(i),MO(e,t),UO(e,t,"matrix3d"),a.snapRenderInfo={request:t.isRequest,direction:i},!1!==_F(e,"onWarpStart",kF(e,t,ZA({set:function(e){n.startValue=e}},NO(e,t))))&&(n.isWarp=!0),n.isWarp},dragControl:function(e,t){var n=t.datas,r=t.isRequest,o=t.distX,i=t.distY,a=n.targetInverseMatrix,s=n.prevMatrix,l=n.isWarp,c=n.startValue,d=n.poses,u=n.posIndexes,p=n.absolutePoses;if(!l)return!1;if(TO(e,t,"matrix3d"),ER(e,"warpable")){var h=u.map(function(e){return p[e]});h.length>1&&h.push([(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]);var f=nz(e,r,{horizontal:h.map(function(e){return e[1]+i}),vertical:h.map(function(e){return e[0]+o})}),g=f.horizontal,m=f.vertical;i-=g.offset,o-=m.offset}var v=zO({datas:n,distX:o,distY:i},!0),y=n.nextPoses.slice();if(u.forEach(function(e){y[e]=MI(y[e],v)}),!gO.every(function(e){return function(e,t){var n=oP(e[0],e[1],e[2]),r=oP(t[0],t[1],t[2]),o=Math.PI;return!(n>=o&&r<=o||n<=o&&r>=o)}(e.map(function(e){return d[e]}),e.map(function(e){return y[e]}))}))return!1;var x=GI(d[0],d[2],d[1],d[3],y[0],y[2],y[1],y[3]);if(!x.length)return!1;var b=OO(n,DI(a,x,4),!0),w=DI(kI(s,4),b,4);n.prevMatrix=b;var S=DI(c,b,4),k=IO(n,"matrix3d(".concat(S.join(", "),")"),"matrix3d(".concat(b.join(", "),")"));return WO(t,k),_F(e,"onWarp",kF(e,t,ZA({delta:w,matrix:S,dist:b,multiply:DI,transform:k},wF({transform:k},t)))),!0},dragControlEnd:function(e,t){var n=t.datas,r=t.isDrag;return!!n.isWarp&&(n.isWarp=!1,_F(e,"onWarpEnd",CF(e,t,{})),r)}},aP=Nz("area-pieces"),sP=Nz("area-piece"),lP=Nz("avoid"),cP=Nz("view-dragging");function dP(e){var t=e.areaElement;if(t){var n=e.state,r=n.width,o=n.height;dI(t,lP),t.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(o,"px")}}function uP(e){return e.createElement("div",{key:"area_pieces",className:aP},e.createElement("div",{className:sP}),e.createElement("div",{className:sP}),e.createElement("div",{className:sP}),e.createElement("div",{className:sP}))}var pP={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(e,t){var n=e.props,r=n.target,o=n.dragArea,i=n.groupable,a=n.passDragArea,s=e.getState(),l=s.width,c=s.height,d=s.renderPoses,u=a?Nz("area","pass"):Nz("area");if(i)return[t.createElement("div",{key:"area",ref:CT(e,"areaElement"),className:u}),uP(t)];if(!r||!o)return[];var p=GI([0,0],[l,0],[0,c],[l,c],d[0],d[1],d[2],d[3]),h=p.length?Jz(p,!0):"none";return[t.createElement("div",{key:"area",ref:CT(e,"areaElement"),className:u,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:h}}),uP(t)]},dragStart:function(e,t){var n=t.datas,r=t.clientX,o=t.clientY;if(!t.inputEvent)return!1;n.isDragArea=!1;var i=e.areaElement,a=e.state,s=a.moveableClientRect,l=a.renderPoses,c=a.rootMatrix,d=a.is3d,u=s.left,p=s.top,h=rF(l),f=h.left,g=h.top,m=h.width,v=h.height,y=$A(RF(c,[r-u,o-p],d?4:3),2),x=y[0],b=y[1],w=[{left:f,top:g,width:m,height:(b-=g)-10},{left:f,top:g,width:(x-=f)-10,height:v},{left:f,top:g+b+10,width:m,height:v-b-10},{left:f+x+10,top:g,width:m-x-10,height:v}],S=[].slice.call(i.nextElementSibling.children);w.forEach(function(e,t){S[t].style.cssText="left: ".concat(e.left,"px;top: ").concat(e.top,"px; width: ").concat(e.width,"px; height: ").concat(e.height,"px;")}),cI(i,lP),a.disableNativeEvent=!0},drag:function(e,t){var n=t.datas,r=t.inputEvent;if(this.enableNativeEvent(e),!r)return!1;n.isDragArea||(n.isDragArea=!0,dP(e))},dragEnd:function(e,t){this.enableNativeEvent(e);var n=t.inputEvent,r=t.datas;if(!n)return!1;r.isDragArea||dP(e)},dragGroupStart:function(e,t){return this.dragStart(e,t)},dragGroup:function(e,t){return this.drag(e,t)},dragGroupEnd:function(e,t){return this.dragEnd(e,t)},unset:function(e){dP(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var t=e.state;t.disableNativeEvent&&ZT(function(){t.disableNativeEvent=!1})}},hP=JA("origin",{props:["origin","svgOrigin"],render:function(e,t){var n,r=e.props,o=r.zoom,i=r.svgOrigin,a=r.groupable,s=e.getState(),l=s.beforeOrigin,c=s.rotation,d=s.svg,u=s.allMatrix,p=s.is3d,h=s.left,f=s.top,g=s.offsetWidth,m=s.offsetHeight;if(!a&&d&&i){var v=$A(YF(i,g,m),2);n=lF(c,o,TI(tF(u,[v[0],v[1]],p?4:3),[h,f]))}else n=lF(c,o,l);return[t.createElement("div",{className:Nz("control","origin"),style:n,key:"beforeOrigin"})]}});function fP(e){var t=e.scrollContainer;return[t.scrollLeft,t.scrollTop]}var gP={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(e,t){var n=e.props,r=n.scrollContainer,o=void 0===r?e.getContainer():r,i=n.scrollOptions,a=new vA,s=UF(o,!0);t.datas.dragScroll=a,e.state.dragScroll=a;var l=t.isControl?"controlGesto":"targetGesto",c=t.targets;a.on("scroll",function(n){var r=n.container,o=n.direction,i=kF(e,t,{scrollContainer:r,direction:o}),a=c?"onScrollGroup":"onScroll";c&&(i.targets=c),_F(e,a,i)}).on("move",function(t){var n=t.offsetX,r=t.offsetY,o=t.inputEvent;e[l].scrollBy(n,r,o.inputEvent,!1)}).on("scrollDrag",function(t){(0,t.next)(e[l].getCurrentEvent())}),a.dragStart(t,ZA({container:s},i))},checkScroll:function(e,t){var n=t.datas.dragScroll;if(n){var r=e.props,o=r.scrollContainer,i=void 0===o?e.getContainer():o,a=r.scrollThreshold,s=void 0===a?0:a,l=r.scrollThrottleTime,c=void 0===l?0:l,d=r.getScrollPosition,u=void 0===d?fP:d,p=r.scrollOptions;return n.drag(t,ZA({container:i,threshold:s,throttleTime:c,getScrollPosition:function(e){return u({scrollContainer:e.container,direction:e.direction})}},p)),!0}},drag:function(e,t){return this.checkScroll(e,t)},dragEnd:function(e,t){t.datas.dragScroll.dragEnd(),t.datas.dragScroll=null},dragControlStart:function(e,t){return this.dragStart(e,ZA(ZA({},t),{isControl:!0}))},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupStart:function(e,t){return this.dragStart(e,ZA(ZA({},t),{targets:e.props.targets}))},dragGroup:function(e,t){return this.drag(e,ZA(ZA({},t),{targets:e.props.targets}))},dragGroupEnd:function(e,t){return this.dragEnd(e,ZA(ZA({},t),{targets:e.props.targets}))},dragGroupControlStart:function(e,t){return this.dragStart(e,ZA(ZA({},t),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,t){return this.drag(e,ZA(ZA({},t),{targets:e.props.targets}))},dragGroupControEnd:function(e,t){return this.dragEnd(e,ZA(ZA({},t),{targets:e.props.targets}))},unset:function(e){var t,n=e.state;null===(t=n.dragScroll)||void 0===t||t.dragEnd(),n.dragScroll=null}},mP={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},vP=JA("padding",{props:["padding"],render:function(e,t){var n=e.props;if(n.dragArea)return[];var r=QF(n.padding||{}),o=r.left,i=r.top,a=r.right,s=r.bottom,l=e.getState(),c=l.renderPoses,d=[l.pos1,l.pos2,l.pos3,l.pos4],u=[];return o>0&&u.push([0,2]),i>0&&u.push([0,1]),a>0&&u.push([1,3]),s>0&&u.push([2,3]),u.map(function(e,n){var r=$A(e,2),o=r[0],i=r[1],a=GI([0,0],[100,0],[0,100],[100,100],d[o],d[i],c[o],c[i]);if(a.length)return t.createElement("div",{key:"padding".concat(n),className:Nz("padding"),style:{transform:Jz(a,!0)}})})}}),yP=["nw","ne","se","sw"];function xP(e,t){var n=e[0]+e[1],r=n>t?t/n:1;return e[0]*=r,e[1]=t-e[1]*r,e}var bP=[1,2,5,6],wP=[0,3,4,7],SP=[1,-1,-1,1],kP=[1,1,-1,-1];function CP(e,t,n,r,o,i,a,s){void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=n),void 0===s&&(s=r);var l=[],c=!1,d=e.filter(function(e){return!e.virtual}),u=d.map(function(e){var d=e.horizontal,u=e.vertical,p=e.pos;if(u&&!c&&(c=!0,l.push("/")),c){var h=Math.max(0,1===u?p[1]-i:s-p[1]);return l.push(PF(h,r,t)),h}h=Math.max(0,1===d?p[0]-o:a-p[0]);return l.push(PF(h,n,t)),h});return{radiusPoses:d,styles:l,raws:u}}function jP(e){for(var t=[0,0],n=[0,0],r=e.length,o=0;o<r;++o){var i=e[o];i.sub&&(i.horizontal&&(0===t[1]&&(t[0]=o),t[1]=o-t[0]+1,n[0]=o+1),i.vertical&&(0===n[1]&&(n[0]=o),n[1]=o-n[0]+1))}return{horizontalRange:t,verticalRange:n}}function _P(e,t,n,r,o,i,a){var s,l,c,d;void 0===i&&(i=[0,0]),void 0===a&&(a=!1);var u=e.indexOf("/"),p=(u>-1?e.slice(0,u):e).length,h=e.slice(0,p),f=e.slice(p+1),g=h.length,m=f.length,v=m>0,y=$A(h,4),x=y[0],b=void 0===x?"0px":x,w=y[1],S=void 0===w?b:w,k=y[2],C=void 0===k?b:k,j=y[3],_=void 0===j?S:j,E=$A(f,4),D=E[0],M=void 0===D?b:D,T=E[1],I=void 0===T?v?M:S:T,A=E[2],O=void 0===A?v?M:C:A,R=E[3],z=void 0===R?v?I:_:R,F=[b,S,C,_].map(function(e){return JT(e,t)}),P=[M,I,O,z].map(function(e){return JT(e,n)}),B=F.slice(),L=P.slice();s=$A(xP([B[0],B[1]],t),2),B[0]=s[0],B[1]=s[1],l=$A(xP([B[3],B[2]],t),2),B[3]=l[0],B[2]=l[1],c=$A(xP([L[0],L[3]],n),2),L[0]=c[0],L[3]=c[1],d=$A(xP([L[1],L[2]],n),2),L[1]=d[0],L[2]=d[1];var N=a?B:B.slice(0,Math.max(i[0],g)),U=a?L:L.slice(0,Math.max(i[1],m));return KA(KA([],$A(N.map(function(e,t){var i=yP[t];return{virtual:t>=g,horizontal:SP[t],vertical:0,pos:[r+e,o+(-1===kP[t]?n:0)],sub:!0,raw:F[t],direction:i}})),!1),$A(U.map(function(e,n){var i=yP[n];return{virtual:n>=m,horizontal:0,vertical:kP[n],pos:[r+(-1===SP[n]?t:0),o+e],sub:!0,raw:P[n],direction:i}})),!1)}var EP=[[0,-1,"n"],[1,0,"e"]],DP=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function MP(e,t,n){var r=e.props.clipRelative,o=e.state,i=o.width,a=o.height,s=t,l=s.type,c=s.poses,d="rect"===l,u="circle"===l;if("polygon"===l)return n.map(function(e){return"".concat(PF(e[0],i,r)," ").concat(PF(e[1],a,r))});if(d||"inset"===l){var p=n[1][1],h=n[3][0],f=n[7][0],g=n[5][1];if(d)return[p,h,g,f].map(function(e){return"".concat(e,"px")});var m=[p,i-h,a-g,f].map(function(e,t){return PF(e,t%2?i:a,r)});if(n.length>8){var v=$A(TI(n[4],n[0]),2),y=v[0],x=v[1];m.push.apply(m,KA(["round"],$A(CP(c.slice(8).map(function(e,t){return ZA(ZA({},e),{pos:n[t]})}),r,y,x,f,p,h,g).styles),!1))}return m}if(u||"ellipse"===l){var b=n[0],w=PF(KF(n[1][1]-b[1]),u?Math.sqrt((i*i+a*a)/2):a,r);return(m=u?[w]:[PF(KF(n[2][0]-b[0]),i,r),w]).push("at",PF(b[0],i,r),PF(b[1],a,r)),m}}function TP(e,t,n,r){var o=[r,(r+t)/2,t],i=[e,(e+n)/2,n];return DP.map(function(e){var t=$A(e,3),n=t[0],r=t[1],a=t[2],s=o[n+1],l=i[r+1];return{vertical:KF(r),horizontal:KF(n),direction:a,pos:[s,l]}})}function IP(e){var t=[1/0,-1/0],n=[1/0,-1/0];return e.forEach(function(e){var r=e.pos;t[0]=Math.min(t[0],r[0]),t[1]=Math.max(t[1],r[0]),n[0]=Math.min(n[0],r[1]),n[1]=Math.max(n[1],r[1])}),[KF(t[1]-t[0]),KF(n[1]-n[0])]}function AP(e,t,n,r,o){var i,a,s,l,c,d,u,p,h;if(e){var f=o;if(!f){var g=iR(e),m=g("clipPath");f="none"!==m?m:g("clip")}if(f&&"none"!==f&&"auto"!==f||(f=r)){var v=HT(f),y=v.prefix,x=void 0===y?f:y,b=v.value,w=void 0===b?"":b,S="circle"===x,k=" ";if("polygon"===x){k=",";var C=(T=WT(w||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map(function(e){var r=$A(e.split(" "),2),o=r[0],i=r[1];return{vertical:1,horizontal:1,pos:[JT(o,t),JT(i,n)]}}),j=SA(C.map(function(e){return e.pos}));return{type:x,clipText:f,poses:C,splitter:k,left:j.minX,right:j.maxX,top:j.minY,bottom:j.maxY}}if(S||"ellipse"===x){var _="",E="",D=0,M=0,T=VT(w);if(S){var I;I=void 0===(a=(i=$A(T,4))[0])?"50%":a,_=void 0===(s=i[2])?"50%":s,E=void 0===(l=i[3])?"50%":l,D=JT(I,Math.sqrt((t*t+n*n)/2)),M=D}else{var A,O;A=void 0===(d=(c=$A(T,5))[0])?"50%":d,O=void 0===(u=c[1])?"50%":u,_=void 0===(p=c[3])?"50%":p,E=void 0===(h=c[4])?"50%":h,D=JT(A,t),M=JT(O,n)}var R=[JT(_,t),JT(E,n)];C=KA([{vertical:1,horizontal:1,pos:R,direction:"nesw"}],$A(EP.slice(0,S?1:2).map(function(e){return{vertical:KF(e[1]),horizontal:e[0],direction:e[2],sub:!0,pos:[R[0]+e[0]*D,R[1]+e[1]*M]}})),!1);return{type:x,clipText:f,radiusX:D,radiusY:M,left:R[0]-D,top:R[1]-M,right:R[0]+D,bottom:R[1]+M,poses:C,splitter:k}}if("inset"===x){var z=(T=VT(w||"0 0 0 0")).indexOf("round"),F=(z>-1?T.slice(0,z):T).length,P=T.slice(F+1),B=$A(T.slice(0,F),4),L=B[0],N=B[1],U=void 0===N?L:N,V=B[2],W=void 0===V?L:V,H=B[3],G=void 0===H?U:H,X=$A([L,W].map(function(e){return JT(e,n)}),2),Y=X[0],q=X[1],Z=$A([G,U].map(function(e){return JT(e,t)}),2),$=Z[0],K=Z[1],J=t-K,Q=n-q,ee=_P(P,J-$,Q-Y,$,Y);return{type:"inset",clipText:f,poses:C=KA(KA([],$A(TP(Y,J,Q,$)),!1),$A(ee),!1),top:Y,left:$,right:J,bottom:Q,radius:P,splitter:k}}if("rect"===x){k=",";var te=$A((T=WT(w||"0px, ".concat(t,"px, ").concat(n,"px, 0px"))).map(function(e){return GT(e).value}),4),ne=te[0];return{type:"rect",clipText:f,poses:C=TP(ne,K=te[1],q=te[2],$=te[3]),top:ne,right:K,bottom:q,left:$,values:T,splitter:k}}}}}function OP(e,t){var n=$A(DO(e,t),2),r=n[0],o=n[1],i=t.datas,a=i.clipPath,s=i.clipIndex,l=a,c=l.type,d=l.poses,u=l.splitter,p=d.map(function(e){return e.pos});if("polygon"===c)p.splice(s,0,[r,o]);else{if("inset"!==c)return;var h=bP.indexOf(s),f=wP.indexOf(s),g=d.length;if(function(e,t,n,r,o,i,a,s,l,c,d){void 0===c&&(c=0),void 0===d&&(d=0);var u=jP(e.slice(n)),p=u.horizontalRange,h=u.verticalRange;if(r>-1)for(var f=1===SP[r]?i-c:s-i,g=p[1];g<=r;++g){var m=1===kP[g]?d:l,v=0;if(r===g?v=i:0===g?v=c+f:-1===SP[g]&&(v=s-(t[n][0]-c)),e.splice(n+g,0,{horizontal:SP[g],vertical:0,pos:[v,m]}),t.splice(n+g,0,[v,m]),0===g)break}else if(o>-1){var y=1===kP[o]?a-d:l-a;if(0===p[1]&&0===h[1]){var x=[c+y,d];e.push({horizontal:SP[0],vertical:0,pos:x}),t.push(x)}var b=h[0];for(g=h[1];g<=o&&(v=1===SP[g]?c:s,m=0,o===g?m=a:0===g?m=d+y:1===kP[g]?m=t[n+b][1]:-1===kP[g]&&(m=l-(t[n+b][1]-d)),e.push({horizontal:0,vertical:kP[g],pos:[v,m]}),t.push([v,m]),0!==g);++g);}}(d,p,8,h,f,r,o,p[4][0],p[4][1],p[0][0],p[0][1]),g===d.length)return}var m=MP(e,a,p),v="".concat(c,"(").concat(m.join(u),")");_F(e,"onClip",kF(e,t,ZA({clipEventType:"added",clipType:c,poses:p,clipStyles:m,clipStyle:v,distX:0,distY:0},wF({clipPath:v},t))))}function RP(e,t){var n=t.datas,r=n.clipPath,o=n.clipIndex,i=r,a=i.type,s=i.poses,l=i.splitter,c=s.map(function(e){return e.pos}),d=c.length;if("polygon"===a)s.splice(o,1),c.splice(o,1);else{if("inset"!==a)return;if(o<8)return;if(function(e,t,n,r,o){void 0===o&&(o=t.length);var i=jP(e.slice(r)),a=i.horizontalRange,s=i.verticalRange,l=n-r,c=0;if(0===l)c=o;else if(l>0&&l<a[1])c=a[1]-l;else{if(!(l>=s[0]))return;c=s[0]+s[1]-l}e.splice(n,c),t.splice(n,c)}(s,c,o,8,d),d===s.length)return}var u=MP(e,r,c),p="".concat(a,"(").concat(u.join(l),")");_F(e,"onClip",kF(e,t,ZA({clipEventType:"removed",clipType:a,poses:c,clipStyles:u,clipStyle:p,distX:0,distY:0},wF({clipPath:p},t))))}var zP={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[".control.clip-control {\nbackground: #6d6;\ncursor: pointer;\n}\n.control.clip-control.clip-radius {\nbackground: #d66;\n}\n.line.clip-line {\nbackground: #6e6;\ncursor: move;\nz-index: 1;\n}\n.clip-area {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.clip-ellipse {\nposition: absolute;\ncursor: move;\nborder: 1px solid #6d6;\nborder: var(--zoompx) solid #6d6;\nborder-radius: 50%;\ntransform-origin: 0px 0px;\n}",":host {\n--bounds-color: #d66;\n}",".guideline {\npointer-events: none;\nz-index: 2;\n}",".line.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}"],render:function(e,t){var n=e.props,r=n.customClipPath,o=n.defaultClipPath,i=n.clipArea,a=n.zoom,s=n.groupable,l=e.getState(),c=l.target,d=l.width,u=l.height,p=l.allMatrix,h=l.is3d,f=l.left,g=l.top,m=l.pos1,v=l.pos2,y=l.pos3,x=l.pos4,b=l.clipPathState,w=l.snapBoundInfos,S=l.rotation;if(!c||s)return[];var k=AP(c,d,u,o||"inset",b||r);if(!k)return[];var C=h?4:3,j=k.type,_=k.poses.map(function(e){var t=tF(p,e.pos,C);return[t[0]-f,t[1]-g]}),E=[],D=[],M="rect"===j,T="inset"===j,I="polygon"===j;if(M||T||I){var A=T?_.slice(0,8):_;D=A.map(function(e,n){var r=0===n?A[A.length-1]:A[n-1],o=rI(r,e),i=aF(r,e);return t.createElement("div",{key:"clipLine".concat(n),className:Nz("line","clip-line","snap-control"),"data-clip-index":n,style:{width:"".concat(i,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(o,"rad) scaleY(").concat(a,")")}})})}if(E=_.map(function(e,n){return t.createElement("div",{key:"clipControl".concat(n),className:Nz("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(S,"rad) scale(").concat(a,")")}})}),T&&E.push.apply(E,KA([],$A(_.slice(8).map(function(e,n){return t.createElement("div",{key:"clipRadiusControl".concat(n),className:Nz("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(S,"rad) scale(").concat(a,")")}})})),!1)),"circle"===j||"ellipse"===j){var O=k.left,R=k.top,z=k.radiusX,F=k.radiusY,P=$A(TI(tF(p,[O,R],C),tF(p,[0,0],C)),2),B=P[0],L=P[1],N="none";if(!i){for(var U=Math.max(10,z/5,F/5),V=[],W=0;W<=U;++W){var H=2*Math.PI/U*W;V.push([z+(z-a)*Math.cos(H),F+(F-a)*Math.sin(H)])}V.push([z,-2]),V.push([-2,-2]),V.push([-2,2*F+2]),V.push([2*z+2,2*F+2]),V.push([2*z+2,-2]),V.push([z,-2]),N="polygon(".concat(V.map(function(e){return"".concat(e[0],"px ").concat(e[1],"px")}).join(", "),")")}E.push(t.createElement("div",{key:"clipEllipse",className:Nz("clip-ellipse","snap-control"),style:{width:"".concat(2*z,"px"),height:"".concat(2*F,"px"),clipPath:N,transform:"translate(".concat(-f+B,"px, ").concat(-g+L,"px) ").concat(Jz(p))}}))}if(i){var G=rF(KA([m,v,y,x],$A(_),!1)),X=G.width,Y=G.height,q=G.left,Z=G.top;if(I||M||T){V=T?_.slice(0,8):_;E.push(t.createElement("div",{key:"clipArea",className:Nz("clip-area","snap-control"),style:{width:"".concat(X,"px"),height:"".concat(Y,"px"),transform:"translate(".concat(q,"px, ").concat(Z,"px)"),clipPath:"polygon(".concat(V.map(function(e){return"".concat(e[0]-q,"px ").concat(e[1]-Z,"px")}).join(", "),")")}}))}}return w&&["vertical","horizontal"].forEach(function(e){var n=w[e],r="horizontal"===e;n.isSnap&&D.push.apply(D,KA([],$A(n.snap.posInfos.map(function(n,o){var i=n.pos,s=TI(tF(p,r?[0,i]:[i,0],C),[f,g]),l=TI(tF(p,r?[d,i]:[i,u],C),[f,g]);return pR(t,"",s,l,a,"clip".concat(e,"snap").concat(o),"guideline")})),!1)),n.isBound&&D.push.apply(D,KA([],$A(n.bounds.map(function(n,o){var i=n.pos,s=TI(tF(p,r?[0,i]:[i,0],C),[f,g]),l=TI(tF(p,r?[d,i]:[i,u],C),[f,g]);return pR(t,"",s,l,a,"clip".concat(e,"bounds").concat(o),"guideline","bounds","bold")})),!1))}),KA(KA([],$A(E),!1),$A(D),!1)},dragControlCondition:function(e,t){return t.inputEvent&&(t.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(e,t){var n=e.props.dragWithClip;return!(void 0===n||n)&&this.dragControlStart(e,t)},drag:function(e,t){return this.dragControl(e,ZA(ZA({},t),{isDragTarget:!0}))},dragEnd:function(e,t){return this.dragControlEnd(e,t)},dragControlStart:function(e,t){var n=e.state,r=e.props,o=r.defaultClipPath,i=r.customClipPath,a=n.target,s=n.width,l=n.height,c=t.inputEvent?t.inputEvent.target:null,d=c&&c.getAttribute("class")||"",u=t.datas,p=AP(a,s,l,o||"inset",i);if(!p)return!1;var h=p.clipText;return!1===_F(e,"onClipStart",kF(e,t,{clipType:p.type,clipStyle:h,poses:p.poses.map(function(e){return e.pos})}))?(u.isClipStart=!1,!1):(u.isControl=d&&d.indexOf("clip-control")>-1,u.isLine=d.indexOf("clip-line")>-1,u.isArea=d.indexOf("clip-area")>-1||d.indexOf("clip-ellipse")>-1,u.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,u.clipPath=p,u.isClipStart=!0,n.clipPathState=h,MO(e,t),!0)},dragControl:function(e,t){var n,r,o,i=t.datas,a=t.originalDatas,s=t.isDragTarget;if(!i.isClipStart)return!1;var l=i,c=l.isControl,d=l.isLine,u=l.isArea,p=l.clipIndex,h=l.clipPath;if(!h)return!1;var f=cF(e.props,"clippable"),g=f.keepRatio,m=0,v=0,y=a.draggable,x=zO(t);s&&y?(n=$A(y.prevBeforeDist,2),m=n[0],v=n[1]):(r=$A(x,2),m=r[0],v=r[1]);var b=[m,v],w=e.state,S=w.width,k=w.height,C=!u&&!c&&!d,j=h.type,_=h.poses,E=h.splitter,D=_.map(function(e){return e.pos});C&&(m=-m,v=-v);var M=!c||"nesw"===_[p].direction,T="inset"===j||"rect"===j,I=_.map(function(){return[0,0]});if(c&&!M){var A=_[p],O=A.horizontal,R=A.vertical,z=[m*KF(O),v*KF(R)];I=function(e,t,n,r,o){var i=e[t],a=i.direction,s=i.sub,l=e.map(function(){return[0,0]}),c=a?a.split(""):[];if(r&&t<8){var d=c.filter(function(e){return"w"===e||"e"===e}),u=c.filter(function(e){return"n"===e||"s"===e}),p=d[0],h=u[0];l[t]=n;var f=$A(IP(e),2),g=f[0],m=f[1],v=g&&m?g/m:0;if(v&&o){var y=e[(t+4)%8].pos,x=[0,0];a.indexOf("w")>-1?x[0]=-1:a.indexOf("e")>-1&&(x[0]=1),a.indexOf("n")>-1?x[1]=-1:a.indexOf("s")>-1&&(x[1]=1);var b=HF([g,m],n,v,x,!0),w=g+b[0],S=m+b[1],k=y[1],C=y[1],j=y[0],_=y[0];-1===x[0]?j=_-w:1===x[0]?_=j+w:(j-=w/2,_+=w/2),-1===x[1]?k=C-S:C=1===x[1]?k+S:(k=C-S/2)+S;var E=TP(k,_,C,j);e.forEach(function(e,t){l[t][0]=E[t].pos[0]-e.pos[0],l[t][1]=E[t].pos[1]-e.pos[1]})}else e.forEach(function(e,t){var r=e.direction;r&&(r.indexOf(p)>-1&&(l[t][0]=n[0]),r.indexOf(h)>-1&&(l[t][1]=n[1]))}),p&&(l[1][0]=n[0]/2,l[5][0]=n[0]/2),h&&(l[3][1]=n[1]/2,l[7][1]=n[1]/2)}else a&&!s?c.forEach(function(t){var r="n"===t||"s"===t;e.forEach(function(e,o){var i=e.direction,a=e.horizontal,s=e.vertical;i&&-1!==i.indexOf(t)&&(l[o]=[r||!a?0:n[0],r&&s?n[1]:0])})}):l[t]=n;return l}(_,p,z,T,g)}else M&&(I=D.map(function(){return[m,v]}));var F=D.map(function(e,t){return MI(e,I[t])}),P=KA([],$A(F),!1);w.snapBoundInfos=null;var B="circle"===h.type,L="ellipse"===h.type;if(B||L){var N=KF((ne=rF(F)).bottom-ne.top),U=KF(L?ne.right-ne.left:N),V=F[0][1]+N,W=F[0][0]-U,H=F[0][0]+U;B&&(P.push([H,ne.bottom]),I.push([1,0])),P.push([ne.left,V]),I.push([0,1]),P.push([W,ne.bottom]),I.push([1,0])}var G=_z((f.clipHorizontalGuidelines||[]).map(function(e){return JT("".concat(e),k)}),(f.clipVerticalGuidelines||[]).map(function(e){return JT("".concat(e),S)}),S,k),X=[],Y=[];if(B||L)X=[P[4][0],P[2][0]],Y=[P[1][1],P[3][1]];else if(T){var q=[P[0],P[2],P[4],P[6]],Z=[I[0],I[2],I[4],I[6]];X=q.filter(function(e,t){return Z[t][0]}).map(function(e){return e[0]}),Y=q.filter(function(e,t){return Z[t][1]}).map(function(e){return e[1]})}else X=P.filter(function(e,t){return I[t][0]}).map(function(e){return e[0]}),Y=P.filter(function(e,t){return I[t][1]}).map(function(e){return e[1]});var $=[0,0],K=rz(G,f.clipTargetBounds&&{left:0,top:0,right:S,bottom:k},X,Y,5,5),J=K.horizontal,Q=K.vertical,ee=J.offset,te=Q.offset;if(J.isBound&&($[1]+=ee),Q.isBound&&($[0]+=te),(L||B)&&0===I[0][0]&&0===I[0][1]){var ne,re=(ne=rF(F)).bottom-ne.top,oe=L?ne.right-ne.left:re;oe-=Q.isBound?KF(te):0===Q.snapIndex?-te:te,re-=J.isBound?KF(ee):0===J.snapIndex?-ee:ee,B&&(oe=re=UR(Q,J)>0?re:oe);var ie=P[0];P[1][1]=ie[1]-re,P[2][0]=ie[0]+oe,P[3][1]=ie[1]+re,P[4][0]=ie[0]-oe}else if(T&&g&&c){var ae=$A(IP(_),2),se=ae[0],le=ae[1],ce=se&&le?se/le:0,de=_[p].direction||"",ue=P[1][1];V=P[5][1],W=P[7][0],H=P[3][0];KF(ee)<=KF(te)?ee=$F(ee)*KF(te)/ce:te=$F(te)*KF(ee)*ce,de.indexOf("w")>-1?W-=te:de.indexOf("e")>-1?H-=te:(W+=te/2,H-=te/2),de.indexOf("n")>-1?ue-=ee:de.indexOf("s")>-1?V-=ee:(ue+=ee/2,V-=ee/2);var pe=TP(ue,H,V,W);P.forEach(function(e,t){var n;n=$A(pe[t].pos,2),e[0]=n[0],e[1]=n[1]})}else P.forEach(function(e,t){var n=I[t];n[0]&&(e[0]-=te),n[1]&&(e[1]-=ee)});var he=MP(e,h,F),fe="".concat(j,"(").concat(he.join(E),")");if(w.clipPathState=fe,B||L)X=[P[4][0],P[2][0]],Y=[P[1][1],P[3][1]];else if(T){X=(q=[P[0],P[2],P[4],P[6]]).map(function(e){return e[0]}),Y=q.map(function(e){return e[1]})}else X=P.map(function(e){return e[0]}),Y=P.map(function(e){return e[1]});if(w.snapBoundInfos=rz(G,f.clipTargetBounds&&{left:0,top:0,right:S,bottom:k},X,Y,1,1),y){var ge=w.is3d,me=w.allMatrix,ve=ge?4:3,ye=$;s&&(ye=[b[0]+$[0]-x[0],b[1]+$[1]-x[1]]),y.deltaOffset=DI(me,[ye[0],ye[1],0,0],ve)}return _F(e,"onClip",kF(e,t,ZA({clipEventType:"changed",clipType:j,poses:F,clipStyle:fe,clipStyles:he,distX:m,distY:v},wF(((o={})["rect"===j?"clip":"clipPath"]=fe,o),t)))),!0},dragControlEnd:function(e,t){this.unset(e);var n=t.isDrag,r=t.datas,o=t.isDouble,i=r.isLine,a=r.isClipStart,s=r.isControl;return!!a&&(_F(e,"onClipEnd",CF(e,t,{})),o&&(s?RP(e,t):i&&OP(e,t)),o||n)},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},FP={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[":host[data-able-origindraggable] .control.origin {\npointer-events: auto;\n}"],dragControlCondition:function(e,t){return t.isRequest?"originDraggable"===t.requestAble:lI(t.inputEvent.target,Nz("origin"))},dragControlStart:function(e,t){var n=t.datas;MO(e,t);var r=kF(e,t,{dragStart:az.dragStart(e,(new _O).dragStart([0,0],t))}),o=_F(e,"onDragOriginStart",r);return n.startOrigin=e.state.transformOrigin,n.startTargetOrigin=e.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,!1===o?(n.isDragOrigin=!1,!1):r},dragControl:function(e,t){var n=t.datas,r=t.isPinch,o=t.isRequest;if(!n.isDragOrigin)return!1;var i=$A(zO(t),2),a=i[0],s=i[1],l=e.state,c=l.width,d=l.height,u=l.offsetMatrix,p=l.targetMatrix,h=l.is3d,f=e.props.originRelative,g=void 0===f||f,m=h?4:3,v=[a,s];if(o){var y=t.distOrigin;(y[0]||y[1])&&(v=y)}var x=MI(n.startOrigin,v),b=MI(n.startTargetOrigin,v),w=TI(v,n.prevOrigin),S=LO(u,p,x,m),k=e.getRect(),C=rF(nF(S,c,d,m)),j=[k.left-C.left,k.top-C.top];n.prevOrigin=v;var _=[PF(b[0],c,g),PF(b[1],d,g)].join(" "),E=az.drag(e,jO(t,e.state,j,!!r,!1)),D=kF(e,t,ZA(ZA({width:c,height:d,origin:x,dist:v,delta:w,transformOrigin:_,drag:E},wF({transformOrigin:_,transform:E.transform},t)),{afterTransform:E.transform}));return _F(e,"onDragOrigin",D),D},dragControlEnd:function(e,t){return!!t.datas.isDragOrigin&&(_F(e,"onDragOriginEnd",CF(e,t,{})),!0)},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragGroupControlStart:function(e,t){return!!this.dragControlStart(e,t)},dragGroupControl:function(e,t){var n=this.dragControl(e,t);return!!n&&(e.transformOrigin=n.transformOrigin,!0)},request:function(e){var t={},n=e.getRect(),r=0,o=0,i=n.transformOrigin,a=[0,0];return{isControl:!0,requestStart:function(){return{datas:t}},request:function(e){return"deltaOrigin"in e?(a[0]+=e.deltaOrigin[0],a[1]+=e.deltaOrigin[1]):"origin"in e?(a[0]=e.origin[0]-i[0],a[1]=e.origin[1]-i[1]):("x"in e?r=e.x-n.left:"deltaX"in e&&(r+=e.deltaX),"y"in e?o=e.y-n.top:"deltaY"in e&&(o+=e.deltaY)),{datas:t,distX:r,distY:o,distOrigin:a}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function PP(e,t,n,r,o){void 0===r&&(r=[0,0]);return _P(e&&"0px"!==e?VT(e):[],t,n,0,0,r,o)}function BP(e,t,n,r,o){var i=e.state,a=i.width,s=i.height,l=CP(o,e.props.roundRelative,a,s),c=l.raws,d=l.styles,u=function(e,t){void 0===t&&(t=e.map(function(e){return e.raw}));var n=e.map(function(e,n){return e.horizontal?t[n]:null}).filter(function(e){return null!=e}),r=e.map(function(e,n){return e.vertical?t[n]:null}).filter(function(e){return null!=e});return{horizontals:n,verticals:r}}(l.radiusPoses,c),p=u.horizontals,h=u.verticals,f=d.join(" ");i.borderRadiusState=f;var g=kF(e,t,ZA({horizontals:p,verticals:h,borderRadius:f,width:a,height:s,delta:r,dist:n},wF({borderRadius:f},t)));return _F(e,"onRound",g),g}function LP(e){var t,n,r=e.getState().style,o=r.borderRadius||"";if(!o&&e.props.groupable){var i=e.moveables[0],a=e.getTargets()[0];a&&((null===i||void 0===i?void 0:i.props.target)===a?(o=null!==(n=null===(t=e.moveables[0])||void 0===t?void 0:t.state.style.borderRadius)&&void 0!==n?n:"",r.borderRadius=o):(o=EF(a).borderRadius,r.borderRadius=o))}return o}var NP={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[".control.border-radius {\nbackground: #d66;\ncursor: pointer;\nz-index: 3;\n}",".control.border-radius.vertical {\nbackground: #d6d;\nz-index: 2;\n}",".control.border-radius.virtual {\nopacity: 0.5;\nz-index: 1;\n}",":host.round-line-clickable .line.direction {\ncursor: pointer;\n}"],className:function(e){var t=e.props.roundClickable;return!0===t||"line"===t?Nz("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(e,t){var n=e.getState(),r=n.target,o=n.width,i=n.height,a=n.allMatrix,s=n.is3d,l=n.left,c=n.top,d=n.borderRadiusState,u=e.props,p=u.minRoundControls,h=void 0===p?[0,0]:p,f=u.maxRoundControls,g=void 0===f?[4,4]:f,m=u.zoom,v=u.roundPadding,y=void 0===v?0:v,x=u.isDisplayShadowRoundControls,b=u.groupable;if(!r)return null;var w=d||LP(e),S=s?4:3,k=PP(w,o,i,h,!0);if(!k)return null;var C=0,j=0,_=b?[0,0]:[l,c];return k.map(function(e,n){var r=e.horizontal,o=e.vertical,i=e.direction||"",s=KA([],$A(e.pos),!1);j+=Math.abs(r),C+=Math.abs(o),r&&i.indexOf("n")>-1&&(s[1]-=y),o&&i.indexOf("w")>-1&&(s[0]-=y),r&&i.indexOf("s")>-1&&(s[1]+=y),o&&i.indexOf("e")>-1&&(s[0]+=y);var l=TI(tF(a,s,S),_),c=x&&"horizontal"!==x,d=e.vertical?C<=g[1]&&(c||!e.virtual):j<=g[0]&&(x||!e.virtual);return t.createElement("div",{key:"borderRadiusControl".concat(n),className:Nz("control","border-radius",e.vertical?"vertical":"",e.virtual?"virtual":""),"data-radius-index":n,style:{display:d?"block":"none",transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) scale(").concat(m,")")}})})},dragControlCondition:function(e,t){if(!t.inputEvent||t.isRequest)return!1;var n=t.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragControlStart:function(e,t){var n=t.inputEvent,r=t.datas,o=n.target,i=o.getAttribute("class")||"",a=i.indexOf("border-radius")>-1,s=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=a?parseInt(o.getAttribute("data-radius-index"),10):-1,c=-1;if(s){var d=o.getAttribute("data-line-key")||"";d&&(c=parseInt(d.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!a&&!s)return!1;var u=kF(e,t,{});if(!1===_F(e,"onRoundStart",u))return!1;r.lineIndex=c,r.controlIndex=l,r.isControl=a,r.isLine=s,MO(e,t);var p=e.props,h=p.roundRelative,f=p.minRoundControls,g=void 0===f?[0,0]:f,m=e.state,v=m.width,y=m.height;r.isRound=!0,r.prevDist=[0,0];var x=PP(LP(e)||"",v,y,g,!0)||[];return r.controlPoses=x,m.borderRadiusState=CP(x,h,v,y).styles.join(" "),u},dragControl:function(e,t){var n=t.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var o=n.controlIndex,i=$A(zO(t),2),a=i[0],s=i[1],l=[a,s],c=TI(l,n.prevDist),d=e.props.maxRoundControls,u=void 0===d?[4,4]:d,p=e.state,h=p.width,f=p.height,g=r[o],m=g.vertical,v=g.horizontal,y=r.map(function(e){var t=e.horizontal,n=e.vertical,r=[t*v*l[0],n*m*l[1]];if(t){if(1===u[0])return r;if(u[0]<4&&t!==v)return r}else{if(0===u[1])return r[1]=n*v*l[0]/h*f,r;if(m){if(1===u[1])return r;if(u[1]<4&&n!==m)return r}}return[0,0]});y[o]=l;var x=r.map(function(e,t){return ZA(ZA({},e),{pos:MI(e.pos,y[t])})});return o<4?x.slice(0,o+1).forEach(function(e){e.virtual=!1}):x.slice(4,o+1).forEach(function(e){e.virtual=!1}),n.prevDist=[a,s],BP(e,t,l,c,x)},dragControlEnd:function(e,t){var n=e.state;n.borderRadiusState="";var r=t.datas,o=t.isDouble;if(!r.isRound)return!1;var i=r.isControl,a=r.controlIndex,s=r.isLine,l=r.lineIndex,c=r.controlPoses,d=c.filter(function(e){return e.virtual}).length,u=e.props.roundClickable,p=void 0===u||u;if(o&&p){if(!i||!0!==p&&"control"!==p){if(s&&(!0===p||"line"===p)){var h=$A(DO(e,t),2);!function(e,t,n,r){var o=e.filter(function(e){var t=e.virtual;return e.horizontal&&!t}).length,i=e.filter(function(e){var t=e.virtual;return e.vertical&&!t}).length,a=-1;if(0===t&&(0===o?a=0:1===o&&(a=1)),2===t&&(o<=2?a=2:o<=3&&(a=3)),3===t&&(0===i?a=4:i<4&&(a=7)),1===t&&(i<=1?a=5:i<=2&&(a=6)),-1!==a&&e[a].virtual){var s=e[a];!function(e,t){t<4?e.slice(0,t+1).forEach(function(e){e.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,t+1).forEach(function(e){e.virtual=!1}))}(e,a),a<4?s.pos[0]=n:s.pos[1]=r}}(c,l,h[0],h[1])}}else!function(e,t){t<4?e.slice(t,4).forEach(function(e){e.virtual=!0}):e.slice(t).forEach(function(e){e.virtual=!0})}(c,a);d!==c.filter(function(e){return e.virtual}).length&&BP(e,t,[0,0],[0,0],c)}var f=CF(e,t,{});return _F(e,"onRoundEnd",f),n.borderRadiusState="",f},dragGroupControlStart:function(e,t){var n=this.dragControlStart(e,t);if(!n)return!1;var r=e.moveables,o=e.props.targets,i=aR(e,"roundable",t),a=ZA({targets:e.props.targets,events:i.map(function(e,t){return ZA(ZA({},e),{target:o[t],moveable:r[t],currentTarget:r[t]})})},n);return _F(e,"onRoundGroupStart",a),n},dragGroupControl:function(e,t){var n=this.dragControl(e,t);if(!n)return!1;var r=e.moveables,o=e.props.targets,i=aR(e,"roundable",t),a=ZA({targets:e.props.targets,events:i.map(function(e,t){return ZA(ZA(ZA({},e),{target:o[t],moveable:r[t],currentTarget:r[t]}),wF({borderRadius:n.borderRadius},e))})},n);return _F(e,"onRoundGroup",a),a},dragGroupControlEnd:function(e,t){var n=e.moveables,r=e.props.targets,o=aR(e,"roundable",t);jF(e,"onRound",function(t){var i=ZA({targets:e.props.targets,events:o.map(function(e,o){return ZA(ZA(ZA({},e),{target:r[o],moveable:n[o],currentTarget:n[o]}),wF({borderRadius:t.borderRadius},e))})},t);_F(e,"onRoundGroup",i)});var i=this.dragControlEnd(e,t);if(!i)return!1;var a=ZA({targets:e.props.targets,events:o.map(function(e,t){var o;return ZA(ZA({},e),{target:r[t],moveable:n[t],currentTarget:n[t],lastEvent:null===(o=e.datas)||void 0===o?void 0:o.lastEvent})})},i);return _F(e,"onRoundGroupEnd",a),a},unset:function(e){e.state.borderRadiusState=""}};var UP={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(e,t){var n=e.state,r=n.is3d,o=n.targetMatrix,i=n.inlineTransform,a=r?"matrix3d(".concat(o.join(","),")"):"matrix(".concat(AI(o,!0),")"),s=i&&"none"!==i?i:a;t.datas.startTransforms=function(e,t){var n=VI(t?4:3);return e==="matrix".concat(t?"3d":"","(").concat(n.join(","),")")||"matrix(1,0,0,1,0,0)"===e}(s,r)?[]:VT(s)},resetStyle:function(e){var t=e.datas;t.nextStyle={},t.nextTransforms=e.datas.startTransforms,t.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,t){return kF(e,t,{setTransform:function(e){t.datas.startTransforms=zT(e)?e:VT(e)},isPinch:!!t.isPinch})},fillDragParams:function(e,t){return kF(e,t,{isPinch:!!t.isPinch})},dragStart:function(e,t){this.setTransform(e,t),this.resetStyle(t),_F(e,"onBeforeRenderStart",this.fillDragStartParams(e,t))},drag:function(e,t){t.datas.startTransforms||this.setTransform(e,t),this.resetStyle(t),_F(e,"onBeforeRender",kF(e,t,{isPinch:!!t.isPinch}))},dragEnd:function(e,t){t.datas.startTransforms||(this.setTransform(e,t),this.resetStyle(t)),_F(e,"onBeforeRenderEnd",kF(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag}))},dragGroupStart:function(e,t){var n=this;this.dragStart(e,t);var r=aR(e,"beforeRenderable",t),o=e.moveables,i=r.map(function(e,t){var r=o[t];return n.setTransform(r,e),n.resetStyle(e),n.fillDragStartParams(r,e)});_F(e,"onBeforeRenderGroupStart",kF(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,t){var n=this;this.drag(e,t);var r=aR(e,"beforeRenderable",t),o=e.moveables,i=r.map(function(e,t){var r=o[t];return n.resetStyle(e),n.fillDragParams(r,e)});_F(e,"onBeforeRenderGroup",kF(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,t){this.dragEnd(e,t),_F(e,"onBeforeRenderGroupEnd",kF(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets}))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)}},VP={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(e,t){_F(e,"onRenderStart",kF(e,t,{isPinch:!!t.isPinch}))},drag:function(e,t){_F(e,"onRender",this.fillDragParams(e,t))},dragAfter:function(e,t){return this.drag(e,t)},dragEnd:function(e,t){_F(e,"onRenderEnd",this.fillDragEndParams(e,t))},dragGroupStart:function(e,t){_F(e,"onRenderGroupStart",kF(e,t,{isPinch:!!t.isPinch,targets:e.props.targets}))},dragGroup:function(e,t){var n=this,r=aR(e,"beforeRenderable",t),o=e.moveables,i=r.map(function(e,t){var r=o[t];return n.fillDragParams(r,e)});_F(e,"onRenderGroup",kF(e,t,ZA(ZA({isPinch:!!t.isPinch,targets:e.props.targets,transform:XO(t),transformObject:{}},wF(YO(t))),{events:i})))},dragGroupEnd:function(e,t){var n=this,r=aR(e,"beforeRenderable",t),o=e.moveables,i=r.map(function(e,t){var r=o[t];return n.fillDragEndParams(r,e)});_F(e,"onRenderGroupEnd",kF(e,t,ZA({isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets,events:i,transformObject:{},transform:XO(t)},wF(YO(t)))))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlAfter:function(e,t){return this.dragAfter(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)},fillDragParams:function(e,t){var n={};return ZI(GO(t)||[]).forEach(function(e){n[e.name]=e.functionValue}),kF(e,t,ZA({isPinch:!!t.isPinch,transformObject:n,transform:XO(t)},wF(YO(t))))},fillDragEndParams:function(e,t){var n={};return ZI(GO(t)||[]).forEach(function(e){n[e.name]=e.functionValue}),kF(e,t,ZA({isPinch:!!t.isPinch,isDrag:t.isDrag,transformObject:n,transform:XO(t)},wF(YO(t))))}};function WP(e,t,n,r,o,i,a){i.clientDistX=i.distX,i.clientDistY=i.distY;var s="Start"===o,l="End"===o,c="After"===o,d=e.state.target,u=i.isRequest,p=r.indexOf("Control")>-1;if(!d||s&&p&&!u&&e.areaElement===i.inputEvent.target)return!1;var h=KA([],$A(t),!1);if(u){var f=i.requestAble;h.some(function(e){return e.name===f})||h.push.apply(h,KA([],$A(e.props.ables.filter(function(e){return e.name===f})),!1))}if(!h.length||h.every(function(e){return e.dragRelation}))return!1;var g,m=i.inputEvent;l&&m&&(g=document.elementFromPoint(i.clientX,i.clientY)||m.target);var v=!1,y=function(){var e;v=!0,null===(e=i.stop)||void 0===e||e.call(i)},x=s&&(!e.targetGesto||!e.controlGesto||!e.targetGesto.isFlag()||!e.controlGesto.isFlag());x&&e.updateRect(o,!0,!1);var b=i.datas,w=p?"controlGesto":"targetGesto",S=e[w],k=function(t,n,r){if(!(n in t)||S!==e[w])return!1;var o=t.name,a=b[o]||(b[o]={});if(s&&(a.isEventStart=!r||!t[r]||t[r](e,i)),!a.isEventStart)return!1;var l=t[n](e,ZA(ZA({},i),{stop:y,datas:a,originalDatas:b,inputTarget:g}));return e._emitter.off(),s&&!1===l&&(a.isEventStart=!1),l};x&&h.forEach(function(t){t.unset&&t.unset(e)}),k(UP,"drag".concat(r).concat(o));var C=0,j=0;n.forEach(function(t){if(v)return!1;var n="".concat(t).concat(r).concat(o),a="".concat(t).concat(r,"Condition");""!==o||u||zF(e.state,i);var l=h.filter(function(e){return e[n]});l=l.filter(function(e,t){return e.name&&l.indexOf(e)===t});var c=l.filter(function(e){return k(e,n,a)}).length;v&&++C,c&&++j,!v&&s&&l.length&&!c&&(C+=l.filter(function(e){var t=e.name;return!!b[t].isEventStart&&"strong"!==e.dragRelation}).length?1:0)}),c&&!j||k(VP,"drag".concat(r).concat(o));var _=S!==e[w]||C===n.length;if((l||v||_)&&(e.state.gestos={},e.moveables&&e.moveables.forEach(function(e){e.state.gestos={}}),h.forEach(function(t){t.unset&&t.unset(e)})),s&&!_&&!u&&j&&e.props.preventDefault&&(null===i||void 0===i||i.preventDefault()),e.isUnmounted||_)return!1;(!s&&j&&!a||l)&&(e.props.flushSync||Uz)(function(){e.updateRect(l?o:"",!0,!1),e.forceUpdate()});return s||l||c||!j||a||WP(e,t,n,r,o+"After",i),!0}function HP(e,t){return function(n,r){var o;void 0===r&&(r=n.inputEvent.target);var i=r,a=e.areaElement,s=e._dragTarget;return!(!s||!t&&(null===(o=e.controlGesto)||void 0===o?void 0:o.isFlag()))&&(i===s||s.contains(i)||i===a||!e.isMoveableElement(i)&&!e.controlBox.contains(i)||lI(i,"moveable-area")||lI(i,"moveable-padding")||lI(i,"moveable-edgeDraggable"))}}function GP(e,t,n){var r=e.controlBox,o=[],i=e.props,a=i.dragArea,s=e.state.target,l=i.dragTarget;o.push(r),a&&!l||o.push(t),!a&&l&&s&&t!==s&&i.dragTargetSelf&&o.push(s);var c=HP(e);return YP(e,o,"targetAbles",n,{dragStart:c,pinchStart:c})}function XP(e,t){var n=e.controlBox,r=[];r.push(n);var o=HP(e,!0),i=function(e,t){return void 0===t&&(t=e.inputEvent.target),t===n||!o(e,t)};return YP(e,r,"controlAbles",t,{dragStart:i,pinchStart:i})}function YP(e,t,n,r,o){void 0===o&&(o={});var i="targetAbles"===n,a=e.props,s=a.pinchOutside,l=a.pinchThreshold,c=a.preventClickEventOnDrag,d=a.preventClickDefault,u=a.checkInput,p=a.dragFocusedInput,h=a.preventDefault,f=void 0===h||h,g=a.preventRightClick,m=void 0===g||g,v=a.preventWheelClick,y={preventDefault:f,preventRightClick:m,preventWheelClick:void 0===v||v,container:UF(a.dragContainer,!0)||mI(e.getControlBoxElement()),pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:!!i&&c,preventClickEventOnDragStart:!!i&&d,preventClickEventByCondition:i?null:function(t){return e.controlBox.contains(t.target)},checkInput:!!i&&u,dragFocusedInput:p},x=new NA(t,y),b="Control"===r;return["drag","pinch"].forEach(function(t){["Start","","End"].forEach(function(i){x.on("".concat(t).concat(i),function(a){var s,l=a.eventType,c="drag"===t&&a.isPinch;if(!o[l]||o[l](a)){if(!c){var d="drag"===t?[t]:["drag",t],u=KA([],$A(e[n]),!1);WP(e,u,d,r,i,a)?(e.props.stopPropagation||"Start"===i&&b)&&(null===(s=null===a||void 0===a?void 0:a.inputEvent)||void 0===s||s.stopPropagation()):a.stop()}}else a.stop()})})}),x}var qP=function(){function e(e,t,n){var r=this;this.target=e,this.moveable=t,this.eventName=n,this.ables=[],this._onEvent=function(e){var t=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach(function(r){r[t](n,{inputEvent:e})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return e.prototype.setAbles=function(e){this.ables=e},e.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e}();function ZP(e,t,n,r){var o;void 0===n&&(n=t);var i=eR(e,t),a=i.matrixes,s=i.is3d,l=i.targetMatrix,c=i.transformOrigin,d=i.targetOrigin,u=i.offsetContainer,p=i.hasFixed,h=i.zoom,f=function(e,t){if(rR){var n=qT(rR,function(n){return n[0][0]==e&&n[0][1]==t});if(n)return n[1]}var r=eR(e,t,!0);return rR&&rR.push([[e,t],r]),r}(u,n),g=f.matrixes,m=f.is3d,v=f.offsetContainer,y=f.zoom,x=r||m||s,b=x?4:3,w="svg"!==e.tagName.toLowerCase()&&"ownerSVGElement"in e,S=l,k=VI(b),C=VI(b),j=VI(b),_=VI(b),E=a.length,D=g.map(function(e){return ZA(ZA({},e),{matrix:e.matrix?KA([],$A(e.matrix),!1):void 0})}).reverse();a.reverse(),!s&&x&&(S=_I(S,3,4),$z(a)),!m&&x&&$z(D),D.forEach(function(e){C=DI(C,e.matrix,b)});var M=n||gI(e),T=(null===(o=D[0])||void 0===o?void 0:o.target)||Yz(M,M,!0).offsetParent,I=D.slice(1).reduce(function(e,t){return DI(e,t.matrix,b)},VI(b));a.forEach(function(e,t){if(E-2===t&&(j=k.slice()),E-1===t&&(_=k.slice()),!e.matrix){var n=function(e,t,n,r,o){var i,a=e.target,s=e.origin,l=t.matrix,c=dF(a),d=c.offsetWidth,u=c.offsetHeight,p=n.getBoundingClientRect(),h=[0,0];n===gI(n)&&(h=Zz(a,!0));for(var f=a.getBoundingClientRect(),g=f.left-p.left+n.scrollLeft-(n.clientLeft||0)+h[0],m=f.top-p.top+n.scrollTop-(n.clientTop||0)+h[1],v=f.width,y=f.height,x=EI(r,o,l),b=oF(x,d,u,r),w=b.left,S=b.top,k=b.width,C=b.height,j=tF(x,s,r),_=TI(j,[w,S]),E=[g+_[0]*v/k,m+_[1]*y/C],D=[0,0],M=0;++M<10;){var T=kI(o,r);i=$A(TI(tF(T,E,r),tF(T,j,r)),2),D[0]=i[0],D[1]=i[1];var I=oF(EI(r,o,HI(D,r),l),d,u,r),A=I.left-g,O=I.top-m;if(KF(A)<2&&KF(O)<2)break;E[0]-=A,E[1]-=O}return D.map(function(e){return Math.round(e)})}(e,a[t+1],T,b,DI(I,k,b));e.matrix=HI(n,b)}k=DI(k,e.matrix,b)});var A=!w&&s;S||(S=VI(A?4:3));var O=Jz(w&&16===S.length?_I(S,4,3):S,A),R=C;return C=SI(C,b,b),{hasZoom:1!==h||1!==y,hasFixed:p,matrixes:a,rootMatrix:C,originalRootMatrix:R,beforeMatrix:j,offsetMatrix:_,allMatrix:k,targetMatrix:S,targetTransform:O,inlineTransform:e.style.transform,transformOrigin:c,targetOrigin:d,is3d:x,offsetContainer:u,offsetRootContainer:v}}function $P(e,t,n,r){void 0===n&&(n=t);var o=0,i=0,a=0,s={},l=dF(e);if(e&&(o=l.offsetWidth,i=l.offsetHeight),e){var c=ZP(e,t,n,r),d=EO(c.allMatrix,c.transformOrigin,o,i);s=ZA(ZA({},c),d);var u=EO(c.allMatrix,[50,50],100,100);a=uF([u.pos1,u.pos2],u.direction)}var p=r?4:3;return ZA(ZA(ZA({hasZoom:!1,width:o,height:i,rotation:a},l),{originalRootMatrix:VI(p),rootMatrix:VI(p),beforeMatrix:VI(p),offsetMatrix:VI(p),allMatrix:VI(p),targetMatrix:VI(p),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),s)}function KP(e,t,n,r,o,i){void 0===i&&(i=[]);var a=1,s=[0,0],l={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},c={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},d={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},u={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},p=[0,0],h={},f=$P(t,n,o,!0);if(t){var g=iR(t);i.forEach(function(e){h[e]=g(e)});var m=f.is3d?4:3,v=EO(f.offsetMatrix,MI(f.transformOrigin,CI(f.targetMatrix,m)),f.width,f.height);a=v.direction,s=MI(v.origin,[v.left-f.left,v.top-f.top]),u=fF(f.offsetRootContainer);var y=Yz(r,r,!0).offsetParent||f.offsetRootContainer;if(f.hasZoom){var x=EO(DI(f.originalRootMatrix,f.allMatrix),f.transformOrigin,f.width,f.height),b=EO(f.originalRootMatrix,Gz(iR(y)("transformOrigin")).map(function(e){return parseFloat(e)}),y.offsetWidth,y.offsetHeight);if(l=hF(x,u),d=hF(b,u,y,!0),e){var w=x.left,S=x.top;c=hF({left:w,top:S,bottom:S,right:S},u)}}else{l=fF(t),d=function(e){var t=null===nR||void 0===nR?void 0:nR.get(e);if(t)return t;var n=fF(e,!0);return nR&&nR.set(e,n),n}(y),e&&(c=fF(e));var k=d.left,C=d.top,j=d.clientLeft,_=d.clientTop,E=[l.left-k,l.top-C];p=TI(RF(f.rootMatrix,E,4),[j+f.left,_+f.top])}}return ZA({targetClientRect:l,containerClientRect:d,moveableClientRect:c,rootContainerClientRect:u,beforeDirection:a,beforeOrigin:s,originalBeforeOrigin:s,target:t,style:h,offsetDelta:p},f)}function JP(e){var t=e.pos1,n=e.pos2,r=e.pos3,o=e.pos4;if(!t||!n||!r||!o)return null;var i=SA([t,n,r,o]),a=[i.minX,i.minY],s=TI(e.origin,a);return t=TI(t,a),n=TI(n,a),r=TI(r,a),o=TI(o,a),ZA(ZA({},e),{left:e.left,top:e.top,posDelta:a,pos1:t,pos2:n,pos3:r,pos4:o,origin:s,beforeOrigin:s,isPersisted:!0})}var QP=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=ZA({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},KP(null)),e.renderState={},e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isMoveableMounted=!1,e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e._emitter=new dA,e._prevOriginalDragTarget=null,e._originalDragTarget=null,e._prevDragTarget=null,e._dragTarget=null,e._prevPropTarget=null,e._propTarget=null,e._prevDragArea=!1,e._isPropTargetChanged=!1,e._hasFirstTarget=!1,e._reiszeObserver=null,e._observerId=0,e._mutationObserver=null,e._rootContainer=null,e._viewContainer=null,e._viewClassNames=[],e._store={},e.checkUpdateRect=function(){if(!e.isDragging()){var t=e.props.parentMoveable;t?t.checkUpdateRect():($T(e._observerId),e._observerId=ZT(function(){e.isDragging()||e.updateRect()}))}},e._onPreventClick=function(e){e.stopPropagation(),e.preventDefault()},e}return qA(n,t),n.prototype.render=function(){var t=this.props,n=this.getState(),r=t.parentPosition,o=t.className,i=t.target,a=t.zoom,s=t.cspNonce,l=t.translateZ,c=t.cssStyled,d=t.groupable,u=t.linePadding,p=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var h=$A(r||[0,0],2),f=h[0],g=h[1],m=n.left,v=n.top,y=n.target,x=n.direction,b=n.hasFixed,w=n.offsetDelta,S=t.targets,k=this.isDragging(),C={};this.getEnabledAbles().forEach(function(e){C["data-able-".concat(e.name.toLowerCase())]=!0});var j=this._getAbleClassName(),_=S&&S.length&&(y||d)||i||!this._hasFirstTarget&&this.state.isPersisted,E=this.controlBox||this.props.firstRenderState||this.props.persistData,D=[m-f,v-g];!d&&t.useAccuratePosition&&(D[0]+=w[0],D[1]+=w[1]);var M={position:b?"fixed":"absolute",display:_?"block":"none",visibility:E?"visible":"hidden",transform:"translate3d(".concat(D[0],"px, ").concat(D[1],"px, ").concat(l,")"),"--zoom":a,"--zoompx":"".concat(a,"px")};return u&&(M["--moveable-line-padding"]=u),p&&(M["--moveable-control-padding"]=p),e.createElement(c,ZA({cspNonce:s,ref:CT(this,"controlBox"),className:"".concat(Nz("control-box",-1===x?"reverse":"",k?"dragging":"")," ").concat(j," ").concat(o)},C,{onClick:this._onPreventClick,style:M}),this.renderAbles(),this._renderLines())},n.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var e=this.props,t=e.parentMoveable,n=e.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),n||t||this.state.isPersisted||(this.updateRect("",!1,!1),this.forceUpdate())},n.prototype.componentDidUpdate=function(e){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(e)},n.prototype.componentWillUnmount=function(){var e,t;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),null===(e=this._reiszeObserver)||void 0===e||e.disconnect(),null===(t=this._mutationObserver)||void 0===t||t.disconnect(),this._viewContainer&&this._changeAbleViewClassNames([]),bF(this,!1),bF(this,!0);var n=this.events;for(var r in n){var o=n[r];o&&o.destroy()}},n.prototype.getTargets=function(){var e=this.props.target;return e?[e]:[]},n.prototype.getAble=function(e){return qT(this.props.ables||[],function(t){return t.name===e})},n.prototype.getContainer=function(){var e=this.props,t=e.parentMoveable,n=e.wrapperMoveable;return e.container||n&&n.getContainer()||t&&t.getContainer()||this.controlBox.parentElement},n.prototype.getControlBoxElement=function(){return this.controlBox},n.prototype.getDragElement=function(){return this._dragTarget},n.prototype.isMoveableElement=function(e){var t;return e&&((null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"class"))||"").indexOf(pO)>-1},n.prototype.dragStart=function(e,t){void 0===t&&(t=e.target);var n=this.targetGesto,r=this.controlGesto;return n&&HP(this)({inputEvent:e},t)?n.isFlag()||n.triggerDragStart(e):r&&this.isMoveableElement(t)&&(r.isFlag()||r.triggerDragStart(e)),this},n.prototype.hitTest=function(e){var t,n=this.state,r=n.target,o=n.pos1,i=n.pos2,a=n.pos3,s=n.pos4,l=n.targetClientRect;if(!r)return 0;if(yI(e)){var c=e.getBoundingClientRect();t={left:c.left,top:c.top,width:c.width,height:c.height}}else t=ZA({width:0,height:0},e);var d=t.left,u=t.top,p=t.width,h=t.height,f=wA([o,i,s,a],l),g=MA(f,[[d,u],[d+p,u],[d+p,u+h],[d,u+h]]),m=bA(f);return g&&m?Math.min(100,g/m*100):0},n.prototype.isInside=function(e,t){var n=this.state,r=n.target,o=n.pos1,i=n.pos2,a=n.pos3,s=n.pos4,l=n.targetClientRect;return!!r&&kA([e,t],wA([o,i,s,a],l))},n.prototype.updateRect=function(e,t,n){void 0===n&&(n=!0);var r=this.props,o=!r.parentPosition&&!r.wrapperMoveable;o&&oR(!0);var i=r.parentMoveable,a=this.state.target||r.target,s=this.getContainer(),l=i?i._rootContainer:this._rootContainer,c=KP(this.controlBox,a,s,s,l||s,this._getRequestStyles());if(!a&&this._hasFirstTarget&&r.persistData){var d=JP(r.persistData);for(var u in d)c[u]=d[u]}o&&oR(),this.updateState(c,!i&&n)},n.prototype.isDragging=function(e){var t,n,r=this.targetGesto,o=this.controlGesto;return(null===r||void 0===r?void 0:r.isFlag())?!e||!!(null===(t=r.getEventData()[e])||void 0===t?void 0:t.isEventStart):!!(null===o||void 0===o?void 0:o.isFlag())&&(!e||!!(null===(n=o.getEventData()[e])||void 0===n?void 0:n.isEventStart))},n.prototype.updateTarget=function(e){this.updateRect(e,!0)},n.prototype.getRect=function(){var e=this.state,t=yF(this.state),n=$A(t,4),r=n[0],o=n[1],i=n[2],a=n[3],s=rF(t),l=e.width,c=e.height,d=s.width,u=s.height,p=s.left,h=s.top,f=[e.left,e.top],g=MI(f,e.origin);return{width:d,height:u,left:p,top:h,pos1:r,pos2:o,pos3:i,pos4:a,offsetWidth:l,offsetHeight:c,beforeOrigin:MI(f,e.beforeOrigin),origin:g,transformOrigin:e.transformOrigin,rotation:this.getRotation()}},n.prototype.getManager=function(){return this},n.prototype.stopDrag=function(e){var t;e&&"target"!==e||(!1===(null===(t=this.targetGesto)||void 0===t?void 0:t.isIdle())&&xF(this,!1),null===t||void 0===t||t.stop());e&&"control"!==e||(!1===(null===(t=this.controlGesto)||void 0===t?void 0:t.isIdle())&&xF(this,!0),null===t||void 0===t||t.stop())},n.prototype.getRotation=function(){var e=this.state;return function(e,t,n){var r=rI(e,t)/Math.PI*180;return(r=n>=0?r:180-r)>=0?r:360+r}(e.pos1,e.pos2,e.direction)},n.prototype.request=function(e,t,n){void 0===t&&(t={});var r=this,o=r.props,i=o.parentMoveable||o.wrapperMoveable||r,a=i.props.ables,s=o.groupable,l=qT(a,function(t){return t.name===e});if(this.isDragging()||!l||!l.request)return{request:function(){return this},requestEnd:function(){return this}};var c=l.request(r),d=n||t.isInstant,u=c.isControl?"controlAbles":"targetAbles",p="".concat(s?"Group":"").concat(c.isControl?"Control":""),h=KA([],$A(i[u]),!1),f={request:function(t){return WP(r,h,["drag"],p,"",ZA(ZA({},c.request(t)),{requestAble:e,isRequest:!0}),d),f},requestEnd:function(){return WP(r,h,["drag"],p,"End",ZA(ZA({},c.requestEnd()),{requestAble:e,isRequest:!0}),d),f}};return WP(r,h,["drag"],p,"Start",ZA(ZA({},c.requestStart(t)),{requestAble:e,isRequest:!0}),d),d?f.request(t).requestEnd():f},n.prototype.getMoveables=function(){return[this]},n.prototype.destroy=function(){this.componentWillUnmount()},n.prototype.updateRenderPoses=function(){var e=this.getState(),t=this.props,n=t.padding,r=e.originalBeforeOrigin,o=e.transformOrigin,i=e.allMatrix,a=e.is3d,s=e.pos1,l=e.pos2,c=e.pos3,d=e.pos4,u=e.left,p=e.top,h=e.isPersisted,f=t.zoom||1;if(!n&&f<=1)return e.renderPoses=[s,l,c,d],void(e.renderLines=[[s,l],[l,d],[d,c],[c,s]]);var g=QF(n||{}),m=g.left,v=g.top,y=g.bottom,x=g.right,b=a?4:3,w=EI(b,HI((h?o:this.controlBox&&t.groupable?r:MI(r,[u,p])).map(function(e){return-e}),b),i,HI(o,b)),S=FF(w,s,[-m,-v],b),k=FF(w,l,[x,-v],b),C=FF(w,c,[-m,y],b),j=FF(w,d,[x,y],b);if(e.renderPoses=[S,k,C,j],e.renderLines=[[S,k],[k,j],[j,C],[C,S]],f){var _=f/2;e.renderLines=[[FF(w,s,[-m-_,-v],b),FF(w,l,[x+_,-v],b)],[FF(w,l,[x,-v-_],b),FF(w,d,[x,y+_],b)],[FF(w,d,[x+_,y],b),FF(w,c,[-m-_,y],b)],[FF(w,c,[-m,y+_],b),FF(w,s,[-m,-v-_],b)]]}},n.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var e=this.props,t=e.target,n=e.container,r=e.parentMoveable,o=this.state,i=o.target,a=o.container;if(i||t){this.updateAbles();var s=!MF(i,t);if(s||!MF(a,n)){var l=n||this.controlBox;l&&this.unsetAbles(),this.updateState({target:t,container:n}),!r&&l&&this.updateRect("End",!1,!1),this._isPropTargetChanged=s}}},n.prototype.waitToChangeTarget=function(){return new Promise(function(){})},n.prototype.triggerEvent=function(e,t){var n=this.props;if(this._emitter.trigger(e,t),n.parentMoveable&&t.isRequest&&!t.isRequestChild)return n.parentMoveable.triggerEvent(e,t,!0);var r=n[e];return r&&r(t)},n.prototype.useCSS=function(e,t){var n=this.props.customStyledMap,r=e+t;return n[r]||(n[r]=XA(e,t)),n[r]},n.prototype.getState=function(){var e,t=this.props;(t.target||(null===(e=t.targets)||void 0===e?void 0:e.length))&&(this._hasFirstTarget=!0);var n=this.controlBox,r=t.persistData,o=t.firstRenderState;if(o&&!n)return o;if(!this._hasFirstTarget&&r){var i=JP(r);if(i)return this.updateState(i,!1),this.state}return this.state.isPersisted=!1,this.state},n.prototype.updateSelectors=function(){},n.prototype.unsetAbles=function(){var e=this;this.targetAbles.forEach(function(t){t.unset&&t.unset(e)})},n.prototype.updateAbles=function(e,t){void 0===e&&(e=this.props.ables),void 0===t&&(t="");var n=this.props.triggerAblesSimultaneously,r=this.getEnabledAbles(e),o="drag".concat(t,"Start"),i="pinch".concat(t,"Start"),a="drag".concat(t,"ControlStart"),s=DF(r,[o,i],n),l=DF(r,[a],n);this.enabledAbles=r,this.targetAbles=s,this.controlAbles=l},n.prototype.updateState=function(e,t){if(t){if(this.isUnmounted)return;this.setState(e)}else{var n=this.state;for(var r in e)n[r]=e[r]}},n.prototype.getEnabledAbles=function(e){void 0===e&&(e=this.props.ables);var t=this.props;return e.filter(function(e){return e&&(e.always&&!1!==t[e.name]||t[e.name])})},n.prototype.renderAbles=function(){var t=this,n=this.props.triggerAblesSimultaneously,r={createElement:e.createElement};return this.renderState={},function(e,t){var n=[],r={};return e.forEach(function(o,i){var a=t(o,i,e),s=r[a];s||(s=[],r[a]=s,n.push(s)),s.push(o)}),n}(AF(DF(this.getEnabledAbles(),["render"],n).map(function(e){return(0,e.render)(t,r)||[]})).filter(function(e){return e}),function(e){return e.key}).map(function(e){return e[0]})},n.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},n.prototype._getRequestStyles=function(){return this.getEnabledAbles().reduce(function(e,t){var n,r,o=null!==(r=null===(n=t.requestStyle)||void 0===n?void 0:n.call(t))&&void 0!==r?r:[];return KA(KA([],$A(e),!1),$A(o),!1)},KA([],$A(this.props.requestStyles||[]),!1))},n.prototype._updateObserver=function(e){this._updateResizeObserver(e),this._updateMutationObserver(e)},n.prototype._updateEvents=function(){var e=this.targetAbles.length,t=this.controlAbles.length,n=this._dragTarget;(!e&&this.targetGesto||this._isTargetChanged(!0))&&(bF(this,!1),this.updateState({gestos:{}})),t||bF(this,!0),n&&e&&!this.targetGesto&&(this.targetGesto=GP(this,n,"")),!this.controlGesto&&t&&(this.controlGesto=XP(this,"Control"))},n.prototype._updateTargets=function(){var e=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=e.dragArea,this._propTarget=e.target,this._originalDragTarget=e.dragTarget||e.target,this._dragTarget=UF(this._originalDragTarget,!0)},n.prototype._renderLines=function(){var t=this.props,n=t.zoom,r=t.hideDefaultLines,o=t.hideChildMoveableDefaultLines,i=t.parentMoveable;if(r||i&&o)return[];var a=this.getState(),s={createElement:e.createElement};return a.renderLines.map(function(e,t){return pR(s,"",e[0],e[1],n,"render-line-".concat(t))})},n.prototype._isTargetChanged=function(e){var t=this.props,n=t.dragTarget||t.target,r=this._prevOriginalDragTarget,o=this._prevDragArea,i=t.dragArea;return!i&&r!==n||(e||i)&&o!==i||this._prevPropTarget!=this._propTarget},n.prototype._updateNativeEvents=function(){var e=this,t=this.props.dragArea?this.areaElement:this.state.target,n=this.events,r=KT(n);if(this._isTargetChanged())for(var o in n){var i=n[o];i&&i.destroy(),n[o]=null}if(t){var a=this.enabledAbles;r.forEach(function(r){var o=DF(a,[r]),i=o.length>0,s=n[r];i?(s||(s=new qP(t,e,r),n[r]=s),s.setAbles(o)):s&&(s.destroy(),n[r]=null)})}},n.prototype._checkUpdateRootContainer=function(){var e=this.props.rootContainer;!this._rootContainer&&e&&(this._rootContainer=UF(e,!0))},n.prototype._checkUpdateViewContainer=function(){var e=this.props.viewContainer;!this._viewContainer&&e&&(this._viewContainer=UF(e,!0)),this._viewContainer&&this._changeAbleViewClassNames(KA(KA([],$A(this._getAbleViewClassNames()),!1),[this.isDragging()?cP:""],!1))},n.prototype._changeAbleViewClassNames=function(e){var t=this._viewContainer,n=IF(e.filter(Boolean),function(e){return e}).map(function(e){return $A(e,1)[0]}),r=this._viewClassNames,o=tA(r,n),i=o.removed,a=o.added;i.forEach(function(e){dI(t,r[e])}),a.forEach(function(e){cI(t,n[e])}),this._viewClassNames=n},n.prototype._getAbleViewClassNames=function(){var e=this;return(this.getEnabledAbles().map(function(t){var n;return(null===(n=t.viewClassName)||void 0===n?void 0:n.call(t,e))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},n.prototype._getAbleClassName=function(e){var t=this;void 0===e&&(e="");var n=this.getEnabledAbles(),r=this.targetGesto,o=this.controlGesto,i=(null===r||void 0===r?void 0:r.isFlag())?r.getEventData():{},a=(null===o||void 0===o?void 0:o.isFlag())?o.getEventData():{};return n.map(function(n){var r,o,s,l=n.name,c=(null===(r=n.className)||void 0===r?void 0:r.call(n,t))||"";return((null===(o=i[l])||void 0===o?void 0:o.isEventStart)||(null===(s=a[l])||void 0===s?void 0:s.isEventStart))&&(c+=" ".concat(Nz("".concat(l).concat(e,"-dragging")))),c.trim()}).filter(Boolean).join(" ")},n.prototype._updateResizeObserver=function(e){var t,n=this.props,r=n.target,o=mI(this.getControlBoxElement());if(o.ResizeObserver&&r&&n.useResizeObserver){if(e.target!==r||!this._reiszeObserver){var i=new o.ResizeObserver(this.checkUpdateRect);i.observe(r,{box:"border-box"}),this._reiszeObserver=i}}else null===(t=this._reiszeObserver)||void 0===t||t.disconnect()},n.prototype._updateMutationObserver=function(e){var t,n=this,r=this.props,o=r.target,i=mI(this.getControlBoxElement());if(i.MutationObserver&&o&&r.useMutationObserver){if(e.target!==o||!this._mutationObserver){var a=new i.MutationObserver(function(e){var t,r;try{for(var o=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next()){var a=i.value;"attributes"===a.type&&"style"===a.attributeName&&n.checkUpdateRect()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}});a.observe(o,{attributes:!0}),this._mutationObserver=a}}else null===(t=this._mutationObserver)||void 0===t||t.disconnect()},n.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Uz,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},n}(e.PureComponent),eB={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(e,t){var n,r=e.props,o=r.targets||[],i=e.getState(),a=i.left,s=i.top,l=i.isPersisted,c=r.zoom||1,d=e.renderGroupRects,u=(null===(n=r.persistData)||void 0===n?void 0:n.children)||[];l?o=u.map(function(){return null}):u=[];var p=ZF(e,"parentPosition",[a,s],function(e){return e.join(",")}),h=ZF(e,"requestStyles",e.getRequestChildStyles(),function(e){return e.join(",")});return e.moveables=e.moveables.slice(0,o.length),KA(KA([],$A(o.map(function(n,o){return t.createElement(QP,{key:"moveable"+o,ref:jT(e,"moveables",o),target:n,origin:!1,requestStyles:h,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:e,parentPosition:[a,s],persistData:u[o],zoom:c})})),!1),$A(AF(d.map(function(e,n){var r=[e.pos1,e.pos2,e.pos3,e.pos4];return[[0,1],[1,3],[3,2],[2,0]].map(function(e,o){var i=$A(e,2),a=i[0],s=i[1];return pR(t,"",TI(r[a],p),TI(r[s],p),c,"group-rect-".concat(n,"-").concat(o))})}))),!1)}},tB=JA("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,t){t.datas.inputTarget=t.inputEvent&&t.inputEvent.target},dragEnd:function(e,t){var n=e.props.target,r=t.inputEvent,o=t.inputTarget,i=!e.isMoveableElement(o)&&e.controlBox.contains(o);if(r&&o&&!t.isDrag&&!e.isMoveableElement(o)&&!i){var a=n.contains(o);_F(e,"onClick",kF(e,t,{isDouble:t.isDouble,inputTarget:o,isTarget:n===o,moveableTarget:e.props.target,containsTarget:a}))}},dragGroupEnd:function(e,t){var n=t.inputEvent,r=t.inputTarget;if(n&&r&&!t.isDrag&&!e.isMoveableElement(r)&&t.datas.inputTarget!==r){var o=e.props.targets,i=o.indexOf(r),a=i>-1,s=!1;-1===i&&(s=(i=YT(o,function(e){return e.contains(r)}))>-1),_F(e,"onClickGroup",kF(e,t,{isDouble:t.isDouble,targets:o,inputTarget:r,targetIndex:i,isTarget:a,containsTarget:s,moveableTarget:o[i]}))}},dragControlEnd:function(e,t){this.dragEnd(e,t)},dragGroupControlEnd:function(e,t){this.dragEnd(e,t)}});function nB(e){var t=e.originalDatas.draggable;return t||(e.originalDatas.draggable={},t=e.originalDatas.draggable),ZA(ZA({},e),{datas:t})}var rB=JA("edgeDraggable",{css:[".edge.edgeDraggable.line {\ncursor: move;\n}"],render:function(e,t){var n=e.props,r=n.edgeDraggable;return r?hR(t,"edgeDraggable",r,e.getState().renderPoses,n.zoom):[]},dragCondition:function(e,t){var n,r=e.props,o=null===(n=t.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!o)&&(!r.draggable&&lI(o,Nz("direction"))&&lI(o,Nz("edge"))&&lI(o,Nz("edgeDraggable")))},dragStart:function(e,t){return az.dragStart(e,nB(t))},drag:function(e,t){return az.drag(e,nB(t))},dragEnd:function(e,t){return az.dragEnd(e,nB(t))},dragGroupCondition:function(e,t){var n,r=e.props,o=null===(n=t.inputEvent)||void 0===n?void 0:n.target;return!(!r.edgeDraggable||!o)&&(!r.draggable&&lI(o,Nz("direction"))&&lI(o,Nz("line")))},dragGroupStart:function(e,t){return az.dragGroupStart(e,nB(t))},dragGroup:function(e,t){return az.dragGroup(e,nB(t))},dragGroupEnd:function(e,t){return az.dragGroupEnd(e,nB(t))},unset:function(e){return az.unset(e)}}),oB={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},iB=[UP,mP,Lz,eP,az,rB,dz,nP,iP,vz,gP,vP,hP,FP,zP,NP,eB,oB,tB,pP,VP];function aB(e,t){var n=$A(e,3),r=n[0],o=n[1],i=n[2];return(r*t[0]+o*t[1]+i)/Math.sqrt(r*r+o*o)}function sB(e,t){var n=$A(e,2),r=n[0],o=n[1];return-r*t[0]-o*t[1]}function lB(e,t){return Math.max.apply(Math,KA([],$A(e.map(function(e){var n=$A(e,4),r=n[0],o=n[1],i=n[2],a=n[3];return Math.max(r[t],o[t],i[t],a[t])})),!1))}function cB(e,t){return Math.min.apply(Math,KA([],$A(e.map(function(e){var n=$A(e,4),r=n[0],o=n[1],i=n[2],a=n[3];return Math.min(r[t],o[t],i[t],a[t])})),!1))}function dB(e,t){var n=t.map(function(t){if(zT(t)){var n=dB(e,t),r=n.length;return r>1?n:1===r?n[0]:null}var o=qT(e,function(e){return e.manager.props.target===t});return o?(o.finded=!0,o.manager):null}).filter(Boolean);return 1===n.length&&zT(n[0])?n[0]:n}var uB=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.differ=new sA,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return qA(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this)},t.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},t.prototype.getTargets=function(){return this.props.targets},t.prototype.updateRect=function(e,t,n){var r;void 0===n&&(n=!0);var o=this.state;if(this.controlBox&&!o.isPersisted){oR(!0),this.moveables.forEach(function(t){t.updateRect(e,!1,!1)});var i=this.props,a=this.moveables,s=o.target||i.target,l=a.map(function(e){return{finded:!1,manager:e}}),c=this.props.targetGroups||[],d=dB(l,c),u=i.useDefaultGroupRotate;d.push.apply(d,KA([],$A(l.filter(function(e){return!e.finded}).map(function(e){return e.manager})),!1));var p=[],h=!t||""!==e&&i.updateGroup,f=i.defaultGroupRotate||0;if(!this._hasFirstTargets){var g=null===(r=i.persistData)||void 0===r?void 0:r.rotation;null!=g&&(f=g)}var m=function e(t,n,r){var o=t.map(function(t){if(zT(t)){var r=e(t,n),o=[r.pos1,r.pos2,r.pos3,r.pos4];return p.push(r),{poses:o,rotation:r.rotation}}return{poses:yF(t.state),rotation:t.getRotation()}}),i=o.map(function(e){return e.rotation}),a=0,s=i[0],l=i.every(function(e){return Math.abs(s-e)<.1});a=h?!u&&l?s:f:u||r||!l?n:s;var c=o.map(function(e){return e.poses}),d=function(e,t){var n,r,o,i=[0,0],a=[0,0],s=[0,0],l=[0,0],c=0,d=0;if(!e.length)return{pos1:i,pos2:a,pos3:s,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:d,rotation:t};var u=aI(t,vO);if(u%90){var p=u/180*Math.PI,h=Math.tan(p),f=-1/h,g=[xO,bO],m=[[0,0],[0,0]],v=[xO,bO],y=[[0,0],[0,0]];e.forEach(function(e){e.forEach(function(e){var t=aB([-h,1,0],e),n=aB([-f,1,0],e);g[0]>t&&(m[0]=e,g[0]=t),g[1]<t&&(m[1]=e,g[1]=t),v[0]>n&&(y[0]=e,v[0]=n),v[1]<n&&(y[1]=e,v[1]=n)})});var x=$A(m,2),b=x[0],w=x[1],S=$A(y,2),k=S[0],C=S[1],j=[-h,1,sB([-h,1],b)],_=[-h,1,sB([-h,1],w)],E=[-f,1,sB([-f,1],k)],D=[-f,1,sB([-f,1],C)];n=$A([[j,E],[j,D],[_,E],[_,D]].map(function(e){var t=$A(e,2);return jA(t[0],t[1])[0]}),4),i=n[0],a=n[1],s=n[2],l=n[3],c=v[1]-v[0],d=g[1]-g[0]}else{var M=cB(e,0),T=cB(e,1),I=lB(e,0),A=lB(e,1);i=[M,T],a=[I,T],s=[M,A],l=[I,A],c=I-M,d=A-T,u%180&&(i=(r=$A([s,i,l,a],4))[0],a=r[1],s=r[2],l=r[3],c=A-T,d=I-M)}u%360>180&&(i=(o=$A([l,s,a,i],4))[0],a=o[1],s=o[2],l=o[3]);var O=SA([i,a,s,l]);return{pos1:i,pos2:a,pos3:s,pos4:l,width:c,height:d,minX:O.minX,minY:O.minY,maxX:O.maxX,maxY:O.maxY,rotation:t}}(c,a);return d}(d,this.rotation,!0);h&&(this.rotation=m.rotation,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=c,this.renderGroupRects=p;var v=this.transformOrigin,y=this.rotation,x=this.scale,b=m.width,w=m.height,S=m.minX,k=m.minY,C=function(e,t,n){var r=e.map(function(e){return TI(e,t)}),o=r.map(function(e){return BI(e,n)});return{prev:r,next:o,result:o.map(function(e){return MI(e,t)})}}([[0,0],[b,0],[0,w],[b,w]],YF(v,b,w),this.rotation/180*Math.PI),j=SA(C.result),_=j.minX,E=j.minY,D=" rotate(".concat(y,"deg)")+" scale(".concat($F(x[0]),", ").concat($F(x[1]),")"),M="translate(".concat(-_,"px, ").concat(-E,"px)").concat(D);this.controlBox.style.transform="translate3d(".concat(S,"px, ").concat(k,"px, ").concat(this.props.translateZ||0,")"),s.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(v,";")+"width:".concat(b,"px;height:").concat(w,"px;")+"transform: ".concat(M),o.width=b,o.height=w;var T=this.getContainer(),I=KP(this.controlBox,s,this.controlBox,this.getContainer(),this._rootContainer||T,[]),A=[I.left,I.top],O=$A(yF(I),4),R=O[0],z=O[1],F=O[2],P=O[3],B=SA([R,z,F,P]),L=[B.minX,B.minY],N=$F(x[0]*x[1]);I.pos1=TI(R,L),I.pos2=TI(z,L),I.pos3=TI(F,L),I.pos4=TI(P,L),I.left=S-I.left+L[0],I.top=k-I.top+L[1],I.origin=TI(MI(A,I.origin),L),I.beforeOrigin=TI(MI(A,I.beforeOrigin),L),I.originalBeforeOrigin=MI(A,I.originalBeforeOrigin),I.transformOrigin=TI(MI(A,I.transformOrigin),L),s.style.transform="translate(".concat(-_-L[0],"px, ").concat(-E-L[1],"px)")+D,oR(),this.updateState(ZA(ZA({},I),{posDelta:L,direction:N,beforeDirection:N}),n)}},t.prototype.getRect=function(){return ZA(ZA({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},t.prototype.triggerEvent=function(t,n,r){if(r||t.indexOf("Group")>-1)return e.prototype.triggerEvent.call(this,t,n);this._emitter.trigger(t,n)},t.prototype.getRequestChildStyles=function(){return this.getEnabledAbles().reduce(function(e,t){var n,r,o=null!==(r=null===(n=t.requestChildStyle)||void 0===n?void 0:n.call(t))&&void 0!==r?r:[];return KA(KA([],$A(e),!1),$A(o),!1)},[])},t.prototype.getMoveables=function(){return KA([],$A(this.moveables),!1)},t.prototype.updateAbles=function(){e.prototype.updateAbles.call(this,KA(KA([],$A(this.props.ables),!1),[eB],!1),"Group")},t.prototype._updateTargets=function(){e.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=UF(this._originalDragTarget,!0)},t.prototype._updateEvents=function(){var e=this.state,t=this.props,n=this._prevDragTarget,r=t.dragTarget||this.areaElement,o=t.targets,i=this.differ.update(o),a=i.added,s=i.changed,l=i.removed,c=a.length||l.length;(c||this._prevOriginalDragTarget!==this._originalDragTarget)&&(bF(this,!1),bF(this,!0),this.updateState({gestos:{}})),n!==r&&(e.target=null),e.target||(e.target=this.areaElement,this.controlBox.style.display="block"),e.target&&(this.targetGesto||(this.targetGesto=GP(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=XP(this,"GroupControl")));var d=!MF(e.container,t.container);d&&(e.container=t.container),(d||c||this.transformOrigin!==(t.defaultGroupOrigin||"50% 50%")||s.length||o.length&&!qF(this._targetGroups,t.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!c},t.prototype._updateObserver=function(){},t.defaultProps=ZA(ZA({},QP.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),t}(QP),pB=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}return qA(n,t),n.prototype.render=function(){var t,n=this,r=this.props,o=r.cspNonce,i=r.cssStyled,a=r.persistData,s=r.targets||[],l=s.length,c=this.isUnmounted||!l,d=null!==(t=null===a||void 0===a?void 0:a.children)&&void 0!==t?t:[];return c&&!l&&d.length?s=d.map(function(){return null}):c||(d=[]),e.createElement(i,{cspNonce:o,ref:CT(this,"controlBox"),className:Nz("control-box")},s.map(function(t,o){var i,a,s=null!==(a=null===(i=r.individualGroupableProps)||void 0===i?void 0:i.call(r,t,o))&&void 0!==a?a:{};return e.createElement(QP,ZA({key:"moveable"+o,ref:jT(n,"moveables",o)},r,s,{target:t,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:d[o]}))}))},n.prototype.componentDidMount=function(){},n.prototype.componentDidUpdate=function(){},n.prototype.getTargets=function(){return this.props.targets},n.prototype.updateRect=function(e,t,n){void 0===n&&(n=!0),oR(!0),this.moveables.forEach(function(r){r.updateRect(e,t,n)}),oR()},n.prototype.getRect=function(){return ZA(ZA({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},n.prototype.request=function(e,t,n){void 0===t&&(t={});var r=this.moveables.map(function(n){return n.request(e,ZA(ZA({},t),{isInstant:!1}),!1)}),o={request:function(e){return r.forEach(function(t){return t.request(e)}),this},requestEnd:function(){return r.forEach(function(e){return e.requestEnd()}),this}};return n||t.isInstant?o.request(t).requestEnd():o},n.prototype.dragStart=function(e,t){void 0===t&&(t=e.target);var n=t,r=qT(this.moveables,function(e){var t=e.getTargets()[0],r=e.getControlBoxElement(),o=e.getDragElement();return!(!t||!o)&&(o===n||o.contains(n)||o!==t&&t===n||t.contains(n)||r===n||r.contains(n))});return r&&r.dragStart(e,t),this},n.prototype.hitTest=function(){return 0},n.prototype.isInside=function(){return!1},n.prototype.isDragging=function(){return!1},n.prototype.getDragElement=function(){return null},n.prototype.getMoveables=function(){return KA([],$A(this.moveables),!1)},n.prototype.updateRenderPoses=function(){},n.prototype.checkUpdate=function(){},n.prototype.triggerEvent=function(){},n.prototype.updateAbles=function(){},n.prototype._updateEvents=function(){},n.prototype._updateObserver=function(){},n}(QP);function hB(e,t){var n=[];return e.forEach(function(e){e&&(FT(e)?t[e]&&n.push.apply(n,KA([],$A(t[e]),!1)):zT(e)?n.push.apply(n,KA([],$A(hB(e,t)),!1)):n.push(e))}),n}function fB(e,t){var n=[];return e.forEach(function(e){e&&(FT(e)?t[e]&&n.push.apply(n,KA([],$A(t[e]),!1)):zT(e)?n.push(fB(e,t)):n.push(e))}),n}function gB(e,t){return e.length!==t.length||e.some(function(e,n){var r=t[n];return!(!e&&!r)&&(e!=r&&(!zT(e)||!zT(r)||gB(e,r)))})}var mB=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e._differ=new sA,e._elementTargets=[],e._tmpRefTargets=[],e._tmpSelectorMap={},e._onChangeTargets=null,e}var r,o;return qA(n,t),n.makeStyled=function(){var e={};this.getTotalAbles().forEach(function(t){var n=t.css;n&&n.forEach(function(t){e[t]=!0})});var t=KT(e).join("\n");this.defaultStyled=XA("div",function(e,t){return t.replace(/([^}{]*){/gm,function(t,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+e+"$1")+"{"})}(pO,fO+t))},n.getTotalAbles=function(){return KA([mP,eB,oB,pP],$A(this.defaultAbles),!1)},n.prototype.render=function(){var t,n=this.constructor;n.defaultStyled||n.makeStyled();var r=this.props,o=r.ables,i=r.props,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(r,["ables","props"]),s=$A(this._updateRefs(!0),2),l=s[0],c=s[1],d=hB(l,c),u=d.length>1,p=KA(KA([],$A(n.getTotalAbles()),!1),$A(o||[]),!1),h=ZA(ZA(ZA({},a),i||{}),{ables:p,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=d;var f=null,g=this.moveable,m=a.persistData;if((null===m||void 0===m?void 0:m.children)&&(u=!0),a.individualGroupable)return e.createElement(pB,ZA({key:"individual-group",ref:CT(this,"moveable")},h,{target:null,targets:d}));if(u){var v=fB(l,c);if(g&&!g.props.groupable&&!g.props.individualGroupable){var y=g.props.target;y&&d.indexOf(y)>-1&&(f=ZA({},g.state))}return e.createElement(uB,ZA({key:"group",ref:CT(this,"moveable")},h,null!==(t=a.groupableProps)&&void 0!==t?t:{},{target:null,targets:d,targetGroups:v,firstRenderState:f}))}var x=d[0];if(g&&(g.props.groupable||g.props.individualGroupable)){var b=qT(g.moveables||[],function(e){return e.props.target===x});b&&(f=ZA({},b.state))}return e.createElement(QP,ZA({key:"single",ref:CT(this,"moveable")},h,{target:x,firstRenderState:f}))},n.prototype.componentDidMount=function(){this._checkChangeTargets()},n.prototype.componentDidUpdate=function(){this._checkChangeTargets()},n.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},n.prototype.getTargets=function(){var e,t;return null!==(t=null===(e=this.moveable)||void 0===e?void 0:e.getTargets())&&void 0!==t?t:[]},n.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},n.prototype.waitToChangeTarget=function(){var e,t=this;return this._onChangeTargets=function(){t._onChangeTargets=null,e()},new Promise(function(t){e=t})},n.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},n.prototype.getManager=function(){return this.moveable},n.prototype.getMoveables=function(){return this.moveable.getMoveables()},n.prototype.getDragElement=function(){return this.moveable.getDragElement()},n.prototype._updateRefs=function(e){var t=this.refTargets,n=VF(this.props.target||this.props.targets),r="undefined"!==typeof document,o=gB(t,n),i=this.selectorMap,a={};return this.refTargets.forEach(function e(t){FT(t)?i[t]?a[t]=i[t]:r&&(o=!0,a[t]=[].slice.call(document.querySelectorAll(t))):zT(t)&&t.forEach(e)}),this._tmpRefTargets=n,this._tmpSelectorMap=a,[n,a,!e&&o]},n.prototype._checkChangeTargets=function(){var e,t,n;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var r=this._differ.update(this._elementTargets),o=r.added,i=r.removed;(o.length||i.length)&&(null===(t=(e=this.props).onChangeTargets)||void 0===t||t.call(e,{moveable:this.moveable,targets:this._elementTargets}),null===(n=this._onChangeTargets)||void 0===n||n.call(this));var a=$A(this._updateRefs(),3),s=a[0],l=a[1],c=a[2];this.refTargets=s,this.selectorMap=l,c&&this.forceUpdate()},n.defaultAbles=[],n.customStyledMap={},n.defaultStyled=null,function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);i>3&&a&&Object.defineProperty(t,n,a)}([(r=CO,void 0===o&&(o={}),function(e,t){r.forEach(function(n){var r=o[n]||n;r in e||(e[r]=function(){for(var e,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=(e=this[t])[n].apply(e,r);return i===this[t]?this:i})})})],n.prototype,"moveable",void 0),n}(e.PureComponent),vB=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qA(t,e),t.defaultAbles=iB,t}(mB);const yB=e=>Math.hypot(e[0].clientX-e[1].clientX,e[0].clientY-e[1].clientY),xB=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),bB=(e,t)=>{let n;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)?(n=e.substring(1).split(""),3===n.length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),n="0x"+n.join(""),"rgba("+[n>>16&255,n>>8&255,255&n].join(",")+","+t+")"):e},wB=(e,t,n)=>Math.min(Math.max(e,t),n),SB=(e,t,n)=>e+(t-e)*n,kB=e=>{let t=e.substring(1);3===t.length&&(t=t.split("").map(e=>e+e).join(""));const n=parseInt(t.substring(0,2),16)/255,r=parseInt(t.substring(2,4),16)/255,o=parseInt(t.substring(4,6),16)/255,i=Math.max(n,r,o),a=Math.min(n,r,o);let s,l,c=i;const d=i-a;if(l=0===i?0:d/i,i===a)s=0;else{switch(i){case n:s=(r-o)/d+(r<o?6:0);break;case r:s=(o-n)/d+2;break;case o:s=(n-r)/d+4}s/=6}return{h:Math.round(360*s),s:Math.round(100*l),v:Math.round(100*c)}},CB=e=>{let{h:t,s:n,v:r}=e;n/=100,r/=100;const o=r*n,i=o*(1-Math.abs(t/60%2-1)),a=r-o;let s=0,l=0,c=0;0<=t&&t<60?(s=o,l=i,c=0):60<=t&&t<120?(s=i,l=o,c=0):120<=t&&t<180?(s=0,l=o,c=i):180<=t&&t<240?(s=0,l=i,c=o):240<=t&&t<300?(s=i,l=0,c=o):300<=t&&t<360&&(s=o,l=0,c=i);const d=e=>{const t=Math.round(255*(e+a)).toString(16);return 1===t.length?"0"+t:t};return"#".concat(d(s)).concat(d(l)).concat(d(c))},jB=e=>{let{isOpen:t,onClose:n,settings:r,onUpdateSettings:o,onToggleFullscreen:i}=e;if(!t)return null;const a={display:"flex",justifyContent:"space-between",alignItems:"center"},s={fontSize:14,color:"#ccc"},l={fontSize:14,width:40,textAlign:"right",fontWeight:"bold"},d={flex:1,margin:"0 15px",cursor:"pointer"};return(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.85)",zIndex:10001,display:"flex",justifyContent:"center",alignItems:"center",color:"#fff",userSelect:"none"},onClick:n,children:(0,c.jsxs)("div",{style:{background:"#222",padding:25,borderRadius:8,width:"90%",maxWidth:400,border:"1px solid #444",display:"flex",flexDirection:"column",gap:20},onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{style:{textAlign:"center",margin:0,borderBottom:"1px solid #444",paddingBottom:10},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,c.jsxs)("div",{style:a,children:[(0,c.jsx)("span",{style:s,children:"\u041c\u0443\u0437\u044b\u043a\u0430"}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",value:r.musicVolume,onChange:e=>o("musicVolume",parseFloat(e.target.value)),style:d}),(0,c.jsxs)("span",{style:l,children:[Math.round(100*r.musicVolume),"%"]})]}),(0,c.jsxs)("div",{style:a,children:[(0,c.jsx)("span",{style:s,children:"\u0417\u0432\u0443\u043a\u0438"}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",value:r.sfxVolume,onChange:e=>o("sfxVolume",parseFloat(e.target.value)),style:d}),(0,c.jsxs)("span",{style:l,children:[Math.round(100*r.sfxVolume),"%"]})]}),(0,c.jsxs)("div",{style:a,children:[(0,c.jsx)("span",{style:s,children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0442\u0435\u043a\u0441\u0442\u0430"}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:r.textSpeed,onChange:e=>o("textSpeed",parseFloat(e.target.value)),style:d}),(0,c.jsxs)("span",{style:l,children:["x",r.textSpeed]})]}),(0,c.jsxs)("div",{style:a,children:[(0,c.jsx)("span",{style:s,children:"\u041f\u0430\u0440\u0430\u043b\u043b\u0430\u043a\u0441"}),(0,c.jsxs)("label",{style:{cursor:"pointer",display:"flex",alignItems:"center"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!r.isParallaxOff,onChange:e=>o("isParallaxOff",!e.target.checked)}),(0,c.jsx)("span",{style:{marginLeft:8,fontSize:14},children:r.isParallaxOff?"\u0412\u044b\u043a\u043b":"\u0412\u043a\u043b"})]})]}),(0,c.jsx)("hr",{style:{width:"100%",border:0,borderTop:"1px solid #444",margin:0}}),(0,c.jsx)("button",{onClick:i,style:{padding:12,background:"#007bff",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:r.isFullscreen?"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u043f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u043e\u0433\u043e":"\u041d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d"}),(0,c.jsx)("button",{onClick:n,style:{marginTop:10,padding:10,background:"transparent",color:"#888",border:"1px solid #444",borderRadius:4,cursor:"pointer"},children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})})},_B=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v;let{settings:y,onSaveClick:x,onLoadClick:b,onRestartClick:w,onSettingsClick:S,onMenuToggle:k,isOpen:C,setIsOpen:j,screenW:_,screenH:E}=t;const D=y||{},M=null!==(n=D.menu_x)&&void 0!==n?n:20,T=null!==(r=D.menu_y)&&void 0!==r?r:20,I=D.menu_open_dir||"left",A=D.menu_btn_w||D.menu_btn_size||50,O=D.menu_btn_h||D.menu_btn_size||50,R=D.menu_extra_w||0,z=D.menu_extra_h||0,F=A+R,P=O+z,B=null!==(o=D.menu_gap)&&void 0!==o?o:5,L=null!==(i=D.menu_internal_gap)&&void 0!==i?i:5,N=4*F+3*L,U=4*P+3*L,V=(0,e.useMemo)(()=>{if(!_||!E)return I;const e=Number(_),t=Number(E);let n=I;const r=M-B,o=e-(M+A+B),i=T-B,a=t-(T+O+B);return"right"===I?N>o&&r>o&&(n="left"):"left"===I?N>r&&o>r&&(n="right"):"down"===I?U>a&&i>a&&(n="up"):"up"===I&&U>i&&a>i&&(n="down"),n},[I,M,T,A,O,B,N,U,_,E]),W=null!==(a=D.menu_radius_main)&&void 0!==a?a:null!==(l=D.menu_radius)&&void 0!==l?l:0,H=null!==(d=D.menu_radius_sub)&&void 0!==d?d:null!==(u=D.menu_radius)&&void 0!==u?u:0,G=D.menu_font_size||14,X=D.menu_main_color||"#333333",Y=null!==(p=D.menu_opacity_main)&&void 0!==p?p:null!==(h=D.menu_opacity)&&void 0!==h?h:1,q=null!==(f=D.menu_opacity_sub)&&void 0!==f?f:null!==(g=D.menu_opacity)&&void 0!==g?g:1,Z=bB(X,Y),$=bB(X,q),K=D.menu_arrow_color||"#ffffff",J=D.menu_item_color||"#ffffff",Q=null!==(m=D.menu_text_opacity)&&void 0!==m?m:1,ee=D.menu_border_width||0,te=null!==(v=D.menu_border_opacity)&&void 0!==v?v:1,ne=D.menu_border_color||"#ffffff",re=bB(ne,te),oe="".concat(ee,"px solid ").concat(re),ie={position:"absolute",left:"".concat(M,"px"),top:"".concat(T,"px"),width:"".concat(A,"px"),height:"".concat(O,"px"),zIndex:9e3,userSelect:"none",WebkitUserSelect:"none",boxSizing:"border-box"},ae={width:"100%",height:"100%",background:Z,border:oe,borderRadius:"".concat(W,"px"),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxSizing:"border-box",transition:"all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)",position:"relative",zIndex:10,boxShadow:C?"0 4px 12px rgba(0,0,0,0.3)":"none"};let se={},le="row",ce="0px, 0px";const de="800px";let ue={};const pe=(A-F)/2,he=(O-P)/2;switch(V){case"right":se={left:"calc(100% + ".concat(B,"px)"),top:"".concat(he,"px"),height:"".concat(P,"px")},le="row",ue={width:C?de:"0px"},ce="-20px, 0";break;case"left":se={right:"calc(100% + ".concat(B,"px)"),top:"".concat(he,"px"),height:"".concat(P,"px")},le="row-reverse",ue={width:C?de:"0px"},ce="20px, 0";break;case"down":se={top:"calc(100% + ".concat(B,"px)"),left:"".concat(pe,"px"),width:"".concat(F,"px")},le="column",ue={height:C?de:"0px"},ce="0, -20px";break;case"up":se={bottom:"calc(100% + ".concat(B,"px)"),left:"".concat(pe,"px"),width:"".concat(F,"px")},le="column-reverse",ue={height:C?de:"0px"},ce="0, 20px";break;default:se={right:"calc(100% + ".concat(B,"px)"),top:0,height:"".concat(P,"px")}}const fe=s(s(s({position:"absolute"},se),{},{display:"flex",flexDirection:le,gap:"".concat(L,"px"),overflow:"hidden"},ue),{},{pointerEvents:C?"auto":"none",transition:"all 0.4s cubic-bezier(0.25, 1, 0.5, 1)",boxSizing:"border-box"});let ge=0;switch(V){case"left":ge=C?0:180;break;case"right":ge=C?180:0;break;case"up":ge=C?90:-90;break;case"down":ge=C?-90:90;break;default:ge=0}const me={color:J,bg:$,border:oe,radius:"".concat(H,"px"),size:G,w:F,h:P,textOpacity:Q,isOpen:C,initialTranslate:ce};return(0,c.jsxs)("div",{style:ie,children:[(0,c.jsx)("div",{style:ae,onClick:e=>{e.stopPropagation(),j(!C),k&&k(!C)},children:(0,c.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:K,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.4s ease",transform:"rotate(".concat(ge,"deg)")},children:(0,c.jsx)("path",{d:"M9 18l6-6-6-6"})})}),(0,c.jsxs)("div",{style:fe,onClick:e=>e.stopPropagation(),children:[(0,c.jsx)(EB,s(s({text:"Save",index:0},me),{},{onClick:()=>{j(!1),x()}})),(0,c.jsx)(EB,s(s({text:"Load",index:1},me),{},{onClick:()=>{j(!1),b()}})),(0,c.jsx)(EB,s(s({text:"Set",index:2},me),{},{onClick:()=>{j(!1),S()}})),(0,c.jsx)(EB,s(s({text:"Rest",index:3},me),{},{onClick:()=>{j(!1),w()}}))]})]})},EB=e=>{let{text:t,color:n,bg:r,border:o,radius:i,size:a,w:s,h:l,textOpacity:d,onClick:u,isOpen:p,initialTranslate:h,index:f}=e;return(0,c.jsx)("div",{onClick:u,style:{width:"".concat(s,"px"),height:"".concat(l,"px"),boxSizing:"border-box",background:r,border:o,borderRadius:i,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",flexShrink:0,opacity:p?1:0,transform:p?"translate(0, 0)":"translate(".concat(h,")"),transition:"\n                    opacity 0.3s ease ".concat(p?.05*f+.1:0,"s,\n                    transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) ").concat(p?.05*f:0,"s,\n                    filter 0.2s\n                ")},onMouseEnter:e=>e.currentTarget.style.filter="brightness(1.2)",onMouseLeave:e=>e.currentTarget.style.filter="none",children:(0,c.jsx)("span",{style:{color:n,fontSize:"".concat(a,"px"),fontWeight:"bold",fontFamily:"inherit",opacity:d,userSelect:"none",whiteSpace:"nowrap"},children:t})})},DB=e=>{let{isOpen:t,mode:n,onClose:r,saves:o,onAction:i,title:a}=e;return t?(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.85)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center",color:"#fff"},onClick:r,children:(0,c.jsxs)("div",{style:{background:"#222",padding:20,borderRadius:8,width:"90%",maxWidth:500,border:"1px solid #444",maxHeight:"80vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{style:{textAlign:"center",marginTop:0},children:a}),"save"===n&&(0,c.jsx)("button",{onClick:()=>i("new"),style:{width:"100%",padding:10,background:"#4caf50",border:"none",color:"#fff",cursor:"pointer",marginBottom:15,borderRadius:4},children:"+ \u041d\u043e\u0432\u043e\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435"}),(!o||0===Object.keys(o).length)&&(0,c.jsx)("div",{style:{textAlign:"center",color:"#888"},children:"\u041d\u0435\u0442 \u0441\u043b\u043e\u0442\u043e\u0432"}),Object.entries(o||{}).sort((e,t)=>t[1].timestamp-e[1].timestamp).map(e=>{let[t,r]=e;return(0,c.jsxs)("div",{style:{background:"#333",marginBottom:10,padding:10,borderRadius:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsxs)("div",{onClick:()=>{"load"===n&&i(r)},style:{flex:1,cursor:"load"===n?"pointer":"default"},children:[(0,c.jsx)("div",{style:{fontWeight:"bold"},children:r.story_title}),(0,c.jsx)("div",{style:{fontSize:12,color:"#aaa"},children:new Date(r.timestamp).toLocaleString()}),(0,c.jsxs)("div",{style:{fontSize:12,fontStyle:"italic"},children:['"',r.text_preview,'"']})]}),(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),i("delete",t)},style:{background:"#d32f2f",border:"none",color:"#fff",padding:"5px 10px",borderRadius:3,marginLeft:10,cursor:"pointer"},children:"X"})]},t)}),(0,c.jsx)("button",{onClick:r,style:{marginTop:20,width:"100%",padding:10,background:"#555",border:"none",color:"#fff",cursor:"pointer",borderRadius:4},children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})}):null},MB=e=>{let{messages:t,onClose:n}=e;return t&&0!==t.length?(0,c.jsx)("div",{style:{position:"absolute",top:20,left:"50%",transform:"translateX(-50%)",zIndex:9999,pointerEvents:"none"},children:t.map((e,t)=>(0,c.jsx)("div",{style:{background:"rgba(0,0,0,0.8)",color:"#fff",padding:"10px 20px",borderRadius:20,marginBottom:10,border:"1px solid #4caf50",textAlign:"center"},children:e},t))}):null},TB=function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const[s,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(!1),[u,p]=(0,e.useState)(!1),[h,f]=(0,e.useState)(!1),g=(0,e.useRef)(null),m=(0,e.useRef)({chunks:[],chunkIndex:0,charIndex:0,currentText:"",waitType:null,waitValue:0}),v=(0,e.useRef)(null),y=(0,e.useRef)(a);(0,e.useEffect)(()=>{y.current=a},[a]),(0,e.useEffect)(()=>{if(!r)return void(g.current=null);const e=new Audio(r);return e.loop=!0,e.volume=.5,g.current=e,()=>{e&&(e.pause(),e.currentTime=0)}},[r]),(0,e.useEffect)(()=>{g.current&&(g.current.volume=.5*i)},[i]),(0,e.useEffect)(()=>{const e=g.current;e&&(c&&!u&&!h&&n.enabled?e.paused&&e.play().catch(e=>console.warn("Audio autoplay blocked",e)):e.paused||e.pause())},[c,u,h,n.enabled]),(0,e.useEffect)(()=>{if(!n.enabled)return f(!0),void l((e=t,e?e.replace(/((?:(\(\([+-]\d+\)\)))|(?:\[\[[+-]\d+\]\])|(?:\[\[click[+-]\]\])|(?:\[\[Event:[^\]]+\]\]))/g,""):""));var e;const r=(e=>e?e.split(/((?:(\(\([+-]\d+\)\)))|(?:\[\[[+-]\d+\]\])|(?:\[\[click[+-]\]\])|(?:\[\[Event:[^\]]+\]\]))/g).filter(Boolean):[])(t);return m.current={chunks:r,chunkIndex:0,charIndex:0,currentText:"",waitType:null,waitValue:0},l(""),d(!0),p(!1),f(!1),b(),()=>clearTimeout(v.current)},[t,n.enabled]);const x=()=>{const e=m.current;if(e.chunkIndex>=e.chunks.length)return d(!1),void f(!0);const t=e.chunks[e.chunkIndex],r=t.match(/^(\(\(|\[\[)([+-])(\d+)(\)\)|\]\])$/),i=t.match(/^\[\[click([+-])\]\]$/),a=t.match(/^\[\[Event:(.+)\]\]$/);if(a){const t=a[1].trim();return y.current&&y.current(t),e.chunkIndex++,e.charIndex=0,void x()}if(i){const t=i[1];return e.chunkIndex++,e.charIndex=0,e.waitType="-"===t?"click_then_clear":"click",p(!0),void d(!1)}if(r){const t=r[2],o=parseInt(r[3],10);"-"===t&&(e.currentText="",l("")),e.chunkIndex++,e.charIndex=0;return"click"===(n["+"===t?"pause_behavior":"clear_behavior"]||"timer")?(e.waitType="-"===t?"click_then_clear":"click",p(!0)):(e.waitType="timer",v.current=setTimeout(()=>{d(!0),b()},1e3*o)),void d(!1)}if("<"===t[e.charIndex]){const n=t.indexOf(">",e.charIndex);if(-1!==n){const r=t.substring(e.charIndex,n+1);e.currentText+=r,e.charIndex=n+1}else e.currentText+="<",e.charIndex++}else e.currentText+=t[e.charIndex],e.charIndex++;l(e.currentText),e.charIndex>=t.length&&(e.chunkIndex++,e.charIndex=0);n.type,n.speed;let s=n.speed;"fade"===n.type&&(s=n.speed/2);const c=Math.max(5,Math.round(s/(o||1)));v.current=setTimeout(x,c)},b=()=>{clearTimeout(v.current),x()},w=(0,e.useCallback)(()=>{const e=m.current;if(h)return;if("click_then_clear"===e.waitType&&u)return e.currentText="",l(""),e.chunkIndex++,e.charIndex=0,e.waitType=null,p(!1),d(!0),void b();if("click"===e.waitType&&u)return e.waitType=null,p(!1),d(!0),void b();clearTimeout(v.current);let t=e.currentText,n=e.chunkIndex;for(;n<e.chunks.length;){const r=e.chunks[n],o=r.match(/^(\(\(|\[\[)([+-])(\d+)(\)\)|\]\])$/),i=r.match(/^\[\[click([+-])\]\]$/),a=r.match(/^\[\[Event:(.+)\]\]$/);if(o||i)return e.chunkIndex=n,e.charIndex=0,e.currentText=t,l(t),void x();a||(n===e.chunkIndex?t+=r.substring(e.charIndex):t+=r),n++}e.chunkIndex=e.chunks.length,e.currentText=t,l(t),d(!1),f(!0)},[h,u,n]);return{displayedText:s,isAnimating:c,isWaiting:u,isFinished:h,triggerSkip:w}},IB=.02,AB=e=>Math.abs(43758.5453*Math.sin(12.9898*e+78.233))%1,OB=new Map,RB={linear:e=>e,easeInOut:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeOutBack:e=>{const t=1.70158;return 1+2.70158*Math.pow(e-1,3)+t*Math.pow(e-1,2)},elastic:e=>{const t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1},bounce:e=>{const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}},zB=function(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5;const a=(n-e)*i,s=(r-t)*i,l=o*o;return(2*t-2*n+a+s)*(o*l)+(-3*t+3*n-2*a-s)*l+a*o+t},FB=(e,t,n)=>e*(1-n)+t*n,PB=(e,t,n)=>{if(!t||!t.effect||"none"===t.effect)return e;const{effect:r,intensity:o=5,speed:i=5,phase:a=0}=t,l=n+a,c=s({},e),d=c.h||100;switch(r){case"shake":c.x+=Math.sin(l*i*20)*o,c.y+=Math.cos(l*i*15)*o;break;case"wiggle":c.rotate=(c.rotate||0)+Math.sin(l*i*5)*o;break;case"pulse":const e=1+Math.sin(l*i*5)*(o/100);c.scaleX=(c.scaleX||1)*e,c.scaleY=(c.scaleY||1)*e;break;case"float":c.y+=Math.sin(l*i)*o;break;case"spin":c.rotate=(c.rotate||0)+l*i*30;break;case"glitch":const t=Math.sin(l*i*50);t>.8&&(c.x+=Math.sin(100*l)*o,c.y+=Math.cos(100*l)*o,t>.95&&(c.opacity=.5*(c.opacity||1)));break;case"jelly":{const e=Math.sin(l*i*5)*(o/100);c.scaleX=(c.scaleX||1)*(1+e),c.scaleY=(c.scaleY||1)*(1-e)}break;case"jelly-bottom":{const e=Math.sin(l*i*5)*(o/100),t=1-e,n=1+e;c.scaleX=(c.scaleX||1)*n,c.scaleY=(c.scaleY||1)*t,c.y+=d*(1-t)/2}break;case"jelly-top":{const e=Math.sin(l*i*5)*(o/100),t=1-e,n=1+e;c.scaleX=(c.scaleX||1)*n,c.scaleY=(c.scaleY||1)*t,c.y-=d*(1-t)/2}break;case"swing":{const e=Math.sin(l*i*3)*o;c.rotate=(c.rotate||0)+e;const t=e*(Math.PI/180);c.x-=d/2*Math.sin(t)}break;case"heartbeat":{const e=l*i%(2*Math.PI);let t=0;e<.5?t=1.5*Math.sin(e*Math.PI*2):e>.8&&e<1.2&&(t=Math.sin((e-.8)*Math.PI*2.5)),t<0&&(t=0);const n=1+t*(o/200);c.scaleX=(c.scaleX||1)*n,c.scaleY=(c.scaleY||1)*n}break;case"flicker":Math.random()>.8&&(c.opacity=(c.opacity||1)*(1-o/20))}return c},BB=(e,t,n,r)=>{const o=null===e||void 0===e?void 0:e[t];if(!o||0===o.length)return null;const i=o.length-1;if(n<=o[0].t)return o[0].v;if(n>=o[i].t)return o[i].v;if("visible"===t){for(let e=i;e>=0;e--)if(n>=o[e].t)return o[e].v;return o[0].v}const a=null===e||void 0===e?void 0:e._config,s=r||(null===a||void 0===a?void 0:a.easing)||"linear",l=RB[s]||RB.linear;for(let c=0;c<i;c++){const e=o[c],r=o[c+1];if(n>=e.t&&n<r.t){const d=r.t-e.t;if(0===d)return e.v;let u=(n-e.t)/d;const p=l(u);if(("x"===t||"y"===t)&&"easeInOut"===s){const t=c>0?o[c-1].v:e.v-(r.v-e.v),n=c<i-1?o[c+2].v:r.v+(r.v-e.v),s=(void 0!==(null===a||void 0===a?void 0:a.easingStrength)?a.easingStrength:2)/4;return zB(t,e.v,r.v,n,u,s)}return FB(e.v,r.v,p)}}return o[i].v},LB=(e,t,n,r,o)=>{const i=JSON.parse(JSON.stringify(e));i.elements||(i.elements={}),i.elements[t]||(i.elements[t]={}),i.elements[t][n]||(i.elements[t][n]=[]);const a=i.elements[t][n],s=a.findIndex(e=>Math.abs(e.t-r)<IB);return s>=0?a[s].v=o:a.push({t:r,v:o}),a.sort((e,t)=>e.t-t.t),i},NB=(e,t,n,r)=>{let o=JSON.parse(JSON.stringify(e));o.elements||(o.elements={}),o.elements[t]||(o.elements[t]={}),o.elements[t][n]||(o.elements[t][n]=[]);const i=o.elements[t][n],a=i.some(e=>Math.abs(e.t-0)<IB);return a||(i.push({t:0,v:r}),i.sort((e,t)=>e.t-t.t)),o},UB=e=>e?e.groups?e:{groups:[{id:"main",name:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f",enabled:e.enabled||!1,duration:e.duration||30,trigger:"start",elements:e.elements||{}}],activeGroupId:"main"}:{groups:[{id:"main",name:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f",enabled:!1,duration:30,trigger:"start",elements:{}}],activeGroupId:"main"},VB=(e,t,n)=>{if(!e||!n)return null;for(const r of e)if(r.id!==t&&r.elements&&r.elements[n]){const e=r.elements[n];for(const t in e){const n=e[t];if(Array.isArray(n)&&n.length>1)return r.name}}return null},WB=(e,t,n,r)=>{if(!r||0===r)return e;const o=JSON.parse(JSON.stringify(e));if(!o.elements||!o.elements[t])return e;const i=o.elements[t];return i[n]&&Array.isArray(i[n])?(i[n].forEach(e=>{e.v=e.v-r}),o):e},HB=(e,t,n)=>{let r=e-t;const o=n/2;return r>o&&(r-=n),r<-o&&(r+=n),r},GB=(e,t,n)=>{const{layers:r=[],stepDuration:o=2,type:i="hard",smoothness:a=.5,multipliers:s={},onlyWhenTyping:l=!1}=e||{};if(!r||0===r.length)return{opacityFactor:1,forceVisible:!0,handled:!1};const c=r.indexOf(t);if(-1===c)return{opacityFactor:1,forceVisible:!0,handled:!1};const d=Math.max(.1,parseFloat(o)||2),u=r.map(e=>{const t=void 0!==s[e]?s[e]:1;return d*t}),p=u.reduce((e,t)=>e+t,0);if(0===p)return{opacityFactor:0,forceVisible:!1,handled:!0};let h=0;for(let w=0;w<c;w++)h+=u[w];const f=h+u[c],g=d*(parseFloat(a)||.5),m="soft"===i?g/2:0,v=Math.max(0,n+m)%p;if("hard"===i){const e=Math.max(0,n)%p,t=e>=h&&e<f;return{opacityFactor:t?1:0,forceVisible:t,handled:!0}}if(g<=.01){const e=v>=h&&v<f;return{opacityFactor:e?1:0,forceVisible:e,handled:!0}}const y=(HB(v,h,p)+g/2)/g,x=1-(HB(v,f,p)+g/2)/g;let b=Math.min(Math.max(0,Math.min(1,y)),Math.max(0,Math.min(1,x)));return{opacityFactor:b,forceVisible:b>.001,handled:!0}},XB=e=>{if(!e||"string"!==typeof e)return{r:0,g:0,b:0};if(OB.has(e))return OB.get(e);let t={r:0,g:0,b:0};if(35===e.charCodeAt(0)){let n=e.slice(1);3===n.length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);const r=parseInt(n,16);isNaN(r)||(t={r:r>>16&255,g:r>>8&255,b:255&r})}else if(e.startsWith("rgb")){const n=e.match(/(\d+(\.\d+)?)/g);n&&n.length>=3&&(t={r:Math.round(parseFloat(n[0])),g:Math.round(parseFloat(n[1])),b:Math.round(parseFloat(n[2]))})}return OB.size>500&&OB.clear(),OB.set(e,t),t},YB=e=>(256+(0|Math.max(0,Math.min(255,Math.round(e))))).toString(16).slice(1),qB=(e,t,n)=>{const r=XB(e),o=XB(t);let i=n;i<0&&(i=0),i>1&&(i=1);const a=r.r+(o.r-r.r)*i,s=r.g+(o.g-r.g)*i,l=r.b+(o.b-r.b)*i;return"#".concat(YB(a)).concat(YB(s)).concat(YB(l))},ZB=(e,t,n,r,o)=>{if(!r||!r.enabled||!r.elements)return n;const i=r.elements[e];if(!i)return n;const a=i[t];if(!a||!Array.isArray(a)||0===a.length)return n;const s=a.length-1;if(o<=a[0].t)return a[0].v;if(o>=a[s].t)return a[s].v;const l=i._config,c=(null===l||void 0===l?void 0:l.easing)||"linear",d=RB[c]||RB.linear;for(let u=0;u<s;u++){const e=a[u],t=a[u+1];if(o>=e.t&&o<t.t){const n=t.t-e.t;if(n<1e-4)return e.v;const r=(o-e.t)/n;return qB(e.v,t.v,d(r))}}return a[s].v},$B=new Map,KB=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return!1;const r=e.currentTarget.querySelector("img.btn-obj-texture");if(!r)return!1;if(!$B.has(t)){const e=document.createElement("canvas");e.width=r.naturalWidth||100,e.height=r.naturalHeight||100;const n=e.getContext("2d");try{n.drawImage(r,0,0,e.width,e.height);const o=n.getImageData(0,0,e.width,e.height);$B.set(t,{data:o.data,width:e.width,height:e.height})}catch(b){return console.warn("Canvas Taint or Error",b),!1}}const o=$B.get(t);if(!o)return!1;const i=e.currentTarget.getBoundingClientRect(),a=e.clientX-i.left,s=e.clientY-i.top,l=(void 0!==n.scaleX?n.scaleX:100)/100,c=(void 0!==n.scaleY?n.scaleY:100)/100,d=(void 0!==n.offsetX?n.offsetX:50)/100,u=(void 0!==n.offsetY?n.offsetY:50)/100,p=i.width*d,h=i.height*u,f=i.width*l,g=i.height*c,m=(a-(p-f/2))/f,v=(s-(h-g/2))/g;if(m<0||m>=1||v<0||v>=1)return!0;const y=Math.floor(Math.max(0,Math.min(m,.999))*o.width),x=4*(Math.floor(Math.max(0,Math.min(v,.999))*o.height)*o.width+y)+3;return o.data[x]<10},JB=e=>{let{url:t,opacity:n,blend:r,borderRadius:o,scaleX:i,scaleY:a,offsetX:s,offsetY:l}=e;if(!t)return null;const d=encodeURI(t),u=void 0!==i?i:100,p=void 0!==a?a:100,h=void 0!==s?s:50,f=void 0!==l?l:50;return(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:'url("'.concat(d,'")'),backgroundSize:"".concat(u,"% ").concat(p,"%"),backgroundPosition:"".concat(h,"% ").concat(f,"%"),backgroundRepeat:"no-repeat",opacity:null!==n&&void 0!==n?n:1,mixBlendMode:r||"normal",borderRadius:o,pointerEvents:"none",zIndex:0}})},QB={enabled:!1,feather:.5,lightColor:"#ffb450",lightIntensity:1.4,monochrome:!1,opacity:.85,radius:170,scaleX:1,scaleY:.8,ambientColor:"#ffe1ba",animationType:"candle",holeBlur:.15,coreOpacity:.46,coreScale:.9,coreBlur:.2,ambientBlur:.3,ambientOpacity:.2,ambientBlend:"screen",ambientScale:1.3,dynamicInvert:!1},eL=e=>{if(!e)return null;if("file"===e.type&&e.url)return e.url;if("preset"===e.type){const t=e.presetType||"noise",n=e.presetScale||50;if("noise"===t)return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d"),i=o.createImageData(e,t),a=new Uint32Array(i.data.buffer);for(let s=0;s<a.length;s++){const e=255*Math.random(),t=n?255*Math.random():e,r=n?255*Math.random():e;a[s]=255<<24|r<<16|t<<8|e}return o.putImageData(i,0,0),r.toDataURL()}(128,128);if("grid"===t){const e=Math.max(4,n),t="<svg width='".concat(e,"' height='").concat(e,"' xmlns='http://www.w3.org/2000/svg'><path d='M ").concat(e," 0 L 0 0 0 ").concat(e,"' fill='none' stroke='white' stroke-width='1'/></svg>");return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(t))}if("scanlines"===t){const e=Math.max(2,n/5),t="<svg width='".concat(e,"' height='").concat(e,"' xmlns='http://www.w3.org/2000/svg'><rect width='").concat(e,"' height='").concat(e/2,"' fill='white'/></svg>");return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(t))}if("checkerboard"===t){const e=Math.max(10,n),t="<svg width='".concat(2*e,"' height='").concat(2*e,"' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='").concat(e,"' height='").concat(e,"' fill='white'/><rect x='").concat(e,"' y='").concat(e,"' width='").concat(e,"' height='").concat(e,"' fill='white'/></svg>");return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(t))}if("vignette"===t){return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent("<svg width='100' height='100' xmlns='http://www.w3.org/2000/svg'><radialGradient id='g'><stop offset='0%' stop-color='white' stop-opacity='0'/><stop offset='100%' stop-color='black'/></radialGradient><rect width='100%' height='100%' fill='url(#g)'/></svg>"))}}return null},tL=t=>{var n,r,o,i,a,l;let{darknessCfg:d,resolution:u,containerRef:p,sharedLightRef:h}=t;const f=s(s({},QB),d),g=(0,e.useRef)(null),m=(0,e.useRef)(null),v=(0,e.useRef)(null),y=(0,e.useRef)({x:-1e3,y:-1e3}),x=(0,e.useRef)({x:-1e3,y:-1e3}),b=(0,e.useRef)({x:-1e3,y:-1e3}),w=(0,e.useRef)({state:"off",lastActiveTime:0,bootTime:0}),S=f&&f.enabled,k=(0,e.useRef)(null);if((0,e.useEffect)(()=>{const e=f.texture;if(!e||!e.enabled)return void(k.current=null);const t=eL(e);if(t){const e=new Image;e.onload=()=>{k.current=e},e.src=t}else k.current=null},[null===(n=f.texture)||void 0===n?void 0:n.enabled,null===(r=f.texture)||void 0===r?void 0:r.type,null===(o=f.texture)||void 0===o?void 0:o.url,null===(i=f.texture)||void 0===i?void 0:i.presetType,null===(a=f.texture)||void 0===a?void 0:a.presetScale]),(0,e.useEffect)(()=>{const e=e=>{const t=g.current;if(!t)return;let n,r;e.touches&&e.touches.length>0?(n=e.touches[0].clientX,r=e.touches[0].clientY):(n=e.clientX,r=e.clientY);const o=t.getBoundingClientRect();if(0===o.width||0===o.height)return;const i=t.width/o.width,a=t.height/o.height;y.current.x=(n-o.left)*i,y.current.y=(r-o.top)*a};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}},[]),(0,e.useEffect)(()=>{if(!S||!g.current)return;const e=g.current,t=e.getContext("2d",{alpha:!0}),n=m.current,r=n?n.getContext("2d",{alpha:!0}):null;let o=!0;const i=(e,t,n)=>e+(t-e)*n,a=()=>{var s,l,c,d,u,p;if(!o)return;const g=e.clientWidth,m=e.clientHeight;e.width===g&&e.height===m||(e.width=g,e.height=m),!n||n.width===g&&n.height===m||(n.width=g,n.height=m),t.clearRect(0,0,g,m),r&&r.clearRect(0,0,g,m);const C=performance.now(),j=f.animationType||"none",_=y.current.x,E=y.current.y;x.current.x<-500&&(x.current.x=_,x.current.y=E,b.current.x=_,b.current.y=E);const D=null!==(s=f.lagIntensity)&&void 0!==s?s:.8,M=1-Math.min(.99,Math.max(0,D));x.current.x=i(x.current.x,_,M),x.current.y=i(x.current.y,E,M);const T=_-b.current.x,I=E-b.current.y,A=Math.sqrt(T*T+I*I);b.current.x=_,b.current.y=E;let O=1,R=1,z=0,F=0;if("candle"===j){const e=Math.sin(.002*C)+.5*Math.sin(.007*C);O=1+.15*e,R=1+.03*e}else if("pulse"===j){const e=Math.sin(.004*C);O=.8+.35*e,R=1+.1*e}else if("broken"===j){const e=C%9e3;if(e<5e3){O=e>1500&&e<2e3||e>3500&&e<4e3?.4+.5*Math.random():1+.05*Math.random()}else O=e<5500?Math.random()>.6?0:1.4:e<7500?0:1}else if("shake"===j){var P;const e=Math.sin(.0025*C)+.4*Math.sin(.008*C);O=1+.12*e,R=1+.02*e;Math.random()>.96&&(O*=Math.random()>.5?.4:1.3);const t=null!==(P=f.shakeAmplitude)&&void 0!==P?P:15,n=Math.sin(.001*C)*t,r=Math.cos(.0013*C)*t;z=n+Math.sin(.02*C)*(.15*t),F=r+Math.cos(.02*C)*(.15*t)}else if("dynamic"===j){var B;const e=null!==(B=f.dynamicSpeed)&&void 0!==B?B:30,t=!!f.dynamicInvert,n=1+.15*(Math.sin(.002*C)+.5*Math.sin(.007*C)),r=A>(t?Math.max(1,.2*e):e);if(t)if(r)w.current.state="active",w.current.lastActiveTime=C,O=n;else{const e=C-w.current.lastActiveTime;if(e<1e3)w.current.state="cooldown_steady",O=n;else if(e<3e3){w.current.state="cooldown_glitch";O=n*(1-(e-1e3)/2e3)*(Math.random()>.7?.2:1)*(Math.random()>.9?0:1)}else w.current.state="off",O=0}else if(r)O=0,w.current.state="off";else{"off"===w.current.state&&(w.current.state="booting",w.current.bootTime=C);const e=C-w.current.bootTime;O=e<300?e/300*n:n}}const L=x.current.x+z,N=x.current.y+F,U=null!==(l=f.lightIntensity)&&void 0!==l?l:1,V=Math.max(0,U*O),W=f.radius||300,H=null!==(c=f.scaleX)&&void 0!==c?c:1,G=null!==(d=f.scaleY)&&void 0!==d?d:1,X=1*W*H*R,Y=1*W*G*R,q=null!==(u=f.holeBlur)&&void 0!==u?u:.3;h&&(!S||V<.05?h.current.active=!1:(h.current.active=!0,h.current.x=L,h.current.y=N,h.current.radius=Math.max(X,Y),h.current.scaleX=X,h.current.scaleY=Y,h.current.intensity=V,h.current.color=f.ambientColor||"#ffb450"));const Z=Math.min(1,V);if(f.monochrome){const t=Math.max(0,X),n=Math.max(0,X+W*q),r="radial-gradient(ellipse ".concat(X,"px ").concat(Y,"px at ").concat(L,"px ").concat(N,"px, transparent 0, transparent ").concat(t,"px, black ").concat(n,"px)");e.style.maskImage!==r&&(e.style.backdropFilter="grayscale(100%)",e.style.webkitBackdropFilter="grayscale(100%)",e.style.maskImage=r,e.style.webkitMaskImage=r)}else"none"!==e.style.backdropFilter&&""!==e.style.backdropFilter&&(e.style.backdropFilter="none",e.style.webkitBackdropFilter="none",e.style.maskImage="none",e.style.webkitMaskImage="none");const $=null!==(p=f.opacity)&&void 0!==p?p:.95;t.globalCompositeOperation="source-over",t.fillStyle="rgba(0, 0, 0, ".concat($,")"),t.fillRect(0,0,g,m),t.globalCompositeOperation="destination-out";const K=Math.max(X,Y);if(K>0&&V>.01){const e=t.createRadialGradient(0,0,0,0,0,K),n=Math.min(1,1.5*V);e.addColorStop(0,"rgba(0,0,0, ".concat(n,")"));const r=Math.max(0,1-1.5*q);r>0&&r<1&&e.addColorStop(r,"rgba(0,0,0, ".concat(n,")")),e.addColorStop(1,"rgba(0,0,0, 0)"),t.save(),t.translate(L,N),t.scale(1,Y/X),t.fillStyle=e,t.beginPath(),t.arc(0,0,Math.max(X,1),0,2*Math.PI),t.fill(),t.restore()}const J=f.texture;if(J&&J.enabled&&k.current&&r){var Q,ee,te;const e=null!==(Q=J.opacity)&&void 0!==Q?Q:.5,t=null!==(ee=J.scale)&&void 0!==ee?ee:1,n=!!J.fixedPos,o=null!==(te=J.blur)&&void 0!==te?te:0,i=Y/X;if(Math.max(X,Y)>0){if(r.save(),r.globalCompositeOperation="source-over",r.globalAlpha=e*Math.min(1,V),n)if(r.setTransform(1,0,0,1,0,0),"file"===J.type&&"stretch"===J.mode)r.drawImage(k.current,0,0,g,m);else{const e=r.createPattern(k.current,"repeat");if(e){const n=new DOMMatrix;n.scaleSelf(t,t),e.setTransform(n),r.fillStyle=e,r.fillRect(0,0,g,m)}}else if(r.translate(L,N),r.scale(1,i),"file"===J.type&&"stretch"===J.mode)r.drawImage(k.current,-X,-X,2*X,2*X);else{const e=r.createPattern(k.current,"repeat");if(e){const n=new DOMMatrix;n.scaleSelf(t,t),e.setTransform(n),r.fillStyle=e,r.fillRect(-X,-X,2*X,2*X)}}if(r.globalCompositeOperation="destination-in",r.globalAlpha=1,r.setTransform(1,0,0,1,L,N),r.scale(1,i),r.beginPath(),o>.01){const e=r.createRadialGradient(0,0,0,0,0,Math.max(X,1)),t=Math.max(0,1-Math.min(1,o));e.addColorStop(0,"rgba(0,0,0,1)"),t>0&&e.addColorStop(t,"rgba(0,0,0,1)"),e.addColorStop(1,"rgba(0,0,0,0)"),r.fillStyle=e,r.fillRect(-X,-X,2*X,2*X)}else r.fillStyle="black",r.arc(0,0,Math.max(X,1),0,2*Math.PI),r.fill();r.restore()}}if(V>.01){var ne,re,oe,ie,ae,se;const e=(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e||"#ffb450");return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:255,g:180,b:80}})(f.ambientColor||"#ffb450"),n=null!==(ne=f.ambientOpacity)&&void 0!==ne?ne:.3,r=null!==(re=f.coreOpacity)&&void 0!==re?re:.5;let o=0,i="screen",a=1;if(r<.5)i="multiply",a=0,o=2*(.5-r);else{i="screen",o=2*(r-.5);a=1+2*(2*(r-.5))}const s=f.ambientBlend||"screen";t.globalCompositeOperation=s;const l=null!==(oe=f.ambientScale)&&void 0!==oe?oe:1.5,c=W*l*H*R,d=W*l*G*R,u=null!==(ie=f.ambientBlur)&&void 0!==ie?ie:.8;if(Math.max(c,d)>0){const r=t.createRadialGradient(L,N,0,L,N,Math.max(c,d)),o="rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b);r.addColorStop(0,"".concat(o,", ").concat(n*Z,")"));const i=Math.max(0,.8*(1-u));i>0&&i<1&&r.addColorStop(i,"".concat(o,", ").concat(n*Z,")")),r.addColorStop(1,"".concat(o,", 0)")),t.save(),t.translate(L,N),t.scale(1,d/c),t.translate(-L,-N),t.fillStyle=r,t.beginPath(),t.arc(L,N,Math.max(c,1),0,2*Math.PI),t.fill(),t.restore()}t.globalCompositeOperation=i;const p=null!==(ae=f.coreScale)&&void 0!==ae?ae:1,h=.25*W*p*H*R,g=.25*W*p*G*R,m=null!==(se=f.coreBlur)&&void 0!==se?se:.1,v=Math.min(255,e.r*a),y=Math.min(255,e.g*a),x=Math.min(255,e.b*a),b="rgba(".concat(v,", ").concat(y,", ").concat(x);if(Math.max(h,g)>0){const e=t.createRadialGradient(L,N,0,L,N,Math.max(h,g));e.addColorStop(0,"".concat(b,", ").concat(o*Z,")"));const n=Math.max(0,.9*(1-m));n>0&&n<1&&e.addColorStop(n,"".concat(b,", ").concat(o*Z,")")),e.addColorStop(1,"".concat(b,", 0)")),t.save(),t.translate(L,N),t.scale(1,g/h),t.translate(-L,-N),t.fillStyle=e,t.beginPath(),t.arc(L,N,Math.max(h,1),0,2*Math.PI),t.fill(),t.restore()}}v.current=requestAnimationFrame(a)};return v.current=requestAnimationFrame(a),()=>{o=!1,v.current&&cancelAnimationFrame(v.current),e.style.backdropFilter="",e.style.webkitBackdropFilter="",e.style.maskImage="",e.style.webkitMaskImage=""}},[f,S]),!S)return null;const C=!1!==f.renderOnTop?9e3:50,j={position:"absolute",top:-10,left:-10,width:"calc(100% + 20px)",height:"calc(100% + 20px)",pointerEvents:"none"};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("canvas",{ref:g,style:s(s({},j),{},{zIndex:C})}),(0,c.jsx)("canvas",{ref:m,style:s(s({},j),{},{zIndex:C+1,mixBlendMode:(null===(l=f.texture)||void 0===l?void 0:l.blend)||"normal",opacity:1})})]})},nL=e.memo(t=>{let{settings:n}=t;const{enabled:r,variant:o="digital",monochrome:i=!0,opacity:a=.1,size:s=1,speed:l=.5,scope:d="global",vhsDistortion:u=.3,vhsTrackingStrength:p=0,vhsTrackingSpeed:h=1}=n||{},[f,g]=(0,e.useState)(null);if((0,e.useEffect)(()=>{if(!r)return;g(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6;const n=document.createElement("canvas"),r=200;n.width=r,n.height=r;const o=n.getContext("2d"),i=o.createImageData(r,r),a=new Uint32Array(i.data.buffer),s=a.length,l=4278190080;for(let c=0;c<s;c++)if(!(Math.random()<t))if(e){const e=256*Math.random()|0;a[c]=l|e<<16|e<<8|e}else a[c]=l|256*Math.random()<<16|256*Math.random()<<8|256*Math.random();return o.putImageData(i,0,0),n.toDataURL("image/png")}("vhs"!==o&&i,.5))},[r,i,o]),!r||!f)return null;const m="global"===d?9e3:50,v=l>.05?"".concat(Math.max(.05,1-l),"s"):"0s",y=l<=.05,x=[];if("vhs"===o&&p>0){const e=Math.min(3,Math.max(0,Math.round(p))),t=Math.max(.1,h);for(let n=0;n<e;n++){const e=(3+1.5*n)/t,r=-1*n;x.push((0,c.jsx)("div",{style:{position:"absolute",left:0,width:"100%",height:"5%",top:"-10%",background:"rgba(255, 255, 255, 0.15)",boxShadow:"0 0 10px rgba(255,255,255,0.2)",mixBlendMode:"overlay",animation:"vhs-tracking-scroll ".concat(e,"s linear infinite"),animationDelay:"".concat(r,"s"),filter:"blur(2px)"}},n))}}return(0,c.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none",zIndex:m},children:[(0,c.jsx)("div",{style:{position:"absolute",top:"-100%",left:"-100%",width:"300%",height:"300%",backgroundImage:"url(".concat(f,")"),backgroundRepeat:"repeat",backgroundSize:"".concat(200*s,"px ").concat(200*s,"px"),animation:y?"none":"noise-shift ".concat(v," steps(5) infinite"),opacity:a,mixBlendMode:"vhs"===o?"overlay":"normal"}}),"vhs"===o&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06))",backgroundSize:"100% 4px, 6px 100%",pointerEvents:"none",opacity:.6}}),(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"repeating-linear-gradient(0deg, transparent, transparent 95%, rgba(255,255,255, ".concat(.4*u,") 96%, transparent 98%)"),backgroundSize:"100% 100vh",animation:"vhs-scroll ".concat(Math.max(.1,5-5*u),"s linear infinite"),mixBlendMode:"screen"}}),x,(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",boxShadow:"inset 0 0 100px rgba(0,0,0,0.8)",mixBlendMode:"multiply"}})]}),(0,c.jsx)("style",{children:"\n                @keyframes noise-shift {\n                    0% { transform: translate(0,0); }\n                    10% { transform: translate(-5%, -5%); }\n                    20% { transform: translate(-10%, 5%); }\n                    30% { transform: translate(5%, -10%); }\n                    40% { transform: translate(-5%, 15%); }\n                    50% { transform: translate(-10%, 5%); }\n                    60% { transform: translate(15%, 0); }\n                    70% { transform: translate(0, 10%); }\n                    80% { transform: translate(-15%, 0); }\n                    90% { transform: translate(10%, 5%); }\n                    100% { transform: translate(5%, 0); }\n                }\n                @keyframes vhs-scroll {\n                    0% { background-position: 0 0; }\n                    100% { background-position: 0 100vh; }\n                }\n                @keyframes vhs-tracking-scroll {\n                    0% { top: -10%; opacity: 0; }\n                    10% { opacity: 1; }\n                    90% { opacity: 1; }\n                    100% { top: 110%; opacity: 0; }\n                }\n            "})]})}),rL=e.memo(t=>{let{settings:n,sceneRef:r,width:o,height:i}=t;const{enabled:a,scope:s="global",speed:l=.5,horzDensity:d=0,vertDensity:u=0,globalShake:p=0,horzScaleX:h=1,horzScaleY:f=1,vertScaleX:g=1,vertScaleY:m=1,blockOpacity:v=1,blockBlend:y="lighter",blockChannelShift:x=0}=n||{},b=(0,e.useRef)(null),w=(0,e.useRef)(null),S=(0,e.useRef)([]),k=(0,e.useRef)(0),C=(0,e.useRef)(null),j=(0,e.useRef)(null),_="glitch-rgb-split-filter",E=(e=>{switch(e){case"lighter":case"screen":return"screen";case"source-over":default:return"normal";case"multiply":return"multiply";case"overlay":return"overlay";case"difference":return"difference"}})(y);if((0,e.useEffect)(()=>{if(!a)return void(r&&r.current&&(r.current.style.filter="brightness(100%)"));r&&r.current&&(r.current.style.filter="global"===s?"url(#".concat(_,")"):"brightness(100%)");const e=b.current;if(!e)return;const t=e.getContext("2d");e.width=o||1280,e.height=i||720;const n=()=>{const e=Math.random();return e<.33?"#ff0000":e<.66?"#00ff00":"#0000ff"},c=()=>{k.current++;const r=e.width,o=e.height;t.clearRect(0,0,r,o);const i=.5*l;if(d>0&&Math.random()<i){const e=Math.ceil(5*d);for(let t=0;t<e;t++)S.current.push({type:"horz",x:Math.random()*r,y:Math.random()*o,w:Math.random()*r*.4*d*h,h:(5*Math.random()+2)*f,color:n(),life:0,maxLife:(5+10*Math.random())/(l+.1)})}if(u>0&&Math.random()<i){const e=Math.ceil(5*u);for(let t=0;t<e;t++)S.current.push({type:"vert",x:Math.random()*r,y:Math.random()*o,w:(5*Math.random()+2)*g,h:Math.random()*o*.4*u*m,color:n(),life:0,maxLife:(5+10*Math.random())/(l+.1)})}if(t.globalCompositeOperation="source-over",S.current.forEach((e,n)=>{e.life++;const r=(1-e.life/e.maxLife)*v;if("horz"===e.type&&(e.x+=10*(Math.random()-.5)*l),"vert"===e.type&&(e.y+=10*(Math.random()-.5)*l),x>0){const n=20*x;t.fillStyle="rgba(255, 0, 0, ".concat(r,")"),t.fillRect(e.x-n,e.y,e.w,e.h),t.fillStyle="rgba(0, 0, 255, ".concat(r,")"),t.fillRect(e.x+n,e.y,e.w,e.h)}else t.fillStyle=e.color,t.globalAlpha=r,t.fillRect(e.x,e.y,e.w,e.h),t.globalAlpha=1;e.life>e.maxLife&&(S.current[n]=null)}),S.current=S.current.filter(Boolean),p>0){if(Math.random()<Math.min(1,.8*l+.05)){const e=20*p,t=(Math.random()-.5)*e,n=(Math.random()-.5)*e;C.current&&C.current.setAttribute("dx",t),j.current&&j.current.setAttribute("dx",n)}else C.current&&C.current.setAttribute("dx",0),j.current&&j.current.setAttribute("dx",0)}else C.current&&"0"!==C.current.getAttribute("dx")&&(C.current.setAttribute("dx",0),j.current.setAttribute("dx",0));w.current=requestAnimationFrame(c)};return w.current=requestAnimationFrame(c),()=>{cancelAnimationFrame(w.current),r&&r.current&&(r.current.style.filter="brightness(100%)")}},[a,l,d,u,p,r,s,h,f,g,m,v,x,o,i]),!a)return null;const D="global"===s?9001:51;return(0,c.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:D,overflow:"hidden",mixBlendMode:E},children:[(0,c.jsx)("canvas",{ref:b,style:{display:"block",position:"absolute",top:0,left:0}}),(0,c.jsx)("svg",{style:{position:"absolute",width:0,height:0,visibility:"hidden"},children:(0,c.jsx)("defs",{children:(0,c.jsxs)("filter",{id:_,x:"-20%",y:"-20%",width:"140%",height:"140%",colorInterpolationFilters:"sRGB",children:[(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",result:"R",values:"1 0 0 0 0 \r 0 0 0 0 0 \r 0 0 0 0 0 \r 0 0 0 1 0"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",result:"G",values:"0 0 0 0 0 \r 0 1 0 0 0 \r 0 0 0 0 0 \r 0 0 0 1 0"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",result:"B",values:"0 0 0 0 0 \r 0 0 0 0 0 \r 0 0 1 0 0 \r 0 0 0 1 0"}),(0,c.jsx)("feOffset",{in:"R",dx:"0",dy:"0",result:"R_OFF",ref:C}),(0,c.jsx)("feOffset",{in:"B",dx:"0",dy:"0",result:"B_OFF",ref:j}),(0,c.jsx)("feComposite",{in:"R_OFF",in2:"G",operator:"arithmetic",k2:"1",k3:"1",result:"RG"}),(0,c.jsx)("feComposite",{in:"B_OFF",in2:"RG",operator:"arithmetic",k2:"1",k3:"1",result:"RGB"})]})})})]})}),oL=(e,t)=>{if(!t||0===t.length)return 0;const n=(e=>e>=95?95:e)(e);if(n<=t[0])return 0;if(n>=t[t.length-1])return t.length-1;const r=t.indexOf(n);if(-1!==r)return r;for(let o=0;o<t.length-1;o++){const e=t[o],r=t[o+1];if(n>e&&n<r){return o+(n-e)/(r-e)}}return 0},iL=(e,t,n,r,o,i)=>{if(!r||!r.enabled)return e;const{x:a,y:l,scale:c,rotate:d}=n,{layerShift:u,affectWidget:p,parallaxStrength:h=.5,parallax3D:f=.5,useRealZ:g}=r,m=((null===o||void 0===o?void 0:o.width)||1280)/2,v=((null===o||void 0===o?void 0:o.height)||720)/2,y=t||0;if(y>=95&&!p)return e;let x=1;if(u&&i&&i.length>0){let e=0;if(g){const t=i[0],n=i[i.length-1],r=n-t;if(r>0){e=(Math.min(Math.max(y,t),n)-t)/r}}else{const t=oL(y,i),n=i.length-1;e=n>0?t/n:0}const t=.1,n=1+1.5*f,r=1+1*f;x=h*(t+Math.pow(e,r)*(n-t))}let b=e.x+a*x,w=e.y+l*x;if(1!==c){const t=1+1*(c-1);b+=(b+e.w/2-m)*(t-1),w+=(w+e.h/2-v)*(t-1)}const S=(e.scaleX||1)*(1+1*(c-1)),k=(e.scaleY||1)*(1+1*(c-1)),C=(e.rotate||0)+d*x;return s(s({},e),{},{x:b,y:w,scaleX:S,scaleY:k,rotate:C})},aL=(e,t,n,r)=>{if(!n||!n.enabled)return 0;const{blurStrength:o=5,blurFront:i=1,blurBack:a=1,useRealZ:s}=n;let l=0,c=1;if(s)l=e-t,c=.2;else{l=oL(e,r)-oL(t,r);const n=10;c=Math.max(1,n/Math.max(2,r.length))}const d=Math.abs(l);if(d<.01)return 0;let u=d*o*c;return u*=l>0?i:a,Math.max(0,u)},sL=["layers"],lL=(e,t)=>{if(!e||!Array.isArray(e)||0===e.length)return null;if(t<=e[0].t)return e[0].v;if(t>=e[e.length-1].t)return e[e.length-1].v;for(let n=0;n<e.length-1;n++){const r=e[n],o=e[n+1];if(t>=r.t&&t<o.t){const e=(t-r.t)/(o.t-r.t);return r.v+e*(o.v-r.v)}}return e[e.length-1].v},cL=function(e,t,n,r,o,i){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";const s=r*Math.PI/180,l=t+Math.cos(s)*o,c=n+Math.sin(s)*o;e.save(),e.strokeStyle=i,e.fillStyle=i,e.lineWidth=2,e.beginPath(),e.moveTo(t,n),e.lineTo(l,c),e.stroke();e.beginPath(),e.moveTo(l,c),e.lineTo(l-10*Math.cos(s-Math.PI/6),c-10*Math.sin(s-Math.PI/6)),e.lineTo(l-10*Math.cos(s+Math.PI/6),c-10*Math.sin(s+Math.PI/6)),e.closePath(),e.fill(),a&&(e.font="10px sans-serif",e.fillStyle="#fff",e.fillText(a,l+10,c)),e.restore()},dL=e=>{e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,r)=>t+t+n+n+r+r);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:255,g:255,b:255}},uL=function(){const e=new Uint8Array(512),t=new Uint8Array(256);for(let i=0;i<256;i++)t[i]=Math.floor(256*Math.random());for(let i=0;i<512;i++)e[i]=t[255&i];const n=e=>e*e*e*(e*(6*e-15)+10),r=(e,t,n)=>t+e*(n-t),o=(e,t,n)=>{const r=15&e,o=r<8?t:n,i=r<4?n:12===r||14===r?t:0;return(0===(1&r)?o:-o)+(0===(2&r)?i:-i)};return{noise:function(t,i){const a=255&Math.floor(t),s=255&Math.floor(i);t-=Math.floor(t),i-=Math.floor(i);const l=n(t),c=n(i),d=e[a]+s,u=e[a+1]+s;return r(c,r(l,o(e[d],t,i),o(e[u],t-1,i)),r(l,o(e[d+1],t,i-1),o(e[u+1],t-1,i-1)))}}}(),pL=t=>{let{settings:n,width:r,height:o,customTime:i,showDebug:a,lightSource:d,cameraSettings:u,cameraOffset:p,currentFocusZ:h,sceneLightsRef:f,uniqueZList:g,isRendering:m=!1}=t;const v=(0,e.useRef)([]),y=(0,e.useMemo)(()=>"undefined"!==typeof navigator&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),[]),x=(0,e.useRef)(null),b=(0,e.useRef)([[],[],[]]),w=(0,e.useRef)({x:-1e3,y:-1e3}),S=(0,e.useRef)([new Map,new Map,new Map]),k=(0,e.useRef)(i),C=(0,e.useRef)([[],[],[]]);(0,e.useEffect)(()=>{k.current=i},[i]);const j=JSON.stringify(n||{}),_=(0,e.useRef)(0),E=(0,e.useMemo)(()=>{const e=n||{},{layers:t}=e,r=l(e,sL);return(t||[e]).map(t=>{const n=s(s({},r),t);!1===e.enabled&&(n.enabled=!1);const o=Math.max(.05,Number(n.stretchX)||1),i=Math.max(.05,Number(n.stretchY)||1),a=n.spawnType||"stream";return s({enabled:!1,type:"snow",count:100,color:"#ffffff",blendMode:"normal",mixBlendMode:n.mixBlendMode||"normal",opacity:.8,size:3,rotate:0,rotateVar:0,areaScaleX:100,areaScaleY:100,areaOffsetX:0,areaOffsetY:0,speed:1,gravity:0,wind:0,windShift:n.windShift||0,windZ:n.windZ||0,windZDir:void 0!==n.windZDir?Number(n.windZDir):1,pixelate:n.pixelate||!1,pixelSize:n.pixelSize||4,airResistance:n.airResistance||0,turbulenceEnabled:!1,turbulenceAmp:20,turbulenceFreq:.01,turbulenceZAmp:n.turbulenceZAmp||0,depth:.5,opacityVar:.5,shape:"circle",stretchX:o,stretchY:i,pointPushForce:n.pointPushForce||0,pointPushZ:void 0!==n.pointPushZ?n.pointPushZ:0,trailLength:n.trailLength||0,trailDensity:n.trailDensity||5,trailSizeDecay:void 0!==n.trailSizeDecay?n.trailSizeDecay:.5,sizeChange:void 0!==n.sizeChange?n.sizeChange:1,sizeChangeSpeed:n.sizeChangeSpeed||5,feather:n.feather||0,spriteBlur:n.spriteBlur||0,blur:0,deviationType:"sin",deviationStrength:10,deviationFreq:.01,flickerSpeed:n.flickerSpeed||1,zIndex:1e3,flicker:0,qualityScale:1,depthBalance:.5,depthSpeedDelta:0,selfRotateSpeed:0,pulseSpeed:0,flipSpeed:0,mouseInteraction:!1,mouseType:"repel",mouseRadius:150,mouseForce:5,opacityRestoreNear:n.opacityRestoreNear||0,opacityRestoreFar:n.opacityRestoreFar||0,cleanStuck:n.cleanStuck||!1,cleanStuckTime:n.cleanStuckTime||3,desyncLife:n.desyncLife||!1,rotateByVelocity:n.rotateByVelocity||!1,velocityStretch:n.velocityStretch||0,velocityExStretch:n.velocityExStretch||0,generationDir:void 0!==n.generationDir?n.generationDir:90,hideZoneDebug:n.hideZoneDebug||!1,colorVarSat:n.colorVarSat||0,colorVarLum:n.colorVarLum||0,colorVarHue:n.colorVarHue||0,useSecondColor:n.useSecondColor||!1,secondColor:n.secondColor||"#000000",colorCycleTime:n.colorCycleTime||3,colorCycleLoop:n.colorCycleLoop||!1,colorCycleReverse:n.colorCycleReverse||!1,spawnType:a,startDelay:void 0!==n.startDelay?Number(n.startDelay):0,preWarmSeconds:void 0!==n.preWarmSeconds?n.preWarmSeconds:0,warmStart:"warm"===a,fadeInTime:void 0!==n.fadeInTime?n.fadeInTime:0,lifeTime:void 0!==n.lifeTime?n.lifeTime:0,generationType:n.generationType||"box",blockingZones:n.blockingZones||[{id:0,enabled:!1,x:50,y:50,width:100,height:100,type:"circle",force:5,ignoreSize:0,mode:"normal",rotation:0}]},n)})},[j]),D=E.some(e=>e.enabled);(0,e.useEffect)(()=>{if(!E.some(e=>e.enabled&&(e.mouseInteraction||"cursor"===e.generationType)))return;const e=e=>{if(x.current){const t=x.current.getBoundingClientRect(),n=r/t.width,i=o/t.height;w.current.x=(e.clientX-t.left)*n,w.current.y=(e.clientY-t.top)*i}else w.current.x=e.clientX,w.current.y=e.clientY},t=e=>{if(e.touches.length>0&&x.current){const t=x.current.getBoundingClientRect(),n=r/t.width,i=o/t.height;w.current.x=(e.touches[0].clientX-t.left)*n,w.current.y=(e.touches[0].clientY-t.top)*i}};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",t)}},[D,j,r,o]);const M=(0,e.useMemo)(()=>E.map(e=>{if(!e.enabled)return null;const t="cloud"===e.shape?1.5:1,n=Math.max(1,e.size*t),r=e.blur||0,o=e.spriteBlur||0,i=4*(r+("circle-soft"===e.shape||"cloud"===e.shape?.5*n:0)+o)+20,a=Math.max(1,e.qualityScale||1),s=n*(e.stretchX||1)*2+i,l=n*(e.stretchY||1)*2+i,c=document.createElement("canvas"),d=Math.max(1,Math.ceil(s*a)),u=Math.max(1,Math.ceil(l*a));c.width=d,c.height=u;const p=c.getContext("2d");p.scale(a,a);const h="blur(".concat(o,"px)");o>0&&(p.filter=h);const f=p.filter===h||p.filter&&"none"!==p.filter;if(o>0)if(f);else{const t=y&&a>1?0:s+50;t>0&&(p.translate(-t,0),p.shadowOffsetX=t),p.shadowBlur=o,p.shadowColor=e.color}else p.filter="none";const g=s/2,m=l/2,v=n*(e.stretchX||1),x=n*(e.stretchY||1);r>0&&(p.shadowBlur=r,p.shadowColor=e.color);const b=dL(e.color);if(p.fillStyle=e.color,p.strokeStyle=e.color,e.feather>0&&"circle"===e.shape){const t=Math.max(v,x),n=p.createRadialGradient(g,m,t*(1-e.feather),g,m,t);n.addColorStop(0,"rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 1)")),n.addColorStop(1,"rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 0)")),p.fillStyle=n}switch(p.beginPath(),e.shape){case"circle":p.ellipse(g,m,v,x,0,0,2*Math.PI),p.fill();break;case"circle-soft":{const e=Math.max(v,x),t=p.createRadialGradient(g,m,0,g,m,e);t.addColorStop(0,"rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 1)")),t.addColorStop(.4,"rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 0.8)")),t.addColorStop(1,"rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 0)")),p.fillStyle=t,p.ellipse(g,m,v,x,0,0,2*Math.PI),p.fill();break}case"ring":p.ellipse(g,m,v,x,0,0,2*Math.PI),p.lineWidth=Math.max(1,.2*v),p.stroke();break;case"triangle":p.moveTo(g,m-x),p.lineTo(g+v,m+x),p.lineTo(g-v,m+x),p.closePath(),p.fill();break;case"star":{const e=5,t=v,n=.4*v,r=Math.PI/e;let o,i,a=Math.PI/2*3;p.moveTo(g,m-t);for(let s=0;s<e;s++)o=g+Math.cos(a)*t,i=m+Math.sin(a)*t,p.lineTo(o,i),a+=r,o=g+Math.cos(a)*n,i=m+Math.sin(a)*n,p.lineTo(o,i),a+=r;p.closePath(),p.fill();break}case"hexagon":{const e=6,t=2*Math.PI/e;let n=-Math.PI/2;p.moveTo(g+Math.cos(n)*v,m+Math.sin(n)*x);for(let r=0;r<e;r++)n+=t,p.lineTo(g+Math.cos(n)*v,m+Math.sin(n)*x);p.closePath(),p.fill();break}case"diamond":p.moveTo(g,m-x),p.lineTo(g+v,m),p.lineTo(g,m+x),p.lineTo(g-v,m),p.closePath(),p.fill();break;case"cloud":{const e=.8*v;p.shadowBlur=!f&&o>0?o+e:e,p.shadowColor="rgba(".concat(b.r,", ").concat(b.g,", ").concat(b.b,", 0.8)"),p.arc(g,m,.5*v,0,2*Math.PI),p.arc(g-.4*v,m+.1*x,.35*v,0,2*Math.PI),p.arc(g+.4*v,m+.1*x,.35*v,0,2*Math.PI),p.fill();break}case"leaf":{const e=m-1.1*x,t=m+.9*x;p.beginPath(),p.moveTo(g,e),p.quadraticCurveTo(g+1.1*v,m-.2*x,g+.4*v,t),p.quadraticCurveTo(g,m+1.15*x,g-.35*v,t),p.quadraticCurveTo(g-.9*v,m-.1*x,g,e),p.closePath(),p.fill();break}case"grass":p.moveTo(g,m-x),p.quadraticCurveTo(g+v,m,g,m+x),p.quadraticCurveTo(g+.2*v,m,g,m-x),p.fill();break;case"heart":{const e=.3*x;p.moveTo(g,m+.8*x),p.bezierCurveTo(g-v,m,g-v,m-e,g,m-e),p.bezierCurveTo(g+v,m-e,g+v,m,g,m+.8*x),p.fill();break}default:p.fillRect(g-v,m-x,2*v,2*x)}return c}),[E,y]),T=(e,t,n)=>{const r=(void 0!==e.areaScaleX?e.areaScaleX:100)/100,o=(void 0!==e.areaScaleY?e.areaScaleY:100)/100,i=(void 0!==e.areaOffsetX?e.areaOffsetX:0)/100*t,a=(void 0!==e.areaOffsetY?e.areaOffsetY:0)/100*n,s=(t*r-t)/2,l=(n*o-n)/2,c=Math.abs(e.speed)<.1?.1:e.speed,d=n/Math.abs(c),u=e.wind*d,p=-s+i-(u>0?0:Math.abs(u)),h=t+s+i+(u<0?0:Math.abs(u)),f=-l+a,g=n+l+a,m=.5*Math.max(t,n)+200;let v,y,x,b;if("point"===e.generationType||"cursor"===e.generationType||"line"===e.generationType){const e=t/2+i,r=n/2+a;v=e-Math.max(t,m),y=e+Math.max(t,m),x=r-Math.max(n,m),b=r+Math.max(n,m)}else v=p-200,y=h+200,x=f-200,b=g+200;return{spawnMinX:p,spawnMaxX:h,spawnMinY:f,spawnMaxY:g,spawnWidth:h-p,spawnHeight:g-f,killMinX:v,killMaxX:y,killMinY:x,killMaxY:b,offsetX:i,offsetY:a,scaleExpandX:s,scaleExpandY:l}},I=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const i=T(e,t,n),{spawnMinX:a,spawnMinY:s,spawnWidth:l,spawnHeight:c,spawnMaxX:d,spawnMaxY:u,offsetX:p,offsetY:h}=i;let f,g,m,v=Math.random();if(.5===e.depthBalance)f=v;else if(e.depthBalance<.5){const t=1+4*(.5-e.depthBalance);f=Math.pow(v,t)}else{const t=1-1.8*(e.depthBalance-.5);f=Math.pow(v,t)}const y=e.generationDir*(Math.PI/180),x=0!==e.speed?Math.abs(e.speed):0;let b=Math.cos(y)*x+e.wind,S=Math.sin(y)*x,k=0;if(r)g=s+Math.random()*c,m=a+Math.random()*l;else if("point"===e.generationType){const r=n/2+h;m=t/2+p+2*(Math.random()-.5),g=r+2*(Math.random()-.5);const o=(e.generationDir||0)*(Math.PI/180),i=0!==e.speed?e.speed:1;if(b=Math.cos(o)*Math.abs(i)+e.wind,S=Math.sin(o)*Math.abs(i),e.pointPushForce>0){const t=e.pointPushForce,n=(e.pointPushZ||0)*(Math.PI/180),r=Math.cos(n)*t;b+=Math.cos(o)*r,S+=Math.sin(o)*r,k=Math.sin(n)*t*.005}else k=0}else if("line"===e.generationType){const r=t/2+p,o=n/2+h,i=t*(void 0!==e.areaScaleX?e.areaScaleX:100)/100/2,a=(e.areaRotation||0)*(Math.PI/180),s=2*(Math.random()-.5);m=r+Math.cos(a)*i*s,g=o+Math.sin(a)*i*s;const l=(e.generationDir||0)*(Math.PI/180),c=0!==e.speed?e.speed:1;b=Math.cos(l)*Math.abs(c)+e.wind,S=Math.sin(l)*Math.abs(c),k=0}else if("cursor"===e.generationType)w.current.x<-500?(m=t/2,g=n/2):(m=w.current.x+10*(Math.random()-.5),g=w.current.y+10*(Math.random()-.5));else{let t=e.generationDir%360;t<0&&(t+=360),t>=45&&t<135?(g=s-10,m=a+Math.random()*l):t>=225&&t<315?(g=u+10,m=a+Math.random()*l):t>=135&&t<225?(m=d+10,g=s+Math.random()*c):(m=a-10,g=s+Math.random()*c)}const C=1-Math.random()*e.opacityVar,j=o||{},_=dL(e.color),E=((e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),o=Math.min(e,t,n);let i,a,s=(r+o)/2;if(r===o)i=a=0;else{const l=r-o;switch(a=s>.5?l/(2-r-o):l/(r+o),r){case e:i=(t-n)/l+(t<n?6:0);break;case t:i=(n-e)/l+2;break;case n:i=(e-t)/l+4}i/=6}return{h:i,s:a,l:s}})(_.r,_.g,_.b),D=e.colorVarHue/100*(Math.random()-.5),M=e.colorVarSat/100*(Math.random()-.5),I=e.colorVarLum/100*(Math.random()-.5);let A=E.h+D;A<0&&(A+=1),A>1&&(A-=1);const O=((e,t,n)=>{let r,o,i;if(0===t)r=o=i=n;else{const a=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;r=a(l,s,e+1/3),o=a(l,s,e),i=a(l,s,e-1/3)}return{r:Math.round(255*r),g:Math.round(255*o),b:Math.round(255*i)}})(A,Math.min(1,Math.max(0,E.s+M)),Math.min(1,Math.max(0,E.l+I)));if(j.cr=O.r,j.cg=O.g,j.cb=O.b,e.useSecondColor){const t=dL(e.secondColor);j.tr=t.r,j.tg=t.g,j.tb=t.b}return j.x=m,j.y=g,j.z=f,j.vy=S,j.vx=b,j.vz=k,j.baseOpacity=C,j.opacity=C,j.phase=Math.random()*Math.PI*2,j.noiseOffsetX=1e3*Math.random(),j.noiseOffsetY=1e3*Math.random(),j.rotatePhase=Math.random()*Math.PI*2,j.pulsePhase=Math.random()*Math.PI*2,j.flipPhase=Math.random()*Math.PI*2,j.flickerPhase=Math.random()*Math.PI*2,j.rotationSeed=Math.random(),j.stuckTimer=0,j.age=0,j.isStuck=!1,j.magnetFactor=0,j.impactEnergy=0,j.currStretch=1,j.currWidth=1,j.lastRotation=0,j.deformationSuppressTimer=0,j.didCollide=!1,j.trail=[],j.stuckTolerance=Math.floor(60*Math.random()),j.isWaitingForBurst=!1,o?"stream"===e.spawnType?j.spawnDelay=Math.floor(90*Math.random()):j.spawnDelay=Math.floor(30*Math.random()):j.spawnDelay=0,j.isDead=!1,j},A=(e,t,n)=>e.blockingZones&&0!==e.blockingZones.length?e.blockingZones.map(e=>{if(!e.enabled)return null;let t=e.x,i=e.y,a=e.width,l=e.height,c=e.rotation||0,d=e.force||0;if(e.animation&&e.animation.enabled){var u,p,h,f,g,m;const r=void 0!==k.current?k.current:n/60,o=!1!==e.animation.loop?r%(e.animation.duration||10):Math.min(r,e.animation.duration||10);e.animation.x&&(t=null!==(u=lL(e.animation.x,o))&&void 0!==u?u:t),e.animation.y&&(i=null!==(p=lL(e.animation.y,o))&&void 0!==p?p:i),e.animation.width&&(a=null!==(h=lL(e.animation.width,o))&&void 0!==h?h:a),e.animation.height&&(l=null!==(f=lL(e.animation.height,o))&&void 0!==f?f:l),e.animation.rotation&&(c=null!==(g=lL(e.animation.rotation,o))&&void 0!==g?g:c),e.animation.force&&(d=null!==(m=lL(e.animation.force,o))&&void 0!==m?m:d)}return s(s({},e),{},{currentX:r*t/100,currentY:o*i/100,currentW:a,currentH:l,currentR:c,force:d})}).filter(Boolean):[],O=(0,e.useRef)([]);(0,e.useEffect)(()=>{E.forEach((e,t)=>{b.current[t]||(b.current[t]=[]);const n=O.current[t]||{};if(!e.enabled)return void(b.current[t]=[]);if(b.current[t].length!==e.count||n.spawnType!==e.spawnType||n.startDelay!==e.startDelay||n.generationType!==e.generationType){if(b.current[t]=[],C.current[t]=[],"sub-layer"===e.generationType)return void(O.current=E);const n=[],i=Math.max(.5,Math.abs(e.speed)),a=o/i||300,s=Math.floor(60*(e.startDelay||0)),l=a/e.count;for(let t=0;t<e.count;t++){const i="warm"===e.spawnType&&s<=0,a=I(e,r,o,i);let c=s;"stream"===e.spawnType?c+=Math.floor(t*l):"burst"===e.spawnType?c+=Math.floor(20*Math.random()):"oneshot"===e.spawnType&&(c+=0),a.spawnDelay=c,i&&e.lifeTime>0&&(a.age=Math.floor(Math.random()*e.lifeTime*60)),a.isDead=!1,n.push(a)}b.current[t]=n}}),O.current=E},[E,o,r]);const R=(e,t,n,r,o,i,a)=>{if(e.isWaitingForBurst)return!1;if(e.spawnDelay>0)return e.spawnDelay--,!1;if(void 0!==e.vz&&Math.abs(e.vz)>1e-5&&(e.z+=e.vz,e.vz*=.95,e.z<-.5||e.z>1.5))return a(),!1;let s=0,l=0;e.didCollide=!1;let c=!1;const d=1+e.z*o.depth,u=1+(e.z-.5)*o.depthSpeedDelta*2,p=e.magnetFactor>.98;p?(e.vx=0,e.vy=0):0!==o.gravity&&(e.vy+=.05*o.gravity*u);const h=10*Math.abs(o.speed)+20;e.vy>h&&(e.vy=h),e.vy<-h&&(e.vy=-h);let f=0,g=0;if(p||(f=0===o.gravity&&"point"!==o.generationType?o.speed*u*d:e.vy*u*d,0!==o.gravity?(g=e.vx*d,e.vx=.99*e.vx+.01*o.wind):(g=e.vx*d+o.wind*d,Math.abs(e.vx)>Math.abs(o.wind)&&(e.vx=.9*e.vx+.1*o.wind))),o.windShift&&0!==o.windShift&&!p&&(e.vx+=.05*o.windShift*d),o.windZ&&0!==o.windZ&&!p){const t=(i.spawnMaxX+i.spawnMinX)/2,n=e.x-t,r=e.z-.5,a=.002*o.windZ;e.vx+=r*a*100*u;const s=-n*a*.05*(o.windZDir||1);e.vz+=.01*s}if(o.airResistance>0&&!p){const t=1-o.airResistance;e.vx*=t,e.vy*=t,void 0!==e.vz&&(e.vz*=t)}e.y+=f,e.x+=g;let m=0,v=0,y=0;if(!p)if(o.turbulenceEnabled){const t=o.turbulenceFreq,r=.005*n,i=uL.noise(e.x*t+e.noiseOffsetX,e.y*t+r),a=uL.noise(e.x*t+e.noiseOffsetY+100,e.y*t-r);if(o.turbulenceZAmp&&0!==o.turbulenceZAmp){y=uL.noise(e.x*t+500,e.y*t+r+200)*o.turbulenceZAmp*5e-4,e.z+=y}m=i*o.turbulenceAmp*d,v=a*o.turbulenceAmp*d*.5,e.x+=.1*m,e.y+=.1*v}else"sin"===o.deviationType&&(m=Math.sin(n*o.deviationFreq+e.phase)*(o.deviationStrength*(1-.5*e.z)),e.x+=m);if(o.mouseInteraction){const t=e.x-w.current.x,n=e.y-w.current.y,r=Math.sqrt(t*t+n*n);if(r<o.mouseRadius){c=!0;const i=(1-r/o.mouseRadius)*o.mouseForce,a=Math.atan2(n,t),s="magnet"===o.mouseType?-1:1;e.x+=Math.cos(a)*i*s,e.y+=Math.sin(a)*i*s}}t.length>0&&t.forEach(t=>{if(t.ignoreSize>0){const n=1-t.ignoreSize;if(e.z>n)return}let n=e.x-t.currentX,r=e.y-t.currentY,o=n,i=r;if("rect"===t.type&&t.currentR){const e=t.currentR*Math.PI/180,a=Math.cos(e),s=Math.sin(e);o=n*a+r*s,i=-n*s+r*a}let d=1e4,u=0,p=0;if("point"===t.type){const o=Math.sqrt(n*n+r*r),i=t.currentW/2;if(o<i){const s=1-o/i,l=t.force||0;if("absorb"===t.mode){c=!0;const t=Math.max(.01,.05*Math.abs(l));return e.opacity-=t,e.opacity<=0?void a():void 0}const d=o>.001?n/o:0,u=o>.001?r/o:1;if(Math.abs(l)>5&&(c=!0),"magnet"===t.mode){const t=.15*l*(s*s);e.vx-=d*t,e.vy-=u*t}else if("bounce"===t.mode){e.magnetFactor=0,e.isStuck=!1;const t=.2*l*s;e.vx+=d*t,e.vy+=u*t}else{const t=.05*l*s;e.vx+=d*t,e.vy+=u*t}}return}if("circle"===t.type){const e=Math.sqrt(n*n+r*r);d=e-t.currentW/2,e>.001?(u=n/e,p=r/e):(u=1,p=0)}else{const e=t.currentW/2,n=t.currentH/2,r=t.borderRadius||0,a=Math.min(r,Math.min(e,n)),s=Math.abs(o)-(e-a),l=Math.abs(i)-(n-a),c=Math.sqrt(Math.max(s,0)**2+Math.max(l,0)**2);d=c+Math.min(Math.max(s,l),0)-a;let h=0,f=0;if(d<0){const t=e-o,r=e+o,a=n-i,s=n+i,l=Math.min(t,r,a,s);l===t?h=1:l===r?h=-1:f=l===a?1:-1}else{const e=o>0?1:-1,t=i>0?1:-1;if(c>.001){h=Math.max(s,0)/c*e,f=Math.max(l,0)/c*t}else s>l?(h=e,f=0):(h=0,f=t)}if(t.currentR){const e=t.currentR*Math.PI/180,n=Math.cos(e),r=Math.sin(e);u=h*n-f*r,p=h*r+f*n}else u=h,p=f}if("absorb"===t.mode){if(d<0){c=!0,e.didCollide=!0;const n=t.force||0,r=Math.max(.01,.05*Math.abs(n));if(e.opacity-=r,e.opacity<=0)return void a()}return}if(d<0){e.didCollide=!0,c=!0;const n=-d;e.x+=u*(n+.1),e.y+=p*(n+.1),"bounce"!==t.mode&&"normal"!==t.mode||(e.magnetFactor=0,e.isStuck=!1);const r=e.vx*u+e.vy*p;if(r<0)if("bounce"===t.mode){let n=.5+t.force/20;n<0&&(n=0),e.vx-=(1+n)*r*u,e.vy-=(1+n)*r*p}else"normal"===t.mode&&(e.vx-=r*u,e.vy-=r*p,e.vx*=.9,e.vy*=.9)}else if("bounce"===t.mode){const n=void 0!==t.magnetRange?t.magnetRange:60;if(d<n){const r=1-d/n,o=.02*(t.force||0)*r;e.vx+=u*o,e.vy+=p*o,Math.abs(o)>.1&&(c=!0)}}const h=void 0!==t.magnetRange?t.magnetRange:60;if("magnet"===t.mode&&d<h){const e=(t.magnetStickiness||0)/100;if(e>0){let n=0;n=d<=0?1:1-d/h;const r=e*n;r>s&&(s=r,l=t.magnetScale||0)}}}),e.magnetFactor=s>0?.8*e.magnetFactor+.2*s:.9*e.magnetFactor;const x=s>.1?l:0;if(e.magnetScaleParam=.9*(e.magnetScaleParam||0)+.1*x,e.magnetFactor>.01){const t=1-e.magnetFactor;e.vx*=t,e.vy*=t,e.x-=g*e.magnetFactor,e.y-=f*e.magnetFactor,p||(e.x-=(e._turbulenceX||0)*e.magnetFactor*.1),e.magnetFactor>.95&&Math.abs(e.vx)+Math.abs(e.vy)<.5&&(e.vx=0,e.vy=0)}if(e.isStuck=e.magnetFactor>.9,e.isStuck&&r){const t=20,n="".concat(Math.floor(e.x/t),"_").concat(Math.floor(e.y/t)),o=r.get(n)||0;r.set(n,o+1),e.gridKey=n}if(o.cleanStuck){const t=e.vx*e.vx+e.vy*e.vy,n=e.isStuck&&t<.5,r=e.didCollide&&t<5,i=e.magnetFactor>.01||c;n||r||i?e.stuckTimer++:(e.stuckTimer=0,e.opacity=e.baseOpacity);const s=60*o.cleanStuckTime+(e.stuckTolerance||0);if(e.stuckTimer>s&&(e.opacity-=.02,e.opacity<=0))return a(),!1}if("dust"===o.type&&0===o.flicker){if(e.opacity+=.04*Math.random()-.02,e.opacity<=0)return a(),!1;e.opacity>1&&(e.opacity=1)}if(e.y>i.killMaxY||e.y<i.killMinY||e.x>i.killMaxX||e.x<i.killMinX)return a(),!1;if(e.z<-.2||e.z,e.age++,e._turbulenceX=m,e._isInteracting=c,e._stepX=g,e._moveY=f,o.trailLength>0)if(e.trail||(e.trail=[]),0===e.trail.length)e.trail.push(e.x,e.y);else{const t=e.trail[0],n=e.trail[1];(e.x-t)**2+(e.y-n)**2>4?(e.trail.unshift(e.x,e.y),e.trail.length>2*o.trailLength&&(e.trail.length=2*o.trailLength)):(e.trail[0]=e.x,e.trail[1]=e.y)}else e.trail&&e.trail.length>0&&(e.trail.length=0);return!0};return(0,e.useEffect)(()=>{if(!D)return;let e;m||(_.current=0),0===_.current&&E.forEach((e,t)=>{if(!e.enabled||e.preWarmSeconds<=0)return;const n=b.current[t];if(!n||0===n.length)return;const i=A(e,0,0),a=Math.ceil(60*e.preWarmSeconds),s=new Map,l=T(e,r,o);let c=0;for(let d=0;d<a;d++)s.clear(),n.forEach(t=>{R(t,i,c,s,e,l,()=>I(e,r,o,!1,t))}),c++;S.current[t]=s});const t=()=>{const e=_.current,t=_.current;E.forEach((n,i)=>{if(!n.enabled)return;const s=v.current[i];if(!s)return;const l=s.getContext("2d",{alpha:!0});if(r>0&&o>0&&l.clearRect(0,0,r,o),"sub-layer"===n.generationType&&i>0){const e=C.current[i-1];if(e&&e.length>0){const t=E[i-1],a=Math.max(1,Math.round(n.count/Math.max(1,t.count)));e.forEach(e=>{for(let t=0;t<a;t++){const t=I(n,r,o,!1);t.x=e.x,t.y=e.y,t.age=0,t.isDead=!1,t.vx+=(Math.random()-.5)*(2*n.speed),t.vy+=(Math.random()-.5)*(2*n.speed),b.current[i].push(t)}})}}i>0&&(C.current[i-1]=[]);const c=b.current[i],u=M[i],p=A(n,0,t),h=!1!==a&&!n.hideZoneDebug,g=T(n,r,o),m=Math.max(1,n.qualityScale||1);const y=c.length;if(h&&p.forEach(e=>{l.save(),l.strokeStyle="magnet"===e.mode?"rgba(0, 255, 200, 0.7)":"bounce"===e.mode?"rgba(255, 165, 0, 0.7)":"rgba(233, 30, 99, 0.7)",l.lineWidth=2,l.setLineDash([6,4]),l.translate(e.currentX,e.currentY),"point"===e.type?(l.beginPath(),l.arc(0,0,e.currentW/2,0,2*Math.PI),l.stroke(),l.beginPath(),l.arc(0,0,5,0,2*Math.PI),l.fill()):"circle"===e.type?(l.beginPath(),l.arc(0,0,e.currentW/2,0,2*Math.PI),l.stroke()):(e.currentR&&l.rotate(e.currentR*Math.PI/180),l.strokeRect(-e.currentW/2,-e.currentH/2,e.currentW,e.currentH)),l.restore()}),!1!==a&&!1!==n.showSpawnDebug){const{offsetX:e,offsetY:t}=g,i=r/2+e,a=o/2+t,s=n.generationDir||0;if(l.save(),"point"===n.generationType){if(l.strokeStyle="#ffff00",l.lineWidth=2,l.beginPath(),l.arc(i,a,5,0,2*Math.PI),l.stroke(),l.setLineDash([2,4]),l.strokeStyle="rgba(255, 255, 0, 0.3)",l.beginPath(),l.arc(i,a,20,0,2*Math.PI),l.stroke(),l.setLineDash([]),cL(l,i,a,s,50,"#00e5ff","Dir"),n.pointPushForce>0){const e=n.pointPushZ||0;l.fillStyle="#ff4081",l.font="10px monospace",l.fillText("Z-Tilt: ".concat(e,"\xb0"),i-30,a-15)}}else if("line"===n.generationType){const e=r*(void 0!==n.areaScaleX?n.areaScaleX:100)/100/2,t=(n.areaRotation||0)*(Math.PI/180),o=i-Math.cos(t)*e,c=a-Math.sin(t)*e,d=i+Math.cos(t)*e,u=a+Math.sin(t)*e;l.strokeStyle="#b39ddb",l.lineWidth=3,l.beginPath(),l.moveTo(o,c),l.lineTo(d,u),l.stroke(),l.fillStyle="#b39ddb",l.beginPath(),l.arc(o,c,3,0,2*Math.PI),l.fill(),l.beginPath(),l.arc(d,u,3,0,2*Math.PI),l.fill(),cL(l,i,a,s,60,"#00e5ff","Fly")}else"box"===n.generationType||n.generationType;l.restore()}l.globalCompositeOperation=["screen","overlay","hard-light","soft-light","plus","lighten","color-dodge"].includes(n.blendMode)?"screen":"multiply"===n.blendMode?"multiply":"source-over";const x=new Map,w=new Map;let k=d&&d.current&&d.current.active?d.current:null;for(let t=c.length-1;t>=0;t--){const a=c[t],s=()=>{C.current[i].push({x:a.x,y:a.y}),"sub-layer"===n.generationType||"oneshot"===n.spawnType?a.isDead=!0:"burst"===n.spawnType?(a.isWaitingForBurst=!0,a.x=-9999,a.y=-9999):I(n,r,o,!1,a)},d=R(a,p,e,x,n,g,s);if(a.isDead){c.splice(t,1);continue}if(!d)continue;let h=1;if(n.fadeInTime>0){const e=60*n.fadeInTime;a.age<e&&(h=a.age/e)}let v=1;if(n.lifeTime>0){const e=60*n.lifeTime;if(a.age>=e){const n=40;if(v=1-(a.age-e)/n,v<=0){if(s(),a.isDead){c.splice(t,1);continue}continue}}}if(a.x>-100&&a.x<r+100&&a.y>-100&&a.y<o+100){let t=a.x,r=a.y;const o=Math.max(0,1-a.magnetFactor);if(n.turbulenceEnabled||"sin"!==n.deviationType||(t+=(a._turbulenceX||0)*o),n.pixelate&&n.pixelSize>1){const e=n.pixelSize;let o=t/e,i=r/e,a=Math.floor(o),s=Math.floor(i),l=o-a,c=i-s;if(Math.abs(l-c)<.25){const e=(l+c)/2;l=e,c=e}if(t=(a+(l>=.5?1:0))*e,r=(s+(c>=.5?1:0))*e,n.pixelReduction>0){const e="".concat(t,"_").concat(r);if(w.has(e)&&Math.random()<n.pixelReduction)continue;w.set(e,!0)}}else t=Math.floor(t+.5),r=Math.floor(r+.5);let s=1;if(n.flicker>0){const t=.05*(n.flickerSpeed||1),r=Math.sin(e*t+a.flickerPhase)*o,i=.6*n.flicker*o;s=Math.max(0,(r+1)/2-i),s>0&&(s=Math.min(1,s*(1+i))),a.magnetFactor>0&&(s=s*(1-a.magnetFactor)+1*a.magnetFactor)}let c=1,d=0,p=0,g=0;if(f&&f.current){const e=f.current;c=void 0!==e.ambient?e.ambient:1;const t=e.threshold||0,n=e.sources||[],r=n.length;if(r>0){a.x,a.y;for(let e=0;e<r;e++){const r=n[e];if(!r.influence||r.influence<=0)continue;let o=0;if("spot"===r.type){const e=a.x-r.x,t=a.y-r.y,n=(r.rotate||0)*(Math.PI/180),i=Math.cos(n),s=Math.sin(n),l=e*i+t*s,c=-e*s+t*i,d=r.spotLength||400;if(l>0&&l<d){const e=r.radius,t=l/d,n=e+(e*(r.spotWidth||1.5)-e)*t,i=(r.spotShift||0)*t,a=Math.abs(c-i);if(a<n){const e=1-a/n,i=r.spotFade||1;o=e*Math.pow(Math.max(0,1-t),i)}}}else{const e=a.x-r.x,t=a.y-r.y,n=e*e+t*t,i=r.radius*(r.haloOpacity>0?3:1.5);if(n<i*i){const e=Math.sqrt(n)/i;o=Math.max(0,1-e),o*=o}}if(t>0&&o>0){const e=1+50*t;o=Math.min(1,o*e)}if(o>.001){var j,_;const e="spot"===r.type?null!==(j=r.haloOpacity)&&void 0!==j?j:1:null!==(_=r.opacity)&&void 0!==_?_:1,t=o*r.influence*e;c+=t,t>.01&&(d+=r.r*t,p+=r.g*t,g+=r.b*t)}}}}let y=n.opacity*a.opacity*s*h*v;const x=void 0!==n.opacityRestoreFarLimit?n.opacityRestoreFarLimit:.3,b=void 0!==n.opacityRestoreNearLimit?n.opacityRestoreNearLimit:.7;if(n.opacityRestoreFar>0&&a.z<x){y+=(1-y)*((x-a.z)/x*n.opacityRestoreFar)}if(n.opacityRestoreNear>0&&a.z>b){const e=1-b;y+=(1-y)*((a.z-b)/(e>0?e:.001)*n.opacityRestoreNear)}let C=Math.max(0,Math.min(1,y*c)),E=0;if(k){const e=a.x-k.x,t=a.y-k.y,n=k.scaleX+50,r=k.scaleY+50,o=e*e/(n*n)+t*t/(r*r);if(o<1){E=(1-o)*k.intensity*2}}if(C+=.5*E,C>.01){let s=a.cr,c=a.cg,h=a.cb;if(E>0){const e=Math.min(1,E);s+=(255-s)*e,c+=(255-c)*e,h+=(255-h)*e}(d>0||p>0||g>0)&&(s+=d,c+=p,h+=g,s>255&&(s=255),c>255&&(c=255),h>255&&(h=255));const f=Math.min(1,C);if(l.globalAlpha=f,n.useSecondColor){const e=60*Math.max(1,n.colorCycleTime);let t=0;if(n.colorCycleLoop&&n.colorCycleReverse){const n=a.age%(2*e);t=n<e?n/e:1-(n-e)/e}else t=n.colorCycleLoop?a.age%e/e:n.colorCycleReverse?a.age<e?a.age/e:a.age<2*e?1-(a.age-e)/e:0:Math.min(1,a.age/e);s=a.cr+(a.tr-a.cr)*t,c=a.cg+(a.tg-a.cg)*t,h=a.cb+(a.tb-a.cb)*t}const v=n.useSecondColor||n.colorVarHue>0||n.colorVarSat>0||n.colorVarLum>0;l.globalAlpha=C;const y=1+a.z*n.depth;let x,b;if(v){const e="cloud"===n.shape?1.5:1,t=n.size*e*2;x=t*y,b=t*y}else x=(u?u.width/m:2*n.size)*y,b=(u?u.height/m:2*n.size)*y;let w=1;if(a.isStuck&&a.magnetScaleParam>0&&a.gridKey){const e=S.current[i],t=e&&e.get(a.gridKey)||1,n=10,r=Math.min(t,n)/n;w=1+a.magnetScaleParam/100*r}if(x*=w,b*=w,1!==n.sizeChange){const e=60*Math.max(.1,n.sizeChangeSpeed);let t=a.age/e;t>1&&(t=1);const r=1+(n.sizeChange-1)*t;x*=Math.max(0,r),b*=Math.max(0,r)}if(n.pulseSpeed>0){const t=1+.5*Math.sin(.05*e*n.pulseSpeed+a.pulsePhase)*o;x*=t,b*=t}if(n.flipSpeed>0){x*=Math.abs(Math.cos(.05*e*n.flipSpeed+a.flipPhase))*o+1*(1-o)}if(n.velocityStretch<=0)a.currStretch=1,a.currWidth=1,a.impactEnergy=0,a.deformationSuppressTimer=0;else{const e=a._stepX||0,t=a._moveY||0,r=e*e+t*t,o=Math.sqrt(r),i=Math.min(o/15,5);let s=1+i*n.velocityExStretch*.4;let l=1-Math.min(i*n.velocityStretch*.15,.75);if(a.deformationSuppressTimer>0){a.deformationSuppressTimer--;let e=a.deformationSuppressTimer>60?1:a.deformationSuppressTimer/60;const t=Math.max(.1,n.stretchX||1),r=Math.max(.1,n.stretchY||1)/t,o=r>1.2;s+=((o?1/r*.8:.9)-s)*e,l+=((o?Math.sqrt(r):1.1)-l)*e}a.isStuck?a.impactEnergy=0:a.didCollide||a._isInteracting||a.stuckTimer>0?a.impactEnergy=1:(a.impactEnergy*=.85,a.impactEnergy<.01&&(a.impactEnergy=0));const c=Math.min(n.velocityStretch/5,1),d=1+.5*c;let u=s+(1-(1-.5*(n.stretchY>n.stretchX?1/(n.stretchY/n.stretchX):.7))*c-s)*a.impactEnergy,p=l+(d-l)*a.impactEnergy;const h=Math.max(.01,n.stretchX||1),f=Math.max(.01,n.stretchY||1),g=f>h?h/f:f/h,m=1,v=2;if(a.age<v)u=g,p=1,a.currStretch=g,a.currWidth=1;else if(a.age<m){const e=(a.age-v)/(m-v),t=e*e;u=g+(u-g)*t,p=1+(p-1)*t,a.currStretch=.8*(a.currStretch||g)+.2*u,a.currWidth=.8*(a.currWidth||1)+.2*p}else a.currStretch=.8*(a.currStretch||1)+.2*u,a.currWidth=.8*(a.currWidth||1)+.2*p;a.magnetFactor>0&&(a.currStretch=a.currStretch*(1-a.magnetFactor)+1*a.magnetFactor,a.currWidth=a.currWidth*(1-a.magnetFactor)+1*a.magnetFactor)}let k=0;const j=n.stretchY>n.stretchX;if(n.rotateByVelocity){const e=a._stepX||0,t=a._moveY||0;if(e*e+t*t>.5){k=Math.atan2(t,e),j&&(k+=Math.PI/2);k+=2*(a.rotationSeed-.5)*(n.rotateVar*Math.PI/180),a.lastRotation=k}else k=a.lastRotation||0}else{k=(n.rotate||0)*(Math.PI/180),0!==n.selfRotateSpeed&&(k+=(.05*e*n.selfRotateSpeed+a.rotatePhase)*o);k+=2*(a.rotationSeed-.5)*(n.rotateVar*Math.PI/180)*o}if(n.trailLength>0&&a.trail&&a.trail.length>=4){const e=a.trail.length/2,t=Math.max(1,n.trailDensity||5),r=void 0!==n.trailSizeDecay?n.trailSizeDecay:.5,o=Math.max(1,Math.floor(e/t));for(let i=o;i<e;i+=o){const t=2*i;if(t>=a.trail.length-1)break;const o=a.trail[t],s=a.trail[t+1],c=i/e,d=C*(1-c),p=1-c*r;if(d<.01||p<=0)continue;l.save(),l.globalAlpha=d,l.translate(o,s),l.rotate(k);let h=a.currStretch*p,f=a.currWidth*p;if(j?l.scale(f,h):l.scale(h,f),v){const e=Math.max(.5,n.size*n.stretchX*y),t=Math.max(.5,n.size*n.stretchY*y);switch(l.fillStyle=l.fillStyle,l.shadowBlur=0,l.beginPath(),n.shape){case"circle":default:l.ellipse(0,0,e,t,0,0,2*Math.PI),l.fill();break;case"rect":l.fillRect(-e,-t,2*e,2*t)}}else u&&u.width>0&&l.drawImage(u,-x/2,-b/2,x,b);l.restore()}l.globalAlpha=f}if(l.translate(t,r),l.rotate(k),j?l.scale(a.currWidth,a.currStretch):l.scale(a.currStretch,a.currWidth),v){const e="rgb(".concat(0|s,", ").concat(0|c,", ").concat(0|h,")"),t=Math.max(.5,x/2*n.stretchX),r=Math.max(.5,b/2*n.stretchY);if(n.feather>0&&"circle"===n.shape){const e=Math.max(t,r),o=Math.max(0,e*(1-n.feather)),i=l.createRadialGradient(0,0,o,0,0,e);i.addColorStop(0,"rgba(".concat(0|s,", ").concat(0|c,", ").concat(0|h,", ").concat(f,")")),i.addColorStop(1,"rgba(".concat(0|s,", ").concat(0|c,", ").concat(0|h,", 0)")),l.fillStyle=i}else l.fillStyle=e;switch(n.blur>0?(l.shadowBlur=n.blur,l.shadowColor=e):l.shadowBlur=0,l.beginPath(),n.shape){case"circle":l.ellipse(0,0,t,r,0,0,2*Math.PI),l.fill();break;case"circle-soft":const n=l.createRadialGradient(0,0,0,0,0,Math.max(t,r));n.addColorStop(0,e.replace(")",", 1)")),n.addColorStop(.5,e.replace(")",", 0.5)")),n.addColorStop(1,e.replace(")",", 0)")),l.fillStyle=n,l.ellipse(0,0,t,r,0,0,2*Math.PI),l.fill();break;case"ring":l.ellipse(0,0,t,r,0,0,2*Math.PI),l.lineWidth=Math.max(1,.2*t),l.strokeStyle=l.fillStyle,l.stroke();break;case"triangle":l.moveTo(0,-r),l.lineTo(t,r),l.lineTo(-t,r),l.closePath(),l.fill();break;case"star":const o=5,i=t,a=.4*t;let s=Math.PI/2*3,c=Math.PI/o;l.moveTo(0,0-i);for(let e=0;e<o;e++)l.lineTo(Math.cos(s)*i,Math.sin(s)*i),s+=c,l.lineTo(Math.cos(s)*a,Math.sin(s)*a),s+=c;l.lineTo(0,0-i),l.closePath(),l.fill();break;case"hexagon":{const e=6,n=2*Math.PI/e;let o=-Math.PI/2;l.moveTo(Math.cos(o)*t,Math.sin(o)*r);for(let i=0;i<e;i++)o+=n,l.lineTo(Math.cos(o)*t,Math.sin(o)*r);l.closePath(),l.fill();break}case"diamond":l.moveTo(0,-r),l.lineTo(t,0),l.lineTo(0,r),l.lineTo(-t,0),l.closePath(),l.fill();break;case"cloud":l.arc(0,0,.5*t,0,2*Math.PI),l.arc(.4*-t,.1*r,.35*t,0,2*Math.PI),l.arc(.4*t,.1*r,.35*t,0,2*Math.PI),l.fill();break;case"leaf":l.moveTo(0,-r),l.quadraticCurveTo(1.2*t,.2*-r,0,r),l.quadraticCurveTo(1.2*-t,.2*-r,0,-r),l.fill();break;case"grass":l.moveTo(0,-r),l.quadraticCurveTo(t,0,0,r),l.quadraticCurveTo(.2*t,0,0,-r),l.fill();break;case"heart":const d=.3*r;l.moveTo(0,.8*r),l.bezierCurveTo(-t,0,-t,-d,0,-d),l.bezierCurveTo(t,-d,t,0,0,.8*r),l.fill();break;default:l.fillRect(-t,-r,2*t,2*r)}n.blur>0&&(l.shadowBlur=0)}else u&&u.width>0&&l.drawImage(u,-x/2,-b/2,x,b);l.setTransform(1,0,0,1,0,0)}}}S.current[i]||(S.current[i]=new Map),S.current[i]=x,"burst"===n.spawnType&&y>0&&0/y>=.85&&c.forEach(e=>{e.isWaitingForBurst=!1,I(n,r,o,!1,e),e.spawnDelay=Math.floor(10*Math.random())})}),_.current++};if(m)t();else{const n=()=>{t(),e=requestAnimationFrame(n)};n()}return()=>{e&&cancelAnimationFrame(e)}},[E,M,r,o,a,d,m,m?i:null]),D?(0,c.jsx)("div",{ref:x,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"hidden"},children:E.map((e,t)=>{var n;if(!e.enabled)return null;const i=void 0!==e.zIndex?e.zIndex:1e3,a=iL({x:0,y:0,w:r,h:o,scaleX:1,scaleY:1,rotate:0},i,p,u,{width:r,height:o},g),s=!y||"normal"===e.mixBlendMode,l=s?"translate3d(".concat(a.x,"px, ").concat(a.y,"px, 0) rotate(").concat(a.rotate,"deg) scale(").concat(a.scaleX,", ").concat(a.scaleY,")"):"translate(".concat(a.x,"px, ").concat(a.y,"px) rotate(").concat(a.rotate,"deg) scale(").concat(a.scaleX,", ").concat(a.scaleY,")");let d="none";if(null!==u&&void 0!==u&&null!==(n=u.focus)&&void 0!==n&&n.enabled){const e=aL(i,h,u.focus,g);e>.5&&(d="blur(".concat(e.toFixed(1),"px)"))}return(0,c.jsx)("canvas",{ref:e=>v.current[t]=e,width:r,height:o,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:i,mixBlendMode:e.mixBlendMode,transform:l,filter:d,transformOrigin:"center center",willChange:s?"transform":"auto",transition:"filter 0.2s ease"}},t)})}):null},hL=e.memo(pL,(e,t)=>{const n=JSON.stringify(e.cameraSettings)!==JSON.stringify(t.cameraSettings),r=e.cameraOffset!==t.cameraOffset,o=e.currentFocusZ!==t.currentFocusZ;return!(n||r||o)&&(e.width===t.width&&e.height===t.height&&e.showDebug===t.showDebug&&JSON.stringify(e.settings)===JSON.stringify(t.settings)&&e.customTime===t.customTime)}),fL=(e,t)=>{if(!e)return null;const n="mobile"===t?"weather_mobile":"weather_desktop";return e[n]?e[n]:"mobile"===t&&e.weather_desktop?e.weather_desktop:e.weather||null},gL=e.memo(t=>{let{settings:n,width:r,height:o,currentTime:i=0,chromaticFilterId:a}=t;const l=n||{},d=!1!==l.enabled,u=l.animation,p="main",h="number"===typeof l._previewTime?l._previewTime:i,{renderAbove:f=!0,brightness:g=1,contrast:m=1,saturate:v=1,grayscale:y=0,sepia:x=0,hueRotate:b=0,invert:w=0,blur:S=0,temperature:k=0,fadeAmount:C=0,chromatic:j,isolation:_={},vignette:E,tint:D}=l,M=(0,e.useMemo)(()=>ZB(p,"fadeColor",l.fadeColor||"#1a1a1a",u,h),[l.fadeColor,u,h]),T=(0,e.useMemo)(()=>ZB(p,"tint_color",(null===D||void 0===D?void 0:D.color)||"#ff0000",u,h),[D,u,h,d,i]),I=f?900:99,A=(0,e.useMemo)(()=>s({color:null,bgDesaturation:0,bgDarkening:0,spread:0},_),[_]),O=(0,e.useMemo)(()=>s({enabled:!1,offsetX:0,offsetY:0},j),[j]),R=s({enabled:!1,intensity:.5,size:.5,color:"#000000"},E),z=s(s({enabled:!1,opacity:.2,mode:"soft-light"},D),{},{color:T}),F=(0,e.useMemo)(()=>Math.random().toString(36).slice(2),[]),P="iso-filter-".concat(F),B=a||"chrom-filter-".concat(F),L=(0,e.useMemo)(()=>{if(!A.color)return null;const e=1-Math.min(1,Math.max(0,A.bgDesaturation)),t=1-Math.min(1,Math.max(0,A.bgDarkening)),n=Math.min(1,Math.max(0,A.spread)),r="\n            ".concat((.2126*(1-e)+e)*t," ").concat(.7152*(1-e)*t," ").concat(.0722*(1-e)*t," 0 0\n            ").concat(.2126*(1-e)*t," ").concat((.7152*(1-e)+e)*t," ").concat(.0722*(1-e)*t," 0 0\n            ").concat(.2126*(1-e)*t," ").concat(.7152*(1-e)*t," ").concat((.0722*(1-e)+e)*t," 0 0\n            0 0 0 1 0\n        "),o=1-.8*n;let i="";switch(A.color){case"red":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  ".concat(2," -").concat(2*o," -").concat(2*o," 0 0");break;case"green":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  -".concat(2*o," ").concat(2," -").concat(2*o," 0 0");break;case"blue":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  -".concat(2*o," -").concat(2*o," ").concat(2," 0 0");break;case"cyan":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  -".concat(2*o," ").concat(2," ").concat(2," 0 0");break;case"magenta":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  ".concat(2," -").concat(2*o," ").concat(2," 0 0");break;case"yellow":case"orange":i="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  ".concat(2," ").concat(2," -").concat(2*o," 0 0");break;default:return null}return(0,c.jsxs)("filter",{id:P,x:"-20%",y:"-20%",width:"140%",height:"140%",colorInterpolationFilters:"sRGB",children:[(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:r,result:"BACKGROUND"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i,result:"MASK_RAW"}),(0,c.jsx)("feComponentTransfer",{in:"MASK_RAW",result:"MASK_ALPHA",children:(0,c.jsx)("feFuncA",{type:"linear",slope:n>.5?2:4,intercept:"-0.1"})}),(0,c.jsx)("feComposite",{in:"SourceGraphic",in2:"MASK_ALPHA",operator:"in",result:"ISOLATED_CONTENT"}),(0,c.jsxs)("feMerge",{children:[(0,c.jsx)("feMergeNode",{in:"BACKGROUND"}),(0,c.jsx)("feMergeNode",{in:"ISOLATED_CONTENT"})]})]})},[A,P]),N=(0,e.useMemo)(()=>{const e=O.enabled?O.offsetX:0,t=O.enabled?O.offsetY:0;return Math.abs(e)<.1&&Math.abs(t)<.1?null:(0,c.jsxs)("filter",{id:B,filterUnits:"userSpaceOnUse",primitiveUnits:"userSpaceOnUse",x:0,y:0,width:r,height:o,colorInterpolationFilters:"sRGB",children:[(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"R"}),(0,c.jsx)("feOffset",{in:"R",dx:e,dy:t,result:"R_SHIFT"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"0 0 0 0 0  0 1 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"G"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"0 0 0 0 0  0 0 0 0 0  0 0 1 0 0  0 0 0 1 0",result:"B"}),(0,c.jsx)("feOffset",{in:"B",dx:-e,dy:-t,result:"B_SHIFT"}),(0,c.jsx)("feBlend",{in:"R_SHIFT",in2:"G",mode:"screen",result:"RG"}),(0,c.jsx)("feBlend",{in:"RG",in2:"B_SHIFT",mode:"screen"})]})},[O,B,r,o]);if(!n||!d)return null;const U=["brightness(".concat(g,")"),"contrast(".concat(m,")"),"saturate(".concat(v,")"),"grayscale(".concat(y,")"),"sepia(".concat(x,")"),"hue-rotate(".concat(b,"deg)"),"invert(".concat(w,")"),"blur(".concat(S,"px)")].join(" "),V=[A.color?"url(#".concat(P,")"):""].filter(Boolean).join(" "),W={position:"absolute",inset:0,width:r||"100%",height:o||"100%",pointerEvents:"none",willChange:"backdrop-filter"};let H="transparent",G=0;k>0?(H="#ff8800",G=.2*k):k<0&&(H="#0088ff",G=.2*Math.abs(k));const X=Math.max(0,100-100*(Number(R.size)||.5));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:r,height:o,overflow:"hidden",pointerEvents:"none",opacity:0,zIndex:-1},children:(0,c.jsxs)("defs",{children:[L,N]})}),U&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I,backdropFilter:U,WebkitBackdropFilter:U,backgroundColor:"transparent"})}),V&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I,backdropFilter:V,WebkitBackdropFilter:V,backgroundColor:"transparent"})}),0!==k&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I+1,backgroundColor:H,opacity:G,mixBlendMode:"overlay"})}),C>0&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I+1,backgroundColor:M,opacity:C,mixBlendMode:"lighten"})}),z.enabled&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I+1,backgroundColor:z.color,opacity:z.opacity,mixBlendMode:z.mode})}),R.enabled&&(0,c.jsx)("div",{style:s(s({},W),{},{zIndex:I+1,background:"radial-gradient(circle, transparent ".concat(X,"%, ").concat(R.color," 100%)"),opacity:R.intensity,mixBlendMode:"multiply"})})]})}),mL=gL,vL=e.memo(t=>{let{settings:n,width:r,height:o}=t;const i=n||{},{enabled:a=!1,renderAbove:s=!0,mode:l="original",opacity:d=.5,blend:u="overlay",scale:p=1,offsetX:h=0,offsetY:f=0,brightness:g=1,textureType:m="file",url:v,presetType:y="noise",noiseScale:x=50,noiseColor:b=!1,lineDensity:w=50,lineThickness:S=20,lineVertical:k=!1,gridSize:C=40,gridThickness:j=1,checkSize:_=50,dotSize:E=2,dotSpacing:D=20,dotColor:M="#ffffff",dotStagger:T=!1,honeycombSize:I=30,honeycombStroke:A=1,honeycombFill:O=!1,diagThickness:R=2,diagSpacing:z=10,diagColor1:F="#ffffff",diagColor2:P="#000000",vigIntensity:B=50,vigColor:L="#000000",paperGrain:N=1}=i,{backgroundString:U,backgroundSize:V}=(0,e.useMemo)(()=>{if(!a)return{backgroundString:"none",backgroundSize:"auto"};if("file"===m){return{backgroundString:v?"url(".concat(v,")"):"none",backgroundSize:"stretch"===l?"100% 100%":"auto"}}switch(y){case"noise":{const e=((e,t,n)=>{const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d"),i=o.createImageData(e,t),a=new Uint32Array(i.data.buffer),s=a.length;for(let l=0;l<s;l++){const e=255*Math.random(),t=n?255*Math.random():e,r=n?255*Math.random():e,o=255;a[l]=o<<24|r<<16|t<<8|e}return o.putImageData(i,0,0),r.toDataURL()})(128,128,b),t=Math.max(64,400-3.3*x);return{backgroundString:"url(".concat(e,")"),backgroundSize:"".concat(t,"px ").concat(t,"px")}}case"scanlines":{const e=Math.max(2,w/2),t=Math.min(95,Math.max(5,S)),n="rgba(0,0,0,1)",r="rgba(0,0,0,0)",o="linear-gradient(to bottom, ".concat(n," ").concat(t,"%, ").concat(r," ").concat(t,"%)"),i="linear-gradient(to right, ".concat(n," ").concat(t,"%, ").concat(r," ").concat(t,"%)");return{backgroundString:k?"".concat(o,", ").concat(i):o,backgroundSize:"".concat(e,"px ").concat(e,"px")}}case"polka-dots":{const e=Math.max(.5,E),t=Math.max(2*e+2,D),n="radial-gradient(circle, ".concat(M||"#ffffff"," ").concat(e,"px, transparent ").concat(e,"px)");return T?{backgroundString:"".concat(n,", ").concat(n),backgroundSize:"".concat(t,"px ").concat(t,"px"),backgroundPosition:"0 0, ".concat(t/2,"px ").concat(t/2,"px")}:{backgroundString:n,backgroundSize:"".concat(t,"px ").concat(t,"px"),backgroundPosition:"0 0"}}case"honeycomb":{const e=Math.max(5,I),t=Math.max(.5,A),n=3*e,r=e*Math.sqrt(3),o=O?"rgba(255,255,255,0.1)":"none",i="white",a="\n                <svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg'>\n                    <defs>\n                        <pattern id='hex' width='".concat(n,"' height='").concat(r,"' patternUnits='userSpaceOnUse'>\n                             <path d='M ").concat(e," 0 L ").concat(.5*e," ").concat(r/2," L ").concat(e," ").concat(r," L ").concat(2*e," ").concat(r," L ").concat(2.5*e," ").concat(r/2," L ").concat(2*e," 0 Z M 0 ").concat(r/2," L ").concat(.5*e," 0 M ").concat(n," ").concat(r/2," L ").concat(2.5*e," 0 M 0 ").concat(r/2," L ").concat(.5*e," ").concat(r," M ").concat(n," ").concat(r/2," L ").concat(2.5*e," ").concat(r,"' \n                             fill='").concat(o,"' stroke='").concat(i,"' stroke-width='").concat(t,"'/>\n                        </pattern>\n                    </defs>\n                    <rect width='100%' height='100%' fill='url(#hex)' />\n                </svg>");return{backgroundString:'url("data:image/svg+xml;charset=utf-8,'.concat(encodeURIComponent(a),'")'),backgroundSize:"auto"}}case"grid":{const e=Math.max(4,C),t=Math.max(.5,j),n="rgba(255, 255, 255, 1)",r="linear-gradient(90deg, ".concat(n," ").concat(t,"px, transparent ").concat(t,"px)"),o="linear-gradient(0deg, ".concat(n," ").concat(t,"px, transparent ").concat(t,"px)");return{backgroundString:"".concat(r,", ").concat(o),backgroundSize:"".concat(e,"px ").concat(e,"px")}}case"diagonal":{const e=Math.max(1,R),t=Math.max(1,z),n=F,r=P;return{backgroundString:"repeating-linear-gradient(45deg, ".concat(n,", ").concat(n," ").concat(e,"px, ").concat(r," ").concat(e,"px, ").concat(r," ").concat(e+t,"px)"),backgroundSize:"auto"}}case"vignette":{const e=100-Math.min(100,Math.max(0,B)),t=L;return{backgroundString:"radial-gradient(ellipse at center, transparent ".concat(e/2,"%, ").concat(t," 100%)"),backgroundSize:"100% 100%"}}case"paper":{const e="<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='".concat(N||1,"' numOctaves='3' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23n)' opacity='0.5'/></svg>");return{backgroundString:'url("data:image/svg+xml;charset=utf-8,'.concat(encodeURIComponent(e),'")'),backgroundSize:"200px 200px"}}case"checkerboard":{const e=Math.max(2,_),t="#000",n="transparent";return{backgroundString:"conic-gradient(".concat(t," 90deg, ").concat(n," 90deg 180deg, ").concat(t," 180deg 270deg, ").concat(n," 270deg)"),backgroundSize:"".concat(2*e,"px ").concat(2*e,"px")}}default:return{backgroundString:"none",backgroundSize:"auto"}}},[m,v,y,a,l,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P,B,L,N]);if(!a)return null;const W="original"===l&&p<1?1/Math.max(.001,p):1,H={position:"absolute",zIndex:s?901:98,pointerEvents:"none",top:"50%",left:"50%",width:"".concat(100*W,"%"),height:"".concat(100*W,"%"),transform:"translate(-50%, -50%) translate(".concat(h,"px, ").concat(f,"px) scale(").concat(p,")"),transformOrigin:"center center",backgroundImage:U,backgroundPosition:(null===V||void 0===V?void 0:V.backgroundPosition)||"center",backgroundRepeat:"stretch"===l?"no-repeat":"repeat",backgroundSize:V,opacity:d,mixBlendMode:u,filter:"brightness(".concat(g,")")};return(0,c.jsx)("div",{style:H})}),yL=vL,xL=(t,n)=>{const[r,o]=(0,e.useState)({x:0,y:0}),[i,a]=(0,e.useState)("unknown"),s=(0,e.useRef)({x:0,y:0});(0,e.useEffect)(()=>{if(t||!n)return void o({x:0,y:0});let e;const r=t=>{cancelAnimationFrame(e),e=requestAnimationFrame(()=>{const e=(t.clientX-window.innerWidth/2)/(window.innerWidth/2),n=(t.clientY-window.innerHeight/2)/(window.innerHeight/2);o({x:30*e,y:30*n})})},l=t=>{const n=t.accelerationIncludingGravity;if(!n)return;const r=/android/i.test(navigator.userAgent),i=r?7:6.5;let a=n.x||0,l=(n.y||0)-i;r||(a=-a);const c=wB(6*a,-40,40),d=wB(3.5*l,-40,40);s.current.x=SB(s.current.x,c,.1),s.current.y=SB(s.current.y,d,.1),cancelAnimationFrame(e),e=requestAnimationFrame(()=>{o({x:Math.round(100*s.current.x)/100,y:Math.round(100*s.current.y)/100})})};return window.addEventListener("mousemove",r),"granted"===i?window.addEventListener("devicemotion",l):"unknown"===i&&"undefined"!==typeof DeviceMotionEvent&&"function"!==typeof DeviceMotionEvent.requestPermission&&a("granted"),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("devicemotion",l),cancelAnimationFrame(e)}},[t,n,i]);return{parallaxOffset:r,gyroPermission:i,requestGyroPermission:async()=>{if("undefined"!==typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission)try{"granted"===await DeviceMotionEvent.requestPermission()?a("granted"):(alert("\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d."),a("denied"))}catch(e){a("granted")}else a("granted")}}},bL={},wL=(e,t)=>{const n=Math.round(10*t);if(!bL[n]){const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[[0,8,2,10],[12,4,14,6],[3,11,1,9],[15,7,13,5]],n=document.createElement("canvas");n.width=4,n.height=4;const r=n.getContext("2d");r.clearRect(0,0,4,4);const o=r.getImageData(0,0,4,4),i=o.data;for(let a=0;a<4;a++)for(let n=0;n<4;n++){const r=4*(4*a+n),o=t[a][n]/16,s=Math.min(255,Math.floor(255*o*e));i[r]=0,i[r+1]=0,i[r+2]=0,i[r+3]=s}return r.putImageData(o,0,0),n}(n/10);bL[n]=e.createPattern(t,"repeat")}return bL[n]},SL=e=>{const t=1e4*Math.sin(e++);return t-Math.floor(t)},kL={},CL=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.startsWith("rgb"))return 1===t?e:e.replace(")",", ".concat(t,")")).replace("rgb","rgba");let n=kL[e];if(!n){const t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);n="".concat(t,", ").concat(r,", ").concat(o);const i=Object.keys(kL);i.length>500&&delete kL[i[0]],kL[e]=n}return"rgba(".concat(n,", ").concat(t,")")};let jL=null;const _L=()=>{if(jL)return jL;const e=document.createElement("canvas");e.width=64,e.height=64;const t=e.getContext("2d"),n=32,r=t.createRadialGradient(n,n,0,n,n,n);return r.addColorStop(0,"rgba(255, 255, 255, 1)"),r.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=r,t.beginPath(),t.arc(n,n,n,0,2*Math.PI),t.fill(),jL=e,e},EL=function(e,t,n){var r,o,i,a;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const c=null!==(r=t.spotLength)&&void 0!==r?r:400,d=null!==(o=t.spotWidth)&&void 0!==o?o:1.5,u=null!==(i=t.spotShift)&&void 0!==i?i:0,p=(t.w||2*t.radius)/2,h=(t.h||2*t.radius)/2,f=p*d,g=h*d,m=c+s,v=u+l;e.fillStyle=n,e.beginPath(),e.ellipse(0,0,p,h,0,Math.PI/2,-Math.PI/2),e.lineTo(m,v-g),e.ellipse(m,v,f,g,0,-Math.PI/2,Math.PI/2),e.lineTo(0,h),e.closePath();const y=null!==(a=t.haloSoftness)&&void 0!==a?a:.5;if(y>0){const n=t.haloColor||t.color||"#ffffff";e.shadowColor=CL(n,1),e.shadowBlur=50*y}e.fill(),e.shadowBlur=0},DL=function(e,t,n,r,o,i,a,s,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,u=arguments.length>11&&void 0!==arguments[11]&&arguments[11],p=arguments.length>12&&void 0!==arguments[12]?arguments[12]:{},h=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0;const f=(t.w||2*t.radius)/2,g=(t.h||2*t.radius)/2,m=t.x+f,v=t.y+g,y=1.5*Math.max(f,g);if(m+y<0||m-y>r||v+y<0||v-y>o)return;const x=Math.floor(r*d),b=Math.floor(o*d),w=i||document.createElement("canvas");w.width===x&&w.height===b||(w.width=x,w.height=b);const S=w.getContext("2d",{alpha:!0});S.imageSmoothingEnabled=!u;const k=s||document.createElement("canvas");k.width===x&&k.height===b||(k.width=x,k.height=b);const C=k.getContext("2d",{alpha:!0});C.imageSmoothingEnabled=!u,S.setTransform(d,0,0,d,0,0),S.clearRect(0,0,r,o),C.setTransform(d,0,0,d,0,0);const j=(e,t,n,r,o,i)=>{const a=e.createRadialGradient(0,0,0,0,0,t);CL(n,1);if(i&&i>1){for(let e=0;e<i;e++){const t=e/i,o=(e+1)/i,s=r*(1-e/(i-1)),l=Math.max(0,s);a.addColorStop(t,CL(n,l)),o<1&&a.addColorStop(o-.001,CL(n,l))}a.addColorStop(1,CL(n,0))}else a.addColorStop(0,CL(n,r)),a.addColorStop(Math.max(0,1-o),CL(n,.5*r)),a.addColorStop(1,CL(n,0));return a},_=u&&p.banding||0;S.save(),S.translate(m,v);const E=(t.rotate||0)*Math.PI/180;if(S.rotate(E),"spot"===t.type){var D,M,T,I;const e=((e,t,n)=>{var r,o;const i=null!==(r=t.spotLength)&&void 0!==r?r:400,a=null!==(o=t.spotFade)&&void 0!==o?o:1,s=t.haloColor||t.color||"#ffffff",l=e.createLinearGradient(0,0,i,0),c=e=>Math.pow(Math.max(0,1-e),a);if(n>0){const e=n;for(let t=0;t<e;t++){const n=t/e,r=(t+1)/e,o=c(n),i=CL(s,o);l.addColorStop(n,i),r<1&&l.addColorStop(r-.001,i)}l.addColorStop(1,CL(s,0))}else l.addColorStop(0,CL(s,1)),l.addColorStop(.33,CL(s,c(.33))),l.addColorStop(.66,CL(s,c(.66))),l.addColorStop(1,CL(s,0));return l})(S,t,_),n=t.spotBlur||0,r=null!==(D=t.spotPenumbra)&&void 0!==D?D:0,o=null!==(M=t.spotSamples)&&void 0!==M?M:8;S.save(),n>0&&(S.filter="blur(".concat(n,"px)"));const i=null!==(T=t.haloOpacity)&&void 0!==T?T:1;if(r>0){const n=i/o*1.8,a=r*(t.spotLength||400)*.3,s=2.39996;S.globalAlpha=Math.min(1,n);for(let r=0;r<o;r++){let n=0,i=0;if(r>0){const e=Math.sqrt(r/o)*a,t=r*s;n=Math.cos(t)*e,i=Math.sin(t)*e}EL(S,t,e,n,i)}}else S.globalAlpha=i,EL(S,t,e,0,0);S.restore();const a=null!==(I=t.coreOpacity)&&void 0!==I?I:1;if(a>.01){var A,O,R;S.save();const e=null!==(A=t.coreLength)&&void 0!==A?A:100,n=null!==(O=t.coreWidth)&&void 0!==O?O:15,r=null!==(R=t.coreBlur)&&void 0!==R?R:0,o=(t.coreRotate||0)*Math.PI/180,i=t.coreVOffset||0,s=t.coreColor||t.color||"#ffffff",l=void 0!==t.coreBanding?t.coreBanding:_;S.rotate(o),S.translate(0,i);const c=e/Math.max(1,n);S.scale(c,1);const d=j(S,n,s,a,.8,l);S.fillStyle=d,r>0&&(S.shadowColor=CL(s,1),S.shadowBlur=r),S.beginPath(),S.arc(0,0,n,0,2*Math.PI),S.fill(),S.restore()}}else{var z,F,P,B,L;S.scale(1,g/f);const e=null!==(z=t.haloOpacity)&&void 0!==z?z:null!==(F=t.opacity)&&void 0!==F?F:1,n=null!==(P=t.haloSoftness)&&void 0!==P?P:.5;e>.01&&(S.fillStyle=j(S,f,t.haloColor||"#ffffff",e,n,_),S.beginPath(),S.arc(0,0,f,0,2*Math.PI),S.fill());const r=t.coreColor||t.color||"#ffffff",o=null!==(B=t.coreOpacity)&&void 0!==B?B:1,i=Math.min(null!==(L=t.coreRadius)&&void 0!==L?L:.3*f,f);if(o>.01&&i>.5){const e=void 0!==t.coreBanding?t.coreBanding:_;S.fillStyle=j(S,i,r,o,.1,e),S.beginPath(),S.arc(0,0,i,0,2*Math.PI),S.fill()}}if(S.restore(),u&&p.dither>0){S.save(),S.globalCompositeOperation="destination-out";const e=wL(S,p.dither);e&&(S.fillStyle=e,S.setTransform(1,0,0,1,0,0),S.fillRect(0,0,x,b)),S.restore(),S.setTransform(d,0,0,d,0,0)}const N=n.filter(e=>!1!==e.castShadow&&(!e.id||!String(e.id).startsWith("cursor_blocker")));N.forEach(e=>{const t=IL(e),n=e.shadowPenumbra||0,i=e.shadowSamples||8,a=n>0?i:1,s=40*n;C.clearRect(0,0,r,o),C.globalCompositeOperation="source-over";const l=(void 0!==e.shadowDensity?e.shadowDensity:1)/a*(a>1?1.8:1);C.fillStyle="#000000";for(let r=0;r<a;r++){var d;C.globalAlpha=Math.min(1,l);let o=m,i=v;if(r>0&&n>0){const e=Math.sqrt(r/a)*s,t=2.39996*r;o+=Math.cos(t)*e,i+=Math.sin(t)*e}const c=TL({x:o,y:i},t,e,null!==(d=e.shadowLength)&&void 0!==d?d:2e3);c.length>=3&&(ML(C,c),C.fill())}const u=Math.min(1,l),p=1-Math.pow(1-u,a);if(e.hideBody){C.save(),ML(C,t),C.clip();const n=2*Math.max(e.w,e.h),r=e.x+e.w/2,o=e.y+e.h/2;C.clearRect(r-n,o-n,2*n,2*n),C.globalCompositeOperation="source-over",C.globalAlpha=p,C.fillStyle="#000000",C.fillRect(r-n,o-n,2*n,2*n),C.restore(),p>0&&(C.globalCompositeOperation="source-over",C.globalAlpha=.15*p,C.lineWidth=1.5,C.strokeStyle="#000000",C.lineJoin="round",ML(C,t),C.stroke()),C.lineWidth=0}else C.globalCompositeOperation="destination-out",C.globalAlpha=1,ML(C,t),C.fill();e.hideBody||(C.globalCompositeOperation="source-over",C.globalAlpha=void 0!==e.density?e.density:1,e.roughness>0?function(e,t,n,r,o,i,a,s){let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;if(!t.length)return;let c=0;if(s)for(let f=0;f<s.length;f++)c+=s.charCodeAt(f);const d=[],u=void 0!==a?a:.5,p=4/Math.max(.1,l);for(let f=0;f<t.length;f++){const e=t[f],i=t[(f+1)%t.length];d.push({x:e.x,y:e.y,isCorner:!0});const a=i.x-e.x,s=i.y-e.y,l=Math.sqrt(a*a+s*s),h=-s/l,g=a/l,m=(e.x+i.x)/2,v=(e.y+i.y)/2;if(0===o||!(h*(n-m)+g*(r-v)<0))continue;const y=Math.floor(l/p);for(let t=1;t<y;t++){const n=t/y;let r=e.x+a*n,i=e.y+s*n;const l=2*(SL(c++)-(1-u))*o*Math.sin(n*Math.PI);r+=h*l,i+=g*l,d.push({x:r,y:i,isCorner:!1})}}let h=d;if(i>0&&h.length>2){const e=Math.ceil(10*i);for(let t=0;t<e;t++){const e=[],t=h.length;for(let n=0;n<t;n++){const r=h[(n-1+t)%t],o=h[n],a=h[(n+1)%t];o.isCorner&&i<.8?e.push(o):e.push({x:.25*r.x+.5*o.x+.25*a.x,y:.25*r.y+.5*o.y+.25*a.y,isCorner:o.isCorner})}h=e}}if(h.length>0){e.beginPath(),e.moveTo(h[0].x,h[0].y);for(let t=1;t<h.length;t++)e.lineTo(h[t].x,h[t].y);e.closePath()}}(C,t,m,v,e.roughness||0,e.roughnessRoundness||0,e.roughnessBias,e.id,c):ML(C,t),C.fill()),S.save(),S.globalCompositeOperation="destination-out",S.globalAlpha=1;let h=e.shadowBlur||0;e.hideBody&&h<2&&(h=2),h>0?(S.shadowColor="#000000",S.shadowBlur=h,S.shadowOffsetX=r,S.drawImage(k,-r,0,r,o)):S.drawImage(k,0,0,r,o),S.restore()}),N.forEach(e=>{if(e.holeCount&&e.holeCount>0){const n=void 0!==e.godRayBlur?e.godRayBlur:e.shadowBlur,r=function(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=Math.round(t),l=Math.round(n),c=e.godRayAnimType||"none",d=e.godRayAnimSpeed||1,u="none"!==c,p=u?"dynamic_".concat(e.id):"".concat(e.id,"_").concat(s,"_").concat(l,"_").concat(r,"_").concat(e.holeCount,"_").concat(e.holeBias,"_").concat(e.holeOpacity,"_").concat(i);if(!u&&o&&o[p])return o[p];let h=o&&o[p]?o[p]:document.createElement("canvas");h.width===s&&h.height===l||(h.width=s,h.height=l);const f=h.getContext("2d");f.globalCompositeOperation="source-over",f.clearRect(0,0,s,l);const g=Math.floor(5*(e.holeCount||0)*i),m=void 0!==e.holeBias?e.holeBias:.5;let v=0;if(e.id)for(let k=0;k<e.id.length;k++)v+=e.id.charCodeAt(k);const y=Math.max(0,r||0);f.filter=y>.5?"blur(".concat(y,"px)"):"none";const x=s,b=l,w=a*d,S=_L();for(let k=0;k<g;k++){let e=v+1337*k,t=SL(e++)*x,n=SL(e++)*b,r=1,o=1;if(u){const e=.5*k+.01*t;"shimmer"===c?r=.6+.4*Math.sin(2*w+e):"leaves"===c?(t+=Math.sin(w+.05*n)*(.02*x),n+=Math.cos(.7*w+.05*t)*(.01*b),r=.5+.5*Math.sin(1.5*w+2*e)):"turbulence"===c&&(t+=Math.sin(.5*w+e)*(.05*x),n+=Math.cos(.3*w+1.5*e)*(.05*b),o=.8+.4*Math.sin(3*w+e))}t<-50&&(t+=x+50),t>x+50&&(t-=x+50),n<-50&&(n+=b+50),n>b+50&&(n-=b+50);const i=t/x-.5,a=n/b-.5,s=2*Math.sqrt(i*i+a*a),l=m>.5?1-s+(m-.5):s+(.5-m);if(SL(e++)>l)continue;const d=(15*SL(e++)+5)*(x/200)*o;f.globalAlpha=r,f.drawImage(S,t-d,n-d,2*d,2*d)}return f.filter="none",f.globalAlpha=1,f.globalCompositeOperation="destination-in",f.fillStyle="#000000",f.beginPath(),"circle"===e.type?f.ellipse(x/2,b/2,x/2,b/2,0,0,2*Math.PI):f.rect(0,0,x,b),f.fill(),f.globalCompositeOperation="source-over",o&&(o[p]=h),h}(e,e.w*d,e.h*d,n,a,c,h),o=t.haloColor||t.color||"#ffffff";!function(e,t,n,r,o,i,a,s){let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;const d=Math.max(10,Math.floor(120*l)),u=void 0!==r.holeOpacity?r.holeOpacity:1,p=void 0!==r.godRayLength?r.godRayLength:.97,h=.45*u/(d/30),f=s.getContext("2d");f.globalCompositeOperation="source-over",f.clearRect(0,0,s.width,s.height),f.drawImage(o,0,0,s.width,s.height),f.globalCompositeOperation="source-in",f.fillStyle=i||"#ffffff",f.fillRect(0,0,s.width,s.height),e.save(),e.globalCompositeOperation=a||"lighter";let g=1,m=h;const v=r.x,y=r.y,x=r.w/2,b=r.h/2,w=(r.rotate||0)*Math.PI/180;for(let S=0;S<d&&!(m<.005);S++)e.globalAlpha=m,e.setTransform(c,0,0,c,0,0),e.translate(t,n),e.scale(g,g),e.translate(-t,-n),e.translate(v,y),e.translate(x,b),e.rotate(w),e.translate(-x,-b),e.drawImage(s,0,0,s.width,s.height,0,0,r.w,r.h),g*=1.01,m*=p;e.restore()}(S,m,v,e,r,o,e.godRayBlendMode,l,c,d)}});const U=n.filter(e=>e.id&&String(e.id).startsWith("cursor_blocker"));if(U.length>0){C.save(),C.setTransform(d,0,0,d,0,0),C.clearRect(0,0,r,o),C.fillStyle="#000000",C.globalCompositeOperation="source-over",U.forEach(e=>{var t;const n=1-.95*(e.shadowSqueeze||0),r=e.w*n,o=e.h*n,i=e.x+(e.w-r)/2,a=e.y+(e.h-o)/2,s=IL(e),l=TL({x:m,y:v},s,e,null!==(t=e.shadowLength)&&void 0!==t?t:2e3);if(l.length>=3&&(C.globalAlpha=void 0!==e.shadowDensity?e.shadowDensity:1,ML(C,l),C.fill()),!e.hideBody){if(C.globalAlpha=void 0!==e.density?e.density:1,C.beginPath(),"circle"===e.type){const e=r/2,t=o/2;C.ellipse(i+e,a+t,e,t,0,0,2*Math.PI)}else C.rect(i,a,r,o);C.fill()}}),C.restore(),S.save(),S.globalCompositeOperation="destination-out";const e=U[0].shadowBlur||0;e>0?(S.shadowColor="#000000",S.shadowBlur=e,S.shadowOffsetX=r,S.drawImage(k,-r,0,r,o)):S.drawImage(k,0,0,r,o),S.restore()}e.drawImage(w,0,0,r,o)},ML=(e,t)=>{if(t.length){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);e.closePath()}},TL=(e,t,n,r)=>{const o=Math.max(0,Math.min(1,n.shadowSqueeze||0)),i=n.x+n.w/2,a=n.y+n.h/2,s=[];t.forEach(t=>{const n=Math.atan2(t.y-e.y,t.x-e.x),l=t.x+Math.cos(n)*r,c=t.y+Math.sin(n)*r;s.push({x:l,y:c}),o>0?s.push({x:t.x+(i-t.x)*o,y:t.y+(a-t.y)*o}):s.push(t)}),s.sort((e,t)=>e.x===t.x?e.y-t.y:e.x-t.x);const l=(e,t,n)=>(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),c=[];for(let u of s){for(;c.length>=2&&l(c[c.length-2],c[c.length-1],u)<=0;)c.pop();c.push(u)}const d=[];for(let u=s.length-1;u>=0;u--){const e=s[u];for(;d.length>=2&&l(d[d.length-2],d[d.length-1],e)<=0;)d.pop();d.push(e)}return d.pop(),c.pop(),[...c,...d]},IL=e=>{var t,n;const r=e.type||"rect",o=null!==(t=e.w)&&void 0!==t?t:100,i=null!==(n=e.h)&&void 0!==n?n:100,a=e.x+o/2,s=e.y+i/2,l=(e.rotate||0)*Math.PI/180,c=Math.cos(l),d=Math.sin(l),u=[],p=(e,t)=>{u.push({x:a+(e*c-t*d),y:s+(e*d+t*c)})};if("circle"===r){const e=32,t=o/2,n=i/2;for(let r=0;r<e;r++){const o=r/e*Math.PI*2;p(Math.cos(o)*t,Math.sin(o)*n)}}else{const e=o/2,t=i/2;p(-e,-t),p(e,-t),p(e,t),p(-e,t)}return u},AL=t=>{let{settings:n,width:r,height:o,isEditor:i,selectedId:a,cameraSettings:l,cameraOffset:d,uniqueZList:u,focusZ:p,resolution:h,animationSettings:f,currentTime:g=0,onUpdateActiveLights:m}=t;const v=(0,e.useRef)(null),y=(0,e.useRef)({x:-1e3,y:-1e3}),x=(0,e.useRef)(null),b=(0,e.useRef)(null),w=(0,e.useRef)(null),S=(0,e.useRef)(null),k=(0,e.useRef)({}),C=(0,e.useRef)({cfg:n,effectiveSources:[],effectiveObstacles:[],animatedAmbientDensity:0,animatedAmbientColor:"#000000",time:0}),j=n||{enabled:!1,ambientColor:"#000000",ambientDensity:0,sources:[],obstacles:[]},{parallaxOffset:_}=xL(!1,j.parallax&&j.parallax.enabled),E=j.pixelMode||!1,D=Math.max(1,j.pixelSize||4),M=E?1/D:void 0!==j.resolutionScale?j.resolutionScale:1,T=Math.max(1,Math.floor(r*M)),I=Math.max(1,Math.floor(o*M)),A=(0,e.useMemo)(()=>{if(i&&"number"===typeof j._previewTime)return j._previewTime;if(!f||!f.enabled)return g;const e=g,t=f.duration||10,n=!1!==f.loop,r=f.reverse||!1;let o=0;if(n)if(r){const n=2*t,r=e%n;o=r>t?n-r:r}else o=e%t;else o=Math.min(e,t);return o},[f,g,j._previewTime,i]),O=(0,e.useMemo)(()=>{var e;if(null===l||void 0===l||null===(e=l.focus)||void 0===e||!e.enabled)return 0;const t=void 0!==j.zIndex?j.zIndex:100;return aL(t,p,l.focus,u||[])},[l,p,u,j.zIndex]),R=(e,t,n,r,o)=>{var i;if(!r||!r.enabled||null===(i=r.elements)||void 0===i||!i[e])return n;const a=r.elements[e];let s=BB(a,t,A);return null!==s&&void 0!==s||(s=n),s},[z,F]=(0,e.useState)(0);(0,e.useEffect)(()=>{if(!i||null===n||void 0===n||!n.enabled)return;const e=(n.sources||[]).some(e=>e.presetLight&&"none"!==e.presetLight.type||e.presetMotion&&"none"!==e.presetMotion.type),t=(n.obstacles||[]).some(e=>e.holeCount>0&&e.godRayAnimType&&"none"!==e.godRayAnimType);if(!e&&!t)return;let r;const o=()=>{F(performance.now()/1e3),r=requestAnimationFrame(o)};return o(),()=>cancelAnimationFrame(r)},[i,n,null===n||void 0===n?void 0:n.sources,null===n||void 0===n?void 0:n.obstacles]),(0,e.useEffect)(()=>{const e=e=>{const t=v.current;if(!t)return;let n,r;e.touches&&e.touches.length>0?(n=e.touches[0].clientX,r=e.touches[0].clientY):(n=e.clientX,r=e.clientY);const o=t.getBoundingClientRect();if(0===o.width||0===o.height)return;const i=t.width/o.width,a=t.height/o.height;y.current.x=(n-o.left)*i,y.current.y=(r-o.top)*a};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}},[]);const P=(0,e.useMemo)(()=>R("sl_ambient","ambientDensity",j.ambientDensity,f),[j.ambientDensity,f,A]),B=(0,e.useMemo)(()=>ZB("sl_ambient","ambientColor",j.ambientColor,f,A),[j.ambientColor,f,A]),{effectiveSources:L,effectiveObstacles:N}=(0,e.useMemo)(()=>{if(!j.enabled)return{effectiveSources:[],effectiveObstacles:[]};const e=h||{width:r,height:o},t=(t,n)=>{let r=((e,t,n)=>{var r;let o={x:e.x||0,y:e.y||0,w:e.w||0,h:e.h||0,rotate:e.rotate||0,opacity:1,scaleX:1,scaleY:1};if(!t||!t.enabled||null===(r=t.elements)||void 0===r||!r[e.id])return o;const i=t.elements[e.id];return["x","y","w","h","rotate"].forEach(e=>{const t=BB(i,e,n);null!==t&&(o[e]=t)}),i._config&&(o=PB(o,i._config,n)),o})(t,f,A),o=s(s({},t),r);const a=i?z:g;let c=0,p=0;if(t.presetMotion&&"none"!==t.presetMotion.type){const{type:e,speed:n=1,strength:r=10}=t.presetMotion,o=((e,t,n,r)=>{const o=t*n;let i=0,a=0;switch(e){case"circular":i=Math.cos(o)*r,a=Math.sin(o)*r;break;case"shake_horizontal":i=Math.sin(20*o)*r;break;case"shake_vertical":a=Math.sin(20*o)*r;break;case"chaotic":i=Math.sin(5*o)*r,a=Math.cos(7*o)*r;break;case"figure_eight":i=Math.cos(o)*r,a=Math.sin(2*o)*(.5*r)}return{x:i,y:a}})(e,a,n,r);c+=o.x,p+=o.y}if("source"===n&&t.parallaxStrength&&0!==t.parallaxStrength&&(c+=_.x*t.parallaxStrength,p+=_.y*t.parallaxStrength),"source"===n&&"spot"===t.type){const e=void 0!==o.spotLength?o.spotLength:400,t=void 0!==o.spotShift?o.spotShift:0;o.spotLength=Math.max(10,e+p),o.spotShift=t-c}else o.x+=c,o.y+=p;if("source"===n){if(o.coreOpacity=R(t.id,"coreOpacity",t.coreOpacity,f),o.haloOpacity=R(t.id,"haloOpacity",t.haloOpacity,f),o.coreRadius=R(t.id,"coreRadius",t.coreRadius,f),o.spotLength=R(t.id,"spotLength",t.spotLength,f),o.spotWidth=R(t.id,"spotWidth",t.spotWidth,f),o.spotShift=R(t.id,"spotShift",t.spotShift,f),o.spotFade=R(t.id,"spotFade",t.spotFade,f),o.spotBlur=R(t.id,"spotBlur",t.spotBlur,f),o.spotPenumbra=R(t.id,"spotPenumbra",t.spotPenumbra,f),o.spotSamples=R(t.id,"spotSamples",t.spotSamples,f),o.coreLength=R(t.id,"coreLength",t.coreLength,f),o.coreWidth=R(t.id,"coreWidth",t.coreWidth,f),o.coreBlur=R(t.id,"coreBlur",t.coreBlur,f),o.coreVOffset=R(t.id,"coreVOffset",t.coreVOffset,f),o.coreRotate=R(t.id,"coreRotate",t.coreRotate,f),"spot"===t.type&&(o.spotLength=Math.max(10,(o.spotLength||400)+p),o.spotShift=(o.spotShift||0)-c),t.presetLight&&"none"!==t.presetLight.type){const{type:e,speed:n=1}=t.presetLight,r=((e,t,n)=>{const r=t*n;switch(e){case"candle":{const e=.1*Math.sin(2*r)+.05*Math.sin(4.3*r),t=.05*Math.sin(13*r)+.03*Math.sin(29*r)+.02*Math.sin(47*r);let n=0;return Math.sin(.5*r)>.8&&(n=.2*(AB(100*r)-.5)),Math.max(.6,1+e+t+n)}case"broken_lamp":{const e=r%20,t=e=>Math.sin(r*e)>0?1:0;return e<3?1:e<3.2?.1:e<5?1:e<6?Math.sin(80*r)>.2?1:.1:e<9?1:e<10?t(30):e<13?.5+.05*Math.sin(10*r):e<13.2?.1:e<15?0:e<17?Math.sin(15*r)>.8?AB(10*r)>.5?.8:.2:0:1}case"tv":return.8+.15*Math.sin(123.45*Math.floor(.5*r))+.1*Math.sin(5*r);case"thunder":return Math.sin(.7*r)>.95?Math.sin(50*r)>0?1.5:.2:0;case"beacon":{const e=r%3;if(e<.2)return 1-e/.2;if(e>.3&&e<.6){const t=e-.3;return Math.sin(t/.3*Math.PI)}return 0}case"pulse":return 1+.3*Math.sin(2*r);case"strobe":return Math.sin(10*r)>0?1:0;default:return 1}})(e,a,n);if(o.coreOpacity*=r,o.haloOpacity*=r,"spot"===t.type){const e=40*(r-1);o.spotLength+=e}}o.coreColor=ZB(t.id,"coreColor",t.coreColor,f,A),o.haloColor=ZB(t.id,"haloColor",t.haloColor,f,A)}else"obstacle"===n&&(o.density=R(t.id,"density",t.density,f),o.shadowDensity=R(t.id,"shadowDensity",t.shadowDensity,f),o.shadowBlur=R(t.id,"shadowBlur",t.shadowBlur,f),o.shadowLength=R(t.id,"shadowLength",t.shadowLength,f),o.holeCount=R(t.id,"holeCount",t.holeCount,f),o.holeBias=R(t.id,"holeBias",t.holeBias,f),o.godRayLength=R(t.id,"godRayLength",t.godRayLength,f),o.holeOpacity=R(t.id,"holeOpacity",t.holeOpacity,f),o.godRayBlur=R(t.id,"godRayBlur",t.godRayBlur,f));const h=void 0!==t.z?t.z:j.zIndex||100,m=iL({x:o.x,y:o.y,w:o.w,h:o.h,rotate:o.rotate,scaleX:1,scaleY:1},h,d||{x:0,y:0,scale:1,rotate:0},l,e,u||[]);return s(s({},o),{},{x:m.x,y:m.y,w:m.w*m.scaleX,h:m.h*m.scaleY,rotate:m.rotate})};return{effectiveSources:(j.sources||[]).map(e=>t(e,"source")),effectiveObstacles:(j.obstacles||[]).map(e=>t(e,"obstacle"))}},[j,d,l,h,r,o,u,f,A,z,g]);return(0,e.useEffect)(()=>{C.current={cfg:j,effectiveSources:L,effectiveObstacles:N,animatedAmbientDensity:P,animatedAmbientColor:B,time:i?z:g||0}},[j,L,N,P,B,i,z,g]),(0,e.useEffect)(()=>{const e=v.current;if(!e)return;Object.keys(k.current).length>100&&(k.current={}),e.width===T&&e.height===I||(e.width=T,e.height=I);const t=e.getContext("2d");E?(t.imageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1):t.imageSmoothingEnabled=!0;const n=void 0!==j.quality?j.quality:1,i=()=>{const e=C.current,a=e.cfg;if(!a.enabled)return t.clearRect(0,0,T,I),void(x.current=requestAnimationFrame(i));const s=e.effectiveSources,l=e.effectiveObstacles,c=e.animatedAmbientDensity,d=e.time;t.clearRect(0,0,T,I),b.current||(b.current=document.createElement("canvas")),b.current.width===T&&b.current.height===I||(b.current.width=T,b.current.height=I),w.current||(w.current=document.createElement("canvas")),w.current.width===T&&w.current.height===I||(w.current.width=T,w.current.height=I);const u=Math.max(1,Math.floor(.5*T)),p=Math.max(1,Math.floor(.5*I));S.current||(S.current=document.createElement("canvas")),S.current.width===u&&S.current.height===p||(S.current.width=u,S.current.height=p),t.save(),t.scale(M,M),c>0&&(t.fillStyle=CL(e.animatedAmbientColor||"#000000",c),t.fillRect(0,0,r,o)),t.globalCompositeOperation="screen";let h=l;if(a.cursorBlocker&&a.cursorBlocker.enabled){var f;const e=y.current.x/M,t=y.current.y/M,n=a.cursorBlocker.radius||50,r=null!==(f=a.cursorBlocker.softness)&&void 0!==f?f:20,o=void 0!==a.cursorBlocker.density?a.cursorBlocker.density:1,i=void 0!==a.cursorBlocker.bodyOpacity?a.cursorBlocker.bodyOpacity:1,s=!!a.cursorBlocker.hideBody,c=a.cursorBlocker.rayCount||0,d=void 0!==a.cursorBlocker.rayGap?a.cursorBlocker.rayGap:.2,u=void 0!==a.cursorBlocker.squeeze?a.cursorBlocker.squeeze:0;if(0===c){const a={id:"cursor_blocker",type:"circle",x:e-n,y:t-n,w:2*n,h:2*n,rotate:0,castShadow:!0,density:i,shadowDensity:o,hideBody:s,shadowLength:2e3,shadowBlur:r,shadowSqueeze:u};h=[...l,a]}else{const a=Math.max(2,c),p=.85*n,f=2*Math.PI/a,g=p*Math.sin(f/2)*(1-Math.min(.95,Math.max(0,d))),m=[];for(let n=0;n<a;n++){const a=n*f,l=Math.cos(a)*p,c=Math.sin(a)*p;m.push({id:"cursor_blocker_part_".concat(n),type:"circle",x:e+l-g,y:t+c-g,w:2*g,h:2*g,rotate:0,castShadow:!0,density:i,shadowDensity:o,hideBody:s,shadowLength:2e3,shadowBlur:r,shadowSqueeze:u})}h=[...l,...m]}}s.forEach(e=>{t.globalCompositeOperation=e.blendMode||"screen",DL(t,e,h,r,o,b.current,k.current,w.current,S.current,n,M,E,{banding:a.pixelBanding||0,dither:a.pixelDithering||0},d)}),t.restore(),t.globalCompositeOperation="source-over",x.current=requestAnimationFrame(i)};return x.current=requestAnimationFrame(i),()=>{x.current&&cancelAnimationFrame(x.current)}},[T,I,M,E,r,o]),(0,e.useEffect)(()=>{if(m&&C.current){const e=C.current,t=void 0!==e.cfg.particleAmbient?e.cfg.particleAmbient:1,n=void 0!==e.cfg.particleLightThreshold?e.cfg.particleLightThreshold:0,r=e.effectiveSources.map(e=>{var t,n;const r=Math.max(e.w||0,e.h||0,2*(e.radius||0))/2,o=e.coreColor||e.color||"#ffffff",i=parseInt(o.slice(1,3),16),a=parseInt(o.slice(3,5),16),s=parseInt(o.slice(5,7),16);return{x:e.x+(e.w||2*e.radius)/2,y:e.y+(e.h||2*e.radius)/2,radius:r,r:i,g:a,b:s,opacity:null!==(t=e.coreOpacity)&&void 0!==t?t:1,haloOpacity:null!==(n=e.haloOpacity)&&void 0!==n?n:1,influence:void 0!==e.particleInfluence?e.particleInfluence:1,type:e.type,rotate:e.rotate||0,spotLength:e.spotLength,spotWidth:e.spotWidth,spotShift:e.spotShift,spotFade:e.spotFade}});m({ambient:t,threshold:n,sources:r})}},[L,j.particleAmbient,j.particleLightThreshold,m]),(0,c.jsx)("canvas",{ref:v,width:T,height:I,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:void 0!==j.zIndex?j.zIndex:100,mixBlendMode:j.globalBlendMode||"normal",imageRendering:E?"pixelated":"auto",filter:O>.5?"blur(".concat(O.toFixed(1),"px)"):"none",transition:"filter 0.2s linear"}})},OL=e.memo(t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v;let{elements:y,activeFragmentData:x,isGlobal:b,selectedElementId:w,assetsMap:S,isEditor:k=!1,onElementClick:C,onElementRelease:j,parallaxOffset:_={x:0,y:0},isParallaxEnabled:E=!1,computedStyles:D={},menuSettings:M,onMenuButtonClick:T,lightAnimTime:I,resolution:A,isMenuOpen:O,onSetMenuOpen:R,onMenuSave:z,layoutMode:F,weatherSettings:P,colorSettings:B,noiseSettings:L,glitchSettings:N,darknessSettings:U,sceneLightSettings:V,onStartColorAnimation:W,colorAnimTime:H,onStartLightAnimation:G,onMenuLoad:X,onMenuRestart:Y,textureSettings:q,onTextEvent:Z,onBackgroundClick:$,onMenuSettings:K,playerStats:J={},statsSettings:Q={},notificationState:ee=null,onCloseNotification:te,textAnimSettings:ne={},typingSoundUrl:re=null,textSpeedMultiplier:oe=1,sfxVolume:ie=1,animationSettings:ae={},currentTime:se=0,cameraLinearTime:le,runningAnimations:ce,allAnimGroups:de,globalEffectTime:ue,gameAreaBg:pe="transparent",cameraSettings:he,onUpdateLayerOpacity:fe,isRendering:ge=!1}=t;const[me,ve]=(0,e.useState)(null),[ye,xe]=(0,e.useState)(!1),[be,we]=(0,e.useState)(null),Se=void 0!==L?L:b?null:null===x||void 0===x||null===(n=x.effects)||void 0===n?void 0:n.noise,ke=void 0!==N?N:b?null:null===x||void 0===x||null===(r=x.effects)||void 0===r?void 0:r.glitch,Ce=void 0!==U?U:b?null:null===x||void 0===x||null===(o=x.effects)||void 0===o?void 0:o.darkness,je="mobile"===F?"sceneLight_mobile":"sceneLight_desktop",_e=void 0!==V?V:b?null:null===x||void 0===x||null===(i=x.effects)||void 0===i?void 0:i[je],Ee=null===_e||void 0===_e?void 0:_e.animation,De=null===Ee||void 0===Ee||null===(a=Ee.groups)||void 0===a?void 0:a.find(e=>e.id===Ee.activeGroupId),Me=null===De||void 0===De?void 0:De.enabled,[Te,Ie]=(0,e.useState)(0),Ae=(0,e.useRef)(null),Oe=(e,t)=>t&&S&&S[t]?S[t]:e&&S&&S[e]?S[e]:e,Re=e=>{if(e)return e.startsWith("http")?"anonymous":void 0};let ze="\u041d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430: \u0437\u0434\u0435\u0441\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u044e\u0442\u0441\u044f \u043e\u0442\u0441\u0442\u0443\u043f\u044b\n\u0410\u0431\u0437\u0430\u0446\u044b, \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u044b \u0441\u0442\u0440\u043e\u043a \u0438 \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0448\u0440\u0438\u0444\u0442\u0430 \u0432 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435.";ne&&ne.enabled&&(ze="\u041d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 ((+2)) \u0432 \u0432\u0438\u0434\u0435 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 ((-2)) \u0414\u0430\u043d\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0442\u044d\u0433\u0430 \u043e\u0447\u0438\u0441\u0442\u043a\u0438...");const Fe=q||(b?null:null===x||void 0===x||null===(l=x.effects)||void 0===l?void 0:l.textureOverlay),Pe=(0,e.useMemo)(()=>{if(!Fe)return null;const e=s({},Fe);return e.url&&(e.url=Oe(e.url)),e},[Fe,S]),Be=b?ze:(null===x||void 0===x?void 0:x.text)||"",{displayedText:Le,isAnimating:Ne,isWaiting:Ue,triggerSkip:Ve,isFinished:We}=TB(Be,ne,re,oe,ie,Z);let He=Le;if(ge&&ne.enabled&&Be){const e=30*(oe||1),t=Math.floor(se*e);He=Be.slice(0,t)}const[Ge,Xe]=(0,e.useState)(0);(0,e.useEffect)(()=>{if(ge)return void Xe(se);let e,t=performance.now();const n=r=>{const o=(r-t)/1e3;t=r,Ne&&!Ue?(Xe(e=>e+o),e=requestAnimationFrame(n)):Xe(0)};return Ne&&!Ue?(t=performance.now(),e=requestAnimationFrame(n)):Xe(0),()=>cancelAnimationFrame(e)},[Ne,Ue,ge,se]);const Ye=(0,e.useMemo)(()=>{var e,t,n,r,o,i,a,l,c,d,u,p,h,f,g,m,v,y,w,S,k,C,j,_,E;const D=B||(b?null:null===x||void 0===x||null===(e=x.effects)||void 0===e?void 0:e.colorCorrection);if(!D)return null;if(null===(t=D.animation)||void 0===t||!t.enabled||null===(n=D.animation.elements)||void 0===n||!n.main)return D;let M=0;M=void 0!==H&&null!==H?H:void 0!==D._previewTime&&null!==D._previewTime?D._previewTime:se||0;const T=D.animation.duration||10,I=!1!==D.animation.loop,A=D.animation.reverse||!1;let O=0;if(I)if(A){const e=2*T,t=M%e;O=t>T?e-t:t}else O=M%T;else O=Math.min(M,T);const R=D.animation.elements.main,z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=n?"".concat(n,"_").concat(e):e,o=BB(R,r,O);return null!==o?o:t};return s(s({},D),{},{_previewTime:O,brightness:z("brightness",null!==(r=D.brightness)&&void 0!==r?r:1),contrast:z("contrast",null!==(o=D.contrast)&&void 0!==o?o:1),saturate:z("saturate",null!==(i=D.saturate)&&void 0!==i?i:1),temperature:z("temperature",null!==(a=D.temperature)&&void 0!==a?a:0),hueRotate:z("hueRotate",null!==(l=D.hueRotate)&&void 0!==l?l:0),fadeAmount:z("fadeAmount",null!==(c=D.fadeAmount)&&void 0!==c?c:0),grayscale:z("grayscale",null!==(d=D.grayscale)&&void 0!==d?d:0),sepia:z("sepia",null!==(u=D.sepia)&&void 0!==u?u:0),chromatic:D.chromatic?s(s({},D.chromatic),{},{offsetX:z("offsetX",null!==(p=D.chromatic.offsetX)&&void 0!==p?p:0,"chromatic"),offsetY:z("offsetY",null!==(h=D.chromatic.offsetY)&&void 0!==h?h:0,"chromatic")}):D.chromatic,vignette:D.vignette?s(s({},D.vignette),{},{intensity:z("intensity",null!==(f=D.vignette.intensity)&&void 0!==f?f:.5,"vignette"),size:z("size",null!==(g=D.vignette.size)&&void 0!==g?g:.5,"vignette")}):D.vignette,tint:D.tint?s(s({},D.tint),{},{opacity:z("opacity",null!==(m=D.tint.opacity)&&void 0!==m?m:.2,"tint")}):D.tint,texture:D.texture?s(s({},D.texture),{},{brightness:z("brightness",null!==(v=D.texture.brightness)&&void 0!==v?v:1,"texture"),contrast:z("contrast",null!==(y=D.texture.contrast)&&void 0!==y?y:1,"texture"),scale:z("scale",null!==(w=D.texture.scale)&&void 0!==w?w:1,"texture"),offsetX:z("offsetX",null!==(S=D.texture.offsetX)&&void 0!==S?S:0,"texture"),offsetY:z("offsetY",null!==(k=D.texture.offsetY)&&void 0!==k?k:0,"texture"),opacity:z("opacity",null!==(C=D.texture.opacity)&&void 0!==C?C:.5,"texture")}):D.texture,isolation:D.isolation?s(s({},D.isolation),{},{spread:z("spread",null!==(j=D.isolation.spread)&&void 0!==j?j:0,"isolation"),bgDesaturation:z("bgDesaturation",null!==(_=D.isolation.bgDesaturation)&&void 0!==_?_:0,"isolation"),bgDarkening:z("bgDarkening",null!==(E=D.isolation.bgDarkening)&&void 0!==E?E:0,"isolation")}):D.isolation})},[B,x,b,se,H]),qe=void 0!==ue?ue:se,[Ze,$e]=(0,e.useState)(0),Ke=(0,e.useRef)(0),Je=(0,e.useMemo)(()=>{const e=new Map;return y&&y.forEach(t=>e.set(t.id,t)),e},[y]),Qe=(0,e.useMemo)(()=>{if(!y)return[];const e=y.map(e=>{const t=e.z||0;return t>=95?95:t});return[...new Set(e)].sort((e,t)=>e-t)},[y]),et=(0,e.useRef)(new Map);et.current.clear();const tt=e=>{var t,n,r;if(et.current.has(e.id))return et.current.get(e.id);const o=void 0!==e._localX?e._localX:e.x||0,i=void 0!==e._localY?e._localY:e.y||0,a=void 0!==e._localRotate?e._localRotate:e.rotate||0;let l={id:e.id,x:o,y:i,w:e.w||0,h:e.h||0,rotate:a,opacity:void 0!==e.opacity?e.opacity:1,scaleX:void 0!==e.scaleX?e.scaleX:1,scaleY:void 0!==e.scaleY?e.scaleY:1,visible:e.visible,brightness:void 0!==e.brightness?e.brightness:1,contrast:void 0!==e.contrast?e.contrast:1,saturate:void 0!==e.saturate?e.saturate:1,hueRotate:void 0!==e.hueRotate?e.hueRotate:0,blur:void 0!==e.blur?e.blur:0,grayscale:void 0!==e.grayscale?e.grayscale:0,sepia:void 0!==e.sepia?e.sepia:0};const c=(e,t)=>{if(!e)return;const n=e._config||{easing:"linear"},r=n.easing||"linear",o=BB(e,"x",t,r);null!==o&&(l.x=o);const i=BB(e,"y",t,r);null!==i&&(l.y=i);const a=BB(e,"rotate",t,r);null!==a&&(l.rotate=a);const s=BB(e,"opacity",t,r);null!==s&&(l.opacity=s);const c=BB(e,"w",t,r);null!==c&&(l.w=c);const d=BB(e,"h",t,r);null!==d&&(l.h=d);const u=BB(e,"scaleX",t,r),p=BB(e,"scaleY",t,r);null!==u&&(l.scaleX=u),null!==p&&(l.scaleY=p);const h=BB(e,"visible",t,r);null!==h&&void 0!==h&&(l.visible=h);const f=BB(e,"brightness",t,r);null!==f&&(l.brightness=f);const g=BB(e,"contrast",t,r);null!==g&&(l.contrast=g);const m=BB(e,"saturate",t,r);null!==m&&(l.saturate=m);const v=BB(e,"hueRotate",t,r);null!==v&&(l.hueRotate=v);const y=BB(e,"blur",t,r);null!==y&&(l.blur=y);const x=BB(e,"grayscale",t,r);null!==x&&(l.grayscale=x);const b=BB(e,"sepia",t,r);null!==b&&(l.sepia=b),l=PB(l,n,qe)};if(null!==ae&&void 0!==ae&&ae.enabled&&null!==(t=ae.elements)&&void 0!==t&&t[e.id]&&c(ae.elements[e.id],se),null!==De&&void 0!==De&&De.enabled&&null!==(n=De.elements)&&void 0!==n&&n[e.id]&&c(De.elements[e.id],Te),ce&&de&&de.forEach(t=>{let n=null,r=!1;if(ce&&void 0!==ce[t.id]&&t.enabled&&(n=ce[t.id],r=!0),t.enabled&&"text_typing"===t.trigger){const e=t.duration||1;n=Ge%e,r=!0}var o,i;if(r&&null!==n&&(null!==(o=t.elements)&&void 0!==o&&o[e.id]&&c(t.elements[e.id],n),null!==(i=t.layerAnimation)&&void 0!==i&&i.enabled)){const r=t.layerAnimation.onlyWhenTyping?Ge:n,o=GB(t.layerAnimation,e.id,r);if(o&&o.handled){const e=void 0!==l.opacity?l.opacity:1;l.opacity=e*o.opacityFactor,o.forceVisible?l.visible=!0:o.opacityFactor<=.001&&(l.visible=!1)}}}),null!==ae&&void 0!==ae&&ae.enabled&&null!==(r=ae.layerAnimation)&&void 0!==r&&r.enabled){let t=void 0!==ue?ue:se||0;ae.layerAnimation.onlyWhenTyping&&(t=Ge);const n=GB(ae.layerAnimation,e.id,t);if(n&&n.handled){const e=void 0!==l.opacity?l.opacity:1;l.opacity=e*n.opacityFactor,n.forceVisible?l.visible=!0:n.opacityFactor<=.001&&(l.visible=!1)}}if(e.parentId){const t=Je.get(e.parentId);if(t){const e=tt(t);l=((e,t)=>{var n,r,o,i,a,l,c,d,u,p,h,f;if(!t)return s(s({},e),{},{scaleX:parseFloat(null!==(n=e.scaleX)&&void 0!==n?n:1),scaleY:parseFloat(null!==(r=e.scaleY)&&void 0!==r?r:1),opacity:parseFloat(null!==(o=e.opacity)&&void 0!==o?o:1),x:parseFloat(null!==(i=e.x)&&void 0!==i?i:0),y:parseFloat(null!==(a=e.y)&&void 0!==a?a:0),rotate:parseFloat(null!==(l=e.rotate)&&void 0!==l?l:0)});const g=parseFloat(t.x||0),m=parseFloat(t.y||0),v=parseFloat(t.w||0),y=parseFloat(t.h||0),x=parseFloat(null!==(c=t.scaleX)&&void 0!==c?c:1),b=parseFloat(null!==(d=t.scaleY)&&void 0!==d?d:1),w=parseFloat(t.rotate||0),S=parseFloat(null!==(u=t.opacity)&&void 0!==u?u:1),k=parseFloat(e.x||0),C=parseFloat(e.y||0),j=parseFloat(e.w||0),_=parseFloat(e.h||0),E=parseFloat(null!==(p=e.scaleX)&&void 0!==p?p:1),D=parseFloat(null!==(h=e.scaleY)&&void 0!==h?h:1),M=parseFloat(e.rotate||0),T=parseFloat(null!==(f=e.opacity)&&void 0!==f?f:1),I=v/2,A=y/2,O=(k+j/2-I)*x,R=(C+_/2-A)*b,z=w*Math.PI/180,F=Math.cos(z),P=Math.sin(z),B=g+I+(O*F-R*P)-j/2,L=m+A+(O*P+R*F)-_/2,N=E*x,U=D*b;return s(s({},e),{},{x:B,y:L,w:j,h:_,rotate:M+w,scaleX:N,scaleY:U,opacity:T*S,visible:!1!==e.visible&&!1!==t.visible})})(l,e),!1===e.visible&&(l.visible=!1)}}return et.current.set(e.id,l),l},nt=(0,e.useMemo)(()=>b?null:P||fL(null===x||void 0===x?void 0:x.effects,F),[b,P,x,F]),rt=ne.enabled&&"click_button"===ne.skip_mode,ot=ne.enabled&&ne.block_choices&&!We&&!rt,[it,at]=(0,e.useState)({}),[st,lt]=(0,e.useState)(new Set),ct=void 0!==le?le:se||0;(0,e.useEffect)(()=>{Ie(ge?se:I||0)},[ge,se,I]),(0,e.useEffect)(()=>{var e,t;if("cursor"===(null===he||void 0===he||null===(e=he.focus)||void 0===e?void 0:e.mode)&&null!==he&&void 0!==he&&null!==(t=he.focus)&&void 0!==t&&t.enabled){if(ge)return void("undefined"!==typeof Ke&&$e(Ke.current));let e;const t=()=>{const n=.5*(he.focus.trackingSpeed||.1);$e(e=>{const t=Ke.current-e;return Math.abs(t)<.5?Ke.current:e+t*n}),e=requestAnimationFrame(t)};return t(),()=>cancelAnimationFrame(e)}},[null===he||void 0===he||null===(d=he.focus)||void 0===d?void 0:d.mode,null===he||void 0===he||null===(u=he.focus)||void 0===u?void 0:u.trackingSpeed,ge]);const dt=(0,e.useMemo)(()=>{var e;if(null===he||void 0===he||null===(e=he.focus)||void 0===e||!e.enabled)return 0;const t=s(s({},he.focus),{},{startDelay:he.startDelay});return function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!t||!t.enabled||!n.length)return 0;const{mode:o,depth:i,preset:a,speed:s=1,loop:l,randomness:c=0,targetZoneZ:d=0,startDelay:u=0}=t;let p=Math.max(0,e-u)*s;const h=n[0],f=n[n.length-1],g=f-h;if("manual"===o)return h+g*((i||0)/100);if("cursor"===o)return r;if("animation"===o){const e=c>0?(.5*Math.sin(5*p)+.5*Math.cos(13*p))*(50*c):0,t=(1-Math.cos(p))/2;if("far_to_near"===a)return h+g*(l?t:Math.min(p,1))+e;if("near_to_far"===a)return f-g*(l?t:Math.min(p,1))+e;if("focusing"===a){const e=.1*g+c*(.5*g);return(d||0)+Math.sin(p)*e}}return 0}(ct,t,Qe,Ze)},[ct,he,Qe,Ze]),ut=(0,e.useMemo)(()=>((e,t,n)=>{const r={x:0,y:0,scale:1,rotate:0};if(!t||!t.enabled)return r;const o=(null===n||void 0===n?void 0:n.width)||1280,i=(null===n||void 0===n?void 0:n.height)||720,{mode:a,preset:l,reverse:c,extraScale:d=0,startDelay:u=0,duration:p=0,loopMode:h="loop",targetX:f=50,targetY:g=50,addShake:m=!1,shakeStrength:v=.5,shakeSpeed:y=.5,animStrength:x=.5,animSpeed:b=.5}=t,w="shake"===a?v:x,S="shake"===a?y:b;if(e<u){if("preset"===a&&l&&l.includes("zoom")){if(c){const e=1+.5*w;let t=0,n=0;if("zoom_point"===l)t=o/2-o*(f/100),n=i/2-i*(g/100);else{const e=o/3;"zoom_left_top"===l?(t=e,n=e):"zoom_right_bottom"===l?(t=-e,n=-e):"zoom_left_bottom"===l?(t=e,n=-e):"zoom_right_top"===l&&(t=-e,n=e)}return s(s({},r),{},{scale:e+d,x:t*(e-1),y:n*(e-1)})}return s(s({},r),{},{scale:1+d})}return s(s({},r),{},{scale:1+d})}let k=e-u;k<0&&(k=0);let C=1;if(p>0&&k>=p){const e=1.5,t=k-p;if(t>=e)return s(s({},r),{},{scale:1});{let n=1-t/e;C=n<0?0:n}}if(C<=0)return s(s({},r),{},{scale:1});const j=c?-1:1;let _=s({},r);const E=200*w,D=k*S,M=(e,t,n,r)=>{const o=30*t,i=20*n;return{x:(Math.sin(e*i)+Math.cos(e*i*1.5))*o*r,y:(Math.cos(e*i*1.2)+Math.sin(e*i*1.8))*o*r,rotate:Math.sin(e*i*.5)*(2*t)*r,scale:.05*t}};if("shake"===a){const e=M(k,v,y,j);_.x=e.x,_.y=e.y,_.rotate=e.rotate,_.scale=1+e.scale}else if("preset"===a){let e=0;if("once"===h){let t=k/(4/(S||.5));t>1&&(t=1),e=t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}else e=Math.sin(D);if(l&&l.includes("zoom")){let t=.5*w,n=0;n="once"===h?e:(1-Math.cos(D))/2,_.scale=c?1+t-t*n:1+t*n;const r=_.scale-1;let a=0,s=0;if("zoom_point"===l)a=o/2-o*(f/100),s=i/2-i*(g/100);else{const e=o/3;"zoom_left_top"===l?(a=e,s=e):"zoom_right_bottom"===l?(a=-e,s=-e):"zoom_left_bottom"===l?(a=e,s=-e):"zoom_right_top"===l&&(a=-e,s=e)}_.x=a*r,_.y=s*r}else{let t=E*e;if(c&&(t*=-1),"slide_left_right"===l)_.x=t;else if("slide_up_down"===l)_.y=t;else if("move_diagonal"===l)_.x=t,_.y=t;else if("move_arc"===l)_.x=t,_.y="once"===h?-Math.abs(E)*Math.sin(e*Math.PI):E*Math.cos(D)*(c?-1:1);else if("rotate_pendulum"===l){const t=15*w;_.rotate="once"===h?t*e*(c?-1:1):t*Math.sin(D)*(c?-1:1)}}if(m){const e=M(k,v,y,j);_.x+=e.x,_.y+=e.y,_.rotate+=e.rotate,_.scale+=e.scale}}return C<1&&(_.x*=C,_.y*=C,_.rotate*=C,_.scale=1+(_.scale-1)*C),_.scale+=d,_})(ct,he,A),[ct,he,A]),pt=(e,t)=>{if(!e.interactionMode||"none"===e.interactionMode)return;if(e.interactionMode!==t)return;const n=e.interactionTarget;n&&(e.interactionOnce&&st.has(e.id)||(at(e=>s(s({},e),{},{[n]:!e[n]})),e.interactionOnce&&lt(t=>new Set(t).add(e.id))))},ht=void 0!==O?O:ye,ft=R||xe,gt=Q.stats_view_mode||"hidden",mt=be&&be.length>0,vt="always"===gt||"interaction"===gt&&mt||b&&"stat_box"===w||"stat_box"===w,yt=()=>{if(!mt)return!b&&"stat_box"!==w||"hidden"===gt?null:(0,c.jsx)("div",{style:{opacity:.5,fontStyle:"italic"},children:"Preview Area"});const e=Q.stats_list_mode||"line",t=Q.stats_list_prefix||"\u25cf",n=e=>e.isError?"#ff6b6b":"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430"===e.value?"#51cf66":"inherit";return"line"===e?(0,c.jsx)("div",{children:be.map((e,t)=>(0,c.jsxs)("span",{style:{color:n(e)},children:[t>0&&", ",e.stat," ",e.value]},t))}):(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:be.map((e,r)=>(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",color:n(e)},children:[(0,c.jsx)("span",{style:{marginRight:5},children:t}),(0,c.jsxs)("span",{children:[e.stat," ",e.value]})]},r))})},xt="global-chromatic-filter",bt=null===Ye||void 0===Ye?void 0:Ye.chromatic,wt=(null===bt||void 0===bt?void 0:bt.enabled)&&(0!==bt.offsetX||0!==bt.offsetY),St={width:"100%",height:"100%",position:"relative",overflow:"hidden",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",cursor:"default",WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none",touchAction:"pinch-zoom",transform:"translate3d(0, 0, 0)",backgroundColor:pe,transition:"background-color 0.5s ease"},kt={position:"absolute",top:0,left:0,width:"100%",height:"100%",filter:"brightness(100%)".concat(wt?" url(#".concat(xt,")"):""),transform:"translateZ(0)",willChange:wt?"filter":"auto",transition:"filter 0.5s ease",zIndex:0},Ct={borderRadius:"".concat(D.textBoxBorderRadius||0,"px"),boxSizing:"border-box",pointerEvents:"auto",position:"relative",backgroundColor:bB(D.textBoxBgColor||"#000000",null!==(p=D.textBoxOpacity)&&void 0!==p?p:.7),border:"".concat(D.textBoxBorderWidth||0,"px solid ").concat(bB(D.textBoxBorderColor||"#ffffff",null!==(h=D.textBoxBorderOpacity)&&void 0!==h?h:1))},jt={position:"relative",zIndex:1,width:"100%",height:"100%",padding:20,boxSizing:"border-box",color:bB(D.textColor||"#ffffff",null!==(f=D.textOpacity)&&void 0!==f?f:1),fontFamily:'"'.concat(D.fontFamily||"Arial",'"'),fontSize:"".concat(D.textSize||16,"px"),textAlign:D.textAlign||"left",transform:"translate(".concat(D.textOffsetX||0,"px, ").concat(D.textOffsetY||0,"px)"),cursor:"default",userSelect:"none",WebkitUserSelect:"none"},_t=e=>{if(e.target.classList.contains("spoiler"))return e.stopPropagation(),void e.target.classList.toggle("is-visible");"A"===e.target.tagName&&(e.stopPropagation(),"_blank"!==e.target.getAttribute("target")&&e.target.setAttribute("target","_blank"))},Et=(0,e.useRef)({x:-1e3,y:-1e3,radius:0,active:!1,color:"#ffffff",intensity:1}),Dt=(0,e.useRef)({ambient:1,sources:[]}),Mt=(void 0!==(null===nt||void 0===nt?void 0:nt.zIndex)&&nt.zIndex,()=>{const e=(Q.p_stats_keys||"").split(",").map(e=>e.trim()).filter(e=>e),t=void 0!==Q.p_stats_gap?Q.p_stats_gap:0;if(0===e.length)return b||"player_stats_box"===w?(0,c.jsx)("div",{style:{fontStyle:"italic",opacity:.7},children:'\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043f\u0443\u0441\u0442. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0432 "\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u0430\u0445".'}):null;const n=e.map(e=>{const t=void 0!==J[e.toLowerCase()]?J[e.toLowerCase()]:0;return{key:e,val:t}});return"line"===(Q.p_stats_list_mode||"column")?(0,c.jsx)("div",{children:n.map((e,n)=>(0,c.jsxs)("span",{children:[0===t&&n>0&&", ",e.key,": ",e.val]},n))}):(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:n.map((e,n)=>(0,c.jsxs)("div",{style:{display:"flex",justifyContent:t>0?"flex-start":"space-between",gap:t>0?"".concat(t,"px"):void 0,alignItems:"center"},children:[(0,c.jsxs)("span",{children:[e.key,":"]}),(0,c.jsx)("span",{children:e.val})]},n))})});return(0,c.jsxs)("div",{ref:Ae,style:St,onDragStart:e=>e.preventDefault(),onContextMenu:e=>e.preventDefault(),onClick:e=>{!ne.enabled||We?$&&$():"function"===typeof Ve&&Ve()},children:[(0,c.jsx)("style",{children:"\n  /* \u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u0441\u0431\u0440\u043e\u0441 \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 */\n  .scene-html-content {\n      line-height: 1.5;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n  }\n  .scene-html-content p { margin: 0 0 0.5em 0; }\n  .scene-html-content p:last-child { margin-bottom: 0; }\n\n  /* \u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 */\n  .scene-html-content strong, .scene-html-content b { font-weight: bold; }\n  .scene-html-content em, .scene-html-content i { font-style: italic; }\n  .scene-html-content u { text-decoration: underline; }\n  .scene-html-content s, .scene-html-content strike, .scene-html-content del { text-decoration: line-through; }\n\n  /* \u0421\u0441\u044b\u043b\u043a\u0438 */\n  .scene-html-content a { color: #4fa3ff; text-decoration: underline; cursor: pointer; }\n  .scene-html-content a:hover { color: #82c0ff; }\n\n  /* \u0418\u043d\u043b\u0430\u0439\u043d \u043a\u043e\u0434 */\n  .scene-html-content code {\n      background: rgba(255, 255, 255, 0.15);\n      padding: 2px 5px;\n      border-radius: 4px;\n      font-family: 'Courier New', monospace;\n      font-size: 0.9em;\n  }\n\n  /* \u0411\u043b\u043e\u043a \u043a\u043e\u0434\u0430 */\n  .scene-html-content pre {\n      background: rgba(0, 0, 0, 0.3);\n      padding: 10px;\n      border-radius: 5px;\n      overflow-x: auto;\n      margin: 5px 0;\n      border: 1px solid rgba(255,255,255,0.1);\n  }\n  .scene-html-content pre code { background: transparent; padding: 0; color: inherit; }\n\n  /* \u0426\u0438\u0442\u0430\u0442\u0430 */\n  .scene-html-content blockquote {\n      border-left: 3px solid rgba(255, 255, 255, 0.5);\n      margin: 10px 0;\n      padding-left: 15px;\n      font-style: italic;\n      color: rgba(255, 255, 255, 0.8);\n  }\n\n  /* \u0421\u041f\u041e\u0419\u041b\u0415\u0420 */\n  .scene-html-content .spoiler {\n      background-color: currentColor;\n      color: currentColor;\n      border-radius: 3px;\n      cursor: pointer;\n      user-select: none;\n      transition: background-color 0.2s, opacity 0.2s;\n      padding: 0 2px;\n  }\n  .scene-html-content .spoiler:hover { opacity: 0.8; }\n  .scene-html-content .spoiler.is-visible {\n      background-color: transparent;\n      color: inherit;\n      cursor: text;\n      user-select: text;\n  }\n"}),(0,c.jsx)(mL,{settings:Ye,width:A.width,height:A.height,chromaticFilterId:xt}),(0,c.jsxs)("div",{style:kt,children:[(0,c.jsx)(tL,{darknessCfg:Ce,resolution:A,containerRef:Ae,sharedLightRef:Et,assetsMap:S}),(0,c.jsx)(yL,{settings:Pe,width:A.width,height:A.height}),(0,c.jsx)(AL,{settings:_e,width:A.width,height:A.height,isEditor:k,onSelect:e=>{C&&C({stopPropagation:()=>{}},e,!1)},selectedId:w,cameraSettings:he,cameraOffset:ut,uniqueZList:Qe,focusZ:dt,resolution:A,animationSettings:De,currentTime:Te,onUpdateActiveLights:e=>{Dt.current=e}}),(0,c.jsx)(nL,{settings:Se,width:A.width,height:A.height}),(0,c.jsx)(rL,{settings:ke,sceneRef:Ae,width:A.width,height:A.height}),(0,c.jsx)(hL,{settings:nt,width:A.width,height:A.height,isRendering:ge,customTime:null!==se&&void 0!==se?se:0,showDebug:k&&!(null!==nt&&void 0!==nt&&nt.hideZoneDebug),lightSource:Et,cameraSettings:he,cameraOffset:ut,currentFocusZ:dt,uniqueZList:Qe,sceneLightsRef:Dt},"weather-".concat(F)),(()=>{var e,t;if(!k||!he||!he.enabled)return null;if("zoom_point"!==he.preset||!he.showTargetDebug)return null;const n=null!==(e=he.targetX)&&void 0!==e?e:50,r=null!==(t=he.targetY)&&void 0!==t?t:50;return(0,c.jsxs)("div",{style:{position:"absolute",left:"".concat(n,"%"),top:"".concat(r,"%"),width:"0",height:"0",zIndex:1e4,pointerEvents:"none"},children:[(0,c.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -50%)",width:"40px",height:"40px",border:"2px solid #00bcd4",borderRadius:"50%",boxShadow:"0 0 5px rgba(0,0,0,0.5)",background:"rgba(0, 188, 212, 0.1)"}}),(0,c.jsx)("div",{style:{position:"absolute",transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:"#00bcd4",borderRadius:"50%"}}),(0,c.jsx)("div",{style:{position:"absolute",top:"-30px",left:"-1px",width:"2px",height:"60px",background:"#00bcd4",opacity:.7}}),(0,c.jsx)("div",{style:{position:"absolute",left:"-30px",top:"-1px",width:"60px",height:"2px",background:"#00bcd4",opacity:.7}})]})})(),y.map(e=>{var t,n,r;let o=e.text;if("button"===e.type&&!b&&null!==x&&void 0!==x&&null!==(t=x.choices)&&void 0!==t&&t[e.index]){const t=x.choices[e.index];o="object"===typeof t?t.text||"":t}if("button"===e.type&&o&&o.includes("{No_btn}"))return null;if(e.isVirtual||"light_virtual"===e.type||"obstacle_virtual"===e.type){if(_e&&_e.hideUI)return null;if(!k)return null;const t=tt(e),n=iL(t,e.z||0,ut,he,A,Qe),r=e.id===w,o={position:"absolute",left:n.x,top:n.y,width:n.w,height:n.h,zIndex:2e3,transform:"rotate(".concat(n.rotate,"deg)"),transformOrigin:"center center",cursor:"move",pointerEvents:"auto",border:r?"light_virtual"===e.type?"2px solid #ffff00":"2px solid #ff4081":"light_virtual"===e.type?"1px dashed rgba(255, 255, 0, 0.5)":"1px dashed rgba(255, 64, 129, 0.5)",borderRadius:"light_virtual"===e.type||"obstacle_virtual"===e.type&&"circle"===e.shape?"50%":"0%",backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center"};return(0,c.jsx)("div",{id:e.id,onMouseDown:t=>C&&C(t,e.id,r),onTouchStart:t=>C&&C(t,e.id,r),style:o,children:r&&(0,c.jsx)("div",{style:{fontSize:"10px",color:"#fff",textShadow:"0 0 2px #000",pointerEvents:"none"},children:"light_virtual"===e.type?"\ud83d\udca1":"\ud83e\uddf1"})},e.id)}const i=Oe(e.src,e.file_id),a=tt(e);let l=e.z||0;if(e.parentId){const t=Je.get(e.parentId);t&&(l=t.z||0)}if("folder"===e.type&&!k)return null;const d=iL(a,e.z,ut,he,A,Qe),u=void 0!==d.visible?d.visible:!1!==e.visible,p=!!it[e.id]?!u:u;if(fe){const t=p?d.opacity:0;fe(e.id,t)}const h=e.id===w,f=me===e.id,g=ce||null!==ae&&void 0!==ae&&ae.enabled?"transform, opacity":"auto",m=[];if(null!==he&&void 0!==he&&null!==(n=he.focus)&&void 0!==n&&n.enabled){const t=he.focus;if(!((e.z||0)>=100)||t.affectWidget){const n=aL(l,dt,t,Qe);if(n>.5&&(m.push("blur(".concat(n.toFixed(1),"px)")),"bg_image"===e.type||"bg_video"===e.type||"image"===e.type)){const e=1+4*n/((null===A||void 0===A?void 0:A.width)||1280);d.scaleX*=e,d.scaleY*=e}}}null!==ke&&void 0!==ke&&ke.enabled&&"global"!==(null===ke||void 0===ke?void 0:ke.scope)&&l<100&&m.push("url(#glitch-rgb-split-filter)"),void 0!==d.brightness&&1!==d.brightness&&m.push("brightness(".concat(d.brightness,")")),void 0!==d.contrast&&1!==d.contrast&&m.push("contrast(".concat(d.contrast,")")),void 0!==d.saturate&&1!==d.saturate&&m.push("saturate(".concat(d.saturate,")")),void 0!==d.hueRotate&&0!==d.hueRotate&&m.push("hue-rotate(".concat(d.hueRotate,"deg)")),void 0!==d.grayscale&&d.grayscale>0&&m.push("grayscale(".concat(d.grayscale,")")),void 0!==d.sepia&&d.sepia>0&&m.push("sepia(".concat(d.sepia,")")),void 0!==d.blur&&d.blur>0&&m.push("blur(".concat(d.blur,"px)"));const v=m.length>0?m.join(" "):void 0,y=t=>{var n,r;if(ve(e.id),"button"===e.type){let t=[];if(e.visibleChecks&&e.visibleChecks.length>0?t=[...t,...e.visibleChecks]:e.isDisabled&&e.lockReason&&t.push({stat:"\u26d4",value:e.lockReason,isError:!0}),e.effects&&e.effects.length>0){const n=e.effects.filter(e=>{if(e.hide)return!1;const t=String(e.value).trim();return!(t.startsWith(">")||t.startsWith("<")||t.startsWith("="))});t=[...t,...n]}t.length>0&&we(t)}pt(e,"hover"),null!==he&&void 0!==he&&null!==(n=he.focus)&&void 0!==n&&n.enabled&&"cursor"===(null===he||void 0===he||null===(r=he.focus)||void 0===r?void 0:r.mode)&&"undefined"!==typeof Ke&&(Ke.current=l)};if("player_stats_box"===e.type){var S;const t=Q.p_stats_view_mode||"always",n="always"===t||"interaction"===t&&mt;let r=n?d.opacity:0,o=n?"auto":"none";k&&(h?(r=d.opacity,o="auto"):n||(r=.5*d.opacity,o="auto"));const i="rotate(".concat(d.rotate,"deg) scale(").concat(d.scaleX,", ").concat(d.scaleY,")");return(0,c.jsx)("div",{id:e.id,onMouseDown:t=>C&&C(t,e.id,h),onTouchStart:t=>C&&C(t,e.id,h),style:{position:"absolute",left:d.x,top:d.y,width:d.w,height:d.h,zIndex:e.z,transform:i,transformOrigin:"center center",willChange:g,backgroundColor:bB(Q.p_stats_bg_color||"#000000",null!==(S=Q.p_stats_bg_opacity)&&void 0!==S?S:.8),border:"".concat(Q.p_stats_border_width||0,"px solid ").concat(Q.p_stats_border_color||"#ffffff"),borderRadius:"".concat(Q.p_stats_border_radius||4,"px"),padding:"10px",boxSizing:"border-box",overflow:"hidden",display:"block",boxShadow:b&&h?"0 0 0 2px #007bff":"none",cursor:b?"move":"default",opacity:r,transition:"opacity 0.2s ease",pointerEvents:o,filter:v},children:(0,c.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"flex-start",justifyContent:"flex-start"},children:(0,c.jsx)("div",{style:{color:Q.p_stats_text_color||"#fff",fontSize:"".concat(Q.p_stats_font_size||14,"px"),fontFamily:'"'.concat(D.fontFamily||"Arial",'"'),width:"100%",wordBreak:"break-word",transform:"translate(".concat(Q.p_stats_text_offset_x||0,"px, ").concat(Q.p_stats_text_offset_y||0,"px)")},children:Mt()})})},e.id)}if("stat_box"===e.type){var M;if("hidden"===gt&&!h)return null;const t=(h?"hidden"===gt?.5:1:vt?1:0)*d.opacity;return(0,c.jsx)("div",{id:e.id,onMouseDown:t=>C&&C(t,e.id,h),onTouchStart:t=>C&&C(t,e.id,h),style:{position:"absolute",left:d.x,top:d.y,width:d.w,height:d.h,zIndex:e.z,transform:"rotate(".concat(d.rotate,"deg) scale(").concat(d.scaleX,", ").concat(d.scaleY,")"),transformOrigin:"center center",backgroundColor:bB(Q.stats_bg_color||"#000000",null!==(M=Q.stats_bg_opacity)&&void 0!==M?M:.8),border:"".concat(Q.stats_border_width||0,"px solid ").concat(Q.stats_border_color||"#ffffff"),borderRadius:"".concat(Q.stats_border_radius||4,"px"),padding:"10px",boxSizing:"border-box",overflow:"hidden",opacity:t,transition:"opacity 0.2s ease",pointerEvents:t>0?"auto":"none",boxShadow:b&&h?"0 0 0 2px #007bff":"none",display:"block",filter:v},children:(0,c.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:(0,c.jsx)("div",{style:{color:Q.stats_text_color||"#fff",fontSize:"".concat(Q.stats_font_size||14,"px"),fontFamily:'"'.concat(D.fontFamily||"Arial",'"'),width:"100%",wordBreak:"break-word",transform:"translate(".concat(Q.stats_text_offset_x||0,"px, ").concat(Q.stats_text_offset_y||0,"px)")},children:yt()})})},e.id)}if(!p)return null;let T=0;E&&!e.disableParallax&&["image","bg_image","video","bg_video"].includes(e.type)&&(T=e.parallaxStrength||0,"bg_image"===e.type&&(T*=.5));const I=-_.x*T,O=-_.y*T,R={width:"100%",height:"100%",objectFit:e.scalingMode||"cover",pointerEvents:"none",transition:"transform 0.1s linear",transform:"translate3d(".concat(I,"px, ").concat(O,"px, 0)")};if("text_area"===e.type){var z,F,P,B,L;const t=ne.enabled?He:Be,n=ne.cursor_char||"_",r=!1!==ne.cursor_blink,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e)return t?'<div class="text-line">'.concat(t,"</div>"):"";if(!e.includes("<p>")&&!e.includes("<div")){const n=e.split("\n");return n.map((e,r)=>{const o=""===e.trim();let i=o?"&nbsp;":e;return r===n.length-1&&(i+=t),'<div class="'.concat(o?"text-line empty-line":"text-line",'">').concat(i,"</div>")}).join("")}return e.replace(/\n/g,"<br>")+t}(t,ne.enabled&&"typewriter"===ne.type&&ne.cursor_enabled?'<span class="cursor">'.concat(n,"</span>"):""),i=D.textSeparatorSide||"none",a=null!==(z=D.textSeparatorPos)&&void 0!==z?z:70,l=s(s({},jt),{},{lineHeight:null!==(F=D.textLineHeight)&&void 0!==F?F:1.5});"none"!==i&&("left"===i?(l.marginLeft="".concat(a,"%"),l.width="".concat(100-a,"%")):"right"===i?(l.width="".concat(a,"%"),l.marginRight="".concat(100-a,"%")):"top"===i?(l.marginTop="".concat(a,"%"),l.height="".concat(100-a,"%")):"bottom"===i&&(l.height="".concat(a,"%"),l.marginBottom="".concat(100-a,"%")));let u=null;if(D.textSeparatorVisualEnabled){var N,U,V;const e=D.textSeparatorLineOrient||"vertical",t=null!==(N=D.textSeparatorLinePos)&&void 0!==N?N:50,n=null!==(U=D.textSeparatorWidth)&&void 0!==U?U:1,r=D.textSeparatorColor||"#ffffff",o=null!==(V=D.textSeparatorOpacity)&&void 0!==V?V:1,i={position:"absolute",backgroundColor:bB(r,o),zIndex:2,pointerEvents:"none"};"vertical"===e?(i.top=0,i.bottom=0,i.width="".concat(n,"px"),i.left="".concat(t,"%")):(i.left=0,i.right=0,i.height="".concat(n,"px"),i.top="".concat(t,"%")),u=(0,c.jsx)("div",{style:i})}const p=null!==(P=D.textParagraphSpacing)&&void 0!==P?P:10,f="\n                    /* \u0423\u0431\u0438\u0440\u0430\u0435\u043c \u043e\u0442\u0441\u0442\u0443\u043f\u044b \u0443 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 p */\n                    #".concat(e.id," .scene-html-content p {\n                        margin: 0 0 ").concat(p,"px 0;\n                    }\n                    \n                    /* \u0421\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u043e\u0431\u044b\u0447\u043d\u044b\u0445 \u0441\u0442\u0440\u043e\u043a */\n                    #").concat(e.id," .scene-html-content .text-line {\n                        display: block;\n                        margin-bottom: ").concat(p,"px;\n                        min-height: 1em; \n                        width: 100%;\n                    }\n\n                    /* === \u041d\u041e\u0412\u041e\u0415: \u0421\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u041f\u0423\u0421\u0422\u042b\u0425 \u0441\u0442\u0440\u043e\u043a === */\n                    #").concat(e.id," .scene-html-content .text-line.empty-line {\n                        /* \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438\u0437 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0438\u043b\u0438 \u0434\u0435\u0444\u043e\u043b\u0442 1.0 */\n                        line-height: ").concat(null!==(B=D.textEmptyLineHeight)&&void 0!==B?B:1,"em;\n                        min-height: ").concat(null!==(L=D.textEmptyLineHeight)&&void 0!==L?L:1,"em;\n                    }\n\n                    /* \u0423\u0431\u0438\u0440\u0430\u0435\u043c \u043e\u0442\u0441\u0442\u0443\u043f \u0443 \u0441\u0430\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 */\n                    #").concat(e.id," .scene-html-content .text-line:last-child {\n                        margin-bottom: 0;\n                    }\n                ");return(0,c.jsxs)("div",{id:e.id,onMouseEnter:y,onMouseDown:t=>C&&C(t,e.id,h),onTouchStart:t=>C&&C(t,e.id,h),style:s(s({position:"absolute",left:d.x,top:d.y,width:d.w,height:d.h,zIndex:e.z,transform:"rotate(".concat(d.rotate,"deg) scale(").concat(d.scaleX,", ").concat(d.scaleY,")"),transformOrigin:"center center",opacity:d.opacity,border:b?h?"2px solid #007bff":"1px dashed rgba(255,255,255,0.3)":"none"},Ct),{},{overflow:e.overflowVisible?"visible":"hidden",filter:v}),children:[(0,c.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative"},children:[(0,c.jsx)("style",{children:f}),(0,c.jsx)(JB,{url:Oe(D.textBoxTexture),opacity:D.textBoxTextureOpacity,blend:D.textBoxTextureBlend,borderRadius:"".concat(D.textBoxBorderRadius||0,"px"),scaleX:D.textBoxTextureScaleX,scaleY:D.textBoxTextureScaleY,offsetX:D.textBoxTextureOffsetX,offsetY:D.textBoxTextureOffsetY}),u,(0,c.jsx)("div",{className:"scene-html-content",style:l,onClick:_t,dangerouslySetInnerHTML:{__html:o}})]}),(0,c.jsx)("style",{children:"\n                            .cursor { display: inline-block; ".concat(r?"animation: blink 1s infinite;":""," }\n                            @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }\n                         ")})]},e.id)}let H="Button",X=!1,Y=null,q={display:"block",boxSizing:"border-box",overflow:e.overflowVisible?"visible":"hidden",cursor:"default",opacity:d.opacity,border:b?h?"2px solid #007bff":"1px dashed rgba(255,255,255,0.3)":"none",filter:v},Z={scaleX:100,scaleY:100,offsetX:50,offsetY:50},$={};const K="button"===e.type&&ot,J=e.isDisabled||K,ee=ne.enabled&&"click_layer"===ne.skip_mode&&ne.trigger_layer_id===e.id;if("button"===e.type){var te,re;if(b)H="Button ".concat(e.index+1);else if(null!==x&&void 0!==x&&null!==(te=x.choices)&&void 0!==te&&te[e.index]){const t=x.choices[e.index];H="object"===typeof t?t.text||"Button":t}e.text&&(H=e.text);const t=null===(re=D.btnObjects)||void 0===re?void 0:re[e.id],n=D.btnMode||"box",r=D.btnGlobalObject;if(X=!!t||"object"===n&&!!r,X){var oe,ie,se,le,de;Y=t||r,Z={scaleX:D.btnObjectScaleX,scaleY:D.btnObjectScaleY,offsetX:D.btnObjectOffsetX,offsetY:D.btnObjectOffsetY};let e="none";if(f&&D.btnObjectHoverEnabled&&!J){const t=D.btnObjectHoverColor||"#ffffff";e="drop-shadow(0 0 5px ".concat(t,")")}J&&(e="grayscale(100%) brightness(0.7)"),q.cursor=J?"default":"pointer",q.opacity=(J?.6:null!==(oe=D.btnObjectOpacity)&&void 0!==oe?oe:1)*d.opacity,$={position:"absolute",left:"".concat(null!==(ie=D.btnObjectOffsetX)&&void 0!==ie?ie:50,"%"),top:"".concat(null!==(se=D.btnObjectOffsetY)&&void 0!==se?se:50,"%"),width:"".concat(null!==(le=D.btnObjectScaleX)&&void 0!==le?le:100,"%"),height:"".concat(null!==(de=D.btnObjectScaleY)&&void 0!==de?de:100,"%"),transform:"translate(-50%, -50%)",mixBlendMode:D.btnObjectBlend||"normal",objectFit:"fill",pointerEvents:"none",zIndex:0,filter:e,transition:"filter 0.2s ease"}}else{var ue,pe;let e=D.btnBgColor||"#444444";f&&D.btnHoverEnabled&&!J&&(e=D.btnHoverColor||e);const t=void 0!==D.btnBgOpacity?D.btnBgOpacity:1;q.backgroundColor=bB(e,t),q.border="".concat(D.btnBorderWidth||0,"px solid ").concat(bB(D.btnBorderColor||"#fff",null!==(ue=D.btnBorderOpacity)&&void 0!==ue?ue:1)),q.borderRadius="".concat(D.btnBorderRadius||0,"px"),q.cursor=J?"default":"pointer";const n=J?.6:null!==(pe=D.btnOpacity)&&void 0!==pe?pe:1;if(q.opacity=n*d.opacity,J){const e="grayscale(100%)";q.filter=v?"".concat(v," ").concat(e):e}}}e.cursorPointer&&"none"!==e.interactionMode&&(q.cursor="pointer"),ee&&(q.cursor="pointer");const ge={position:"relative",zIndex:2,fontFamily:'"'.concat(D.fontFamily||"Arial",'"'),fontSize:"".concat(D.btnTextSize||14,"px"),color:bB(D.btnTextColor||"#fff",null!==(r=D.btnTextOpacity)&&void 0!==r?r:1),pointerEvents:"none",userSelect:"none"};return(0,c.jsx)("div",{id:e.id,onMouseEnter:e=>{y()},onMouseLeave:t=>{if("button"===e.type&&(t.currentTarget.style.cursor=""),ve(null),we(null),"hover"===e.interactionMode&&!e.interactionOnce){const t=e.interactionTarget;t&&at(e=>s(s({},e),{},{[t]:!e[t]}))}j&&j(e.id,"leave")},onMouseMove:t=>{if("button"===e.type&&X&&!e.isDisabled){const e=Oe(Y),n=KB(t,e,Z)?"default":"pointer";t.currentTarget.style.cursor!==n&&(t.currentTarget.style.cursor=n)}},onMouseDown:t=>{if("button"===e.type){const e=Oe(Y);if(X&&KB(t,e,Z))return;t.stopPropagation()}"button"===e.type&&rt&&!We||C&&C(t,e.id,h)},onMouseUp:t=>{j&&j(e.id,"up")},onTouchStart:t=>{"button"===e.type&&t.stopPropagation(),"button"===e.type&&rt&&!We||C&&C(t,e.id,h)},onTouchEnd:t=>{j&&j(e.id,"up")},onClick:t=>{var n;if("button"===e.type&&t.stopPropagation(),"button"!==e.type||!rt||We){if(ee)return t.stopPropagation(),void("function"===typeof Ve&&Ve());if("button"===e.type){if(X){const e=Oe(Y);if(KB(t,e,Z))return}}else pt(e,"click");if(null!==Ye&&void 0!==Ye&&null!==(n=Ye.animation)&&void 0!==n&&n.enabled&&"click"===Ye.animation.trigger&&Ye.animation.triggerLayerId===e.id){const e=!!Ye.animation.restartOnClick;W&&W(e)}if(Me&&"click"===De.trigger&&De.triggerLayerId===e.id){const e=!!De.restartOnClick;G&&G(e)}C&&C(t,e.id,h)}else"function"===typeof Ve&&Ve()},style:s(s(s({position:"absolute",left:d.x,top:d.y,width:d.w,height:d.h,zIndex:e.z,transform:"rotate(".concat(d.rotate,"deg) scale(").concat(d.scaleX,", ").concat(d.scaleY,")"),transformOrigin:"center center"},q),e.style),{},{opacity:q.opacity,pointerEvents:"auto"}),children:(0,c.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:["button"===e.type&&(0,c.jsxs)(c.Fragment,{children:[X&&Y&&(0,c.jsx)("img",{src:Oe(Y),className:"btn-obj-texture",alt:"",crossOrigin:Re(Oe(Y)),style:$,loading:"eager",decoding:"sync"}),!X&&(0,c.jsx)(JB,{url:Oe(D.btnTexture),opacity:D.btnTextureOpacity,blend:D.btnTextureBlend,borderRadius:"".concat(D.btnBorderRadius||0,"px"),scaleX:D.btnTextureScaleX,scaleY:D.btnTextureScaleY,offsetX:D.btnTextureOffsetX,offsetY:D.btnTextureOffsetY}),(!D.btnHideTextMap||!D.btnHideTextMap[e.id])&&(0,c.jsx)("span",{style:ge,children:H})]}),("image"===e.type||"bg_image"===e.type)&&(0,c.jsx)("img",{src:i,alt:"",style:R,draggable:!1,loading:"eager",decoding:"sync",crossOrigin:Re(i),onError:t=>{if(e.local_path){const n=t.target.src;n===(e.local_path.startsWith("http")?e.local_path:window.location.origin+e.local_path)||n.includes(e.local_path)||(t.target.src=e.local_path)}}}),("video"===e.type||"bg_video"===e.type)&&(0,c.jsx)("video",{src:i,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:R,crossOrigin:Re(i),onError:t=>{if(e.local_path){const n=t.target.src;n===(e.local_path.startsWith("http")?e.local_path:window.location.origin+e.local_path)||n.includes(e.local_path)||(t.target.src=e.local_path,t.target.load(),t.target.play().catch(()=>{}))}}})]})},e.id)})]})," ",M&&!1!==M.menu_enabled?(0,c.jsx)(_B,{settings:M,isOpen:ht,setIsOpen:ft,onSaveClick:z||(()=>{}),onLoadClick:X||(()=>{}),onRestartClick:Y||(()=>{}),onSettingsClick:K||(()=>{}),onMenuToggle:e=>{T&&!0===e&&T()},screenW:null===A||void 0===A?void 0:A.width,screenH:null===A||void 0===A?void 0:A.height}):null,!1!==Q.notification_enabled&&ee&&(0,c.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,c.jsx)("div",{onClick:()=>te&&te(),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#000",opacity:null!==(g=Q.notif_backdrop_opacity)&&void 0!==g?g:.5,cursor:"pointer"}}),(0,c.jsxs)("div",{style:{position:"relative",width:Q.notif_width||300,height:Q.notif_height||210,backgroundColor:Q.notif_bg_color||"#ffffff",border:"".concat(Q.notif_border_width||1,"px solid ").concat(Q.notif_border_color||"#ccc"),borderRadius:"".concat(Q.notif_border_radius||10,"px"),padding:"20px 15px",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",animation:"popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},children:[(0,c.jsx)("style",{children:"@keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }"}),(0,c.jsx)("div",{onClick:()=>te&&te(),style:{position:"absolute",top:10,right:10,fontSize:"18px",fontWeight:"bold",color:Q.notif_text_color||"#000",cursor:"pointer",lineHeight:1,opacity:.6},children:"\u2715"}),(0,c.jsx)("div",{style:{marginBottom:20,color:Q.notif_text_color||"#000",fontSize:"".concat(Q.notif_font_size||16,"px"),textAlign:"center",fontFamily:D.fontFamily||"Arial",width:"100%",overflowY:"auto",maxHeight:"60%",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:(e=>{if(!e)return null;return e.split(",").map(e=>e.trim()).filter(Boolean).map((e,t)=>(0,c.jsx)("div",{style:{marginBottom:4},children:e},t))})(ee.text)}),(0,c.jsx)("button",{onClick:()=>te&&te(),style:{padding:"8px 25px",fontSize:"14px",cursor:"pointer",backgroundColor:Q.notif_btn_bg_color||"#f0f0f0",color:Q.notif_btn_text_color||"#333",border:"".concat(null!==(m=Q.notif_btn_border_width)&&void 0!==m?m:1,"px solid ").concat(Q.notif_btn_border_color||"#ccc"),opacity:null!==(v=Q.notif_btn_opacity)&&void 0!==v?v:1,borderRadius:"4px",transition:"filter 0.2s",flexShrink:0},children:"Ok"})]})]})]})}),RL=OL,zL={container:{display:"flex",height:"100vh",overflow:"hidden",background:"#121212",color:"#eee",fontFamily:"sans-serif"},sidebar:(e,t)=>({width:t?e?"75%":"0px":"300px",backgroundColor:"#1e1e1e",borderRight:"1px solid #333",transition:"width 0.3s",position:t?"absolute":"relative",top:t?"50px":"0",height:t?"calc(100% - 50px)":"100%",zIndex:20,flexShrink:0,display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:t&&e?"5px 0 15px rgba(0,0,0,0.5)":"none"}),overlay:{position:"fixed",top:"50px",left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:19,cursor:"pointer"},backBtn:{height:"50px",display:"flex",alignItems:"center",padding:"0 20px",background:"#252525",borderBottom:"1px solid #333",color:"#fff",cursor:"pointer",fontWeight:"bold",fontSize:"14px",flexShrink:0,whiteSpace:"nowrap"},sidebarScroll:{flex:1,overflowY:"auto",padding:"10px 0"},main:{flex:1,position:"relative",display:"flex",flexDirection:"column"},header:{height:"50px",borderBottom:"1px solid #333",display:"flex",alignItems:"center",padding:"0 10px",background:"#252525",zIndex:10},content:{padding:0,overflow:"hidden",flex:1,display:"flex",flexDirection:"column",background:"#000"},spoilerBtn:{width:"100%",textAlign:"left",padding:"10px 15px",background:"#2a2a2a",border:"none",borderBottom:"1px solid #333",color:"#fff",cursor:"pointer",fontWeight:"bold"},subItem:e=>({padding:"8px 15px",cursor:"pointer",background:e?"#3a3a3a":"transparent",color:e?"#7568ed":"#ccc",borderLeft:e?"4px solid #7568ed":"4px solid transparent"}),subActionsPanel:{display:"flex",background:"#222",borderBottom:"1px solid #444",padding:5},subActionBtn:e=>({flex:1,background:e?"#7568ed":"#333",color:"#fff",border:"none",fontSize:"11px",padding:"5px 0",margin:"0 2px",borderRadius:3,cursor:"pointer"}),hamburger:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",marginRight:"10px"},modeSwitch:{display:"flex",background:"#111",borderRadius:5,padding:2,marginRight:15},modeBtn:e=>({padding:"5px 15px",border:"none",background:e?"#7568ed":"transparent",color:e?"#fff":"#aaa",cursor:"pointer",borderRadius:4,fontWeight:"bold"}),layersPanelContainer:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",gap:"15px",height:"100%",padding:"5px"},layersLeftColumn:{width:"300px",flexShrink:0,display:"flex",flexDirection:"column",gap:"15px"},layersListBlock:{flex:"1 1 300px",minWidth:"300px",height:"100%",display:"flex",flexDirection:"column"},addLayerBlock:{width:"100%"},layerSettingsBlock:{width:"100%",background:"#252525",border:"1px solid #444",borderRadius:"8px",padding:"10px",display:"flex",flexDirection:"column",gap:"10px"},roundedLayerItem:(e,t)=>({display:"flex",alignItems:"center",padding:"10px",background:e?"#383838":"#2a2a2a",border:e?"1px solid #7568ed":"1px solid #333",borderRadius:"12px",marginBottom:"8px",cursor:"pointer",opacity:t?.5:1,transition:"all 0.2s ease",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"}),dropPlaceholder:{height:"40px",border:"2px dashed #7568ed",borderRadius:"12px",marginBottom:"8px",background:"rgba(76, 175, 80, 0.1)"},layerHandle:{marginRight:10,color:"#666",cursor:"grab",fontSize:"16px",userSelect:"none"},layerInfo:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"13px"},layerActions:{display:"flex",gap:5},iconBtn:{background:"none",border:"none",color:"#888",cursor:"pointer",fontSize:"14px",padding:2},addPanel:{background:"#222",padding:10,borderRadius:6,marginBottom:10,border:"1px solid #333"},selectInput:{width:"100%",background:"#333",border:"1px solid #444",color:"#fff",padding:"6px",borderRadius:4,marginBottom:8,fontSize:"12px"},visualStackContainer:{flex:1,display:"flex",flexDirection:"column",background:"#181818",border:"1px solid #333",borderRadius:"8px",padding:"10px",marginLeft:"20px",height:"100%",boxShadow:"inset 0 0 20px rgba(0,0,0,0.5)"},stackScrollArea:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBottom:5},resizer:{height:"12px",background:"#1a1a1a",borderTop:"1px solid #333",borderBottom:"1px solid #333",cursor:"row-resize",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,zIndex:15,userSelect:"none",touchAction:"none"},resizerIcon:{width:"40px",height:"4px",borderTop:"2px solid #555",borderBottom:"2px solid #555"},effectCard:(e,t)=>({background:"#252525",borderRadius:6,marginBottom:10,border:e?"1px solid #7568ed":"1px solid #333",overflow:"hidden"}),effectHeader:{padding:"10px",display:"flex",alignItems:"center",cursor:"pointer",background:"#2a2a2a",justifyContent:"space-between"},effectTitle:{fontWeight:"bold",fontSize:"13px",color:"#fff"},effectBody:{padding:"10px",background:"#1e1e1e",borderTop:"1px solid #333"}},FL={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},content:{background:"#1e1e1e",border:"1px solid #444",borderRadius:"8px",width:"100%",maxWidth:"500px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff",boxShadow:"0 10px 40px rgba(0,0,0,0.7)"},header:{padding:"15px",borderBottom:"1px solid #333",display:"flex",justifyContent:"space-between",alignItems:"center"},body:{padding:"15px",overflowY:"auto",flex:1},footer:{padding:"15px",borderTop:"1px solid #333",display:"flex",justifyContent:"flex-end",gap:"10px"},checkbox:{marginRight:"10px",transform:"scale(1.2)",cursor:"pointer"},itemRow:{display:"flex",alignItems:"center",padding:"6px 8px",borderRadius:"4px",cursor:"pointer",transition:"background 0.2s"}},PL=e=>{let{node:t,selectedIds:n,onToggle:r}=e;const o=t.children||t.files||t.layers,i=o&&o.length>0,a=t.id||t._uniqueId,s=n.has(a),l=e=>{e.stopPropagation(),r(t,!s)};return(0,c.jsxs)("div",{style:{marginLeft:"18px",borderLeft:"1px solid #333"},children:[(0,c.jsxs)("div",{style:FL.itemRow,onClick:l,className:"hover-row",children:[(0,c.jsx)("input",{type:"checkbox",checked:s,onChange:l,style:FL.checkbox}),(0,c.jsxs)("span",{style:{opacity:!1===t.visible?.5:1,display:"flex",alignItems:"center",gap:"6px",fontWeight:i?"bold":"normal",fontSize:"14px"},children:[i?"\ud83d\udcc1":"\ud83d\uddbc\ufe0f"," ",t.name,!1===t.visible&&(0,c.jsx)("span",{style:{fontSize:10,color:"#666"},children:"(\u0441\u043a\u0440\u044b\u0442)"})]})]}),i&&o.map((e,t)=>(0,c.jsx)(PL,{node:e,selectedIds:n,onToggle:r},e.id||e._uniqueId||t))]})},BL=t=>{let{isOpen:n,onClose:r,rootNode:o,onConfirm:i,initialSelectedIds:a=null}=t;const[s,l]=(0,e.useState)(new Set);(0,e.useEffect)(()=>{if(n&&o)if(Array.isArray(a))l(new Set(a));else{const e=new Set,t=n=>{const r=n.id||n._uniqueId;!1!==n.visible&&e.add(r);const o=n.children||n.files||n.layers;o&&o.forEach(t)};Array.isArray(o)?o.forEach(t):t(o),l(e)}},[n,o,a]);const d=(e,t)=>{const n=new Set(s),r=e.id||e._uniqueId;t?n.add(r):n.delete(r);const o=(e,t)=>{const r=e.children||e.files||e.layers;r&&r.forEach(e=>{const r=e.id||e._uniqueId;t?n.add(r):n.delete(r),o(e,t)})};o(e,t),l(n)};return n?(0,c.jsxs)("div",{style:FL.overlay,onClick:r,children:[(0,c.jsx)("style",{children:".hover-row:hover { background: rgba(255,255,255,0.05); }"}),(0,c.jsxs)("div",{style:FL.content,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{style:FL.header,children:[(0,c.jsx)("h3",{style:{margin:0},children:"\ud83d\udee0\ufe0f \u0412\u044b\u0431\u043e\u0440 \u0441\u043b\u043e\u0435\u0432 \u0432\u0440\u0443\u0447\u043d\u0443\u044e"}),(0,c.jsx)("button",{onClick:r,style:{background:"none",border:"none",color:"#aaa",cursor:"pointer",fontSize:20},children:"\u2715"})]}),(0,c.jsxs)("div",{style:FL.body,children:[(0,c.jsxs)("div",{style:{marginBottom:15,fontSize:"13px",color:"#aaa",lineHeight:1.4},children:["\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0438 \u0434\u043b\u044f \u0438\u043c\u043f\u043e\u0440\u0442\u0430. ",(0,c.jsx)("br",{}),(0,c.jsxs)("span",{style:{fontSize:11,color:"#777"},children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432: ",s.size]})]}),o&&(Array.isArray(o)?o.map((e,t)=>(0,c.jsx)(PL,{node:e,selectedIds:s,onToggle:d},e.id||e._uniqueId||t)):(0,c.jsx)(PL,{node:o,selectedIds:s,onToggle:d}))]}),(0,c.jsxs)("div",{style:FL.footer,children:[(0,c.jsx)("button",{onClick:r,style:{padding:"8px 16px",background:"transparent",border:"1px solid #555",color:"#ccc",borderRadius:6,cursor:"pointer"},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:()=>{i(Array.from(s))},style:{padding:"8px 16px",background:"#007acc",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:"bold"},children:"\u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})]})]}):null},LL={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(3px)"},modal:{width:"700px",maxHeight:"85%",height:"800px",display:"flex",flexDirection:"column",backgroundColor:"#1e1e1e",borderRadius:"8px",border:"1px solid #333",boxShadow:"0 20px 50px rgba(0,0,0,0.7)",color:"#ccc",fontFamily:"Segoe UI, sans-serif"},header:{padding:"12px 20px",borderBottom:"1px solid #333",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#252526",borderRadius:"8px 8px 0 0",flexShrink:0},title:{fontWeight:600,fontSize:"16px",color:"#fff"},breadcrumbs:{padding:"10px 20px",backgroundColor:"#1e1e1e",borderBottom:"1px solid #2d2d2d",fontSize:"13px",display:"flex",gap:"5px",overflowX:"auto",whiteSpace:"nowrap",flexShrink:0,alignItems:"center"},breadcrumbItem:{cursor:"pointer",color:"#6ab0f3",textDecoration:"none",transition:"color 0.2s"},breadcrumbActive:{color:"#bbb",cursor:"default"},separator:{color:"#555"},content:{flex:1,overflowY:"auto",padding:"15px",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(110px, 1fr))",gap:"15px",alignContent:"start",backgroundColor:"#1e1e1e"},item:{display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",cursor:"pointer",borderRadius:"6px",border:"1px solid transparent",transition:"all 0.15s ease",position:"relative",backgroundColor:"#252526",userSelect:"none",WebkitUserSelect:"none"},itemHover:{backgroundColor:"#2a2d2e",borderColor:"#007acc"},itemSelected:{backgroundColor:"rgba(0, 122, 204, 0.2)",borderColor:"#007acc",boxShadow:"0 0 0 1px #007acc inset"},icon:{fontSize:"40px",marginBottom:"8px",opacity:.9},label:{fontSize:"12px",textAlign:"center",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"#d4d4d4",marginTop:"auto"},preview:{width:"100%",height:"80px",objectFit:"contain",backgroundColor:"#111",borderRadius:"4px",marginBottom:"6px",border:"1px solid #333"},checkboxWrapper:{position:"absolute",top:"5px",left:"5px",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,backgroundColor:"rgba(0,0,0,0.5)",borderRadius:"4px"},checkbox:{transform:"scale(1.2)",cursor:"pointer",pointerEvents:"none"},footer:{padding:"15px 20px",borderTop:"1px solid #333",backgroundColor:"#252526",borderRadius:"0 0 8px 8px",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"10px",flexShrink:0},btnPrimary:{background:"#007acc",color:"#fff",border:"none",padding:"8px 24px",borderRadius:"4px",cursor:"pointer",fontWeight:"500",fontSize:"14px",transition:"background 0.2s"},btnCancel:{background:"transparent",color:"#ccc",border:"1px solid #444",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"}},NL={sys_backgrounds:"Backgrounds",sys_characters:"Characters",sys_textures:"Textures",sys_objects:"Objects",sys_audio:"Audio",sys_fonts:"Fonts"};function UL(t){let{isOpen:n,onClose:r,onSelect:o,assets:i,assetsMap:a,rootId:l=null,title:d="\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b",allowedTypes:u=[],detectCharacterFolders:p=!1,multiSelect:h=!1}=t;const[f,g]=(0,e.useState)([]),[m,v]=(0,e.useState)([]);(0,e.useEffect)(()=>{n&&(g([]),v([]))},[n,l]),(0,e.useEffect)(()=>{v([])},[f]);const y=e=>{if(!e)return null;if(a){if(e.file_id&&a[e.file_id])return a[e.file_id];if(e.local_path&&a[e.local_path])return a[e.local_path];if(e.url&&a[e.url])return a[e.url]}return e.url||e.local_path},x=(0,e.useMemo)(()=>{if(!i)return[];let e=null;if(0===f.length){if(!l)return Object.entries(i).map(e=>{let[t,n]=e;return{id:t,name:NL[t]||n.name||t,type:"folder",files:n.files||[],isSystem:!0,_ui_key:t}});e=i[l]}else{let t=l?i[l]:i[f[0].id];for(let e=l?0:1;e<f.length&&(t&&t.files);e++){const n=t.files.find(t=>t.id===f[e].id);if(!n)break;t=n}e=t}return e&&e.files?e.files.filter(e=>{if("folder"===e.type||"character_folder"===e.type)return!0;if(0===u.length)return!0;const t=(e.name||"").split(".").pop().toLowerCase();return u.includes(t)}).map(e=>s(s({},e),{},{_ui_key:e.id||e.local_path||e.url||e.name})):[]},[i,f,l,u]),b=e=>g(-1===e?[]:f.slice(0,e+1)),w=e=>{v(t=>{const n=t.find(t=>t._ui_key===e._ui_key);return n?t.filter(t=>t._ui_key!==e._ui_key):[...t,e]})},S=(e,t)=>{e&&(e.preventDefault(),e.stopPropagation());if("folder"===t.type||"character_folder"===t.type){if(p&&("character_folder"===t.type||t.structure&&t.presets)){const e=f.length>0?f[f.length-1].id:l||"root";return o(t,e),void r()}return n=t,void g([...f,{id:n.id,name:n.name}])}var n;if(h)w(t);else{const e=f.length>0?f[f.length-1].id:l||"root",n=y(t);o(s(s({},t),{},{url:n||t.url}),e),r()}};return n?(0,c.jsx)("div",{style:LL.overlay,onClick:r,children:(0,c.jsxs)("div",{style:LL.modal,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{style:LL.header,children:[(0,c.jsx)("span",{style:LL.title,children:d}),(0,c.jsx)("button",{onClick:r,style:{background:"none",border:"none",color:"#aaa",cursor:"pointer",fontSize:"20px"},children:"\u2715"})]}),(0,c.jsxs)("div",{style:LL.breadcrumbs,children:[(0,c.jsx)("span",{style:0===f.length?LL.breadcrumbActive:LL.breadcrumbItem,onClick:()=>b(-1),children:l?NL[l]||"Root":"Home"}),f.map((t,n)=>(0,c.jsxs)(e.Fragment,{children:[(0,c.jsx)("span",{style:LL.separator,children:" / "}),(0,c.jsx)("span",{style:n===f.length-1?LL.breadcrumbActive:LL.breadcrumbItem,onClick:()=>b(n),children:t.name})]},n))]}),(0,c.jsxs)("div",{style:LL.content,children:[f.length>0&&(0,c.jsxs)("div",{style:LL.item,onClick:()=>g(f.slice(0,-1)),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#2a2d2e",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#252526",children:[(0,c.jsx)("div",{style:s(s({},LL.icon),{},{fontSize:"30px"}),children:"\u21a9\ufe0f"}),(0,c.jsx)("span",{style:LL.label,children:"\u041d\u0430\u0437\u0430\u0434"})]}),x.map(e=>{const t="folder"===e.type||"character_folder"===e.type,n=m.some(t=>t._ui_key===e._ui_key),r=!t&&(e=>{if(!e)return!1;const t=/\.(jpg|jpeg|png|webp|gif|svg|avif|bmp)$/i;return!!t.test(e.name)||!(!e.local_path||!t.test(e.local_path))||!(!e.extension||!/^(jpg|jpeg|png|webp|gif|svg|avif|bmp)$/i.test(e.extension))})(e);return(0,c.jsxs)("div",{style:s(s({},LL.item),n?LL.itemSelected:{}),onClick:t=>S(t,e),onMouseEnter:e=>!n&&(e.currentTarget.style.backgroundColor="#2a2d2e"),onMouseLeave:e=>!n&&(e.currentTarget.style.backgroundColor="#252526"),children:[h&&!t&&(0,c.jsx)("div",{style:LL.checkboxWrapper,onClick:t=>{t&&t.stopPropagation(),w(e)},children:(0,c.jsx)("input",{type:"checkbox",checked:n,readOnly:!0,style:LL.checkbox})}),t?(0,c.jsx)("div",{style:LL.icon,children:"character_folder"===e.type?"\ud83c\udfad":"\ud83d\udcc1"}):r?(0,c.jsx)("img",{src:y(e),style:LL.preview,alt:e.name,onError:t=>{e.local_path&&!t.target.src.includes(e.local_path)?t.target.src=e.local_path:(t.target.style.display="none",t.target.parentNode.innerHTML='<div style="font-size:30px; margin-bottom:10px">\u26a0\ufe0f</div>')}}):(0,c.jsx)("div",{style:LL.icon,children:"\ud83d\udcc4"}),(0,c.jsx)("span",{style:LL.label,title:e.name,children:e.name})]},e._ui_key)}),0===x.length&&(0,c.jsxs)("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",color:"#666"},children:[(0,c.jsx)("div",{style:{fontSize:"40px",marginBottom:"10px"},children:"\ud83d\udced"}),"\u041f\u0430\u043f\u043a\u0430 \u043f\u0443\u0441\u0442\u0430"]})]}),(0,c.jsx)("div",{style:LL.footer,children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginRight:"auto",fontSize:"13px",color:"#888"},children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043e: ",m.length]}),(0,c.jsx)("button",{onClick:r,style:LL.btnCancel,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsxs)("button",{onClick:e=>{if(e&&e.stopPropagation(),0===m.length)return;const t=f.length>0?f[f.length-1].id:l||"root",n=m.map(e=>s(s({},e),{},{url:y(e)||e.url}));o(n,t),r()},style:s(s({},LL.btnPrimary),{},{opacity:m.length>0?1:.5,cursor:m.length>0?"pointer":"default"}),disabled:0===m.length,children:["\u0412\u044b\u0431\u0440\u0430\u0442\u044c (",m.length,")"]})]}):(0,c.jsx)("button",{onClick:r,style:LL.btnCancel,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]})}):null}const VL=e=>{let{title:t,children:n,isOpen:r,onToggle:o,icon:i="\u2699\ufe0f"}=e;return(0,c.jsxs)("div",{style:{marginBottom:10,border:"1px solid #333",borderRadius:6,overflow:"hidden",background:"#252525"},children:[(0,c.jsxs)("div",{onClick:o,style:{padding:"8px 10px",background:"#2e2e2e",cursor:"pointer",fontSize:"11px",fontWeight:"bold",color:"#ccc",display:"flex",alignItems:"center",justifyContent:"space-between",select:"none"},children:[(0,c.jsxs)("span",{style:{display:"flex",gap:6,alignItems:"center"},children:[i," ",t]}),(0,c.jsx)("span",{children:r?"\u25bc":"\u25b6"})]}),r&&(0,c.jsx)("div",{style:{padding:"10px"},children:n})]})},WL=e=>{let{label:t,value:n,def:r=1,min:o=0,max:i=2,step:a=.05,onChange:s,unit:l=""}=e;return(0,c.jsxs)("div",{style:{marginBottom:8},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:"#888",marginBottom:2},children:[(0,c.jsx)("span",{children:t}),(0,c.jsxs)("span",{children:[Math.round(100*(null!==n&&void 0!==n?n:r))/100,l]})]}),(0,c.jsx)("input",{type:"range",min:o,max:i,step:a,value:null!==n&&void 0!==n?n:r,onChange:e=>s(parseFloat(e.target.value)),style:{width:"100%",height:4,cursor:"pointer",accentColor:"#7568ed"},title:"\u0414\u0432\u043e\u0439\u043d\u043e\u0439 \u043a\u043b\u0438\u043a \u0434\u043b\u044f \u0441\u0431\u0440\u043e\u0441\u0430",onDoubleClick:()=>s(r)})]})},HL=e=>{let{label:t,val:n,param:r,step:o=1,min:i=-9999,layerId:a,onUpdate:s}=e;const l=void 0!==n&&null!==n?Math.round(100*n)/100:0;return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2,flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#888",fontWeight:"bold"},children:t}),(0,c.jsx)("input",{type:"number",step:o,min:i,value:l,onChange:e=>s(a,r,parseFloat(e.target.value)),style:{background:"#222",border:"1px solid #444",color:"#fff",borderRadius:"4px",padding:"4px",fontSize:"11px",width:"100%",textAlign:"center"}})]})},GL=e=>{let{isDragging:t}=e;const{setNodeRef:n,isOver:r}=c_({id:"root-drop-zone"});return t?(0,c.jsx)("div",{ref:n,style:{marginTop:"10px",padding:"15px",border:"2px dashed",borderColor:r?"#4caf50":"#444",backgroundColor:r?"rgba(76, 175, 80, 0.1)":"transparent",borderRadius:"8px",color:r?"#4caf50":"#666",textAlign:"center",fontSize:"12px",fontWeight:"bold",transition:"all 0.2s"},children:"\u2b07 \u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u0435\u043d\u044c"}):null},XL=t=>{let{folder:n,isSelected:r,onSelect:o,onToggleCollapse:i,onUpdateName:a,onToggleVisibility:l,onRemove:d,children:u}=t;const p=P_({id:n.id,data:{type:"folder",id:n.id}}),h=c_({id:"folder-drop-".concat(n.id),data:{type:"folder-drop",targetId:n.id}}),f={transform:hC.Transform.toString(p.transform),transition:p.transition,opacity:p.isDragging?.5:1,marginBottom:"6px",touchAction:"manipulation"},[g,m]=(0,e.useState)(!1),[v,y]=(0,e.useState)(n.name),x=()=>{""!==v.trim()?a(n.id,v):y(n.name),m(!1)},b=h.isOver,w=r?"rgba(0, 110, 255, 0.45)":b?"rgba(76, 175, 80, 0.2)":"#2a2a2a",S=r?"#55aaff":b?"#4caf50":"#444",k=r||b?"2px":"1px";return(0,c.jsx)("div",s(s({ref:p.setNodeRef,style:f},p.attributes),{},{children:(0,c.jsxs)("div",{style:{background:w,border:"".concat(k," solid ").concat(S),borderRadius:"6px",overflow:"hidden",transition:"all 0.15s ease-in-out",boxShadow:r?"0 0 10px ".concat("#00aaff","40"):"none"},children:[(0,c.jsxs)("div",{ref:h.setNodeRef,onClick:o,style:{padding:"10px",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:[(0,c.jsx)("div",s(s({},p.listeners),{},{style:{cursor:"grab",color:"#666",flexShrink:0,padding:"2px 4px"},children:"\u2630"})),(0,c.jsx)("div",{onClick:e=>{e.stopPropagation(),i(n.id)},style:{cursor:"pointer",fontSize:12,width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,background:"rgba(255,255,255,0.05)",flexShrink:0},children:n.collapsed?"\u25b6":"\u25bc"}),(0,c.jsx)("div",{style:{fontSize:18,flexShrink:0},children:n.collapsed?"\ud83d\udcc1":"\ud83d\udcc2"}),g?(0,c.jsx)("input",{value:v,onChange:e=>y(e.target.value),onBlur:x,onKeyDown:e=>"Enter"===e.key&&x(),autoFocus:!0,onClick:e=>e.stopPropagation(),style:{background:"#111",border:"1px solid #7568ed",color:"#fff",fontSize:13,padding:"4px 6px",borderRadius:4,width:"100%"}}):(0,c.jsx)("div",{onDoubleClick:e=>{e.stopPropagation(),m(!0)},style:{fontSize:13,fontWeight:r?"bold":"normal",color:r?"#fff":"#ddd",userSelect:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},title:n.name,children:n.name})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:2,flexShrink:0,marginLeft:5},children:[(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),l(n.id)},style:{background:"none",border:"none",cursor:"pointer",opacity:n.visible?1:.4,padding:4},children:n.visible?"\ud83d\udc41\ufe0f":"\ud83d\ude48"}),(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),d(n.id)},style:{background:"none",border:"none",cursor:"pointer",opacity:.6,padding:4},children:"\u2716"})]})]}),!n.collapsed&&(0,c.jsxs)("div",{style:{padding:"4px 4px 4px 16px",background:r?"rgba(117, 104, 237, 0.03)":"#1e1e1e",minHeight:"20px",borderTop:"1px solid ".concat(r?"rgba(117, 104, 237, 0.2)":"#333")},children:[u,0===e.Children.count(u)&&(0,c.jsx)("div",{style:{fontSize:11,color:"#555",textAlign:"center",padding:10,border:"1px dashed #333",borderRadius:4,margin:4},children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0441\u043b\u043e\u0438 \u0441\u044e\u0434\u0430"})]})]})}))},YL=e=>{var t;let{layer:n,realIndex:r,isSelected:o,selectedIds:i=[],onSelect:a,onUpdateLayerParam:l,onRemoveLayer:d}=e;const{attributes:u,listeners:p,setNodeRef:h,transform:f,transition:g,isDragging:m}=P_({id:n.id}),v={transform:hC.Transform.toString(f),transition:g,opacity:m?.5:1,position:"relative",zIndex:m?999:"auto",marginBottom:"4px",touchAction:"manipulation"},y=!1===n.visible,x=i.includes(n.id),b=o||x;return(0,c.jsx)("div",s(s({ref:h,style:v},u),{},{children:(0,c.jsxs)("div",{style:zL.roundedLayerItem(b,y),onClick:e=>{a(n.id,e.ctrlKey||e.metaKey)},children:[(0,c.jsx)("div",s(s({},p),{},{style:{cursor:"grab",fontSize:"16px",color:"#666",marginRight:10,userSelect:"none",padding:"0 5px",touchAction:"none"},title:"\u041f\u043e\u0442\u044f\u043d\u0438\u0442\u0435 \u0434\u043b\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438 (\u041d\u0430 \u0442\u0430\u0447\u0441\u043a\u0440\u0438\u043d\u0435: \u0443\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439\u0442\u0435)",children:"\u2630"})),(0,c.jsx)("div",{style:{marginRight:10,fontSize:"16px"},children:"video"===n.type?"\ud83c\udfa5":"\ud83d\uddbc\ufe0f"}),(0,c.jsxs)("div",{style:{flex:1,overflow:"hidden"},children:[(0,c.jsx)("div",{style:{fontWeight:"bold",fontSize:"13px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.name}),(0,c.jsxs)("div",{style:{fontSize:"10px",color:"#888"},children:["Z: ",n.z," | Op: ",Math.round(100*(null!==(t=n.opacity)&&void 0!==t?t:1)),"%"]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:5,marginLeft:10},onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("button",{title:y?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c":"\u0421\u043a\u0440\u044b\u0442\u044c",onClick:()=>l(n.id,"visible",!!y),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",opacity:y?.5:1},children:y?"\ud83d\ude48":"\ud83d\udc41\ufe0f"}),(0,c.jsx)("button",{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",style:zL.iconBtn,onClick:()=>d(n.id),children:"\ud83d\uddd1"})]})]})}))},qL=[{value:"cover",label:"\u0417\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 (\u041e\u0431\u0440\u0435\u0437\u0430\u0442\u044c \u043a\u0440\u0430\u044f)"},{value:"contain",label:"\u0412\u043f\u0438\u0441\u0430\u0442\u044c (\u0411\u0435\u0437 \u043e\u0431\u0440\u0435\u0437\u043e\u043a)"},{value:"fill",label:"\u0420\u0430\u0441\u0442\u044f\u043d\u0443\u0442\u044c (\u0418\u0441\u043a\u0430\u0437\u0438\u0442\u044c)"},{value:"none",label:"\u041e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440"}],ZL=[{group:"\u041e\u0431\u044b\u0447\u043d\u044b\u0435",modes:[{value:"normal",label:"Normal (\u041e\u0431\u044b\u0447\u043d\u044b\u0439)"}]},{group:"\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435",modes:[{value:"multiply",label:"Multiply (\u0423\u043c\u043d\u043e\u0436\u0435\u043d\u0438\u0435)"},{value:"darken",label:"Darken (\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435)"},{value:"color-burn",label:"Color Burn (\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u044b)"}]},{group:"\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435",modes:[{value:"screen",label:"Screen (\u042d\u043a\u0440\u0430\u043d)"},{value:"lighten",label:"Lighten (\u0417\u0430\u043c\u0435\u043d\u0430 \u0441\u0432\u0435\u0442\u043b\u044b\u043c)"},{value:"color-dodge",label:"Color Dodge (\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u044b)"}]},{group:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442",modes:[{value:"overlay",label:"Overlay (\u041f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u0435)"},{value:"soft-light",label:"Soft Light (\u041c\u044f\u0433\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"},{value:"hard-light",label:"Hard Light (\u0416\u0435\u0441\u0442\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}]},{group:"\u0418\u043d\u0432\u0435\u0440\u0441\u0438\u044f/\u0420\u0430\u0437\u043d\u0438\u0446\u0430",modes:[{value:"difference",label:"Difference (\u0420\u0430\u0437\u043d\u0438\u0446\u0430)"},{value:"exclusion",label:"Exclusion (\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435)"}]},{group:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u044b\u0435",modes:[{value:"hue",label:"Hue (\u0426\u0432\u0435\u0442\u043e\u0432\u043e\u0439 \u0442\u043e\u043d)"},{value:"saturation",label:"Saturation (\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0441\u0442\u044c)"},{value:"color",label:"Color (\u0426\u0432\u0435\u0442)"},{value:"luminosity",label:"Luminosity (\u042f\u0440\u043a\u043e\u0441\u0442\u044c)"}]}],$L=t=>{var n,r,o,i,a,l;let{layers:d=[],bgImage:u,assets:p,onAddLayer:h,onAddCharacter:f,presets:g,onRemoveLayer:m,onReorderLayers:v,onUpdateLayerParam:y,onReorderLayersSmart:x,onReparentLayer:b,onBgChange:w,bgFiles:S=[],selectedLayerId:k,selectedIds:C=[],onSelectLayer:j,onAddFolder:_,onToggleFolderCollapse:E,onToggleFolderVisibility:D,onSelectFolder:M,assetsMap:T,onReorderLayersWithHierarchy:I,onPasteLayer:A,onOpenCharEditor:O,isSimpleMode:R=!1}=t;const[z,F]=(0,e.useState)(null),[P,B]=(0,e.useState)(!1),[L,N]=(0,e.useState)(""),[U,V]=(0,e.useState)(null),[W,H]=(0,e.useState)(!1),[G,X]=(0,e.useState)({pos:!0,size:!0,rot:!0}),[Y,q]=(0,e.useState)(!1),[Z,$]=(0,e.useState)(null),[K,J]=(0,e.useState)("Default"),Q=d.find(e=>e.id===k),ee="folder"===(null===Q||void 0===Q?void 0:Q.type),[te,ne]=(0,e.useState)(!0),[re,oe]=(0,e.useState)(null),ie=MC(DC(Cj,{activationConstraint:{distance:5}}),DC(_j,{activationConstraint:{delay:100,tolerance:5}})),[ae,se]=(0,e.useState)("layers"),[le,ce]=(0,e.useState)(!1),[de,ue]=(0,e.useState)(null),[pe,he]=(0,e.useState)(null),[fe,ge]=(0,e.useState)(!0),[me,ve]=(0,e.useState)(!0),ye=e=>{he(t=>t===e?null:e)},[xe,be]=(0,e.useState)(!1),[we,Se]=(0,e.useState)("layer"),[ke,Ce]=(0,e.useState)(null),je=(0,e.useMemo)(()=>R?d:"characters"===ae?d.filter(e=>"sys_characters"===e.folderId):d.filter(e=>"sys_characters"!==e.folderId),[d,ae,R]),_e=(e,t,n)=>{const r=d.find(t=>t.id===e);if(!r)return;const o={[t]:n};if(("w"===t||"h"===t)&&fe&&r.w>0&&r.h>0){const e=r.w/r.h;"w"===t?o.h=n/e:o.w=n*e}"scaleX"!==t&&"scaleY"!==t||!me||("scaleX"===t?o.scaleY=n:o.scaleX=n),y(e,o)},Ee=e=>{if(""===e)return;let t=parseInt(e,10);Number.isNaN(t)||(t<1&&(t=1),y(k,"z",t))},De=(e,t)=>(t.z||0)-(e.z||0),Me=(0,e.useMemo)(()=>{const e=je.filter(e=>!e.parentId).sort(De),t={};je.forEach(e=>{e.parentId&&(t[e.parentId]||(t[e.parentId]=[]),t[e.parentId].push(e))}),Object.keys(t).forEach(e=>{t[e].sort(De)});const n=[],r=e=>{e.forEach(e=>{n.push(e.id),"folder"===e.type&&!e.collapsed&&t[e.id]&&r(t[e.id])})};return r(e),n},[je]),Te=(0,e.useMemo)(()=>je.filter(e=>!e.parentId).sort(De),[je]),Ie=(0,e.useMemo)(()=>{const e={};return je.forEach(t=>{"folder"===t.type&&(e[t.id]=[])}),je.forEach(t=>{t.parentId&&e[t.parentId]&&e[t.parentId].push(t)}),Object.keys(e).forEach(t=>{e[t].sort(De)}),e},[je]),Ae=e=>{if("folder"===e.type){const t=Ie[e.id]||[];return(0,c.jsx)(XL,{folder:e,isSelected:k===e.id,onSelect:()=>M(e.id),onToggleCollapse:E,onUpdateName:(e,t)=>y(e,"name",t),onToggleVisibility:D,onRemove:m,children:t.map(e=>Ae(e))},e.id)}return(0,c.jsx)(YL,{layer:e,realIndex:d.findIndex(t=>t.id===e.id),isSelected:k===e.id,selectedIds:C,onSelect:j,onUpdateLayerParam:y,onRemoveLayer:m},e.id)},Oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(Z&&f){const t=e?"Default":K;f(Z.id,t,p,null,te,e)}q(!1),$(null),ne(!0),ce(!1),ue(null),oe(null)},Re=(0,e.useMemo)(()=>{const e=null===p||void 0===p?void 0:p.sys_characters;return!(!e||!e.files)&&e.files.some(e=>"folder"===e.type||"character_folder"===e.type)},[p]);return(0,c.jsxs)("div",{style:zL.layersPanelContainer,children:[(0,c.jsx)("div",{style:zL.layersLeftColumn,children:Q?(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #444",paddingBottom:10,marginBottom:15},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)("span",{style:{fontSize:20},children:ee?"\ud83d\udcc1":"video"===Q.type?"\ud83c\udfa5":"\ud83d\uddbc\ufe0f"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",textTransform:"uppercase",letterSpacing:.5},children:"\u0412\u044b\u0431\u0440\u0430\u043d \u0441\u043b\u043e\u0439"}),(0,c.jsx)("strong",{style:{fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:140,display:"block"},children:Q.name})]})]}),(0,c.jsx)("button",{onClick:()=>j(null),title:"\u0421\u043d\u044f\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435",style:{background:"#333",border:"1px solid #555",color:"#fff",cursor:"pointer",borderRadius:4,padding:"4px 8px",fontSize:12},children:"\u2715"})]}),(0,c.jsxs)("div",{style:{flex:1,overflowY:"auto",paddingRight:5},children:[(0,c.jsxs)("div",{style:{marginBottom:20,padding:"0 5px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",color:"#ccc",marginBottom:6},children:[(0,c.jsx)("span",{children:"\ud83d\udca7 \u041d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("span",{children:[Math.round(100*(null!==(n=Q.opacity)&&void 0!==n?n:1)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",value:void 0!==Q.opacity?Q.opacity:1,onChange:e=>y(Q.id,"opacity",parseFloat(e.target.value)),style:{width:"100%",cursor:"pointer",height:6,accentColor:"#7568ed"}})]}),(0,c.jsxs)(VL,{title:"\u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",icon:"\ud83d\udcd0",isOpen:"transform"===pe,onToggle:()=>ye("transform"),children:[(0,c.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:10},children:[(0,c.jsx)(HL,{label:"X",val:Q.x,param:"x",layerId:Q.id,onUpdate:y}),(0,c.jsx)(HL,{label:"Y",val:Q.y,param:"y",layerId:Q.id,onUpdate:y})]}),!ee&&(0,c.jsxs)("div",{style:{display:"flex",gap:5,marginBottom:10,alignItems:"flex-end"},children:[(0,c.jsx)(HL,{label:"\u0428\u0438\u0440\u0438\u043d\u0430",val:Q.w,param:"w",min:0,layerId:Q.id,onUpdate:_e}),(0,c.jsx)("button",{onClick:()=>ge(!fe),title:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438",style:{background:fe?"#7568ed":"#333",border:"1px solid #555",borderRadius:4,color:"#fff",width:24,height:24,marginBottom:1,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12},children:"\ud83d\udd17"}),(0,c.jsx)(HL,{label:"\u0412\u044b\u0441\u043e\u0442\u0430",val:Q.h,param:"h",min:0,layerId:Q.id,onUpdate:_e})]}),ee&&(0,c.jsxs)("div",{style:{display:"flex",gap:5,marginBottom:10,alignItems:"flex-end"},children:[(0,c.jsx)(HL,{label:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 X",val:null!==(r=Q.scaleX)&&void 0!==r?r:1,param:"scaleX",step:.01,layerId:Q.id,onUpdate:_e}),(0,c.jsx)("button",{onClick:()=>ve(!me),title:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438",style:{background:me?"#7568ed":"#333",border:"1px solid #555",borderRadius:4,color:"#fff",width:24,height:24,marginBottom:1,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12},children:"\ud83d\udd17"}),(0,c.jsx)(HL,{label:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 Y",val:null!==(o=Q.scaleY)&&void 0!==o?o:1,param:"scaleY",step:.01,layerId:Q.id,onUpdate:_e})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,c.jsx)(HL,{label:"\u041f\u043e\u0432\u043e\u0440\u043e\u0442 (\xb0)",val:Q.rotate,param:"rotate",layerId:Q.id,onUpdate:y}),(0,c.jsx)("div",{style:{flex:1}})]})]}),(0,c.jsxs)(VL,{title:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",icon:"\ud83c\udfa8",isOpen:"display"===pe,onToggle:()=>ye("display"),children:[!ee&&(0,c.jsxs)("div",{style:{marginBottom:12},children:[(0,c.jsx)("div",{style:zL.label,children:"\u0421\u043b\u043e\u0439 (Z-Index)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:5},children:[(0,c.jsx)("button",{onClick:()=>Ee((Q.z||1)-1),style:s(s({},zL.iconBtn),{},{width:25}),children:"-"}),(0,c.jsx)("input",{type:"number",value:Q.z||1,onChange:e=>Ee(e.target.value),style:{flex:1,background:"#111",border:"1px solid #444",color:"#fff",textAlign:"center",borderRadius:4}}),(0,c.jsx)("button",{onClick:()=>Ee((Q.z||1)+1),style:s(s({},zL.iconBtn),{},{width:25}),children:"+"})]})]}),(0,c.jsxs)("div",{style:{marginBottom:12},children:[(0,c.jsx)("div",{style:zL.label,children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsx)("select",{style:s(s({},zL.selectInput),{},{width:"100%"}),value:Q.blendMode||"normal",onChange:e=>y(Q.id,"blendMode",e.target.value),children:ZL.map(e=>(0,c.jsx)("optgroup",{label:e.group,children:e.modes.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))},e.group))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:zL.label,children:"\u0417\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 (Fit)"}),(0,c.jsx)("select",{style:s(s({},zL.selectInput),{},{width:"100%"}),value:Q.scalingMode||"cover",onChange:e=>y(Q.id,"scalingMode",e.target.value),children:qL.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,c.jsxs)("div",{style:{marginTop:15,paddingTop:10,borderTop:"1px solid #333"},children:[(0,c.jsx)("div",{style:{fontSize:"11px",fontWeight:"bold",color:"#ccc",marginBottom:8},children:"\ud83c\udfa8 \u0426\u0432\u0435\u0442\u043e\u043a\u043e\u0440\u0440\u0435\u043a\u0446\u0438\u044f"}),(0,c.jsx)(WL,{label:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c (Brightness)",value:Q.brightness,def:1,min:0,max:3,onChange:e=>y(Q.id,"brightness",e)}),(0,c.jsx)(WL,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442 (Contrast)",value:Q.contrast,def:1,min:0,max:3,onChange:e=>y(Q.id,"contrast",e)}),(0,c.jsx)(WL,{label:"\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0441\u0442\u044c (Saturate)",value:Q.saturate,def:1,min:0,max:3,onChange:e=>y(Q.id,"saturate",e)}),(0,c.jsx)(WL,{label:"\u041e\u0442\u0442\u0435\u043d\u043e\u043a (Hue)",value:Q.hueRotate,def:0,min:0,max:360,step:1,unit:"\xb0",onChange:e=>y(Q.id,"hueRotate",e)}),(0,c.jsx)(WL,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 (Blur)",value:Q.blur,def:0,min:0,max:20,step:.5,unit:"px",onChange:e=>y(Q.id,"blur",e)}),(0,c.jsxs)("div",{style:{display:"flex",gap:5},children:[(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(WL,{label:"\u0427/\u0411",value:Q.grayscale,def:0,min:0,max:1,onChange:e=>y(Q.id,"grayscale",e)})}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(WL,{label:"\u0421\u0435\u043f\u0438\u044f",value:Q.sepia,def:0,min:0,max:1,onChange:e=>y(Q.id,"sepia",e)})})]})]})]}),!ee&&(0,c.jsxs)(VL,{title:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["\u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432",(0,c.jsx)(PE,{text:"\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0440\u0435\u0430\u043a\u0446\u0438\u044e \u043d\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u044b\u0448\u0438. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0441\u043b\u043e\u044f \u043f\u0440\u0438 \u043a\u043b\u0438\u043a\u0435 \u0438\u043b\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 \u043a\u0443\u0440\u0441\u043e\u0440\u0430. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043a\u043d\u043e\u043f\u043e\u043a, \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u043e\u043d \u0438\u043b\u0438 \u0441\u043c\u0435\u043d\u044b \u044d\u043c\u043e\u0446\u0438\u0439 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430."})]}),icon:"\ud83d\udc46",isOpen:"interact"===pe,onToggle:()=>ye("interact"),children:[(0,c.jsxs)("div",{style:{marginBottom:10},children:[(0,c.jsx)("div",{style:zL.label,children:"\u0420\u0435\u0436\u0438\u043c \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430"}),(0,c.jsxs)("select",{style:s(s({},zL.selectInput),{},{width:"100%"}),value:Q.interactionMode||"none",onChange:e=>y(Q.id,"interactionMode",e.target.value),children:[(0,c.jsx)("option",{value:"none",children:"\u041d\u0435\u0442 (\u041f\u0430\u0441\u0441\u0438\u0432\u043d\u044b\u0439)"}),(0,c.jsx)("option",{value:"hover",children:"\u041d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0435 (Hover)"}),(0,c.jsx)("option",{value:"click",children:"\u041a\u043b\u0438\u043a (Click)"})]})]}),Q.interactionMode&&"none"!==Q.interactionMode&&(0,c.jsxs)("div",{style:{padding:"8px",background:"rgba(255,255,255,0.05)",borderRadius:4},children:[(0,c.jsx)("div",{style:zL.label,children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043b\u043e\u0439:"}),(0,c.jsxs)("select",{style:s(s({},zL.selectInput),{},{width:"100%",marginBottom:8}),value:Q.interactionTarget||"",onChange:e=>y(Q.id,"interactionTarget",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0435\u043b\u044c --"}),d.filter(e=>e.id!==Q.id).map(e=>(0,c.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,c.jsxs)("label",{style:{fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!Q.interactionOnce,onChange:e=>y(Q.id,"interactionOnce",e.target.checked),style:{marginRight:6}}),"\u0421\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c 1 \u0440\u0430\u0437"]}),(0,c.jsxs)("label",{style:{fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!Q.cursorPointer,onChange:e=>y(Q.id,"cursorPointer",e.target.checked),style:{marginRight:6}}),"\u041a\u0443\u0440\u0441\u043e\u0440-\u0440\u0443\u043a\u0430"]})]})]})]}),(0,c.jsxs)(VL,{title:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",icon:"\ud83d\udccb",isOpen:"copy"===pe,onToggle:()=>ye("copy"),children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:15,marginBottom:12},children:["pos","size","rot"].map(e=>(0,c.jsxs)("label",{style:{fontSize:"10px",color:"#888",cursor:"pointer",display:"flex",alignItems:"center",gap:4,textTransform:"capitalize"},children:[(0,c.jsx)("input",{type:"checkbox",checked:G[e],onChange:t=>X(n=>s(s({},n),{},{[e]:t.target.checked})),style:{accentColor:"#7568ed"}}),"pos"===e?"\u041f\u043e\u0437\u0438\u0446\u0438\u044f":"size"===e?"\u0420\u0430\u0437\u043c\u0435\u0440":"\u0423\u0433\u043e\u043b"]},e))}),(0,c.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,c.jsx)("button",{onClick:()=>{if(!Q)return;let e=[];if("folder"===Q.type){const t=e=>{const n=d.filter(t=>t.parentId===e);let r=[...n];return n.forEach(e=>{"folder"===e.type&&(r=[...r,...t(e.id)])}),r};e=t(Q.id)}V({root:Q,children:e,params:{x:G.pos?Q.x||0:void 0,y:G.pos?Q.y||0:void 0,w:G.size?Q.w:void 0,h:G.size?Q.h:void 0,rotate:G.rot?Q.rotate||0:void 0,opacity:Q.opacity}})},title:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",style:{flex:1,background:"#333",border:"1px solid #555",color:"#fff",borderRadius:6,padding:"10px",cursor:"pointer",fontSize:"12px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:6,transition:"background 0.2s"},children:"\ud83d\udccb \u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,c.jsx)("button",{onClick:()=>{if(!Q||!U)return;const e="folder"===Q.type,t={};Object.entries(U.params).forEach(n=>{let[r,o]=n;if(void 0!==o){if(e&&("w"===r||"h"===r)&&o<=1)return;t[r]=o}}),Object.keys(t).length>0&&y(Q.id,t)},disabled:!U,title:U?"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438\u0437 \u0431\u0443\u0444\u0435\u0440\u0430":"\u0411\u0443\u0444\u0435\u0440 \u043f\u0443\u0441\u0442",style:{flex:1,background:U?"#2d4b2e":"#222",border:U?"1px solid #4caf50":"1px solid #333",color:U?"#fff":"#555",borderRadius:6,padding:"10px",cursor:U?"pointer":"default",fontSize:"12px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:6,transition:"all 0.2s"},children:"\ud83d\udcdd \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c"})]})]})]})]}):(0,c.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#666",textAlign:"center"},children:[(0,c.jsx)("div",{style:{fontSize:40,marginBottom:10,opacity:.2},children:"\ud83d\uddb1\ufe0f"}),(0,c.jsxs)("div",{style:{fontSize:13},children:["\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0439",(0,c.jsx)("br",{}),"\u0434\u043b\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"]}),"characters"===ae&&!R&&(0,c.jsx)("div",{style:{marginTop:20,width:"90%",padding:"0 5px"},children:Re?(0,c.jsx)("button",{onClick:O,className:"hover-btn",style:{background:"#007acc",color:"#fff",border:"none",padding:"10px 15px",borderRadius:6,cursor:"pointer",fontWeight:"bold",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:8,boxShadow:"0 4px 10px rgba(0, 122, 204, 0.3)",transition:"transform 0.1s"},children:"\ud83c\udfad \u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439"}):(0,c.jsxs)("div",{style:{padding:15,background:"#2a2a2a",border:"1px dashed #444",borderRadius:8,fontSize:"11px",lineHeight:"1.4",color:"#aaa"},children:["\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439. ",(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 PSD \u0444\u0430\u0439\u043b \u0441 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u043c \u0432 \u043f\u0430\u043f\u043a\u0443 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439, \u043b\u0438\u0431\u043e \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0441\u0432\u043e\u044e, \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0435\u0433\u043e \u043f\u043e \u0441\u043b\u043e\u044f\u043c \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e."]})}),U&&(0,c.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#666",textAlign:"center"},children:[(0,c.jsx)("div",{style:{fontSize:40,marginBottom:10,opacity:.2},children:"\ud83d\uddb1\ufe0f"}),(0,c.jsxs)("div",{style:{fontSize:13},children:["\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0439",(0,c.jsx)("br",{}),"\u0434\u043b\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"]}),U&&(0,c.jsxs)("div",{style:{marginTop:30,width:"90%",background:"#252525",padding:15,borderRadius:8,border:"1px solid #444"},children:[(0,c.jsx)("div",{style:{fontSize:10,color:"#888",marginBottom:5,textTransform:"uppercase"},children:"\u0412 \u0431\u0443\u0444\u0435\u0440\u0435 \u043e\u0431\u043c\u0435\u043d\u0430"}),(0,c.jsxs)("div",{style:{fontWeight:"bold",color:"#fff",marginBottom:10},children:['"',null===(i=U.fullLayer)||void 0===i?void 0:i.name,'"']}),(0,c.jsx)("button",{onClick:()=>{U&&A(U)},style:{background:"#7568ed",color:"#fff",border:"none",padding:"10px",borderRadius:6,cursor:"pointer",fontWeight:"bold",width:"100%",fontSize:"12px",boxShadow:"0 4px 10px rgba(117, 104, 237, 0.3)"},children:"+ \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u043a \u043d\u043e\u0432\u044b\u0439"})]})]})]})}),(0,c.jsx)("div",{style:s(s({},zL.layersListBlock),{},{position:"relative"}),children:(0,c.jsxs)("div",{style:{background:"#181818",borderRadius:"8px",padding:"10px",height:"100%",display:"flex",flexDirection:"column",border:"1px solid #333",minHeight:"200px",position:"relative"},children:[!R&&(0,c.jsxs)("div",{style:{display:"flex",marginBottom:10,background:"#111",borderRadius:6,padding:2},children:[(0,c.jsx)("button",{onClick:()=>se("layers"),style:{flex:1,background:"layers"===ae?"#333":"transparent",color:"layers"===ae?"#fff":"#888",border:"none",padding:"6px",borderRadius:4,cursor:"pointer",fontSize:"11px",fontWeight:"bold"},children:"\u0421\u043b\u043e\u0438"}),(0,c.jsx)("button",{onClick:()=>se("characters"),style:{flex:1,background:"characters"===ae?"#333":"transparent",color:"characters"===ae?"#fff":"#888",border:"none",padding:"6px",borderRadius:4,cursor:"pointer",fontSize:"11px",fontWeight:"bold"},children:"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0438"})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,c.jsx)("h4",{style:{margin:0,fontSize:"13px",color:"#888"},children:R?"\u0421\u043b\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430":"characters"===ae?"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439":"\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043b\u043e\u0435\u0432"}),!R&&(0,c.jsxs)("div",{style:{display:"flex",gap:5},children:["layers"===ae&&(0,c.jsx)("button",{onClick:()=>_(),style:{fontSize:11,cursor:"pointer",background:"none",border:"1px solid #555",color:"#ccc",borderRadius:4,padding:"2px 6px"},children:"\ud83d\udcc1 \u041f\u0430\u043f\u043a\u0430"}),(0,c.jsxs)("button",{onClick:()=>{N("characters"===ae?"sys_characters":""),B(!P)},style:{backgroundColor:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontWeight:900,color:"#a855f7",fontSize:"14px",lineHeight:1},children:"+"}),"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"]})]})]}),P&&(0,c.jsxs)("div",{style:{position:"absolute",top:"85px",right:"10px",width:"240px",backgroundColor:"#222",border:"1px solid #555",borderRadius:"8px",padding:"10px",zIndex:2e3,boxShadow:"0 8px 20px rgba(0,0,0,0.6)"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #444",paddingBottom:8,marginBottom:10},children:[(0,c.jsxs)("div",{style:{fontSize:"12px",color:"#fff",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{color:"#a855f7",fontWeight:900,fontSize:"14px"},children:"+"}),"characters"===ae?"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439"]}),(0,c.jsx)("button",{onClick:()=>B(!1),style:{background:"none",border:"none",color:"#aaa",cursor:"pointer"},children:"\u2715"})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,c.jsx)("div",{style:{fontSize:"11px",color:"#ccc",lineHeight:"1.4"},children:"characters"===ae?"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0430\u043f\u043a\u0443 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0438\u0437 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438.":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u0432\u0438\u0434\u0435\u043e \u0438\u0437 \u043b\u044e\u0431\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430."}),(0,c.jsxs)("button",{onClick:()=>{B(!1),"characters"===ae?(Se("character"),Ce("sys_characters")):(Se("layer"),Ce(null)),be(!0)},style:{padding:"8px",background:"#007acc",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:["\ud83d\udcc2 ","characters"===ae?"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430...":"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 \u0444\u0430\u0439\u043b\u043e\u0432..."]})]})]}),(0,c.jsxs)("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",paddingRight:4},children:[(0,c.jsxs)(r_,{sensors:ie,collisionDetection:FC,onDragStart:e=>{F(e.active.id)},onDragEnd:e=>{let{active:t,over:n}=e;if(F(null),n)if("root-drop-zone"!==n.id){if(n.id.toString().startsWith("folder-drop-")){const e=n.id.replace("folder-drop-","");return void(t.id!==e&&b&&b(t.id,e))}t.id!==n.id&&x&&x(t.id,n.id)}else t.id&&b&&b(t.id,void 0)},children:[(0,c.jsx)(T_,{items:Me,strategy:E_,children:Te.map(e=>Ae(e))}),z&&!(null!==(a=d.find(e=>e.id===z))&&void 0!==a&&null!==(l=a.type)&&void 0!==l&&l.includes("folder"))&&(0,c.jsx)(GL,{isDragging:!!z}),(0,c.jsx)(w_,{dropAnimation:{sideEffects:m_({styles:{active:{opacity:"0.5"}}})},children:(()=>{if(!z)return null;const e=d.find(e=>e.id===z);return e?(0,c.jsxs)("div",{style:{padding:"10px",background:"#444",border:"1px solid #7568ed",borderRadius:6,opacity:.9,boxShadow:"0 5px 15px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",gap:10},children:[(0,c.jsx)("span",{children:"folder"===e.type?"\ud83d\udcc1":"video"===e.type?"\ud83c\udfa5":"\ud83d\uddbc\ufe0f"}),(0,c.jsx)("span",{style:{fontWeight:"bold",color:"#fff"},children:e.name})]}):null})()})]}),0===d.length&&(0,c.jsx)("div",{style:{padding:20,textAlign:"center",color:"#444",fontSize:12},children:"\u041d\u0435\u0442 \u0441\u043b\u043e\u0435\u0432"})]}),!R&&(0,c.jsxs)("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #333"},children:[(0,c.jsx)("div",{style:{fontSize:"11px",color:"#666",marginBottom:5},children:"\u0424\u043e\u043d \u0441\u0446\u0435\u043d\u044b (Base)"}),(0,c.jsxs)("select",{style:s(s({},zL.selectInput),{},{marginBottom:0,borderColor:u?"#ff9800":"#444"}),value:u||"",onChange:e=>w(e.target.value),children:[(0,c.jsx)("option",{value:"",children:"\u0411\u0435\u0437 \u0444\u043e\u043d\u0430"}),S.map(e=>(0,c.jsx)("option",{value:e.local_path,children:e.name},e.local_path))]})]})]})}),(0,c.jsx)(UL,{isOpen:xe,onClose:()=>be(!1),onSelect:(e,t)=>{if("character"===we){const n=Array.isArray(e)?e[0]:e;let r=null;if("folder"===n.type||"character_folder"===n.type)r=n;else if(t){const e=p.sys_characters;e&&e.files&&(r=e.files.find(e=>e.id===t))}return void(r&&($(r),J("Default"),q(!0)))}if(h){const t=Array.isArray(e)?e:[e];let n,r;"sys_characters"===L?(n=void 0,r="sys_characters"):L&&(n=L);const o=t.filter(e=>"folder"!==e.type&&"character_folder"!==e.type).map((e,t)=>{const o=n?0:20*t;return s(s({},e),{},{targetParentId:n,folderId:r,x:100+o,y:100+o})});o.length>0&&h(o)}},assets:p,rootId:ke,title:"character"===we?"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0434\u043b\u044f \u0441\u043b\u043e\u044f",assetsMap:T,detectCharacterFolders:"character"===we,multiSelect:"layer"===we}),Y&&Z&&(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsxs)("div",{style:{background:"#252526",padding:20,borderRadius:8,width:320,border:"1px solid #444",boxShadow:"0 10px 30px #000"},children:[(0,c.jsxs)("h3",{style:{marginTop:0,color:"#fff",fontSize:"16px",marginBottom:"15px"},children:["\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c: ",(0,c.jsx)("span",{style:{color:"#007acc"},children:Z.name})]}),(0,c.jsxs)("div",{style:{marginBottom:15},children:[(0,c.jsx)("label",{style:{display:"block",color:"#aaa",fontSize:12,marginBottom:5,fontWeight:"bold"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0441\u0435\u0442:"}),(0,c.jsxs)("select",{style:s(s({},zL.selectInput),{},{width:"100%",padding:"8px",marginBottom:"10px"}),value:K,onChange:e=>J(e.target.value),children:[(0,c.jsx)("option",{value:"Default",children:"\ud83d\udcc4 Default (\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438\u0437 PSD)"}),Z.presets&&Object.keys(Z.presets).map(e=>(0,c.jsxs)("option",{value:e,children:["\ud83c\udfad ",e]},e))]}),(0,c.jsx)("button",{onClick:()=>{if(!Z)return;let e=Z.structure?Z.structure.layers:Z.files;!e&&Z.files&&(e=Z.files),ue(e);const t=[],n=e=>{e.forEach(e=>{const r=e.id||e._uniqueId,o=e.children||e.files||e.layers;!1!==e.visible&&t.push(r),o&&n(o)})};e&&n(e),oe(t),ce(!0),q(!1)},style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",color:"#fff",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,fontSize:"12px"},title:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u0441\u043b\u043e\u0438 \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u0440\u0435\u0441\u0435\u0442\u0430",children:"\ud83d\udee0\ufe0f \u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043b\u043e\u0438 \u0432\u0440\u0443\u0447\u043d\u0443\u044e..."})]}),(0,c.jsxs)("div",{style:{marginBottom:20},children:[(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",fontSize:12,color:"#e0e0e0",select:"none"},children:[(0,c.jsx)("input",{type:"checkbox",checked:te,onChange:e=>ne(e.target.checked),style:{cursor:"pointer"}}),"\u0422\u043e\u043b\u044c\u043a\u043e \u0432\u0438\u0434\u0438\u043c\u044b\u0435 \u0441\u043b\u043e\u0438"]}),(0,c.jsx)("div",{style:{fontSize:10,color:"#666",marginLeft:20,marginTop:2},children:"\u0418\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043a\u0440\u044b\u0442\u044b\u0435 \u0441\u043b\u043e\u0438 \u0438\u0437 \u043f\u0440\u0435\u0441\u0435\u0442\u0430"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[(0,c.jsx)("button",{onClick:()=>{q(!1),$(null)},style:{background:"transparent",border:"1px solid #555",color:"#ccc",padding:"8px 16px",borderRadius:4,cursor:"pointer",fontSize:12},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:()=>Oe(null),style:{background:"#007acc",border:"none",color:"#fff",padding:"8px 16px",borderRadius:4,cursor:"pointer",fontWeight:"bold",fontSize:12},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})}),(0,c.jsx)(BL,{isOpen:le,onClose:()=>ce(!1),rootNode:de,initialSelectedIds:re,onConfirm:e=>{Oe(e)}})]})};var KL=Symbol.for("immer-nothing"),JL=Symbol.for("immer-draftable"),QL=Symbol.for("immer-state");function eN(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var tN=Object,nN=tN.getPrototypeOf,rN="constructor",oN="prototype",iN="configurable",aN="enumerable",sN="writable",lN="value",cN=e=>!!e&&!!e[QL];function dN(e){var t;return!!e&&(hN(e)||xN(e)||!!e[JL]||!(null===(t=e[rN])||void 0===t||!t[JL])||bN(e)||wN(e))}var uN=tN[oN][rN].toString(),pN=new WeakMap;function hN(e){if(!e||!SN(e))return!1;const t=nN(e);if(null===t||t===tN[oN])return!0;const n=tN.hasOwnProperty.call(t,rN)&&t[rN];if(n===Object)return!0;if(!kN(n))return!1;let r=pN.get(n);return void 0===r&&(r=Function.toString.call(n),pN.set(n,r)),r===uN}function fN(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===gN(e)){(n?Reflect.ownKeys(e):tN.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function gN(e){const t=e[QL];return t?t.type_:xN(e)?1:bN(e)?2:wN(e)?3:0}var mN=function(e,t){return 2===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:gN(e))?e.has(t):tN[oN].hasOwnProperty.call(e,t)},vN=function(e,t){return 2===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:gN(e))?e.get(t):e[t]},yN=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gN(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n};var xN=Array.isArray,bN=e=>e instanceof Map,wN=e=>e instanceof Set,SN=e=>"object"===typeof e,kN=e=>"function"===typeof e,CN=e=>"boolean"===typeof e;var jN=e=>e.copy_||e.base_,_N=e=>e.modified_?e.copy_:e.base_;function EN(e,t){if(bN(e))return new Map(e);if(wN(e))return new Set(e);if(xN(e))return Array[oN].slice.call(e);const n=hN(e);if(!0===t||"class_only"===t&&!n){const t=tN.getOwnPropertyDescriptors(e);delete t[QL];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const o=n[r],i=t[o];!1===i[sN]&&(i[sN]=!0,i[iN]=!0),(i.get||i.set)&&(t[o]={[iN]:!0,[sN]:!0,[aN]:i[aN],[lN]:e[o]})}return tN.create(nN(e),t)}{const t=nN(e);if(null!==t&&n)return s({},e);const r=tN.create(t);return tN.assign(r,e)}}function DN(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return TN(e)||cN(e)||!dN(e)||(gN(e)>1&&tN.defineProperties(e,{set:MN,add:MN,clear:MN,delete:MN}),tN.freeze(e),t&&fN(e,(e,t)=>{DN(t,!0)},!1)),e}var MN={[lN]:function(){eN(2)}};function TN(e){return null===e||!SN(e)||tN.isFrozen(e)}var IN="MapSet",AN="Patches",ON="ArrayMethods",RN={};function zN(e){const t=RN[e];return t||eN(0),t}var FN,PN=e=>!!RN[e];var BN=()=>FN;function LN(e,t){t&&(e.patchPlugin_=zN(AN),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function NN(e){UN(e),e.drafts_.forEach(WN),e.drafts_=null}function UN(e){e===FN&&(FN=e.parent_)}var VN=e=>FN={drafts_:[],parent_:FN,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:PN(IN)?zN(IN):void 0,arrayMethodsPlugin_:PN(ON)?zN(ON):void 0};function WN(e){const t=e[QL];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function HN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(void 0!==e&&e!==n){n[QL].modified_&&(NN(t),eN(4)),dN(e)&&(e=GN(t,e));const{patchPlugin_:r}=t;r&&r.generateReplacementPatches_(n[QL].base_,e,t)}else e=GN(t,n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&DN(t,n)}(t,e,!0),NN(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==KL?e:void 0}function GN(e,t){if(TN(t))return t;const n=t[QL];if(!n){return KN(t,e.handledSet_,e)}if(!YN(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:t}=n;if(t)for(;t.length>0;){t.pop()(e)}$N(n,e)}return n.copy_}function XN(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var YN=(e,t)=>e.scope_===t,qN=[];function ZN(e,t,n,r){var o;const i=jN(e),a=e.type_;if(void 0!==r){if(vN(i,r,a)===t)return void yN(i,r,n,a)}if(!e.draftLocations_){const t=e.draftLocations_=new Map;fN(i,(e,n)=>{if(cN(n)){const r=t.get(n)||[];r.push(e),t.set(n,r)}})}const s=null!==(o=e.draftLocations_.get(t))&&void 0!==o?o:qN;for(const l of s)yN(i,l,n,a)}function $N(e,t){var n,r;if(e.modified_&&!e.finalized_&&(3===e.type_||1===e.type_&&e.allIndicesReassigned_||(null!==(n=null===(r=e.assigned_)||void 0===r?void 0:r.size)&&void 0!==n?n:0)>0)){const{patchPlugin_:n}=t;if(n){const r=n.getPath(e);r&&n.generatePatches_(e,r,t)}XN(e)}}function KN(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||cN(e)||t.has(e)||!dN(e)||TN(e)||(t.add(e),fN(e,(r,o)=>{if(cN(o)){const t=o[QL];if(YN(t,n)){const n=_N(t);yN(e,r,n,e.type_),XN(t)}}else dN(o)&&KN(o,t,n)})),e}var JN={get(e,t){if(t===QL)return e;let n=e.scope_.arrayMethodsPlugin_;const r=1===e.type_&&"string"===typeof t;if(r&&null!==n&&void 0!==n&&n.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const o=jN(e);if(!mN(o,t,e.type_))return function(e,t,n){var r;const o=tU(t,n);return o?lN in o?o[lN]:null===(r=o.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,o,t);const i=o[t];if(e.finalized_||!dN(i))return i;if(r&&e.operationMethod&&null!==n&&void 0!==n&&n.isMutatingArrayMethod(e.operationMethod)&&function(e){const t=+e;return Number.isInteger(t)&&String(t)===e}(t))return i;if(i===eU(e.base_,t)){rU(e);const n=1===e.type_?+t:t,r=oU(e.scope_,i,e,n);return e.copy_[n]=r}return i},has:(e,t)=>t in jN(e),ownKeys:e=>Reflect.ownKeys(jN(e)),set(e,t,n){const r=tU(jN(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=eU(jN(e),t),o=null===r||void 0===r?void 0:r[QL];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||mN(e.base_,t,e.type_)))return!0;rU(e),nU(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),function(e,t,n){const{scope_:r}=e;if(cN(n)){const o=n[QL];YN(o,r)&&o.callbacks_.push(function(){rU(e);const r=_N(o);ZN(e,n,r,t)})}else dN(n)&&e.callbacks_.push(function(){const o=jN(e);var i;vN(o,t,e.type_)===n&&r.drafts_.length>1&&!0===(null!==(i=e.assigned_.get(t))&&void 0!==i&&i)&&e.copy_&&KN(vN(e.copy_,t,e.type_),r.handledSet_,r)})}(e,t,n)),!0},deleteProperty:(e,t)=>(rU(e),void 0!==eU(e.base_,t)||t in e.base_?(e.assigned_.set(t,!1),nU(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=jN(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{[sN]:!0,[iN]:1!==e.type_||"length"!==t,[aN]:r[aN],[lN]:n[t]}:r},defineProperty(){eN(11)},getPrototypeOf:e=>nN(e.base_),setPrototypeOf(){eN(12)}},QN={};function eU(e,t){const n=e[QL];return(n?jN(n):e)[t]}function tU(e,t){if(!(t in e))return;let n=nN(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=nN(n)}}function nU(e){e.modified_||(e.modified_=!0,e.parent_&&nU(e.parent_))}function rU(e){e.copy_||(e.assigned_=new Map,e.copy_=EN(e.base_,e.scope_.immer_.useStrictShallowCopy_))}fN(JN,(e,t)=>{QN[e]=function(){const e=arguments;return e[0]=e[0][0],t.apply(this,e)}}),QN.deleteProperty=function(e,t){return QN.set.call(this,e,t,void 0)},QN.set=function(e,t,n){return JN.set.call(this,e[0],t,n,e[0])};function oU(e,t,n,r){var o,i;const[a,s]=bN(t)?zN(IN).proxyMap_(t,n):wN(t)?zN(IN).proxySet_(t,n):function(e,t){const n=xN(e),r={type_:n?1:0,scope_:t?t.scope_:BN(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let o=r,i=JN;n&&(o=[r],i=QN);const{revoke:a,proxy:s}=Proxy.revocable(o,i);return r.draft_=s,r.revoke_=a,[s,r]}(t,n);return(null!==(o=null===n||void 0===n?void 0:n.scope_)&&void 0!==o?o:BN()).drafts_.push(a),s.callbacks_=null!==(i=null===n||void 0===n?void 0:n.callbacks_)&&void 0!==i?i:[],s.key_=r,n&&void 0!==r?function(e,t,n){e.callbacks_.push(function(r){var o,i;const a=t;if(!a||!YN(a,r))return;null===(o=r.mapSetPlugin_)||void 0===o||o.fixSetContents(a);const s=_N(a);ZN(e,null!==(i=a.draft_)&&void 0!==i?i:a,s,n),$N(a,r)})}(n,s,r):s.callbacks_.push(function(e){var t;null===(t=e.mapSetPlugin_)||void 0===t||t.fixSetContents(s);const{patchPlugin_:n}=e;s.modified_&&n&&n.generatePatches_(s,[],e)}),a}function iU(e){if(!dN(e)||TN(e))return e;const t=e[QL];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=EN(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=EN(e,!0);return fN(n,(e,t)=>{yN(n,e,iU(t))},r),t&&(t.finalized_=!1),n}var aU=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(e,t,n)=>{if(kN(e)&&!kN(t)){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return r.produce(e,e=>t.call(this,e,...i))}}let r;if(kN(t)||eN(6),void 0===n||kN(n)||eN(7),dN(e)){const o=VN(this),i=oU(o,e,void 0);let a=!0;try{r=t(i),a=!1}finally{a?NN(o):UN(o)}return LN(o,n),HN(r,o)}if(!e||!SN(e)){if(r=t(e),void 0===r&&(r=e),r===KL&&(r=void 0),this.autoFreeze_&&DN(r,!0),n){const t=[],o=[];zN(AN).generateReplacementPatches_(e,r,{patches_:t,inversePatches_:o}),n(t,o)}return r}eN(1)},this.produceWithPatches=(e,n)=>{if(kN(e))return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,t=>e(t,...o))};let r,o;const i=this.produce(e,n,(e,t)=>{r=e,o=t});return[i,r,o]},CN(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),CN(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),CN(null===e||void 0===e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){dN(e)||eN(8),cN(e)&&(e=function(e){cN(e)||eN(10);return iU(e)}(e));const t=VN(this),n=oU(t,e,void 0);return n[QL].isManual_=!0,UN(t),n}finishDraft(e,t){const n=e&&e[QL];n&&n.isManual_||eN(9);const{scope_:r}=n;return LN(r,t),HN(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=zN(AN).applyPatches_;return cN(e)?r(e,t):this.produce(e,e=>r(e,t))}},sU=aU.produce;const lU=t=>{const[n,r]=(0,e.useState)({past:[],present:t,future:[]}),o=(0,e.useRef)(null),{past:i,present:a,future:l}=n,c=(e,t)=>e&&t&&e.global_settings&&t.global_settings?sU(e,e=>{e.global_settings||(e.global_settings={}),t.global_settings.editor_view_desktop&&(e.global_settings.editor_view_desktop=t.global_settings.editor_view_desktop),t.global_settings.editor_view_mobile&&(e.global_settings.editor_view_mobile=t.global_settings.editor_view_mobile)}):e,d=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(n=>{let r;if("function"===typeof e)try{r=sU(n.present,e)}catch(M2){"function"===typeof e&&(r=e(n.present))}else r=e;if(r===n.present)return n;if(t)return s(s({},n),{},{present:r});const i=null!==o.current;o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{o.current=null},500);let a=n.past;return i||null===n.present||(a=[...n.past,n.present].slice(-20)),{past:a,present:r,future:[]}})},[]),u=(0,e.useCallback)(()=>{r(e=>{if(0===e.past.length)return e;const t=e.past[e.past.length-1];if(null===t)return s(s({},e),{},{past:[]});o.current&&(clearTimeout(o.current),o.current=null);return{past:e.past.slice(0,-1),present:c(t,e.present),future:[e.present,...e.future]}})},[]),p=(0,e.useCallback)(()=>{r(e=>{if(0===e.future.length)return e;o.current&&(clearTimeout(o.current),o.current=null);const t=e.future[0],n=e.future.slice(1),r=c(t,e.present);return{past:[...e.past,e.present].slice(-20),present:r,future:n}})},[]),h=(0,e.useCallback)(e=>{d(e,!0)},[d]),f=(0,e.useCallback)(e=>{r({past:[],present:e,future:[]})},[]);return{state:a,setState:d,setStateQuietly:h,undo:u,redo:p,canUndo:i.length>0&&null!==i[i.length-1],canRedo:l.length>0,setInitState:f}},cU=e=>e.replace(/[^a-z0-9\u0430-\u044f_]/gi,"_"),dU=(e,t)=>{let n=t[e],r=!0,o=1;for(;n&&(!1===n.visible&&(r=!1),o*=void 0!==n.opacity?n.opacity:1,n.parentId);)n=t[n.parentId];return{visible:r,opacity:o}},uU=e=>{const t={byId:{},byPath:{}},n=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e&&e.files&&e.files.forEach(e=>{if("folder"===e.type||"character_folder"===e.type){const t=r?"".concat(r,"/").concat(e.name):e.name;n(e,t)}else{e.file_id&&(t.byId[e.file_id]=e),t.byId[e.id]=e;const n=cU(e.name.replace(/\.[^/.]+$/,"")),o=r?"".concat(r,"/").concat(n):n;t.byPath[o]=e}})};return n(e),t},pU=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=[];return e.forEach((e,i)=>{var a;const s=e._uniqueId||e.id||"char_layer_".concat(Math.random().toString(36).substr(2,9)),l=e.children||e.files,c=!!l&&l.length>0;let d=null,u=null;if(!c){const n=cU(e.name),o=r?"".concat(r,"/").concat(n):n,i=t.byPath[o];if(i&&(d=i.local_path,u=i.file_id),!d&&e.file_id&&t.byId[e.file_id]){const n=t.byId[e.file_id];d=n.local_path,u=n.file_id}!d&&e.local_path&&(d=e.local_path)}const p={id:s,name:e.name,type:c?"folder":"image",visible:!1!==e.visible,opacity:null!==(a=e.opacity)&&void 0!==a?a:1,blendMode:e.blendMode||"normal",parentId:n,x:e.left||0,y:e.top||0,w:e.width||0,h:e.height||0,rotate:e.rotate||0,src:d,file_id:u,collapsed:!0,_origIndex:i};if(o.push(p),c){const n=r?"".concat(r,"/").concat(e.name):e.name,i=pU(l,t,s,n);o=[...o,...i]}}),o},hU=t=>{let{isOpen:n,onClose:r,assets:o,onSavePresets:i,resolution:a,assetsMap:l}=t;const[d,u]=(0,e.useState)(600),[p,h]=(0,e.useState)(40),[f,g]=(0,e.useState)(!1),[m,v]=(0,e.useState)(!1),[y,x]=(0,e.useState)(""),[b,w]=(0,e.useState)("Default"),{state:S,setState:k,undo:C,redo:j,canUndo:_,canRedo:E,setInitState:D}=lU([]),[M,T]=(0,e.useState)(null),[I,A]=(0,e.useState)({}),[O,R]=(0,e.useState)([]),[z,F]=(0,e.useState)([]),P=(0,e.useRef)(null),B=(0,e.useRef)({startZoom:1,startX:0,startY:0,startDist:0,startCenter:{x:0,y:0},isGesture:!1}),[L,N]=(0,e.useState)({x:0,y:0,z:.5}),[U,V]=(0,e.useState)(!1),[W,H]=(0,e.useState)({x:0,y:0}),[G,X]=(0,e.useState)(!0),[Y,q]=(0,e.useState)(!0),[Z,$]=(0,e.useState)(40),[K,J]=(0,e.useState)(!1),Q=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=Q.current;if(!e)return;const t=t=>{if(!(t.target.closest("button")||t.target.closest(".moveable-control-box")||t.target.closest(".nav-controls")))if(t.touches.length>1&&t.cancelable&&t.preventDefault(),1===t.touches.length){const e=t.touches[0];B.current=s(s({},B.current),{},{isPanning:!0,startX:e.clientX,startY:e.clientY,viewStartX:L.x,viewStartY:L.y})}else if(t.touches.length>=2){const n=e.getBoundingClientRect(),r=xB(t.touches),o={x:r.x-n.left,y:r.y-n.top};B.current={isGesture:!0,isPanning:!1,startDist:yB(t.touches),startZoom:L.z,startX:L.x,startY:L.y,startCenter:o}}},n=t=>{if(t.cancelable&&(B.current.isPanning||B.current.isGesture)&&t.preventDefault(),1===t.touches.length&&B.current.isPanning){const e=t.touches[0],n=e.clientX-B.current.startX,r=e.clientY-B.current.startY;N(e=>s(s({},e),{},{x:B.current.viewStartX+n,y:B.current.viewStartY+r}))}else if(2===t.touches.length&&B.current.isGesture){const{startDist:n,startZoom:r,startX:o,startY:i,startCenter:a}=B.current,s=yB(t.touches)/n,l=Math.min(Math.max(r*s,.1),5),c=e.getBoundingClientRect(),d=xB(t.touches),u={x:d.x-c.left,y:d.y-c.top},p=(a.x-o)/r,h=(a.y-i)/r,f=u.x-p*l,g=u.y-h*l;N({x:f,y:g,z:l})}},r=e=>{e.touches.length<2&&(B.current.isGesture=!1),0===e.touches.length&&(B.current.isPanning=!1)};return e.addEventListener("touchstart",t,{passive:!1}),e.addEventListener("touchmove",n,{passive:!1}),e.addEventListener("touchend",r),()=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n),e.removeEventListener("touchend",r)}},[L]),(0,e.useEffect)(()=>{if(!n)return;const e=e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName))return;const t=e.ctrlKey||e.metaKey,n="KeyZ"===e.code;t&&n&&(e.preventDefault(),e.stopPropagation(),e.shiftKey?E&&j():_&&C())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,C,j,_,E]);const ee=()=>V(!1),te=()=>{if(!Q.current||!a)return;const{clientWidth:e,clientHeight:t}=Q.current,n=a.width||1280,r=a.height||720,o=(e-40)/n,i=(t-40)/r,s=Math.min(o,i,1);N({x:(e-n*s)/2,y:(t-r*s)/2,z:s})};(0,e.useEffect)(()=>{n&&y&&setTimeout(te,100)},[n,y,a]),(0,e.useEffect)(()=>{if(!Q.current)return;const e=new ResizeObserver(()=>requestAnimationFrame(()=>te()));return e.observe(Q.current),()=>e.disconnect()},[a]),(0,e.useEffect)(()=>{const e=e=>{if(K){const t=window.innerHeight-d,n=(e.clientY-t)/d*100;$(Math.max(10,Math.min(90,n)))}},t=()=>J(!1),n=t=>{K&&t.touches.length>0&&(t.cancelable&&t.preventDefault(),e(t.touches[0]))},r=t=>{K&&e(t)};return K&&(window.addEventListener("mousemove",r),window.addEventListener("touchmove",n,{passive:!1}),window.addEventListener("mouseup",t),window.addEventListener("touchend",t),document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",t),window.removeEventListener("touchmove",n),window.removeEventListener("touchend",t),document.body.style.userSelect=""}},[K,d]);const ne=(0,e.useMemo)(()=>o&&o.sys_characters&&o.sys_characters.files?o.sys_characters.files.filter(e=>"folder"===e.type||"character_folder"===e.type):[],[o]);(0,e.useEffect)(()=>{if(!y)return D([]),A({}),R([]),void F([]);const e=ne.find(e=>e.id===y);if(!e)return;const t=uU(e);(async()=>{let n=e.presets||{};A(n),F(Object.keys(n));let r=[];if(e.files&&e.files.length>0){const n=pU(e.files||[],t),o=n.length;r=n.map((e,t)=>s(s({},e),{},{z:o-t+10}))}R(r),D(r),w("Default")})()},[y,ne,D]),(0,e.useEffect)(()=>{if(y)if("Default"===b)O.length>0&&D(JSON.parse(JSON.stringify(O)));else{const e=I[b];if(e&&e.length>0){const t=ne.find(e=>e.id===y),n=t?uU(t):{byId:{},byPath:{}};let r=[...e];const o=r[0].z||0,i=r[r.length-1].z||0;r.length>1&&o<i&&r.reverse();const a=r.map((e,t)=>{let o=e.src;if("image"===e.type)if(e.file_id&&n.byId[e.file_id])o=n.byId[e.file_id].local_path;else if(!o){const t=Object.values(n.byId).find(t=>t.name===e.name||t.name===e.name+".png");t&&(o=t.local_path)}const i=r.length-t+10;return s(s({},e),{},{src:o,z:i})});D(a)}}},[b,I,O,y,ne]),(0,e.useEffect)(()=>{let e=!0;if(S.some(e=>"image"===e.type&&e.src&&(0===e.w||0===e.h))){const t=async()=>{const t=[...S];let n=!1;for(let e=0;e<t.length;e++){const r=t[e];if("image"===r.type&&r.src&&(0===r.w||0===r.h))try{const o=await new Promise((e,t)=>{const n=new Image;n.onload=()=>e(n),n.onerror=t,n.src=r.src});t[e]=s(s({},r),{},{w:o.naturalWidth,h:o.naturalHeight}),n=!0}catch(M2){}}n&&e&&k(t)};t()}return()=>{e=!1}},[S,k]);const re=(0,e.useMemo)(()=>{const e={};return S.forEach(t=>{e[t.id]=t}),S.filter(t=>{if("folder"===t.type)return!1;if(!t.src)return!1;const{visible:n}=dU(t.id,e);return n}).sort((e,t)=>(e.z||0)-(t.z||0)).map(t=>{const{opacity:n}=dU(t.id,e);return s(s({},t),{},{opacity:n,type:"image"})})},[S]),oe=(e,t)=>{k(n=>n.map(n=>n.id===e?s(s({},n),t):n))};(0,e.useEffect)(()=>{const e=e=>{f&&u(window.innerHeight-e.clientY),m&&h(e.clientX/window.innerWidth*100)},t=()=>{g(!1),v(!1)};return f||m?(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),document.body.style.userSelect="none"):document.body.style.userSelect="",()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),document.body.style.userSelect=""}},[f,m]);const ie=M?document.getElementById(M):null;return n?(0,c.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:d,background:"#1a1a1a",borderTop:"2px solid #007bff",zIndex:5e3,display:"flex",flexDirection:"column",boxShadow:"0 -10px 40px rgba(0,0,0,0.5)",color:"#eee",fontFamily:"sans-serif"},children:[(0,c.jsx)("style",{children:"\n                .character-moveable-control {\n                    width: 10px !important; height: 10px !important;\n                    margin-left: -5px !important; margin-top: -5px !important;\n                    background: #fff !important; border: 1px solid #007bff !important; z-index: 100 !important;\n                }\n                .editor-btn {\n                    border: none; border-radius: 4px; padding: 6px 12px; font-size: 13px;\n                    cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 6px;\n                    font-weight: 500; color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n                }\n                .editor-btn:hover { filter: brightness(1.1); transform: translateY(-1px); }\n                .editor-btn:active { transform: translateY(0); }\n                .editor-btn:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }\n                .btn-primary { background: #007bff; }\n                .btn-success { background: #28a745; }\n                .btn-danger { background: #dc3545; }\n                .btn-secondary { background: #444; }\n\n                .close-cross-btn {\n                    background: transparent; border: none; color: #aaa; font-size: 24px;\n                    line-height: 1; cursor: pointer; padding: 0 10px; transition: color 0.2s; margin-left: 10px;\n                }\n                .close-cross-btn:hover { color: #fff; }\n\n                .editor-body {\n                    flex: 1; display: flex; overflow: hidden;\n                    flex-direction: row; \n                }\n                .preview-pane {\n                    position: relative; overflow: hidden; background: #111;\n                    height: 100%;\n                }\n                .splitter-bar-h {\n                    width: 5px; cursor: col-resize; background: #333; z-index: 10;\n                    display: block; border-left: 1px solid #000; border-right: 1px solid #000;\n                }\n                .splitter-bar-v {\n                    display: none; \n                }\n                .nav-controls {\n                    position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);\n                    background: rgba(0,0,0,0.7); padding: 5px 10px; border-radius: 20px;\n                    display: flex; gap: 8px; z-index: 200; backdrop-filter: blur(2px);\n                    border: 1px solid rgba(255,255,255,0.1);\n                }\n                .nav-btn {\n                    background: transparent; border: none; color: #ddd; font-size: 16px;\n                    cursor: pointer; width: 30px; height: 30px; border-radius: 50%;\n                    display: flex; align-items: center; justify-content: center;\n                    transition: background 0.2s;\n                }\n                .nav-btn:hover { background: rgba(255,255,255,0.2); color: #fff; }\n                .nav-btn.active { color: #f39c12; background: rgba(243, 156, 18, 0.2); }\n\n                @media (max-width: 768px) {\n                    .editor-body {\n                        flex-direction: column !important; \n                    }\n                    .splitter-bar-h { display: none !important; }\n                    .splitter-bar-v {\n                        display: flex !important;\n                        height: 12px; cursor: row-resize; background: #252526;\n                        border-top: 1px solid #333; border-bottom: 1px solid #000;\n                        align-items: center; justify-content: center; z-index: 20;\n                    }\n                    .splitter-handle {\n                        width: 40px; height: 4px; background: #555; border-radius: 2px;\n                    }\n                    .toolbar-container { flex-wrap: wrap; height: auto !important; padding: 10px !important; }\n                }\n            "}),(0,c.jsx)("div",{onMouseDown:()=>g(!0),style:{height:10,cursor:"ns-resize",background:"#252526",borderBottom:"1px solid #333",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,c.jsx)("div",{style:{width:40,height:4,background:"#555",borderRadius:2}})}),(0,c.jsxs)("div",{className:"toolbar-container",style:{minHeight:50,background:"#252526",display:"flex",alignItems:"center",padding:"5px 15px",gap:10,borderBottom:"1px solid #333"},children:[(0,c.jsx)("span",{style:{fontSize:20},children:"\ud83d\udc64"}),(0,c.jsxs)("select",{value:y,onChange:e=>{x(e.target.value)},style:zL.selectInput,children:[(0,c.jsx)("option",{value:"",children:"-- \u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 --"}),ne.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,c.jsxs)("select",{value:b,onChange:e=>w(e.target.value),disabled:!y,style:zL.selectInput,children:[(0,c.jsx)("option",{value:"Default",children:"\u041e\u0440\u0438\u0433\u0438\u043d\u0430\u043b (PSD)"}),z.map(e=>(0,c.jsx)("option",{value:e,children:e},e))]}),(0,c.jsx)("div",{style:{flex:1}}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[y&&"Default"!==b&&(0,c.jsxs)("button",{onClick:async()=>{if(!y||"Default"===b)return;if(!window.confirm('\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0435\u0441\u0435\u0442 "'.concat(b,'"?')))return;const e=s({},I);if(delete e[b],A(e),F(Object.keys(e)),w("Default"),i)try{await i(y,e)}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438: "+M2.message)}},className:"editor-btn btn-danger",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0440\u0435\u0441\u0435\u0442",children:["\ud83d\uddd1 ",(0,c.jsx)("span",{style:{display:window.innerWidth<600?"none":"inline"},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]}),y&&"Default"!==b&&(0,c.jsxs)("button",{onClick:async()=>{if(!y||"Default"===b)return;const e=S.map(e=>s(s({},e),{},{src:void 0,local_path:void 0})),t=s(s({},I),{},{[b]:e});if(A(t),i)try{await i(y,t),console.log("\u041f\u0440\u0435\u0441\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d")}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f: "+M2.message)}},className:"editor-btn btn-success",title:"\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0440\u0435\u0441\u0435\u0442",children:["\ud83d\udcbe ",(0,c.jsx)("span",{style:{display:window.innerWidth<600?"none":"inline"},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}),(0,c.jsxs)("button",{onClick:async()=>{if(!y)return;const e=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u0435\u0441\u0435\u0442\u0430:","NewPreset_".concat(Object.keys(I).length+1));if(!e||!e.trim())return;const t=e.trim();if(I[t]||"Default"===t)return void alert("\u041f\u0440\u0435\u0441\u0435\u0442 \u0441 \u0442\u0430\u043a\u0438\u043c \u0438\u043c\u0435\u043d\u0435\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!");const n=S.map(e=>s(s({},e),{},{src:void 0,local_path:void 0})),r=s(s({},I),{},{[t]:n});if(A(r),F(Object.keys(r)),w(t),i)try{await i(y,r)}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f: "+M2.message)}},disabled:!y,className:"editor-btn btn-primary",title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u043d\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0441\u0435\u0442",children:["\u2795 ",(0,c.jsx)("span",{style:{display:window.innerWidth<600?"none":"inline"},children:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0441\u0435\u0442"})]}),(0,c.jsx)("button",{onClick:r,className:"close-cross-btn",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440",children:"\u2715"})]})]}),(0,c.jsxs)("div",{className:"editor-body",children:[(0,c.jsxs)("div",{ref:Q,className:"preview-pane",style:{width:window.innerWidth>768?"".concat(p,"%"):"100%",height:window.innerWidth>768?"100%":"".concat(Z,"%"),cursor:U?"grabbing":"default",touchAction:"none",userSelect:"none"},onWheel:e=>{e.preventDefault();const t=e.deltaY>0?.9:1.1;N(e=>s(s({},e),{},{z:Math.max(.1,Math.min(5,e.z*t))}))},onMouseDown:e=>{if(!e.target.closest(".moveable-control-box")&&!e.target.closest("button")&&!e.target.closest(".nav-controls")){if(!Y&&M){const t=document.getElementById(M);if(t&&(e.target===t||t.contains(e.target)))return}"IMG"!==e.target.tagName&&T(null),V(!0),H({x:e.clientX-L.x,y:e.clientY-L.y})}},onMouseMove:e=>{U&&N(t=>s(s({},t),{},{x:e.clientX-W.x,y:e.clientY-W.y}))},onMouseUp:ee,onMouseLeave:ee,children:[(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"linear-gradient(45deg, #1a1a1a 25%, transparent 25%), linear-gradient(-45deg, #1a1a1a 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #1a1a1a 75%), linear-gradient(-45deg, transparent 75%, #1a1a1a 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",opacity:.2,pointerEvents:"none"}}),(0,c.jsx)("div",{style:{width:(null===a||void 0===a?void 0:a.height)||1280,height:(null===a||void 0===a?void 0:a.height)||720,transformOrigin:"0 0",transform:"translate(".concat(L.x,"px, ").concat(L.y,"px) scale(").concat(L.z,")"),border:"1px dashed rgba(100,100,100,0.5)",position:"absolute",background:"transparent",boxShadow:"0 0 50px rgba(0,0,0,0.5)",transition:U?"none":"transform 0.1s ease-out"},children:re.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(RL,{elements:re,resolution:a,selectedElementId:Y?null:M,onElementClick:(e,t)=>!Y&&T(t),isEditor:!0,activeFragmentData:{},isGlobal:!1,gameAreaBg:"transparent"}),!Y&&(0,c.jsx)(vB,{ref:P,target:ie,draggable:!0,resizable:!0,rotatable:!0,throttleDrag:0,throttleRotate:0,throttleResize:0,className:"character-moveable-control",onDrag:e=>{let{target:t,left:n,top:r}=e;t.style.left="".concat(n,"px"),t.style.top="".concat(r,"px")},onDragEnd:e=>{let{target:t}=e;const n=parseFloat(t.style.left),r=parseFloat(t.style.top);M&&oe(M,{x:n,y:r})},onRotate:e=>{let{target:t,transform:n}=e;t.style.transform=n},onRotateEnd:e=>{let{target:t}=e;const n=t.style.transform.match(/rotate\((-?\d+\.?\d*)deg\)/),r=n?parseFloat(n[1]):0;M&&oe(M,{rotate:r})},onResize:e=>{let{target:t,width:n,height:r,drag:o}=e;t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),t.style.left="".concat(o.left,"px"),t.style.top="".concat(o.top,"px")},onResizeEnd:e=>{let{target:t}=e;const n=parseFloat(t.style.width),r=parseFloat(t.style.height),o=parseFloat(t.style.left),i=parseFloat(t.style.top);M&&oe(M,{w:n,h:r,x:o,y:i})}})]}):(0,c.jsx)("div",{style:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center",color:"#555",fontSize:24/L.z},children:y?"\u041d\u0435\u0442 \u0432\u0438\u0434\u0438\u043c\u044b\u0445 \u0441\u043b\u043e\u0435\u0432":"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d"})}),G&&(0,c.jsxs)("div",{className:"nav-controls",onMouseDown:e=>e.stopPropagation(),children:[(0,c.jsx)("button",{className:"nav-btn ".concat(Y?"active":""),onClick:()=>q(!Y),title:Y?"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043b\u043e\u0438":"\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435",children:Y?"\ud83d\udd12":"\ud83d\udd13"}),(0,c.jsx)("div",{style:{width:1,background:"rgba(255,255,255,0.2)",margin:"0 5px"}}),(0,c.jsx)("button",{className:"nav-btn",onClick:()=>N(e=>s(s({},e),{},{z:1.2*e.z})),title:"Zoom In",children:"\u2795"}),(0,c.jsx)("button",{className:"nav-btn",onClick:()=>N(e=>s(s({},e),{},{z:.8*e.z})),title:"Zoom Out",children:"\u2796"}),(0,c.jsx)("button",{className:"nav-btn",onClick:te,title:"Fit to Screen",children:"\u26f6"})]}),(0,c.jsx)("button",{style:{position:"absolute",top:10,right:10,background:"rgba(0,0,0,0.5)",border:"none",color:"#fff",borderRadius:"4px",cursor:"pointer",padding:"4px 8px"},onClick:()=>X(!G),children:G?"Hide UI":"Show UI"})]}),(0,c.jsx)("div",{className:"splitter-bar-h",onMouseDown:()=>v(!0)}),(0,c.jsx)("div",{className:"splitter-bar-v",onMouseDown:e=>{e.preventDefault(),J(!0)},onTouchStart:e=>{e.stopPropagation(),J(!0)},style:{touchAction:"none"},children:(0,c.jsx)("div",{className:"splitter-handle"})}),(0,c.jsx)("div",{style:{flex:1,background:"#1e1e1e",display:"flex",flexDirection:"column",overflowY:"auto",borderLeft:window.innerWidth>768?"1px solid #000":"none",touchAction:"pan-y"},onTouchStart:e=>e.stopPropagation(),children:y?(0,c.jsx)($L,{layers:S,isSimpleMode:!0,assets:o,onUpdateLayerParam:(e,t,n)=>{k(r=>r.map(r=>r.id===e?s(s({},r),{},{[t]:n}):r))},selectedLayerId:M,onSelectLayer:e=>T(e),onSelectFolder:e=>T(e),onToggleFolderCollapse:e=>k(t=>t.map(t=>t.id===e?s(s({},t),{},{collapsed:!t.collapsed}):t)),onToggleFolderVisibility:e=>k(t=>t.map(t=>t.id===e?s(s({},t),{},{visible:!t.visible}):t)),onRemoveLayer:()=>{},bgFiles:[],onBgChange:()=>{},onAddLayer:()=>{},onAddFolder:()=>{},onPasteLayer:()=>{},onAddPsd:()=>{},onImportPsdData:()=>{},assetsMap:l}):(0,c.jsxs)("div",{style:{padding:40,color:"#666",textAlign:"center"},children:[(0,c.jsx)("h3",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439"}),(0,c.jsxs)("p",{children:["\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u043b\u0435\u0432\u0430 \u0441\u0432\u0435\u0440\u0445\u0443,",(0,c.jsx)("br",{}),"\u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u043b\u043e\u0438 \u0438 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u0435\u0441\u0435\u0442\u044b."]})]})})]})]}):null},fU={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",zIndex:2200,display:"flex",justifyContent:"center",alignItems:"center"},contentContainer:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},media:{maxWidth:"100%",maxHeight:"80vh",borderRadius:"4px",boxShadow:"0 5px 20px rgba(0,0,0,0.5)",outline:"none",background:"#000"},audioContainer:{background:"#252526",padding:"40px",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",minWidth:"300px"},closeBtn:{position:"absolute",top:-40,right:0,width:30,height:30,borderRadius:"50%",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"white",cursor:"pointer",fontWeight:"bold",fontSize:20,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s"},fileName:{color:"#e0e0e0",marginTop:"15px",fontSize:"14px",background:"rgba(0,0,0,0.6)",padding:"6px 12px",borderRadius:"20px",backdropFilter:"blur(4px)"}},gU=e=>{let{file:t,onClose:n,assetsMap:r}=e;if(!t)return null;const o=t.name.split(".").pop().toLowerCase(),i=["jpg","jpeg","png","webp","gif","svg","bmp","ico","avif"].includes(o),a=["mp4","webm","ogg","mov","mkv","avi"].includes(o),s=["mp3","wav","ogg","m4a","aac","flac"].includes(o),l=(()=>{if(r){if(t.file_id&&r[t.file_id])return r[t.file_id];if(t.local_path&&r[t.local_path])return r[t.local_path];if(t.url&&r[t.url])return r[t.url]}return t.url||t.local_path})(),d=e=>{t.local_path&&e.target.src!==t.local_path&&!e.target.src.includes(t.local_path)&&(e.target.src=t.local_path)};let u=null;return u=i?(0,c.jsx)("img",{src:l,style:fU.media,alt:t.name,onError:d}):a?(0,c.jsx)("video",{src:l,style:fU.media,controls:!0,autoPlay:!0,onError:d}):s?(0,c.jsxs)("div",{style:fU.audioContainer,children:[(0,c.jsx)("div",{style:{fontSize:"64px"},children:"\ud83c\udfb5"}),(0,c.jsx)("audio",{src:l,controls:!0,autoPlay:!0,style:{width:"100%"},onError:d})]}):(0,c.jsxs)("div",{style:fU.audioContainer,children:[(0,c.jsx)("div",{style:{fontSize:"64px"},children:"\ud83d\udcc4"}),(0,c.jsx)("div",{style:{color:"#fff",marginBottom:10},children:"\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"}),(0,c.jsx)("a",{href:l,download:t.name,className:"hover-btn",style:{color:"#fff",background:"#007acc",padding:"8px 16px",borderRadius:"4px",textDecoration:"none",fontSize:"14px"},children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b"})]}),(0,c.jsx)("div",{style:fU.overlay,onClick:n,children:(0,c.jsxs)("div",{style:fU.contentContainer,onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("button",{style:fU.closeBtn,onClick:n,onMouseOver:e=>e.currentTarget.style.background="rgba(211, 47, 47, 0.8)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"}),u,(0,c.jsx)("div",{style:fU.fileName,children:t.name})]})})},mU={sys_backgrounds:"Backgrounds",sys_characters:"Characters",sys_textures:"Textures",sys_objects:"Objects",sys_audio:"Audio",sys_fonts:"Fonts"},vU={sys_audio:"\u0414\u043b\u044f audio - \u0437\u0432\u0443\u043a\u0438 \u0438 \u043c\u0443\u0437\u044b\u043a\u0430.",sys_backgrounds:"\u0414\u043b\u044f backgrounds - \u0444\u043e\u043d\u044b \u0438 \u0441\u043b\u043e\u0438.",sys_characters:"\u0414\u043b\u044f characters - \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0438 (\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f PSD \u0441\u043e \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439).",sys_fonts:"\u0414\u043b\u044f font - \u0448\u0440\u0438\u0444\u0442\u044b.",sys_objects:"Objects - \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b.",sys_textures:"Textures - \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b UI."},yU={container:e=>({position:"relative",color:"#e0e0e0",fontFamily:'"Segoe UI", Roboto, Helvetica, Arial, sans-serif',backgroundColor:"#1e1e1e",height:"100%",width:"100%",boxSizing:"border-box",overflowY:"auto",display:"flex",flexDirection:"column"}),toolbar:{display:"flex",flexWrap:"wrap",gap:"8px",padding:"10px 15px",backgroundColor:"#252526",borderBottom:"1px solid #333",alignItems:"center",flexShrink:0},addressBarContainer:{display:"flex",alignItems:"center",background:"#3c3c3c",padding:"6px 12px",borderRadius:"4px",flex:"1 1 300px",border:"1px solid #555",fontSize:"14px",overflowX:"auto",whiteSpace:"nowrap",marginRight:"auto"},breadcrumbItem:{cursor:"pointer",color:"#cecece",padding:"2px 6px",borderRadius:"4px",transition:"background 0.2s",display:"flex",alignItems:"center"},breadcrumbSeparator:{color:"#888",margin:"0 2px",fontSize:"12px"},breadcrumbActive:{color:"#fff",fontWeight:"600"},btn:{padding:"8px 12px",cursor:"pointer",borderRadius:"4px",border:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s",display:"inline-flex",alignItems:"center",gap:"6px",lineHeight:"1.2",whiteSpace:"nowrap",flexShrink:0},btnPrimary:{background:"#007acc",color:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},btnDanger:{background:"#d32f2f",color:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(130px, 1fr))",gap:"20px",padding:"20px",alignContent:"start"},card:(e,t)=>({position:"relative",background:t?"rgba(0, 122, 204, 0.15)":e?"#37373d":"#2d2d2d",border:t||e?"2px solid #007acc":"1px solid #3e3e3e",borderRadius:"6px",padding:"10px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",cursor:"pointer",transform:t?"scale(1.05)":"transform 0.1s",transition:"transform 0.1s, background 0.2s, border-color 0.2s",height:"150px",boxShadow:e?"0 0 0 1px #007acc":t?"0 0 15px rgba(0, 122, 204, 0.5)":"none",overflow:"hidden",zIndex:t?60:1}),iconArea:{fontSize:"48px",marginBottom:"8px",opacity:.9},fileName:{fontSize:"12px",textAlign:"center",color:"#e0e0e0",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginTop:"auto"},previewImg:{width:"100%",height:"90px",objectFit:"cover",borderRadius:"4px",marginBottom:"6px",background:"#111"},checkbox:{position:"absolute",top:"8px",left:"8px",cursor:"pointer",transform:"scale(1.1)"},deleteBtn:{position:"absolute",top:"6px",right:"6px",color:"#fff",background:"#e53935",borderRadius:"4px",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",zIndex:1200,display:"flex",justifyContent:"center",alignItems:"center"},modalContent:{background:"#252526",padding:"10px",borderRadius:"8px",maxWidth:"90%",maxHeight:"90%",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},dragOverlay:{position:"absolute",top:10,left:10,right:10,bottom:10,border:"3px dashed #007acc",borderRadius:"12px",background:"rgba(30, 30, 30, 0.9)",zIndex:50,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#fff",pointerEvents:"none"},loadingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(3px)",zIndex:100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#fff"},spinner:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.1)",borderTop:"4px solid #007acc",borderRadius:"50%",marginBottom:"20px"},jsonEditorArea:{width:"800px",height:"500px",background:"#1e1e1e",color:"#d4d4d4",fontFamily:"monospace",border:"1px solid #3e3e3e",padding:"10px",resize:"none",outline:"none",fontSize:"14px"},modalActions:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"10px"},progressBarContainer:{width:"320px",height:"8px",background:"#333",borderRadius:"4px",overflow:"hidden",marginTop:"10px"},progressBarFill:e=>({height:"100%",width:"".concat(e,"%"),background:"#007acc",transition:"width 0.2s ease-out"})};const xU=e=>{if(!e)return!1;const t=/\.(jpg|jpeg|png|webp|gif|svg|avif|bmp)$/i;return!!t.test(e.name)||(!(!e.local_path||!t.test(e.local_path))||!(!e.extension||!/^(jpg|jpeg|png|webp|gif|svg|avif|bmp)$/i.test(e.extension)))};function bU(t){var n;let{assetsData:r,onUpdate:o,userId:i,storyId:a,presets:l,onSavePresets:d,resolution:u,onOpenCharEditor:p,assetsMap:h,onRegisterAsset:f}=t;const[g,m]=(0,e.useState)([]),[v,y]=(0,e.useState)(new Set),[x,b]=(0,e.useState)(null),[w,S]=(0,e.useState)(!1),[k,C]=(0,e.useState)(!1),[j,_]=(0,e.useState)(null),[E,D]=(0,e.useState)(!1),[M,T]=(0,e.useState)(null),[I,A]=(0,e.useState)({isOpen:!1,file:null,content:""}),[O,R]=(0,e.useState)(0),z=e=>{if(!e)return null;if(h){if(e.file_id&&h[e.file_id])return h[e.file_id];if(e.local_path&&h[e.local_path])return h[e.local_path];if(e.url&&h[e.url])return h[e.url]}return e.url||e.local_path};(0,e.useEffect)(()=>{let e;if(k&&null===j){R(0);const t=Date.now();e=setInterval(()=>{const e=Date.now()-t;let n=0;n=e<5e3?e/5e3*30:e<15e3?30+(e-5e3)/1e4*40:70+25*(1-Math.exp(-(e-15e3)/5e3)),R(Math.min(n,98))},200)}else R(0);return()=>clearInterval(e)},[k,j]);(0,e.useEffect)(()=>{if(!r)return;let e=!1;const t=s({},r);Object.entries(mU).forEach(n=>{let[r,o]=n;t[r]?t[r].name!==o&&(t[r]=s(s({},t[r]),{},{name:o}),e=!0):(t[r]={name:o,files:[]},e=!0)}),e&&o(t)},[r,o]);const F=(e,t,n)=>{const r=s({},e);if(0===t.length)return n(r),r;const o=t[0].id;if(!r[o])return r;r[o]=s({},r[o]);r[o];const i=(e,r)=>{if(r===t.length)return n(e);const o=t[r].id,a=e.files.findIndex(e=>e.id===o);if(-1===a)return e;const l=[...e.files];return l[a]=s({},l[a]),l[a]=i(l[a],r+1),s(s({},e),{},{files:l})};return r[o]=i(r[o],1),r},P=((e,t)=>{if(0===t.length)return Object.entries(e).map(e=>{let[t,n]=e;return s(s({id:t},n),{},{type:"folder",isSystem:mU.hasOwnProperty(t)})});let n=e[t[0].id];if(!n)return[];for(let o=1;o<t.length;o++){var r;const e=t[o].id,i=null===(r=n.files)||void 0===r?void 0:r.find(t=>t.id===e||t.name===e);if(!i||"folder"!==i.type&&"character_folder"!==i.type)return[];n=i}return(n.files||[]).map((e,t)=>s(s({},e),{},{internalId:t}))})(r||{},g),B=(g.length>0&&g[g.length-1].id,e=>{m(-1===e?[]:g.slice(0,e+1)),y(new Set)}),L=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=new FormData;o.append("file",e,n||e.name),o.append("user_id",i);const s=/\.(png|webp|avif|svg|gif|webm|tiff|bmp)$/i.test(n||e.name);(r||s||e.size>4194304)&&o.append("force_document","true");try{const r=await fetch("/api/upload_media",{method:"POST",body:o}),s=await r.json();if(!s.file_id)throw new Error(s.error||"Upload failed");const l=await fetch("/api/html/ensure_local/".concat(i,"/").concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_id:s.file_id,type:s.type,target_folder:t,extension:s.extension})}),c=await l.json(),d=URL.createObjectURL(e);return f&&f(s.file_id,d),null===j&&R(100),{id:"file_".concat(Date.now(),"_").concat(Math.random()),file_id:s.file_id,type:s.type,name:n||e.name,local_path:c.local_path||"",extension:s.extension,url:s.direct_url||null}}catch(M2){throw console.error(M2),M2}},N=async(e,t)=>{var n;if(!e.length)return;const i=e.find(e=>e.name.toLowerCase().endsWith(".psd")),a=0===t.length||"sys_characters"===t[0].id;if(i&&a)return void await(async e=>{if(e.size>209715200)alert("\u0424\u0430\u0439\u043b ".concat(e.name," \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439."));else{C(!0),_({current:0,total:0,status:"Parsing PSD..."});try{const t=await e.arrayBuffer(),n=(0,oT.readPsd)(t,{skipLayerData:!1});let i=0;const a=e=>{e.forEach(e=>{e.canvas&&i++,e.children&&a(e.children)})};n.children&&a(n.children),_({current:0,total:i,status:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043b\u043e\u0451\u0432..."});const l=e.name.replace(/\.psd$/i,"").replace(/[^a-zA-Z0-9\u0430-\u044f\u0410-\u042f0-9_\-]/g,"_"),c="sys_characters/".concat(l),d=async(e,t)=>{const n={name:e.name,visible:!e.hidden,opacity:e.opacity,blendMode:e.blendMode,left:e.left,top:e.top,width:e.width,height:e.height,_uniqueId:"layer_".concat(Math.random().toString(36).substr(2,9))};if(e.children){n.type="folder",n.id="folder_".concat(Math.random().toString(36).substr(2,9)),n.files=[];const r=e.name.replace(/[^a-z0-9\u0430-\u044f_]/gi,"_"),o="".concat(t,"/").concat(r),i=[...e.children].reverse();for(const e of i){const t=await d(e,o);t&&n.files.push(t)}return n}if(e.canvas){const o=await new Promise(t=>e.canvas.toBlob(t,"image/png")),a=e.name.replace(/[^a-z0-9\u0430-\u044f_]/gi,"_")+".png";try{const e=await L(o,t,a,!0);return _(e=>s(s({},e),{},{current:(e.current||0)+1,status:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043b\u043e\u0451\u0432: ".concat(e.current+1," / ").concat(i)})),s(s(s({},n),e),{},{type:"image"})}catch(r){return console.error("Layer upload error",r),null}}return null},u=[];if(n.children){const e=[...n.children].reverse();for(const t of e){const e=await d(t,c);e&&u.push(e)}}const p={id:"char_".concat(Date.now()),name:l,type:"character_folder",files:u,structure:{originalName:e.name,width:n.width,height:n.height,layers:u},presets:{}},h=F(r,[{id:"sys_characters"}],e=>s(s({},e),{},{files:[p,...e.files||[]]}));o(h),alert("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 ".concat(l," \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d!"))}catch(M2){console.error(M2),alert("PSD Error: "+M2.message)}finally{C(!1),_(null)}}})(i);if(0===t.length)return void alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0430\u043f\u043a\u0443 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432.");const l=t[0].id,c=mU[l]||(null===(n=r[l])||void 0===n?void 0:n.name)||l,d=t.slice(1).map(e=>e.name),u=[c,...d].join("/");C(!0);try{const n=await async function(e,t,n,r){let o=0;const i=[],a=[],s=()=>{if(o===e.length)return Promise.resolve();const l=o++,c=e[l],d=Promise.resolve().then(()=>n(c));i.push(d);const u=d.then(e=>(a.splice(a.indexOf(u),1),r&&r(),e));a.push(u);let p=Promise.resolve();return a.length>=t&&(p=Promise.race(a)),p.then(()=>s())};return await s(),Promise.all(i)}(e,3,async e=>await L(e,u)),i=n.filter(Boolean);if(i.length>0){const e=F(r,t,e=>s(s({},e),{},{files:[...e.files||[],...i]}));o(e)}}catch(M2){alert("Upload error: "+M2.message)}finally{setTimeout(()=>C(!1),500)}},U=0===g.length,V=!U&&"sys_characters"===g[0].id;return(0,c.jsxs)("div",{style:yU.container(E),onDragOver:e=>{e.preventDefault(),D(!0)},onDragLeave:e=>{e.currentTarget.contains(e.relatedTarget)||D(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),D(!1),T(null);const t=Array.from(e.dataTransfer.files);t.length>0&&N(t,g)},children:[(0,c.jsx)("style",{children:'\n                @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }\n                ::-webkit-scrollbar { width: 8px; }\n                ::-webkit-scrollbar-track { background: #1e1e1e; }\n                ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }\n                ::-webkit-scrollbar-thumb:hover { background: #555; }\n                .hover-btn:hover { filter: brightness(1.1); }\n\n                /* \u0410\u0434\u0430\u043f\u0442\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u043a\u0438 \u0434\u043b\u044f \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0445 */\n                @media (max-width: 480px) {\n                    /* \u0423\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u043c \u0440\u0430\u0437\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a \u043d\u0430 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0435 */\n                    div[style*="grid-template-columns"] {\n                        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)) !important;\n                        gap: 10px !important;\n                        padding: 10px !important;\n                    }\n                }\n            '}),E&&!M&&(0,c.jsxs)("div",{style:yU.dragOverlay,children:[(0,c.jsx)("div",{style:{fontSize:60,marginBottom:20},children:"\ud83d\udcc2"}),(0,c.jsx)("h3",{children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438"})]}),k&&(0,c.jsxs)("div",{style:yU.loadingOverlay,children:[(0,c.jsx)("div",{style:s(s({},yU.spinner),{},{animation:"spin 0.8s linear infinite"})}),(0,c.jsx)("h3",{style:{margin:0,fontWeight:400},children:(null===j||void 0===j?void 0:j.status)||"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432..."}),(null===j||void 0===j?void 0:j.total)>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginTop:10,fontSize:"12px",color:"#aaa"},children:[Math.round(j.current/j.total*100),"%"]}),(0,c.jsx)("div",{style:yU.progressBarContainer,children:(0,c.jsx)("div",{style:yU.progressBarFill(j.current/j.total*100)})})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginTop:10,fontSize:"12px",color:"#aaa"},children:[Math.round(O),"%"]}),(0,c.jsx)("div",{style:yU.progressBarContainer,children:(0,c.jsx)("div",{style:yU.progressBarFill(O)})})]})]}),(0,c.jsxs)("div",{style:yU.toolbar,children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",flex:"1 1 100%",width:"100%",alignItems:"center"},children:[!U&&(0,c.jsx)("button",{className:"hover-btn",style:s(s({},yU.btn),{},{background:"#333",color:"#fff",padding:"8px 10px"}),onClick:()=>{m(g.slice(0,-1)),y(new Set)},title:"\u041d\u0430 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0432\u044b\u0448\u0435",children:"\u2b05"}),(0,c.jsxs)("div",{style:yU.addressBarContainer,children:[(0,c.jsx)("span",{style:s(s({},yU.breadcrumbItem),U?yU.breadcrumbActive:{}),onClick:()=>B(-1),title:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u0432 \u043a\u043e\u0440\u0435\u043d\u044c",children:"\ud83d\udcc1 Root"}),g.map((t,n)=>{const r=n===g.length-1;return(0,c.jsxs)(e.Fragment,{children:[(0,c.jsx)("span",{style:yU.breadcrumbSeparator,children:"\u203a"}),(0,c.jsx)("span",{style:s(s({},yU.breadcrumbItem),r?yU.breadcrumbActive:{}),onClick:()=>B(n),children:t.name})]},n)})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginLeft:"auto"},children:[(0,c.jsx)("button",{className:"hover-btn",style:s(s(s({},yU.btn),yU.btnPrimary),{},{background:"#3a3d41"}),onClick:()=>{let e=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043d\u043e\u0432\u043e\u0439 \u043f\u0430\u043f\u043a\u0438:");if(!e)return;const t=(e=>{let t=e.trim();return t=t.replace(/[\\/\s]/g,"_"),t=t.replace(/[<>:"|?*]/g,""),t=t.replace(/[\x00-\x1F\x7F]/g,""),t=t.replace(/^\.+|\.+$/g,""),t||"New_Folder"})(e),n={id:"folder_".concat(Date.now()),name:t,type:"folder",files:[]},i=F(r,g,e=>0===g.length?e[t]?(alert("\u041f\u0430\u043f\u043a\u0430 \u0441 \u0442\u0430\u043a\u0438\u043c \u0438\u043c\u0435\u043d\u0435\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!"),e):(n.id=t,e[t]=n,e):s(s({},e),{},{files:[...e.files||[],n]}));o(i)},children:"\u2795 \u041f\u0430\u043f\u043a\u0430"}),!U&&(0,c.jsxs)("label",{className:"hover-btn",style:s(s({},yU.btn),yU.btnPrimary),children:["\ud83d\udce4 ",(0,c.jsx)("span",{style:{display:"inline-block"},children:V?"PSD":"\u0424\u0430\u0439\u043b"}),(0,c.jsx)("input",{type:"file",hidden:!0,multiple:!0,onChange:e=>{N(Array.from(e.target.files),g),e.target.value=""},accept:V?".psd":"*/*"})]}),v.size>0&&(0,c.jsxs)("button",{className:"hover-btn",style:s(s({},yU.btn),yU.btnDanger),onClick:()=>{if(!window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b?"))return;const e=F(r,g,e=>{if(0===g.length)return v.forEach(t=>{mU[t]||delete e[t]}),e;{const t=e.files.filter((e,t)=>!v.has(t));return s(s({},e),{},{files:t})}});o(e),y(new Set)},children:["\ud83d\uddd1 ",(0,c.jsx)("span",{style:{display:"none","@media (min-width: 600px)":{display:"inline"}},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})," (",v.size,")"]})]})]}),(0,c.jsx)("div",{style:yU.grid,children:P.map(e=>{var t;const n=v.has(void 0!==e.internalId?e.internalId:e.id),i="folder"===e.type||"character_folder"===e.type,a=M===e.id;return(0,c.jsxs)("div",{style:yU.card(n,a),onClick:()=>{return i?(t=e,m([...g,{id:t.id,name:t.name}]),void y(new Set)):(async e=>{if(e.name.endsWith(".json")){try{const t=await fetch(e.local_path),n=await t.text();A({isOpen:!0,file:e,content:n})}catch(M2){alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b")}return}let t=e;if(!/\.[a-z0-9]+$/i.test(e.name)){const n=e.local_path?e.local_path.match(/\.([a-z0-9]+)$/i):null,r=n?n[1]:e.extension||"dat";t=s(s({},e),{},{name:"".concat(e.name,".").concat(r)})}b(t)})(e);var t},onDragOver:t=>{i&&(t.preventDefault(),t.stopPropagation(),T(e.id))},onDragLeave:e=>{e.currentTarget.contains(e.relatedTarget)||T(null)},onDrop:t=>{i&&((e,t)=>{e.preventDefault(),e.stopPropagation(),D(!1),T(null);const n=[...g,{id:t.id,name:t.name}],r=Array.from(e.dataTransfer.files);r.length>0&&N(r,n)})(t,e)},children:[(0,c.jsx)("input",{type:"checkbox",style:yU.checkbox,checked:n,onClick:t=>((e,t)=>{e.stopPropagation();const n=void 0!==t.internalId?t.internalId:t.id,r=new Set(v);r.has(n)?r.delete(n):r.add(n),y(r)})(t,e),onChange:()=>{}}),!e.isSystem&&(0,c.jsx)("div",{className:"hover-btn",style:yU.deleteBtn,onClick:t=>((e,t)=>{e.stopPropagation();const n=void 0!==t.internalId?t.internalId:t.id;if(0===g.length&&mU[t.id])return void alert("\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u043d\u0435\u043b\u044c\u0437\u044f \u0443\u0434\u0430\u043b\u0438\u0442\u044c.");if(!window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442?"))return;const i=F(r,g,e=>{if(0===g.length)return delete e[n],e;{const t=e.files.filter((e,t)=>t!==n);return s(s({},e),{},{files:t})}});o(i)})(t,e),title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:"\xd7"}),i?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,c.jsx)("div",{style:{fontSize:"50px",lineHeight:1},children:"character_folder"===e.type?"\ud83c\udfad":mU[e.id]?"\ud83d\uddc2\ufe0f":"\ud83d\udcc1"})}),(0,c.jsx)("div",{style:yU.fileName,children:e.name}),(0,c.jsxs)("div",{style:{fontSize:10,color:"#888",marginTop:2},children:[(null===(t=e.files)||void 0===t?void 0:t.length)||0," \u0444\u0430\u0439\u043b\u043e\u0432"]})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{flex:1,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:xU(e)?(0,c.jsx)("img",{src:z(e),style:yU.previewImg,alt:"",onError:t=>{e.local_path&&!t.target.src.includes(e.local_path)&&(t.target.src=e.local_path)}}):(0,c.jsx)("div",{style:yU.iconArea,children:"\ud83d\udcc4"})}),(0,c.jsx)("div",{style:yU.fileName,title:e.name,children:e.name})]})]},e.id||e.internalId)})}),0===P.length&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"50%",color:"#666",marginTop:50},children:[(0,c.jsx)("div",{style:{fontSize:40,marginBottom:10,opacity:.3},children:"\ud83d\udced"}),(0,c.jsx)("div",{children:g.length>0?vU[g[g.length-1].id]||"\u041f\u0430\u043f\u043a\u0430 \u043f\u0443\u0441\u0442\u0430":"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043f\u0430\u043f\u043a\u0438"}),!U&&(0,c.jsx)("div",{style:{fontSize:12,marginTop:5},children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430"})]}),V&&(0,c.jsx)("div",{style:{position:"fixed",bottom:80,right:20,zIndex:90},children:(0,c.jsxs)("button",{className:"hover-btn",style:s(s({},yU.btn),{},{background:"#007acc",padding:"12px 20px",borderRadius:"30px",fontSize:"15px",boxShadow:"0 4px 15px rgba(0,0,0,0.4)",border:"2px solid rgba(255,255,255,0.1)"}),onClick:()=>p?p():alert("\u0424\u0443\u043d\u043a\u0446\u0438\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430"),children:["\ud83c\udfad ",(0,c.jsx)("span",{style:{marginLeft:5},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439"})]})}),x&&(0,c.jsx)(gU,{file:x,assetsMap:h,onClose:()=>b(null)}),I.isOpen&&(0,c.jsx)("div",{style:yU.modalOverlay,onClick:()=>A(s(s({},I),{},{isOpen:!1})),children:(0,c.jsxs)("div",{style:s(s({},yU.modalContent),{},{cursor:"default"}),onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h3",{style:{color:"#ddd",marginTop:0},children:["\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435: ",null===(n=I.file)||void 0===n?void 0:n.name]}),(0,c.jsx)("textarea",{style:yU.jsonEditorArea,value:I.content,onChange:e=>A(s(s({},I),{},{content:e.target.value})),spellCheck:!1}),(0,c.jsxs)("div",{style:yU.modalActions,children:[(0,c.jsx)("button",{style:yU.btn,onClick:()=>A(s(s({},I),{},{isOpen:!1})),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{style:s(s({},yU.btn),yU.btnPrimary),onClick:async()=>{if(I.file)try{const t=new Blob([I.content],{type:"application/json"}),n=g.length>0?g[0].id:null;let o="";if(n){var e;const t=mU[n]||(null===(e=r[n])||void 0===e?void 0:e.name),i=g.slice(1).map(e=>e.name);o=[t,...i].join("/")}else o="";await L(t,o,I.file.name,!0),alert("\u0424\u0430\u0439\u043b \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d!"),A({isOpen:!1,file:null,content:""})}catch(M2){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f: "+M2.message)}},children:"\ud83d\udcbe \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})]})}const wU=(0,e.createContext)({});function SU(t){const n=(0,e.useRef)(null);return null===n.current&&(n.current=t()),n.current}const kU="undefined"!==typeof window,CU=kU?e.useLayoutEffect:e.useEffect,jU=(0,e.createContext)(null);function _U(e){return"object"===typeof e&&null!==e}function EU(e){return _U(e)&&"offsetHeight"in e}const DU=(0,e.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function MU(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function TU(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.useCallback(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const r=t.map(t=>{const r=MU(t,e);return n||"function"!==typeof r||(n=!0),r});if(n)return()=>{for(let e=0;e<r.length;e++){const n=r[e];"function"===typeof n?n():MU(t[e],null)}}}}(...n),n)}class IU extends e.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=EU(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function AU(t){let{children:n,isPresent:r,anchorX:o,root:i}=t;const a=(0,e.useId)(),s=(0,e.useRef)(null),l=(0,e.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=(0,e.useContext)(DU),u=TU(s,null===n||void 0===n?void 0:n.ref);return(0,e.useInsertionEffect)(()=>{const{width:e,height:t,top:n,left:c,right:u}=l.current;if(r||!s.current||!e||!t)return;const p="left"===o?"left: ".concat(c):"right: ".concat(u);s.current.dataset.motionPopId=a;const h=document.createElement("style");d&&(h.nonce=d);const f=null!==i&&void 0!==i?i:document.head;return f.appendChild(h),h.sheet&&h.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat(p,"px !important;\n            top: ").concat(n,"px !important;\n          }\n        ")),()=>{f.contains(h)&&f.removeChild(h)}},[r]),(0,c.jsx)(IU,{isPresent:r,childRef:s,sizeRef:l,children:e.cloneElement(n,{ref:u})})}const OU=t=>{let{children:n,initial:r,isPresent:o,onExitComplete:i,custom:a,presenceAffectsLayout:l,mode:d,anchorX:u,root:p}=t;const h=SU(RU),f=(0,e.useId)();let g=!0,m=(0,e.useMemo)(()=>(g=!1,{id:f,initial:r,isPresent:o,custom:a,onExitComplete:e=>{h.set(e,!0);for(const t of h.values())if(!t)return;i&&i()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[o,h,i]);return l&&g&&(m=s({},m)),(0,e.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[o]),e.useEffect(()=>{!o&&!h.size&&i&&i()},[o]),"popLayout"===d&&(n=(0,c.jsx)(AU,{isPresent:o,anchorX:u,root:p,children:n})),(0,c.jsx)(jU.Provider,{value:m,children:n})};function RU(){return new Map}function zU(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=(0,e.useContext)(jU);if(null===n)return[!0,null];const{isPresent:r,onExitComplete:o,register:i}=n,a=(0,e.useId)();(0,e.useEffect)(()=>{if(t)return i(a)},[t]);const s=(0,e.useCallback)(()=>t&&o&&o(a),[a,o,t]);return!r&&o?[!1,s]:[!0]}const FU=e=>e.key||"";function PU(t){const n=[];return e.Children.forEach(t,t=>{(0,e.isValidElement)(t)&&n.push(t)}),n}const BU=t=>{let{children:n,custom:r,initial:o=!0,onExitComplete:i,presenceAffectsLayout:a=!0,mode:s="sync",propagate:l=!1,anchorX:d="left",root:u}=t;const[p,h]=zU(l),f=(0,e.useMemo)(()=>PU(n),[n]),g=l&&!p?[]:f.map(FU),m=(0,e.useRef)(!0),v=(0,e.useRef)(f),y=SU(()=>new Map),[x,b]=(0,e.useState)(f),[w,S]=(0,e.useState)(f);CU(()=>{m.current=!1,v.current=f;for(let e=0;e<w.length;e++){const t=FU(w[e]);g.includes(t)?y.delete(t):!0!==y.get(t)&&y.set(t,!1)}},[w,g.length,g.join("-")]);const k=[];if(f!==x){let e=[...f];for(let t=0;t<w.length;t++){const n=w[t],r=FU(n);g.includes(r)||(e.splice(t,0,n),k.push(n))}return"wait"===s&&k.length&&(e=k),S(PU(e)),b(f),null}const{forceRender:C}=(0,e.useContext)(wU);return(0,c.jsx)(c.Fragment,{children:w.map(e=>{const t=FU(e),n=!(l&&!p)&&(f===w||g.includes(t));return(0,c.jsx)(OU,{isPresent:n,initial:!(m.current&&!o)&&void 0,custom:r,presenceAffectsLayout:a,mode:s,root:u,onExitComplete:n?void 0:()=>{if(!y.has(t))return;y.set(t,!0);let e=!0;y.forEach(t=>{t||(e=!1)}),e&&(null===C||void 0===C||C(),S(v.current),l&&(null===h||void 0===h||h()),i&&i())},anchorX:d,children:e},t)})})},LU=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],NU=(()=>new Set(LU))(),UU=e=>180*e/Math.PI,VU=e=>{const t=UU(Math.atan2(e[1],e[0]));return HU(t)},WU={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:VU,rotateZ:VU,skewX:e=>UU(Math.atan(e[1])),skewY:e=>UU(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},HU=e=>((e%=360)<0&&(e+=360),e),GU=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),XU=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),YU={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:GU,scaleY:XU,scale:e=>(GU(e)+XU(e))/2,rotateX:e=>HU(UU(Math.atan2(e[6],e[5]))),rotateY:e=>HU(UU(Math.atan2(-e[2],e[0]))),rotateZ:VU,rotate:VU,skewX:e=>UU(Math.atan(e[4])),skewY:e=>UU(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function qU(e){return e.includes("scale")?1:0}function ZU(e,t){if(!e||"none"===e)return qU(t);const n=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let r,o;if(n)r=YU,o=n;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);r=WU,o=t}if(!o)return qU(t);const i=r[t],a=o[1].split(",").map($U);return"function"===typeof i?i(a):a[i]}function $U(e){return parseFloat(e.trim())}const KU=e=>t=>"string"===typeof t&&t.startsWith(e),JU=KU("--"),QU=KU("var(--"),eV=e=>!!QU(e)&&tV.test(e.split("/*")[0].trim()),tV=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i;function nV(e){let{top:t,left:n,right:r,bottom:o}=e;return{x:{min:n,max:r},y:{min:t,max:o}}}const rV=(e,t,n)=>e+(t-e)*n;function oV(e){return void 0===e||1===e}function iV(e){let{scale:t,scaleX:n,scaleY:r}=e;return!oV(t)||!oV(n)||!oV(r)}function aV(e){return iV(e)||sV(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function sV(e){return lV(e.x)||lV(e.y)}function lV(e){return e&&"0%"!==e}function cV(e,t,n){return n+t*(e-n)}function dV(e,t,n,r,o){return void 0!==o&&(e=cV(e,o,r)),cV(e,n,r)+t}function uV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;e.min=dV(e.min,t,n,r,o),e.max=dV(e.max,t,n,r,o)}function pV(e,t){let{x:n,y:r}=t;uV(e.x,n.translate,n.scale,n.originPoint),uV(e.y,r.translate,r.scale,r.originPoint)}const hV=.999999999999,fV=1.0000000000001;function gV(e,t){e.min=e.min+t,e.max=e.max+t}function mV(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;uV(e,t,n,rV(e.min,e.max,o),r)}function vV(e,t){mV(e.x,t.x,t.scaleX,t.scale,t.originX),mV(e.y,t.y,t.scaleY,t.scale,t.originY)}function yV(e,t){return nV(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const xV=new Set(["width","height","top","left","right","bottom",...LU]),bV=(e,t,n)=>n>t?t:n<e?e:n,wV={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},SV=s(s({},wV),{},{transform:e=>bV(0,1,e)}),kV=s(s({},wV),{},{default:1}),CV=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),jV=CV("deg"),_V=CV("%"),EV=CV("px"),DV=CV("vh"),MV=CV("vw"),TV=(()=>s(s({},_V),{},{parse:e=>_V.parse(e)/100,transform:e=>_V.transform(100*e)}))(),IV=e=>t=>t.test(e),AV=[wV,EV,_V,jV,MV,DV,{test:e=>"auto"===e,parse:e=>e}],OV=e=>AV.find(IV(e));const RV=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),zV=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function FV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[r,o]=function(e){const t=zV.exec(e);if(!t)return[,];const[,n,r,o]=t;return["--".concat(null!==n&&void 0!==n?n:r),o]}(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const e=i.trim();return RV(e)?parseFloat(e):e}return eV(o)?FV(o,t,n+1):o}const PV=e=>e===wV||e===EV,BV=new Set(["x","y","z"]),LV=LU.filter(e=>!BV.has(e));const NV={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:o="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(o)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:o="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(o)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return ZU(n,"x")},y:(e,t)=>{let{transform:n}=t;return ZU(n,"y")}};NV.translateX=NV.x,NV.translateY=NV.y;const UV=e=>e,VV={},WV=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],HV={value:null,addProjectionMetrics:null};function GV(e,t){let n=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=WV.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,r=new Set,o=!1,i=!1;const a=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){a.has(t)&&(d.schedule(t),e()),l++,t(s)}const d={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&o?n:r;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&a.add(e),t.has(e)||t.add(e),e},cancel:e=>{r.delete(e),a.delete(e)},process:e=>{s=e,o?i=!0:(o=!0,[n,r]=[r,n],n.forEach(c),t&&HV.value&&HV.value.frameloop[t].push(l),l=0,n.clear(),o=!1,i&&(i=!1,d.process(e)))}};return d}(i,t?n:void 0),e),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:p,render:h,postRender:f}=a,g=()=>{const i=VV.useManualTiming?o.timestamp:performance.now();n=!1,VV.useManualTiming||(o.delta=r?1e3/60:Math.max(Math.min(i-o.timestamp,40),1)),o.timestamp=i,o.isProcessing=!0,s.process(o),l.process(o),c.process(o),d.process(o),u.process(o),p.process(o),h.process(o),f.process(o),o.isProcessing=!1,n&&t&&(r=!1,e(g))},m=WV.reduce((t,i)=>{const s=a[i];return t[i]=function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,o.isProcessing||e(g)),s.schedule(t,i,a)},t},{});return{schedule:m,cancel:e=>{for(let t=0;t<WV.length;t++)a[WV[t]].cancel(e)},state:o,steps:a}}const{schedule:XV,cancel:YV,state:qV,steps:ZV}=GV("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:UV,!0),$V=new Set;let KV=!1,JV=!1,QV=!1;function eW(){if(JV){const e=Array.from($V).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return LV.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(t=>{var n;let[r,o]=t;null===(n=e.getValue(r))||void 0===n||n.set(o)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}JV=!1,KV=!1,$V.forEach(e=>e.complete(QV)),$V.clear()}function tW(){$V.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(JV=!0)})}class nW{constructor(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=o,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?($V.add(this),KV||(KV=!0,XV.read(tW),XV.resolveKeyframes(eW))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const o=null===r||void 0===r?void 0:r.get(),i=e[e.length-1];if(void 0!==o)e[0]=o;else if(n&&t){const r=n.readValue(t,i);void 0!==r&&null!==r&&(e[0]=r)}void 0===e[0]&&(e[0]=i),r&&void 0===o&&r.set(e[0])}!function(e){for(let n=1;n<e.length;n++){var t;null!==(t=e[n])&&void 0!==t||(e[n]=e[n-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),$V.delete(this)}cancel(){"scheduled"===this.state&&($V.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const rW=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function oW(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||rW(e))}const iW=e=>Math.round(1e5*e)/1e5,aW=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const sW=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,lW=(e,t)=>n=>Boolean("string"===typeof n&&sW.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),cW=(e,t,n)=>r=>{if("string"!==typeof r)return r;const[o,i,a,s]=r.match(aW);return{[e]:parseFloat(o),[t]:parseFloat(i),[n]:parseFloat(a),alpha:void 0!==s?parseFloat(s):1}},dW=s(s({},wV),{},{transform:e=>Math.round((e=>bV(0,255,e))(e))}),uW={test:lW("rgb","red"),parse:cW("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:o=1}=e;return"rgba("+dW.transform(t)+", "+dW.transform(n)+", "+dW.transform(r)+", "+iW(SV.transform(o))+")"}};const pW={test:lW("#"),parse:function(e){let t="",n="",r="",o="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),o=e.substring(4,5),t+=t,n+=n,r+=r,o+=o),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}},transform:uW.transform},hW={test:lW("hsl","hue"),parse:cW("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:o=1}=e;return"hsla("+Math.round(t)+", "+_V.transform(iW(n))+", "+_V.transform(iW(r))+", "+iW(SV.transform(o))+")"}},fW={test:e=>uW.test(e)||pW.test(e)||hW.test(e),parse:e=>uW.test(e)?uW.parse(e):hW.test(e)?hW.parse(e):pW.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?uW.transform(e):hW.transform(e),getAnimatableNone:e=>{const t=fW.parse(e);return t.alpha=0,fW.transform(t)}},gW=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const mW="number",vW="color",yW=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function xW(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},o=[];let i=0;const a=t.replace(yW,e=>(fW.test(e)?(r.color.push(i),o.push(vW),n.push(fW.parse(e))):e.startsWith("var(")?(r.var.push(i),o.push("var"),n.push(e)):(r.number.push(i),o.push(mW),n.push(parseFloat(e))),++i,"${}")).split("${}");return{values:n,split:a,indexes:r,types:o}}function bW(e){return xW(e).values}function wW(e){const{split:t,types:n}=xW(e),r=t.length;return e=>{let o="";for(let i=0;i<r;i++)if(o+=t[i],void 0!==e[i]){const t=n[i];o+=t===mW?iW(e[i]):t===vW?fW.transform(e[i]):e[i]}return o}}const SW=e=>"number"===typeof e?0:fW.test(e)?fW.getAnimatableNone(e):e;const kW={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(aW))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(gW))||void 0===n?void 0:n.length)||0)>0},parse:bW,createTransformer:wW,getAnimatableNone:function(e){const t=bW(e);return wW(e)(t.map(SW))}},CW=new Set(["brightness","contrast","saturate","opacity"]);function jW(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(aW)||[];if(!r)return e;const o=n.replace(r,"");let i=CW.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+o+")"}const _W=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,EW=s(s({},kW),{},{getAnimatableNone:e=>{const t=e.match(_W);return t?t.map(jW).join(" "):e}}),DW=s(s({},wV),{},{transform:Math.round}),MW=s(s({borderWidth:EV,borderTopWidth:EV,borderRightWidth:EV,borderBottomWidth:EV,borderLeftWidth:EV,borderRadius:EV,radius:EV,borderTopLeftRadius:EV,borderTopRightRadius:EV,borderBottomRightRadius:EV,borderBottomLeftRadius:EV,width:EV,maxWidth:EV,height:EV,maxHeight:EV,top:EV,right:EV,bottom:EV,left:EV,padding:EV,paddingTop:EV,paddingRight:EV,paddingBottom:EV,paddingLeft:EV,margin:EV,marginTop:EV,marginRight:EV,marginBottom:EV,marginLeft:EV,backgroundPositionX:EV,backgroundPositionY:EV},{rotate:jV,rotateX:jV,rotateY:jV,rotateZ:jV,scale:kV,scaleX:kV,scaleY:kV,scaleZ:kV,skew:jV,skewX:jV,skewY:jV,distance:EV,translateX:EV,translateY:EV,translateZ:EV,x:EV,y:EV,z:EV,perspective:EV,transformPerspective:EV,opacity:SV,originX:TV,originY:TV,originZ:EV}),{},{zIndex:DW,fillOpacity:SV,strokeOpacity:SV,numOctaves:DW}),TW=s(s({},MW),{},{color:fW,backgroundColor:fW,outlineColor:fW,fill:fW,stroke:fW,borderColor:fW,borderTopColor:fW,borderRightColor:fW,borderBottomColor:fW,borderLeftColor:fW,filter:EW,WebkitFilter:EW}),IW=e=>TW[e];function AW(e,t){let n=IW(e);return n!==EW&&(n=kW),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const OW=new Set(["auto","none","0"]);class RW extends nW{constructor(e,t,n,r,o){super(e,t,n,r,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let s=0;s<e.length;s++){let n=e[s];if("string"===typeof n&&(n=n.trim(),eV(n))){const r=FV(n,t.current);void 0!==r&&(e[s]=r),s===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!xV.has(n)||2!==e.length)return;const[r,o]=e,i=OV(r),a=OV(o);if(i!==a)if(PV(i)&&PV(a))for(let s=0;s<e.length;s++){const t=e[s];"string"===typeof t&&(e[s]=parseFloat(t))}else NV[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(null===e[r]||oW(e[r]))&&n.push(r);n.length&&function(e,t,n){let r,o=0;for(;o<e.length&&!r;){const t=e[o];"string"===typeof t&&!OW.has(t)&&xW(t).values.length&&(r=e[o]),o++}if(r&&n)for(const i of t)e[i]=AW(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=NV[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const o=t.getValue(n);o&&o.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=NV[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[n,r]=e;t.getValue(n).set(r)}),this.resolveNoneKeyframes()}}const zW=e=>Boolean(e&&e.getVelocity);let FW;function PW(){FW=void 0}const BW={now:()=>(void 0===FW&&BW.set(qV.isProcessing||VV.useManualTiming?qV.timestamp:performance.now()),FW),set:e=>{FW=e,queueMicrotask(PW)}};function LW(e,t){-1===e.indexOf(t)&&e.push(t)}function NW(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class UW{constructor(){this.subscriptions=[]}add(e){return LW(this.subscriptions,e),()=>NW(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let o=0;o<r;o++){const r=this.subscriptions[o];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function VW(e,t){return t?e*(1e3/t):0}const WW={current:void 0};class HW{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=BW.now();var n;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(n=this.events.change)||void 0===n||n.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=BW.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(e=>!isNaN(parseFloat(e)))(this.current))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new UW);const n=this.events[e].add(t);return"change"===e?()=>{n(),XV.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return WW.current&&WW.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=BW.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return VW(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function GW(e,t){return new HW(e,t)}const XW=[...AV,fW,kW],{schedule:YW,cancel:qW}=GV(queueMicrotask,!1),ZW={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$W={};for(const n in ZW)$W[n]={isEnabled:e=>ZW[n].some(t=>!!e[t])};const KW=()=>({x:{min:0,max:0},y:{min:0,max:0}}),JW={current:null},QW={current:!1};const eH=new WeakMap;function tH(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function nH(e){return"string"===typeof e||Array.isArray(e)}const rH=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],oH=["initial",...rH];function iH(e){return tH(e.animate)||oH.some(t=>nH(e[t]))}function aH(e){return Boolean(iH(e)||e.variants)}function sH(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function lH(e,t,n,r){if("function"===typeof t){const[o,i]=sH(r);t=t(void 0!==n?n:e.custom,o,i)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[o,i]=sH(r);t=t(void 0!==n?n:e.custom,o,i)}return t}const cH=["willChange"],dH=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class uH{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:i,visualState:a}=e,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=nW,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=BW.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,XV.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=a;this.latestValues=d,this.baseTarget=s({},d),this.initialValues=n.initial?s({},d):{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=c,this.blockInitialAnimation=Boolean(i),this.isControllingVariants=iH(n),this.isVariantNode=aH(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const p=this.scrapeMotionValuesFromProps(n,{},this),{willChange:h}=p,f=l(p,cH);for(const s in f){const e=f[s];void 0!==d[s]&&zW(e)&&e.set(d[s])}}mount(e){var t;this.current=e,eH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),QW.current||function(){if(QW.current=!0,kU)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>JW.current=e.matches;e.addEventListener("change",t),t()}else JW.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||JW.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),YV(this.notifyUpdate),YV(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=NU.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&XV.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in $W){const t=$W[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<dH.length;n++){const t=dH[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const o=t[r],i=n[r];if(zW(o))e.addValue(r,o);else if(zW(i))e.addValue(r,GW(o,{owner:e}));else if(i!==o)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(o):t.hasAnimated||t.set(o)}else{const t=e.getStaticValue(r);e.addValue(r,GW(void 0!==t?t:o,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=GW(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return void 0!==r&&null!==r&&("string"===typeof r&&(RV(r)||rW(r))?r=parseFloat(r):!(e=>XW.find(IV(e)))(r)&&kW.test(t)&&(r=AW(e,t)),this.setBaseTarget(e,zW(r)?r.get():r)),zW(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"===typeof t||"object"===typeof t){var r;const o=lH(this.props,t,null===(r=this.presenceContext)||void 0===r?void 0:r.custom);o&&(n=o[e])}if(t&&void 0!==n)return n;const o=this.getBaseTargetFromProps(this.props,e);return void 0===o||zW(o)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:o}on(e,t){return this.events[e]||(this.events[e]=new UW),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}scheduleRenderMicrotask(){YW.render(this.render)}}class pH extends uH{constructor(){super(...arguments),this.KeyframeResolver=RW}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;zW(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const hH=(e,t)=>t&&"number"===typeof e?t.transform(e):e,fH={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gH=LU.length;function mH(e,t,n){const{style:r,vars:o,transformOrigin:i}=e;let a=!1,s=!1;for(const l in t){const e=t[l];if(NU.has(l))a=!0;else if(JU(l))o[l]=e;else{const t=hH(e,MW[l]);l.startsWith("origin")?(s=!0,i[l]=t):r[l]=t}}if(t.transform||(a||n?r.transform=function(e,t,n){let r="",o=!0;for(let i=0;i<gH;i++){const a=LU[i],s=e[a];if(void 0===s)continue;let l=!0;if(l="number"===typeof s?s===(a.startsWith("scale")?1:0):0===parseFloat(s),!l||n){const e=hH(s,MW[a]);l||(o=!1,r+="".concat(fH[a]||a,"(").concat(e,") ")),n&&(t[a]=e)}}return r=r.trim(),n?r=n(t,o?"":r):o&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:e="50%",originY:t="50%",originZ:n=0}=i;r.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function vH(e,t,n,r){let{style:o,vars:i}=t;const a=e.style;let s;for(s in o)a[s]=o[s];for(s in null===r||void 0===r||r.applyProjectionStyles(a,n),i)a.setProperty(s,i[s])}function yH(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const xH={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!EV.test(e))return e;e=parseFloat(e)}const n=yH(e,t.target.x),r=yH(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},bH={correct:(e,t)=>{let{treeScale:n,projectionDelta:r}=t;const o=e,i=kW.parse(e);if(i.length>5)return o;const a=kW.createTransformer(e),s="number"!==typeof i[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;i[0+s]/=l,i[1+s]/=c;const d=rV(l,c,.5);return"number"===typeof i[2+s]&&(i[2+s]/=d),"number"===typeof i[3+s]&&(i[3+s]/=d),a(i)}},wH={borderRadius:s(s({},xH),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:xH,borderTopRightRadius:xH,borderBottomLeftRadius:xH,borderBottomRightRadius:xH,boxShadow:bH};function SH(e,t){let{layout:n,layoutId:r}=t;return NU.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!wH[e]||"opacity"===e)}function kH(e,t,n){const{style:r}=e,o={};for(const a in r){var i;(zW(r[a])||t.style&&zW(t.style[a])||SH(a,e)||void 0!==(null===n||void 0===n||null===(i=n.getValue(a))||void 0===i?void 0:i.liveStyle))&&(o[a]=r[a])}return o}class CH extends pH{constructor(){super(...arguments),this.type="html",this.renderInstance=vH}readValueFromInstance(e,t){var n,r;if(NU.has(t))return null!==(n=this.projection)&&void 0!==n&&n.isProjecting?qU(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return ZU(n,t)})(e,t);{const n=(r=e,window.getComputedStyle(r)),o=(JU(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof o?o.trim():o}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return yV(e,n)}build(e,t,n){mH(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return kH(e,t,n)}}const jH=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),_H={offset:"stroke-dashoffset",array:"stroke-dasharray"},EH={offset:"strokeDashoffset",array:"strokeDasharray"};const DH=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function MH(e,t,n,r,o){let{attrX:i,attrY:a,attrScale:s,pathLength:c,pathSpacing:d=1,pathOffset:u=0}=t;if(mH(e,l(t,DH),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:p,style:h}=e;var f,g;(p.transform&&(h.transform=p.transform,delete p.transform),h.transform||p.transformOrigin)&&(h.transformOrigin=null!==(f=p.transformOrigin)&&void 0!==f?f:"50% 50%",delete p.transformOrigin);h.transform&&(h.transformBox=null!==(g=null===o||void 0===o?void 0:o.transformBox)&&void 0!==g?g:"fill-box",delete p.transformBox);void 0!==i&&(p.x=i),void 0!==a&&(p.y=a),void 0!==s&&(p.scale=s),void 0!==c&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const i=o?_H:EH;e[i.offset]=EV.transform(-r);const a=EV.transform(t),s=EV.transform(n);e[i.array]="".concat(a," ").concat(s)}(p,c,d,u,!1)}const TH=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),IH=e=>"string"===typeof e&&"svg"===e.toLowerCase();function AH(e,t,n){const r=kH(e,t,n);for(const o in e)if(zW(e[o])||zW(t[o])){r[-1!==LU.indexOf(o)?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o]=e[o]}return r}class OH extends pH{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=KW}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(NU.has(t)){const e=IW(t);return e&&e.default||0}return t=TH.has(t)?t:jH(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return AH(e,t,n)}build(e,t,n){MH(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){vH(e,t,void 0,r);for(const o in t.attrs)e.setAttribute(TH.has(o)?o:jH(o),t.attrs[o])}(e,t,0,r)}mount(e){this.isSVGTag=IH(e.tagName),super.mount(e)}}const RH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zH(e){return"string"===typeof e&&!e.includes("-")&&!!(RH.indexOf(e)>-1||/[A-Z]/.test(e))}const FH=(t,n)=>zH(t)?new OH(n):new CH(n,{allowProjection:t!==e.Fragment}),PH=(0,e.createContext)({strict:!1}),BH=(0,e.createContext)({});function LH(t){const{initial:n,animate:r}=function(e,t){if(iH(e)){const{initial:t,animate:n}=e;return{initial:!1===t||nH(t)?t:void 0,animate:nH(n)?n:void 0}}return!1!==e.inherit?t:{}}(t,(0,e.useContext)(BH));return(0,e.useMemo)(()=>({initial:n,animate:r}),[NH(n),NH(r)])}function NH(e){return Array.isArray(e)?e.join(" "):e}const UH=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function VH(e,t,n){for(const r in t)zW(t[r])||SH(r,n)||(e[r]=t[r])}function WH(t,n){const r={};return VH(r,t.style||{},t),Object.assign(r,function(t,n){let{transformTemplate:r}=t;return(0,e.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return mH(e,n,r),Object.assign({},e.vars,e.style)},[n])}(t,n)),r}function HH(e,t){const n={},r=WH(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const GH=()=>s(s({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}});function XH(t,n,r,o){const i=(0,e.useMemo)(()=>{const e=GH();return MH(e,n,IH(o),t.transformTemplate,t.style),s(s({},e.attrs),{},{style:s({},e.style)})},[n]);if(t.style){const e={};VH(e,t.style,t),i.style=s(s({},e),i.style)}return i}const YH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qH(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||YH.has(e)}let ZH=e=>!qH(e);try{"function"===typeof($H=require("@emotion/is-prop-valid").default)&&(ZH=e=>e.startsWith("on")?!qH(e):$H(e))}catch(T2){}var $H;function KH(t,n,r,o,i){let{latestValues:a}=o,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const c=(zH(t)?XH:HH)(n,a,i,t),d=function(e,t,n){const r={};for(const o in e)"values"===o&&"object"===typeof e.values||(ZH(o)||!0===n&&qH(o)||!t&&!qH(o)||e.draggable&&o.startsWith("onDrag"))&&(r[o]=e[o]);return r}(n,"string"===typeof t,l),u=t!==e.Fragment?s(s(s({},d),c),{},{ref:r}):{},{children:p}=n,h=(0,e.useMemo)(()=>zW(p)?p.get():p,[p]);return(0,e.createElement)(t,s(s({},u),{},{children:h}))}function JH(e){return zW(e)?e.get():e}const QH=["transitionEnd","transition"];function eG(e,t,n,r){const o={},i=r(e,{});for(const l in i)o[l]=JH(i[l]);let{initial:a,animate:s}=e;const c=iH(e),d=aH(e);t&&d&&!c&&!1!==e.inherit&&(void 0===a&&(a=t.initial),void 0===s&&(s=t.animate));let u=!!n&&!1===n.initial;u=u||!1===a;const p=u?s:a;if(p&&"boolean"!==typeof p&&!tH(p)){const t=Array.isArray(p)?p:[p];for(let n=0;n<t.length;n++){const r=lH(e,t[n]);if(r){const{transitionEnd:e,transition:t}=r,n=l(r,QH);for(const r in n){let e=n[r];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(o[r]=e)}for(const r in e)o[r]=e[r]}}}return o}const tG=t=>(n,r)=>{const o=(0,e.useContext)(BH),i=(0,e.useContext)(jU),a=()=>function(e,t,n,r){let{scrapeMotionValuesFromProps:o,createRenderState:i}=e;return{latestValues:eG(t,n,r,o),renderState:i()}}(t,n,o,i);return r?a():SU(a)},nG=tG({scrapeMotionValuesFromProps:kH,createRenderState:UH}),rG=tG({scrapeMotionValuesFromProps:AH,createRenderState:GH});const oG=Symbol.for("motionComponentSymbol");function iG(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function aG(t,n,r){return(0,e.useCallback)(e=>{e&&t.onMount&&t.onMount(e),n&&(e?n.mount(e):n.unmount()),r&&("function"===typeof r?r(e):iG(r)&&(r.current=e))},[n])}const sG="data-"+jH("framerAppearId"),lG=(0,e.createContext)({});function cG(t,n,r,o,i){var a,s,l,c;const{visualElement:d}=(0,e.useContext)(BH),u=(0,e.useContext)(PH),p=(0,e.useContext)(jU),h=(0,e.useContext)(DU).reducedMotion,f=(0,e.useRef)(null);o=o||u.renderer,!f.current&&o&&(f.current=o(t,{visualState:n,parent:d,props:r,presenceContext:p,blockInitialAnimation:!!p&&!1===p.initial,reducedMotionConfig:h}));const g=f.current,m=(0,e.useContext)(lG);!g||g.projection||!i||"html"!==g.type&&"svg"!==g.type||function(e,t,n,r){const{layoutId:o,layout:i,drag:a,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:dG(e.parent)),e.projection.setOptions({layoutId:o,layout:i,alwaysMeasureLayout:Boolean(a)||s&&iG(s),visualElement:e,animationType:"string"===typeof i?i:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:l,layoutRoot:c})}(f.current,r,i,m);const v=(0,e.useRef)(!1);(0,e.useInsertionEffect)(()=>{g&&v.current&&g.update(r,p)});const y=r[sG],x=(0,e.useRef)(Boolean(y)&&!(null!==(a=(s=window).MotionHandoffIsComplete)&&void 0!==a&&a.call(s,y))&&(null===(l=(c=window).MotionHasOptimisedAnimation)||void 0===l?void 0:l.call(c,y)));return CU(()=>{g&&(v.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),x.current&&g.animationState&&g.animationState.animateChanges())}),(0,e.useEffect)(()=>{g&&(!x.current&&g.animationState&&g.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var e,t;null===(e=(t=window).MotionHandoffMarkAsComplete)||void 0===e||e.call(t,y)}),x.current=!1),g.enteringChildren=void 0)}),g}function dG(e){if(e)return!1!==e.options.allowProjection?e.projection:dG(e.parent)}function uG(t){var n,r;let{forwardMotionProps:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;i&&function(e){for(const t in e)$W[t]=s(s({},$W[t]),e[t])}(i);const l=zH(t)?rG:nG;function d(n,r){let i;const d=s(s(s({},(0,e.useContext)(DU)),n),{},{layoutId:pG(n)}),{isStatic:u}=d,p=LH(n),h=l(n,u);if(!u&&kU){!function(){(0,e.useContext)(PH).strict;0}();const n=function(e){const{drag:t,layout:n}=$W;if(!t&&!n)return{};const r=s(s({},t),n);return{MeasureLayout:null!==t&&void 0!==t&&t.isEnabled(e)||null!==n&&void 0!==n&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(d);i=n.MeasureLayout,p.visualElement=cG(t,h,d,a,n.ProjectionNode)}return(0,c.jsxs)(BH.Provider,{value:p,children:[i&&p.visualElement?(0,c.jsx)(i,s({visualElement:p.visualElement},d)):null,KH(t,n,aG(h,p.visualElement,r),h,u,o)]})}d.displayName="motion.".concat("string"===typeof t?t:"create(".concat(null!==(n=null!==(r=t.displayName)&&void 0!==r?r:t.name)&&void 0!==n?n:"",")"));const u=(0,e.forwardRef)(d);return u[oG]=t,u}function pG(t){let{layoutId:n}=t;const r=(0,e.useContext)(wU).id;return r&&void 0!==n?r+"-"+n:n}function hG(e,t){if("undefined"===typeof Proxy)return uG;const n=new Map,r=(n,r)=>uG(n,r,e,t);return new Proxy((e,t)=>r(e,t),{get:(o,i)=>"create"===i?r:(n.has(i)||n.set(i,uG(i,void 0,e,t)),n.get(i))})}function fG(e,t,n){const r=e.getProps();return lH(r,t,void 0!==n?n:r.custom,e)}function gG(e,t){var n,r;return null!==(n=null!==(r=null===e||void 0===e?void 0:e[t])&&void 0!==r?r:null===e||void 0===e?void 0:e.default)&&void 0!==n?n:e}const mG=e=>Array.isArray(e),vG=["transitionEnd","transition"];function yG(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,GW(n))}function xG(e){return mG(e)?e[e.length-1]||0:e}function bG(e,t){const n=e.getValue("willChange");if(function(e){return Boolean(zW(e)&&e.add)}(n))return n.add(t);if(!n&&VV.WillChange){const n=new VV.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function wG(e){return e.props[sG]}function SG(e){e.duration=0,e.type="keyframes"}const kG=(e,t)=>n=>t(e(n)),CG=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(kG)},jG=e=>1e3*e,_G=e=>e/1e3,EG={layout:0,mainThread:0,waapi:0};function DG(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function MG(e,t){return n=>n>0?t:e}const TG=(e,t,n)=>{const r=e*e,o=n*(t*t-r)+r;return o<0?0:Math.sqrt(o)},IG=[pW,uW,hW];function AG(e){const t=(e=>IG.find(t=>t.test(e)))(e);if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let n=t.parse(e);return t===hW&&(n=function(e){let{hue:t,saturation:n,lightness:r,alpha:o}=e;t/=360,n/=100,r/=100;let i=0,a=0,s=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,o=2*r-e;i=DG(o,e,t+1/3),a=DG(o,e,t),s=DG(o,e,t-1/3)}else i=a=s=r;return{red:Math.round(255*i),green:Math.round(255*a),blue:Math.round(255*s),alpha:o}}(n)),n}const OG=(e,t)=>{const n=AG(e),r=AG(t);if(!n||!r)return MG(e,t);const o=s({},n);return e=>(o.red=TG(n.red,r.red,e),o.green=TG(n.green,r.green,e),o.blue=TG(n.blue,r.blue,e),o.alpha=rV(n.alpha,r.alpha,e),uW.transform(o))},RG=new Set(["none","hidden"]);function zG(e,t){return n=>rV(e,t,n)}function FG(e){return"number"===typeof e?zG:"string"===typeof e?eV(e)?MG:fW.test(e)?OG:LG:Array.isArray(e)?PG:"object"===typeof e?fW.test(e)?OG:BG:MG}function PG(e,t){const n=[...e],r=n.length,o=e.map((e,n)=>FG(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=o[t](e);return n}}function BG(e,t){const n=s(s({},e),t),r={};for(const o in n)void 0!==e[o]&&void 0!==t[o]&&(r[o]=FG(e[o])(e[o],t[o]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const LG=(e,t)=>{const n=kW.createTransformer(t),r=xW(e),o=xW(t);return r.indexes.var.length===o.indexes.var.length&&r.indexes.color.length===o.indexes.color.length&&r.indexes.number.length>=o.indexes.number.length?RG.has(e)&&!o.values.length||RG.has(t)&&!r.values.length?function(e,t){return RG.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):CG(PG(function(e,t){const n=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){var o;const a=t.types[i],s=e.indexes[a][r[a]],l=null!==(o=e.values[s])&&void 0!==o?o:0;n[i]=l,r[a]++}return n}(r,o),o.values),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),MG(e,t))};function NG(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return rV(e,t,n);return FG(e)(e,t)}const UG=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return XV.update(t,e)},stop:()=>YV(t),now:()=>qV.isProcessing?qV.timestamp:BW.now()}},VG=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r="";const o=Math.max(Math.round(t/n),2);for(let i=0;i<o;i++)r+=Math.round(1e4*e(i/(o-1)))/1e4+", ";return"linear(".concat(r.substring(0,r.length-2),")")},WG=2e4;function HG(e){let t=0;let n=e.next(t);for(;!n.done&&t<WG;)t+=50,n=e.next(t);return t>=WG?1/0:t}function GG(e,t,n){const r=Math.max(t-5,0);return VW(n-e(r),t-r)}const XG={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},YG=.001;function qG(e){let t,n,{duration:r=XG.duration,bounce:o=XG.bounce,velocity:i=XG.velocity,mass:a=XG.mass}=e;jG(XG.maxDuration);let s=1-o;s=bV(XG.minDamping,XG.maxDamping,s),r=bV(XG.minDuration,XG.maxDuration,_G(r)),s<1?(t=e=>{const t=e*s,n=t*r,o=t-i,a=$G(e,s),l=Math.exp(-n);return YG-o/a*l},n=e=>{const n=e*s*r,o=n*i+i,a=Math.pow(s,2)*Math.pow(e,2)*r,l=Math.exp(-n),c=$G(Math.pow(e,2),s);return(-t(e)+YG>0?-1:1)*((o-a)*l)/c}):(t=e=>Math.exp(-e*r)*((e-i)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(i-e)));const l=function(e,t,n){let r=n;for(let o=1;o<ZG;o++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=jG(r),isNaN(l))return{stiffness:XG.stiffness,damping:XG.damping,duration:r};{const e=Math.pow(l,2)*a;return{stiffness:e,damping:2*s*Math.sqrt(a*e),duration:r}}}const ZG=12;function $G(e,t){return e*Math.sqrt(1-t*t)}const KG=["duration","bounce"],JG=["stiffness","damping","mass"];function QG(e,t){return t.some(t=>void 0!==e[t])}function eX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XG.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:XG.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:o}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:u,duration:p,velocity:h,isResolvedFromDuration:f}=function(e){let t=s({velocity:XG.velocity,stiffness:XG.stiffness,damping:XG.damping,mass:XG.mass,isResolvedFromDuration:!1},e);if(!QG(e,JG)&&QG(e,KG))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),o=r*r,i=2*bV(.05,1,1-(e.bounce||0))*Math.sqrt(o);t=s(s({},t),{},{mass:XG.mass,stiffness:o,damping:i})}else{const n=qG(e);t=s(s(s({},t),n),{},{mass:XG.mass}),t.isResolvedFromDuration=!0}return t}(s(s({},n),{},{velocity:-_G(n.velocity||0)})),g=h||0,m=d/(2*Math.sqrt(c*u)),v=a-i,y=_G(Math.sqrt(c/u)),x=Math.abs(v)<5;let b;if(r||(r=x?XG.restSpeed.granular:XG.restSpeed.default),o||(o=x?XG.restDelta.granular:XG.restDelta.default),m<1){const e=$G(y,m);b=t=>{const n=Math.exp(-m*y*t);return a-n*((g+m*y*v)/e*Math.sin(e*t)+v*Math.cos(e*t))}}else if(1===m)b=e=>a-Math.exp(-y*e)*(v+(g+y*v)*e);else{const e=y*Math.sqrt(m*m-1);b=t=>{const n=Math.exp(-m*y*t),r=Math.min(e*t,300);return a-n*((g+m*y*v)*Math.sinh(r)+e*v*Math.cosh(r))/e}}const w={calculatedDuration:f&&p||null,next:e=>{const t=b(e);if(f)l.done=e>=p;else{let n=0===e?g:0;m<1&&(n=0===e?jG(g):GG(b,e,t));const i=Math.abs(n)<=r,s=Math.abs(a-t)<=o;l.done=i&&s}return l.value=l.done?a:t,l},toString:()=>{const e=Math.min(HG(w),WG),t=VG(t=>w.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return w}function tX(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:o=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:s,min:l,max:c,restDelta:d=.5,restSpeed:u}=e;const p=t[0],h={done:!1,value:p},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let g=r*n;const m=p+g,v=void 0===s?m:s(m);v!==m&&(g=v-p);const y=e=>-g*Math.exp(-e/o),x=e=>v+y(e),b=e=>{const t=y(e),n=x(e);h.done=Math.abs(t)<=d,h.value=h.done?v:n};let w,S;const k=e=>{(e=>void 0!==l&&e<l||void 0!==c&&e>c)(h.value)&&(w=e,S=eX({keyframes:[h.value,f(h.value)],velocity:GG(x,e,h.value),damping:i,stiffness:a,restDelta:d,restSpeed:u}))};return k(0),{calculatedDuration:null,next:e=>{let t=!1;return S||void 0!==w||(t=!0,b(e),k(e)),void 0!==w&&e>=w?S.next(e-w):(!t&&b(e),h)}}}eX.applyToOptions=e=>{const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=(arguments.length>2?arguments[2]:void 0)(s(s({},e),{},{keyframes:[0,t]})),r=Math.min(HG(n),WG);return{type:"keyframes",ease:e=>n.next(r*e).value/t,duration:_G(r)}}(e,100,eX);return e.ease=t.ease,e.duration=jG(t.duration),e.type="keyframes",e};const nX=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function rX(e,t,n,r){if(e===t&&n===r)return UV;const o=t=>function(e,t,n,r,o){let i,a,s=0;do{a=t+(n-t)/2,i=nX(a,r,o)-e,i>0?n=a:t=a}while(Math.abs(i)>1e-7&&++s<12);return a}(t,0,1,e,n);return e=>0===e||1===e?e:nX(o(e),t,r)}const oX=rX(.42,0,1,1),iX=rX(0,0,.58,1),aX=rX(.42,0,.58,1),sX=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,lX=e=>t=>1-e(1-t),cX=rX(.33,1.53,.69,.99),dX=lX(cX),uX=sX(dX),pX=e=>(e*=2)<1?.5*dX(e):.5*(2-Math.pow(2,-10*(e-1))),hX=e=>1-Math.sin(Math.acos(e)),fX=lX(hX),gX=sX(hX),mX=e=>Array.isArray(e)&&"number"===typeof e[0],vX={linear:UV,easeIn:oX,easeInOut:aX,easeOut:iX,circIn:hX,circInOut:gX,circOut:fX,backIn:dX,backInOut:uX,backOut:cX,anticipate:pX},yX=e=>{if(mX(e)){e.length;const[t,n,r,o]=e;return rX(t,n,r,o)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),vX[e]):e},xX=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r};function bX(e,t){let{clamp:n=!0,ease:r,mixer:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.length;if(t.length,1===i)return()=>t[0];if(2===i&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=function(e,t,n){const r=[],o=n||VV.mix||NG,i=e.length-1;for(let a=0;a<i;a++){let n=o(e[a],e[a+1]);if(t){const e=Array.isArray(t)?t[a]||UV:t;n=CG(e,n)}r.push(n)}return r}(t,r,o),l=s.length,c=n=>{if(a&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const o=xX(e[r],e[r+1],n);return s[r](o)};return n?t=>c(bV(e[0],e[i-1],t)):c}function wX(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const o=xX(0,t,r);e.push(rV(n,1,o))}}(t,e.length-1),t}function SX(e){let{duration:t=300,keyframes:n,times:r,ease:o="easeInOut"}=e;const i=(e=>Array.isArray(e)&&"number"!==typeof e[0])(o)?o.map(yX):yX(o),a={done:!1,value:n[0]},s=function(e,t){return e.map(e=>e*t)}(r&&r.length===n.length?r:wX(n),t),l=bX(s,n,{ease:Array.isArray(i)?i:(c=n,d=i,c.map(()=>d||aX).splice(0,c.length-1))});var c,d;return{calculatedDuration:t,next:e=>(a.value=l(e),a.done=e>=t,a)}}const kX=e=>null!==e;function CX(e,t,n){let{repeat:r,repeatType:o="loop"}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const a=e.filter(kX),s=i<0||r&&"loop"!==o&&r%2===1?0:a.length-1;return s&&void 0!==n?n:a[s]}const jX={decay:tX,inertia:tX,tween:SX,keyframes:SX,spring:eX};function _X(e){"string"===typeof e.type&&(e.type=jX[e.type])}class EX{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const DX=e=>e/100;class MX extends EX{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==BW.now()&&this.tick(BW.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},EG.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;_X(e);const{type:t=SX,repeat:n=0,repeatDelay:r=0,repeatType:o,velocity:i=0}=e;let{keyframes:a}=e;const l=t||SX;l!==SX&&"number"!==typeof a[0]&&(this.mixKeyframes=CG(DX,NG(a[0],a[1])),a=[0,100]);const c=l(s(s({},e),{},{keyframes:a}));"mirror"===o&&(this.mirroredGenerator=l(s(s({},e),{},{keyframes:[...a].reverse(),velocity:-i}))),null===c.calculatedDuration&&(c.calculatedDuration=HG(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=c}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:n,totalDuration:r,mixKeyframes:o,mirroredGenerator:i,resolvedDuration:a,calculatedDuration:s}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:p,type:h,onUpdate:f,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const m=this.currentTime-l*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?m<0:m>r;this.currentTime=Math.max(m,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let y=this.currentTime,x=n;if(d){const e=Math.min(this.currentTime,r)/a;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(n=1-n,p&&(n-=p/a)):"mirror"===u&&(x=i)),y=bV(0,1,n)*a}const b=v?{done:!1,value:c[0]}:x.next(y);o&&(b.value=o(b.value));let{done:w}=b;v||null===s||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const S=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return S&&h!==tX&&(b.value=CX(c,this.options,g,this.speed)),f&&f(b.value),S&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return _G(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+_G(e)}get time(){return _G(this.currentTime)}set time(e){var t;e=jG(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(BW.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=_G(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=UG,startTime:r}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const o=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=o):null!==this.holdTime?this.startTime=o-this.holdTime:this.startTime||(this.startTime=null!==r&&void 0!==r?r:o),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(BW.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,EG.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}function TX(e){let t;return()=>(void 0===t&&(t=e()),t)}const IX=TX(()=>void 0!==window.ScrollTimeline),AX={};function OX(e,t){const n=TX(e);return()=>{var e;return null!==(e=AX[t])&&void 0!==e?e:n()}}const RX=OX(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(M2){return!1}return!0},"linearEasing"),zX=e=>{let[t,n,r,o]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(o,")")},FX={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:zX([0,.65,.55,1]),circOut:zX([.55,0,1,.45]),backIn:zX([.31,.01,.66,-.59]),backOut:zX([.33,1.53,.69,.99])};function PX(e,t){return e?"function"===typeof e?RX()?VG(e,t):"ease-out":mX(e)?zX(e):Array.isArray(e)?e.map(e=>PX(e,t)||FX.easeOut):FX[e]:void 0}function BX(e,t,n){let{delay:r=0,duration:o=300,repeat:i=0,repeatType:a="loop",ease:s="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d={[t]:n};l&&(d.offset=l);const u=PX(s,o);Array.isArray(u)&&(d.easing=u),HV.value&&EG.waapi++;const p={delay:r,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:"reverse"===a?"alternate":"normal"};c&&(p.pseudoElement=c);const h=e.animate(d,p);return HV.value&&h.finished.finally(()=>{EG.waapi--}),h}function LX(e){return"function"===typeof e&&"applyToOptions"in e}const NX=["type"];class UX extends EX{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:o,allowFlatten:i=!1,finalKeyframe:a,onComplete:s}=e;this.isPseudoElement=Boolean(o),this.allowFlatten=i,this.options=e,e.type;const c=function(e){let{type:t}=e,n=l(e,NX);return LX(t)&&RX()?t.applyToOptions(n):(null!==(r=n.duration)&&void 0!==r||(n.duration=300),null!==(o=n.ease)&&void 0!==o||(n.ease="easeOut"),n);var r,o}(e);this.animation=BX(t,n,r,c,o),!1===c.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const e=CX(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null===s||void 0===s||s(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch(M2){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const n=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return _G(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+_G(e)}get time(){return _G(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=jG(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;var r;this.allowFlatten&&(null===(r=this.animation.effect)||void 0===r||r.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&IX()?(this.animation.timeline=t,UV):n(this)}}const VX={anticipate:pX,backInOut:uX,circInOut:gX};function WX(e){"string"===typeof e.ease&&function(e){return e in VX}(e.ease)&&(e.ease=VX[e.ease])}const HX=["motionValue","onUpdate","onComplete","element"];class GX extends UX{constructor(e){WX(e),_X(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:o,onComplete:i,element:a}=n,c=l(n,HX);if(!r)return;if(void 0!==e)return void r.set(e);const d=new MX(s(s({},c),{},{autoplay:!1})),u=jG(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);r.setWithVelocity(d.sample(u-10).value,d.sample(u).value,10),d.stop()}}const XX=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!kW.test(e)&&"0"!==e||e.startsWith("url(")));const YX=new Set(["opacity","clipPath","filter","transform"]),qX=TX(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const ZX=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class $X extends EX{constructor(e){var t;let{autoplay:n=!0,delay:r=0,type:o="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:c="loop",keyframes:d,name:u,motionValue:p,element:h}=e,f=l(e,ZX);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=BW.now();const g=s({autoplay:n,delay:r,type:o,repeat:i,repeatDelay:a,repeatType:c,name:u,motionValue:p,element:h},f),m=(null===h||void 0===h?void 0:h.KeyframeResolver)||nW;this.keyframeResolver=new m(d,(e,t,n)=>this.onKeyframesResolved(e,t,g,!n),u,p,h),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:o,type:i,velocity:a,delay:l,isHandoff:c,onUpdate:d}=n;this.resolvedAt=BW.now(),function(e,t,n,r){const o=e[0];if(null===o)return!1;if("display"===t||"visibility"===t)return!0;const i=e[e.length-1],a=XX(o,t),s=XX(i,t);return"You are trying to animate ".concat(t,' from "').concat(o,'" to "').concat(i,'". "').concat(a?i:o,'" is not an animatable value.'),!(!a||!s)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||LX(n))&&r)}(e,o,i,a)||(!VV.instantAnimations&&l||null===d||void 0===d||d(CX(e,n,t)),e[0]=e[e.length-1],SG(n),n.repeat=0);const u=s(s({startTime:r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t},n),{},{keyframes:e}),p=!c&&function(e){var t;const{motionValue:n,name:r,repeatDelay:o,repeatType:i,damping:a,type:s}=e;if(!((null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return qX()&&r&&YX.has(r)&&("transform"!==r||!c)&&!l&&!o&&"mirror"!==i&&0!==a&&"inertia"!==s}(u)?new GX(s(s({},u),{},{element:u.motionValue.owner.current})):new MX(u);p.finished.then(()=>this.notifyFinished()).catch(UV),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),QV=!0,tW(),eW(),QV=!1);return this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const KX=e=>null!==e;const JX={type:"spring",stiffness:500,damping:25,restSpeed:10},QX={type:"keyframes",duration:.8},eY={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},tY=(e,t)=>{let{keyframes:n}=t;return n.length>2?QX:NU.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:JX:eY},nY=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const rY=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return a=>{const c=gG(r,e)||{},d=c.delay||r.delay||0;let{elapsed:u=0}=r;u-=jG(d);const p=s(s({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},c),{},{delay:-u,onUpdate:e=>{t.set(e),c.onUpdate&&c.onUpdate(e)},onComplete:()=>{a(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:i?void 0:o});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:o,staggerDirection:i,repeat:a,repeatType:s,repeatDelay:c,from:d,elapsed:u}=e,p=l(e,nY);return!!Object.keys(p).length})(c)||Object.assign(p,tY(e,p)),p.duration&&(p.duration=jG(p.duration)),p.repeatDelay&&(p.repeatDelay=jG(p.repeatDelay)),void 0!==p.from&&(p.keyframes[0]=p.from);let h=!1;if((!1===p.type||0===p.duration&&!p.repeatDelay)&&(SG(p),0===p.delay&&(h=!0)),(VV.instantAnimations||VV.skipAnimations)&&(h=!0,SG(p),p.delay=0),p.allowFlatten=!c.type&&!c.ease,h&&!i&&void 0!==t.get()){const e=function(e,t,n){let{repeat:r,repeatType:o="loop"}=t;const i=e.filter(KX),a=r&&"loop"!==o&&r%2===1?0:i.length-1;return a&&void 0!==n?n:i[a]}(p.keyframes,c);if(void 0!==e)return void XV.update(()=>{p.onUpdate(e),p.onComplete()})}return c.isSync?new MX(p):new $X(p)}},oY=["transition","transitionEnd"];function iY(e,t){let{protectedKeys:n,needsAnimating:r}=e;const o=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,o}function aY(e,t){let{delay:n=0,transitionOverride:r,type:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:i=e.getDefaultTransition(),transitionEnd:a}=t,c=l(t,oY);r&&(i=r);const d=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const l in c){var p;const t=e.getValue(l,null!==(p=e.latestValues[l])&&void 0!==p?p:null),r=c[l];if(void 0===r||u&&iY(u,l))continue;const o=s({delay:n},gG(i||{},l)),a=t.get();if(void 0!==a&&!t.isAnimating&&!Array.isArray(r)&&r===a&&!o.velocity)continue;let h=!1;if(window.MotionHandoffAnimation){const t=wG(e);if(t){const e=window.MotionHandoffAnimation(t,l,XV);null!==e&&(o.startTime=e,h=!0)}}bG(e,l),t.start(rY(l,t,r,e.shouldReduceMotion&&xV.has(l)?{type:!1}:o,e,h));const f=t.animation;f&&d.push(f)}return a&&Promise.all(d).then(()=>{XV.update(()=>{a&&function(e,t){let n=fG(e,t)||{},{transitionEnd:r={},transition:o={}}=n,i=l(n,vG);i=s(s({},i),r);for(const a in i)yG(e,a,xG(i[a]))}(e,a)})}),d}function sY(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),a=e.size,s=(a-1)*r;return"function"===typeof n?n(i,a):1===o?i*r:s-i*r}function lY(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=fG(e,t,"exit"===r.type?null===(n=e.presenceContext)||void 0===n?void 0:n.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=o||{};r.transitionOverride&&(i=r.transitionOverride);const a=o?()=>Promise.all(aY(e,o,r)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:o=0,staggerChildren:a,staggerDirection:l}=i;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0;const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(lY(c,t,s(s({},a),{},{delay:n+("function"===typeof r?0:r)+sY(e.variantChildren,c,r,o,i)})).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}(e,t,n,o,a,l,r)}:()=>Promise.resolve(),{when:c}=i;if(c){const[e,t]="beforeChildren"===c?[a,l]:[l,a];return e().then(()=>t())}return Promise.all([a(),l(r.delay)])}function cY(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const dY=oH.length;function uY(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&uY(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<dY;n++){const r=oH[n],o=e.props[r];(nH(o)||!1===o)&&(t[r]=o)}return t}const pY=["transition","transitionEnd"],hY=[...rH].reverse(),fY=rH.length;function gY(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:r}=t;return function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const o=t.map(t=>lY(e,t,r));n=Promise.all(o)}else if("string"===typeof t)n=lY(e,t,r);else{const o="function"===typeof t?fG(e,t,r.custom):t;n=Promise.all(aY(e,o,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,n,r)}))}function mY(e){let t=gY(e),n=xY(),r=!0;const o=t=>(n,r)=>{var o;const i=fG(e,r,"exit"===t?null===(o=e.presenceContext)||void 0===o?void 0:o.custom:void 0);if(i){const{transition:e,transitionEnd:t}=i,r=l(i,pY);n=s(s(s({},n),r),t)}return n};function i(i){const{props:a}=e,l=uY(e.parent)||{},c=[],d=new Set;let u={},p=1/0;for(let t=0;t<fY;t++){const h=hY[t],f=n[h],g=void 0!==a[h]?a[h]:l[h],m=nH(g),v=h===i?f.isActive:null;!1===v&&(p=t);let y=g===l[h]&&g!==a[h]&&m;if(y&&r&&e.manuallyAnimateOnMount&&(y=!1),f.protectedKeys=s({},u),!f.isActive&&null===v||!g&&!f.prevProp||tH(g)||"boolean"===typeof g)continue;const x=vY(f.prevProp,g);let b=x||h===i&&f.isActive&&!y&&m||t>p&&m,w=!1;const S=Array.isArray(g)?g:[g];let k=S.reduce(o(h),{});!1===v&&(k={});const{prevResolvedValues:C={}}=f,j=s(s({},C),k),_=t=>{b=!0,d.has(t)&&(w=!0,d.delete(t)),f.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in j){const t=k[e],n=C[e];if(u.hasOwnProperty(e))continue;let r=!1;r=mG(t)&&mG(n)?!cY(t,n):t!==n,r?void 0!==t&&null!==t?_(e):d.add(e):void 0!==t&&d.has(e)?_(e):f.protectedKeys[e]=!0}f.prevProp=g,f.prevResolvedValues=k,f.isActive&&(u=s(s({},u),k)),r&&e.blockInitialAnimation&&(b=!1);const E=y&&x;b&&(!E||w)&&c.push(...S.map(t=>{const n={type:h};if("string"===typeof t&&r&&!E&&e.manuallyAnimateOnMount&&e.parent){const{parent:r}=e,o=fG(r,t);if(r.enteringChildren&&o){const{delayChildren:t}=o.transition||{};n.delay=sY(r.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(d.size){const t={};if("boolean"!==typeof a.initial){const n=fG(e,Array.isArray(a.initial)?a.initial[0]:a.initial);n&&n.transition&&(t.transition=n.transition)}d.forEach(n=>{const r=e.getBaseTarget(n),o=e.getValue(n);o&&(o.liveStyle=!0),t[n]=null!==r&&void 0!==r?r:null}),c.push({animation:t})}let h=Boolean(c.length);return!r||!1!==a.initial&&a.initial!==a.animate||e.manuallyAnimateOnMount||(h=!1),r=!1,h?t(c):Promise.resolve()}return{animateChanges:i,setActive:function(t,r){var o;if(n[t].isActive===r)return Promise.resolve();null===(o=e.variantChildren)||void 0===o||o.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)}),n[t].isActive=r;const a=i(t);for(const e in n)n[e].protectedKeys={};return a},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=xY()}}}function vY(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!cY(t,e)}function yY(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function xY(){return{animate:yY(!0),whileInView:yY(),whileHover:yY(),whileTap:yY(),whileDrag:yY(),whileFocus:yY(),exit:yY()}}class bY{constructor(e){this.isMounted=!1,this.node=e}update(){}}let wY=0;const SY={animation:{Feature:class extends bY{constructor(e){super(e),e.animationState||(e.animationState=mY(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();tH(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends bY{constructor(){super(...arguments),this.id=wY++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},kY={x:!1,y:!1};function CY(){return kY.x||kY.y}function jY(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const _Y=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function EY(e){return{point:{x:e.pageX,y:e.pageY}}}function DY(e,t,n,r){return jY(e,t,(e=>t=>_Y(t)&&e(t,EY(t)))(n),r)}function MY(e){return e.max-e.min}function TY(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=r,e.originPoint=rV(t.min,t.max,e.origin),e.scale=MY(n)/MY(t),e.translate=rV(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function IY(e,t,n,r){TY(e.x,t.x,n.x,r?r.originX:void 0),TY(e.y,t.y,n.y,r?r.originY:void 0)}function AY(e,t,n){e.min=n.min+t.min,e.max=e.min+MY(t)}function OY(e,t,n){e.min=t.min-n.min,e.max=e.min+MY(t)}function RY(e,t,n){OY(e.x,t.x,n.x),OY(e.y,t.y,n.y)}function zY(e){return[e("x"),e("y")]}const FY=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},PY=(e,t)=>Math.abs(e-t);class BY{constructor(e,t){let{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:o=!1,distanceThreshold:i=3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=UY(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=PY(e.x,t.x),r=PY(e.y,t.y);return Math.sqrt(n**2+r**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;const{point:r}=e,{timestamp:o}=qV;this.history.push(s(s({},r),{},{timestamp:o}));const{onStart:i,onMove:a}=this.handlers;t||(i&&i(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),a&&a(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=LY(t,this.transformPagePoint),XV.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:o}=this.handlers;if(this.dragSnapToOrigin&&o&&o(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const i=UY("pointercancel"===e.type?this.lastMoveEventInfo:LY(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,i),r&&r(e,i)},!_Y(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=r||window;const a=LY(EY(e),this.transformPagePoint),{point:l}=a,{timestamp:c}=qV;this.history=[s(s({},l),{},{timestamp:c})];const{onSessionStart:d}=t;d&&d(e,UY(a,this.history)),this.removeListeners=CG(DY(this.contextWindow,"pointermove",this.handlePointerMove),DY(this.contextWindow,"pointerup",this.handlePointerUp),DY(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),YV(this.updatePoint)}}function LY(e,t){return t?{point:t(e.point)}:e}function NY(e,t){return{x:e.x-t.x,y:e.y-t.y}}function UY(e,t){let{point:n}=e;return{point:n,delta:NY(n,WY(t)),offset:NY(n,VY(t)),velocity:HY(t,.1)}}function VY(e){return e[0]}function WY(e){return e[e.length-1]}function HY(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const o=WY(e);for(;n>=0&&(r=e[n],!(o.timestamp-r.timestamp>jG(t)));)n--;if(!r)return{x:0,y:0};const i=_G(o.timestamp-r.timestamp);if(0===i)return{x:0,y:0};const a={x:(o.x-r.x)/i,y:(o.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function GY(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function XY(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const YY=.35;function qY(e,t,n){return{min:ZY(e,t),max:ZY(e,n)}}function ZY(e,t){return"number"===typeof e?e:e[t]||0}const $Y=new WeakMap;class KY{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e){let{snapToCursor:t=!1,distanceThreshold:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:r}=this.visualElement;if(r&&!1===r.isPresent)return;const{dragSnapToOrigin:o}=this.getProps();this.panSession=new BY(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(EY(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:o}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(i=n)||"y"===i?kY[i]?null:(kY[i]=!0,()=>{kY[i]=!1}):kY.x||kY.y?null:(kY.x=kY.y=!0,()=>{kY.x=kY.y=!1}),!this.openDragLock))return;var i;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),zY(e=>{let t=this.getAxisMotionValue(e).get()||0;if(_V.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=MY(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),o&&XV.postRender(()=>o(e,t)),bG(this.visualElement,"transform");const{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:o,onDrag:i}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:a}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(a),void(null!==this.currentDirection&&o&&o(this.currentDirection));this.updateAxis("x",t.point,a),this.updateAxis("y",t.point,a),this.visualElement.render(),i&&i(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>zY(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:o,distanceThreshold:n,contextWindow:FY(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,r=t||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!r||!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:a}=this.getProps();a&&XV.postRender(()=>a(n,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!JY(e,r,this.currentDirection))return;const o=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=function(e,t,n){let{min:r,max:o}=t;return void 0!==r&&e<r?e=n?rV(r,e,n.min):Math.max(e,r):void 0!==o&&e>o&&(e=n?rV(o,e,n.max):Math.min(e,o)),e}(i,this.constraints[e],this.elastic[e])),o.set(i)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,o=this.constraints;t&&iG(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,t){let{top:n,left:r,bottom:o,right:i}=t;return{x:GY(e.x,r,i),y:GY(e.y,n,o)}}(r.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:YY;return!1===e?e=0:!0===e&&(e=YY),{x:qY(e,"left","right"),y:qY(e,"top","bottom")}}(n),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&zY(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!iG(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const o=function(e,t,n){const r=yV(e,n),{scroll:o}=t;return o&&(gV(r.x,o.offset.x),gV(r.y,o.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let i=function(e,t){return{x:XY(e.x,t.x),y:XY(e.y,t.y)}}(r.layout.layoutBox,o);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(i));this.hasMutatedConstraints=!!e,e&&(i=nV(e))}return i}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=zY(a=>{if(!JY(a,t,this.currentDirection))return;let c=l&&l[a]||{};i&&(c={min:0,max:0});const d=r?200:1e6,u=r?40:1e7,p=s(s({type:"inertia",velocity:n?e[a]:0,bounceStiffness:d,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10},o),c);return this.startAxisValueAnimation(a,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return bG(this.visualElement,e),n.start(rY(e,n,0,t,this.visualElement,!1))}stopAnimation(){zY(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){zY(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){zY(t=>{const{drag:n}=this.getProps();if(!JY(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,o=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:i}=r.layout.layoutBox[t];o.set(e[t]-rV(n,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!iG(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};zY(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();r[e]=function(e,t){let n=.5;const r=MY(e),o=MY(t);return o>r?n=xX(t.min,t.max-r,e.min):r>o&&(n=xX(e.min,e.max-o,t.min)),bV(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),zY(t=>{if(!JY(t,e,null))return;const n=this.getAxisMotionValue(t),{min:o,max:i}=this.constraints[t];n.set(rV(o,i,r[t]))})}addListeners(){if(!this.visualElement.current)return;$Y.set(this.visualElement,this);const e=DY(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();iG(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),XV.read(t);const o=jY(window,"resize",()=>this.scalePositionWithinConstraints()),i=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(zY(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{o(),e(),r(),i&&i()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:o=!1,dragElastic:i=YY,dragMomentum:a=!0}=e;return s(s({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:o,dragElastic:i,dragMomentum:a})}}function JY(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const QY=e=>(t,n)=>{e&&XV.postRender(()=>e(t,n))};const eq={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let tq=!1;class nq extends e.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:o}=e;o&&(t.group&&t.group.add(o),n&&n.register&&r&&n.register(o),tq&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions(s(s({},o.options),{},{onExitComplete:()=>this.safeToRemove()}))),eq.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:o}=this.props,{projection:i}=n;return i?(i.isPresent=o,tq=!0,r||e.layoutDependency!==t||void 0===t||e.isPresent!==o?i.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?i.promote():i.relegate()||XV.postRender(()=>{const e=i.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),YW.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;tq=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function rq(t){const[n,r]=zU(),o=(0,e.useContext)(wU);return(0,c.jsx)(nq,s(s({},t),{},{layoutGroup:o,switchLayoutGroup:(0,e.useContext)(lG),isPresent:n,safeToRemove:r}))}function oq(e){return _U(e)&&"ownerSVGElement"in e}const iq=(e,t)=>e.depth-t.depth;class aq{constructor(){this.children=[],this.isDirty=!1}add(e){LW(this.children,e),this.isDirty=!0}remove(e){NW(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iq),this.isDirty=!1,this.children.forEach(e)}}function sq(e,t){const n=BW.now(),r=o=>{let{timestamp:i}=o;const a=i-n;a>=t&&(YV(r),e(a-t))};return XV.setup(r,!0),()=>YV(r)}const lq=["TopLeft","TopRight","BottomLeft","BottomRight"],cq=lq.length,dq=e=>"string"===typeof e?parseFloat(e):e,uq=e=>"number"===typeof e||EV.test(e);function pq(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const hq=gq(0,.5,fX),fq=gq(.5,.95,UV);function gq(e,t,n){return r=>r<e?0:r>t?1:n(xX(e,t,r))}function mq(e,t){e.min=t.min,e.max=t.max}function vq(e,t){mq(e.x,t.x),mq(e.y,t.y)}function yq(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function xq(e,t,n,r,o){return e=cV(e-=t,1/n,r),void 0!==o&&(e=cV(e,1/o,r)),e}function bq(e,t,n,r,o){let[i,a,s]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;_V.test(t)&&(t=parseFloat(t),t=rV(a.min,a.max,t/100)-a.min);if("number"!==typeof t)return;let s=rV(i.min,i.max,r);e===i&&(s-=t),e.min=xq(e.min,t,n,s,o),e.max=xq(e.max,t,n,s,o)}(e,t[i],t[a],t[s],t.scale,r,o)}const wq=["x","scaleX","originX"],Sq=["y","scaleY","originY"];function kq(e,t,n,r){bq(e.x,t,wq,n?n.x:void 0,r?r.x:void 0),bq(e.y,t,Sq,n?n.y:void 0,r?r.y:void 0)}function Cq(e){return 0===e.translate&&1===e.scale}function jq(e){return Cq(e.x)&&Cq(e.y)}function _q(e,t){return e.min===t.min&&e.max===t.max}function Eq(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Dq(e,t){return Eq(e.x,t.x)&&Eq(e.y,t.y)}function Mq(e){return MY(e.x)/MY(e.y)}function Tq(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Iq{constructor(){this.members=[]}add(e){LW(this.members,e),e.scheduleRender()}remove(e){if(NW(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Aq={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},Oq=["","X","Y","Z"];let Rq=0;function zq(e,t,n,r){const{latestValues:o}=t;o[e]&&(n[e]=o[e],t.setStaticValue(e,0),r&&(r[e]=0))}function Fq(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=wG(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:r}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",XV,!(t||r))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&Fq(r)}function Pq(e){let{attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:o,resetTransform:i}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=Rq++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,HV.value&&(Aq.nodes=Aq.calculatedTargetDeltas=Aq.calculatedProjections=0),this.nodes.forEach(Nq),this.nodes.forEach(Yq),this.nodes.forEach(qq),this.nodes.forEach(Uq),HV.addProjectionMetrics&&HV.addProjectionMetrics(Aq)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new aq)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new UW),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t&&t.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;var n;this.isSVG=oq(e)&&!(oq(n=e)&&"svg"===n.tagName),this.instance=e;const{layoutId:r,layout:o,visualElement:i}=this.options;if(i&&!i.current&&i.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(o||r)&&(this.isLayoutDirty=!0),t){let n,r=0;const o=()=>this.root.updateBlockedByResize=!1;XV.read(()=>{r=window.innerWidth}),t(e,()=>{const e=window.innerWidth;e!==r&&(r=e,this.root.updateBlockedByResize=!0,n&&n(),n=sq(o,250),eq.hasAnimatedSinceResize&&(eq.hasAnimatedSinceResize=!1,this.nodes.forEach(Xq)))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&i&&(r||o)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:r,layout:o}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const a=this.options.transition||i.getDefaultTransition()||eZ,{onLayoutAnimationStart:l,onLayoutAnimationComplete:c}=i.getProps(),d=!this.targetLayout||!Dq(this.targetLayout,o),u=!n&&r;if(this.options.layoutRoot||this.resumeFrom||u||n&&(d||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const e=s(s({},gG(a,"layout")),{},{onPlay:l,onComplete:c});(i.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,u)}else n||Xq(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=o})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),YV(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Zq),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Fq(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let o=0;o<this.path.length;o++){const e=this.path[o];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Wq);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(Hq);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Gq),this.nodes.forEach(Bq),this.nodes.forEach(Lq)):this.nodes.forEach(Hq),this.clearAllSnapshots();const e=BW.now();qV.delta=bV(0,1e3/60,e-qV.timestamp),qV.timestamp=e,qV.isProcessing=!0,ZV.update.process(qV),ZV.preRender.process(qV),ZV.render.process(qV),qV.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,YW.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Vq),this.sharedNodes.forEach($q)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,XV.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){XV.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||MY(this.snapshot.measuredBox.x)||MY(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=o(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!jq(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,o=r!==this.prevTransformTemplateValue;e&&this.instance&&(t||aV(this.latestValues)||o)&&(i(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);return e&&(n=this.removeTransform(n)),function(e){rZ(e.x),rZ(e.y)}(n),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(iZ))){const{scroll:e}=this.root;e&&(gV(n.x,e.offset.x),gV(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(vq(n,e),null!==(t=this.scroll)&&void 0!==t&&t.wasRoot)return n;for(let r=0;r<this.path.length;r++){const t=this.path[r],{scroll:o,options:i}=t;t!==this.root&&o&&i.layoutScroll&&(o.wasRoot&&vq(n,e),gV(n.x,o.offset.x),gV(n.y,o.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};vq(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&vV(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),aV(e.latestValues)&&vV(n,e.latestValues)}return aV(this.latestValues)&&vV(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};vq(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!aV(e.latestValues))continue;iV(e.latestValues)&&e.updateSnapshot();const r=KW();vq(r,e.measurePageBox()),kq(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return aV(this.latestValues)&&kq(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=s(s(s({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qV.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(t||r&&this.isSharedProjectionDirty||this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:o,layoutId:i}=this.options;if(!this.layout||!o&&!i)return;this.resolvedRelativeTargetAt=qV.timestamp;const a=this.getClosestProjectingParent();var s,l,c;(a&&this.linkedParentVersion!==a.layoutVersion&&!a.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(a&&a.layout?this.createRelativeTarget(a,this.layout.layoutBox,a.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta)&&(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),s=this.target,l=this.relativeTarget,c=this.relativeParent.target,AY(s.x,l.x,c.x),AY(s.y,l.y,c.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):vq(this.target,this.layout.layoutBox),pV(this.target,this.targetDelta)):vq(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,a&&Boolean(a.resumingFrom)===Boolean(this.resumingFrom)&&!a.options.layoutScroll&&a.target&&1!==this.animationProgress?this.createRelativeTarget(a,this.target,a.target):this.relativeParent=this.relativeTarget=void 0),HV.value&&Aq.calculatedTargetDeltas++)}getClosestProjectingParent(){if(this.parent&&!iV(this.parent.latestValues)&&!sV(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,n){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},RY(this.relativeTargetOrigin,t,n),vq(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty)&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===qV.timestamp&&(r=!1),r)return;const{layout:o,layoutId:i}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!o&&!i)return;vq(this.layoutCorrected,this.layout.layoutBox);const a=this.treeScale.x,s=this.treeScale.y;!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=n.length;if(!o)return;let i,a;t.x=t.y=1;for(let s=0;s<o;s++){i=n[s],a=i.projectionDelta;const{visualElement:o}=i.options;o&&o.props.style&&"contents"===o.props.style.display||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&vV(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,pV(e,a)),r&&aV(i.latestValues)&&vV(e,i.latestValues))}t.x<fV&&t.x>hV&&(t.x=1),t.y<fV&&t.y>hV&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(yq(this.prevProjectionDelta.x,this.projectionDelta.x),yq(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),IY(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===a&&this.treeScale.y===s&&Tq(this.projectionDelta.x,this.prevProjectionDelta.x)&&Tq(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),HV.value&&Aq.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},o=s({},this.latestValues),i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const a={x:{min:0,max:0},y:{min:0,max:0}},l=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,u=Boolean(l&&!d&&!0===this.options.crossfade&&!this.path.some(Qq));let p;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;Kq(i.x,e.x,n),Kq(i.y,e.y,n),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(RY(a,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,n,r){Jq(e.x,t.x,n.x,r),Jq(e.y,t.y,n.y,r)}(this.relativeTarget,this.relativeTargetOrigin,a,n),p&&function(e,t){return _q(e.x,t.x)&&_q(e.y,t.y)}(this.relativeTarget,p)&&(this.isProjectionDirty=!1),p||(p={x:{min:0,max:0},y:{min:0,max:0}}),vq(p,this.relativeTarget)),l&&(this.animationValues=o,function(e,t,n,r,o,i){var a,s;if(o)e.opacity=rV(0,null!==(a=n.opacity)&&void 0!==a?a:1,hq(r)),e.opacityExit=rV(null!==(s=t.opacity)&&void 0!==s?s:1,0,fq(r));else if(i){var l,c;e.opacity=rV(null!==(l=t.opacity)&&void 0!==l?l:1,null!==(c=n.opacity)&&void 0!==c?c:1,r)}for(let d=0;d<cq;d++){const o="border".concat(lq[d],"Radius");let i=pq(t,o),a=pq(n,o);void 0===i&&void 0===a||(i||(i=0),a||(a=0),0===i||0===a||uq(i)===uq(a)?(e[o]=Math.max(rV(dq(i),dq(a),r),0),(_V.test(a)||_V.test(i))&&(e[o]+="%")):e[o]=a)}(t.rotate||n.rotate)&&(e.rotate=rV(t.rotate||0,n.rotate||0,r))}(o,r,this.latestValues,n,u,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,n;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),null===(n=this.resumingFrom)||void 0===n||null===(n=n.currentAnimation)||void 0===n||n.stop(),this.pendingAnimation&&(YV(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=XV.update(()=>{eq.hasAnimatedSinceResize=!0,EG.layout++,this.motionValue||(this.motionValue=GW(0)),this.currentAnimation=function(e,t,n){const r=zW(e)?e:GW(e);return r.start(rY("",r,t,n)),r.animation}(this.motionValue,[0,1e3],s(s({},e),{},{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{EG.layout--},onComplete:()=>{EG.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:o}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&oZ(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=MY(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=MY(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}vq(t,n),vV(t,o),IY(this.projectionDeltaWithTransform,this.layoutCorrected,t,o)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Iq);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const r={};n.z&&zq("z",e,r,this.animationValues);for(let o=0;o<Oq.length;o++)zq("rotate".concat(Oq[o]),e,r,this.animationValues),zq("skew".concat(Oq[o]),e,r,this.animationValues);e.render();for(const o in r)e.setStaticValue(o,r[o]),this.animationValues&&(this.animationValues[o]=r[o]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=JH(null===t||void 0===t?void 0:t.pointerEvents)||"",void(e.transform=n?n(this.latestValues,""):"none");const r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=JH(null===t||void 0===t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!aV(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1));e.visibility="";const o=r.animationValues||r.latestValues;this.applyTransformsToTarget();let i=function(e,t,n){let r="";const o=e.x.translate/t.x,i=e.y.translate/t.y,a=(null===n||void 0===n?void 0:n.z)||0;if((o||i||a)&&(r="translate3d(".concat(o,"px, ").concat(i,"px, ").concat(a,"px) ")),1===t.x&&1===t.y||(r+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:o,rotateY:i,skewX:a,skewY:s}=n;e&&(r="perspective(".concat(e,"px) ").concat(r)),t&&(r+="rotate(".concat(t,"deg) ")),o&&(r+="rotateX(".concat(o,"deg) ")),i&&(r+="rotateY(".concat(i,"deg) ")),a&&(r+="skewX(".concat(a,"deg) ")),s&&(r+="skewY(".concat(s,"deg) "))}const s=e.x.scale*t.x,l=e.y.scale*t.y;return 1===s&&1===l||(r+="scale(".concat(s,", ").concat(l,")")),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,o);n&&(i=n(o,i)),e.transform=i;const{x:a,y:s}=this.projectionDelta;var l,c;(e.transformOrigin="".concat(100*a.origin,"% ").concat(100*s.origin,"% 0"),r.animationValues)?e.opacity=r===this?null!==(l=null!==(c=o.opacity)&&void 0!==c?c:this.latestValues.opacity)&&void 0!==l?l:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:e.opacity=r===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const d in wH){if(void 0===o[d])continue;const{correct:t,applyTo:n,isCSSVariable:a}=wH[d],s="none"===i?o[d]:t(o[d],r);if(n){const t=n.length;for(let r=0;r<t;r++)e[n[r]]=s}else a?this.options.visualElement.renderState.vars[d]=s:e[d]=s}this.options.layoutId&&(e.pointerEvents=r===this?JH(null===t||void 0===t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(Wq),this.root.sharedNodes.clear()}}}function Bq(e){e.updateLayout()}function Lq(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:o}=e.options,i=n.source!==e.layout.source;"size"===o?zY(e=>{const r=i?n.measuredBox[e]:n.layoutBox[e],o=MY(r);r.min=t[e].min,r.max=r.min+o}):oZ(o,n.layoutBox,t)&&zY(r=>{const o=i?n.measuredBox[r]:n.layoutBox[r],a=MY(t[r]);o.max=o.min+a,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+a)});const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};IY(a,t,n.layoutBox);const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};i?IY(s,e.applyTransform(r,!0),n.measuredBox):IY(s,t,n.layoutBox);const l=!jq(a);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:o,layout:i}=r;if(o&&i){const a={x:{min:0,max:0},y:{min:0,max:0}};RY(a,n.layoutBox,o.layoutBox);const s={x:{min:0,max:0},y:{min:0,max:0}};RY(s,t,i.layoutBox),Dq(a,s)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=s,e.relativeTargetOrigin=a,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:s,layoutDelta:a,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Nq(e){HV.value&&Aq.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Uq(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Vq(e){e.clearSnapshot()}function Wq(e){e.clearMeasurements()}function Hq(e){e.isLayoutDirty=!1}function Gq(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Xq(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Yq(e){e.resolveTargetDelta()}function qq(e){e.calcProjection()}function Zq(e){e.resetSkewAndRotation()}function $q(e){e.removeLeadSnapshot()}function Kq(e,t,n){e.translate=rV(t.translate,0,n),e.scale=rV(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Jq(e,t,n,r){e.min=rV(t.min,n.min,r),e.max=rV(t.max,n.max,r)}function Qq(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const eZ={duration:.45,ease:[.4,0,.1,1]},tZ=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),nZ=tZ("applewebkit/")&&!tZ("chrome/")?Math.round:UV;function rZ(e){e.min=nZ(e.min),e.max=nZ(e.max)}function oZ(e,t,n){return"position"===e||"preserve-aspect"===e&&!function(e,t,n){return Math.abs(e-t)<=n}(Mq(t),Mq(n),.2)}function iZ(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const aZ=Pq({attachResizeListener:(e,t)=>jY(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),sZ={current:void 0},lZ=Pq({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!sZ.current){const e=new aZ({});e.mount(window),e.setOptions({layoutScroll:!0}),sZ.current=e}return sZ.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),cZ={pan:{Feature:class extends bY{constructor(){super(...arguments),this.removePointerDownListener=UV}onPointerDown(e){this.session=new BY(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:FY(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:QY(e),onStart:QY(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&XV.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=DY(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends bY{constructor(e){super(e),this.removeGroupControls=UV,this.removeListeners=UV,this.controls=new KY(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||UV}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:lZ,MeasureLayout:rq}};function dZ(e,t){const n=function(e,t,n){if(e instanceof EventTarget)return[e];if("string"===typeof e){var r;let o=document;t&&(o=t.current);const i=null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:o.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}(e),r=new AbortController;return[n,s(s({passive:!0},t),{},{signal:r.signal}),()=>r.abort()]}function uZ(e){return!("touch"===e.pointerType||CY())}function pZ(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const o=r["onHover"+n];o&&XV.postRender(()=>o(t,EY(t)))}const hZ=(e,t)=>!!t&&(e===t||hZ(e,t.parentElement)),fZ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const gZ=new WeakSet;function mZ(e){return t=>{"Enter"===t.key&&e(t)}}function vZ(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function yZ(e){return _Y(e)&&!CY()}function xZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,o,i]=dZ(e,n),a=e=>{const r=e.currentTarget;if(!yZ(e))return;gZ.add(r);const i=t(r,e),a=(e,t)=>{window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",l),gZ.has(r)&&gZ.delete(r),yZ(e)&&"function"===typeof i&&i(e,{success:t})},s=e=>{a(e,r===window||r===document||n.useGlobalTarget||hZ(r,e.target))},l=e=>{a(e,!1)};window.addEventListener("pointerup",s,o),window.addEventListener("pointercancel",l,o)};return r.forEach(e=>{var t;(n.useGlobalTarget?window:e).addEventListener("pointerdown",a,o),EU(e)&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=mZ(()=>{if(gZ.has(n))return;vZ(n,"down");const e=mZ(()=>{vZ(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>vZ(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)})(e,o)),t=e,fZ.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),i}function bZ(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const o=r["onTap"+("End"===n?"":n)];o&&XV.postRender(()=>o(t,EY(t)))}const wZ=["root"],SZ=new WeakMap,kZ=new WeakMap,CZ=e=>{const t=SZ.get(e.target);t&&t(e)},jZ=e=>{e.forEach(CZ)};function _Z(e,t,n){const r=function(e){let{root:t}=e,n=l(e,wZ);const r=t||document;kZ.has(r)||kZ.set(r,{});const o=kZ.get(r),i=JSON.stringify(n);return o[i]||(o[i]=new IntersectionObserver(jZ,s({root:t},n))),o[i]}(t);return SZ.set(e,n),r.observe(e),()=>{SZ.delete(e),r.unobserve(e)}}const EZ={some:0,all:1};const DZ={inView:{Feature:class extends bY{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:o}=e,i={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:EZ[r]};return _Z(this.node.current,i,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,o&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),i=t?n:r;i&&i(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends bY{mount(){const{current:e}=this.node;e&&(this.unmount=xZ(e,(e,t)=>(bZ(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return bZ(this.node,e,n?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends bY{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(M2){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=CG(jY(this.node.current,"focus",()=>this.onFocus()),jY(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends bY{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,o,i]=dZ(e,n),a=e=>{if(!uZ(e))return;const{target:n}=e,r=t(n,e);if("function"!==typeof r||!n)return;const i=e=>{uZ(e)&&(r(e),n.removeEventListener("pointerleave",i))};n.addEventListener("pointerleave",i,o)};return r.forEach(e=>{e.addEventListener("pointerenter",a,o)}),i}(e,(e,t)=>(pZ(this.node,t,"Start"),e=>pZ(this.node,e,"End"))))}unmount(){}}}},MZ={layout:{ProjectionNode:lZ,MeasureLayout:rq}},TZ=hG(s(s(s(s({},SY),DZ),cZ),MZ),FH),IZ=t=>{let{currentFragId:n,transitionCfg:r,children:o}=t;const i=(0,e.useMemo)(()=>((e,t,n)=>{const r="100%";switch(e){case"page_turn":return{initial:{rotateY:90,originX:0,opacity:1,filter:"brightness(0.2)",zIndex:10},animate:{rotateY:0,originX:0,opacity:1,filter:"brightness(1)",zIndex:10,transition:{duration:t||.8,ease:"easeInOut"===n?[.16,1,.3,1]:n}},exit:{rotateY:-90,originX:0,opacity:1,filter:"brightness(0.5)",zIndex:1,transition:{duration:t||.8,ease:"easeInOut"===n?[.16,1,.3,1]:n}}};case"slide_left":return{initial:{x:r,opacity:1,zIndex:2},animate:{x:0,opacity:1,zIndex:2},exit:{x:"-".concat(r),opacity:1,zIndex:1,filter:"brightness(0.5)"}};case"slide_right":return{initial:{x:"-".concat(r),opacity:1,zIndex:2},animate:{x:0,opacity:1,zIndex:2},exit:{x:r,opacity:1,zIndex:1,filter:"brightness(0.5)"}};case"slide_up":return{initial:{y:r,opacity:1,zIndex:2},animate:{y:0,opacity:1,zIndex:2},exit:{y:"-".concat(r),opacity:1,zIndex:1}};case"slide_down":return{initial:{y:"-".concat(r),opacity:1,zIndex:2},animate:{y:0,opacity:1,zIndex:2},exit:{y:r,opacity:1,zIndex:1}};case"flip_x":return{initial:{rotateX:90,opacity:0},animate:{rotateX:0,opacity:1},exit:{rotateX:-90,opacity:0}};case"flip_y":return{initial:{rotateY:90,opacity:0},animate:{rotateY:0,opacity:1},exit:{rotateY:-90,opacity:0}};case"zoom_in":return{initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0,filter:"blur(10px)"}};case"zoom_out":return{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.1,opacity:0}};case"blur":return{initial:{filter:"blur(20px)",opacity:0},animate:{filter:"blur(0px)",opacity:1},exit:{filter:"blur(20px)",opacity:0}};case"tv_turn_on":return{initial:{scaleY:.005,scaleX:0,opacity:1,filter:"brightness(5)"},animate:{scaleY:1,scaleX:1,opacity:1,filter:"brightness(1)",transition:{type:"spring",stiffness:120,damping:15}},exit:{scaleY:.005,scaleX:0,opacity:0,filter:"brightness(5)"}};case"iris_circle":return{initial:{clipPath:"circle(0% at 50% 50%)",zIndex:10},animate:{clipPath:"circle(150% at 50% 50%)",zIndex:10},exit:{zIndex:0,filter:"brightness(0.5)"}};case"wipe_diagonal":return{initial:{clipPath:"polygon(100% 0, 100% 0, 100% 100%, 100% 100%)",zIndex:10},animate:{clipPath:"polygon(0 0, 100% 0, 100% 100%, 0 100%)",zIndex:10},exit:{zIndex:0,filter:"brightness(0.5)"}};case"flash_white":return{initial:{opacity:0,filter:"brightness(3)"},animate:{opacity:1,filter:"brightness(1)"},exit:{opacity:0}};case"flash_black":return{initial:{opacity:0,filter:"brightness(0)"},animate:{opacity:1,filter:"brightness(1)"},exit:{opacity:0}};default:return{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}}})(r.type,r.duration,r.ease),[r.type,r.duration,r.ease]);return(0,c.jsxs)("div",{style:{width:"100%",height:"100%",position:"absolute",perspective:"2000px",overflow:"hidden",background:"#000"},children:[(0,c.jsx)(BU,{mode:"popLayout",custom:r.type,children:(0,c.jsx)(TZ.div,{variants:i,initial:!!r.enabled&&"initial",animate:!!r.enabled&&"animate",exit:!!r.enabled&&"exit",transition:{duration:r.duration||.6,ease:r.ease||"easeInOut"},style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,transformStyle:"preserve-3d",backfaceVisibility:"hidden",boxShadow:"0 0 20px rgba(0,0,0,0.5)"},children:o},n)}),"page_turn"===r.type&&(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,width:"40px",background:"linear-gradient(to right, rgba(0,0,0,0.3), transparent)",zIndex:20,pointerEvents:"none"}})]})},AZ=(e,t,n,r,o)=>{const i=o.find(e=>e.id===r);if(!i)return{x:e,y:t,rotate:n};const a=Number(i.x)||0,s=Number(i.y)||0,l=Number(i.rotate)||0,c=n-l,d=(Number(i.w)||0)/2,u=(Number(i.h)||0)/2,p=e-a-d,h=t-s-u,f=-l*(Math.PI/180),g=Math.cos(f),m=Math.sin(f);return{x:p*g-h*m+d,y:p*m+h*g+u,rotate:c}},OZ=()=>(0,c.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"#ffffff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:99999},children:[(0,c.jsx)("svg",{style:{position:"absolute",width:0,height:0},children:(0,c.jsx)("defs",{children:(0,c.jsxs)("filter",{id:"ios-test-glitch",x:"0",y:"0",width:"100%",height:"100%",filterUnits:"userSpaceOnUse",primitiveUnits:"userSpaceOnUse",children:[(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"R"}),(0,c.jsx)("feOffset",{in:"R",dx:"10",dy:"0",result:"R_SHIFT"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"0 0 0 0 0  0 1 0 0 0  0 0 0 0 0  0 0 0 1 0",result:"G"}),(0,c.jsx)("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:"0 0 0 0 0  0 0 0 0 0  0 0 1 0 0  0 0 0 1 0",result:"B"}),(0,c.jsx)("feOffset",{in:"B",dx:"-10",dy:"0",result:"B_SHIFT"}),(0,c.jsx)("feBlend",{in:"R_SHIFT",in2:"G",mode:"screen",result:"RG"}),(0,c.jsx)("feBlend",{in:"RG",in2:"B_SHIFT",mode:"screen"})]})})}),(0,c.jsx)("div",{style:s({fontSize:"60px",fontWeight:"bold",color:"black",marginBottom:"20px",filter:"url(#ios-test-glitch)"},{transform:"translateZ(0)",willChange:"filter"}),children:"TEST IOS"}),(0,c.jsx)("div",{style:{fontSize:"20px",color:"#333"},children:"\u0415\u0441\u043b\u0438 \u0442\u0435\u043a\u0441\u0442 \u0434\u0432\u043e\u0438\u0442\u0441\u044f \u0446\u0432\u0435\u0442\u0430\u043c\u0438 \u2014 \u0444\u0438\u043b\u044c\u0442\u0440 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442."})]}),RZ=e=>{let{activeGroup:t,staticElements:n,onSelectElement:r,onTimeChange:o,onNodeDragStart:i}=e;if(!t||!t.elements||!n)return null;const a=(e,t,r)=>{const o=n.find(t=>t.id===e);if(!o)return{x:0,y:0};const i=(r._config||{}).easing||"linear",a=BB(r,"x",t,i),s=BB(r,"y",t,i);return{x:null!==a?a:o.x,y:null!==s?s:o.y}};return(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:9999,overflow:"visible"},children:Object.keys(t.elements).map(e=>{const s=t.elements[e];if(!(s.x&&s.x.length>0||s.y&&s.y.length>0))return null;const l=new Set;s.x&&s.x.forEach(e=>l.add(e.t)),s.y&&s.y.forEach(e=>l.add(e.t));const d=Array.from(l).sort((e,t)=>e-t);if(d.length<2)return null;const u=s._config||{},p=[],h=d[0],f=d[d.length-1];for(let t=h;t<=f;t+=.04){let n=a(e,t,s),r={x:n.x,y:n.y};r=PB(r,u,t),p.push("".concat(r.x,",").concat(r.y))}let g=a(e,f,s),m={x:g.x,y:g.y};m=PB(m,u,f),p.push("".concat(m.x,",").concat(m.y));const v=p.join(" "),y=d.map(t=>{const n=a(e,t,s);return(0,c.jsx)("circle",{cx:n.x,cy:n.y,r:5,strokeWidth:2,fill:"#fff",stroke:"#007bff",style:{cursor:"grab",pointerEvents:"auto"},onMouseDown:n=>{n.preventDefault(),n.stopPropagation(),r(e),o(t),i&&i(n)},onTouchStart:n=>{n.preventDefault(),n.stopPropagation(),r(e),o(t),i&&i(n)},children:(0,c.jsxs)("title",{children:["Keyframe: ",t.toFixed(2),"s"]})},"node-".concat(t))}),x=n.find(t=>t.id===e);let b=0,w=0;x&&(b=x.w/2,w=x.h/2);const S=u.effect&&"none"!==u.effect,k=S?"#ff4081":"#00e676",C=S?"none":"4,4";return(0,c.jsxs)("g",{transform:"translate(".concat(b,", ").concat(w,")"),children:[(0,c.jsx)("polyline",{points:v,fill:"none",stroke:k,strokeWidth:"2",strokeDasharray:C,opacity:.8,style:{pointerEvents:"none"}}),y]},e)})})},zZ=t=>{let{element:n,zoom:r,onUpdate:o,isRotating:i}=t;const[a,s]=(0,e.useState)(!1),[l,d]=(0,e.useState)((null===n||void 0===n?void 0:n.rotate)||0),u=(0,e.useRef)(null);if((0,e.useEffect)(()=>{n&&d(Math.round(n.rotate||0))},[null===n||void 0===n?void 0:n.rotate,n]),(0,e.useEffect)(()=>{i&&s(!0)},[i]),(0,e.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&(i||s(!1))};return a&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[a,i]),!n)return null;const p=e=>{o(n.id,{rotate:e})},h=n.x+n.w/2,f=n.y+n.h/2,g=n.h/2+60+40/r;return(0,c.jsx)("div",{ref:u,className:"rotation-control-wrapper",style:{position:"absolute",left:"".concat(h,"px"),top:"".concat(f,"px"),width:0,height:0,pointerEvents:"none",zIndex:1e4,transform:"rotate(".concat(n.rotate||0,"deg) translate(0px, -").concat(g,"px)")},onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),children:(0,c.jsx)("div",{style:{transform:"translate(-50%, -50%) scale(".concat(1/r,")"),pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:a&&(0,c.jsxs)("div",{style:{background:"#2a2a2a",padding:"6px",borderRadius:"6px",border:"1px solid #444",display:"flex",gap:"5px",alignItems:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.5)",animation:"fadeIn 0.2s ease"},onMouseDown:e=>e.stopPropagation(),children:[(0,c.jsx)("style",{children:"@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }"}),(0,c.jsx)("span",{style:{fontSize:"12px",color:"#aaa"},children:"\u2220"}),(0,c.jsx)("input",{type:"number",value:Math.round(l),onChange:e=>{e.stopPropagation();const t=parseFloat(e.target.value);d(t),p(t)},onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),style:{width:"50px",background:"#111",border:"1px solid #333",color:"#fff",fontSize:"12px",padding:"3px",borderRadius:"3px",textAlign:"center"}}),(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),d(0),p(0)},title:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0432 0",style:{background:"#444",border:"none",color:"#fff",cursor:"pointer",fontSize:"12px",width:"22px",height:"22px",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"center"},children:"\u27f2"})]})})})},FZ=t=>{var n,r;let{elements:o,resolution:i,onUpdateElement:a,onUpdateElements:l,selectedElementId:d,onSelectElement:u,externalSelectionIds:p=[],activeFragmentData:h,isGlobal:f,canvasBg:g,gameAreaBg:m,layoutMode:v,savedView:y,onUpdateView:x,computedStyles:b={},gridSettings:w,lightAnimTime:S,menuSettings:k,statsSettings:C,textAnimSettings:j,typingSoundUrl:_,animationSettings:E,currentTime:D,showTrajectories:M,staticElements:T,onTimeChange:I,previewTrigger:A,transitionSettings:O,onUpdateGrid:R,weatherSettings:z,cameraSettings:F,onStartLightAnimation:P}=t;const B=(0,e.useRef)(null),L=(0,e.useRef)(!1),[N,U]=(0,e.useState)([]),[V,W]=(0,e.useState)(!1),[H,G]=(0,e.useState)(!1),[X,Y]=(0,e.useState)(!1),[q,Z]=(0,e.useState)(null),$=((0,e.useRef)(null),i.width),K=i.height,J=w||{enabled:!1,snap:!1,step:50,snapThreshold:10,customLines:[]},{containerRef:Q,zoom:ee,pan:te,isPanning:ne,isMultiTouch:re,fitToScreen:oe,handleMouseDown:ie,gestureRef:ae}=((t,n,r,o,i)=>{const a=(0,e.useRef)(null),[l,c]=(0,e.useState)(1),[d,u]=(0,e.useState)({x:0,y:0}),[p,h]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),m=(0,e.useRef)(d),v=(0,e.useRef)({x:0,y:0,panX:0,panY:0}),y=(0,e.useRef)({startZoom:1,startPan:{x:0,y:0},startDist:0,startCenter:{x:0,y:0},isGesture:!1,lastTouch:{x:0,y:0}});(0,e.useEffect)(()=>{m.current=d},[d]);const x=(0,e.useCallback)(()=>{if(!a.current)return;const{clientWidth:e,clientHeight:r}=a.current;if(0===e||0===r)return;const i=(e-40)/t,s=(r-40)/n,l=.95*Math.min(i,s),d={x:(e-t*l)/2,y:(r-n*l)/2};c(l),u(d),o&&o({zoom:l,pan:d})},[t,n,o]);(0,e.useEffect)(()=>{r&&r.zoom&&r.pan?(c(r.zoom),u(r.pan)):x()},[x]),(0,e.useEffect)(()=>{const e=()=>{h(!1),setTimeout(()=>g(!1),100)},t=e=>{if(p){const t=e.clientX-v.current.x,n=e.clientY-v.current.y,r={x:v.current.panX+t,y:v.current.panY+n};u(r),o&&o({zoom:l,pan:r})}};return window.addEventListener("mouseup",e),window.addEventListener("mousemove",t),window.addEventListener("touchend",e,{capture:!0}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("mousemove",t),window.removeEventListener("touchend",e,{capture:!0})}},[p,l,o]),(0,e.useEffect)(()=>{const e=a.current;if(!e)return;const t=t=>{t.preventDefault();const n=.001*-t.deltaY,r=l,i=Math.min(Math.max(r+n,.05),10),a=m.current,s=e.getBoundingClientRect(),d=t.clientX-s.left,p=t.clientY-s.top,h={x:d-(d-a.x)*(i/r),y:p-(p-a.y)*(i/r)};c(i),u(h),o&&o({zoom:i,pan:h})},n=t=>{if(i&&1===t.touches.length){const e=t.touches[0];v.current={x:e.clientX,y:e.clientY,panX:m.current.x,panY:m.current.y}}if(t.touches.length>=2){t.preventDefault(),g(!0),y.current.isGesture=!0;const n=e.getBoundingClientRect(),r=xB(t.touches),o={x:r.x-n.left,y:r.y-n.top},i=m.current;y.current=s(s({},y.current),{},{isGesture:!0,startDist:yB(t.touches),startZoom:l,startPan:s({},i),startCenter:o})}},r=t=>{if(i&&1===t.touches.length&&!y.current.isGesture){t.cancelable&&t.preventDefault();const e=t.touches[0],n=e.clientX-v.current.x,r=e.clientY-v.current.y,i={x:v.current.panX+n,y:v.current.panY+r};u(i),o&&o({zoom:l,pan:i})}if(2===t.touches.length&&y.current.isGesture){t.cancelable&&t.preventDefault(),g(!0);const{startDist:n,startZoom:r,startPan:i,startCenter:a}=y.current,s=yB(t.touches)/n,l=Math.min(Math.max(r*s,.05),10),c=e.getBoundingClientRect(),d=xB(t.touches),p={x:d.x-c.left,y:d.y-c.top},h=(a.x-i.x)/r,f=(a.y-i.y)/r,m=p.x-h*l,v=p.y-f*l;u({x:m,y:v}),o&&o({zoom:l,pan:{x:m,y:v}})}},d=e=>{e.touches.length<2&&(y.current.isGesture=!1)};return e.addEventListener("wheel",t,{passive:!1}),e.addEventListener("touchstart",n,{passive:!1}),e.addEventListener("touchmove",r,{passive:!1}),e.addEventListener("touchend",d),()=>{e.removeEventListener("wheel",t),e.removeEventListener("touchstart",n),e.removeEventListener("touchmove",r),e.removeEventListener("touchend",d)}},[l,o,i]);const b=e=>{h(!0),v.current={x:e.clientX,y:e.clientY,panX:m.current.x,panY:m.current.y}};return{containerRef:a,zoom:l,setZoom:c,pan:d,setPan:u,isPanning:p,isMultiTouch:f,fitToScreen:x,handleMouseDown:e=>{i&&0===e.button?b(e):(1===e.button||2===e.button||0===e.button&&e.shiftKey)&&(b(e),e.preventDefault())},gestureRef:y}})($,K,y,x,V),{setDraggingLine:se}=((t,n,r,o,i)=>{const[a,l]=(0,e.useState)(null);return(0,e.useEffect)(()=>{if(!a)return;const e=e=>{if(!t.current)return;const l=e.clientX||e.touches&&e.touches[0].clientX,c=e.clientY||e.touches&&e.touches[0].clientY;if(void 0===l||void 0===c)return;const d=t.current.getBoundingClientRect(),u=(l-d.left-r.x)/n,p=(c-d.top-r.y)/n;let h="x"===a.axis?u:p;if(h=5*Math.round(h/5),o&&o.customLines&&i){const e=o.customLines.map(e=>e.id===a.id?s(s({},e),{},{pos:h}):e);i({customLines:e})}},c=()=>{l(null),document.body.style.cursor="default"};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",c),window.addEventListener("touchmove",e,{passive:!1}),window.addEventListener("touchend",c),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",c),window.removeEventListener("touchmove",e),window.removeEventListener("touchend",c)}},[a,r,n,o,i,t]),{draggingLine:a,setDraggingLine:l}})(Q,ee,te,w,R),le=!f&&!0===(null===h||void 0===h||null===(n=h.effects)||void 0===n||null===(r=n.parallax)||void 0===r?void 0:r.enabled),{parallaxOffset:ce,gyroPermission:de,requestGyroPermission:ue}=xL(f,le);(0,e.useEffect)(()=>{const e=()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.updateRect()};e();const t=setTimeout(e,0),n=setTimeout(e,50);return()=>{clearTimeout(t),clearTimeout(n)}},[N,ee,o,te,D,S]),(0,e.useEffect)(()=>{if(p&&p.length>0)U(p);else if(d){o.find(e=>e.id===d)&&(!N.includes(d)||N.length>1)&&U([d])}else N.length},[p,d,o]),(0,e.useEffect)(()=>{const e=()=>L.current=!0,t=()=>L.current=!1;return window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("mouseup",t,{capture:!0}),window.addEventListener("touchstart",e,{capture:!0}),window.addEventListener("touchend",t,{capture:!0}),()=>{window.removeEventListener("mousedown",e,{capture:!0}),window.removeEventListener("mouseup",t,{capture:!0}),window.removeEventListener("touchstart",e,{capture:!0}),window.removeEventListener("touchend",t,{capture:!0})}},[]),(0,e.useEffect)(()=>{const e=e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName))return;if(0===N.length)return;const t=e.shiftKey?10:1;let n=0,r=0;if("ArrowLeft"===e.key)n=-t;else if("ArrowRight"===e.key)n=t;else if("ArrowUp"===e.key)r=-t;else{if("ArrowDown"!==e.key)return;r=t}e.preventDefault(),N.forEach(e=>{const t=o.find(t=>t.id===e);t&&a(e,{x:(t.x||0)+n,y:(t.y||0)+r})})};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[N,o,a]),(0,e.useEffect)(()=>{if(q&&N.length>0&&B.current){const e="mousedown"===q.type||"touchstart"===q.type,t=1===q.buttons||q.touches&&q.touches.length>0;e&&t&&L.current&&B.current.dragStart(q),Z(null)}},[N,q]);const pe=d?o.find(e=>e.id===d):null,he=(null===pe||void 0===pe||pe.type,"folder"===(null===pe||void 0===pe?void 0:pe.type)),fe=!(null===pe||void 0===pe||!pe.parentId),ge=N.map(e=>document.getElementById(e)).filter(e=>null!==e),me=o.filter(e=>!N.includes(e.id)).map(e=>document.getElementById(e.id)).filter(e=>null!==e),ve=J.customLines||[],ye=!1!==J.customLinesVisible,xe=ye?ve:[],be=[0,$,...xe.filter(e=>"x"===e.axis).map(e=>e.pos)],we=[0,K,...xe.filter(e=>"y"===e.axis).map(e=>e.pos)];(0,e.useEffect)(()=>{const e=e=>{"Shift"===e.key&&Y(!0)},t=e=>{"Shift"===e.key&&Y(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]);const Se=(void 0!==J.snapThreshold?Number(J.snapThreshold):10)/ee;return(0,c.jsxs)("div",{ref:Q,tabIndex:-1,style:{width:"100%",height:"100%",overflow:"hidden",cursor:ne?"grabbing":"default",display:"block",backgroundColor:g||"#252525",position:"relative",outline:"none",overscrollBehavior:"none",touchAction:"none","--editor-zoom":ee},onMouseDown:e=>{1!==e.button&&2!==e.button||e.preventDefault(),ie(e),e.target===Q.current&&(u(null),U([]))},onContextMenu:e=>e.preventDefault(),children:[(0,c.jsx)("style",{children:"\n        :root { --handle-size: 24px; }\n        .mobile-friendly-moveable .moveable-control {\n            width: calc(var(--handle-size) / var(--editor-zoom)) !important;\n            height: calc(var(--handle-size) / var(--editor-zoom)) !important;\n            margin-left: calc(var(--handle-size) / -2 / var(--editor-zoom)) !important;\n            margin-top: calc(var(--handle-size) / -2 / var(--editor-zoom)) !important;\n            background: #fff !important;\n            border: calc(2px / var(--editor-zoom)) solid #007bff !important;\n            border-radius: 50% !important;\n            box-shadow: 0 0 calc(4px / var(--editor-zoom)) rgba(0,0,0,0.3);\n            z-index: 10;\n        }\n        .mobile-friendly-moveable .moveable-line.moveable-rotation-line {\n            display: block !important;\n            height: 80px !important;\n            top: -80px !important;\n            width: 2px !important;\n            background: #4af !important;\n            pointer-events: none;\n        }\n        .mobile-friendly-moveable .moveable-rotation-control {\n            display: block !important;\n            position: absolute !important;\n            top: 0 !important; left: 0 !important;\n            margin-top: calc( -80px - (var(--handle-size) / 2 / var(--editor-zoom)) ) !important;\n            background: #fff !important;\n            border: 2px solid #4af !important;\n            border-radius: 50% !important;\n            z-index: 20 !important;\n            cursor: alias !important;\n        }\n    "}),"granted"!==de&&"undefined"!==typeof DeviceOrientationEvent&&"function"===typeof DeviceOrientationEvent.requestPermission&&(0,c.jsx)("button",{onClick:ue,style:{position:"absolute",top:10,right:10,zIndex:2e3,padding:"12px 20px",background:"#4caf50",border:"none",color:"#fff",borderRadius:4,fontWeight:"bold"},children:"\ud83d\udcf1 \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,c.jsxs)("div",{style:{position:"absolute",top:10,right:20,zIndex:1e3,display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{onClick:()=>W(!V),style:{background:V?"#ff4081":"#333",color:"#fff",border:"1px solid #555",padding:"5px 10px",borderRadius:4,minWidth:"40px"},title:V?"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0431\u043e\u0440":"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0431\u043e\u0440",children:V?"\ud83d\udd12":"\ud83d\udd13"}),(0,c.jsx)("button",{onClick:oe,style:{background:"#333",color:"#fff",border:"1px solid #555",padding:"5px 10px",borderRadius:4},children:"\u27f2 Fit"})]}),(0,c.jsxs)("div",{style:{transform:"translate(".concat(te.x,"px, ").concat(te.y,"px) scale(").concat(ee,")"),transformOrigin:"0 0",width:$,height:K,position:"absolute",top:0,left:0,backgroundColor:m||"#ffffff",border:"1px solid #666",boxShadow:"0 0 50px rgba(0,0,0,0.5)",boxSizing:"border-box"},children:[(0,c.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:0},children:[(0,c.jsx)("div",{style:{width:"100%",height:"100%",position:"relative",zIndex:5e3},children:(0,c.jsx)(OZ,{})}),M&&E&&(0,c.jsx)(RZ,{activeGroup:E,staticElements:T,onSelectElement:u,onTimeChange:I,onNodeDragStart:e=>Z(e.nativeEvent||e)}),ye&&ve.map(e=>{const t="x"===e.axis,n=J.customWidth||2,r=t?"col-resize":"row-resize";return(0,c.jsxs)("div",{style:{position:"absolute",left:t?"".concat(e.pos-n/2,"px"):0,top:t?0:"".concat(e.pos-n/2,"px"),width:t?"".concat(n,"px"):"100%",height:t?"100%":"".concat(n,"px"),zIndex:9998},children:[(0,c.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:J.customColor||"#ffeb3b",boxShadow:"0 0 2px rgba(0,0,0,0.5)",pointerEvents:"none"}}),(0,c.jsx)("div",{style:{position:"absolute",top:t?0:-7,left:t?-7:0,width:t?"14px":"100%",height:t?"100%":"14px",cursor:r,pointerEvents:"auto"},onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),se({id:e.id,axis:e.axis}),document.body.style.cursor=r},onTouchStart:t=>{t.stopPropagation(),se({id:e.id,axis:e.axis})},children:(0,c.jsx)("title",{children:Math.round(e.pos)})})]},e.id)}),J.enabled&&(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:999,pointerEvents:"none",backgroundImage:"linear-gradient(to right, ".concat(J.color||"#4caf504d"," ").concat(J.lineWidth||1,"px, transparent ").concat(J.lineWidth||1,"px), linear-gradient(to bottom, ").concat(J.color||"#4caf504d"," ").concat(J.lineWidth||1,"px, transparent ").concat(J.lineWidth||1,"px)"),backgroundSize:"".concat(J.step,"px ").concat(J.step,"px")}})]}),(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",boxShadow:"0 0 0 10000px rgba(0, 0, 0, 0.85)",pointerEvents:"none",zIndex:900}}),1===N.length&&pe&&(0,c.jsx)(zZ,{element:pe,zoom:ee,onUpdate:a,isRotating:H}),(0,c.jsx)(vB,{ref:B,className:"mobile-friendly-moveable",target:ge,resizable:!he&&!fe,scalable:he,origin:!0,keepRatio:!!he&&!X,draggable:!0,throttleDrag:0,throttleScale:0,throttleResize:0,throttleRotate:0,snappable:J.snap,snapGridWidth:J.step,snapGridHeight:J.step,snapThreshold:Se,snapHorizontalThreshold:Se,snapVerticalThreshold:Se,verticalGuidelines:be,horizontalGuidelines:we,elementGuidelines:J.snap?me:[],snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},isDisplaySnapDigit:!1,bounds:{left:-500,top:-500,right:$+500,bottom:K+500},rotatable:!0,rotationPosition:"top",renderDirections:["nw","n","ne","w","e","sw","s","se"],onRotateStart:e=>{let{set:t}=e;G(!0),1===ge.length&&pe&&t(pe.rotate||0)},onRotate:e=>{var t,n;let{target:r,beforeRotate:i}=e;const s=r.id,l=o.find(e=>e.id===s),c=null!==(t=null===l||void 0===l?void 0:l.scaleX)&&void 0!==t?t:1,d=null!==(n=null===l||void 0===l?void 0:l.scaleY)&&void 0!==n?n:1;r.style.transform="rotate(".concat(i,"deg) scale(").concat(c,", ").concat(d,")"),l&&l.isVirtual&&a(s,{rotate:i})},onRotateEnd:e=>{let{target:t,lastEvent:n}=e;if(G(!1),!n)return;const r=t.id,i=o.find(e=>e.id===r),s=n.beforeRotate;if(i&&i.parentId){const e=AZ(i.x,i.y,s,i.parentId,T);a(r,{rotate:e.rotate})}else a(r,{rotate:s})},onRotateGroupStart:e=>{let{events:t}=e;G(!0),t.forEach(e=>{let{target:t,set:n}=e;const r=o.find(e=>e.id===t.id);r&&n(r.rotate||0)})},onRotateGroup:e=>{let{events:t}=e;t.forEach(e=>{var t,n;let{target:r,beforeRotate:i,drag:a}=e;const s=r.id,l=o.find(e=>e.id===s),c=null!==(t=null===l||void 0===l?void 0:l.scaleX)&&void 0!==t?t:1,d=null!==(n=null===l||void 0===l?void 0:l.scaleY)&&void 0!==n?n:1;r.style.transform="rotate(".concat(i,"deg) scale(").concat(c,", ").concat(d,")"),r.style.left="".concat(a.left,"px"),r.style.top="".concat(a.top,"px")})},onRotateGroupEnd:e=>{let{targets:t}=e;G(!1);const n={};t.forEach(e=>{const t=e.id,r=o.find(e=>e.id===t),i=e.style.transform.match(/rotate\((-?\d+\.?\d*)deg\)/),a=i?parseFloat(i[1]):0,s=parseFloat(e.style.left),l=parseFloat(e.style.top);if(r&&r.parentId){const e=AZ(s,l,a,r.parentId,T);n[t]={rotate:e.rotate,x:e.x,y:e.y}}else n[t]={rotate:a,x:s,y:l}}),l&&Object.keys(n).length>0&&l(n)},onDrag:e=>{let{target:t,left:n,top:r}=e;const i=t.id,s=o.find(e=>e.id===i);if(s&&s.parentId){const e=AZ(n,r,s.rotate,s.parentId,T);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px")}else t.style.left="".concat(n,"px"),t.style.top="".concat(r,"px");s&&s.isVirtual&&a(i,{x:n,y:r})},onDragEnd:e=>{let{target:t}=e;const n=t.id,r=parseFloat(t.style.left),o=parseFloat(t.style.top);a(n,{x:r,y:o})},onDragGroup:e=>{let{events:t}=e;return t.forEach(e=>{let{target:t,left:n,top:r}=e;const i=t.id,a=o.find(e=>e.id===i);if(a&&a.parentId){const e=AZ(n,r,a.rotate,a.parentId,T);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px")}else t.style.left="".concat(n,"px"),t.style.top="".concat(r,"px")})},onDragGroupEnd:e=>{let{targets:t}=e;const n={};t.forEach(e=>{const t=e.id,r=parseFloat(e.style.left),o=parseFloat(e.style.top);n[t]={x:r,y:o}}),l&&Object.keys(n).length>0&&l(n)},onScale:e=>{let{target:t,drag:n}=e;t.style.transform=n.transform},onScaleEnd:e=>{let{target:t,lastEvent:n}=e;if(!n)return;const{drag:r}=n,i=t.id,s=o.find(e=>e.id===i),l=n.scale[0],c=n.scale[1];if(s&&s.parentId){const e=s.rotate||0,t=AZ(r.left,r.top,e,s.parentId,T);a(i,{scaleX:l,scaleY:c,x:t.x,y:t.y})}else a(i,{scaleX:l,scaleY:c,x:r.left,y:r.top})},onResize:e=>{var t,n,r;let{target:i,width:s,height:l,drag:c}=e;const d=i.id,u=o.find(e=>e.id===d);i.style.width="".concat(s,"px"),i.style.height="".concat(l,"px");const p=null!==(t=null===u||void 0===u?void 0:u.scaleX)&&void 0!==t?t:1,h=null!==(n=null===u||void 0===u?void 0:u.scaleY)&&void 0!==n?n:1,f=null!==(r=null===u||void 0===u?void 0:u.rotate)&&void 0!==r?r:0;if(i.style.transform="rotate(".concat(f,"deg) scale(").concat(p,", ").concat(h,")"),u&&u.parentId){const e=AZ(c.left,c.top,f,u.parentId,T);i.style.left="".concat(e.x,"px"),i.style.top="".concat(e.y,"px")}else i.style.left="".concat(c.left,"px"),i.style.top="".concat(c.top,"px");u&&u.isVirtual&&a(d,{w:s,h:l,x:c.left,y:c.top})},onResizeEnd:e=>{let{target:t,lastEvent:n}=e;if(!n)return;const{drag:r,width:i,height:s}=n,l=t.id,c=o.find(e=>e.id===l),d=i,u=s;if(c&&c.parentId){const e=AZ(r.left,r.top,c.rotate||0,c.parentId,T);a(l,{w:d,h:u,x:e.x,y:e.y})}else a(l,{w:d,h:u,x:r.left,y:r.top})},onResizeGroup:e=>{let{events:t}=e;return t.forEach(e=>{let{target:t,width:n,height:r,drag:o}=e;t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),t.style.transform=o.transform})},onResizeGroupEnd:e=>{let{targets:t,events:n}=e;const r={};n.forEach(e=>{var t,n;const i=e.target,a=e.drag,s=i.id,l=o.find(e=>e.id===s),c=parseFloat(i.style.width),d=parseFloat(i.style.height),u=null!==(t=null===l||void 0===l?void 0:l.scaleX)&&void 0!==t?t:1,p=null!==(n=null===l||void 0===l?void 0:l.scaleY)&&void 0!==n?n:1;if(i.style.transform="rotate(".concat(l.rotate||0,"deg) scale(").concat(u,", ").concat(p,")"),l&&l.parentId){const e=AZ(a.left,a.top,l.rotate,l.parentId,T);r[s]={w:c,h:d,x:e.x,y:e.y}}else r[s]={w:c,h:d,x:a.left,y:a.top}}),l&&Object.keys(r).length>0&&l(r)}},"scene-moveable")]})]})},PZ=(e,t)=>{e.global_settings||(e.global_settings={});const n=e.global_settings;if(!n.menu_desktop||!n.menu_mobile){const e={};["menu_enabled","menu_open_dir","menu_x","menu_y","menu_btn_w","menu_btn_h","menu_btn_size","menu_extra_w","menu_extra_h","menu_font_size","menu_radius_main","menu_radius_sub","menu_radius","menu_gap","menu_internal_gap","menu_main_color","menu_arrow_color","menu_item_color","menu_opacity_main","menu_opacity_sub","menu_opacity","menu_text_opacity","menu_border_color","menu_border_width","menu_border_opacity"].forEach(t=>{void 0!==n[t]&&(e[t]=n[t],delete n[t])}),n.menu_desktop||(n.menu_desktop=s(s({},e),{},{menu_enabled:!0})),n.menu_mobile||(n.menu_mobile=s(s({},e),{},{menu_enabled:!0})),void 0===n.autosave_interval&&(n.autosave_interval=0)}n.text_animation||(n.text_animation={enabled:!1,type:"typewriter",speed:30,cursor_enabled:!0,cursor_char:"_",cursor_blink:!0,skip_mode:"click_anywhere",block_choices:!1,pause_behavior:"timer",clear_behavior:"timer"}),n.audio||(n.audio={playlist:[],playlist_mode:"loop",click_sound:"",typing_sound:""}),n.grid||(n.grid={enabled:!1,snap:!1,step:50,color:"#4caf504d",lineWidth:1,snapThreshold:10,customLines:[],customLinesVisible:!0}),n.grid&&void 0===n.grid.customLinesVisible&&(n.grid.customLinesVisible=!0),n.layout_desktop||(n.layout_desktop={}),n.layout_mobile||(n.layout_mobile={}),n.styles||(n.styles={}),n.play_mode||(n.play_mode="adaptive"),n.resolution_desktop||(n.resolution_desktop={width:1280,height:720}),n.resolution_mobile||(n.resolution_mobile={width:480,height:800}),n.canvas_bg_color||(n.canvas_bg_color="#1a1a1a"),n.game_area_bg_color||(n.game_area_bg_color="#ffffff"),e.fragments||(e.fragments={}),Object.values(e.fragments).forEach(e=>{e.effects||(e.effects={}),e.effects.darkness||(e.effects.darkness={enabled:!1,opacity:.95,radius:150,monochrome:!1,feather:.5,scaleX:1,scaleY:1,lightColor:"#ffb450",lightIntensity:.15}),["sceneLight_desktop","sceneLight_mobile"].forEach(t=>{e.effects[t]||(e.effects[t]={enabled:!1,ambientColor:"#000000",ambientDensity:.6,sources:[],obstacles:[],animation:{groups:[{id:"main",enabled:!0,elements:{}}],activeGroupId:"main"}})})}),e.assets||(e.assets={}),e.assets.sys_backgrounds||(e.assets.sys_backgrounds={name:"Backgrounds",files:[]}),e.assets.sys_textures||(e.assets.sys_textures={name:"Textures",files:[]}),e.assets.sys_objects||(e.assets.sys_objects={name:"Objects",files:[]}),e.assets[""]&&delete e.assets[""];const r=e=>{e&&e.files&&e.files.forEach(e=>{"folder"===e.type||"character_folder"===e.type?r(e):e.local_path&&(e.local_path=e.local_path.replace(/\\/g,"/"))})};if(Object.values(e.assets).forEach(e=>r(e)),t&&t.fragments){const n={},r=e=>{e&&e.files&&e.files.forEach(e=>{"folder"===e.type||"character_folder"===e.type?r(e):e.file_id&&(n[e.file_id]=e)})};Object.values(e.assets).forEach(e=>r(e)),Object.keys(t.fragments).forEach(r=>{const o=t.fragments[r];if(e.fragments[r]||(e.fragments[r]={}),o.media&&Array.isArray(o.media)){const t=o.media.find(e=>"photo"===e.type||"image"===e.type||"video"===e.type||"animation"===e.type);if(t&&t.file_id){const o=n[t.file_id];o&&!e.fragments[r].bg_image&&(e.fragments[r].bg_image=o.local_path)}}else if(o.image){const t=Object.values(n).find(e=>e.name===o.image||e.local_path&&e.local_path.includes(o.image));t&&!e.fragments[r].bg_image&&(e.fragments[r].bg_image=t.local_path)}})}return n.animations_desktop||(n.animations_desktop={groups:[{id:"main",name:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f",enabled:!1,duration:30,trigger:"start",elements:{}}],activeGroupId:"main"}),n.animations_mobile||(n.animations_mobile={groups:[{id:"main",name:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f",enabled:!1,duration:30,trigger:"start",elements:{}}],activeGroupId:"main"}),e},BZ=(e,t)=>{var n,r,o;if(!e)return{};const i=(null===(n=e.global_settings)||void 0===n?void 0:n.text_animation)||{};if(null===t)return i;const a=(null===(r=e.fragments)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.text_animation)||{},l=s(s({},i),a);return void 0!==a.enabled&&(l.enabled=a.enabled),l},LZ=(e,t)=>{var n,r,o;if(!e)return{};const i=null===t,a=(null===(n=e.global_settings)||void 0===n?void 0:n.stats_settings)||{},l=!i&&t&&(null===(r=e.fragments)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.stats_settings)||{};return s(s({},a),l)},NZ=(e,t)=>t?e&&e[t]?e[t]:t:null,UZ=e=>{var t;let{htmlData:n,story:r,selectedId:o,layoutMode:i,animOverrides:a={},assetsMap:l}=e;if(!n)return[];const c=n.global_settings||{},d=null===o,u=(e=>{const t={};if(!e)return t;const n=e=>{e.files&&e.files.forEach(e=>{"folder"===e.type||"character_folder"===e.type?n(e):(e.file_id&&(t[e.file_id]=e),e.url&&(t[e.url]=e),e.local_path&&(t[e.local_path]=e),e.src&&(t[e.src]=e))})};return Object.values(e).forEach(n),t})(n.assets),p="mobile"===i?"layout_mobile":"layout_desktop",h="mobile"===i?"layout_override_mobile":"layout_override_desktop",f=c["mobile"===i?"resolution_mobile":"resolution_desktop"]||("mobile"===i?{width:480,height:800}:{width:1280,height:720}),g=c[p]||{},m={id:"text_area",type:"text_area",x:50,y:f.height-250,w:f.width-100,h:200,z:100,rotate:0},v=g.text_area||{},y=s(s({},m),v);let x=s(s({},y),{},{id:"text_area",type:"text_area"});if(!d){var b;const e=null===(b=n.fragments)||void 0===b?void 0:b[o];if(e&&e[h]&&e[h].text_area){const t=e[h].text_area;x=s(s(s({},x),t),{},{rotate:void 0!==t.rotate?t.rotate:x.rotate})}}let w=s({},{id:"stat_box",type:"stat_box",x:f.width<500?10:20,y:20,w:200,h:100,z:200,rotate:0});if(g.stat_box&&(w=s(s({},w),g.stat_box)),!d){var S;const e=null===(S=n.fragments)||void 0===S?void 0:S[o];if(e&&e[h]&&e[h].stat_box){const t=e[h].stat_box;w=s(s(s({},w),t),{},{rotate:void 0!==t.rotate?t.rotate:w.rotate})}}const k=LZ(n,o);let C=null;if(k.p_stats_enabled){const e=void 0!==k.p_stats_w?k.p_stats_w:200,t=void 0!==k.p_stats_h?k.p_stats_h:150;let r=f.width-e-20;r<0&&(r=10);if(C={id:"player_stats_box",type:"player_stats_box",x:r,y:10,w:e,h:t,z:201,rotate:0},g.player_stats_box&&(C=s(s({},C),g.player_stats_box)),d)void 0!==k.p_stats_x&&(C.x=k.p_stats_x,C.y=k.p_stats_y,C.x>f.width&&(C.x=r));else{var j;const e=null===(j=n.fragments)||void 0===j?void 0:j[o];e&&e[h]&&e[h].player_stats_box&&(C=s(s({},C),e[h].player_stats_box))}}let _=[],E=2;const D=d?null:null===r||void 0===r||null===(t=r.fragments)||void 0===t?void 0:t[o];if(d)E=g.template_button_count||2;else{var M,T;const e=null===r||void 0===r||null===(M=r.fragments)||void 0===M?void 0:M[o];E=(null===e||void 0===e||null===(T=e.choices)||void 0===T?void 0:T.length)||0,0===E&&(E=0)}for(let B=0;B<E;B++){if(!d&&D&&D.choices&&D.choices[B]){const e=(D.choices[B].text||"").trim();if(/^\d+$/.test(e))continue}const e="btn_".concat(B),t=300,r=60,i=f.height/2-E*(r+10)/2;let a=s({},{x:f.width/2-t/2,y:i+B*(r+10),w:t,h:r,z:105+B,rotate:0});if(g[e]&&(a=s(s({},a),g[e])),!d){var I;const t=null===(I=n.fragments)||void 0===I?void 0:I[o];t&&t[h]&&t[h][e]&&(a=s(s({},a),t[h][e]))}_.push(s(s({},a),{},{id:e,type:"button",index:B,rotate:a.rotate||0}))}const A=[w,x,..._];if(C&&A.push(C),!d){var O;const e=(null===(O=n.fragments)||void 0===O?void 0:O[o])||{},t=e[h]||{};if(e.bg_image){var R,z,F,P;const n=t.bg_layout||e.bg_layout||{},r=u[e.bg_image]||{},o=NZ(l,e.bg_image);A.unshift({id:"bg_image",type:"bg_image",src:o||r.url||e.bg_image,local_path:r.local_path,x:null!==(R=n.x)&&void 0!==R?R:0,y:null!==(z=n.y)&&void 0!==z?z:0,w:null!==(F=n.w)&&void 0!==F?F:f.width,h:null!==(P=n.h)&&void 0!==P?P:f.height,z:0,rotate:n.rotate||0})}if(e.layers){const n={};e.layers.forEach(e=>{var r,o,i,c,d,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T;const I=t[e.id]||{},A=a[e.id]||{},O=e.file_id||e.src,R=u[O]||{},z=NZ(l,e.file_id||e.src),F=R.local_path||e.local_path,P=Number(null!==(r=null!==(o=null!==(i=A.x)&&void 0!==i?i:I.x)&&void 0!==o?o:e.x)&&void 0!==r?r:0),B=Number(null!==(c=null!==(d=null!==(p=A.y)&&void 0!==p?p:I.y)&&void 0!==d?d:e.y)&&void 0!==c?c:0),L=Number(null!==(h=null!==(f=null!==(g=A.rotate)&&void 0!==g?g:I.rotate)&&void 0!==f?f:e.rotate)&&void 0!==h?h:0),N=parseFloat(null!==(m=null!==(v=null!==(y=A.opacity)&&void 0!==y?y:I.opacity)&&void 0!==v?v:e.opacity)&&void 0!==m?m:1),U=parseFloat(null!==(x=null!==(b=null!==(w=A.scaleX)&&void 0!==w?w:I.scaleX)&&void 0!==b?b:e.scaleX)&&void 0!==x?x:1),V=parseFloat(null!==(S=null!==(k=null!==(C=A.scaleY)&&void 0!==C?C:I.scaleY)&&void 0!==k?k:e.scaleY)&&void 0!==S?S:1);let W=!0;W=void 0!==A.visible?A.visible:void 0!==I.visible?I.visible:!1!==e.visible,n[e.id]=s(s(s(s({},e),I),A),{},{src:z,local_path:F,x:P,y:B,_localX:P,_localY:B,_localRotate:L,w:Number(null!==(j=null!==(_=null!==(E=A.w)&&void 0!==E?E:I.w)&&void 0!==_?_:e.w)&&void 0!==j?j:"folder"===e.type?100:0),h:Number(null!==(D=null!==(M=null!==(T=A.h)&&void 0!==T?T:I.h)&&void 0!==M?M:e.h)&&void 0!==D?D:"folder"===e.type?100:0),rotate:L,scaleX:U,scaleY:V,opacity:N,visible:W,_baseOpacity:N})});const r=e=>{const t=n[e];if(!t)return null;if(t._computed)return t;if(t.parentId&&n[t.parentId]){const e=r(t.parentId);!1===e.visible&&(t.visible=!1),t.opacity=e.opacity*t._baseOpacity,t.rotate=(e.rotate+t.rotate)%360;const n=e.rotate*(Math.PI/180),o=Math.cos(n),i=Math.sin(n),a=(e.w||0)/2,s=(e.h||0)/2,l=void 0!==e.scaleX?e.scaleX:1,c=void 0!==e.scaleY?e.scaleY:1,d=(t.x-a)*l,u=(t.y-s)*c,p=d*o-u*i,h=d*i+u*o;t.x=e.x+a+p,t.y=e.y+s+h;let f=t.blendMode;e.blendMode&&"normal"!==e.blendMode&&"normal"===t.blendMode&&(f=e.blendMode),t.blendMode=f}return t._computed=!0,t};e.layers.forEach(e=>r(e.id)),e.layers.forEach(e=>{const t=n[e.id];A.push(s(s({},t),{},{style:s(s({},t.style||{}),{},{opacity:t.opacity,mixBlendMode:t.blendMode,backgroundColor:"folder"===t.type&&o===t.id?"rgba(0,255,255,0.1)":void 0,border:"folder"===t.type&&o===t.id?"1px dashed cyan":void 0})}))})}}return A},VZ=function(e,t,n,r,o){const i=e+n/2,a=t+r/2,s=n*(arguments.length>5&&void 0!==arguments[5]?arguments[5]:1)/2,l=r*(arguments.length>6&&void 0!==arguments[6]?arguments[6]:1)/2;return[{x:i-s,y:a-l},{x:i+s,y:a-l},{x:i+s,y:a+l},{x:i-s,y:a+l}].map(e=>((e,t,n,r,o)=>{const i=o*(Math.PI/180),a=Math.cos(i),s=Math.sin(i);return{x:a*(e-n)-s*(t-r)+n,y:s*(e-n)+a*(t-r)+r}})(e.x,e.y,i,a,o))},WZ=(e,t,n)=>{const r=t&&t[e.id]?t[e.id]:{},o=n&&n[e.id]?n[e.id]:{};return{id:e.id,x:void 0!==r.x?r.x:void 0!==o.x?o.x:e.x||0,y:void 0!==r.y?r.y:void 0!==o.y?o.y:e.y||0,w:void 0!==r.w?r.w:void 0!==o.w?o.w:e.w||0,h:void 0!==r.h?r.h:void 0!==o.h?o.h:e.h||0,scaleX:void 0!==r.scaleX?r.scaleX:void 0!==o.scaleX?o.scaleX:void 0!==e.scaleX?e.scaleX:1,scaleY:void 0!==r.scaleY?r.scaleY:void 0!==o.scaleY?o.scaleY:void 0!==e.scaleY?e.scaleY:1,rotate:void 0!==r.rotate?r.rotate:void 0!==o.rotate?o.rotate:e.rotate||0}},HZ=function(e,t){var n,r,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t||0===t.length)return{folderUpdates:{},childrenUpdates:{}};let s=1/0,l=1/0,c=-1/0,d=-1/0;if(t.forEach(e=>{const t=WZ(e,i,a);VZ(t.x,t.y,t.w,t.h,t.rotate,t.scaleX,t.scaleY).forEach(e=>{e.x<s&&(s=e.x),e.y<l&&(l=e.y),e.x>c&&(c=e.x),e.y>d&&(d=e.y)})}),s===1/0)return{folderUpdates:{},childrenUpdates:{}};const u=c-s+0,p=d-l+0,h=s-0,f=l-0,g=WZ(e,i,a),m=null!==(n=g.scaleX)&&void 0!==n?n:1,v=null!==(r=g.scaleY)&&void 0!==r?r:1,y=null!==(o=g.rotate)&&void 0!==o?o:0,x=h*m,b=f*v,w=y*Math.PI/180,S=Math.cos(w),k=Math.sin(w),C=x*S-b*k,j=x*k+b*S,_={w:u,h:p,x:g.x+C,y:g.y+j},E={};return t.forEach(e=>{const t=WZ(e,i,a);E[e.id]={x:t.x-h,y:t.y-f}}),{folderUpdates:_,childrenUpdates:E}},GZ=function(e,t){var n,r,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desktop";if(!e)return{};const a=(null===(n=e.global_settings)||void 0===n?void 0:n.styles)||{},s=t&&(null===(r=e.fragments)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.styles)||{},l="mobile"===i?"_mobile":"_desktop",c=(e,t)=>{const n=e+l;return void 0!==s[n]&&null!==s[n]&&""!==s[n]?s[n]:void 0!==a[n]&&null!==a[n]&&""!==a[n]?a[n]:void 0!==s[e]&&null!==s[e]&&""!==s[e]?s[e]:void 0!==a[e]&&null!==a[e]&&""!==a[e]?a[e]:t},d=(e,t)=>void 0!==s[e]&&null!==s[e]&&""!==s[e]?s[e]:void 0!==a[e]&&null!==a[e]&&""!==a[e]?a[e]:t;return{fontFamily:d("font_family","Arial"),textSize:c("text_size",16),textColor:d("text_color","#ffffff"),textOpacity:d("text_opacity",1),textAlign:c("text_align","left"),textOffsetX:c("text_offset_x",0),textOffsetY:c("text_offset_y",0),textLineHeight:c("text_line_height",1.5),textParagraphSpacing:c("text_paragraph_spacing",10),textEmptyLineHeight:c("text_empty_line_height",1),textBoxBgColor:d("text_box_bg_color","#000000"),textBoxOpacity:d("text_box_opacity",.7),textBoxTexture:d("text_box_texture",null),textBoxTextureOpacity:d("text_box_texture_opacity",1),textBoxTextureBlend:d("text_box_texture_blend","normal"),textBoxBorderRadius:d("text_box_border_radius",0),textBoxBorderWidth:c("text_box_border_width",0),textBoxBorderColor:d("text_box_border_color","#ffffff"),textBoxBorderOpacity:d("text_box_border_opacity",1),textBoxTextureScaleX:c("text_box_texture_scale_x",100),textBoxTextureScaleY:c("text_box_texture_scale_y",100),textBoxTextureOffsetX:c("text_box_texture_offset_x",50),textBoxTextureOffsetY:c("text_box_texture_offset_y",50),textSeparatorSide:c("text_separator_side","right"),textSeparatorPos:c("text_separator_pos",80),textSeparatorVisualEnabled:c("text_separator_visual_enabled",!1),textSeparatorLineOrient:c("text_separator_line_orient","vertical"),textSeparatorLinePos:c("text_separator_line_pos",50),textSeparatorColor:c("text_separator_color","#ffffff"),textSeparatorWidth:c("text_separator_width",1),textSeparatorOpacity:c("text_separator_opacity",1),btnTextureScaleX:c("btn_texture_scale_x",100),btnTextureScaleY:c("btn_texture_scale_y",100),btnTextureOffsetX:c("btn_texture_offset_x",50),btnTextureOffsetY:c("btn_texture_offset_y",50),btnTextSize:c("btn_text_size",14),btnTextColor:d("btn_text_color","#ffffff"),btnTextOpacity:d("btn_text_opacity",1),btnMode:d("btn_mode","box"),btnBgColor:d("btn_bg_color","#444444"),btnObjectScaleX:c("btn_object_scale_x",100),btnObjectScaleY:c("btn_object_scale_y",100),btnObjectOffsetX:c("btn_object_offset_x",50),btnObjectOffsetY:c("btn_object_offset_y",50),btnObjectBlend:d("btn_object_blend","normal"),btnBgOpacity:d("btn_bg_opacity",1),btnOpacity:d("btn_opacity",1),btnTexture:d("btn_texture",null),btnTextureOpacity:d("btn_texture_opacity",1),btnTextureBlend:d("btn_texture_blend","normal"),btnBorderColor:d("btn_border_color","#ffffff"),btnBorderWidth:c("btn_border_width",0),btnBorderOpacity:d("btn_border_opacity",1),btnBorderRadius:d("btn_border_radius",0),btnHoverEnabled:d("btn_hover_enabled",!1),btnHoverColor:d("btn_hover_color","#666666"),btnGlobalObject:d("btn_global_object",null),btnObjects:d("btn_objects",{}),btnObjectOpacity:d("btn_object_opacity",1),btnObjectHoverEnabled:d("btn_object_hover_enabled",!1),btnObjectHoverColor:d("btn_object_hover_color","#ffffff"),btnHideTextMap:d("btn_hide_text_map",{})}},XZ=t=>{let{loadingProgress:n}=t;const r=n.total>0?Math.round(n.current/n.total*100):0,o=(0,e.useRef)(null);(0,e.useEffect)(()=>{var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[n.logs]);return(0,c.jsxs)("div",{style:{width:"100vw",height:"100vh",background:"#111",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#fff",fontFamily:"monospace"},children:[(0,c.jsx)("div",{style:{marginBottom:"20px",fontSize:"24px",fontWeight:"bold"},children:n.total>0?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0430\u0441\u0441\u0435\u0442\u043e\u0432...":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445..."}),n.total>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{width:"300px",height:"10px",background:"#333",borderRadius:"5px",overflow:"hidden",marginBottom:"10px",boxShadow:"0 0 10px rgba(0,0,0,0.5)"},children:(0,c.jsx)("div",{style:{width:"".concat(r,"%"),height:"100%",background:"linear-gradient(90deg, #4caf50, #81c784)",transition:"width 0.3s ease-out"}})}),(0,c.jsxs)("div",{style:{fontSize:"14px",color:"#aaa",marginBottom:"15px"},children:["\u0424\u0430\u0439\u043b\u044b: ",n.current," \u0438\u0437 ",n.total," (",r,"%)"]}),(0,c.jsxs)("div",{style:{width:"95%",maxWidth:"600px",height:"300px",background:"#000",border:"1px solid #333",borderRadius:"4px",padding:"10px",overflowY:"auto",fontSize:"10px",textAlign:"left",display:"flex",flexDirection:"column",gap:"3px"},children:[n.logs&&n.logs.map((e,t)=>{return(0,c.jsx)("div",{style:{color:(n=e,n.includes("[ERR]")||n.includes("[TIMEOUT]")||n.includes("[HTTP 4")||n.includes("[HTTP 5")?"#ff5555":n.includes("[FALLBACK]")?"#ffff55":n.includes("[DONE]")||n.includes("[HTTP 200]")?"#55ff55":n.includes("[NET]")?"#55ffff":"#cccccc"),borderBottom:"1px solid #1a1a1a",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e},t);var n}),(0,c.jsx)("div",{ref:o})]})]}):(0,c.jsx)("div",{style:{fontSize:"14px",color:"#666"},children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435..."})]})},YZ=e=>{let{sidebarOpen:t,isMobileScreen:n,sidebarWidth:r,setSidebarOpen:o,userId:i,storyId:a,selectedId:l,setSelectedId:d,fragmentTab:u,setFragmentTab:p,groups:h,sortedKeys:f,openSpoilers:g,setOpenSpoilers:m,onExportClick:v,onEditLogic:y}=e;return(0,c.jsxs)("div",{style:s(s({},zL.sidebar(t,n)),{},{width:n?"260px":"".concat(r,"px"),zIndex:100,position:n?"fixed":"relative",transform:n&&!t?"translateX(-100%)":"none",bottom:n?0:"auto",height:n?"auto":"100%",paddingBottom:n?"calc(env(safe-area-inset-bottom) + 15px)":0,top:0,left:0,transition:"transform 0.3s ease",boxShadow:n&&t?"5px 0 15px rgba(0,0,0,0.5)":"none",display:"flex",flexDirection:"column"}),children:[n&&(0,c.jsx)("div",{onClick:()=>o(!1),style:{padding:"15px",cursor:"pointer",color:"#fff",fontSize:"24px",lineHeight:"1",borderBottom:"1px solid #333",display:"flex",alignItems:"center"},children:"\u2715"}),(0,c.jsx)("div",{style:zL.backBtn,onClick:()=>window.location.href="/".concat(i),children:"\u2b05 \u041d\u0430\u0437\u0430\u0434 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u0438\u0441\u0442\u043e\u0440\u0438\u0439"}),(0,c.jsxs)("div",{style:s(s({},zL.sidebarScroll),{},{flex:1,overflowY:"auto"}),children:[(0,c.jsx)("button",{style:s(s({},zL.spoilerBtn),{},{color:null===l?"#7568ed":"#fff"}),onClick:()=>d(null),children:"\u2699 \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,c.jsx)("button",{style:s(s({},zL.spoilerBtn),{},{color:"materials"===l?"#7568ed":"#fff"}),onClick:()=>d("materials"),children:"\ud83d\udcc1 \u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b"}),f.map(e=>(0,c.jsxs)("div",{children:[(0,c.jsxs)("button",{style:zL.spoilerBtn,onClick:()=>m(t=>s(s({},t),{},{[e]:!t[e]})),children:[g[e]?"\u25bc":"\u25b6"," ",e]}),g[e]&&h[e].map(e=>(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:zL.subItem(l===e),onClick:()=>d(e),children:e}),l===e&&(0,c.jsxs)("div",{style:zL.subActionsPanel,children:[(0,c.jsx)("button",{style:zL.subActionBtn("layers"===u),onClick:()=>p("layers"),children:"\u0421\u043b\u043e\u0438"}),(0,c.jsx)("button",{style:zL.subActionBtn("effects"===u),onClick:()=>p("effects"),children:"\u042d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,c.jsx)("button",{style:zL.subActionBtn("settings"===u),onClick:()=>p("settings"),children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]})]},e))]},e))]}),(0,c.jsxs)("div",{style:{padding:"15px",borderTop:"1px solid #333",background:"#1e1e1e",flexShrink:0},children:[(0,c.jsx)("button",{onClick:y,style:{width:"100%",padding:"10px",background:"#2196F3",color:"#fff",fontWeight:"bold",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"10px",gap:"8px"},children:"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u0433\u0438\u043a\u0443"}),(0,c.jsx)("button",{id:"export-btn-id",onClick:v,style:{width:"100%",padding:"10px",background:"#28a745",color:"#000",fontWeight:"bold",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"\ud83d\udce6 \u042d\u043a\u0441\u043f\u043e\u0440\u0442 (Offline)"}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#777",marginTop:"5px",textAlign:"center"},children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c HTML5 \u0441\u0431\u043e\u0440\u043a\u0443"})]})]})},qZ=t=>{let{title:n,children:r,initialOpen:o=!1,isOpen:i,onToggle:a}=t;const[s,l]=(0,e.useState)(o),d=void 0!==i,u=d?i:s;return(0,c.jsxs)("div",{style:{breakInside:"avoid",marginBottom:"15px",background:"#2a2a2a",borderRadius:"8px",border:"1px solid #333",overflow:"hidden",display:"block"},children:[(0,c.jsxs)("div",{onClick:()=>{d?a&&a():l(!s)},style:{padding:"12px 15px",cursor:"pointer",background:"#333",color:"#fff",fontWeight:"bold",fontSize:"14px",display:"flex",justifyContent:"space-between",alignItems:"center",userSelect:"none",borderBottom:u?"1px solid #444":"none"},children:[(0,c.jsx)("span",{children:n}),(0,c.jsx)("span",{style:{fontSize:"12px",color:"#aaa"},children:u?"\u25b2":"\u25bc"})]}),u&&(0,c.jsx)("div",{style:{padding:"5px"},children:(0,c.jsx)("div",{style:{width:"100%"},children:r})})]})},ZZ=t=>{let{interval:n,onUpdateInterval:r,onExport:o,onImport:i}=t;const a=(0,e.useRef)(null);(0,e.useEffect)(()=>{void 0!==n&&null!==n||r(15)},[n,r]);const s=void 0===n||null===n?15:n;return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"5px"},children:"\ud83d\udd52 \u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u0430\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430"}),(0,c.jsxs)("select",{value:s,onChange:e=>r(Number(e.target.value)),style:{width:"100%",padding:"8px",background:"#333",color:"#fff",border:"1px solid #444",borderRadius:"4px",cursor:"pointer"},children:[(0,c.jsx)("option",{value:0,children:"\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e"}),(0,c.jsx)("option",{value:5,children:"\u041a\u0430\u0436\u0434\u044b\u0435 5 \u043c\u0438\u043d\u0443\u0442"}),(0,c.jsx)("option",{value:10,children:"\u041a\u0430\u0436\u0434\u044b\u0435 10 \u043c\u0438\u043d\u0443\u0442"}),(0,c.jsx)("option",{value:15,children:"\u041a\u0430\u0436\u0434\u044b\u0435 15 \u043c\u0438\u043d\u0443\u0442"}),(0,c.jsx)("option",{value:30,children:"\u041a\u0430\u0436\u0434\u044b\u0435 30 \u043c\u0438\u043d\u0443\u0442"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"5px"},children:"\ud83d\udcbe \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u043c"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{onClick:o,style:{flex:1,padding:"8px",background:"#28a745",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"\u2b07 \u042d\u043a\u0441\u043f\u043e\u0440\u0442"}),(0,c.jsx)("button",{onClick:()=>a.current.click(),style:{flex:1,padding:"8px",background:"#17a2b8",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"\u2b06 \u0418\u043c\u043f\u043e\u0440\u0442"}),(0,c.jsx)("input",{type:"file",accept:".json",ref:a,style:{display:"none"},onChange:e=>{const t=e.target.files[0];t&&i(t),e.target.value=null}})]}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#888",marginTop:"5px",fontStyle:"italic"},children:"\u0418\u043c\u043f\u043e\u0440\u0442 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043c\u0435\u043d\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430."})]})]})};function $Z(){return($Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function KZ(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}function JZ(t){var n=(0,e.useRef)(t),r=(0,e.useRef)(function(e){n.current&&n.current(e)});return n.current=t,r.current}var QZ=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e<t?t:e},e$=function(e){return"touches"in e},t$=function(e){return e&&e.ownerDocument.defaultView||self},n$=function(e,t,n){var r=e.getBoundingClientRect(),o=e$(t)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]}(t.touches,n):t;return{left:QZ((o.pageX-(r.left+t$(e).pageXOffset))/r.width),top:QZ((o.pageY-(r.top+t$(e).pageYOffset))/r.height)}},r$=function(e){!e$(e)&&e.preventDefault()},o$=e.memo(function(t){var n=t.onMove,r=t.onKey,o=KZ(t,["onMove","onKey"]),i=(0,e.useRef)(null),a=JZ(n),s=JZ(r),l=(0,e.useRef)(null),c=(0,e.useRef)(!1),d=(0,e.useMemo)(function(){var e=function(e){r$(e),(e$(e)?e.touches.length>0:e.buttons>0)&&i.current?a(n$(i.current,e,l.current)):n(!1)},t=function(){return n(!1)};function n(n){var r=c.current,o=t$(i.current),a=n?o.addEventListener:o.removeEventListener;a(r?"touchmove":"mousemove",e),a(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=i.current;if(r&&(r$(t),!function(e,t){return t&&!e$(e)}(t,c.current)&&r)){if(e$(t)){c.current=!0;var o=t.changedTouches||[];o.length&&(l.current=o[0].identifier)}r.focus(),a(n$(r,t,l.current)),n(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),s({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]},[s,a]),u=d[0],p=d[1],h=d[2];return(0,e.useEffect)(function(){return h},[h]),e.createElement("div",$Z({},o,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:i,onKeyDown:p,tabIndex:0,role:"slider"}))}),i$=function(e){return e.filter(Boolean).join(" ")},a$=function(t){var n=t.color,r=t.left,o=t.top,i=void 0===o?.5:o,a=i$(["react-colorful__pointer",t.className]);return e.createElement("div",{className:a,style:{top:100*i+"%",left:100*r+"%"}},e.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:n}}))},s$=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n},l$=(Math.PI,function(e){return m$(c$(e))}),c$=function(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?s$(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?s$(parseInt(e.substring(6,8),16)/255,2):1}},d$=function(e){return g$(h$(e))},u$=function(e){var t=e.s,n=e.v,r=e.a,o=(200-t)*n/100;return{h:s$(e.h),s:s$(o>0&&o<200?t*n/100/(o<=100?o:200-o)*100:0),l:s$(o/2),a:s$(r,2)}},p$=function(e){var t=u$(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},h$=function(e){var t=e.h,n=e.s,r=e.v,o=e.a;t=t/360*6,n/=100,r/=100;var i=Math.floor(t),a=r*(1-n),s=r*(1-(t-i)*n),l=r*(1-(1-t+i)*n),c=i%6;return{r:s$(255*[r,s,a,a,l,r][c]),g:s$(255*[l,r,r,s,a,a][c]),b:s$(255*[a,a,l,r,r,s][c]),a:s$(o,2)}},f$=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},g$=function(e){var t=e.r,n=e.g,r=e.b,o=e.a,i=o<1?f$(s$(255*o)):"";return"#"+f$(t)+f$(n)+f$(r)+i},m$=function(e){var t=e.r,n=e.g,r=e.b,o=e.a,i=Math.max(t,n,r),a=i-Math.min(t,n,r),s=a?i===t?(n-r)/a:i===n?2+(r-t)/a:4+(t-n)/a:0;return{h:s$(60*(s<0?s+6:s)),s:s$(i?a/i*100:0),v:s$(i/255*100),a:o}},v$=e.memo(function(t){var n=t.hue,r=t.onChange,o=i$(["react-colorful__hue",t.className]);return e.createElement("div",{className:o},e.createElement(o$,{onMove:function(e){r({h:360*e.left})},onKey:function(e){r({h:QZ(n+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":s$(n),"aria-valuemax":"360","aria-valuemin":"0"},e.createElement(a$,{className:"react-colorful__hue-pointer",left:n/360,color:p$({h:n,s:100,v:100,a:1})})))}),y$=e.memo(function(t){var n=t.hsva,r=t.onChange,o={backgroundColor:p$({h:n.h,s:100,v:100,a:1})};return e.createElement("div",{className:"react-colorful__saturation",style:o},e.createElement(o$,{onMove:function(e){r({s:100*e.left,v:100-100*e.top})},onKey:function(e){r({s:QZ(n.s+100*e.left,0,100),v:QZ(n.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+s$(n.s)+"%, Brightness "+s$(n.v)+"%"},e.createElement(a$,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:p$(n)})))}),x$=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0},b$=function(e,t){return e.toLowerCase()===t.toLowerCase()||x$(c$(e),c$(t))};function w$(t,n,r){var o=JZ(r),i=(0,e.useState)(function(){return t.toHsva(n)}),a=i[0],s=i[1],l=(0,e.useRef)({color:n,hsva:a});(0,e.useEffect)(function(){if(!t.equal(n,l.current.color)){var e=t.toHsva(n);l.current={hsva:e,color:n},s(e)}},[n,t]),(0,e.useEffect)(function(){var e;x$(a,l.current.hsva)||t.equal(e=t.fromHsva(a),l.current.color)||(l.current={hsva:a,color:e},o(e))},[a,t,o]);var c=(0,e.useCallback)(function(e){s(function(t){return Object.assign({},t,e)})},[]);return[a,c]}var S$,k$="undefined"!=typeof window?e.useLayoutEffect:e.useEffect,C$=new Map,j$=function(e){k$(function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!C$.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',C$.set(t,r);var o=S$||n.nc;o&&r.setAttribute("nonce",o),t.head.appendChild(r)}},[])},_$=function(t){var n=t.className,r=t.colorModel,o=t.color,i=void 0===o?r.defaultColor:o,a=t.onChange,s=KZ(t,["className","colorModel","color","onChange"]),l=(0,e.useRef)(null);j$(l);var c=w$(r,i,a),d=c[0],u=c[1],p=i$(["react-colorful",n]);return e.createElement("div",$Z({},s,{ref:l,className:p}),e.createElement(y$,{hsva:d,onChange:u}),e.createElement(v$,{hue:d.h,onChange:u,className:"react-colorful__last-control"}))},E$={defaultColor:"000",toHsva:l$,fromHsva:function(e){return d$({h:e.h,s:e.s,v:e.v,a:1})},equal:b$},D$=function(t){return e.createElement(_$,$Z({},t,{colorModel:E$}))};const M$={pickerWrapper:{position:"relative",display:"inline-block",width:"100%",height:"100%",display:"flex",alignItems:"center"},swatch:{width:"32px",height:"32px",borderRadius:"4px",border:"1px solid #555",cursor:"pointer",boxSizing:"border-box",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},popoverContent:{borderRadius:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.6)",border:"1px solid #444",backgroundColor:"#1f1f1f",padding:"12px",paddingTop:"36px",width:"220px",display:"flex",flexDirection:"column",boxSizing:"border-box"},closeBtn:{position:"absolute",top:"0",right:"0",width:"44px",height:"44px",background:"transparent",border:"none",color:"#aaa",fontSize:"20px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",outline:"none",zIndex:10},slidersContainer:{marginTop:"12px",display:"flex",flexDirection:"column",gap:"8px"},sliderRow:{display:"flex",alignItems:"center",justifyContent:"space-between",color:"#ccc",fontSize:"12px",fontFamily:"monospace"},label:{width:"15px",fontWeight:"bold",color:"#888"},inputRange:{flex:1,margin:"0 8px",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valDisplay:{width:"25px",textAlign:"right",color:"#fff"},hexInput:{width:"100%",marginTop:12,background:"#111",color:"#fff",border:"1px solid #333",padding:"8px 0",borderRadius:4,textAlign:"center",fontSize:13,fontFamily:"monospace",boxSizing:"border-box",outline:"none"}},T$=t=>{let{color:n,onChange:r}=t;const[o,i]=(0,e.useState)(!1),a=(0,e.useRef)(null),l=(0,e.useRef)(null),d=n||"#000000",[u,p]=(0,e.useState)(()=>kB(d)),[h,f]=(0,e.useState)({top:0,left:0});(0,e.useEffect)(()=>{const e=CB(u);d.toLowerCase()!==e.toLowerCase()&&p(kB(d))},[d]);(0,e.useEffect)(()=>{const e=e=>{a.current&&!a.current.contains(e.target)&&l.current&&!l.current.contains(e.target)&&i(!1)};return o&&(document.addEventListener("mousedown",e),window.addEventListener("scroll",()=>i(!1),{capture:!0}),window.addEventListener("resize",()=>i(!1))),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",()=>i(!1),{capture:!0}),window.removeEventListener("resize",()=>i(!1))}},[o]);const g=(e,t)=>{const n=s(s({},u),{},{[e]:Number(t)});p(n),r(CB(n))};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:M$.pickerWrapper,children:(0,c.jsx)("div",{ref:a,style:s(s({},M$.swatch),{},{backgroundColor:d}),onClick:()=>{if(o)i(!1);else{if(a.current){const e=a.current.getBoundingClientRect(),t=360,n=220,r=window.innerHeight,o=window.innerWidth;let i=e.bottom+8,s=e.left;i+t>r&&(i=e.top-t-8),s+n>o&&(s=o-n-10),s<0&&(s=10),f({top:i,left:s})}i(!0)}},title:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0446\u0432\u0435\u0442"})}),o&&Mi.createPortal((0,c.jsxs)("div",{ref:l,style:s({position:"fixed",top:h.top,left:h.left,zIndex:99999},M$.popoverContent),children:[(0,c.jsx)("button",{style:M$.closeBtn,onClick:()=>i(!1),onMouseOver:e=>e.target.style.color="#fff",onMouseOut:e=>e.target.style.color="#aaa",children:"\u2715"}),(0,c.jsx)(D$,{color:d,onChange:e=>{r(e),p(kB(e))}}),(0,c.jsxs)("div",{style:M$.slidersContainer,children:[(0,c.jsxs)("div",{style:M$.sliderRow,children:[(0,c.jsx)("span",{style:M$.label,children:"H"}),(0,c.jsx)("input",{type:"range",min:"0",max:"360",value:u.h,onChange:e=>g("h",e.target.value),style:M$.inputRange}),(0,c.jsx)("span",{style:M$.valDisplay,children:u.h})]}),(0,c.jsxs)("div",{style:M$.sliderRow,children:[(0,c.jsx)("span",{style:M$.label,children:"S"}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",value:u.s,onChange:e=>g("s",e.target.value),style:M$.inputRange}),(0,c.jsx)("span",{style:M$.valDisplay,children:u.s})]}),(0,c.jsxs)("div",{style:M$.sliderRow,children:[(0,c.jsx)("span",{style:M$.label,children:"V"}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",value:u.v,onChange:e=>g("v",e.target.value),style:M$.inputRange}),(0,c.jsx)("span",{style:M$.valDisplay,children:u.v})]})]}),(0,c.jsx)("input",{type:"text",value:d,onChange:e=>{r(e.target.value),/^#[0-9A-F]{6}$/i.test(e.target.value)&&p(kB(e.target.value))},style:M$.hexInput})]}),document.body)]})},I$=e=>{let{globalSettings:t,onUpdate:n}=e;const r=t.resolution_desktop||{width:1280,height:720},o=t.resolution_mobile||{width:480,height:800},i=t.play_mode||"adaptive",a=t.canvas_bg_color||"#252525",l=t.game_area_bg_color||"#000000",d=(e,r)=>n(s(s({},t),{},{[e]:r})),u=(e,t,n)=>{const i=s(s({},"desktop"===e?r:o),{},{[t]:Number(n)});d("desktop"===e?"resolution_desktop":"resolution_mobile",i)},p={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",minWidth:"240px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",gap:"12px",alignItems:"flex-end"},labelContainer:{display:"flex",alignItems:"center",fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",height:"32px",boxSizing:"border-box",outline:"none"},colorContainer:{display:"flex",alignItems:"center",gap:"12px",background:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",padding:"6px 8px"},colorValue:{fontSize:"12px",fontFamily:"monospace",color:"#fff",minWidth:"55px",textAlign:"right"},divider:{border:0,borderTop:"1px solid #333",margin:"0"},select:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px",borderRadius:"4px",fontSize:"13px",width:"100%",outline:"none",cursor:"pointer"}};return(0,c.jsxs)("div",{style:p.panel,children:[(0,c.jsxs)("div",{style:p.row,children:[(0,c.jsxs)("div",{style:p.labelContainer,children:[(0,c.jsx)("span",{children:"\u0420\u0435\u0436\u0438\u043c\u044b \u0432\u0451\u0440\u0441\u0442\u043a\u0438"}),(0,c.jsx)(PE,{text:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0449\u0438\u0439 \u0432 \u043a\u0430\u043a\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c\u0441\u044f \u0432\u0430\u0448\u0430 \u0438\u0433\u0440\u0430, \u0430\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u043e, \u0438\u043b\u0438 \u0432 \u043e\u0434\u043d\u043e\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u043c. \u0412\u0451\u0440\u0441\u0442\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u043e \u043a\u043d\u043e\u043f\u043a\u0435 \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0443\u0433\u043b\u0443."})]}),(0,c.jsxs)("select",{style:p.select,value:i,onChange:e=>d("play_mode",e.target.value),children:[(0,c.jsx)("option",{value:"adaptive",children:"\ud83d\udcf1/\ud83d\udcbb \u0410\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u043e (Auto)"}),(0,c.jsx)("option",{value:"desktop_only",children:"\ud83d\udcbb \u0422\u043e\u043b\u044c\u043a\u043e Desktop"}),(0,c.jsx)("option",{value:"mobile_only",children:"\ud83d\udcf1 \u0422\u043e\u043b\u044c\u043a\u043e Mobile"})]})]}),(0,c.jsx)("hr",{style:p.divider}),(0,c.jsxs)("div",{style:p.row,children:[(0,c.jsxs)("div",{style:p.labelContainer,children:[(0,c.jsx)("span",{children:"Desktop \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435"}),(0,c.jsx)(PE,{text:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0432\u044b\u0441\u043e\u043a\u0438\u0445 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f, \u043f\u043e\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0431\u0435\u0442\u0430-\u0432\u0435\u0440\u0441\u0438\u0438. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043d\u0430 \u0432\u0430\u0448 \u0441\u0442\u0440\u0430\u0445 \u0438 \u0440\u0438\u0441\u043a."})]}),(0,c.jsxs)("div",{style:p.rowHorizontal,children:[(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("input",{type:"number",style:p.input,placeholder:"W",value:r.width,onChange:e=>u("desktop","width",e.target.value)})}),(0,c.jsx)("span",{style:{color:"#555",paddingBottom:"6px"},children:"x"}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("input",{type:"number",style:p.input,placeholder:"H",value:r.height,onChange:e=>u("desktop","height",e.target.value)})})]})]}),(0,c.jsxs)("div",{style:p.row,children:[(0,c.jsx)("div",{style:p.labelContainer,children:"Mobile \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435"}),(0,c.jsxs)("div",{style:p.rowHorizontal,children:[(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("input",{type:"number",style:p.input,placeholder:"W",value:o.width,onChange:e=>u("mobile","width",e.target.value)})}),(0,c.jsx)("span",{style:{color:"#555",paddingBottom:"6px"},children:"x"}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("input",{type:"number",style:p.input,placeholder:"H",value:o.height,onChange:e=>u("mobile","height",e.target.value)})})]})]}),(0,c.jsx)("hr",{style:p.divider}),(0,c.jsxs)("div",{style:p.row,children:[(0,c.jsx)("div",{style:p.labelContainer,children:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u0446\u0432\u0435\u0442\u0430"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"4px"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",color:"#ccc"},children:"\u041f\u043e\u0434\u043b\u043e\u0436\u043a\u0430 (Workspace)"}),(0,c.jsxs)("div",{style:p.colorContainer,children:[(0,c.jsx)(T$,{color:a,onChange:e=>d("canvas_bg_color",e)}),(0,c.jsx)("span",{style:p.colorValue,children:a})]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",color:"#ccc"},children:"\u0424\u043e\u043d \u0438\u0433\u0440\u044b (Game Area)"}),(0,c.jsxs)("div",{style:p.colorContainer,children:[(0,c.jsx)(T$,{color:l,onChange:e=>d("game_area_bg_color",e)}),(0,c.jsx)("span",{style:p.colorValue,children:l})]})]})]})]})},A$=t=>{let{data:n,onUpdate:r}=t;const o=n||{},i=s(s({},{enabled:!1,snap:!1,step:50,color:"#4caf504d",lineWidth:1,snapThreshold:10,customLines:[],customColor:"#ffeb3b",customWidth:2,customLinesVisible:!0}),o),[a,l]=(0,e.useState)(null),[d,u]=(0,e.useState)(!1),p=(e,t)=>r(s(s({},i),{},{[e]:t})),h=e=>!e||e.length<9?1:parseInt(e.slice(7,9),16)/255,f=(e,t)=>(e?e.slice(0,7):"#4caf50")+Math.round(255*t).toString(16).padStart(2,"0"),g=e=>{const t=i.customLines||[];if(t.length>=10)return;const n={id:Date.now()+Math.random(),axis:e,pos:100};r(s(s({},i),{},{customLines:[...t,n]})),l(n.id),u(!0),i.customLinesVisible||p("customLinesVisible",!0)},m=(e,t)=>{const n=(i.customLines||[]).map(n=>n.id===e?s(s({},n),{},{pos:Number(t)}):n);r(s(s({},i),{},{customLines:n}))},v=i.customLines.find(e=>e.id===a),y={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",minWidth:"240px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",gap:"12px",alignItems:"flex-end"},label:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",display:"flex",alignItems:"center"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",height:"32px",boxSizing:"border-box",outline:"none"},colorInput:{background:"transparent",border:"none",width:"100%",height:"32px",cursor:"pointer",padding:0},toggleBtn:e=>({flex:1,cursor:"pointer",padding:"8px",textAlign:"center",borderRadius:"4px",background:e?"#7568ed":"#333",color:e?"#fff":"#ccc",border:"1px solid",borderColor:e?"#7568ed":"#444",fontSize:"13px",fontWeight:e?"600":"400",transition:"all 0.2s"}),divider:{border:0,borderTop:"1px solid #333",margin:"0"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"11px",textAlign:"right",minWidth:"25px",color:"#fff"},spoilerHeader:{background:"#333",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",fontWeight:"bold"},lineItem:e=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 10px",borderRadius:"4px",marginBottom:"4px",background:e?"#7568ed44":"#222",border:e?"1px solid #7568ed":"1px solid #333",cursor:"pointer"}),addBtn:{background:"#444",border:"none",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"11px",cursor:"pointer",flex:1},delBtn:{background:"transparent",border:"none",color:"#ff5252",fontWeight:"bold",cursor:"pointer",fontSize:"14px"}};return(0,c.jsxs)("div",{style:y.panel,children:[(0,c.jsxs)("div",{style:y.header,children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:"\ud83d\udcd0"}),(0,c.jsx)("span",{children:"\u0421\u0435\u0442\u043a\u0430 \u0438 \u041d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0435"})]}),(0,c.jsxs)("div",{style:y.row,children:[(0,c.jsx)("label",{style:y.label,children:"\u0420\u0435\u0436\u0438\u043c \u0440\u0430\u0431\u043e\u0442\u044b"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{style:y.toggleBtn(i.enabled),onClick:()=>p("enabled",!i.enabled),children:i.enabled?"\u0421\u0435\u0442\u043a\u0430 \u0412\u041a\u041b":"\u0421\u0435\u0442\u043a\u0430 \u0412\u042b\u041a\u041b"}),(0,c.jsx)("button",{style:y.toggleBtn(i.snap),onClick:()=>p("snap",!i.snap),children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[i.snap?"\u041c\u0430\u0433\u043d\u0438\u0442 \u0412\u041a\u041b":"\u041c\u0430\u0433\u043d\u0438\u0442 \u0412\u042b\u041a\u041b",(0,c.jsx)(PE,{text:"\u0420\u0435\u0436\u0438\u043c '\u043f\u0440\u0438\u043b\u0438\u043f\u0430\u043d\u0438\u044f'. \u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0431\u0443\u0434\u0443\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u043e \u043b\u0438\u043d\u0438\u044f\u043c \u0441\u0435\u0442\u043a\u0438 \u0438\u043b\u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u043c \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u043c."})]})})]})]}),(0,c.jsx)("hr",{style:y.divider}),(0,c.jsxs)("div",{style:y.rowHorizontal,children:[(0,c.jsxs)("div",{style:s({flex:1},y.row),children:[(0,c.jsx)("label",{style:y.label,children:"\u0428\u0430\u0433 (px)"}),(0,c.jsx)("input",{type:"number",min:"10",max:"500",step:"10",style:y.input,value:i.step,onChange:e=>p("step",Number(e.target.value))})]}),(0,c.jsxs)("div",{style:s({flex:1},y.row),children:[(0,c.jsxs)("label",{style:y.label,children:["\u0421\u0438\u043b\u0430 (px)",(0,c.jsx)(PE,{text:"\u0420\u0430\u0434\u0438\u0443\u0441 \u0437\u0430\u0445\u0432\u0430\u0442\u0430 \u043c\u0430\u0433\u043d\u0438\u0442\u0430 \u0432 \u043f\u0438\u043a\u0441\u0435\u043b\u044f\u0445. \u0415\u0441\u043b\u0438 \u043e\u0431\u044a\u0435\u043a\u0442 \u043f\u043e\u0434\u043d\u0435\u0441\u0442\u0438 \u043a \u043b\u0438\u043d\u0438\u0438 \u0431\u043b\u0438\u0436\u0435 \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u044f, \u043e\u043d '\u043f\u0440\u0438\u043b\u0438\u043f\u043d\u0435\u0442' \u043a \u043d\u0435\u0439."})]}),(0,c.jsx)("input",{type:"number",min:"1",max:"50",step:"1",style:y.input,value:i.snapThreshold,onChange:e=>p("snapThreshold",Number(e.target.value))})]})]}),(0,c.jsx)("hr",{style:y.divider}),(0,c.jsxs)("div",{style:y.row,children:[(0,c.jsx)("label",{style:y.label,children:"\u0421\u0442\u0438\u043b\u044c \u0441\u0435\u0442\u043a\u0438"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 40px",gap:"10px",alignItems:"center"},children:[(0,c.jsx)("input",{type:"range",min:"1",max:"5",step:"1",title:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0439",style:y.rangeInput,value:i.lineWidth,onChange:e=>p("lineWidth",Number(e.target.value))}),(0,c.jsx)("input",{type:"color",style:y.colorInput,title:"\u0426\u0432\u0435\u0442 \u0441\u0435\u0442\u043a\u0438",value:(e=>e?e.slice(0,7):"#4caf50")(i.color),onChange:e=>p("color",f(e.target.value,h(i.color)))})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:y.rangeInput,value:h(i.color),onChange:e=>p("color",f(i.color,parseFloat(e.target.value)))}),(0,c.jsxs)("span",{style:y.valueLabel,children:[Math.round(100*h(i.color)),"%"]})]})]}),(0,c.jsx)("hr",{style:y.divider}),(0,c.jsxs)("div",{style:y.row,children:[(0,c.jsxs)("div",{style:y.spoilerHeader,onClick:()=>u(!d),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("span",{children:["\ud83d\udee0 \u041a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 \u043b\u0438\u043d\u0438\u0438 (",i.customLines.length,"/10)"]}),(0,c.jsx)(PE,{text:"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0435. \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0438 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043b\u0438\u043d\u0438\u0438 \u0432 \u043b\u044e\u0431\u043e\u043c \u043c\u0435\u0441\u0442\u0435 \u043f\u043e\u043b\u044f \u0434\u043b\u044f \u0442\u043e\u0447\u043d\u043e\u0433\u043e \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u0435\u0442\u043a\u0438."})]}),(0,c.jsx)("span",{children:d?"\u25b2":"\u25bc"})]}),d&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",padding:"5px"},children:[(0,c.jsx)("button",{style:s(s({},y.toggleBtn(i.customLinesVisible)),{},{padding:"6px",fontSize:"12px"}),onClick:()=>p("customLinesVisible",!i.customLinesVisible),children:i.customLinesVisible?"\ud83d\udc41 \u041b\u0438\u043d\u0438\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f":"\ud83d\ude48 \u041b\u0438\u043d\u0438\u0438 \u0441\u043a\u0440\u044b\u0442\u044b"}),(0,c.jsxs)("div",{style:y.rowHorizontal,children:[(0,c.jsxs)("div",{style:s({flex:1},y.row),children:[(0,c.jsx)("label",{style:y.label,children:"\u0426\u0432\u0435\u0442 \u043b\u0438\u043d\u0438\u0439"}),(0,c.jsx)("input",{type:"color",style:s(s({},y.colorInput),{},{height:"28px",border:"1px solid #444",borderRadius:"4px"}),value:i.customColor||"#ffeb3b",onChange:e=>p("customColor",e.target.value)})]}),(0,c.jsxs)("div",{style:s({flex:1},y.row),children:[(0,c.jsx)("label",{style:y.label,children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430"}),(0,c.jsx)("input",{type:"number",min:"1",max:"10",style:s(s({},y.input),{},{height:"28px"}),value:i.customWidth||2,onChange:e=>p("customWidth",Number(e.target.value))})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsx)("button",{style:s(s({},y.addBtn),{},{opacity:i.customLines.length>=10?.5:1}),onClick:()=>g("x"),disabled:i.customLines.length>=10,children:"+ \u0412\u0435\u0440\u0442. (X)"}),(0,c.jsx)("button",{style:s(s({},y.addBtn),{},{opacity:i.customLines.length>=10?.5:1}),onClick:()=>g("y"),disabled:i.customLines.length>=10,children:"+ \u0413\u043e\u0440\u0438\u0437. (Y)"})]}),(0,c.jsxs)("div",{style:{maxHeight:"150px",overflowY:"auto",display:"flex",flexDirection:"column"},children:[0===i.customLines.length&&(0,c.jsx)("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",padding:"10px"},children:"\u041d\u0435\u0442 \u043b\u0438\u043d\u0438\u0439"}),i.customLines.map((e,t)=>(0,c.jsxs)("div",{style:y.lineItem(a===e.id),onClick:()=>l(e.id),children:[(0,c.jsxs)("span",{style:{fontSize:"11px",color:"#ddd"},children:["#",t+1," ",(0,c.jsx)("b",{children:e.axis.toUpperCase()}),": ",Math.round(e.pos),"px"]}),(0,c.jsx)("button",{style:y.delBtn,onClick:t=>{t.stopPropagation(),(e=>{const t=(i.customLines||[]).filter(t=>t.id!==e);r(s(s({},i),{},{customLines:t})),a===e&&l(null)})(e.id)},title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:"\xd7"})]},e.id))]}),v&&(0,c.jsxs)("div",{style:{background:"#222",padding:"8px",borderRadius:"4px",border:"1px solid #444"},children:[(0,c.jsxs)("label",{style:s(s({},y.label),{},{display:"block",marginBottom:"5px"}),children:["\u041f\u043e\u0437\u0438\u0446\u0438\u044f (",v.axis.toUpperCase(),")"]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"2000",step:"1",style:y.rangeInput,value:v.pos,onChange:e=>m(v.id,e.target.value)}),(0,c.jsx)("input",{type:"number",style:s(s({},y.input),{},{width:"60px",height:"24px",padding:"2px 5px"}),value:v.pos,onChange:e=>m(v.id,e.target.value)})]})]})]})]})]})},O$={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",minWidth:"240px"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",justifyContent:"space-between"},sectionLabel:{fontSize:"12px",color:"#fff",fontWeight:"600",marginTop:"4px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",gap:"10px",alignItems:"flex-end"},label:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",boxSizing:"border-box",outline:"none"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},divider:{border:0,borderTop:"1px solid #333",margin:"0"},valueText:{fontSize:"11px",color:"#7568ed",fontWeight:"bold",marginLeft:"auto"},checkbox:{transform:"scale(1.2)",accentColor:"#7568ed",cursor:"pointer"}},R$=e=>{let{label:t,value:n,min:r,max:o,step:i=1,onChange:a,unit:s=""}=e;return(0,c.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("span",{style:O$.label,children:t}),(0,c.jsxs)("span",{style:O$.valueText,children:[n,s]})]}),(0,c.jsx)("input",{type:"range",min:r,max:o,step:i,value:n,onChange:e=>a(Number(e.target.value)),style:O$.rangeInput})]})},z$=e=>{var t,n,r,o,i,a,l,d;let{data:u,onUpdate:p,resolution:h}=e;const f=(e,t)=>p(s(s({},u),{},{[e]:t})),g=(null===h||void 0===h?void 0:h.width)||window.innerWidth,m=(null===h||void 0===h?void 0:h.height)||window.innerHeight;return(0,c.jsxs)("div",{style:O$.panel,children:[(0,c.jsxs)("div",{style:O$.header,children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:"\ud83d\udcf1"}),(0,c.jsx)("span",{children:"\u0412\u043a\u043b \u043a\u043d\u043e\u043f\u043a\u0443 \u043c\u0435\u043d\u044e"})]}),(0,c.jsx)("input",{type:"checkbox",checked:!1!==u.menu_enabled,onChange:e=>f("menu_enabled",e.target.checked),style:O$.checkbox,title:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u0435\u043d\u044e"})]}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("label",{style:O$.label,children:"\u041d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f"}),(0,c.jsxs)("select",{value:u.menu_open_dir||"left",onChange:e=>f("menu_open_dir",e.target.value),style:O$.input,children:[(0,c.jsx)("option",{value:"left",children:"\u2b05 \u0412\u043b\u0435\u0432\u043e"}),(0,c.jsx)("option",{value:"right",children:"\u27a1 \u0412\u043f\u0440\u0430\u0432\u043e"}),(0,c.jsx)("option",{value:"down",children:"\u2b07 \u0412\u043d\u0438\u0437"}),(0,c.jsx)("option",{value:"up",children:"\u2b06 \u0412\u0432\u0435\u0440\u0445"})]})]}),(0,c.jsx)("hr",{style:O$.divider}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("span",{style:O$.sectionLabel,children:"\ud83d\udccd \u041f\u043e\u0437\u0438\u0446\u0438\u044f"}),(0,c.jsx)(R$,{label:"\u041f\u043e\u0437\u0438\u0446\u0438\u044f X",value:null!==(t=u.menu_x)&&void 0!==t?t:20,min:0,max:g-50,onChange:e=>f("menu_x",e)}),(0,c.jsx)(R$,{label:"\u041f\u043e\u0437\u0438\u0446\u0438\u044f Y",value:null!==(n=u.menu_y)&&void 0!==n?n:20,min:0,max:m-50,onChange:e=>f("menu_y",e)})]}),(0,c.jsx)("hr",{style:O$.divider}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("span",{style:O$.sectionLabel,children:"\ud83d\udcd0 \u0420\u0430\u0437\u043c\u0435\u0440\u044b (\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043a\u043d\u043e\u043f\u043a\u0430)"}),(0,c.jsx)(R$,{label:"\u0428\u0438\u0440\u0438\u043d\u0430",value:u.menu_btn_w||u.menu_btn_size||50,min:20,max:200,onChange:e=>f("menu_btn_w",e)}),(0,c.jsx)(R$,{label:"\u0412\u044b\u0441\u043e\u0442\u0430",value:u.menu_btn_h||u.menu_btn_size||50,min:20,max:200,onChange:e=>f("menu_btn_h",e)})]}),(0,c.jsxs)("div",{style:s(s({},O$.row),{},{padding:"8px",background:"rgba(255,255,255,0.03)",borderRadius:"4px"}),children:[(0,c.jsx)("span",{style:s(s({},O$.label),{},{color:"#888"}),children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u0445 (+px)"}),(0,c.jsxs)("div",{style:O$.rowHorizontal,children:[(0,c.jsx)(R$,{label:"\u0428\u0438\u0440-\u0430",value:u.menu_extra_w||0,min:-100,max:150,onChange:e=>f("menu_extra_w",e)}),(0,c.jsx)(R$,{label:"\u0412-\u0442\u0430",value:u.menu_extra_h||0,min:-100,max:100,onChange:e=>f("menu_extra_h",e)})]})]}),(0,c.jsx)("hr",{style:O$.divider}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("span",{style:O$.sectionLabel,children:"\ud83c\udfa8 \u0421\u0442\u0438\u043b\u044c \u043a\u043d\u043e\u043f\u043e\u043a"}),(0,c.jsx)(R$,{label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0448\u0440\u0438\u0444\u0442\u0430",value:u.menu_font_size||14,min:8,max:32,onChange:e=>f("menu_font_size",e),unit:"px"}),(0,c.jsxs)("div",{style:s(s({},O$.rowHorizontal),{},{marginTop:5}),children:[(0,c.jsx)(R$,{label:"\u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 (M)",value:null!==(r=u.menu_radius_main)&&void 0!==r?r:0,min:0,max:50,onChange:e=>f("menu_radius_main",e)}),(0,c.jsx)(R$,{label:"\u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 (S)",value:null!==(o=u.menu_radius_sub)&&void 0!==o?o:0,min:0,max:50,onChange:e=>f("menu_radius_sub",e)})]}),(0,c.jsxs)("div",{style:s(s({},O$.rowHorizontal),{},{marginTop:5}),children:[(0,c.jsx)(R$,{label:"\u041e\u0442\u0441\u0442\u0443\u043f \u041c\u0435\u043d\u044e",value:null!==(i=u.menu_gap)&&void 0!==i?i:5,min:0,max:50,onChange:e=>f("menu_gap",e)}),(0,c.jsx)(R$,{label:"\u041c\u0435\u0436\u0434\u0443 \u043a\u043d.",value:null!==(a=u.menu_internal_gap)&&void 0!==a?a:5,min:0,max:30,onChange:e=>f("menu_internal_gap",e)})]})]}),(0,c.jsx)("hr",{style:O$.divider}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("span",{style:O$.sectionLabel,children:"\ud83d\udd8c \u0426\u0432\u0435\u0442\u0430"}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:5},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,c.jsx)("span",{style:O$.label,children:"\u0424\u043e\u043d"}),(0,c.jsx)(T$,{color:u.menu_main_color||"#333333",onChange:e=>f("menu_main_color",e)})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,c.jsx)("span",{style:O$.label,children:"\u0422\u0435\u043a\u0441\u0442/\u0418\u043a\u043e\u043d\u043a\u0438"}),(0,c.jsx)(T$,{color:u.menu_arrow_color||"#ffffff",onChange:e=>{f("menu_arrow_color",e),f("menu_item_color",e)}})]})]})]}),(0,c.jsx)("hr",{style:O$.divider}),(0,c.jsxs)("div",{style:O$.row,children:[(0,c.jsx)("span",{style:O$.label,children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("div",{style:O$.rowHorizontal,children:[(0,c.jsx)(R$,{label:"Main",value:null!==(l=u.menu_opacity_main)&&void 0!==l?l:1,min:0,max:1,step:.05,onChange:e=>f("menu_opacity_main",e)}),(0,c.jsx)(R$,{label:"Sub",value:null!==(d=u.menu_opacity_sub)&&void 0!==d?d:1,min:0,max:1,step:.05,onChange:e=>f("menu_opacity_sub",e)})]})]}),(0,c.jsxs)("div",{style:{marginTop:8,padding:"10px",background:"#222",borderRadius:"4px",border:"1px dashed #444"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,c.jsx)("span",{style:O$.label,children:"\u041e\u0431\u0432\u043e\u0434\u043a\u0430 (Border)"}),(0,c.jsx)(T$,{color:u.menu_border_color||"#ffffff",onChange:e=>f("menu_border_color",e)})]}),(0,c.jsx)(R$,{label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430",value:u.menu_border_width||0,min:0,max:10,onChange:e=>f("menu_border_width",e),unit:"px"})]})]})},F$=["Arial","Roboto","Times New Roman","Courier New","Georgia","Verdana","Impact","Comic Sans MS"],P$=e=>{var t,n;let{scope:r,data:o,onUpdate:i,customFonts:a=[],layoutMode:l="desktop"}=e;const d=o||{},u="mobile"===l?"_mobile":"_desktop",p=(e,t)=>{const n=e+u;return void 0!==d[n]&&null!==d[n]?d[n]:void 0!==d[e]?d[e]:t},h=(e,t)=>{i(s(s({},d),{},{[e+u]:t}))},f=(e,t)=>i(s(s({},d),{},{[e]:t})),g="global"===r,m={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",minWidth:"240px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",gap:"12px",alignItems:"flex-end"},label:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",display:"flex",alignItems:"center"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",height:"32px",boxSizing:"border-box",outline:"none"},alignBtn:e=>({flex:1,cursor:"pointer",padding:"6px",textAlign:"center",borderRadius:"4px",background:e?"#7568ed":"#333",color:e?"#fff":"#ccc",border:"1px solid",borderColor:e?"#7568ed":"#444",fontSize:"14px"}),divider:{border:0,borderTop:"1px solid #333",margin:"0"},sliderContainer:{display:"flex",alignItems:"center",gap:"10px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"}};return(0,c.jsxs)("div",{style:m.panel,children:[(0,c.jsxs)("div",{style:m.header,children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:"\ud83c\udd70"}),(0,c.jsx)("span",{children:"\u0428\u0440\u0438\u0444\u0442\u044b \u0438 \u0422\u0435\u043a\u0441\u0442"}),(0,c.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:"5px"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#aaa",border:"1px solid #444",padding:"2px 4px",borderRadius:"4px"},children:"mobile"===l?"\ud83d\udcf1 Mobile":"\ud83d\udda5 Desktop"}),(0,c.jsx)("span",{style:{fontSize:"11px",color:g?"#4caf50":"#7568ed",background:"rgba(255,255,255,0.05)",padding:"2px 6px",borderRadius:"4px"},children:g?"Global":"Local"})]})]}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsxs)("label",{style:m.label,children:["\u0421\u0435\u043c\u0435\u0439\u0441\u0442\u0432\u043e \u0448\u0440\u0438\u0444\u0442\u043e\u0432",(0,c.jsx)(PE,{text:"\u0427\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0438 \u0448\u0440\u0438\u0444\u0442\u044b, \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u0444\u0430\u0439\u043b \u0448\u0440\u0438\u0444\u0442\u043e\u0432 \u0432 \u043f\u0430\u043f\u043a\u0443 'Fonts' \u0432\u0430\u0448\u0435\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430. \u041e\u043d\u0438 \u043f\u043e\u044f\u0432\u044f\u0442\u0441\u044f \u0432 \u044d\u0442\u043e\u043c \u0441\u043f\u0438\u0441\u043a\u0435 \u0432\u0432\u0435\u0440\u0445\u0443. \u041f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0448\u0440\u0438\u0444\u0442\u044b \u0443\u043f\u0430\u043a\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043e\u0434\u043d\u0438\u043c \u0444\u0430\u0439\u043b\u043e\u043c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ttf"})]}),(0,c.jsxs)("select",{style:m.input,value:d.font_family||"",onChange:e=>f("font_family",e.target.value),children:[(0,c.jsx)("option",{value:"",children:g?"Arial (Default)":"\u041d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c (Auto)"}),a.length>0&&(0,c.jsx)("optgroup",{label:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435",children:a.map(e=>(0,c.jsx)("option",{value:e,children:e},e))}),(0,c.jsx)("optgroup",{label:"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435",children:F$.map(e=>(0,c.jsx)("option",{value:e,children:e},e))})]})]}),(0,c.jsxs)("div",{style:m.rowHorizontal,children:[(0,c.jsxs)("div",{style:s({flex:1},m.row),children:[(0,c.jsx)("label",{style:m.label,children:"\u0420\u0430\u0437\u043c\u0435\u0440 (Text)"}),(0,c.jsx)("input",{type:"number",style:m.input,value:p("text_size",16),onChange:e=>h("text_size",Number(e.target.value))})]}),(0,c.jsxs)("div",{style:s({flex:1},m.row),children:[(0,c.jsx)("label",{style:m.label,children:"\u0420\u0430\u0437\u043c\u0435\u0440 (Btn)"}),(0,c.jsx)("input",{type:"number",style:m.input,value:p("btn_text_size",14),onChange:e=>h("btn_text_size",Number(e.target.value))})]})]}),(0,c.jsx)("hr",{style:m.divider}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsx)("label",{style:m.label,children:"\u041e\u0442\u0441\u0442\u0443\u043f\u044b (\u041e\u0431\u0449\u0438\u0435 / \u0410\u0431\u0437\u0430\u0446 / \u041f\u0443\u0441\u0442\u044b\u0435)"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",marginTop:"4px"},children:[(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 32px",alignItems:"center",columnGap:"6px"},children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px"},children:"Line"}),(0,c.jsx)("input",{type:"range",min:"0.5",max:"3.0",step:"0.1",style:m.rangeInput,value:p("text_line_height",1.5),onChange:e=>h("text_line_height",parseFloat(e.target.value))}),(0,c.jsx)("span",{style:{color:"#fff",fontSize:"10px",textAlign:"right"},children:p("text_line_height",1.5)})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 32px",alignItems:"center",columnGap:"6px"},children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px"},children:"Para"}),(0,c.jsx)("input",{type:"range",min:"-20",max:"50",step:"1",style:m.rangeInput,value:p("text_paragraph_spacing",10),onChange:e=>h("text_paragraph_spacing",parseInt(e.target.value))}),(0,c.jsx)("span",{style:{color:"#fff",fontSize:"10px",textAlign:"right"},children:p("text_paragraph_spacing",10)})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 32px",alignItems:"center",columnGap:"6px"},children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px"},children:"Empty"}),(0,c.jsx)("input",{type:"range",min:"0",max:"3.0",step:"0.1",style:m.rangeInput,value:p("text_empty_line_height",1),onChange:e=>h("text_empty_line_height",parseFloat(e.target.value))}),(0,c.jsx)("span",{style:{color:"#fff",fontSize:"10px",textAlign:"right"},children:p("text_empty_line_height",1)})]})]})]}),(0,c.jsx)("hr",{style:m.divider}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsx)("label",{style:m.label,children:"\u0422\u0435\u043a\u0441\u0442: \u0426\u0432\u0435\u0442 \u0438 \u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 40px",gap:"10px",alignItems:"center"},children:[(0,c.jsx)(T$,{color:d.text_color||"#ffffff",onChange:e=>f("text_color",e)}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:m.rangeInput,value:void 0!==d.text_opacity?d.text_opacity:1,onChange:e=>f("text_opacity",parseFloat(e.target.value))}),(0,c.jsxs)("span",{style:{fontSize:"11px",textAlign:"right"},children:[Math.round(100*(null!==(t=d.text_opacity)&&void 0!==t?t:1)),"%"]})]})]}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsx)("label",{style:m.label,children:"\u041a\u043d\u043e\u043f\u043a\u0438: \u0426\u0432\u0435\u0442 \u0438 \u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 40px",gap:"10px",alignItems:"center"},children:[(0,c.jsx)(T$,{color:d.btn_text_color||"#ffffff",onChange:e=>f("btn_text_color",e)}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:m.rangeInput,value:void 0!==d.btn_text_opacity?d.btn_text_opacity:1,onChange:e=>f("btn_text_opacity",parseFloat(e.target.value))}),(0,c.jsxs)("span",{style:{fontSize:"11px",textAlign:"right"},children:[Math.round(100*(null!==(n=d.btn_text_opacity)&&void 0!==n?n:1)),"%"]})]})]}),(0,c.jsx)("hr",{style:m.divider}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsxs)("label",{style:m.label,children:["\u0412\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435",(0,c.jsx)(PE,{text:"\u0417\u0434\u0435\u0441\u044c \u0437\u0430\u0434\u0430\u0435\u0442\u0441\u044f \u0432\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u0431\u043b\u043e\u043a\u0430. \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u043b\u0435\u0439 (Padding) \u0438 \u043e\u0431\u0440\u0435\u0437\u043a\u0438 \u0442\u0435\u043a\u0441\u0442\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0422\u0435\u043a\u0441\u0442-\u0431\u043e\u043a\u0441\u0430."})]}),(0,c.jsx)("div",{style:{display:"flex",gap:"5px"},children:["left","center","right","justify"].map(e=>{const t=p("text_align",g?"left":"");return(0,c.jsx)("button",{style:m.alignBtn(t===e),onClick:()=>h("text_align",e),title:e,children:{left:"\u2b05",center:"\u2b07",right:"\u27a1",justify:"\u2194"}[e]},e)})})]}),(0,c.jsxs)("div",{style:m.row,children:[(0,c.jsx)("label",{style:m.label,children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 (Offset X/Y)"}),(0,c.jsxs)("div",{style:m.sliderContainer,children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px"},children:"X"}),(0,c.jsx)("input",{type:"range",min:"-100",max:"100",step:"1",style:s(s({},m.rangeInput),{},{flex:1}),value:p("text_offset_x",0),onChange:e=>h("text_offset_x",parseInt(e.target.value))}),(0,c.jsx)("span",{style:{color:"#fff",fontSize:"10px",width:"25px",textAlign:"right"},children:p("text_offset_x",0)})]}),(0,c.jsxs)("div",{style:m.sliderContainer,children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px"},children:"Y"}),(0,c.jsx)("input",{type:"range",min:"-100",max:"100",step:"1",style:s(s({},m.rangeInput),{},{flex:1}),value:p("text_offset_y",0),onChange:e=>h("text_offset_y",parseInt(e.target.value))}),(0,c.jsx)("span",{style:{color:"#fff",fontSize:"10px",width:"25px",textAlign:"right"},children:p("text_offset_y",0)})]})]})]})},B$=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"],L$="#7568ed",N$="#333333",U$="#3e3e42",V$="#e0e0e0",W$="#9e9e9e",H$="#4caf50",G$={panel:{background:"#252526",padding:"12px",borderRadius:"8px",minWidth:"260px",border:"1px solid ".concat(U$),display:"flex",flexDirection:"column",gap:"16px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',fontSize:"12px",color:V$,boxSizing:"border-box",boxShadow:"0 4px 12px rgba(0,0,0,0.2)"},section:{display:"flex",flexDirection:"column",gap:"10px",background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.05)"},header:{fontWeight:"700",fontSize:"13px",color:"#fff",display:"flex",alignItems:"center",gap:"8px",paddingBottom:"8px",borderBottom:"1px solid ".concat(U$),marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.5px"},subHeader:{fontSize:"11px",fontWeight:"600",color:W$,textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"6px"},row:{display:"flex",flexDirection:"column",gap:"6px"},grid2:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},grid2Auto:{display:"grid",gridTemplateColumns:"1fr auto",gap:"8px",alignItems:"center"},label:{fontSize:"11px",color:W$,marginBottom:"2px"},subLabelRow:{display:"flex",justifyContent:"space-between",alignItems:"baseline",fontSize:"11px",color:W$,marginBottom:"4px"},input:{background:N$,border:"1px solid ".concat(U$),color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",width:"100%",height:"28px",boxSizing:"border-box",outline:"none",transition:"border-color 0.2s"},select:{background:N$,border:"1px solid ".concat(U$),color:"#fff",padding:"0 6px",borderRadius:"4px",fontSize:"11px",width:"100%",height:"28px",outline:"none",cursor:"pointer",appearance:"none",backgroundImage:"linear-gradient(45deg, transparent 50%, #aaa 50%), linear-gradient(135deg, #aaa 50%, transparent 50%)",backgroundPosition:"calc(100% - 12px) calc(50%), calc(100% - 7px) calc(50%)",backgroundSize:"5px 5px, 5px 5px",backgroundRepeat:"no-repeat"},rangeInput:{width:"100%",cursor:"pointer",accentColor:L$,height:"4px",background:"#444",borderRadius:"2px",appearance:"auto"},divider:{border:0,borderTop:"1px solid ".concat(U$),margin:"8px 0",opacity:.5},tabGroup:{display:"flex",background:"#111",padding:"3px",borderRadius:"6px",border:"1px solid ".concat(U$)},tabBtn:e=>({flex:1,border:"none",background:e?L$:"transparent",color:e?"#fff":"#888",cursor:"pointer",borderRadius:"4px",padding:"6px",fontSize:"11px",fontWeight:e?"600":"500",transition:"all 0.2s",boxShadow:e?"0 2px 4px rgba(0,0,0,0.3)":"none"}),checkboxRow:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(0,0,0,0.2)",padding:"8px",borderRadius:"4px",border:"1px solid ".concat(U$),cursor:"pointer"},iconBtn:{background:"transparent",border:"none",color:W$,cursor:"pointer",fontSize:"14px",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"}},X$=e=>{try{return decodeURIComponent(e)}catch(M2){return e}},Y$=e=>{let{label:t,val:n,min:r,max:o,step:i,onChange:a,unit:s=""}=e;return(0,c.jsxs)("div",{style:G$.row,children:[t&&(0,c.jsxs)("div",{style:G$.subLabelRow,children:[(0,c.jsx)("span",{children:t}),(0,c.jsxs)("span",{style:{fontFamily:"monospace",color:L$},children:[n,s]})]}),(0,c.jsx)("input",{type:"range",min:r,max:o,step:i,style:G$.rangeInput,value:n,onChange:e=>a(parseFloat(e.target.value))})]})},q$=t=>{let{value:n,assets:r,assetsMap:o,rootId:i,onChange:a,label:l="\u041d\u0435\u0442"}=t;const[d,u]=(0,e.useState)(!1),p=(0,e.useMemo)(()=>((e,t)=>{if(!t||!e)return null;const n=e=>X$(String(e)).replace(/\\/g,"/").trim(),r=n(t),o=e=>{if(!e)return null;for(const i of e){if(i.id===t)return i;if(i.local_path){const e=n(i.local_path);if(e===r)return i;if(e.endsWith(r)||r.endsWith(e))return i}if(i.files){const e=o(i.files);if(e)return e}}return null};for(const i in e)if(e[i].files){const t=o(e[i].files);if(t)return t}return null})(r,n),[r,n]),h=p?p.name:n?X$(n.split(/[/\\]/).pop()):l,f=h.length>18?"".concat(h.substring(0,10),"...").concat(h.substring(h.length-5)):h;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,c.jsxs)("div",{onClick:()=>u(!0),style:s(s({},G$.select),{},{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",overflow:"hidden",paddingRight:"20px"}),title:f,children:[(0,c.jsx)("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:f}),(0,c.jsx)("span",{style:{opacity:.7,fontSize:"12px"},children:"\ud83d\udcc2"})]}),n&&(0,c.jsx)("button",{onClick:()=>a(""),style:{background:N$,border:"1px solid ".concat(U$),color:W$,borderRadius:"4px",cursor:"pointer",width:"28px",display:"flex",alignItems:"center",justifyContent:"center"},title:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",children:"\u2715"})]}),(0,c.jsx)(UL,{isOpen:d,onClose:()=>u(!1),assets:r,assetsMap:o,rootId:i,onSelect:e=>a(e.local_path),allowedTypes:["png","jpg","jpeg","webp","svg"],title:"\u0412\u044b\u0431\u043e\u0440 \u0444\u0430\u0439\u043b\u0430 (".concat("sys_objects"===i?"\u041e\u0431\u044a\u0435\u043a\u0442\u044b":"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u044b",")")})]})},Z$=e=>{let{label:t,value:n,onChange:r}=e;return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,c.jsx)("span",{style:{fontSize:"9px",color:"#888",textTransform:"uppercase"},children:t}),(0,c.jsx)("input",{type:"number",style:s(s({},G$.input),{},{height:"24px",fontSize:"11px",padding:"2px 6px"}),value:n,onChange:e=>r(parseFloat(e.target.value))})]})},$$=e=>{let{texture:t,opacity:n,blend:r,scaleX:o,scaleY:i,offsetX:a,offsetY:l,onUpdateOpacity:d,onUpdateBlend:u,onUpdateScaleX:p,onUpdateScaleY:h,onUpdateOffsetX:f,onUpdateOffsetY:g}=e;return t?(0,c.jsxs)("div",{style:s(s({},G$.section),{},{marginTop:4,background:"rgba(0,0,0,0.15)"}),children:[(0,c.jsx)("div",{style:G$.subLabelRow,children:(0,c.jsx)("span",{style:{fontWeight:600,color:"#ccc"},children:"\u2699\ufe0f \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b"})}),(0,c.jsxs)("div",{style:s(s({},G$.grid2),{},{marginBottom:4}),children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:G$.rangeInput,value:n,onChange:e=>d(parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u0420\u0435\u0436\u0438\u043c \u0441\u043c\u0435\u0448\u0438\u0432\u0430\u043d\u0438\u044f"}),(0,c.jsx)("select",{style:s(s({},G$.select),{},{height:"22px",fontSize:"10px",padding:"0 4px"}),value:r,onChange:e=>u(e.target.value),children:B$.map(e=>(0,c.jsx)("option",{value:e,children:e},e))})]})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"6px"},children:[(0,c.jsx)(Z$,{label:"\u041c\u0430\u0441\u0448\u0442 X%",value:o,onChange:p}),(0,c.jsx)(Z$,{label:"\u041c\u0430\u0441\u0448\u0442 Y%",value:i,onChange:h}),(0,c.jsx)(Z$,{label:"\u0421\u0434\u0432\u0438\u0433 X%",value:a,onChange:f}),(0,c.jsx)(Z$,{label:"\u0421\u0434\u0432\u0438\u0433 Y%",value:l,onChange:g})]})]}):null},K$=t=>{let{w:n,h:r,x:o,y:i,rotate:a,onChangeW:l,onChangeH:d,onChangeX:u,onChangeY:p,onChangeRotate:h,title:f="\u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",defaultW:g=100,defaultH:m=100,disablePosition:v=!1,isAnimEnabled:y=!1}=t;const[x,b]=(0,e.useState)(!1),[w,S]=(0,e.useState)(!0),k=void 0!==n&&null!==n?n:g,C=void 0!==r&&null!==r?r:m;return(0,c.jsxs)("div",{style:s(s({},G$.section),{},{borderLeft:"3px solid ".concat(L$)}),children:[(0,c.jsxs)("div",{onClick:()=>b(!x),style:{fontSize:"11px",color:L$,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",userSelect:"none",fontWeight:700,textTransform:"uppercase"},children:[(0,c.jsx)("span",{children:f}),(0,c.jsx)("span",{style:{fontSize:"10px"},children:x?"\u25bc":"\u25b6"})]}),x&&(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"4px"},children:y?(0,c.jsxs)("div",{style:{padding:"10px",background:"rgba(255, 152, 0, 0.15)",border:"1px dashed #ff9800",borderRadius:"6px",color:"#ffb74d",fontSize:"11px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[(0,c.jsx)("span",{children:"\u26a0"})," \u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0435\u0439"]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"end",gap:6},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0428\u0438\u0440\u0438\u043d\u0430 (W)"}),(0,c.jsx)("input",{type:"number",style:G$.input,value:Math.round(k),onChange:e=>(e=>{const t=parseFloat(e);if(!isNaN(t)&&(l(t),w&&k>0&&C>0)){const e=C/k,n=Math.round(t*e);d(n)}})(e.target.value)})]}),(0,c.jsx)("div",{onClick:()=>S(!w),title:w?"\u041f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u044b":"\u041f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438 \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u044b",style:{cursor:"pointer",paddingBottom:"6px",width:"20px",textAlign:"center",color:w?L$:"#555",fontSize:"14px",transition:"color 0.2s"},children:w?"\ud83d\udd17":"\ud83d\udd13"}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0412\u044b\u0441\u043e\u0442\u0430 (H)"}),(0,c.jsx)("input",{type:"number",style:G$.input,value:Math.round(C),onChange:e=>(e=>{const t=parseFloat(e);if(!isNaN(t)&&(d(t),w&&k>0&&C>0)){const e=k/C,n=Math.round(t*e);l(n)}})(e.target.value)})]})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:6},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u041f\u043e\u0437. X"}),(0,c.jsx)("input",{type:"number",style:s(s({},G$.input),{},{opacity:v?.5:1}),value:v?"":Math.round(null!==o&&void 0!==o?o:0),placeholder:v?"-":"0",disabled:v,onChange:e=>u(parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u041f\u043e\u0437. Y"}),(0,c.jsx)("input",{type:"number",style:s(s({},G$.input),{},{opacity:v?.5:1}),value:v?"":Math.round(null!==i&&void 0!==i?i:0),placeholder:v?"-":"0",disabled:v,onChange:e=>p(parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u041f\u043e\u0432\u043e\u0440\u043e\u0442 \xb0"}),(0,c.jsx)("input",{type:"number",style:G$.input,value:Math.round(null!==a&&void 0!==a?a:0),onChange:e=>h(parseFloat(e.target.value))})]})]})]})})]})},J$=t=>{var n,r,o,i,a,l,d;let{mode:u="text",scope:p,data:h,onUpdate:f,assets:g={},assetsMap:m={},objects:v=[],activeButtons:y=[],layoutMode:x="desktop",buttonCount:b,onUpdateButtonCount:w,onOpenTextEditor:S,selectedElementId:k,currentTextElement:C,currentButtonElement:j,onUpdateLayout:_,isAnimEnabled:E=!1}=t;const D=h||{},M=(e,t)=>f(s(s({},D),{},{[e]:t})),T="mobile"===x?"_mobile":"_desktop",I=(e,t)=>{const n=e+T;return void 0!==D[n]?D[n]:void 0!==D[e]?D[e]:t},[A,O]=(0,e.useState)(!1),R=(e,t)=>f(s(s({},D),{},{[e+T]:t})),z=R,F="global"===p,P=e=>{let{title:t,icon:n}=e;return(0,c.jsxs)("div",{style:G$.header,children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:n}),(0,c.jsx)("span",{children:t})]})};var B,L,N;if("text"===u)return(0,c.jsxs)("div",{style:G$.panel,children:[(0,c.jsx)(P,{title:"\u0421\u0442\u0438\u043b\u044c \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0431\u043b\u043e\u043a\u0430",icon:"\ud83d\udcdd"}),(0,c.jsx)(K$,{w:null===C||void 0===C?void 0:C.w,h:null===C||void 0===C?void 0:C.h,x:null===C||void 0===C?void 0:C.x,y:null===C||void 0===C?void 0:C.y,rotate:null===C||void 0===C?void 0:C.rotate,onChangeW:e=>_&&_("text_area",{w:e}),onChangeH:e=>_&&_("text_area",{h:e}),onChangeX:e=>_&&_("text_area",{x:e}),onChangeY:e=>_&&_("text_area",{y:e}),onChangeRotate:e=>_&&_("text_area",{rotate:e}),title:"\ud83d\udcd0 \u0413\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u044f \u0431\u043b\u043e\u043a\u0430",isAnimEnabled:E}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\ud83c\udfa8 \u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0432\u0438\u0434"}),(0,c.jsxs)("div",{style:G$.grid2Auto,children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430 \u0444\u043e\u043d\u0430"}),(0,c.jsx)(q$,{value:D.text_box_texture,assets:g,assetsMap:m,rootId:"sys_textures",onChange:e=>M("text_box_texture",e),label:"\u0411\u0435\u0437 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b"})]}),(0,c.jsxs)("div",{style:{width:"32px"},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:D.text_box_bg_color,onChange:e=>M("text_box_bg_color",e)})]})]}),(0,c.jsx)($$,{texture:D.text_box_texture,opacity:null!==(B=D.text_box_texture_opacity)&&void 0!==B?B:1,blend:D.text_box_texture_blend||"normal",scaleX:I("text_box_texture_scale_x",100),scaleY:I("text_box_texture_scale_y",100),offsetX:I("text_box_texture_offset_x",50),offsetY:I("text_box_texture_offset_y",50),onUpdateOpacity:e=>M("text_box_texture_opacity",e),onUpdateBlend:e=>M("text_box_texture_blend",e),onUpdateScaleX:e=>R("text_box_texture_scale_x",e),onUpdateScaleY:e=>R("text_box_texture_scale_y",e),onUpdateOffsetX:e=>R("text_box_texture_offset_x",e),onUpdateOffsetY:e=>R("text_box_texture_offset_y",e)}),(0,c.jsxs)("div",{style:{marginTop:6},children:[(0,c.jsx)(Y$,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0444\u043e\u043d\u0430",val:null!==(L=D.text_box_opacity)&&void 0!==L?L:.7,min:"0",max:"1",step:"0.05",onChange:e=>M("text_box_opacity",e)}),(0,c.jsx)(Y$,{label:"\u0420\u0430\u0434\u0438\u0443\u0441 \u0441\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u044f",val:null!==(N=D.text_box_border_radius)&&void 0!==N?N:0,min:"0",max:"50",step:"1",onChange:e=>M("text_box_border_radius",e),unit:"px"})]})]}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\u23f9 \u0413\u0440\u0430\u043d\u0438\u0446\u044b \u0431\u043b\u043e\u043a\u0430"}),(0,c.jsx)("div",{style:s(s({},G$.row),{},{marginTop:5}),children:(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"32px 1fr 1fr",gap:"8px",alignItems:"end"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:I("text_box_border_color","#ffffff"),onChange:e=>M("text_box_border_color",e)})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:G$.label,children:["\u0428\u0438\u0440\u0438\u043d\u0430: ",I("text_box_border_width",0),"px"]}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"1",style:G$.rangeInput,value:I("text_box_border_width",0),onChange:e=>z("text_box_border_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:G$.label,children:["\u041f\u0440\u043e\u0437\u0440.: ",I("text_box_border_opacity",1)]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:G$.rangeInput,value:I("text_box_border_opacity",1),onChange:e=>M("text_box_border_opacity",parseFloat(e.target.value))})]})]})})]}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\u2712\ufe0f \u0422\u0438\u043f\u043e\u0433\u0440\u0430\u0444\u0438\u043a\u0430 \u0438 \u043e\u0442\u0441\u0442\u0443\u043f\u044b"}),(0,c.jsxs)("div",{style:G$.row,children:[(0,c.jsx)("div",{style:G$.subLabelRow,children:(0,c.jsx)("span",{children:"\u041c\u0430\u043a\u0435\u0442 / \u041e\u0442\u0441\u0442\u0443\u043f"})}),(0,c.jsxs)("select",{style:G$.select,value:I("text_separator_side","none"),onChange:e=>R("text_separator_side",e.target.value),children:[(0,c.jsx)("option",{value:"none",children:"\u041d\u0435\u0442 (\u041d\u0430 \u0432\u0441\u044e \u0448\u0438\u0440\u0438\u043d\u0443)"}),(0,c.jsx)("option",{value:"left",children:"\u041e\u0442\u0441\u0442\u0443\u043f \u0441\u043b\u0435\u0432\u0430 (\u0421\u0434\u0432\u0438\u0433 \u0432\u043f\u0440\u0430\u0432\u043e)"}),(0,c.jsx)("option",{value:"right",children:"\u041e\u0442\u0441\u0442\u0443\u043f \u0441\u043f\u0440\u0430\u0432\u0430 (\u0421\u0434\u0432\u0438\u0433 \u0432\u043b\u0435\u0432\u043e)"})]})]}),"none"!==I("text_separator_side","none")&&(0,c.jsx)(Y$,{label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043e\u0442\u0441\u0442\u0443\u043f\u0430",val:I("text_separator_pos",70),min:"0",max:"100",step:"1",onChange:e=>R("text_separator_pos",e),unit:"%"})]}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.checkboxRow,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)("input",{type:"checkbox",checked:I("text_separator_visual_enabled",!1),onChange:e=>z("text_separator_visual_enabled",e.target.checked),style:{accentColor:L$}}),(0,c.jsx)("span",{style:{fontWeight:600,fontSize:"12px"},children:"\ud83d\udd8c \u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c"})]})}),I("text_separator_visual_enabled",!1)&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10,marginTop:8,paddingLeft:8,borderLeft:"2px solid ".concat(L$)},children:[(0,c.jsxs)("div",{style:G$.row,children:[(0,c.jsx)("div",{style:G$.subLabelRow,children:(0,c.jsx)("span",{children:"\u041e\u0440\u0438\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043b\u0438\u043d\u0438\u0438"})}),(0,c.jsxs)("select",{style:G$.select,value:I("text_separator_line_orient","vertical"),onChange:e=>z("text_separator_line_orient",e.target.value),children:[(0,c.jsx)("option",{value:"vertical",children:"\u0412\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0430\u044f (\u041e\u0441\u044c X)"}),(0,c.jsx)("option",{value:"horizontal",children:"\u0413\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f (\u041e\u0441\u044c Y)"})]})]}),(0,c.jsx)(Y$,{label:"\u041f\u043e\u0437\u0438\u0446\u0438\u044f",val:I("text_separator_line_pos",50),min:"0",max:"100",step:"0.5",onChange:e=>z("text_separator_line_pos",e),unit:"%"}),(0,c.jsxs)("div",{style:G$.grid2Auto,children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.subLabelRow,children:(0,c.jsxs)("span",{children:["\u0428\u0438\u0440\u0438\u043d\u0430: ",I("text_separator_width",1),"px"]})}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"1",style:G$.rangeInput,value:I("text_separator_width",1),onChange:e=>z("text_separator_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:{width:32},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:I("text_separator_color","#ffffff"),onChange:e=>z("text_separator_color",e)})]})]}),(0,c.jsx)(Y$,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u043b\u0438\u043d\u0438\u0438",val:I("text_separator_opacity",1),min:"0",max:"1",step:"0.1",onChange:e=>z("text_separator_opacity",e)})]})]}),"local"===p&&S&&(0,c.jsxs)("button",{onClick:S,style:{background:L$,border:"none",borderRadius:"6px",color:"#fff",padding:"12px",fontSize:"13px",fontWeight:"600",cursor:"pointer",width:"100%",marginTop:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 4px 6px rgba(117, 104, 237, 0.3)"},children:[(0,c.jsx)("span",{children:"\ud83d\udcdd"})," \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"]})]});const U=D.btn_mode||"box",V=k&&k.startsWith("btn_"),W=j||(y.length>0?y[0]:null),H=(e,t)=>{_&&(V&&W?_(W.id,{[e]:t}):y.length>0&&y.forEach(n=>_(n.id,{[e]:t})))};return(0,c.jsxs)("div",{style:G$.panel,children:[(0,c.jsx)(P,{title:"\u0421\u0442\u0438\u043b\u044c \u043a\u043d\u043e\u043f\u043e\u043a",icon:"\ud83c\udfae"}),"global"===p&&(0,c.jsx)("div",{style:G$.section,children:(0,c.jsxs)("div",{style:s(s({},G$.row),{},{marginBottom:4}),children:[(0,c.jsxs)("div",{style:G$.subLabelRow,children:[(0,c.jsx)("span",{style:{fontWeight:600},children:"\ud83d\udd22 \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u043d\u043e\u043f\u043e\u043a"}),(0,c.jsx)(PE,{text:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u043d\u043e\u043f\u043e\u043a \u0434\u043b\u044f \u043c\u0430\u043a\u0435\u0442\u0430 \u0448\u0430\u0431\u043b\u043e\u043d\u0430. \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435."})]}),(0,c.jsx)(Y$,{label:"",val:b||2,min:"1",max:"10",step:"1",onChange:e=>w&&w(e)})]})}),(0,c.jsxs)("div",{style:{marginTop:4},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:V?H$:"#888",marginBottom:4,textAlign:"right"},children:V?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435: ".concat(k):"\u0420\u0435\u0436\u0438\u043c: \u0428\u0410\u0411\u041b\u041e\u041d (\u0412\u0441\u0435 \u043a\u043d\u043e\u043f\u043a\u0438)"}),(0,c.jsx)(K$,{w:null===W||void 0===W?void 0:W.w,h:null===W||void 0===W?void 0:W.h,x:null===W||void 0===W?void 0:W.x,y:null===W||void 0===W?void 0:W.y,rotate:null===W||void 0===W?void 0:W.rotate,defaultW:250,defaultH:80,onChangeW:e=>H("w",e),onChangeH:e=>H("h",e),onChangeX:e=>H("x",e),onChangeY:e=>H("y",e),onChangeRotate:e=>H("rotate",e),title:"\ud83d\udcd0 \u0413\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u044f \u043a\u043d\u043e\u043f\u043a\u0438",disablePosition:!V,isAnimEnabled:E})]}),(0,c.jsxs)("div",{style:s(s({},G$.section),{},{borderLeft:A?"3px solid ".concat(L$):G$.section.borderLeft}),children:[(0,c.jsxs)("div",{onClick:()=>O(!A),style:{fontSize:"11px",color:L$,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",userSelect:"none",fontWeight:700,textTransform:"uppercase"},children:[(0,c.jsx)("span",{children:"\ud83d\uddb1\ufe0f \u041a\u043b\u0438\u043a \u0432\u0435\u0437\u0434\u0435 (\u0424\u043e\u043d)"}),(0,c.jsx)("span",{style:{fontSize:"10px"},children:A?"\u25bc":"\u25b6"})]}),A&&(0,c.jsxs)("div",{style:{marginTop:"8px"},children:[(0,c.jsxs)("div",{style:{fontSize:"10px",color:"#888",marginBottom:6},children:["\u041a\u043b\u0438\u043a \u043f\u043e \u043f\u0443\u0441\u0442\u043e\u0439 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u0438. \u0415\u0441\u043b\u0438 \u043a\u043d\u043e\u043f\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 ",(0,c.jsx)("b",{children:"{No_btn}"}),", \u043e\u043d\u0430 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438."]}),(()=>{const e=y.find(e=>e.text&&e.text.includes("{No_btn}"));return(0,c.jsxs)("div",{style:G$.row,children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0435\u043b\u0435\u0432\u0430\u044f \u043a\u043d\u043e\u043f\u043a\u0430"}),(0,c.jsxs)("select",{style:s(s({},G$.select),{},{opacity:e?.6:1,cursor:e?"not-allowed":"pointer",backgroundColor:e?"#2a2a2a":void 0}),value:e?e.id:D.click_anywhere_target||"",disabled:!!e,onChange:e=>M("click_anywhere_target",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"\u2014 \u041d\u0435\u0442 (\u0422\u043e\u043b\u044c\u043a\u043e \u043a\u043b\u0438\u043a \u043f\u043e \u043a\u043d\u043e\u043f\u043a\u0430\u043c) \u2014"}),"global"===p?Array.from({length:b||4}).map((e,t)=>(0,c.jsxs)("option",{value:"btn_".concat(t),children:["\u041a\u043d\u043e\u043f\u043a\u0430 ",t+1]},t)):y.map(e=>(0,c.jsx)("option",{value:e.id,children:e.text?'"'.concat(e.text.slice(0,20)).concat(e.text.length>20?"...":"",'" (').concat(e.id,")"):"\u041a\u043d\u043e\u043f\u043a\u0430 ".concat(e.index+1)},e.id))]}),e&&(0,c.jsxs)("div",{style:{fontSize:"10px",color:H$,marginTop:4},children:["\ud83d\udd12 \u0410\u0432\u0442\u043e-\u0432\u044b\u0431\u043e\u0440: \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0430 \u0441 ",(0,c.jsx)("b",{children:"{No_btn}"})]})]})})()]})]}),(0,c.jsxs)("div",{style:{marginTop:10,marginBottom:10},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0420\u0435\u0436\u0438\u043c \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("div",{style:G$.tabGroup,children:[(0,c.jsx)("button",{onClick:()=>M("btn_mode","box"),style:G$.tabBtn("box"===U),children:"\ud83d\udce6 \u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0431\u043b\u043e\u043a"}),(0,c.jsx)("button",{onClick:()=>M("btn_mode","object"),style:G$.tabBtn("object"===U),children:"\ud83d\uddbc PNG \u041e\u0431\u044a\u0435\u043a\u0442"})]})]}),"box"===U&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\ud83c\udfa8 \u0417\u0430\u043b\u0438\u0432\u043a\u0430 \u0438 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0430"}),(0,c.jsxs)("div",{style:G$.grid2Auto,children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430"}),(0,c.jsx)(q$,{value:D.btn_texture,assets:g,assetsMap:m,rootId:"sys_textures",onChange:e=>M("btn_texture",e),label:"\u0411\u0435\u0437 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b"})]}),(0,c.jsxs)("div",{style:{width:32},children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:D.btn_bg_color,onChange:e=>M("btn_bg_color",e)})]})]}),(0,c.jsx)($$,{texture:D.btn_texture,opacity:null!==(n=D.btn_texture_opacity)&&void 0!==n?n:1,blend:D.btn_texture_blend||"normal",scaleX:I("btn_texture_scale_x",100),scaleY:I("btn_texture_scale_y",100),offsetX:I("btn_texture_offset_x",50),offsetY:I("btn_texture_offset_y",50),onUpdateOpacity:e=>M("btn_texture_opacity",e),onUpdateBlend:e=>M("btn_texture_blend",e),onUpdateScaleX:e=>R("btn_texture_scale_x",e),onUpdateScaleY:e=>R("btn_texture_scale_y",e),onUpdateOffsetX:e=>R("btn_texture_offset_x",e),onUpdateOffsetY:e=>R("btn_texture_offset_y",e)})]}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\ud83d\udca7 \u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)(Y$,{label:"\u0424\u043e\u043d",val:null!==(r=D.btn_bg_opacity)&&void 0!==r?r:1,min:"0",max:"1",step:"0.05",onChange:e=>M("btn_bg_opacity",e)}),(0,c.jsx)(Y$,{label:"\u0422\u0435\u043a\u0441\u0442",val:null!==(o=D.btn_text_opacity)&&void 0!==o?o:1,min:"0",max:"1",step:"0.05",onChange:e=>M("btn_text_opacity",e)}),(0,c.jsx)(Y$,{label:"\u041e\u0431\u0449\u0430\u044f",val:null!==(i=D.btn_opacity)&&void 0!==i?i:1,min:"0",max:"1",step:"0.05",onChange:e=>M("btn_opacity",e)})]}),(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\u23f9 \u0413\u0440\u0430\u043d\u0438\u0446\u044b"}),(0,c.jsx)("div",{style:s(s({},G$.row),{},{marginTop:5}),children:(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"32px 1fr 1fr",gap:"8px",alignItems:"end"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:G$.label,children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:D.btn_border_color,onChange:e=>M("btn_border_color",e)})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:G$.label,children:["\u0428\u0438\u0440\u0438\u043d\u0430: ",I("btn_border_width",0),"px"]}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"1",style:G$.rangeInput,value:I("btn_border_width",0),onChange:e=>z("btn_border_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:G$.label,children:["\u0420\u0430\u0434\u0438\u0443\u0441: ",null!==(a=D.btn_border_radius)&&void 0!==a?a:0,"px"]}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:G$.rangeInput,value:null!==(l=D.btn_border_radius)&&void 0!==l?l:0,onChange:e=>M("btn_border_radius",parseInt(e.target.value))})]})]})})]}),(0,c.jsxs)("div",{style:G$.checkboxRow,children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)("input",{type:"checkbox",checked:D.btn_hover_enabled||!1,onChange:e=>M("btn_hover_enabled",e.target.checked),style:{accentColor:L$}}),(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:500},children:"\u2728 \u042d\u0444\u0444\u0435\u043a\u0442 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u044f"})]}),D.btn_hover_enabled&&(0,c.jsx)("div",{style:{width:"32px"},children:(0,c.jsx)(T$,{color:D.btn_hover_color||"#666666",onChange:e=>M("btn_hover_color",e)})})]})]}),"object"===U&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[F&&(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\ud83c\udf0d \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043a\u0438\u043d"}),(0,c.jsx)(q$,{value:D.btn_global_object,assets:g,assetsMap:m,rootId:"sys_objects",onChange:e=>M("btn_global_object",e),label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b \u043e\u0431\u044a\u0435\u043a\u0442\u0430..."}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#666",marginTop:4},children:"* \u0424\u0430\u0439\u043b\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432 \u043f\u0430\u043f\u043a\u0435 objects"})]}),!F&&y.length>0&&(0,c.jsxs)("div",{style:G$.section,children:[(0,c.jsx)("div",{style:G$.subHeader,children:"\ud83d\udccd \u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u043a\u0438\u043d\u044b"}),y.map((e,t)=>{const n=D.btn_objects||{},r=n[e.id]||"",o=D.btn_hide_text_map||{},i=o[e.id]||!1;return(0,c.jsxs)("div",{style:{marginBottom:8,paddingBottom:8,borderBottom:"1px solid #333"},children:[(0,c.jsx)("div",{style:G$.subLabelRow,children:(0,c.jsxs)("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px",display:"inline-block",verticalAlign:"bottom"},children:[e.text?(0,c.jsx)("span",{title:e.text,children:e.text.length>20?e.text.slice(0,20)+"...":e.text}):"\u041a\u043d\u043e\u043f\u043a\u0430 ".concat(t+1),(0,c.jsxs)("span",{style:{color:"#666",marginLeft:"4px"},children:["(",e.id,")"]})]})}),(0,c.jsx)(q$,{value:r,assets:g,assetsMap:m,rootId:"sys_objects",onChange:t=>M("btn_objects",s(s({},n),{},{[e.id]:t})),label:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0413\u043b\u043e\u0431.)"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"6px"},children:[(0,c.jsx)("input",{type:"checkbox",id:"hide_".concat(e.id),checked:i,onChange:t=>M("btn_hide_text_map",s(s({},o),{},{[e.id]:t.target.checked}))}),(0,c.jsx)("label",{htmlFor:"hide_".concat(e.id),style:{fontSize:"11px",color:"#888",cursor:"pointer"},children:"\u0421\u043a\u0440\u044b\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u043d\u0430 \u044d\u0442\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u0435"})]})]},e.id)})]}),(0,c.jsx)($$,{texture:D.btn_global_object||"local_override",opacity:null!==(d=D.btn_object_opacity)&&void 0!==d?d:1,blend:D.btn_object_blend||"normal",scaleX:I("btn_object_scale_x",100),scaleY:I("btn_object_scale_y",100),offsetX:I("btn_object_offset_x",50),offsetY:I("btn_object_offset_y",50),onUpdateOpacity:e=>M("btn_object_opacity",e),onUpdateBlend:e=>M("btn_object_blend",e),onUpdateScaleX:e=>z("btn_object_scale_x",e),onUpdateScaleY:e=>z("btn_object_scale_y",e),onUpdateOffsetX:e=>z("btn_object_offset_x",e),onUpdateOffsetY:e=>z("btn_object_offset_y",e)}),(0,c.jsxs)("div",{style:G$.checkboxRow,children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)("input",{type:"checkbox",checked:D.btn_object_hover_enabled||!1,onChange:e=>M("btn_object_hover_enabled",e.target.checked),style:{accentColor:L$}}),(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:500},children:"\u2728 \u0421\u0432\u0435\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438"})]}),D.btn_object_hover_enabled&&(0,c.jsx)("div",{style:{width:"32px"},children:(0,c.jsx)(T$,{color:D.btn_object_hover_color||"#ffffff",onChange:e=>M("btn_object_hover_color",e)})})]})]})]})},Q$=e=>e.touches&&e.touches.length>0?e.touches[0].clientX:e.clientX,eK=e.memo(e=>{let{duration:t,onDurationChange:n,trigger:r,onTriggerChange:o,triggerLayerId:i,onTriggerLayerIdChange:a,restartOnClick:l,onRestartOnClickChange:d,snapStep:u,setSnapStep:p,layers:h=[],onAddEvent:f,isEnabled:g,isBlocked:m,showEvents:v=!0,showTriggerTextTyping:y=!0,textEvents:x=[]}=e;const b={background:"#1a1a1a",border:"1px solid #444",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",width:"100%",boxSizing:"border-box"},w={fontSize:"11px",color:"#888",marginBottom:"4px",display:"block"};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"15px",marginBottom:"15px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:w,children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"number",value:t||30,min:.1,max:300,step:.1,onChange:e=>n(parseFloat(e.target.value)),style:b})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:w,children:"\u0423\u0441\u043b\u043e\u0432\u0438\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430"}),(0,c.jsxs)("select",{value:r||"start",onChange:e=>o(e.target.value),style:b,children:[(0,c.jsx)("option",{value:"start",children:"\u0421\u0442\u0430\u0440\u0442 \u0441\u0446\u0435\u043d\u044b"}),(0,c.jsx)("option",{value:"click",children:"\u041a\u043b\u0438\u043a \u043f\u043e \u0441\u043b\u043e\u044e"}),y&&(0,c.jsx)("option",{value:"text_typing",children:"\u041d\u0430\u0431\u043e\u0440 \u0442\u0435\u043a\u0441\u0442\u0430 \u2328\ufe0f"}),(0,c.jsx)("option",{value:"text_event",children:"Text Event \ud83d\udcdd"})]}),"text_event"===r&&(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:w,children:"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435"}),(0,c.jsxs)("select",{value:i||"",onChange:e=>a(e.target.value),style:s(s({},b),{},{borderColor:"#2196f3"}),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435 --"}),x&&x.length>0?x.map(e=>(0,c.jsx)("option",{value:e,children:e},e)):(0,c.jsx)("option",{disabled:!0,children:"\u0412 \u0442\u0435\u043a\u0441\u0442\u0435 \u043d\u0435\u0442 \u0442\u0435\u0433\u043e\u0432 [[Event:...]]"})]})]})})]}),"click"===r&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:w,children:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u043b\u043e\u0439 (\u041a\u043d\u043e\u043f\u043a\u0430)"}),(0,c.jsxs)("select",{value:i||"",onChange:e=>a(e.target.value),style:s(s({},b),{},{borderColor:"#2196f3"}),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043b\u043e\u0439 --"}),h.filter(e=>"folder"!==e.type).map(e=>(0,c.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]})]}),(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",color:"#ccc",cursor:"pointer",background:"rgba(255,255,255,0.05)",padding:"4px 6px",borderRadius:"4px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!l,onChange:e=>d&&d(e.target.checked),style:{accentColor:"#2196f3"}}),"\ud83d\udd04 \u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438 \u043a\u043b\u0438\u043a\u0435"]})]})]})]}),(0,c.jsxs)("div",{style:{marginBottom:10,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#aaa"},children:"\u041c\u0430\u0433\u043d\u0438\u0442:"}),(0,c.jsxs)("select",{value:u,onChange:e=>p(parseFloat(e.target.value)),style:s(s({},b),{},{width:"auto",padding:"2px 5px"}),children:[(0,c.jsx)("option",{value:0,children:"\u041f\u043b\u0430\u0432\u043d\u043e"}),(0,c.jsx)("option",{value:1,children:"1.0 \u0441\u0435\u043a"}),(0,c.jsx)("option",{value:.5,children:"0.5 \u0441\u0435\u043a"}),(0,c.jsx)("option",{value:.25,children:"0.25 \u0441\u0435\u043a"}),(0,c.jsx)("option",{value:.1,children:"0.1 \u0441\u0435\u043a"}),(0,c.jsx)("option",{value:.05,children:"0.05 \u0441\u0435\u043a"})]})]}),v&&(0,c.jsx)("button",{onClick:f,disabled:!g||m,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0430\u0440\u043a\u0435\u0440 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f",style:{background:"#e91e63",border:"none",borderRadius:"4px",color:"#fff",padding:"4px 10px",cursor:"pointer",fontWeight:"bold",fontSize:"11px",display:"flex",alignItems:"center",gap:5},children:"\ud83d\udccd + Event"})]})]})}),tK=t=>{let{data:n,onUpdateData:r,currentTime:o,onTimeChange:i,selectedElementId:a,isEnabled:l=!0,blockingMessage:d=null,snapStep:u=0,onPlayStateChange:p,textEvents:h=[]}=t;const f=(null===n||void 0===n?void 0:n.duration)||30,g=(0,e.useRef)(null),m=(0,e.useRef)(null),v=(0,e.useRef)(null),y=(0,e.useRef)(o),x=(0,e.useRef)(i),[b,w]=(0,e.useState)(!1);(0,e.useEffect)(()=>{p&&p(b)},[b,p]),(0,e.useEffect)(()=>{y.current=o},[o]),(0,e.useEffect)(()=>{x.current=i},[i]);const[S,k]=(0,e.useState)(!1),[C,j]=(0,e.useState)(null),[_,E]=(0,e.useState)(null),[D,M]=(0,e.useState)(null),[T,I]=(0,e.useState)(()=>localStorage.getItem("clipboard_anim_type")||null);(0,e.useEffect)(()=>{if(b){v.current=performance.now();const e=t=>{if(!b)return;v.current||(v.current=t);const n=(t-v.current)/1e3;v.current=t;let r=y.current+n;r>=f&&(r=0),y.current=r,x.current&&x.current(r),m.current=requestAnimationFrame(e)};m.current=requestAnimationFrame(e)}else m.current&&cancelAnimationFrame(m.current),v.current=null;return()=>{m.current&&cancelAnimationFrame(m.current)}},[b,f]);const A=()=>w(!1),O=e=>{if(!g.current)return 0;const t=g.current.getBoundingClientRect();let n=(e-t.left)/t.width*f;return n<0&&(n=0),n>f&&(n=f),u>0&&(n=Math.round(n/u)*u,n>f&&(n=f)),n},R=e=>{if(!l)return;A(),k(!0);const t=Q$(e),n=O(t);i(n),E(null)},z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.stopPropagation(),A(),n?(M(r),E(null)):(E(t),M(null)),j({time:t,isEvent:n,id:r}),i(t)};(0,e.useEffect)(()=>{const e=e=>{const t=Q$(e);if(S){const e=O(t);i(e)}else if(C){const e=O(t);if(C.isEvent){const t=(n.events||[]).map(t=>t.id===C.id?s(s({},t),{},{time:e}):t);r(s(s({},n),{},{events:t})),i(e)}else{const t=((e,t,n,r)=>{var o;const i=JSON.parse(JSON.stringify(e));if(null===(o=i.elements)||void 0===o||!o[t])return i;const a=i.elements[t];return Object.keys(a).forEach(e=>{if("_config"===e||!Array.isArray(a[e]))return;const t=a[e],o=t.findIndex(e=>Math.abs(e.t-n)<IB);o>=0&&(t[o].t=r,t.sort((e,t)=>e.t-t.t))}),i})(n,a,C.time,e);j(t=>s(s({},t),{},{time:e})),E(e),i(e),r(t)}}},t=()=>{k(!1),j(null)};return(S||null!==C)&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),window.addEventListener("touchmove",e,{passive:!1}),window.addEventListener("touchend",t)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),window.removeEventListener("touchmove",e),window.removeEventListener("touchend",t)}},[S,C,n,f,a,r,i,u]);const F=()=>{if(!D)return;const e=n.events||[];r(s(s({},n),{},{events:e.filter(e=>e.id!==D)})),M(null)},P=null!==_,B=P?"Copy Key":"Copy",L="key"===T?"Paste Key":"Paste",N={background:"#333",border:"1px solid #555",color:"#eee",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},U=!!d;return(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{ref:g,onMouseDown:U?void 0:R,onTouchStart:U?void 0:R,style:{position:"relative",height:"40px",background:"#111",borderRadius:"6px",cursor:U?"not-allowed":l?"pointer":"default",opacity:l?1:.5,border:"1px solid #444",marginBottom:"15px",userSelect:"none",overflow:"hidden",touchAction:"none"},children:U?(0,c.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(211, 47, 47, 0.2)",color:"#ff8a80",fontSize:"11px",textAlign:"center",padding:"0 10px"},children:["\u26a0\ufe0f ",d]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:"linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px)",backgroundSize:"".concat(100/f,"% 100%")}}),(0,c.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"".concat(o/f*100,"%"),background:"rgba(33, 150, 243, 0.15)",pointerEvents:"none"}}),(0,c.jsx)("div",{style:{position:"absolute",left:"".concat(o/f*100,"%"),top:0,bottom:0,width:2,background:"#f44336",zIndex:10,pointerEvents:"none",boxShadow:"0 0 5px #f44336"}}),l&&(n.events||[]).map(e=>{const t=D===e.id,n=e.time/f*100;return(0,c.jsx)("div",{onMouseDown:t=>z(t,e.time,!0,e.id),onTouchStart:t=>z(t,e.time,!0,e.id),title:"Event: ".concat(e.name),style:{position:"absolute",left:"".concat(n,"%"),top:0,width:14,height:14,background:t?"#ff4081":"#e91e63",borderRadius:"50%",transform:"translate(-50%, 0)",border:"2px solid #fff",zIndex:20,cursor:"ew-resize",boxShadow:"0 2px 5px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"}},e.id)}),l&&(()=>{var e;if(!a||null===n||void 0===n||null===(e=n.elements)||void 0===e||!e[a])return null;const t=n.elements[a],r=new Set;return Object.keys(t).forEach(e=>{"_config"!==e&&Array.isArray(t[e])&&t[e].forEach(e=>{let t=!1;for(let n of r)if(Math.abs(n-e.t)<.01){t=!0;break}t||r.add(e.t)})}),Array.from(r).map((e,t)=>{const n=null!==_&&Math.abs(_-e)<.01;return(0,c.jsx)("div",{onMouseDown:t=>z(t,e),onTouchStart:t=>z(t,e),style:{position:"absolute",left:"".concat(e/f*100,"%"),bottom:4,width:16,height:16,background:n?"#ffeb3b":"#2196f3",transform:"translate(-50%, 0) rotate(45deg)",border:"2px solid #fff",zIndex:15,cursor:"ew-resize",boxShadow:"0 2px 5px rgba(0,0,0,0.5)",touchAction:"none"}},"k-".concat(t))})})()]})}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:10},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("button",{onClick:()=>w(!b),disabled:!l,style:{background:b?"#ffc107":"#4caf50",border:"none",borderRadius:"4px",color:b?"#000":"#fff",padding:"6px 16px",cursor:"pointer",fontWeight:"bold"},children:b?"PAUSE":"PLAY"}),(0,c.jsx)(PE,{text:"\u26a0\ufe0f \u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0432 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435 \u043c\u043e\u0436\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438. \u0412 Runtime \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u043f\u043b\u0430\u0432\u043d\u043e\u0439."}),(0,c.jsxs)("span",{style:{fontFamily:"monospace",fontSize:"14px",color:"#aaa"},children:[o.toFixed(2),"s"]})]}),D&&(()=>{const e=(n.events||[]).find(e=>e.id===D);if(e)return(0,c.jsxs)("div",{style:{display:"flex",gap:5,alignItems:"center",background:"#333",padding:"2px 6px",borderRadius:4},children:[(0,c.jsx)(PE,{text:"\u041c\u0435\u0442\u043a\u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0434\u043b\u044f \u0432\u044b\u0437\u043e\u0432\u0430 \u0432\u043d\u0435\u0448\u043d\u0435\u0439 \u043b\u043e\u0433\u0438\u043a\u0438 (\u0437\u0432\u0443\u043a\u0438, \u0441\u043a\u0440\u0438\u043f\u0442\u044b)."}),(0,c.jsx)("span",{style:{fontSize:10,color:"#e91e63"},children:"EVENT:"}),(0,c.jsx)("input",{value:e.name,onChange:e=>(e=>{if(!D)return;const t=(n.events||[]).map(t=>t.id===D?s(s({},t),{},{name:e}):t);r(s(s({},n),{},{events:t}))})(e.target.value),style:{background:"#111",border:"none",color:"#fff",width:80,fontSize:12,padding:2}}),(0,c.jsx)("button",{onClick:F,style:{color:"#ff6b6b",background:"none",border:"none",cursor:"pointer"},children:"\xd7"})]})})(),(0,c.jsxs)("div",{style:{display:"flex",gap:8},children:[!U&&a&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>{if(P){const e=((e,t,n)=>{var r;if(null===e||void 0===e||null===(r=e.elements)||void 0===r||!r[t])return"none";const o=e.elements[t],i={};let a=!1;return Object.keys(o).forEach(e=>{if("_config"===e||!Array.isArray(o[e]))return;const t=o[e].find(e=>Math.abs(e.t-n)<IB);t&&(i[e]=t.v,a=!0)}),a?(localStorage.setItem("clipboard_anim_type","key"),localStorage.setItem("clipboard_key_data",JSON.stringify(i)),"key"):(alert("\u0412 \u044d\u0442\u043e\u0439 \u0442\u043e\u0447\u043a\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043d\u0435\u0442 \u043a\u043b\u044e\u0447\u0435\u0439."),"none")})(n,a,_);"key"===e&&(I("key"),alert("\u0414\u0430\u043d\u043d\u044b\u0435 \u043a\u043b\u044e\u0447\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u044b!"))}else{"object"===((e,t)=>{var n;if(null===e||void 0===e||null===(n=e.elements)||void 0===n||!n[t])return alert("\u0423 \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043d\u0435\u0442 \u043a\u043b\u044e\u0447\u0435\u0439 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438."),"none";const r=e.elements[t];return localStorage.setItem("clipboard_anim_type","object"),localStorage.setItem("clipboard_anim_data",JSON.stringify(r)),"object"})(n,a)&&I("object")}},style:N,children:B}),(0,c.jsx)("button",{onClick:()=>{if("key"===T){const e=((e,t,n)=>{const r=localStorage.getItem("clipboard_key_data");if(!r)return e;try{const o=JSON.parse(r);let i=JSON.parse(JSON.stringify(e));return Object.keys(o).forEach(e=>{const r=o[e];i=LB(i,t,e,n,r)}),i}catch(M2){return console.error(M2),e}})(n,a,o);r(e)}else{const e=((e,t)=>{const n=localStorage.getItem("clipboard_anim_data");if(!n)return e;try{const r=JSON.parse(n),o=JSON.parse(JSON.stringify(e));return o.elements||(o.elements={}),o.elements[t]=r,o}catch(M2){return console.error(M2),e}})(n,a);r(e)}},style:N,children:L})]}),!U&&null!==_&&(0,c.jsx)("button",{onClick:()=>{if(null===_||!a)return;const e=((e,t,n)=>{var r;const o=JSON.parse(JSON.stringify(e));if(null===(r=o.elements)||void 0===r||!r[t])return o;const i=o.elements[t];return Object.keys(i).forEach(e=>{"_config"!==e&&Array.isArray(i[e])&&(i[e]=i[e].filter(e=>Math.abs(e.t-n)>IB))}),o})(n,a,_);r(e),E(null)},style:s(s({},N),{},{background:"#d32f2f"}),children:"Delete Key"})]})]})]})},nK=e.memo(e=>{let{label:t,val:n,min:r,max:o,step:i,param:a,def:s,onChange:l}=e;return(0,c.jsxs)("div",{style:{marginBottom:6},children:[(0,c.jsxs)("div",{style:{fontSize:"9px",color:"#888",marginBottom:2,display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("span",{children:t}),(0,c.jsx)("span",{style:{color:"#fff"},children:Math.round(100*n)/100})]}),(0,c.jsx)("input",{type:"range",min:r,max:o,step:i,value:n,onChange:e=>l(a,parseFloat(e.target.value)),onDoubleClick:()=>l(a,s),style:{width:"100%",height:4,cursor:"pointer",accentColor:"#7568ed"}})]})}),rK=e.memo(t=>{var n;let{group:r,elementId:o,time:i,onUpdate:a,enabled:l}=t;const[d,u]=(0,e.useState)(!0),p=null===r||void 0===r||null===(n=r.elements)||void 0===n?void 0:n[o],h=(e,t)=>{const n=BB(p,e,i);return null!==n?n:t},f=h("opacity",1),g=h("visible",!0),m=h("x",0),v=h("y",0),y=h("rotate",0),x=h("scaleX",1),b=h("scaleY",1),w=(e,t)=>{let n=0;["scaleX","scaleY","opacity"].includes(e)&&(n=1),"visible"===e&&(n=!0);let s=NB(r,o,e,n);s=LB(s,o,e,i,t),a(s)},S=l?{}:{opacity:.4,pointerEvents:"none",filter:"grayscale(1)"},k={background:"#111",border:"1px solid #444",color:"#fff",fontSize:"11px",padding:"2px",width:"100%",textAlign:"center",borderRadius:3},C={fontSize:"9px",color:"#888",marginBottom:2,display:"block"},j={flex:1,display:"flex",flexDirection:"column",gap:2};return(0,c.jsxs)("div",{style:s({background:"#2a2a2a",borderRadius:6,marginBottom:15,border:"1px solid #444",overflow:"hidden"},S),children:[(0,c.jsxs)("div",{onClick:()=>u(!d),style:{fontSize:"12px",fontWeight:"bold",color:"#fff",padding:"8px 10px",borderBottom:d?"none":"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",background:"#333",userSelect:"none"},children:[(0,c.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,c.jsx)("span",{style:{fontSize:10,color:"#aaa"},children:d?"\u25b6":"\u25bc"}),"\ud83d\udcd0 \u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"]}),(0,c.jsxs)("label",{onClick:e=>e.stopPropagation(),style:{display:"flex",alignItems:"center",gap:5,cursor:"pointer",fontSize:"11px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!g,onChange:e=>w("visible",e.target.checked)}),g?"Visible":"Hidden"]})]}),!d&&(0,c.jsxs)("div",{style:{padding:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,c.jsxs)("div",{style:j,children:[(0,c.jsx)("span",{style:C,children:"X"}),(0,c.jsx)("input",{type:"number",value:Math.round(m),onChange:e=>w("x",parseFloat(e.target.value)),style:k})]}),(0,c.jsxs)("div",{style:j,children:[(0,c.jsx)("span",{style:C,children:"Y"}),(0,c.jsx)("input",{type:"number",value:Math.round(v),onChange:e=>w("y",parseFloat(e.target.value)),style:k})]}),(0,c.jsxs)("div",{style:j,children:[(0,c.jsx)("span",{style:C,children:"Rotate"}),(0,c.jsx)("input",{type:"number",value:Math.round(y),onChange:e=>w("rotate",parseFloat(e.target.value)),style:k})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,c.jsxs)("div",{style:j,children:[(0,c.jsx)("span",{style:C,children:"Scale X"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:x.toFixed(2),onChange:e=>w("scaleX",parseFloat(e.target.value)),style:k})]}),(0,c.jsxs)("div",{style:j,children:[(0,c.jsx)("span",{style:C,children:"Scale Y"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:b.toFixed(2),onChange:e=>w("scaleY",parseFloat(e.target.value)),style:k})]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:5,background:"#222",padding:"4px 8px",borderRadius:4},children:[(0,c.jsx)("span",{style:{fontSize:9,color:"#aaa",minWidth:40},children:"Opacity:"}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",value:Math.round(100*f),onChange:e=>w("opacity",parseFloat(e.target.value)/100),style:{flex:1,height:4,cursor:"pointer"}}),(0,c.jsxs)("span",{style:{fontSize:9,color:"#fff",width:25,textAlign:"right"},children:[Math.round(100*f),"%"]})]})]})]})}),oK=e.memo(e=>{let{group:t,onUpdate:n,layers:r}=e;const o=s({enabled:!1,layers:[],type:"hard",stepDuration:2,smoothness:.5,multipliers:{},onlyWhenTyping:!1},t.layerAnimation||{}),i=(e,r)=>{n(s(s({},t),{},{layerAnimation:s(s({},o),{},{[e]:r})}))},a=(e,t)=>{const n=[...o.layers||[]];-1===t&&e>0?[n[e-1],n[e]]=[n[e],n[e-1]]:1===t&&e<n.length-1&&([n[e+1],n[e]]=[n[e],n[e+1]]),i("layers",n)},l="#7568ed",d={width:"100%",padding:"10px",background:l,color:"#fff",fontWeight:"bold",border:"1px solid #7b1fa2",borderRadius:4,cursor:"pointer",fontSize:12,marginBottom:15,display:"flex",alignItems:"center",justifyContent:"center",gap:8};return o.enabled?(0,c.jsxs)("div",{style:{background:"#222",border:"1px solid ".concat(l),borderRadius:6,padding:10,marginBottom:15},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,borderBottom:"1px solid #444",paddingBottom:8},children:[(0,c.jsxs)("span",{style:{color:l,fontWeight:"bold",fontSize:13,display:"flex",alignItems:"center"},children:["\ud83d\udd04 \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u0441\u043b\u043e\u044f\u043c",(0,c.jsx)(PE,{text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u043e\u043a\u0430\u0434\u0440\u043e\u0432\u043e\u0439 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 \u043f\u0443\u0442\u0451\u043c \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0451\u0432. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u044d\u0444\u0444\u0435\u043a\u0442\u0430 \u0440\u0435\u0447\u0438 (Lip Sync), \u043c\u043e\u0440\u0433\u0430\u043d\u0438\u044f \u0438\u043b\u0438 \u0441\u043c\u0435\u043d\u044b \u044d\u043c\u043e\u0446\u0438\u0439."})]}),(0,c.jsx)("button",{onClick:()=>i("enabled",!1),style:{background:"transparent",border:"none",color:"#f44336",cursor:"pointer",fontSize:16},children:"\u2715"})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:10},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:{fontSize:10,color:"#aaa",display:"block"},children:"\u0411\u0430\u0437\u0430 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"number",step:"0.1",min:"0.1",value:o.stepDuration,onChange:e=>i("stepDuration",parseFloat(e.target.value)),style:{width:"100%",background:"#111",border:"1px solid #444",color:"#fff",padding:4,borderRadius:3}})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:{fontSize:10,color:"#aaa",display:"block"},children:"\u0420\u0435\u0436\u0438\u043c"}),(0,c.jsxs)("select",{value:o.type,onChange:e=>i("type",e.target.value),style:{width:"100%",background:"#111",border:"1px solid #444",color:"#fff",padding:4,borderRadius:3},children:[(0,c.jsx)("option",{value:"hard",children:"\u0416\u0451\u0441\u0442\u043a\u043e"}),(0,c.jsx)("option",{value:"soft",children:"\u041f\u043b\u0430\u0432\u043d\u043e"})]})]})]}),(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:11,color:"#ccc",marginBottom:10,cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:o.onlyWhenTyping||!1,onChange:e=>i("onlyWhenTyping",e.target.checked)}),"\u0422\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u043d\u0430\u0431\u043e\u0440\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 (Lip Sync)"]}),"soft"===o.type&&(0,c.jsxs)("div",{style:{marginBottom:12,background:"#1a1a1a",padding:6,borderRadius:4},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"#ccc"},children:[(0,c.jsx)("span",{children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430"}),(0,c.jsxs)("span",{children:[Math.round(100*o.smoothness),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"1",max:"100",step:"1",value:Math.round(100*o.smoothness),onChange:e=>i("smoothness",parseFloat(e.target.value)/100),style:{width:"100%",height:4,cursor:"pointer",accentColor:l}})]}),(0,c.jsxs)("div",{style:{marginBottom:8},children:[(0,c.jsxs)("span",{style:{fontSize:11,color:"#ddd",fontWeight:"bold"},children:["\u041e\u0447\u0435\u0440\u0435\u0434\u044c \u0441\u043b\u043e\u0435\u0432 (",o.layers.length,"):"]}),(0,c.jsx)("div",{style:{marginTop:5,display:"flex",flexDirection:"column",gap:6},children:o.layers.map((e,t)=>{var n,d;const u=(null===(n=r.find(t=>t.id===e))||void 0===n?void 0:n.name)||"\u0421\u043b\u043e\u0439",p=(null===(d=o.multipliers)||void 0===d?void 0:d[e])||1,h=(o.stepDuration*p).toFixed(1);return(0,c.jsxs)("div",{style:{background:"#333",padding:"6px",borderRadius:4,border:"1px solid #555"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[(0,c.jsxs)("span",{style:{fontSize:11,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:100},children:["#",t+1," ",u]}),(0,c.jsxs)("div",{style:{display:"flex",gap:2},children:[(0,c.jsx)("button",{onClick:()=>a(t,-1),disabled:0===t,style:{cursor:"pointer",fontSize:10,padding:"1px 5px",background:"#444",border:"none",color:"#fff",borderRadius:2},children:"\u2191"}),(0,c.jsx)("button",{onClick:()=>a(t,1),disabled:t===o.layers.length-1,style:{cursor:"pointer",fontSize:10,padding:"1px 5px",background:"#444",border:"none",color:"#fff",borderRadius:2},children:"\u2193"}),(0,c.jsx)("button",{onClick:()=>(e=>{const t=[...o.layers||[]];t.splice(e,1),i("layers",t)})(t),style:{cursor:"pointer",fontSize:12,padding:"0 5px",background:"transparent",border:"none",color:"#ff6b6b"},children:"\xd7"})]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsxs)("span",{style:{fontSize:9,color:"#aaa",minWidth:20},children:["x",p.toFixed(1)]}),(0,c.jsx)("input",{type:"range",min:"0.3",max:"3.0",step:"0.1",value:p,onChange:t=>((e,t)=>{const n=s({},o.multipliers||{});n[e]=parseFloat(t),i("multipliers",n)})(e,t.target.value),style:{flex:1,height:2,accentColor:l,cursor:"ew-resize"},title:"\u041c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u0438: x".concat(p)}),(0,c.jsxs)("span",{style:{fontSize:9,color:l,minWidth:30,textAlign:"right"},children:[h,"s"]})]})]},t)})})]}),(0,c.jsxs)("select",{value:"",onChange:e=>(e=>{const t=o.layers||[];t.includes(e)||i("layers",[...t,e])})(e.target.value),style:{width:"100%",background:"#28a745",border:"none",color:"#fff",padding:"6px",borderRadius:4,cursor:"pointer",fontSize:11,fontWeight:"bold",marginTop:5},children:[(0,c.jsx)("option",{value:"",children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439 \u0432 \u0446\u0438\u043a\u043b"}),r.filter(e=>!o.layers.includes(e.id)&&"folder"!==e.type).map(e=>{const t=e.name||"",n=t.length>20?t.substring(0,20)+"...":t;return(0,c.jsx)("option",{value:e.id,children:n},e.id)})]})]}):(0,c.jsx)("div",{style:{marginBottom:15},children:(0,c.jsxs)("button",{onClick:()=>i("enabled",!0),style:d,children:[(0,c.jsx)("span",{children:"\ud83d\udd04"})," \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0441\u043c\u0435\u043d\u044b \u0441\u043b\u043e\u0451\u0432"]})})}),iK=e.memo(e=>{var t,n;let{config:r,onChange:o,enabled:i}=e;const a=r||{easing:"linear",easingStrength:2,effect:"none",intensity:5,speed:5,phase:0},l={marginBottom:8,display:"flex",alignItems:"center",justifyContent:"space-between"},d={color:"#aaa",fontSize:"11px",marginRight:10,minWidth:60},u={background:"#111",border:"1px solid #444",color:"#fff",fontSize:"11px",padding:"2px 5px",borderRadius:3,flex:1},p={background:"#111",border:"1px solid #444",color:"#fff",fontSize:"11px",padding:"2px 5px",width:45,borderRadius:3},h=(e,t)=>{o(s(s({},a),{},{[e]:t}))},f=i?{}:{opacity:.4,pointerEvents:"none",filter:"grayscale(1)"};return(0,c.jsxs)("div",{style:s({background:"#2a2a2a",padding:"10px",borderRadius:6,marginBottom:15,border:"1px solid #444"},f),children:[(0,c.jsx)("div",{style:{fontSize:"12px",fontWeight:"bold",color:"#fff",marginBottom:8,borderBottom:"1px solid #444",paddingBottom:4},children:"\u26a1 \u042d\u0444\u0444\u0435\u043a\u0442\u044b \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("div",{style:l,children:[(0,c.jsx)("span",{style:d,children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0441\u0442\u044c:"}),(0,c.jsxs)("select",{value:a.easing,onChange:e=>h("easing",e.target.value),style:u,children:[(0,c.jsx)("option",{value:"linear",children:"\u041b\u0438\u043d\u0435\u0439\u043d\u043e (Linear)"}),(0,c.jsx)("option",{value:"easeInOut",children:"\u041c\u044f\u0433\u043a\u043e (Ease In-Out)"}),(0,c.jsx)("option",{value:"easeOutBack",children:"\u0412\u044b\u0441\u0442\u0440\u0435\u043b (Back)"}),(0,c.jsx)("option",{value:"elastic",children:"\u041f\u0440\u0443\u0436\u0438\u043d\u0430 (Elastic)"}),(0,c.jsx)("option",{value:"bounce",children:"\u041e\u0442\u0441\u043a\u043e\u043a (Bounce)"})]})]}),"easeInOut"===a.easing&&(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:5,marginTop:-4,marginBottom:8,padding:"4px 8px",background:"#222",borderRadius:4},children:[(0,c.jsx)("span",{style:{fontSize:9,color:"#4caf50",minWidth:50},children:"\u0421\u0438\u043b\u0430:"}),(0,c.jsx)("input",{type:"range",min:"1.1",max:"15.0",step:"0.1",value:a.easingStrength||2,onChange:e=>h("easingStrength",parseFloat(e.target.value)),style:{flex:1,height:4,cursor:"pointer"}}),(0,c.jsx)("span",{style:{fontSize:9,color:"#fff",width:20,textAlign:"right"},children:(null===(t=a.easingStrength)||void 0===t?void 0:t.toFixed(1))||"2.0"})]}),(0,c.jsxs)("div",{style:l,children:[(0,c.jsx)("span",{style:d,children:"\u042d\u0444\u0444\u0435\u043a\u0442:"}),(0,c.jsxs)("select",{value:a.effect,onChange:e=>h("effect",e.target.value),style:u,children:[(0,c.jsx)("option",{value:"none",children:"\u041d\u0435\u0442"}),(0,c.jsxs)("optgroup",{label:"\u0418\u0441\u043a\u0430\u0436\u0435\u043d\u0438\u044f",children:[(0,c.jsx)("option",{value:"shake",children:"\u0422\u0440\u044f\u0441\u043a\u0430 (Shake)"}),(0,c.jsx)("option",{value:"glitch",children:"\u0413\u043b\u0438\u0442\u0447 (Glitch) \u2728"}),(0,c.jsx)("option",{value:"wiggle",children:"\u041f\u043e\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 (Wiggle)"}),(0,c.jsx)("option",{value:"flicker",children:"\u041c\u0435\u0440\u0446\u0430\u043d\u0438\u0435 (Flicker) \ud83d\udca1"})]}),(0,c.jsxs)("optgroup",{label:"\u0416\u0435\u043b\u0435 \u0438 \u0421\u0436\u0430\u0442\u0438\u0435",children:[(0,c.jsx)("option",{value:"jelly",children:"\u0416\u0435\u043b\u0435: \u0426\u0435\u043d\u0442\u0440 (Jelly)"}),(0,c.jsx)("option",{value:"jelly-bottom",children:"\u0416\u0435\u043b\u0435: \u041d\u0438\u0437 \u0444\u0438\u043a\u0441 (Bottom) \ud83c\udf6c"}),(0,c.jsx)("option",{value:"jelly-top",children:"\u0416\u0435\u043b\u0435: \u0412\u0435\u0440\u0445 \u0444\u0438\u043a\u0441 (Top)"}),(0,c.jsx)("option",{value:"pulse",children:"\u041f\u0443\u043b\u044c\u0441 (Pulse)"}),(0,c.jsx)("option",{value:"heartbeat",children:"\u0421\u0435\u0440\u0434\u0446\u0435\u0431\u0438\u0435\u043d\u0438\u0435 (Heartbeat) \u2764\ufe0f"})]}),(0,c.jsxs)("optgroup",{label:"\u0414\u0432\u0438\u0436\u0435\u043d\u0438\u0435",children:[(0,c.jsx)("option",{value:"float",children:"\u041f\u0430\u0440\u0435\u043d\u0438\u0435 (Float) \u2728"}),(0,c.jsx)("option",{value:"swing",children:"\u041c\u0430\u044f\u0442\u043d\u0438\u043a (Swing) \ud83d\udd70\ufe0f"}),(0,c.jsx)("option",{value:"spin",children:"\u0412\u0440\u0430\u0449\u0435\u043d\u0438\u0435 (Spin)"})]})]})]}),"none"!==a.effect&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8,marginTop:8,background:"#222",padding:5,borderRadius:4},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"space-between"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[(0,c.jsx)("span",{style:{fontSize:9,color:"#777"},children:"\u0421\u0438\u043b\u0430"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:a.intensity,onChange:e=>h("intensity",parseFloat(e.target.value)),style:p})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[(0,c.jsx)("span",{style:{fontSize:9,color:"#777"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:a.speed,onChange:e=>h("speed",parseFloat(e.target.value)),style:p})]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:5},children:[(0,c.jsx)("span",{style:{fontSize:9,color:"#9d9dff",minWidth:30},children:"\u0424\u0430\u0437\u0430:"}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.1",value:a.phase||0,onChange:e=>h("phase",parseFloat(e.target.value)),style:{flex:1,height:4}}),(0,c.jsx)("span",{style:{fontSize:9,color:"#fff",width:20,textAlign:"right"},children:(null===(n=a.phase)||void 0===n?void 0:n.toFixed(1))||0})]})]})]})}),aK=e.memo(t=>{var n;let{group:r,elementId:o,time:i,onUpdate:a,enabled:l}=t;const[d,u]=(0,e.useState)(!0),p=null===r||void 0===r||null===(n=r.elements)||void 0===n?void 0:n[o],h=(e,t)=>{const n=BB(p,e,i);return null!==n?n:t},f=h("brightness",1),g=h("contrast",1),m=h("saturate",1),v=h("blur",0),y=h("hueRotate",0),x=h("grayscale",0),b=h("sepia",0),w=(e,t)=>{let n=0;["brightness","contrast","saturate"].includes(e)&&(n=1);let s=NB(r,o,e,n);s=LB(s,o,e,i,t),a(s)},S=l?{}:{opacity:.4,pointerEvents:"none",filter:"grayscale(1)"};return(0,c.jsxs)("div",{style:s({background:"#2a2a2a",borderRadius:6,marginBottom:15,border:"1px solid #444",overflow:"hidden"},S),children:[(0,c.jsxs)("div",{onClick:()=>u(!d),style:{fontSize:"12px",fontWeight:"bold",color:"#fff",padding:"8px 10px",borderBottom:d?"none":"1px solid #444",display:"flex",alignItems:"center",gap:6,cursor:"pointer",background:"#333",userSelect:"none"},children:[(0,c.jsx)("span",{style:{fontSize:10,color:"#aaa"},children:d?"\u25b6":"\u25bc"}),"\ud83c\udfa8 \u0426\u0432\u0435\u0442\u043e\u043a\u043e\u0440\u0440\u0435\u043a\u0446\u0438\u044f \u0438 \u0424\u0438\u043b\u044c\u0442\u0440\u044b"]}),!d&&(0,c.jsxs)("div",{style:{padding:"10px"},children:[(0,c.jsx)(nK,{label:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c",val:f,min:0,max:3,step:.05,param:"brightness",def:1,onChange:w}),(0,c.jsx)(nK,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442",val:g,min:0,max:3,step:.05,param:"contrast",def:1,onChange:w}),(0,c.jsx)(nK,{label:"\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0441\u0442\u044c",val:m,min:0,max:3,step:.05,param:"saturate",def:1,onChange:w}),(0,c.jsx)(nK,{label:"\u041e\u0442\u0442\u0435\u043d\u043e\u043a (Hue)",val:y,min:0,max:360,step:1,param:"hueRotate",def:0,onChange:w}),(0,c.jsx)(nK,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 (Blur)",val:v,min:0,max:20,step:.5,param:"blur",def:0,onChange:w}),(0,c.jsxs)("div",{style:{display:"flex",gap:10,marginTop:5},children:[(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(nK,{label:"\u0427/\u0411",val:x,min:0,max:1,step:.05,param:"grayscale",def:0,onChange:w})}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(nK,{label:"\u0421\u0435\u043f\u0438\u044f",val:b,min:0,max:1,step:.05,param:"sepia",def:0,onChange:w})})]})]})]})}),sK=t=>{var n;let{data:r,onUpdate:o,currentTime:i,onTimeChange:a,selectedElementId:l,layers:d=[],showTrajectories:u,setShowTrajectories:p,textEvents:h=[]}=t;const f=UB(r),{groups:g,activeGroupId:m}=f,[v,y]=(0,e.useState)(0),x=l?VB(g,m,l):null,[b,w]=(0,e.useState)(null),[S,k]=(0,e.useState)(!1),C=e=>{if(!l)return;const t=g.map(t=>{if(t.id===m){const n=s(s({},t),{},{elements:s({},t.elements)});return n.elements[l]||(n.elements[l]={}),n.elements[l]=s(s({},n.elements[l]),{},{_config:e}),n}return t});o(s(s({},f),{},{groups:t}))},j=g.find(e=>e.id===m),_=j&&l?null===(n=j.elements)||void 0===n?void 0:n[l]:null,E=null===_||void 0===_?void 0:_._config,D=(null===j||void 0===j?void 0:j.enabled)||!1,M=(e,t)=>{const n=g.map(n=>n.id===e?t:n);o(s(s({},f),{},{groups:n}))};return(0,c.jsxs)("div",{style:{width:"100%",fontFamily:"sans-serif"},children:[(0,c.jsxs)("div",{style:{padding:"0 0 10px 0",borderBottom:"1px solid #333",marginBottom:"10px"},children:[(0,c.jsxs)("label",{style:{cursor:"pointer",display:"flex",alignItems:"center",fontSize:"13px",color:"#ddd"},children:[(0,c.jsx)("input",{type:"checkbox",checked:u,onChange:e=>p(e.target.checked),style:{marginRight:8}}),"\ud83d\udc41 \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0440\u0430\u0435\u043a\u0442\u043e\u0440\u0438\u0438"]}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#777",marginTop:4,marginLeft:24},children:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043f\u0443\u0442\u044c \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0435\u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b. \u041a\u043b\u0438\u043a \u043f\u043e \u0443\u0437\u043b\u0443 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442 \u0432\u0440\u0435\u043c\u044f."})]}),(0,c.jsxs)("div",{style:{marginBottom:10,display:"flex",flexDirection:"column",gap:8},children:[g.map(e=>{const t=e.id===m,n=e.id===b;let r="#222";return t?r="#333":n&&(r="#2a2a2a"),(0,c.jsxs)("div",{style:{border:t?"1px solid #666":"1px solid #333",borderRadius:6,overflow:"hidden"},children:[(0,c.jsxs)("div",{onClick:()=>(e=>{const t=m===e?null:e;o(s(s({},f),{},{activeGroupId:t})),t&&a(0)})(e.id),onMouseEnter:()=>w(e.id),onMouseLeave:()=>w(null),style:{padding:"12px 15px",background:r,cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",color:t?"#fff":"#bbb",userSelect:"none",transition:"background 0.2s"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:t?600:400},children:[(0,c.jsx)("span",{style:{fontSize:10,opacity:.7},children:t?"\u25bc":"\u25b6"}),(0,c.jsx)("span",{children:e.name}),"click"===e.trigger&&(0,c.jsx)("span",{style:{fontSize:9,background:"#2196f3",color:"#fff",padding:"2px 5px",borderRadius:3,marginLeft:5},children:"CLICK"})]}),t&&(0,c.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,c.jsx)("button",{onClick:t=>{t.stopPropagation(),((e,t)=>{const n=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u043e\u0435 \u0438\u043c\u044f \u0433\u0440\u0443\u043f\u043f\u044b:",t);n&&M(e,s(s({},g.find(t=>t.id===e)),{},{name:n}))})(e.id,e.name)},style:{fontSize:14,cursor:"pointer",background:"none",border:"none",color:"#bbb"},children:"\u270e"}),"main"!==e.id&&(0,c.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{if(!window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0433\u0440\u0443\u043f\u043f\u0443 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438?"))return;const t=g.filter(t=>t.id!==e);let n=m;m===e&&(n=t.length>0?t[0].id:null),0===t.length&&(t.push({id:"main",name:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f",enabled:!1,duration:30,trigger:"start",elements:{}}),n="main"),o(s(s({},f),{},{groups:t,activeGroupId:n}))})(e.id)},style:{fontSize:14,cursor:"pointer",color:"#f44336",background:"none",border:"none"},children:"\u2715"})]})]}),t&&(0,c.jsxs)("div",{style:{padding:"10px 15px",background:"#282828",borderBottom:"1px dashed #444",display:"flex",alignItems:"center",gap:"20px"},children:[(0,c.jsxs)("label",{style:{cursor:"pointer",display:"flex",alignItems:"center",fontWeight:"bold",fontSize:"13px",color:e.enabled?"#4caf50":"#888"},children:[(0,c.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>M(e.id,s(s({},e),{},{enabled:t.target.checked})),style:{marginRight:8,width:16,height:16,cursor:"pointer"}}),"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044e"]}),(0,c.jsxs)("label",{style:{cursor:"pointer",display:"flex",alignItems:"center",fontSize:"13px",color:e.enabled?"#ddd":"#666",pointerEvents:e.enabled?"auto":"none"},children:[(0,c.jsx)("input",{type:"checkbox",checked:e.loop||!1,onChange:t=>M(e.id,s(s({},e),{},{loop:t.target.checked})),style:{marginRight:8,width:16,height:16,cursor:"pointer"}}),"\u0417\u0430\u0446\u0438\u043a\u043b\u0438\u0442\u044c"]})]}),t&&(0,c.jsx)("div",{style:{padding:"0 15px"},children:(0,c.jsx)(oK,{group:e,onUpdate:t=>M(e.id,t),layers:d})}),t&&l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(iK,{config:E,onChange:C,enabled:D}),(0,c.jsx)(rK,{group:e,elementId:l,time:i,onUpdate:t=>M(e.id,t),enabled:D}),(0,c.jsx)(aK,{group:e,elementId:l,time:i,onUpdate:t=>M(e.id,t),enabled:D})]}),t&&(0,c.jsxs)("div",{style:{padding:"15px",background:"#222",borderTop:"1px solid #444",marginTop:"10px"},children:[(0,c.jsx)(eK,{duration:e.duration,onDurationChange:t=>M(e.id,s(s({},e),{},{duration:t})),trigger:e.trigger,onTriggerChange:t=>M(e.id,s(s({},e),{},{trigger:t})),triggerLayerId:e.triggerLayerId,onTriggerLayerIdChange:t=>M(e.id,s(s({},e),{},{triggerLayerId:t})),snapStep:v,setSnapStep:y,layers:d,textEvents:h,isEnabled:e.enabled,isBlocked:!!x,onAddEvent:()=>{const t=e.events||[],n={id:"evt_"+Date.now(),name:"event".concat(t.length+1),time:i};M(e.id,s(s({},e),{},{events:[...t,n]}))}}),(0,c.jsx)(tK,{data:e,onUpdateData:t=>M(e.id,t),currentTime:i,onTimeChange:a,selectedElementId:l,isEnabled:e.enabled,blockingMessage:x?'\u0421\u043b\u043e\u0439 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d \u0433\u0440\u0443\u043f\u043f\u043e\u0439 "'.concat(x,'"'):null,snapStep:v})]})]},e.id)}),(0,c.jsx)("button",{onClick:()=>{const e={id:"group_"+Date.now(),name:"\u0413\u0440\u0443\u043f\u043f\u0430 ".concat(g.length+1),enabled:!0,duration:5,trigger:"start",triggerLayerId:"",elements:{}},t=s(s({},f),{},{groups:[...g,e],activeGroupId:e.id});o(t),a(0)},onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),style:{padding:"12px",background:S?"rgba(40, 167, 69, 0.2)":"#1a1a1a",border:S?"1px dashed #28a745":"1px dashed #444",color:S?"#fff":"#777",cursor:"pointer",borderRadius:6,marginTop:10,userSelect:"none",transition:"all 0.2s ease",fontWeight:"500"},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0439"})]})]})},lK=e=>{let{data:t,layers:n,onUpdate:r,isGlobal:o}=e;const i=t||{},a=(e,t)=>{r(s(s({},i),{},{[e]:t}))},l={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",minWidth:"240px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},sectionHeader:{fontSize:"11px",fontWeight:"bold",color:"#7568ed",textTransform:"uppercase",letterSpacing:"0.5px",marginTop:"4px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"10px"},label:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",height:"32px",boxSizing:"border-box",outline:"none"},checkbox:{cursor:"pointer",accentColor:"#7568ed",width:"16px",height:"16px"},divider:{border:0,borderTop:"1px solid #333",margin:"0"},sliderContainer:{display:"flex",alignItems:"center",gap:"10px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"}};return(0,c.jsxs)("div",{style:l.panel,children:[(0,c.jsxs)("div",{style:l.header,children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:"\ud83c\udfac"}),(0,c.jsx)("span",{children:"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430"}),(0,c.jsx)("span",{style:{fontSize:"11px",color:o?"#4caf50":"#7568ed",marginLeft:"auto",background:"rgba(255,255,255,0.05)",padding:"2px 6px",borderRadius:"4px"},children:o?"Global":"Local"})]}),(0,c.jsxs)("div",{style:l.rowHorizontal,children:[(0,c.jsx)("span",{style:{fontSize:"13px",fontWeight:"500"},children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044e"}),(0,c.jsx)("input",{type:"checkbox",style:l.checkbox,checked:i.enabled||!1,onChange:e=>a("enabled",e.target.checked)})]}),i.enabled&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("hr",{style:l.divider}),(0,c.jsxs)("div",{style:l.row,children:[(0,c.jsx)("label",{style:l.label,children:"\u042d\u0444\u0444\u0435\u043a\u0442 \u0438 \u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("select",{style:l.input,value:i.type||"typewriter",onChange:e=>a("type",e.target.value),children:[(0,c.jsx)("option",{value:"typewriter",children:"\u041f\u0435\u0447\u0430\u0442\u043d\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u043a\u0430 (Typewriter)"}),(0,c.jsx)("option",{value:"fade",children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0435 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 (Fade In)"})]}),(0,c.jsxs)("div",{style:s(s({},l.sliderContainer),{},{marginTop:"4px"}),children:[(0,c.jsx)("span",{style:{color:"#888",fontSize:"10px",width:"30px"},children:"Speed"}),(0,c.jsx)("input",{type:"range",min:"5",max:"200",step:"5",style:l.rangeInput,value:i.speed||30,onChange:e=>a("speed",parseInt(e.target.value))}),(0,c.jsxs)("span",{style:{color:"#fff",fontSize:"11px",width:"25px",textAlign:"right"},children:[i.speed||30,"ms"]})]})]}),"typewriter"===(i.type||"typewriter")&&(0,c.jsxs)("div",{style:s(s({},l.row),{},{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"6px",border:"1px solid #333"}),children:[(0,c.jsxs)("div",{style:l.rowHorizontal,children:[(0,c.jsx)("label",{style:s(s({},l.label),{},{margin:0}),children:"\u041a\u0443\u0440\u0441\u043e\u0440"}),(0,c.jsx)("input",{type:"checkbox",style:l.checkbox,checked:i.cursor_enabled||!1,onChange:e=>a("cursor_enabled",e.target.checked)})]}),i.cursor_enabled&&(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"10px",marginTop:"5px"},children:[(0,c.jsx)("select",{style:s(s({},l.input),{},{fontSize:"12px",height:"28px",padding:"2px 8px"}),value:i.cursor_char||"_",onChange:e=>a("cursor_char",e.target.value),children:[{label:"_ (\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442)",value:"_"},{label:"\u2581 (\u0411\u043b\u043e\u043a \u0441 \u0432\u043e\u0437\u0434\u0443\u0445\u043e\u043c)",value:"\u2581"},{label:"\u258d (\u0412\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439)",value:"\u258d"},{label:"\u2584 (\u041d\u0438\u0436\u043d\u0438\u0439 \u0431\u043b\u043e\u043a)",value:"\u2584"},{label:"\u2588 (\u041f\u043e\u043b\u043d\u044b\u0439 \u0431\u043b\u043e\u043a)",value:"\u2588"},{label:"| (\u0422\u043e\u043d\u043a\u0430\u044f \u043f\u0430\u043b\u043a\u0430)",value:"|"}].map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},title:"\u041c\u0438\u0433\u0430\u043d\u0438\u0435",children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",cursor:"pointer"},htmlFor:"blink_chk",children:"Blink"}),(0,c.jsx)("input",{id:"blink_chk",type:"checkbox",style:l.checkbox,checked:!1!==i.cursor_blink,onChange:e=>a("cursor_blink",e.target.checked)})]})]})]}),(0,c.jsx)("hr",{style:l.divider}),(0,c.jsx)("div",{style:l.sectionHeader,children:"\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"}),(0,c.jsxs)("div",{style:l.row,children:[(0,c.jsx)("label",{style:l.label,children:"\u0420\u0435\u0436\u0438\u043c \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430 (Skip)"}),(0,c.jsxs)("select",{style:l.input,value:i.skip_mode||"click_anywhere",onChange:e=>a("skip_mode",e.target.value),children:[(0,c.jsx)("option",{value:"none",children:"\u26d4 \u041d\u0435\u043b\u044c\u0437\u044f \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"click_anywhere",children:"\ud83d\uddb1\ufe0f \u041a\u043b\u0438\u043a \u0432\u0435\u0437\u0434\u0435"}),!o&&(0,c.jsx)("option",{value:"click_layer",children:"\ud83c\udfaf \u041a\u043b\u0438\u043a \u043f\u043e \u0441\u043b\u043e\u044e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"}),(0,c.jsx)("option",{value:"click_button",children:"\ud83d\udd18 \u0421\u043a\u0438\u043f \u043b\u044e\u0431\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439"})]})]}),"click_layer"===i.skip_mode&&!o&&(0,c.jsxs)("div",{style:l.row,children:[(0,c.jsx)("label",{style:l.label,children:"\u0421\u043b\u043e\u0439-\u0442\u0440\u0438\u0433\u0433\u0435\u0440"}),(0,c.jsxs)("select",{style:l.input,value:i.trigger_layer_id||"",onChange:e=>a("trigger_layer_id",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0439 --"}),n&&n.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]})]}),(0,c.jsxs)("div",{style:l.rowHorizontal,children:[(0,c.jsx)("span",{style:{fontSize:"12px",color:"#ddd"},children:"\u0411\u043b\u043e\u043a. \u0432\u044b\u0431\u043e\u0440\u044b \u0434\u043e \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430"}),(0,c.jsx)("input",{type:"checkbox",style:l.checkbox,checked:i.block_choices||!1,onChange:e=>a("block_choices",e.target.checked)})]}),(0,c.jsx)("hr",{style:l.divider}),(0,c.jsxs)("div",{style:l.sectionHeader,children:["\u041b\u043e\u0433\u0438\u043a\u0430 \u0442\u0435\u0433\u043e\u0432 [[+N / -N)]]",(0,c.jsx)(PE,{text:"\u044d\u0442\u0430 \u043b\u043e\u0433\u0438\u043a\u0430 \u043d\u0443\u0436\u043d\u0430 \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0442\u0435\u043a\u0441\u0442\u0430 \u0432 \u0431\u043e\u043a\u0441\u0435 \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0430 \u0438\u043d\u043e\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442. \u0422\u044d\u0433\u0438 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435 \u043f\u0440\u0438 \u0432\u0432\u043e\u0434\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430, \u0442\u0430\u043c \u0436\u0435 \u0435\u0441\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,c.jsxs)("div",{style:l.row,children:[(0,c.jsx)("label",{style:l.label,children:"\u041f\u0430\u0443\u0437\u0430 (+N)"}),(0,c.jsxs)("select",{style:l.input,value:i.pause_behavior||"timer",onChange:e=>a("pause_behavior",e.target.value),children:[(0,c.jsx)("option",{value:"timer",children:"\u0422\u0430\u0439\u043c\u0435\u0440"}),(0,c.jsx)("option",{value:"click",children:"\u0416\u0434\u0430\u0442\u044c \u043a\u043b\u0438\u043a"})]})]}),(0,c.jsxs)("div",{style:l.row,children:[(0,c.jsx)("label",{style:l.label,children:"\u041e\u0447\u0438\u0441\u0442\u043a\u0430 (-N)"}),(0,c.jsxs)("select",{style:l.input,value:i.clear_behavior||"timer",onChange:e=>a("clear_behavior",e.target.value),children:[(0,c.jsx)("option",{value:"timer",children:"\u0422\u0430\u0439\u043c\u0435\u0440"}),(0,c.jsx)("option",{value:"click",children:"\u0416\u0434\u0430\u0442\u044c \u043a\u043b\u0438\u043a"})]})]})]})]})]})},cK={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",minWidth:"240px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},row:{display:"flex",flexDirection:"column",gap:"6px"},rowHorizontal:{display:"flex",gap:"10px",alignItems:"flex-end"},label:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",display:"flex",alignItems:"center"},input:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"13px",width:"100%",height:"32px",boxSizing:"border-box",outline:"none"},fileInputLike:{background:"#1e1e1e",border:"1px solid #444",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",width:"100%",height:"32px",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",overflow:"hidden"},divider:{border:0,borderTop:"1px solid #333",margin:"0"},card:{background:"#222",border:"1px solid #333",borderRadius:"6px",padding:"10px",display:"flex",flexDirection:"column",gap:"8px",position:"relative"},scrollBox:{background:"#1a1a1a",border:"1px solid #333",borderRadius:"4px",padding:"4px",maxHeight:"200px",overflowY:"auto"},iconBtn:{background:"transparent",border:"none",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",padding:"4px",borderRadius:"4px"},badge:e=>({fontSize:"11px",color:e?"#4caf50":"#7568ed",marginLeft:"auto",background:"rgba(255,255,255,0.05)",padding:"2px 6px",borderRadius:"4px"}),sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",fontWeight:"600",color:"#ccc",marginTop:"4px"},addBtn:{background:"#7568ed",color:"#fff",border:"none",borderRadius:"3px",padding:"2px 8px",fontSize:"14px",cursor:"pointer",lineHeight:"1"}},dK=(e,t)=>{if(!e)return"";const n=t=>{if(!t)return null;for(const r of t){if(r.local_path===e)return r.name;if(r.files){const e=n(r.files);if(e)return e}}return null};if(t)for(const r of Object.keys(t)){const e=t[r],o=n(e.files);if(o)return o}try{return decodeURIComponent(e.split("/").pop())}catch(M2){return e.split("/").pop()}},uK=e=>{let{track:t,displayName:n,onRemove:r}=e;const{attributes:o,listeners:i,setNodeRef:a,transform:l,transition:d,isDragging:u}=P_({id:t.id}),p={transform:hC.Transform.toString(l),transition:d,opacity:u?.5:1,position:"relative",zIndex:u?999:"auto",marginBottom:"4px",touchAction:"manipulation"};return(0,c.jsx)("div",s(s({ref:a,style:p},o),{},{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",background:u?"#2d2d2d":"#222",padding:"6px 8px",borderRadius:"4px",border:u?"1px solid #7568ed":"1px solid #333"},children:[(0,c.jsx)("div",s(s({},i),{},{style:{cursor:"grab",color:"#666",fontSize:"14px"},title:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u044c",children:"\u2630"})),(0,c.jsx)("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"12px",color:"#ddd"},children:n||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0442\u0440\u0435\u043a"}),(0,c.jsx)("button",{onClick:r,style:s(s({},cK.iconBtn),{},{color:"#ff6b6b"}),title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:"\xd7"})]})}))},pK=t=>{let{scope:n,data:r,assets:o,layers:i,animationEvents:a=[],textEvents:l=[],onUpdate:d}=t;const u=MC(DC(Cj,{activationConstraint:{distance:10}}),DC(_j,{activationConstraint:{delay:250,tolerance:5}})),p="global"===n,h=(e,t)=>d(s(s({},r),{},{[e]:t})),[f,g]=(0,e.useState)({isOpen:!1,target:null,index:null}),m=function(e){g({isOpen:!0,target:e,index:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null})},v=e=>{const t=e.local_path;if(t)switch(f.target){case"playlist":const e=[...r.playlist||[],{src:t,id:Date.now()}];h("playlist",e);break;case"click_sound":h("click_sound",t);break;case"typing_sound":h("typing_sound",t);break;case"music_src":h("music",s(s({},r.music),{},{src:t}));break;case"sfx_src":if(null!==f.index){const e=[...r.sfx||[]];e[f.index]&&(e[f.index]=s(s({},e[f.index]),{},{src:t}),h("sfx",e))}break;case"override":h("click_sound_override",t)}},y=e=>{let{value:t,placeholder:n,onClick:r,onClear:i}=e;const a=dK(t,o)||n;return(0,c.jsxs)("div",{style:cK.fileInputLike,onClick:r,title:t,children:[(0,c.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:t?"#fff":"#666"},children:t?"\ud83c\udfb5 "+a:n}),t?(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},style:{background:"none",border:"none",color:"#888",cursor:"pointer",padding:"0 4px"},children:"\u2715"}):(0,c.jsx)("span",{style:{color:"#666",fontSize:10},children:"\u25bc"})]})},x=i?i.filter(e=>"folder"!==e.type&&"character_folder"!==e.type):[],b=()=>(0,c.jsxs)("div",{style:cK.header,children:[(0,c.jsx)("span",{style:{fontSize:"16px"},children:"\ud83c\udfb5"}),(0,c.jsx)("span",{children:"\u0410\u0443\u0434\u0438\u043e \u0438 \u0417\u0432\u0443\u043a\u0438"}),(0,c.jsx)("span",{style:cK.badge(p),children:p?"Global":"Local"})]});if(p){const e=r.playlist||[],t=r.playlist_mode||"loop",n=t=>{h("playlist",e.filter(e=>e.id!==t))},i=t=>{const{active:n,over:r}=t;if(n.id!==r.id){const t=e.findIndex(e=>e.id===n.id),o=e.findIndex(e=>e.id===r.id),i=[...e],[a]=i.splice(t,1);i.splice(o,0,a),h("playlist",i)}};return(0,c.jsxs)("div",{style:cK.panel,children:[(0,c.jsx)(b,{}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442"}),(0,c.jsx)("button",{onClick:()=>m("playlist"),style:s(s({},cK.input),{},{cursor:"pointer",textAlign:"left",color:"#7568ed"}),children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0440\u0435\u043a..."}),(0,c.jsxs)("div",{style:cK.scrollBox,children:[0===e.length&&(0,c.jsx)("div",{style:{color:"#666",padding:"10px",textAlign:"center",fontSize:"12px",fontStyle:"italic"},children:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442 \u043f\u0443\u0441\u0442"}),(0,c.jsx)(r_,{sensors:u,collisionDetection:FC,onDragEnd:i,children:(0,c.jsx)(T_,{items:e.map(e=>e.id),strategy:E_,children:e.map(e=>(0,c.jsx)(uK,{track:e,displayName:dK(e.src,o),onRemove:()=>n(e.id)},e.id))})})]})]}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0420\u0435\u0436\u0438\u043c \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("select",{style:cK.input,value:t,onChange:e=>h("playlist_mode",e.target.value),children:[(0,c.jsx)("option",{value:"loop",children:"\u041f\u043e \u043a\u0440\u0443\u0433\u0443 (Loop)"}),(0,c.jsx)("option",{value:"shuffle",children:"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e (Shuffle)"})]})]}),(0,c.jsx)("hr",{style:cK.divider}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0417\u0432\u0443\u043a \u043a\u043b\u0438\u043a\u0430 (\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)"}),(0,c.jsx)(y,{value:r.click_sound,placeholder:"-- \u0411\u0435\u0437 \u0437\u0432\u0443\u043a\u0430 --",onClick:()=>m("click_sound"),onClear:()=>h("click_sound","")})]}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0417\u0432\u0443\u043a \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 \u0442\u0435\u043a\u0441\u0442\u0430 (Loop)"}),(0,c.jsx)(y,{value:r.typing_sound,placeholder:"-- \u0411\u0435\u0437 \u0437\u0432\u0443\u043a\u0430 --",onClick:()=>m("typing_sound"),onClear:()=>h("typing_sound","")}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginTop:"2px"},children:"\u0412\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0446\u0438\u043a\u043b\u0438\u0447\u043d\u043e, \u043f\u043e\u043a\u0430 \u0438\u0434\u0435\u0442 \u043d\u0430\u0431\u043e\u0440 \u0442\u0435\u043a\u0441\u0442\u0430."})]}),(0,c.jsx)(UL,{isOpen:f.isOpen,onClose:()=>g(s(s({},f),{},{isOpen:!1})),onSelect:v,assets:o,rootId:"sys_audio",title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u043e\u0444\u0430\u0439\u043b",allowedTypes:["mp3","wav","ogg","m4a"]})]})}const w=r.music||{action:"continue"},S=r.sfx||[],k=r.click_sound_override,C=(e,t)=>h("music",s(s({},w),{},{[e]:t})),j=(e,t,n)=>{const r=[...S];r[e]=s(s({},r[e]),{},{[t]:n}),h("sfx",r)};return(0,c.jsxs)("div",{style:cK.panel,children:[(0,c.jsx)(b,{}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0424\u043e\u043d\u043e\u0432\u0430\u044f \u043c\u0443\u0437\u044b\u043a\u0430"}),(0,c.jsxs)("select",{value:w.action,onChange:e=>C("action",e.target.value),style:cK.input,children:[(0,c.jsx)("option",{value:"continue",children:"\u27a1 \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0443\u044e"}),(0,c.jsx)("option",{value:"play",children:"\u25b6 \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e"}),(0,c.jsx)("option",{value:"stop",children:"\u23f9 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u0443\u0437\u044b\u043a\u0443"})]}),"play"===w.action&&(0,c.jsxs)("div",{style:cK.card,children:[(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u0424\u0430\u0439\u043b \u0442\u0440\u0435\u043a\u0430"}),(0,c.jsx)(y,{value:w.src,placeholder:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0440\u0435\u043a --",onClick:()=>m("music_src"),onClear:()=>C("src","")})]}),(0,c.jsxs)("div",{style:cK.rowHorizontal,children:[(0,c.jsxs)("div",{style:s({flex:1},cK.row),children:[(0,c.jsx)("label",{style:cK.label,children:"Start Delay (s)"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:w.start_delay||0,onChange:e=>C("start_delay",parseFloat(e.target.value)),style:cK.input})]}),(0,c.jsxs)("div",{style:s({flex:1},cK.row),children:[(0,c.jsx)("label",{style:cK.label,children:"On Finish"}),(0,c.jsxs)("select",{value:w.on_finish||"loop",onChange:e=>C("on_finish",e.target.value),style:cK.input,children:[(0,c.jsx)("option",{value:"loop",children:"Loop"}),(0,c.jsx)("option",{value:"stop",children:"Stop"}),(0,c.jsx)("option",{value:"return_global",children:"Global"})]})]})]})]}),"stop"===w.action&&(0,c.jsx)("div",{style:s(s({},cK.card),{},{borderColor:"#f44336"}),children:(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:s(s({},cK.label),{},{color:"#ff6b6b"}),children:"\u0417\u0430\u0442\u0443\u0445\u0430\u043d\u0438\u0435 / \u041f\u0430\u0443\u0437\u0430 (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"number",step:"0.1",value:w.stop_delay||0,onChange:e=>C("stop_delay",parseFloat(e.target.value)),style:cK.input})]})})]}),(0,c.jsx)("hr",{style:cK.divider}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:cK.sectionHeader,children:[(0,c.jsxs)("span",{children:["SFX \u0421\u041b\u041e\u0418 (",S.length,"/5)"]}),(0,c.jsx)(PE,{text:(0,c.jsxs)(c.Fragment,{children:["\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0432\u0443\u043a\u043e\u0432 \u0438\u043b\u0438 \u043c\u0443\u0437\u044b\u043a\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430 \u0434\u0430\u043d\u043d\u043e\u043c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0435 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u044f\u0442\u0441\u044f \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435 \u043d\u0430 \u0438\u043d\u043e\u0439. \u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430:",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Auto Start"})," - \u0441\u0442\u0430\u0440\u0442 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0441\u0446\u0435\u043d\u044b",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Timer"})," - \u043f\u043e \u0442\u0430\u0439\u043c\u0435\u0440\u0443",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Layer Visibility"})," - \u043f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0437\u0432\u0443\u043a \u043a \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u0438 \u0441\u043b\u043e\u044f, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u0438",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Animation Event"})," - \u0441\u0442\u0430\u0440\u0442 \u043f\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044e \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438, \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u0430\u043d\u0435\u043b\u0438 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438"]})}),(0,c.jsx)("button",{onClick:()=>{if(S.length>=5)return alert("\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 5 \u0437\u0432\u0443\u043a\u043e\u0432");const e={id:Date.now(),src:"",trigger:"start",trigger_val:0,stop_trigger:"none",stop_val:0,volume:1};h("sfx",[...S,e])},style:cK.addBtn,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439",children:"+"})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"8px"},children:[S.map((e,t)=>(0,c.jsxs)("div",{style:cK.card,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,c.jsxs)("span",{style:{fontSize:"11px",color:"#7568ed",fontWeight:"bold"},children:["SFX #",t+1]}),(0,c.jsx)("button",{onClick:()=>(e=>{const t=[...S];t.splice(e,1),h("sfx",t)})(t),style:s(s({},cK.iconBtn),{},{color:"#666",height:"16px"}),children:"\xd7"})]}),(0,c.jsx)(y,{value:e.src,placeholder:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0432\u0443\u043a --",onClick:()=>m("sfx_src",t),onClear:()=>j(t,"src","")}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"5px",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:cK.label,children:"\u0413\u0440\u043e\u043c\u043a\u043e\u0441\u0442\u044c"}),(0,c.jsx)("input",{type:"number",min:"0",max:"1",step:"0.1",value:void 0!==e.volume?e.volume:1,onChange:e=>j(t,"volume",parseFloat(e.target.value)),style:cK.input})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingTop:"15px"},children:[(0,c.jsx)("input",{type:"checkbox",id:"sfx_loop_".concat(t),checked:e.loop||!1,onChange:e=>j(t,"loop",e.target.checked),style:{cursor:"pointer"}}),(0,c.jsx)("label",{htmlFor:"sfx_loop_".concat(t),style:s(s({},cK.label),{},{marginLeft:"5px",cursor:"pointer"}),children:"Loop"})]})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"5px"},children:[(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"Start / Trigger"}),(0,c.jsxs)("select",{value:e.trigger,onChange:e=>j(t,"trigger",e.target.value),style:s(s({},cK.input),{},{fontSize:"11px",padding:"0 4px"}),children:[(0,c.jsx)("option",{value:"start",children:"Auto Start"}),(0,c.jsx)("option",{value:"timer",children:"Timer"}),(0,c.jsx)("option",{value:"click_layer",children:"Click Layer"}),(0,c.jsx)("option",{value:"layer_visibility",children:"Layer Visibility"}),(0,c.jsx)("option",{value:"animation_event",children:"Animation Event \ud83d\udccd"}),(0,c.jsx)("option",{value:"text_event",children:"Text Event \ud83d\udcdd"})," "]}),"text_event"===e.trigger&&(0,c.jsxs)("select",{value:e.trigger_val,onChange:e=>j(t,"trigger_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 --"}),l.length>0?l.map(e=>(0,c.jsx)("option",{value:e,children:e},e)):(0,c.jsx)("option",{disabled:!0,children:"\u0412 \u0442\u0435\u043a\u0441\u0442\u0435 \u043d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 [[Event:...]]"})]}),("timer"===e.trigger||"click_layer"===e.trigger)&&("timer"===e.trigger?(0,c.jsx)("input",{type:"number",placeholder:"sec",value:e.trigger_val,onChange:e=>j(t,"trigger_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"})}):(0,c.jsxs)("select",{value:e.trigger_val,onChange:e=>j(t,"trigger_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"Choose Layer"}),x.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]})),"animation_event"===e.trigger&&(0,c.jsxs)("select",{value:e.trigger_val,onChange:e=>j(t,"trigger_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"-- Event Name --"}),a.length>0?a.map(e=>(0,c.jsxs)("option",{value:e.name,children:[e.name," (",e.time.toFixed(1),"s)"]},e.id)):(0,c.jsx)("option",{disabled:!0,children:"\u041d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"})]}),"layer_visibility"===e.trigger&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("select",{value:e.trigger_val,onChange:e=>j(t,"trigger_val",e.target.value),style:s(s({},cK.input),{},{height:"28px",marginBottom:"4px"}),children:[(0,c.jsx)("option",{value:"",children:"Target Layer"}),x.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]}),(0,c.jsxs)("select",{value:e.visibility_mode||"hard",onChange:e=>j(t,"visibility_mode",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),title:"Hard: On/Off. Smooth: Volume by Opacity",children:[(0,c.jsx)("option",{value:"hard",children:"Hard (On/Off)"}),(0,c.jsx)("option",{value:"smooth",children:"Smooth (Volume)"})]})]})]}),"layer_visibility"!==e.trigger&&(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"Stop"}),(0,c.jsxs)("select",{value:e.stop_trigger,onChange:e=>j(t,"stop_trigger",e.target.value),style:s(s({},cK.input),{},{fontSize:"11px",padding:"0 4px"}),children:[(0,c.jsx)("option",{value:"none",children:"Auto/None"}),(0,c.jsx)("option",{value:"timer",children:"Timer"}),(0,c.jsx)("option",{value:"click_layer",children:"Click Layer"}),(0,c.jsx)("option",{value:"animation_event",children:"Animation Event \ud83d\udccd"}),(0,c.jsx)("option",{value:"text_event",children:"Text Event \ud83d\udcdd"})," "]}),"text_event"===e.stop_trigger&&(0,c.jsxs)("select",{value:e.stop_val,onChange:e=>j(t,"stop_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 --"}),l.length>0?l.map(e=>(0,c.jsx)("option",{value:e,children:e},e)):(0,c.jsx)("option",{disabled:!0,children:"\u0412 \u0442\u0435\u043a\u0441\u0442\u0435 \u043d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"})]}),("timer"===e.stop_trigger||"click_layer"===e.stop_trigger)&&("timer"===e.stop_trigger?(0,c.jsx)("input",{type:"number",placeholder:"sec",value:e.stop_val,onChange:e=>j(t,"stop_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"})}):(0,c.jsxs)("select",{value:e.stop_val,onChange:e=>j(t,"stop_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"Choose Layer"}),x.map(e=>(0,c.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]})),"animation_event"===e.stop_trigger&&(0,c.jsxs)("select",{value:e.stop_val,onChange:e=>j(t,"stop_val",e.target.value),style:s(s({},cK.input),{},{height:"28px"}),children:[(0,c.jsx)("option",{value:"",children:"-- Event Name --"}),a.length>0?a.map(e=>(0,c.jsxs)("option",{value:e.name,children:[e.name," (",e.time.toFixed(1),"s)"]},e.id)):(0,c.jsx)("option",{disabled:!0,children:"\u041d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"})]})]})]})]},e.id)),0===S.length&&(0,c.jsx)("div",{style:{textAlign:"center",color:"#555",fontSize:"12px",padding:"10px"},children:"\u041d\u0435\u0442 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"})]})]}),(0,c.jsx)("hr",{style:cK.divider}),(0,c.jsxs)("div",{style:cK.row,children:[(0,c.jsx)("label",{style:cK.label,children:"\u041f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0437\u0432\u0443\u043a \u043a\u043b\u0438\u043a\u0430"}),(0,c.jsx)(y,{value:k,placeholder:"-- \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e --",onClick:()=>m("override"),onClear:()=>h("click_sound_override","")})]}),(0,c.jsx)(UL,{isOpen:f.isOpen,onClose:()=>g(s(s({},f),{},{isOpen:!1})),onSelect:v,assets:o,rootId:"sys_audio",title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u043e\u0444\u0430\u0439\u043b",allowedTypes:["mp3","wav","ogg","m4a"]})]})},hK={panel:{background:"#1f1f1f",padding:"12px",width:"100%",minWidth:"220px",maxWidth:"100%",boxSizing:"border-box",borderRadius:"8px",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"12px",fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',fontSize:"12px",color:"#e0e0e0",boxShadow:"0 4px 20px rgba(0,0,0,0.4)"},header:{fontSize:"13px",fontWeight:"600",color:"#fff",display:"flex",alignItems:"center",gap:"8px",paddingBottom:"8px",borderBottom:"1px solid #333",marginBottom:"4px"},spoilerHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#2b2b2b",padding:"8px 10px",borderRadius:"4px",cursor:"pointer",userSelect:"none",border:"1px solid #3a3a3a",transition:"background 0.2s",marginBottom:"4px"},spoilerContent:{padding:"10px 8px 8px 8px",borderLeft:"2px solid #4a4a4a",marginLeft:"4px",display:"flex",flexDirection:"column",gap:"10px",background:"rgba(255,255,255,0.02)",marginBottom:"8px"},row:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},rowSplit:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(110px, 1fr))",gap:"8px",alignItems:"end",width:"100%"},label:{fontSize:"11px",color:"#9aa0a6",fontWeight:"500",display:"flex",alignItems:"center",whiteSpace:"nowrap"},input:{background:"#141414",border:"1px solid #333",color:"#eee",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",width:"100%",boxSizing:"border-box",outline:"none",height:"28px"},textarea:{background:"#141414",border:"1px solid #333",color:"#eee",padding:"6px",borderRadius:"4px",fontSize:"11px",width:"100%",boxSizing:"border-box",minHeight:"40px",resize:"vertical",outline:"none",fontFamily:"monospace"},rangeWrapper:{display:"flex",alignItems:"center",gap:"8px",minWidth:0},rangeInput:{flex:1,cursor:"pointer",accentColor:"#7568ed",height:"4px",minWidth:"20px"},rangeValue:{width:"30px",textAlign:"right",fontSize:"10px",color:"#777"},divider:{border:0,borderTop:"1px solid #333",margin:"4px 0"},sectionTitle:{fontSize:"11px",fontWeight:"700",color:"#8b80f9",textTransform:"uppercase",letterSpacing:"0.5px",marginTop:"6px",marginBottom:"4px"},checkbox:{cursor:"pointer",accentColor:"#7568ed",width:"16px",height:"16px",margin:0,flexShrink:0},colorRow:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"#141414",padding:"3px 6px",borderRadius:"4px",border:"1px solid #333",height:"28px",width:"100%",boxSizing:"border-box"},previewBox:{background:"#111",borderRadius:"6px",border:"1px dashed #333",padding:"8px",display:"flex",flexDirection:"column",alignItems:"center",overflow:"hidden"}},fK=e=>{let{label:t,value:n,min:r,max:o,step:i,onChange:a,unit:s="",tooltip:l}=e;return(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsxs)("span",{style:hK.label,children:[t," ",l&&(0,c.jsx)(PE,{text:l})]})}),(0,c.jsxs)("div",{style:hK.rangeWrapper,children:[(0,c.jsx)("input",{type:"range",min:r,max:o,step:i,style:hK.rangeInput,value:n,onChange:a}),(0,c.jsxs)("span",{style:hK.rangeValue,children:[n,s]})]})]})},gK=e=>{let{label:t,color:n,onChange:r}=e;return(0,c.jsxs)("div",{style:hK.colorRow,children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#aaa"},children:t}),(0,c.jsx)("div",{style:{transform:"scale(0.8)",transformOrigin:"right center"},children:(0,c.jsx)(T$,{color:n,onChange:r})})]})},mK=t=>{let{title:n,enabled:r,onToggleEnable:o,children:i,defaultOpen:a=!1,tooltip:l}=t;const[d,u]=(0,e.useState)(a);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[(0,c.jsxs)("div",{style:hK.spoilerHeader,onClick:e=>{"checkbox"!==e.target.type&&u(!d)},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",overflow:"hidden"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s",flexShrink:0},children:"\u25b6"}),(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",color:r?"#fff":"#777",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n}),l&&(0,c.jsx)(PE,{text:l})]}),(0,c.jsx)("input",{type:"checkbox",checked:r,onChange:e=>{e.stopPropagation(),o(e.target.checked)},style:hK.checkbox})]}),d&&(0,c.jsx)("div",{style:s(s({},hK.spoilerContent),{},{opacity:r?1:.5,pointerEvents:r?"auto":"none"}),children:i})]})},vK=e=>{var t,n,r,o,i,a,l,d,u,p,h,f,g,m,v,y;let{settings:x,onUpdate:b}=e;const w=x||{},S=(e,t)=>b(s(s({},w),{},{[e]:t})),k=w.notif_width||300,C=w.notif_height||210;return(0,c.jsxs)("div",{style:hK.panel,onMouseDown:e=>e.stopPropagation(),children:[(0,c.jsx)("div",{style:hK.header,children:(0,c.jsx)("span",{children:"\ud83d\udee0 \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430"})}),(0,c.jsxs)("div",{style:hK.sectionTitle,children:["\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u042d\u0444\u0444\u0435\u043a\u0442\u044b",(0,c.jsx)(PE,{text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0441\u0442\u0430\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: +1 \u0421\u0438\u043b\u0430)."})]}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsxs)("label",{style:hK.label,children:["\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",(0,c.jsx)(PE,{text:"Hidden: \u0441\u043a\u0440\u044b\u0442\u043e \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0442\u043e\u043b\u044c\u043a\u043e \u043b\u043e\u0433\u0438\u043a\u0430).\\nAlways: \u0431\u043b\u043e\u043a \u0432\u0441\u0435\u0433\u0434\u0430 \u0432\u0438\u0434\u0435\u043d.\\nInteraction: \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438."})]}),(0,c.jsxs)("select",{style:hK.input,value:w.stats_view_mode||"hidden",onChange:e=>S("stats_view_mode",e.target.value),children:[(0,c.jsx)("option",{value:"hidden",children:"\u0421\u043a\u0440\u044b\u0442\u043e"}),(0,c.jsx)("option",{value:"always",children:"\u0412\u0441\u0435\u0433\u0434\u0430"}),(0,c.jsx)("option",{value:"interaction",children:"\u041f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438"})]})]}),(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("label",{style:hK.label,children:"\u0421\u043f\u0438\u0441\u043a\u043e\u043c / \u0421\u0442\u0440\u043e\u043a\u043e\u0439"}),(0,c.jsxs)("select",{style:hK.input,value:w.stats_list_mode||"line",onChange:e=>S("stats_list_mode",e.target.value),children:[(0,c.jsx)("option",{value:"line",children:"\u0421\u0442\u0440\u043e\u043a\u043e\u0439"}),(0,c.jsx)("option",{value:"column",children:"\u0421\u0442\u043e\u043b\u0431\u0438\u043a\u043e\u043c"})]})]})]}),"column"===w.stats_list_mode&&(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("label",{style:hK.label,children:"\u041f\u0440\u0435\u0444\u0438\u043a\u0441 \u0441\u043f\u0438\u0441\u043a\u0430"}),(0,c.jsx)("input",{type:"text",style:hK.input,value:w.stats_list_prefix||"\u25cf",onChange:e=>S("stats_list_prefix",e.target.value)})]}),(0,c.jsxs)("div",{style:{background:"#1a1a1a",padding:"8px",borderRadius:"6px"},children:[(0,c.jsx)("label",{style:s(s({},hK.label),{},{marginBottom:"6px",color:"#ccc"}),children:"\ud83c\udfa8 \u0414\u0438\u0437\u0430\u0439\u043d \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430"}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u0424\u043e\u043d",color:w.stats_bg_color||"#000000",onChange:e=>S("stats_bg_color",e)}),(0,c.jsx)(gK,{label:"\u0422\u0435\u043a\u0441\u0442",color:w.stats_text_color||"#ffffff",onChange:e=>S("stats_text_color",e)})]}),(0,c.jsxs)("div",{style:s(s({},hK.rowSplit),{},{marginTop:"6px"}),children:[(0,c.jsx)(gK,{label:"\u0411\u043e\u0440\u0434\u0435\u0440",color:w.stats_border_color||"#ffffff",onChange:e=>S("stats_border_color",e)}),(0,c.jsx)("input",{type:"number",placeholder:"W",style:s(s({},hK.input),{},{textAlign:"center"}),value:null!==(t=w.stats_border_width)&&void 0!==t?t:0,onChange:e=>S("stats_border_width",parseInt(e.target.value)),title:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043e\u0431\u0432\u043e\u0434\u043a\u0438"})]}),(0,c.jsxs)("div",{style:{marginTop:"8px",display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:"10px"},children:[(0,c.jsx)(fK,{label:"Opactiy",value:null!==(n=w.stats_bg_opacity)&&void 0!==n?n:.8,min:"0",max:"1",step:"0.1",onChange:e=>S("stats_bg_opacity",parseFloat(e.target.value))}),(0,c.jsx)(fK,{label:"Radius",value:w.stats_border_radius||4,min:"0",max:"20",step:"1",onChange:e=>S("stats_border_radius",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:{marginTop:"8px"},children:[(0,c.jsx)("label",{style:hK.label,children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430 (Offset)"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:"10px"},children:[(0,c.jsx)(fK,{label:"X",value:null!==(r=w.stats_text_offset_x)&&void 0!==r?r:0,min:"-50",max:"50",step:"1",onChange:e=>S("stats_text_offset_x",parseInt(e.target.value))}),(0,c.jsx)(fK,{label:"Y",value:null!==(o=w.stats_text_offset_y)&&void 0!==o?o:0,min:"-50",max:"50",step:"1",onChange:e=>S("stats_text_offset_y",parseInt(e.target.value))})]})]}),(0,c.jsx)("div",{style:{marginTop:"8px"},children:(0,c.jsx)(fK,{label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0448\u0440\u0438\u0444\u0442\u0430",value:w.stats_font_size||14,min:"8",max:"32",step:"1",onChange:e=>S("stats_font_size",parseInt(e.target.value)),unit:"px"})})]}),(0,c.jsxs)(mK,{title:"\u0421\u0442\u0430\u0442\u044b \u0418\u0433\u0440\u043e\u043a\u0430",enabled:!0===w.p_stats_enabled,onToggleEnable:e=>S("p_stats_enabled",e),tooltip:"\u041f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e\u0435 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0443\u0449\u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435, \u0414\u0435\u043d\u044c\u0433\u0438) \u0432 \u0443\u0433\u043b\u0443 \u044d\u043a\u0440\u0430\u043d\u0430.",children:[(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsxs)("label",{style:hK.label,children:["\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435",(0,c.jsx)(PE,{text:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u0435\u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e \u0442\u043e\u0447\u043d\u043e \u0442\u0430\u043a, \u043a\u0430\u043a \u043e\u043d\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u044b \u0432 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435 \u043b\u043e\u0433\u0438\u043a\u0438."})]}),(0,c.jsx)("textarea",{style:hK.textarea,value:w.p_stats_keys||"",onChange:e=>S("p_stats_keys",e.target.value),placeholder:"\u041f\u0440\u0438\u043c\u0435\u0440: HP, Gold, Exp"})]}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("label",{style:hK.label,children:"\u0420\u0435\u0436\u0438\u043c \u043f\u043e\u043a\u0430\u0437\u0430"}),(0,c.jsxs)("select",{style:hK.input,value:w.p_stats_view_mode||"always",onChange:e=>S("p_stats_view_mode",e.target.value),children:[(0,c.jsx)("option",{value:"always",children:"\u0412\u0441\u0435\u0433\u0434\u0430"}),(0,c.jsx)("option",{value:"interaction",children:"\u041f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438"})]})]}),(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("label",{style:hK.label,children:"\u0424\u043e\u0440\u043c\u0430\u0442"}),(0,c.jsxs)("select",{style:hK.input,value:w.p_stats_list_mode||"column",onChange:e=>S("p_stats_list_mode",e.target.value),children:[(0,c.jsx)("option",{value:"column",children:"\u0421\u0442\u043e\u043b\u0431\u0438\u043a"}),(0,c.jsx)("option",{value:"line",children:"\u0421\u0442\u0440\u043e\u043a\u0430"})]})]})]}),(0,c.jsx)(fK,{label:"\u041e\u0442\u0441\u0442\u0443\u043f (Gap)",tooltip:"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0438\u043b\u0438 \u043e\u0442\u0441\u0442\u0443\u043f \u043e\u0442 \u043a\u0440\u0430\u0435\u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430.",value:null!==(i=w.p_stats_gap)&&void 0!==i?i:0,min:"0",max:"50",step:"1",onChange:e=>S("p_stats_gap",parseInt(e.target.value)),unit:"px"}),(0,c.jsxs)("div",{style:{borderTop:"1px solid #333",paddingTop:"8px",marginTop:"4px"},children:[(0,c.jsx)("label",{style:s(s({},hK.label),{},{marginBottom:"6px",color:"#aaa"}),children:"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0432\u0438\u0434"}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u0424\u043e\u043d",color:w.p_stats_bg_color||"#000000",onChange:e=>S("p_stats_bg_color",e)}),(0,c.jsx)(gK,{label:"\u0422\u0435\u043a\u0441\u0442",color:w.p_stats_text_color||"#ffffff",onChange:e=>S("p_stats_text_color",e)})]}),(0,c.jsxs)("div",{style:s(s({},hK.rowSplit),{},{marginTop:"6px"}),children:[(0,c.jsx)(gK,{label:"\u041e\u0431\u0432\u043e\u0434\u043a\u0430",color:w.p_stats_border_color||"#ffffff",onChange:e=>S("p_stats_border_color",e)}),(0,c.jsx)(fK,{label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430",value:null!==(a=w.p_stats_border_width)&&void 0!==a?a:0,min:"0",max:"10",step:"1",onChange:e=>S("p_stats_border_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:{marginTop:"8px",display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:"8px"},children:[(0,c.jsx)(fK,{label:"Opacity",value:null!==(l=w.p_stats_bg_opacity)&&void 0!==l?l:.8,min:"0",max:"1",step:"0.1",onChange:e=>S("p_stats_bg_opacity",parseFloat(e.target.value))}),(0,c.jsx)(fK,{label:"Radius",value:w.p_stats_border_radius||4,min:"0",max:"30",step:"1",onChange:e=>S("p_stats_border_radius",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:{marginTop:"8px"},children:[(0,c.jsx)("label",{style:hK.label,children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:"10px"},children:[(0,c.jsx)(fK,{label:"X",value:null!==(d=w.p_stats_text_offset_x)&&void 0!==d?d:0,min:"-100",max:"100",step:"1",onChange:e=>S("p_stats_text_offset_x",parseInt(e.target.value))}),(0,c.jsx)(fK,{label:"Y",value:null!==(u=w.p_stats_text_offset_y)&&void 0!==u?u:0,min:"-100",max:"100",step:"1",onChange:e=>S("p_stats_text_offset_y",parseInt(e.target.value))})]})]}),(0,c.jsx)("div",{style:{marginTop:"8px"},children:(0,c.jsx)(fK,{label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0448\u0440\u0438\u0444\u0442\u0430",value:w.p_stats_font_size||14,min:"8",max:"40",step:"1",onChange:e=>S("p_stats_font_size",parseInt(e.target.value)),unit:"px"})})]})]}),(0,c.jsxs)(mK,{title:"\u041e\u043a\u043d\u043e \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439",enabled:!1!==w.notification_enabled,onToggleEnable:e=>S("notification_enabled",e),tooltip:"\u0412\u0441\u043f\u043b\u044b\u0432\u0430\u044e\u0449\u0435\u0435 \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u043d\u043e (Pop-up), \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0449\u0435\u0435 \u0438\u0442\u043e\u0433\u0438 \u0432\u044b\u0431\u043e\u0440\u0430 \u0438\u0433\u0440\u043e\u043a\u0430.",children:[(0,c.jsxs)("div",{style:hK.previewBox,children:[(0,c.jsx)("div",{style:s(s({},hK.label),{},{marginBottom:"4px"}),children:"\ud83d\udc41 Live Preview"}),(0,c.jsxs)("div",{style:{position:"relative",width:"100%",height:"120px",background:"#222",borderRadius:"4px",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,c.jsx)("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0, ".concat(null!==(p=w.notif_backdrop_opacity)&&void 0!==p?p:.5,")"),zIndex:1}}),(0,c.jsxs)("div",{style:{width:k,height:C,transform:"scale(0.35)",transformOrigin:"center",backgroundColor:w.notif_bg_color||"#ffffff",border:"".concat(w.notif_border_width||0,"px solid ").concat(w.notif_border_color||"#000"),borderRadius:w.notif_border_radius||5,display:"flex",flexDirection:"column",zIndex:2,boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},children:[(0,c.jsx)("div",{style:{position:"absolute",top:10,right:15,fontSize:24,color:w.notif_text_color||"#000"},children:"\u2715"}),(0,c.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",fontSize:w.notif_font_size||16,color:w.notif_text_color||"#000",gap:"5px"},children:[(0,c.jsx)("span",{children:"\u0421\u0438\u043b\u0430 +1"}),(0,c.jsx)("span",{children:"\u0417\u043e\u043b\u043e\u0442\u043e -10"})]}),(0,c.jsx)("div",{style:{textAlign:"center",paddingBottom:15},children:(0,c.jsx)("button",{style:{fontSize:14,padding:"8px 24px",backgroundColor:w.notif_btn_bg_color||"#f0f0f0",color:w.notif_btn_text_color||"#333",border:"".concat(null!==(h=w.notif_btn_border_width)&&void 0!==h?h:1,"px solid ").concat(w.notif_btn_border_color||"#ccc"),borderRadius:4,opacity:null!==(f=w.notif_btn_opacity)&&void 0!==f?f:1},children:"OK"})})]})]})]}),(0,c.jsxs)("div",{style:hK.row,children:[(0,c.jsx)("label",{style:hK.label,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043e\u043a\u043d\u0430 (px)"}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsxs)("div",{style:hK.rangeWrapper,children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#777"},children:"W:"}),(0,c.jsx)("input",{type:"range",min:150,max:450,step:"10",style:hK.rangeInput,value:k,onChange:e=>S("notif_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:hK.rangeWrapper,children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#777"},children:"H:"}),(0,c.jsx)("input",{type:"range",min:60,max:360,step:"10",style:hK.rangeInput,value:C,onChange:e=>S("notif_height",parseInt(e.target.value))})]})]})]}),(0,c.jsx)("div",{style:hK.divider}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u0424\u043e\u043d \u043e\u043a\u043d\u0430",color:w.notif_bg_color||"#ffffff",onChange:e=>S("notif_bg_color",e)}),(0,c.jsx)(gK,{label:"\u0422\u0435\u043a\u0441\u0442",color:w.notif_text_color||"#000000",onChange:e=>S("notif_text_color",e)})]}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u041e\u0431\u0432\u043e\u0434\u043a\u0430",color:w.notif_border_color||"#cccccc",onChange:e=>S("notif_border_color",e)}),(0,c.jsx)(fK,{label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430",value:null!==(g=w.notif_border_width)&&void 0!==g?g:1,min:"0",max:"10",step:"1",onChange:e=>S("notif_border_width",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:"8px",marginTop:"4px"},children:[(0,c.jsx)(fK,{label:"\u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435",value:w.notif_border_radius||10,min:"0",max:"50",step:"1",onChange:e=>S("notif_border_radius",parseInt(e.target.value))}),(0,c.jsx)(fK,{label:"\u0428\u0440\u0438\u0444\u0442",value:w.notif_font_size||16,min:"8",max:"40",step:"1",onChange:e=>S("notif_font_size",parseInt(e.target.value))})]}),(0,c.jsx)(fK,{label:"\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435 (Backdrop)",value:null!==(m=w.notif_backdrop_opacity)&&void 0!==m?m:.5,min:"0",max:"1",step:"0.1",onChange:e=>S("notif_backdrop_opacity",parseFloat(e.target.value))}),(0,c.jsx)("div",{style:hK.divider}),(0,c.jsx)("label",{style:s(s({},hK.label),{},{color:"#aaa"}),children:'\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u043d\u043e\u043f\u043a\u0438 "OK"'}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u0424\u043e\u043d \u043a\u043d.",color:w.notif_btn_bg_color||"#f0f0f0",onChange:e=>S("notif_btn_bg_color",e)}),(0,c.jsx)(gK,{label:"\u0422\u0435\u043a\u0441\u0442 \u043a\u043d.",color:w.notif_btn_text_color||"#333333",onChange:e=>S("notif_btn_text_color",e)})]}),(0,c.jsxs)("div",{style:hK.rowSplit,children:[(0,c.jsx)(gK,{label:"\u041e\u0431\u0432\u043e\u0434\u043a\u0430",color:w.notif_btn_border_color||"#cccccc",onChange:e=>S("notif_btn_border_color",e)}),(0,c.jsx)(fK,{label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430",value:null!==(v=w.notif_btn_border_width)&&void 0!==v?v:1,min:"0",max:"10",step:"1",onChange:e=>S("notif_btn_border_width",parseInt(e.target.value))})]}),(0,c.jsx)(fK,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0438",value:null!==(y=w.notif_btn_opacity)&&void 0!==y?y:1,min:"0",max:"1",step:"0.1",onChange:e=>S("notif_btn_opacity",parseFloat(e.target.value))})]})]})},yK=[{key:"brightness"},{key:"contrast"},{key:"saturate"},{key:"temperature"},{key:"hueRotate"},{key:"fadeAmount"},{key:"grayscale"},{key:"sepia"},{key:"fadeColor"},{key:"color",nested:"tint"},{key:"intensity",nested:"vignette"},{key:"size",nested:"vignette"},{key:"opacity",nested:"tint"},{key:"spread",nested:"isolation"},{key:"bgDesaturation",nested:"isolation"},{key:"bgDarkening",nested:"isolation"},{key:"offsetX",nested:"chromatic"},{key:"offsetY",nested:"chromatic"}],xK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v;let{settings:y,onUpdate:x,isExpanded:b,textEvents:w,onToggle:S,layers:k=[],availableLayers:C=[]}=t;const[j,_]=(0,e.useState)(!1),[E,D]=(0,e.useState)(0),[M,T]=(0,e.useState)(0),[I,A]=(0,e.useState)({chromatic:!1,vignette:!1,tint:!1,animation:!1}),O=e=>{A(t=>s(s({},t),{},{[e]:!t[e]}))},[R,z]=(0,e.useState)(!1),F="main",P=!(!y||!y.enabled),B=(null===y||void 0===y||null===(n=y.animation)||void 0===n?void 0:n.enabled)||!1,L=k&&k.length>0?k:C,N=((0,e.useMemo)(()=>L.filter(e=>"folder"!==e.type),[L]),{panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},subHeader:{background:"#333",padding:"8px 12px",borderRadius:"4px",marginTop:"5px",marginBottom:"5px",fontSize:"11px",fontWeight:"600",color:"#ddd",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",border:"1px solid #3f3f3f",userSelect:"none"},subContent:{padding:"8px",borderLeft:"2px solid #444",marginLeft:"4px",marginBottom:"10px"},sectionTitle:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"}}),U=(e,t)=>t?"".concat(t,"_").concat(e):e,V=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=U(e,r);if(B){var i,a;if(e.toLowerCase().includes("color"))return ZB(F,o,t,y.animation,E);const n=null===(i=y.animation)||void 0===i||null===(a=i.elements)||void 0===a?void 0:a[F],r=BB(n,o,E);if(null!==r)return r}var s,l;return r?null!==(s=null===y||void 0===y||null===(l=y[r])||void 0===l?void 0:l[e])&&void 0!==s?s:t:null!==(n=null===y||void 0===y?void 0:y[e])&&void 0!==n?n:t},W=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(console.log("[Panel] updateVal: ".concat(n?n+".":"").concat(e),{value:t,isAnimMode:B,currentTime:E,isTimelinePlaying:R}),B){var r;if(R)return void console.warn("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u043e \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f");const o=U(e,n);let i=y.animation?JSON.parse(JSON.stringify(y.animation)):{duration:10,elements:{[F]:{}}};const a=(((null===(r=i.elements)||void 0===r?void 0:r[F])||{})[o]||[]).some(e=>Math.abs(e.t-E)<.001);a||yK.forEach(t=>{if(t.key===e&&t.nested===n)return;const r=U(t.key,t.nested),o=t.key.toLowerCase().includes("color");let a;if(o){var s;const e=t.nested?null===y||void 0===y||null===(s=y[t.nested])||void 0===s?void 0:s[t.key]:null===y||void 0===y?void 0:y[t.key];a=ZB(F,r,e||"#000000",y.animation,E)}else{var l,c;a=BB(null===(l=y.animation)||void 0===l||null===(c=l.elements)||void 0===c?void 0:c[F],r,E)}if(null!==a&&void 0!==a){if(!o&&isNaN(a))return;if(o&&"string"===typeof a&&a.includes("NaN"))return;i=LB(i,F,r,E,a)}else{var d;const e=t.nested?null===y||void 0===y||null===(d=y[t.nested])||void 0===d?void 0:d[t.key]:null===y||void 0===y?void 0:y[t.key];void 0!==e&&null!==e&&(i=LB(i,F,r,E,e))}}),console.log("[Panel] Saving Keyframe -> Track: ".concat(o,", Time: ").concat(E,", Val:"),t);const s=LB(i,F,o,E,t);x({animation:s})}else if(n){const r=(null===y||void 0===y?void 0:y[n])||{};x({[n]:s(s({},r),{},{[e]:t})})}else x({[e]:t})},H=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{onDoubleClick:r=>{r.stopPropagation(),W(e,t,n)},onTouchEnd:r=>{const o=Date.now();r.target.lastTouch&&o-r.target.lastTouch<300&&(r.preventDefault(),W(e,t,n)),r.target.lastTouch=o}}};(0,e.useEffect)(()=>{b||void 0===(null===y||void 0===y?void 0:y._previewTime)||x({_previewTime:void 0})},[b]);const G=R?{opacity:.5,pointerEvents:"none",filter:"grayscale(1)"}:{};return(0,c.jsxs)("div",{style:N.panel,children:[(0,c.jsxs)("div",{style:N.header,onClick:S,children:[(0,c.jsx)("input",{type:"checkbox",checked:!(!y||!y.enabled),onClick:e=>e.stopPropagation(),onChange:e=>x({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#ff9800"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u0426\u0432\u0435\u0442\u043e\u043a\u043e\u0440\u0440\u0435\u043a\u0446\u0438\u044f \ud83c\udfa8"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00e676",background:"rgba(0, 230, 118, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:y&&y.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:b?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),b&&(0,c.jsxs)("div",{style:{padding:"0 5px",opacity:P?1:.4,pointerEvents:P?"auto":"none",filter:P?"none":"grayscale(100%)",transition:"opacity 0.3s, filter 0.3s"},children:[(0,c.jsxs)("div",{onClick:()=>x({renderAbove:!1===(null===y||void 0===y?void 0:y.renderAbove)}),style:{marginBottom:"8px",background:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"rgba(255, 152, 0, 0.15)":"#1e1e1e",border:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"1px solid #ff9800":"1px solid #444",borderRadius:"6px",padding:"10px 12px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s ease",userSelect:"none"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",color:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"#ffb74d":"#ccc"},children:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"\u042d\u0444\u0444\u0435\u043a\u0442\u044b \u043f\u043e\u0432\u0435\u0440\u0445 UI":"\u042d\u0444\u0444\u0435\u043a\u0442\u044b \u043f\u043e\u0434 UI"}),(0,c.jsxs)("span",{style:{fontSize:"9px",color:"#777",marginTop:"2px"},children:["Z-Index: ",!1!==(null===y||void 0===y?void 0:y.renderAbove)?"900 (High)":"99 (Low)"]})]}),(0,c.jsx)(PE,{text:"\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u044d\u0444\u0444\u0435\u043a\u0442\u044b (\u0437\u0435\u0440\u043d\u043e, \u0432\u0438\u043d\u044c\u0435\u0442\u043a\u0430) \u043d\u0430\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u043b\u0438\u0441\u044c \u043f\u043e\u0432\u0435\u0440\u0445 \u043a\u043d\u043e\u043f\u043e\u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430. \u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043e\u0441\u0442\u0430\u0432\u0430\u043b\u0441\u044f \u0447\u0438\u0441\u0442\u044b\u043c."})]}),(0,c.jsx)("div",{style:{width:"40px",height:"20px",background:"#333",borderRadius:"10px",position:"relative",transition:"background 0.3s"},children:(0,c.jsx)("div",{style:{width:"16px",height:"16px",borderRadius:"50%",background:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"#ff9800":"#555",position:"absolute",top:"2px",left:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"22px":"2px",transition:"all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)",boxShadow:!1!==(null===y||void 0===y?void 0:y.renderAbove)?"0 0 8px #ff9800":"none"}})})]}),(0,c.jsxs)("div",{onClick:()=>!R&&(e=>{if(e){var t,n,r,o,i,a,l,c,d,u,p,h,f,g;let e=y.animation?s({},y.animation):{duration:10,loop:!0,elements:{[F]:{}}};const w=function(t,n){var r,o;const i=U(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);(null===(r=e.elements[F])||void 0===r||null===(o=r[i])||void 0===o?void 0:o.length)>0||(e=LB(e,F,i,0,n))};var m,v,b;w("brightness",null!==(t=y.brightness)&&void 0!==t?t:1),w("contrast",null!==(n=y.contrast)&&void 0!==n?n:1),w("saturate",null!==(r=y.saturate)&&void 0!==r?r:1),w("temperature",null!==(o=y.temperature)&&void 0!==o?o:0),w("hueRotate",null!==(i=y.hueRotate)&&void 0!==i?i:0),y.isolation&&(w("spread",null!==(m=y.isolation.spread)&&void 0!==m?m:0,"isolation"),w("bgDesaturation",null!==(v=y.isolation.bgDesaturation)&&void 0!==v?v:0,"isolation"),w("bgDarkening",null!==(b=y.isolation.bgDarkening)&&void 0!==b?b:0,"isolation")),w("fadeAmount",null!==(a=y.fadeAmount)&&void 0!==a?a:0),w("grayscale",null!==(l=y.grayscale)&&void 0!==l?l:0),w("sepia",null!==(c=y.sepia)&&void 0!==c?c:0),w("intensity",null!==(d=null===(u=y.vignette)||void 0===u?void 0:u.intensity)&&void 0!==d?d:.5,"vignette"),w("size",null!==(p=null===(h=y.vignette)||void 0===h?void 0:h.size)&&void 0!==p?p:.5,"vignette"),w("opacity",null!==(f=null===(g=y.tint)||void 0===g?void 0:g.opacity)&&void 0!==f?f:.2,"tint"),e.enabled=!0,x({animation:e})}else x({animation:s(s({},y.animation),{},{enabled:!1})})})(!B),style:{marginBottom:"15px",background:B?"rgba(255, 82, 82, 0.15)":"#1e1e1e",border:B?"1px solid #ff5252":"1px solid #444",borderRadius:"6px",padding:"10px 12px",cursor:R?"not-allowed":"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s ease",userSelect:"none",opacity:R?.7:1},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",color:B?"#ff8a80":"#ccc",display:"flex",alignItems:"center",gap:"5px"},children:R?"\u26d4 \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430":B?"\ud83d\udd34 \u0420\u0435\u0436\u0438\u043c \u0437\u0430\u043f\u0438\u0441\u0438 (REC)":"\u23f1\ufe0f \u0420\u0435\u0436\u0438\u043c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438"}),(0,c.jsx)("span",{style:{fontSize:"9px",color:B?"#ff8a80":"#777",marginTop:"2px"},children:R?"\u0418\u0434\u0435\u0442 \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0435":B?"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0437\u0434\u0430\u044e\u0442 \u043a\u043b\u044e\u0447\u0438":"\u0421\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]}),(0,c.jsx)(PE,{text:"\u0410\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u043a\u0430\u0434\u0440\u043e\u0432 (Keyframes). \u041a\u043e\u0433\u0434\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u2014 \u043b\u044e\u0431\u043e\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0441\u043b\u0430\u0439\u0434\u0435\u0440\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u043e\u0447\u043a\u0443 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438. \u041a\u043e\u0433\u0434\u0430 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u2014 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0435\u0433\u043e \u043a\u043b\u0438\u043f\u0430."})]}),(0,c.jsx)("div",{style:{width:"40px",height:"20px",background:"#333",borderRadius:"10px",position:"relative",transition:"background 0.3s"},children:(0,c.jsx)("div",{style:{width:"16px",height:"16px",borderRadius:"50%",background:B?"#ff5252":"#555",position:"absolute",top:"2px",left:B?"22px":"2px",transition:"all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)",boxShadow:B?"0 0 8px #ff5252":"none"}})})]}),(0,c.jsxs)("div",{style:G,children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#777",marginBottom:"10px",fontStyle:"italic"},children:"\ud83d\udca1 \u0414\u0432\u043e\u0439\u043d\u043e\u0439 \u043a\u043b\u0438\u043a \u043f\u043e \u043f\u043e\u043b\u0437\u0443\u043d\u043a\u0443 \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435."}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"10px 0"}}),(0,c.jsx)("div",{style:N.sectionTitle,children:(0,c.jsx)("span",{children:"\ud83d\udd06 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0442\u043e\u043d\u0430"})}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("brightness",1).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"2",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff9800"}),value:V("brightness",1),onChange:e=>W("brightness",parseFloat(e.target.value)),disabled:R},H("brightness",1)))]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("contrast",1).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"3",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff9800"}),value:V("contrast",1),onChange:e=>W("contrast",parseFloat(e.target.value)),disabled:R},H("contrast",1)))]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0441\u0442\u044c (Saturation)"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("saturate",1).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"3",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff9800"}),value:V("saturate",1),onChange:e=>W("saturate",parseFloat(e.target.value)),disabled:R},H("saturate",1)))]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430 (\u2744\ufe0f / \ud83d\udd25)"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("temperature",0).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"-1",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff9800"}),value:V("temperature",0),onChange:e=>W("temperature",parseFloat(e.target.value)),disabled:R},H("temperature",0))),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9px",color:"#666",marginTop:"-3px"},children:[(0,c.jsx)("span",{children:"\u0425\u043e\u043b\u043e\u0434"}),(0,c.jsx)("span",{children:"\u0422\u0435\u043f\u043b\u043e"})]})]}),(0,c.jsxs)("div",{style:{marginTop:"5px",marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:s(s({},N.subHeader),{},{background:j?"#333":"transparent",borderRadius:"4px"}),onClick:()=>_(!j),children:[(0,c.jsx)("span",{children:"\ud83c\udfaf \u0410\u043a\u0446\u0435\u043d\u0442\u043d\u044b\u0439 \u0446\u0432\u0435\u0442 (Isolation)"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888"},children:j?"\u25bc":"\u25b6"})]}),j&&(0,c.jsxs)("div",{style:s(s({},N.subContent),{},{padding:"10px 5px",background:"#222"}),children:[(0,c.jsxs)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"10px"},children:["\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0432\u0435\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e ",(0,c.jsx)("b",{children:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),". \u041e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043e."]}),(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",background:"#111",padding:"6px",borderRadius:"20px"},children:[{id:"red",icon:"\ud83d\udd34",tooltip:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439"},{id:"orange",icon:"\ud83d\udfe0",tooltip:"\u041e\u0440\u0430\u043d\u0436\u0435\u0432\u044b\u0439"},{id:"yellow",icon:"\ud83d\udfe1",tooltip:"\u0416\u0435\u043b\u0442\u044b\u0439"},{id:"green",icon:"\ud83d\udfe2",tooltip:"\u0417\u0435\u043b\u0435\u043d\u044b\u0439"},{id:"cyan",icon:"\ud83d\udca0",tooltip:"\u0426\u0438\u0430\u043d"},{id:"blue",icon:"\ud83d\udd35",tooltip:"\u0421\u0438\u043d\u0438\u0439"},{id:"magenta",icon:"\ud83d\udfe3",tooltip:"\u041c\u0430\u0434\u0436\u0435\u043d\u0442\u0430"}].map(e=>{var t;const n=(null===y||void 0===y||null===(t=y.isolation)||void 0===t?void 0:t.color)===e.id;return(0,c.jsx)("div",{onClick:()=>x({isolation:s(s({},null===y||void 0===y?void 0:y.isolation),{},{color:n?null:e.id})}),style:{cursor:"pointer",opacity:n?1:.5,transform:n?"scale(1.3)":"scale(1)",filter:n?"drop-shadow(0 0 5px rgba(255,255,255,0.35))":"none",transition:"all 0.2s",fontSize:"16px",padding:"0 2px"},title:e.tooltip,children:e.icon},e.id)})}),null!==y&&void 0!==y&&null!==(r=y.isolation)&&void 0!==r&&r.color?(0,c.jsx)(c.Fragment,{children:(()=>{const e=V("spread",0,"isolation"),t=V("bgDesaturation",0,"isolation"),n=V("bgDarkening",0,"isolation");return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u0431\u0440\u043e\u0441 \u043e\u0442\u0442\u0435\u043d\u043a\u0430"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[Math.round(100*e),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff5252"}),value:e,onChange:e=>W("spread",parseFloat(e.target.value),"isolation"),disabled:R})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#333",margin:"8px 0"}}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u0440\u0438\u0433\u043b\u0443\u0448\u0438\u0442\u044c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[Math.round(100*t),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff5252"}),value:t,onChange:e=>W("bgDesaturation",parseFloat(e.target.value),"isolation"),disabled:R})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#333",margin:"8px 0"}}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0417\u0430\u0442\u0435\u043c\u043d\u0438\u0442\u044c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[Math.round(100*n),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#ff5252"}),value:n,onChange:e=>W("bgDarkening",parseFloat(e.target.value),"isolation"),disabled:R})]})]})})()}):(0,c.jsx)("div",{style:{padding:"10px",textAlign:"center",color:"#555",fontSize:"11px",border:"1px dashed #333",borderRadius:"4px"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0432\u0435\u0442 \u0441\u0432\u0435\u0440\u0445\u0443, \u0447\u0442\u043e\u0431\u044b \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u043a\u0446\u0435\u043d\u0442\u0430."})]})]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0434\u0432\u0438\u0433 \u043e\u0442\u0442\u0435\u043d\u043a\u0430 (Hue)"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[Math.round(V("hueRotate",0)),"\xb0"]})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"360",step:"1",style:s(s({},N.rangeInput),{},{accentColor:"#e040fb"}),value:V("hueRotate",0),onChange:e=>W("hueRotate",parseFloat(e.target.value)),disabled:R},H("hueRotate",0)))]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"10px 0"}}),(0,c.jsx)("div",{style:s(s({},N.sectionTitle),{},{marginTop:"15px"}),children:(0,c.jsx)("span",{children:"\ud83c\udf9e \u042d\u0444\u0444\u0435\u043a\u0442\u044b \u043f\u043b\u0435\u043d\u043a\u0438"})}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0412\u044b\u0446\u0432\u0435\u0442\u0430\u043d\u0438\u0435 (Fade / Lift)"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("fadeAmount",0).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#aaa"}),value:V("fadeAmount",0),onChange:e=>W("fadeAmount",parseFloat(e.target.value)),disabled:R},H("fadeAmount",0))),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777"},children:"\u0414\u0435\u043b\u0430\u0435\u0442 \u0442\u0435\u043d\u0438 \u0441\u0432\u0435\u0442\u043b\u0435\u0435 (\u0438\u043c\u0438\u0442\u0430\u0446\u0438\u044f \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0444\u043e\u0442\u043e)."})]}),(0,c.jsx)("div",{style:N.row,children:(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442 \u0442\u0435\u043d\u0435\u0439 (Fade Color)"}),(0,c.jsx)(T$,{color:V("fadeColor","#1a1a1a"),onChange:e=>W("fadeColor",e),disabled:R})]})}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u0427/\u0411 (Grayscale)"}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:{width:"100%",height:"4px"},value:V("grayscale",0),onChange:e=>W("grayscale",parseFloat(e.target.value)),disabled:R},H("grayscale",0)))]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u0421\u0435\u043f\u0438\u044f (Sepia)"}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:{width:"100%",height:"4px"},value:V("sepia",0),onChange:e=>W("sepia",parseFloat(e.target.value)),disabled:R},H("sepia",0)))]})]}),(0,c.jsxs)("div",{style:{marginTop:"15px",display:"flex",flexDirection:"column",gap:"2px"},children:[(0,c.jsxs)("div",{style:{background:"#252525",borderRadius:"4px",overflow:"hidden"},children:[(0,c.jsxs)("div",{style:s(s({},N.subHeader),{},{margin:0,borderRadius:0,border:"none",background:I.chromatic?"#3a3a3a":"transparent"}),onClick:()=>O("chromatic"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888",transform:I.chromatic?"rotate(90deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25b6"}),(0,c.jsx)("span",{children:"\ud83c\udf08 RGB \u0421\u0434\u0432\u0438\u0433"})]}),(0,c.jsx)("input",{type:"checkbox",checked:!(null===y||void 0===y||null===(o=y.chromatic)||void 0===o||!o.enabled),onClick:e=>e.stopPropagation(),onChange:e=>{const t=(null===y||void 0===y?void 0:y.chromatic)||{};x({chromatic:e.target.checked?s(s(s({},{offsetX:5,offsetY:0,enabled:!0}),t),{},{enabled:!0}):s(s({},t),{},{enabled:!1})})},style:{cursor:"pointer",accentColor:"#00e5ff"}})]}),I.chromatic&&(0,c.jsxs)("div",{style:s(s({},N.subContent),{},{borderLeft:"none",padding:"10px",background:"#2a2a2a"}),children:[(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginBottom:"8px",fontStyle:"italic"},children:"\u0421\u0434\u0432\u0438\u0433\u0430\u0435\u0442 \u0446\u0432\u0435\u0442\u043e\u0432\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b. \u041c\u043e\u0436\u043d\u043e \u0430\u043d\u0438\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0440\u044f\u0441\u043a\u0443."}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 X"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[V("offsetX",0,"chromatic").toFixed(1),"px"]})]}),(0,c.jsx)("input",s({type:"range",min:"-20",max:"20",step:"0.5",style:s(s({},N.rangeInput),{},{accentColor:"#ff0055"}),value:V("offsetX",0,"chromatic"),onChange:e=>W("offsetX",parseFloat(e.target.value),"chromatic"),disabled:R},H("offsetX",0,"chromatic")))]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 Y"}),(0,c.jsxs)("span",{style:N.valueLabel,children:[V("offsetY",0,"chromatic").toFixed(1),"px"]})]}),(0,c.jsx)("input",s({type:"range",min:"-20",max:"20",step:"0.5",style:s(s({},N.rangeInput),{},{accentColor:"#00e5ff"}),value:V("offsetY",0,"chromatic"),onChange:e=>W("offsetY",parseFloat(e.target.value),"chromatic"),disabled:R},H("offsetY",0,"chromatic")))]})]})]}),(0,c.jsxs)("div",{style:{background:"#252525",borderRadius:"4px",overflow:"hidden"},children:[(0,c.jsxs)("div",{style:s(s({},N.subHeader),{},{margin:0,borderRadius:0,border:"none",background:I.vignette?"#3a3a3a":"transparent"}),onClick:()=>O("vignette"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888",transform:I.vignette?"rotate(90deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25b6"}),(0,c.jsx)("span",{children:"\ud83c\udf11 \u0412\u0438\u043d\u044c\u0435\u0442\u043a\u0430"})]}),(0,c.jsx)("input",{type:"checkbox",checked:!(null===y||void 0===y||null===(i=y.vignette)||void 0===i||!i.enabled),onClick:e=>e.stopPropagation(),onChange:e=>{const t=(null===y||void 0===y?void 0:y.vignette)||{};x({vignette:e.target.checked?s(s(s({},{intensity:.5,size:.5,color:"#000000",enabled:!0}),t),{},{enabled:!0}):s(s({},t),{},{enabled:!1})})},style:{cursor:"pointer",accentColor:"#00e676"}})]}),I.vignette&&(0,c.jsxs)("div",{style:s(s({},N.subContent),{},{borderLeft:"none",padding:"10px",background:"#2a2a2a"}),children:[(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430"})}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#00e676"}),value:V("intensity",.5,"vignette"),onChange:e=>W("intensity",parseFloat(e.target.value),"vignette"),disabled:R},H("intensity",.5,"vignette")))]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440"})}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#00e676"}),value:V("size",.5,"vignette"),onChange:e=>W("size",parseFloat(e.target.value),"vignette"),disabled:R},H("size",.5,"vignette")))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:(null===y||void 0===y||null===(a=y.vignette)||void 0===a?void 0:a.color)||"#000000",onChange:e=>x({vignette:s(s({},y.vignette),{},{color:e})}),disabled:R})]})]})]}),(0,c.jsxs)("div",{style:{background:"#252525",borderRadius:"4px",overflow:"hidden"},children:[(0,c.jsxs)("div",{style:s(s({},N.subHeader),{},{margin:0,borderRadius:0,border:"none",background:I.tint?"#3a3a3a":"transparent"}),onClick:()=>O("tint"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888",transform:I.tint?"rotate(90deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25b6"}),(0,c.jsx)("span",{children:"\ud83d\udd8c \u0422\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"})]}),(0,c.jsx)("input",{type:"checkbox",checked:!(null===y||void 0===y||null===(l=y.tint)||void 0===l||!l.enabled),onClick:e=>e.stopPropagation(),onChange:e=>{const t=(null===y||void 0===y?void 0:y.tint)||{};x({tint:e.target.checked?s(s(s({},{color:"#ff0000",opacity:.2,mode:"soft-light",enabled:!0}),t),{},{enabled:!0}):s(s({},t),{},{enabled:!1})})},style:{cursor:"pointer",accentColor:"#e040fb"}})]}),I.tint&&(0,c.jsxs)("div",{style:s(s({},N.subContent),{},{borderLeft:"none",padding:"10px",background:"#2a2a2a"}),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442 \u0444\u0438\u043b\u044c\u0442\u0440\u0430"}),(0,c.jsx)(T$,{color:V("color","#ff0000","tint"),onChange:e=>W("color",e,"tint"),disabled:R})]}),(0,c.jsxs)("div",{style:N.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:N.valueLabel,children:V("opacity",.2,"tint").toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:s(s({},N.rangeInput),{},{accentColor:"#e040fb"}),value:V("opacity",.2,"tint"),onChange:e=>W("opacity",parseFloat(e.target.value),"tint"),disabled:R},H("opacity",.2,"tint")))]}),(0,c.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("select",{value:(null===y||void 0===y||null===(d=y.tint)||void 0===d?void 0:d.mode)||"soft-light",onChange:e=>x({tint:s(s({},y.tint),{},{mode:e.target.value})}),style:N.selectInput,children:[(0,c.jsx)("option",{value:"normal",children:"Normal"}),(0,c.jsx)("option",{value:"multiply",children:"Multiply"}),(0,c.jsx)("option",{value:"screen",children:"Screen"}),(0,c.jsx)("option",{value:"overlay",children:"Overlay"}),(0,c.jsx)("option",{value:"soft-light",children:"Soft Light"}),(0,c.jsx)("option",{value:"color",children:"Color"}),(0,c.jsx)("option",{value:"hue",children:"Hue"})]})]})]})]})]})]}),(0,c.jsxs)("div",{style:{marginTop:"15px",borderTop:"1px solid #444",paddingTop:"5px"},children:[(0,c.jsxs)("div",{style:s(s({},N.subHeader),{},{background:I.animation?"#333":"transparent",border:"1px solid #444"}),onClick:()=>O("animation"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"10px",color:"#888",transform:I.animation?"rotate(90deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25b6"}),(0,c.jsx)("span",{children:"\ud83c\udfac \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0438 \u043a\u043b\u044e\u0447\u0438"})]}),(0,c.jsx)("span",{style:{fontSize:"9px",color:B?"#ff5252":"#555",fontWeight:B?"bold":"normal"},children:B?"\u25cf REC":"Off"})]}),I.animation&&(0,c.jsx)("div",{style:{background:"#222",borderRadius:"6px",padding:"10px",marginTop:"5px",border:"1px solid #333"},children:B?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"10px",borderBottom:"1px dashed #444",paddingBottom:"10px"},children:[(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",color:"#ddd",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!1!==(null===(u=y.animation)||void 0===u?void 0:u.loop),onChange:e=>x({animation:s(s({},y.animation),{},{loop:e.target.checked})}),disabled:R}),"\ud83d\udd04 Loop"]}),!1!==(null===(p=y.animation)||void 0===p?void 0:p.loop)&&(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",color:"#ddd",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!(null===(h=y.animation)||void 0===h||!h.reverse),onChange:e=>x({animation:s(s({},y.animation),{},{reverse:e.target.checked})}),disabled:R}),"\u2194\ufe0f Reverse"]})]}),(0,c.jsx)(eK,{duration:(null===(f=y.animation)||void 0===f?void 0:f.duration)||10,onDurationChange:e=>x({animation:s(s({},y.animation),{},{duration:e})}),isEnabled:!R,trigger:(null===(g=y.animation)||void 0===g?void 0:g.trigger)||"start",onTriggerChange:e=>x({animation:s(s({},y.animation),{},{trigger:e})}),triggerLayerId:(null===(m=y.animation)||void 0===m?void 0:m.triggerLayerId)||"",onTriggerLayerIdChange:e=>x({animation:s(s({},y.animation),{},{triggerLayerId:e})}),restartOnClick:null===(v=y.animation)||void 0===v?void 0:v.restartOnClick,onRestartOnClickChange:e=>x({animation:s(s({},y.animation),{},{restartOnClick:e})}),layers:L,snapStep:M,setSnapStep:T,showEvents:!1,showTriggerTextTyping:!1,textEvents:w}),(0,c.jsx)("div",{style:{marginTop:"10px"},children:(0,c.jsx)(tK,{data:y.animation,onUpdateData:e=>x({animation:e}),currentTime:E,onTimeChange:e=>{D(e),x({_previewTime:e})},selectedElementId:F,isEnabled:!0,onPlayStateChange:z,snapStep:M})})]}):(0,c.jsxs)("div",{style:{textAlign:"center",padding:"20px 10px",color:"#777",fontSize:"12px"},children:[(0,c.jsx)("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"\ud83d\udc46"}),(0,c.jsx)("div",{children:"\u0420\u0435\u0436\u0438\u043c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d."}),(0,c.jsxs)("div",{style:{fontSize:"11px",marginTop:"5px",color:"#555"},children:["\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 ",(0,c.jsx)("b",{children:'"\u0420\u0435\u0436\u0438\u043c \u0437\u0430\u043f\u0438\u0441\u0438 (REC)"'})," \u0432\u0432\u0435\u0440\u0445\u0443 \u043f\u0430\u043d\u0435\u043b\u0438,",(0,c.jsx)("br",{}),"\u0447\u0442\u043e\u0431\u044b \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0430\u0439\u043c\u043b\u0430\u0439\u043d \u0438 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u043a\u043b\u044e\u0447\u0438."]})]})})]}),(0,c.jsx)("div",{style:{marginTop:"20px",borderTop:"1px solid #444",paddingTop:"15px",paddingBottom:"5px"},children:(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),window.confirm("\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0412\u0421\u0415 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0446\u0432\u0435\u0442\u043e\u043a\u043e\u0440\u0440\u0435\u043a\u0446\u0438\u0438?")&&x({enabled:!1,renderAbove:!0,brightness:1,contrast:1,saturate:1,temperature:0,hueRotate:0,fadeAmount:0,fadeColor:"#1a1a1a",grayscale:0,sepia:0,isolation:{color:null,bgDesaturation:0,bgDarkening:0,spread:0},vignette:{enabled:!1,intensity:.5,size:.5,color:"#000000"},tint:{enabled:!1,color:"#ff0000",opacity:.2,mode:"soft-light"},animation:{enabled:!1,elements:{[F]:{}},duration:10},chromatic:{enabled:!1,intensity:0,deadZone:.2}})},style:{width:"100%",padding:"10px",background:"#d32f2f",color:"#fff",border:"1px solid #b71c1c",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.5px",transition:"background 0.2s"},children:"\u26a0\ufe0f \u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0446\u0432\u0435\u0442\u0430"})})]})]})},bK=t=>{let{settings:n,onUpdate:r,textureFiles:o,isExpanded:i,onToggle:a,isAnimMode:l=!1,isTimelinePlaying:d=!1,currentTime:u=0,animData:p=null,onUpdateAnimData:h,assetsMap:f}=t;const[g,m]=(0,e.useState)(!1),v="main",y=(0,e.useMemo)(()=>({sys_textures:{id:"sys_textures",name:"Textures",files:o||[]}}),[o]),x=(e,t)=>{var r;if(l){var o;const t="texture_".concat(e),n=BB(null===p||void 0===p||null===(o=p.elements)||void 0===o?void 0:o[v],t,u);if(null!==n)return n}return null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:t},b=(e,t)=>{if(l){if(d)return;const n="texture_".concat(e);let r=p?JSON.parse(JSON.stringify(p)):{duration:10,elements:{[v]:{}}};r=LB(r,v,n,u,t),h(r)}else r({[e]:t})},w=(e,t)=>({onDoubleClick:n=>{n.stopPropagation(),b(e,t)}}),S={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",border:"1px solid #333"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",userSelect:"none"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#ff9800",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"},tabContainer:{display:"flex",background:"#1e1e1e",borderRadius:"4px",padding:"2px",marginBottom:"10px",border:"1px solid #444"},tab:e=>({flex:1,textAlign:"center",padding:"4px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",background:e?"#ff9800":"transparent",color:e?"#000":"#888",fontWeight:e?"bold":"normal",transition:"0.2s"})},k=(null===n||void 0===n?void 0:n.textureType)||"file";return(0,c.jsxs)("div",{style:S.panel,children:[(0,c.jsxs)("div",{style:S.header,onClick:a,children:[(0,c.jsx)("input",{type:"checkbox",checked:!(!n||!n.enabled),onClick:e=>e.stopPropagation(),onChange:e=>r({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#ff9800"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430 / \u041e\u0432\u0435\u0440\u043b\u0435\u0439"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#ff9800",background:"rgba(255, 152, 0, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:n&&n.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:i?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),i&&(0,c.jsxs)("div",{style:{padding:"0 5px",opacity:null!==n&&void 0!==n&&n.enabled?1:.5,pointerEvents:null!==n&&void 0!==n&&n.enabled?"auto":"none",transition:"0.3s"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",marginTop:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043e\u0432\u0435\u0440\u0445 \u0432\u0441\u0435\u0433\u043e"}),(0,c.jsx)("input",{type:"checkbox",checked:!1!==(null===n||void 0===n?void 0:n.renderAbove),onChange:e=>r({renderAbove:e.target.checked}),style:{accentColor:"#ff9800"}})]}),(0,c.jsxs)("div",{style:S.tabContainer,children:[(0,c.jsx)("div",{style:S.tab("file"===k),onClick:()=>r({textureType:"file"}),children:"\ud83d\udcc1 \u0424\u0430\u0439\u043b"}),(0,c.jsx)("div",{style:S.tab("preset"===k),onClick:()=>r({textureType:"preset"}),children:"\u2699\ufe0f \u0413\u043e\u0442\u043e\u0432\u0430\u044f"})]}),"file"===k&&(0,c.jsx)("div",{style:{marginBottom:"10px"},children:(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flex:1,background:"#1e1e1e",border:"1px solid #444",padding:"5px 8px",borderRadius:"4px",fontSize:"11px",color:null!==n&&void 0!==n&&n.url?"#fff":"#777",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:null===n||void 0===n?void 0:n.url,children:null!==n&&void 0!==n&&n.url?n.url.split("/").pop():"\u0424\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d"}),(0,c.jsx)("button",{onClick:()=>m(!0),style:{background:"#444",border:"none",borderRadius:"4px",color:"#fff",padding:"5px 10px",cursor:"pointer",fontSize:"11px"},children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"})]})}),"preset"===k&&(0,c.jsxs)("div",{style:{marginBottom:"15px",background:"#333",padding:"8px",borderRadius:"4px"},children:[(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\u0422\u0438\u043f \u0443\u0437\u043e\u0440\u0430"}),(0,c.jsx)("select",{value:(null===n||void 0===n?void 0:n.presetType)||"noise",onChange:e=>r({presetType:e.target.value}),style:S.selectInput,children:[{value:"noise",label:"Noise (\u0428\u0443\u043c)"},{value:"scanlines",label:"Scanlines (\u041f\u043e\u043b\u043e\u0441\u044b / \u042d\u041b\u0422)"},{value:"grid",label:"Grid (\u0421\u0435\u0442\u043a\u0430)"},{value:"checkerboard",label:"Checker (\u0428\u0430\u0448\u043a\u0438)"},{value:"polka-dots",label:"Polka Dots (\u0413\u043e\u0440\u043e\u0448\u0435\u043a)"},{value:"honeycomb",label:"Honeycomb (\u0421\u043e\u0442\u044b)"},{value:"diagonal",label:"Diagonal (\u0414\u0438\u0430\u0433\u043e\u043d\u0430\u043b\u0438)"},{value:"vignette",label:"Vignette (\u0412\u0438\u043d\u044c\u0435\u0442\u043a\u0430)"},{value:"paper",label:"Paper (\u0411\u0443\u043c\u0430\u0433\u0430/\u0413\u0440\u0430\u043d\u0436)"}].map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))})]}),"noise"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0437\u0435\u0440\u043d\u0430"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("noiseScale",50).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"1",max:"100",step:"1",style:S.rangeInput,value:x("noiseScale",50),onChange:e=>b("noiseScale",parseFloat(e.target.value))},w("noiseScale",50)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442\u043d\u043e\u0439 \u0448\u0443\u043c"}),(0,c.jsx)("input",{type:"checkbox",checked:x("noiseColor",!1),onChange:e=>b("noiseColor",e.target.checked),style:{accentColor:"#ff9800"}})]})]}),"scanlines"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c (Scale)"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("lineDensity",50).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"5",max:"200",step:"5",style:S.rangeInput,value:x("lineDensity",50),onChange:e=>b("lineDensity",parseFloat(e.target.value))},w("lineDensity",50)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438"}),(0,c.jsxs)("span",{style:S.valueLabel,children:[x("lineThickness",20).toFixed(0),"%"]})]}),(0,c.jsx)("input",s({type:"range",min:"1",max:"90",step:"1",style:S.rangeInput,value:x("lineThickness",20),onChange:e=>b("lineThickness",parseFloat(e.target.value))},w("lineThickness",20)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0412\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0436\u0435"}),(0,c.jsx)("input",{type:"checkbox",checked:x("lineVertical",!1),onChange:e=>b("lineVertical",e.target.checked),style:{accentColor:"#ff9800"}})]})]}),"grid"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u044f\u0447\u0435\u0439\u043a\u0438"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("gridSize",40).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"10",max:"200",step:"5",style:S.rangeInput,value:x("gridSize",40),onChange:e=>b("gridSize",parseFloat(e.target.value))},w("gridSize",40)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u0441\u0435\u0442\u043a\u0438"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("gridThickness",1).toFixed(1)})]}),(0,c.jsx)("input",s({type:"range",min:"0.5",max:"10",step:"0.5",style:S.rangeInput,value:x("gridThickness",1),onChange:e=>b("gridThickness",parseFloat(e.target.value))},w("gridThickness",1)))]})]}),"checkerboard"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0448\u0430\u0448\u043a\u0438"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("checkSize",50).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"10",max:"200",step:"5",style:S.rangeInput,value:x("checkSize",50),onChange:e=>b("checkSize",parseFloat(e.target.value))},w("checkSize",50)))]}),"polka-dots"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u043e\u0447\u043a\u0438"}),(0,c.jsxs)("span",{style:S.valueLabel,children:[x("dotSize",2).toFixed(1),"px"]})]}),(0,c.jsx)("input",s({type:"range",min:"1",max:"50",step:"0.5",style:S.rangeInput,value:x("dotSize",2),onChange:e=>b("dotSize",parseFloat(e.target.value))},w("dotSize",2)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435"}),(0,c.jsxs)("span",{style:S.valueLabel,children:[x("dotSpacing",20).toFixed(0),"px"]})]}),(0,c.jsx)("input",s({type:"range",min:"5",max:"100",step:"1",style:S.rangeInput,value:x("dotSpacing",20),onChange:e=>b("dotSpacing",parseFloat(e.target.value))},w("dotSpacing",20)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442"}),(0,c.jsx)("input",{type:"color",value:x("dotColor","#ffffff"),onChange:e=>b("dotColor",e.target.value),style:{width:"30px",height:"20px",border:"none",padding:0,background:"none",cursor:"pointer"}})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0428\u0430\u0445\u043c\u0430\u0442\u043d\u044b\u0439 \u043f\u043e\u0440\u044f\u0434\u043e\u043a"}),(0,c.jsx)("input",{type:"checkbox",checked:x("dotStagger",!1),onChange:e=>b("dotStagger",e.target.checked),style:{accentColor:"#ff9800"}})]})]}),"diagonal"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("diagThickness",2).toFixed(1)})]}),(0,c.jsx)("input",s({type:"range",min:"1",max:"50",step:"1",style:S.rangeInput,value:x("diagThickness",2),onChange:e=>b("diagThickness",parseFloat(e.target.value))},w("diagThickness",2)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u0440\u043e\u0431\u0435\u043b"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("diagSpacing",10).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"2",max:"100",step:"1",style:S.rangeInput,value:x("diagSpacing",10),onChange:e=>b("diagSpacing",parseFloat(e.target.value))},w("diagSpacing",10)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442 1"}),(0,c.jsx)("input",{type:"color",value:x("diagColor1","#ffffff"),onChange:e=>b("diagColor1",e.target.value),style:{width:"30px",height:"20px",border:"none",background:"none",cursor:"pointer"}})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442 2 (\u0424\u043e\u043d)"}),(0,c.jsx)("input",{type:"color",value:x("diagColor2","#000000"),onChange:e=>b("diagColor2",e.target.value),style:{width:"30px",height:"20px",border:"none",background:"none",cursor:"pointer"}})]})]}),"vignette"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0418\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("span",{style:S.valueLabel,children:[x("vigIntensity",50).toFixed(0),"%"]})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"100",step:"1",style:S.rangeInput,value:x("vigIntensity",50),onChange:e=>b("vigIntensity",parseFloat(e.target.value))},w("vigIntensity",50)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0426\u0432\u0435\u0442 \u0432\u0438\u043d\u044c\u0435\u0442\u043a\u0438"}),(0,c.jsx)("input",{type:"color",value:x("vigColor","#000000"),onChange:e=>b("vigColor",e.target.value),style:{width:"30px",height:"20px",border:"none",background:"none",cursor:"pointer"}})]})]}),"paper"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0417\u0435\u0440\u043d\u0438\u0441\u0442\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("paperGrain",1).toFixed(1)})]}),(0,c.jsx)("input",s({type:"range",min:"0.5",max:"3",step:"0.1",style:S.rangeInput,value:x("paperGrain",1),onChange:e=>b("paperGrain",parseFloat(e.target.value))},w("paperGrain",1)))]})}),"honeycomb"===(null===n||void 0===n?void 0:n.presetType)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0441\u043e\u0442\u044b"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("honeycombSize",30).toFixed(0)})]}),(0,c.jsx)("input",s({type:"range",min:"10",max:"150",step:"1",style:S.rangeInput,value:x("honeycombSize",30),onChange:e=>b("honeycombSize",parseFloat(e.target.value))},w("honeycombSize",30)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("honeycombStroke",1).toFixed(1)})]}),(0,c.jsx)("input",s({type:"range",min:"0.5",max:"10",step:"0.5",style:S.rangeInput,value:x("honeycombStroke",1),onChange:e=>b("honeycombStroke",parseFloat(e.target.value))},w("honeycombStroke",1)))]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0417\u0430\u043b\u0438\u0432\u043a\u0430"}),(0,c.jsx)("input",{type:"checkbox",checked:x("honeycombFill",!1),onChange:e=>b("honeycombFill",e.target.checked),style:{accentColor:"#ff9800"}})]})]})]}),(0,c.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"5px"},children:[(0,c.jsx)("button",{onClick:()=>r({mode:"original"}),style:{flex:1,padding:"4px",border:"none",borderRadius:"4px",cursor:"pointer",background:"original"===(null===n||void 0===n?void 0:n.mode)?"#ff9800":"#444",color:"#fff",fontSize:"10px"},children:"Repeat / Original"}),(0,c.jsx)("button",{onClick:()=>r({mode:"stretch"}),style:{flex:1,padding:"4px",border:"none",borderRadius:"4px",cursor:"pointer",background:"stretch"===(null===n||void 0===n?void 0:n.mode)?"#ff9800":"#444",color:"#fff",fontSize:"10px"},children:"Stretch"})]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ff9800"},children:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 (Scale)"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("scale",1).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0.1",max:"5",step:"0.05",style:S.rangeInput,value:x("scale",1),onChange:e=>b("scale",parseFloat(e.target.value))},w("scale",1)))]}),(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ff9800"},children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("opacity",.5).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"1",step:"0.05",style:S.rangeInput,value:x("opacity",.5),onChange:e=>b("opacity",parseFloat(e.target.value))},w("opacity",.5)))]}),(0,c.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ff9800",display:"block",marginBottom:"4px"},children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("select",{value:(null===n||void 0===n?void 0:n.blend)||"normal",onChange:e=>r({blend:e.target.value}),style:s(s({},S.selectInput),{},{borderColor:"#ff9800"}),children:[(0,c.jsx)("optgroup",{label:"\u0411\u0430\u0437\u043e\u0432\u044b\u0435",children:(0,c.jsx)("option",{value:"normal",children:"Normal (\u0411\u0435\u0437 \u044d\u0444\u0444\u0435\u043a\u0442\u0430)"})}),(0,c.jsxs)("optgroup",{label:"\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435 (\u0423\u0431\u0438\u0440\u0430\u0435\u0442 \u0431\u0435\u043b\u043e\u0435)",children:[(0,c.jsx)("option",{value:"multiply",children:"Multiply (\u0414\u043b\u044f \u0442\u0435\u043d\u0435\u0439 / \u0433\u0440\u044f\u0437\u0438)"}),(0,c.jsx)("option",{value:"darken",children:"Darken (\u0417\u0430\u043c\u0435\u043d\u0430 \u0442\u0435\u043c\u043d\u044b\u043c)"}),(0,c.jsx)("option",{value:"color-burn",children:"Color Burn (\u0412\u044b\u0436\u0438\u0433\u0430\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u0430)"})]}),(0,c.jsxs)("optgroup",{label:"\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435 (\u0423\u0431\u0438\u0440\u0430\u0435\u0442 \u0447\u0435\u0440\u043d\u043e\u0435)",children:[(0,c.jsx)("option",{value:"screen",children:"Screen (\u0414\u043b\u044f \u0431\u043b\u0438\u043a\u043e\u0432 / \u043e\u0433\u043d\u044f)"}),(0,c.jsx)("option",{value:"lighten",children:"Lighten (\u0417\u0430\u043c\u0435\u043d\u0430 \u0441\u0432\u0435\u0442\u043b\u044b\u043c)"}),(0,c.jsx)("option",{value:"color-dodge",children:"Color Dodge (\u042f\u0440\u043a\u043e\u0435 \u043e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435)"})]}),(0,c.jsxs)("optgroup",{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442 (Overlay)",children:[(0,c.jsx)("option",{value:"overlay",children:"Overlay (\u0421\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u0435)"}),(0,c.jsx)("option",{value:"soft-light",children:"Soft Light (\u041c\u044f\u0433\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"hard-light",children:"Hard Light (\u0416\u0435\u0441\u0442\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"vivid-light",children:"Vivid Light (\u042d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0432\u0435\u0442)"})]}),(0,c.jsxs)("optgroup",{label:"\u0418\u043d\u0432\u0435\u0440\u0441\u0438\u044f \u0438 \u0420\u0430\u0437\u043d\u0438\u0446\u0430",children:[(0,c.jsx)("option",{value:"difference",children:"Difference (\u041d\u0435\u0433\u0430\u0442\u0438\u0432 / \u0420\u0430\u0437\u043d\u0438\u0446\u0430)"}),(0,c.jsx)("option",{value:"exclusion",children:"Exclusion (\u041c\u044f\u0433\u043a\u0430\u044f \u0440\u0430\u0437\u043d\u0438\u0446\u0430)"})]}),(0,c.jsxs)("optgroup",{label:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0426\u0432\u0435\u0442\u0430",children:[(0,c.jsx)("option",{value:"hue",children:"Hue (\u0422\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0442\u0435\u043d\u043e\u043a)"}),(0,c.jsx)("option",{value:"saturation",children:"Saturation (\u0422\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0441\u0442\u044c)"}),(0,c.jsx)("option",{value:"color",children:"Color (\u0422\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0447/\u0431)"}),(0,c.jsx)("option",{value:"luminosity",children:"Luminosity (\u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0430)"})]})]})]}),(0,c.jsxs)("details",{style:{marginTop:"10px"},children:[(0,c.jsx)("summary",{style:{fontSize:"12px",color:"#ff9800",cursor:"pointer"},children:"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e (\u041f\u043e\u0437\u0438\u0446\u0438\u044f/\u0426\u0432\u0435\u0442)"}),(0,c.jsxs)("div",{style:{marginTop:"10px",paddingLeft:"5px",borderLeft:"2px solid #444"},children:[(0,c.jsxs)("div",{style:S.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:S.valueLabel,children:x("brightness",1).toFixed(2)})]}),(0,c.jsx)("input",s({type:"range",min:"0",max:"3",step:"0.05",style:S.rangeInput,value:x("brightness",1),onChange:e=>b("brightness",parseFloat(e.target.value))},w("brightness",1)))]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"5px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#ccc"},children:"\u041f\u043e\u0437. X"}),(0,c.jsx)("input",s({type:"range",min:"-500",max:"500",step:"10",style:s(s({},S.rangeInput),{},{height:"4px"}),value:x("offsetX",0),onChange:e=>b("offsetX",parseFloat(e.target.value))},w("offsetX",0)))]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#ccc"},children:"\u041f\u043e\u0437. Y"}),(0,c.jsx)("input",s({type:"range",min:"-500",max:"500",step:"10",style:s(s({},S.rangeInput),{},{height:"4px"}),value:x("offsetY",0),onChange:e=>b("offsetY",parseFloat(e.target.value))},w("offsetY",0)))]})]})]})]})]}),(0,c.jsx)(UL,{isOpen:g,onClose:()=>m(!1),title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0443",assets:y,rootId:"sys_textures",allowedTypes:["png","jpg","jpeg","webp","svg"],assetsMap:f,onSelect:e=>{r({url:e.local_path||e.file_id}),m(!1)}})]})},wK=e=>e.touches&&e.touches.length>0?e.touches[0].clientX:e.clientX,SK=t=>{let{currentTime:n,onTimeChange:r}=t;const[o,i]=(0,e.useState)(10),[a,s]=(0,e.useState)(!1),[l,d]=(0,e.useState)(!1),u=(0,e.useRef)(null),p=(0,e.useRef)(null),h=(0,e.useRef)(n),f=(0,e.useRef)(r),g=(0,e.useRef)(null);(0,e.useEffect)(()=>{h.current=n},[n]),(0,e.useEffect)(()=>{f.current=r},[r]),(0,e.useEffect)(()=>{if(a){g.current=performance.now();const e=t=>{const n=(t-g.current)/1e3;g.current=t;let r=h.current+n;r>=o&&(r=0),f.current(r),p.current=requestAnimationFrame(e)};p.current=requestAnimationFrame(e)}else p.current&&cancelAnimationFrame(p.current),g.current=null;return()=>{p.current&&cancelAnimationFrame(p.current)}},[a,o]);const m=e=>{if(!u.current)return 0;const t=u.current.getBoundingClientRect();let n=(e-t.left)/t.width*o;return n<0&&(n=0),n>o&&(n=o),n},v=e=>{s(!1),d(!0);const t=wK(e),n=m(t);r(n)};(0,e.useEffect)(()=>{const e=e=>{if(l){const t=wK(e),n=m(t);r(n)}},t=()=>d(!1);return l&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),window.addEventListener("touchmove",e,{passive:!1}),window.addEventListener("touchend",t)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),window.removeEventListener("touchmove",e),window.removeEventListener("touchend",t)}},[l,o,r]);const y={label:{fontSize:"10px",color:"#777",marginBottom:"4px"},input:{background:"#1a1a1a",border:"1px solid #444",color:"#fff",padding:"2px 5px",borderRadius:"3px",fontSize:"10px",width:"40px",textAlign:"center"},playBtn:{background:a?"#ffc107":"#00bcd4",border:"none",borderRadius:"3px",color:a?"#000":"#fff",padding:"4px 10px",cursor:"pointer",fontWeight:"bold",fontSize:"10px"}};return(0,c.jsxs)("div",{style:{marginTop:"15px",borderTop:"1px dashed #444",paddingTop:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("button",{onClick:()=>s(!a),style:y.playBtn,children:a?"PAUSE":"PLAY"}),(0,c.jsxs)("span",{style:{fontFamily:"monospace",fontSize:"11px",color:"#ccc"},children:[n.toFixed(2),"s"]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,c.jsx)("span",{style:y.label,children:"Max:"}),(0,c.jsx)("input",{type:"number",value:o,min:1,max:60,onChange:e=>i(parseFloat(e.target.value)||10),style:y.input})]})]}),(0,c.jsxs)("div",{ref:u,onMouseDown:v,onTouchStart:v,style:{position:"relative",height:"34px",background:"#111",borderRadius:"4px",cursor:"pointer",border:"1px solid #444",overflow:"hidden",touchAction:"none"},children:[(0,c.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:"linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px)",backgroundSize:"".concat(100/o,"% 100%")}}),(0,c.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"".concat(n/o*100,"%"),background:"rgba(0, 188, 212, 0.2)",pointerEvents:"none"}}),(0,c.jsx)("div",{style:{position:"absolute",left:"".concat(n/o*100,"%"),top:0,bottom:0,width:2,background:"#00bcd4",zIndex:10,pointerEvents:"none",boxShadow:"0 0 5px #00bcd4"}})]})]})},kK=e=>{var t,n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_;let{settings:E,onUpdate:D,currentTime:M,onTimeChange:T,isExpanded:I,onToggle:A}=e;const O={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},subHeader:{background:"#333",padding:"8px 12px",borderRadius:"4px",marginTop:"5px",marginBottom:"5px",fontSize:"11px",fontWeight:"600",color:"#ddd",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",border:"1px solid #3f3f3f",userSelect:"none"},subContent:{padding:"8px",borderLeft:"2px solid #444",marginLeft:"4px",marginBottom:"10px"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},checkboxRow:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"}},R=E||{enabled:!1,mode:"shake",preset:"left_right",strength:.5,speed:.5,layerShift:!1,reverse:!1},z=R.focus||{},F=e=>{const t=R.focus||{enabled:!1,mode:"manual",depth:50,blurStrength:2,blurFront:1,blurBack:1,preset:"far_to_near",speed:1,randomness:0};D({focus:s(s({},t),e)})};return(0,c.jsxs)("div",{style:O.panel,children:[(0,c.jsxs)("div",{style:O.header,onClick:A,children:[(0,c.jsx)("input",{type:"checkbox",checked:!!R.enabled,onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target.checked;D(t?{enabled:!0}:{enabled:!1,focus:s(s({},R.focus),{},{enabled:!1})})},style:{cursor:"pointer",accentColor:"#00bcd4"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u041a\u0430\u043c\u0435\u0440\u0430 \u0438 \u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \ud83c\udfa5"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00bcd4",background:"rgba(0, 188, 212, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:R.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:I?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),I&&(0,c.jsxs)("div",{style:{padding:"0 5px",opacity:R.enabled?1:.4,pointerEvents:R.enabled?"auto":"none",filter:R.enabled?"none":"grayscale(100%)",transition:"all 0.3s ease"},children:[(0,c.jsxs)("div",{style:{marginTop:"10px",borderTop:"1px solid #444",paddingTop:"10px"},children:[(0,c.jsxs)("div",{style:s(s({},O.subHeader),{},{marginBottom:"10px"}),onClick:()=>D({affectWidget:!R.affectWidget}),children:[(0,c.jsx)("span",{children:"\ud83e\udde9 \u0423\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441"}),(0,c.jsx)("input",{type:"checkbox",checked:!!R.affectWidget,onChange:()=>{},style:{pointerEvents:"none",accentColor:"#00bcd4"}})]}),R.affectWidget&&(0,c.jsx)("div",{style:s(s({},O.subContent),{},{background:"rgba(0, 0, 0, 0.25)",padding:"8px 10px",borderRadius:"6px"}),children:(0,c.jsx)("div",{style:{fontSize:"10px",color:"#aaa"},children:"\u0415\u0441\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e, \u043a\u043d\u043e\u043f\u043a\u0438 \u0438 UI \u0442\u043e\u0436\u0435 \u0431\u0443\u0434\u0443\u0442 \u0442\u0440\u044f\u0441\u0442\u0438\u0441\u044c, \u0441\u043c\u0435\u0449\u0430\u0442\u044c\u0441\u044f \u0438 \u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u044d\u0444\u0444\u0435\u043a\u0442\u0430\u0445 \u043a\u0430\u043c\u0435\u0440\u044b."})})]}),(0,c.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"5px"},children:[(0,c.jsx)("button",{onClick:()=>D({mode:"shake"}),style:{flex:1,padding:"6px",border:"none",borderRadius:"4px",cursor:"pointer",background:"shake"===R.mode?"#00bcd4":"#444",color:"#fff",fontSize:"11px"},children:"\u0422\u0440\u044f\u0441\u043a\u0430"}),(0,c.jsx)("button",{onClick:()=>D({mode:"preset"}),style:{flex:1,padding:"6px",border:"none",borderRadius:"4px",cursor:"pointer",background:"preset"===R.mode?"#00bcd4":"#444",color:"#fff",fontSize:"11px"},children:"\u0422\u0440\u0430\u0435\u043a\u0442\u043e\u0440\u0438\u044f"})]}),"preset"===R.mode&&(0,c.jsxs)("div",{style:{marginBottom:"10px",background:"#333",padding:"8px",borderRadius:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\u0422\u0438\u043f \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("select",{value:R.preset||"slide_left_right",onChange:e=>D({preset:e.target.value}),style:O.selectInput,children:[(0,c.jsxs)("optgroup",{label:"\u041f\u0430\u043d\u043e\u0440\u0430\u043c\u0430 / \u0421\u0434\u0432\u0438\u0433",children:[(0,c.jsx)("option",{value:"slide_left_right",children:"\u2194 \u0421\u043b\u0435\u0432\u0430 \u043d\u0430\u043f\u0440\u0430\u0432\u043e (Slide)"}),(0,c.jsx)("option",{value:"slide_up_down",children:"\u2195 \u0421\u0432\u0435\u0440\u0445\u0443 \u0432\u043d\u0438\u0437 (Slide)"}),(0,c.jsx)("option",{value:"move_diagonal",children:"\u2198 \u041f\u043e \u0434\u0438\u0430\u0433\u043e\u043d\u0430\u043b\u0438"}),(0,c.jsx)("option",{value:"move_arc",children:"\u2229 \u041f\u043e \u0434\u0443\u0433\u0435 / \u041a\u0440\u0443\u0433"})]}),(0,c.jsxs)("optgroup",{label:"\u0417\u0443\u043c (\u041f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u0435)",children:[(0,c.jsx)("option",{value:"zoom_center",children:"\ud83d\udd0d \u0417\u0443\u043c (\u0426\u0435\u043d\u0442\u0440)"}),(0,c.jsx)("option",{value:"zoom_point",children:"\ud83c\udfaf \u0417\u0443\u043c (\u041a \u0442\u043e\u0447\u043a\u0435)"}),(0,c.jsx)("option",{value:"zoom_left_top",children:"\u2196 \u0417\u0443\u043c \u0432 \u041b\u0435\u0432\u043e-\u0412\u0435\u0440\u0445"}),(0,c.jsx)("option",{value:"zoom_right_top",children:"\u2197 \u0417\u0443\u043c \u0432 \u041f\u0440\u0430\u0432\u043e-\u0412\u0435\u0440\u0445"}),(0,c.jsx)("option",{value:"zoom_left_bottom",children:"\u2199 \u0417\u0443\u043c \u0432 \u041b\u0435\u0432\u043e-\u041d\u0438\u0437"}),(0,c.jsx)("option",{value:"zoom_right_bottom",children:"\u2198 \u0417\u0443\u043c \u0432 \u041f\u0440\u0430\u0432\u043e-\u041d\u0438\u0437"})]}),(0,c.jsx)("optgroup",{label:"\u0412\u0440\u0430\u0449\u0435\u043d\u0438\u0435",children:(0,c.jsx)("option",{value:"rotate_pendulum",children:"\u21bb \u041c\u0430\u044f\u0442\u043d\u0438\u043a"})})]}),"zoom_point"===R.preset&&(0,c.jsxs)("div",{style:{marginTop:"10px",padding:"8px",background:"#222",borderRadius:"4px",border:"1px solid #444"},children:[(0,c.jsx)("div",{style:{marginBottom:"6px",fontSize:"11px",color:"#00bcd4",fontWeight:"bold"},children:"\u0422\u043e\u0447\u043a\u0430 \u043f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u044f (%)"}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u043e\u0437\u0438\u0446\u0438\u044f X"}),(0,c.jsxs)("span",{style:O.valueLabel,children:[Math.round(null!==(t=R.targetX)&&void 0!==t?t:50),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(n=R.targetX)&&void 0!==n?n:50,onChange:e=>D({targetX:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u043e\u0437\u0438\u0446\u0438\u044f Y"}),(0,c.jsxs)("span",{style:O.valueLabel,children:[Math.round(null!==(r=R.targetY)&&void 0!==r?r:50),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(o=R.targetY)&&void 0!==o?o:50,onChange:e=>D({targetY:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:s(s({},O.checkboxRow),{},{marginBottom:0}),children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0442\u043e\u0447\u043a\u0443 (Debug)"}),(0,c.jsx)("input",{type:"checkbox",checked:!!R.showTargetDebug,onChange:e=>D({showTargetDebug:e.target.checked}),style:{accentColor:"#00bcd4"}})]})]}),(0,c.jsxs)("div",{style:{marginTop:"10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,c.jsxs)("div",{style:{display:"flex",background:"#222",borderRadius:"4px",overflow:"hidden",border:"1px solid #444"},children:[(0,c.jsx)("button",{onClick:()=>D({loopMode:"once"}),title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c 1 \u0440\u0430\u0437 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0441\u044f",style:{fontSize:"10px",padding:"4px 8px",border:"none",cursor:"pointer",background:"once"===R.loopMode?"#00bcd4":"transparent",color:"once"===R.loopMode?"#000":"#888"},children:"1 \u0440\u0430\u0437"}),(0,c.jsx)("div",{style:{width:1,background:"#444"}}),(0,c.jsx)("button",{onClick:()=>D({loopMode:"loop"}),title:"\u0411\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u043e \u0442\u0443\u0434\u0430-\u0441\u044e\u0434\u0430",style:{fontSize:"10px",padding:"4px 8px",border:"none",cursor:"pointer",background:"once"!==R.loopMode?"#00bcd4":"transparent",color:"once"!==R.loopMode?"#000":"#888"},children:"\u0426\u0438\u043a\u043b"})]}),(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!R.reverse,onChange:e=>D({reverse:e.target.checked}),style:{accentColor:"#ff5722"}}),(0,c.jsx)("span",{style:{fontSize:"11px",color:"#ccc"},children:"\u0418\u043d\u0432\u0435\u0440\u0441\u0438\u044f"})]})]}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginTop:"6px",lineHeight:"1.3"},children:"once"===R.loopMode?"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0439\u0434\u0435\u0442 \u0434\u043e \u043f\u0438\u043a\u043e\u0432\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0442\u0430\u043c \u043d\u0430\u0432\u0441\u0435\u0433\u0434\u0430 (\u043f\u043e\u043a\u0430 \u043d\u0435 \u0438\u0441\u0442\u0435\u0447\u0435\u0442 \u0442\u0430\u0439\u043c\u0435\u0440).":"\u041a\u0430\u043c\u0435\u0440\u0430 \u0431\u0443\u0434\u0435\u0442 \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u043e \u0434\u0432\u0438\u0433\u0430\u0442\u044c\u0441\u044f \u0442\u0443\u0434\u0430 \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e."}),(0,c.jsxs)("div",{style:s(s({},O.checkboxRow),{},{marginBottom:"10px",borderBottom:"1px dashed #444",paddingBottom:"6px"}),children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff"},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0422\u0440\u044f\u0441\u043a\u0443"}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#777"},children:"\u041d\u0430\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442 \u0442\u0440\u044f\u0441\u043a\u0438 \u043f\u043e\u0432\u0435\u0440\u0445 \u043f\u0443\u0442\u0438"})]}),(0,c.jsx)("input",{type:"checkbox",checked:!!R.addShake,onChange:e=>D({addShake:e.target.checked}),style:{accentColor:"#00bcd4",cursor:"pointer"}})]})]}),(0,c.jsxs)("div",{style:{marginBottom:"10px",borderBottom:"1px solid #444",paddingBottom:"10px"},children:[(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430 \u0441\u0442\u0430\u0440\u0442\u0430 (\u0441\u0435\u043a)"}),(0,c.jsxs)("span",{style:O.valueLabel,children:[R.startDelay||0,"s"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.5",style:s(s({},O.rangeInput),{},{accentColor:"#4caf50"}),value:R.startDelay||0,onChange:e=>D({startDelay:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c / \u0422\u0430\u0439\u043c\u0435\u0440 \u043a\u043e\u043d\u0446\u0430"}),(0,c.jsx)("span",{style:O.valueLabel,children:R.duration>0?R.duration+"s":"\u221e"})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"30",step:"1",style:s(s({},O.rangeInput),{},{accentColor:"#ff9800"}),value:R.duration||0,onChange:e=>D({duration:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginTop:"-2px"},children:R.duration>0?"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 ".concat(R.duration," \u0441\u0435\u043a."):'\u0411\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u0430\u044f \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f (\u0435\u0441\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e "\u0412\u0435\u0447\u043d\u043e")'})]})]}),("shake"===R.mode||"preset"===R.mode&&R.addShake)&&(0,c.jsxs)("div",{style:{marginBottom:"10px",background:"preset"===R.mode?"rgba(0,0,0,0.2)":"transparent",padding:"preset"===R.mode?"8px":"0",borderRadius:"4px",border:"preset"===R.mode?"1px dashed #444":"none"},children:["preset"===R.mode&&(0,c.jsx)("div",{style:{fontSize:"10px",color:"#00bcd4",marginBottom:"5px",fontWeight:"bold"},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0439 \u0442\u0440\u044f\u0441\u043a\u0438:"}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430 \u0442\u0440\u044f\u0441\u043a\u0438"}),(0,c.jsx)("span",{style:s(s({},O.valueLabel),{},{width:"auto",minWidth:"30px"}),children:(null!==(i=R.shakeStrength)&&void 0!==i?i:.5).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"3",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:void 0!==R.shakeStrength?R.shakeStrength:.5,onChange:e=>D({shakeStrength:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0442\u0440\u044f\u0441\u043a\u0438"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(a=R.shakeSpeed)&&void 0!==a?a:.5})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:void 0!==R.shakeSpeed?R.shakeSpeed:.5,onChange:e=>D({shakeSpeed:parseFloat(e.target.value)})})]})]}),"preset"===R.mode&&(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438 / \u0417\u0443\u043c\u0430"}),(0,c.jsx)("span",{style:s(s({},O.valueLabel),{},{width:"auto",minWidth:"30px"}),children:(null!==(l=R.animStrength)&&void 0!==l?l:.5).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"3",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#ff9800"}),value:void 0!==R.animStrength?R.animStrength:.5,onChange:e=>D({animStrength:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(d=R.animSpeed)&&void 0!==d?d:.5})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#ff9800"}),value:void 0!==R.animSpeed?R.animSpeed:.5,onChange:e=>D({animSpeed:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0414\u043e\u043f. \u041c\u0430\u0441\u0448\u0442\u0430\u0431 (Zoom+)"}),(0,c.jsx)("span",{style:O.valueLabel,children:(R.extraScale||0).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"0.5",step:"0.01",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:R.extraScale||0,onChange:e=>D({extraScale:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginTop:"-2px"},children:"\u0423\u0432\u0435\u043b\u0438\u0447\u044c\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u043a\u0440\u044b\u0442\u044c \u0447\u0435\u0440\u043d\u044b\u0435 \u043a\u0440\u0430\u044f \u043f\u0440\u0438 \u0442\u0440\u044f\u0441\u043a\u0435."})]}),(0,c.jsxs)("div",{style:{marginTop:"10px",borderTop:"1px solid #444",paddingTop:"10px"},children:[(0,c.jsxs)("div",{style:s(s({},O.subHeader),{},{marginBottom:"10px"}),onClick:()=>F({enabled:!z.enabled}),children:[(0,c.jsx)("span",{children:"\ud83c\udfaf \u0417\u043e\u043d\u0430 \u0444\u043e\u043a\u0443\u0441\u0438\u0440\u043e\u0432\u043a\u0438 (DoF)"}),(0,c.jsx)("input",{type:"checkbox",checked:!!z.enabled,onChange:()=>{},style:{pointerEvents:"none",accentColor:"#e91e63"}})]}),z.enabled&&(0,c.jsxs)("div",{style:s(s({},O.subContent),{},{background:"rgba(0, 0, 0, 0.25)",padding:"10px",borderRadius:"6px"}),children:[(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\u0420\u0435\u0436\u0438\u043c \u0440\u0430\u0431\u043e\u0442\u044b"}),(0,c.jsxs)("select",{value:z.mode||"manual",onChange:e=>F({mode:e.target.value}),style:O.selectInput,children:[(0,c.jsx)("option",{value:"manual",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u043b\u0430\u0441\u0442\u044c (Manual)"}),(0,c.jsx)("option",{value:"animation",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0430\u0440\u0438\u0430\u043d\u0442 (Animation)"}),(0,c.jsx)("option",{value:"cursor",children:"\u041a\u0443\u0440\u0441\u043e\u0440 / \u041f\u0430\u043b\u0435\u0446"})]})]}),"manual"===z.mode&&(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0422\u043e\u0447\u043a\u0430 \u0444\u043e\u043a\u0443\u0441\u0430 (Z-Depth)"}),(0,c.jsxs)("span",{style:O.valueLabel,children:[null!==(u=z.depth)&&void 0!==u?u:50,"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(p=z.depth)&&void 0!==p?p:50,onChange:e=>F({depth:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777"},children:"0% = \u0414\u0430\u043b\u044c\u043d\u0438\u0435 \u0441\u043b\u043e\u0438, 100% = \u041f\u0435\u0440\u0435\u0434\u043d\u0438\u0435 \u0441\u043b\u043e\u0438"})]}),"animation"===z.mode&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{marginBottom:"10px"},children:(0,c.jsxs)("select",{value:z.preset||"far_to_near",onChange:e=>F({preset:e.target.value}),style:O.selectInput,children:[(0,c.jsx)("option",{value:"far_to_near",children:"\u0421\u0437\u0430\u0434\u0438 -> \u0412\u043f\u0435\u0440\u0435\u0434"}),(0,c.jsx)("option",{value:"near_to_far",children:"\u0421\u043f\u0435\u0440\u0435\u0434\u0438 -> \u041d\u0430\u0437\u0430\u0434"}),(0,c.jsx)("option",{value:"focusing",children:"\u0424\u043e\u043a\u0443\u0441\u0438\u0440\u043e\u0432\u043a\u0430 (\u0414\u044b\u0445\u0430\u043d\u0438\u0435)"})]})}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(h=z.speed)&&void 0!==h?h:1})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(f=z.speed)&&void 0!==f?f:1,onChange:e=>F({speed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.checkboxRow,children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0417\u0430\u0446\u0438\u043a\u043b\u0438\u0442\u044c"}),(0,c.jsx)("input",{type:"checkbox",checked:!!z.loop,onChange:e=>F({loop:e.target.checked}),style:{accentColor:"#e91e63"}})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u043d\u0434\u043e\u043c / \u0414\u0440\u043e\u0436\u0430\u043d\u0438\u0435"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(g=z.randomness)&&void 0!==g?g:0})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(m=z.randomness)&&void 0!==m?m:0,onChange:e=>F({randomness:parseFloat(e.target.value)})})]}),"focusing"===z.preset&&(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0426\u0435\u043d\u0442\u0440 \u0444\u043e\u043a\u0443\u0441\u0430 (Z)"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(v=z.targetZoneZ)&&void 0!==v?v:0})]}),(0,c.jsx)("input",{type:"number",style:{background:"#222",border:"1px solid #444",color:"#fff",width:"50px"},value:null!==(y=z.targetZoneZ)&&void 0!==y?y:0,onChange:e=>F({targetZoneZ:parseFloat(e.target.value)})})]})]}),"cursor"===z.mode&&(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0441\u043c\u0435\u043d\u044b \u0444\u043e\u043a\u0443\u0441\u0430"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(x=z.trackingSpeed)&&void 0!==x?x:.1})]}),(0,c.jsx)("input",{type:"range",min:"0.01",max:"0.5",step:"0.01",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(b=z.trackingSpeed)&&void 0!==b?b:.1,onChange:e=>F({trackingSpeed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{marginTop:"10px",paddingTop:"5px",borderTop:"1px dashed #444"},children:[(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430 \u0440\u0430\u0437\u043c\u044b\u0442\u0438\u044f (Blur)"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(w=z.blurStrength)&&void 0!==w?w:5})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"0.5",style:s(s({},O.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(S=z.blurStrength)&&void 0!==S?S:5,onChange:e=>F({blurStrength:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa"},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u0441\u0437\u0430\u0434\u0438"}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",style:s(s({},O.rangeInput),{},{height:"4px"}),value:null!==(k=z.blurBack)&&void 0!==k?k:1,onChange:e=>F({blurBack:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa"},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u0441\u043f\u0435\u0440\u0435\u0434\u0438"}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",style:s(s({},O.rangeInput),{},{height:"4px"}),value:null!==(C=z.blurFront)&&void 0!==C?C:1,onChange:e=>F({blurFront:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{style:s(s({},O.checkboxRow),{},{marginTop:"10px"}),children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u044b\u0432\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441"}),(0,c.jsx)("input",{type:"checkbox",checked:!!z.affectWidget,onChange:e=>F({affectWidget:e.target.checked}),style:{accentColor:"#e91e63"}})]})]})]})]}),(0,c.jsxs)("div",{style:{marginTop:"10px",borderTop:"1px solid #444",paddingTop:"10px"},children:[(0,c.jsxs)("div",{style:s(s({},O.subHeader),{},{marginBottom:"10px"}),onClick:()=>D({layerShift:!R.layerShift}),children:[(0,c.jsx)("span",{children:"\u26f0\ufe0f \u0421\u043c\u0435\u0449\u0430\u0442\u044c \u0441\u043b\u043e\u0438 (3D/Parallax)"}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#00bcd4",background:"rgba(0, 188, 212, 0.1)",padding:"2px 5px",borderRadius:"4px",marginRight:"6px"},children:R.layerShift?"On":"Off"}),(0,c.jsx)("input",{type:"checkbox",checked:!!R.layerShift,onChange:()=>{},style:{pointerEvents:"none",accentColor:"#00bcd4"}})]}),R.layerShift&&(0,c.jsxs)("div",{style:s(s({},O.subContent),{},{background:"rgba(0, 0, 0, 0.25)",padding:"10px",borderRadius:"6px"}),children:[(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430 \u0441\u043c\u0435\u0449\u0435\u043d\u0438\u044f"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(j=R.parallaxStrength)&&void 0!==j?j:.5})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:void 0!==R.parallaxStrength?R.parallaxStrength:.5,onChange:e=>D({parallaxStrength:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:O.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"3D \u0413\u043b\u0443\u0431\u0438\u043d\u0430"}),(0,c.jsx)("span",{style:O.valueLabel,children:null!==(_=R.parallax3D)&&void 0!==_?_:.5})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",style:s(s({},O.rangeInput),{},{accentColor:"#00bcd4"}),value:void 0!==R.parallax3D?R.parallax3D:.5,onChange:e=>D({parallax3D:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginTop:"2px"},children:"\u0420\u0430\u0437\u043d\u0438\u0446\u0430 \u0432 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u0434\u0430\u043b\u044c\u043d\u0438\u043c \u0444\u043e\u043d\u043e\u043c \u0438 \u043f\u0435\u0440\u0435\u0434\u043d\u0438\u043c \u043f\u043b\u0430\u043d\u043e\u043c."})]})]})]}),R.enabled&&(0,c.jsx)(SK,{currentTime:M,onTimeChange:T})]})]})},CK=e=>{let{settings:t,onUpdate:n,onPreview:r,isExpanded:o,onToggle:i}=e;const a=t||{enabled:!1,type:"fade",duration:.5,ease:"easeInOut"},s={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#aa00ff",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"}};return(0,c.jsxs)("div",{style:s.panel,children:[(0,c.jsxs)("div",{style:s.header,onClick:i,children:[(0,c.jsx)("input",{type:"checkbox",checked:!!a.enabled,onClick:e=>e.stopPropagation(),onChange:e=>n({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#aa00ff"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u041f\u0435\u0440\u0435\u0445\u043e\u0434\u044b \ud83c\udfac"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#aa00ff",background:"rgba(170, 0, 255, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:a.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:o?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),o&&(0,c.jsxs)("div",{style:{padding:"0 5px",opacity:a.enabled?1:.4,pointerEvents:a.enabled?"auto":"none",filter:a.enabled?"none":"grayscale(100%)",transition:"all 0.3s ease"},children:[(0,c.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,c.jsx)("button",{onClick:r,style:{width:"100%",padding:"8px",background:a.enabled?"#aa00ff":"#444",color:"#fff",border:"none",borderRadius:"4px",cursor:a.enabled?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontWeight:"bold",opacity:a.enabled?1:.5},disabled:!a.enabled,children:"\u25b6 \u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginTop:"5px",textAlign:"center"},children:"\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u044d\u0442\u043e\u0442 \u0436\u0435"})]}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#888",marginBottom:"10px",fontStyle:"italic"},children:"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u042d\u0422\u041e\u0413\u041e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430."}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",display:"block",marginBottom:"5px"},children:"\u0422\u0438\u043f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430"}),(0,c.jsxs)("select",{value:a.type||"fade",onChange:e=>n({type:e.target.value}),style:s.selectInput,children:[(0,c.jsxs)("optgroup",{label:"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435",children:[(0,c.jsx)("option",{value:"fade",children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c (Fade)"}),(0,c.jsx)("option",{value:"crossfade",children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0435 \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u0435 (Crossfade)"}),(0,c.jsx)("option",{value:"flash_white",children:"\u0412\u0441\u043f\u044b\u0448\u043a\u0430 (\u0411\u0435\u043b\u044b\u0439 \u044d\u043a\u0440\u0430\u043d)"}),(0,c.jsx)("option",{value:"flash_black",children:"\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435 (\u0427\u0435\u0440\u043d\u044b\u0439 \u044d\u043a\u0440\u0430\u043d)"})]}),(0,c.jsxs)("optgroup",{label:"\u0421\u043b\u0430\u0439\u0434\u044b",children:[(0,c.jsx)("option",{value:"slide_left",children:"\u0421\u043b\u0430\u0439\u0434 \u0412\u043b\u0435\u0432\u043e (\u2190)"}),(0,c.jsx)("option",{value:"slide_right",children:"\u0421\u043b\u0430\u0439\u0434 \u0412\u043f\u0440\u0430\u0432\u043e (\u2192)"}),(0,c.jsx)("option",{value:"slide_up",children:"\u0421\u043b\u0430\u0439\u0434 \u0412\u0432\u0435\u0440\u0445 (\u2191)"}),(0,c.jsx)("option",{value:"slide_down",children:"\u0421\u043b\u0430\u0439\u0434 \u0412\u043d\u0438\u0437 (\u2193)"})]}),(0,c.jsxs)("optgroup",{label:"3D \u042d\u0444\u0444\u0435\u043a\u0442\u044b",children:[(0,c.jsx)("option",{value:"page_turn",children:"\ud83d\udcd6 \u041f\u0435\u0440\u0435\u043b\u0438\u0441\u0442\u044b\u0432\u0430\u043d\u0438\u0435 (\u041a\u043d\u0438\u0433\u0430)"}),(0,c.jsx)("option",{value:"flip_x",children:"3D \u041f\u0435\u0440\u0435\u0432\u043e\u0440\u043e\u0442 (\u0413\u043e\u0440\u0438\u0437\u043e\u043d\u0442)"}),(0,c.jsx)("option",{value:"flip_y",children:"3D \u041f\u0435\u0440\u0435\u0432\u043e\u0440\u043e\u0442 (\u0412\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c)"}),(0,c.jsx)("option",{value:"zoom_in",children:"\u041f\u0440\u0438\u0431\u043b\u0438\u0436\u0435\u043d\u0438\u0435 (Zoom In)"}),(0,c.jsx)("option",{value:"zoom_out",children:"\u041e\u0442\u0434\u0430\u043b\u0435\u043d\u0438\u0435 (Zoom Out)"})]}),(0,c.jsxs)("optgroup",{label:"\u0421\u043f\u0435\u0446\u044d\u0444\u0444\u0435\u043a\u0442\u044b",children:[(0,c.jsx)("option",{value:"blur",children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 (Blur)"}),(0,c.jsx)("option",{value:"tv_turn_on",children:"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0422\u0412 (TV)"}),(0,c.jsx)("option",{value:"iris_circle",children:"\u041a\u0440\u0443\u0433 (Iris)"}),(0,c.jsx)("option",{value:"wipe_diagonal",children:"\u0428\u0442\u043e\u0440\u043a\u0430 (\u0414\u0438\u0430\u0433\u043e\u043d\u0430\u043b\u044c)"})]})]})]}),(0,c.jsxs)("div",{style:s.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c (\u0441\u0435\u043a)"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0.1",max:"3",step:"0.1",style:s.rangeInput,value:a.duration||.5,onChange:e=>n({duration:parseFloat(e.target.value)})}),(0,c.jsxs)("span",{style:s.valueLabel,children:[a.duration,"s"]})]})]}),(0,c.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",display:"block",marginBottom:"5px"},children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0441\u0442\u044c (Easing)"}),(0,c.jsxs)("select",{value:a.ease||"easeInOut",onChange:e=>n({ease:e.target.value}),style:s.selectInput,children:[(0,c.jsx)("option",{value:"linear",children:"\u041b\u0438\u043d\u0435\u0439\u043d\u043e (Linear)"}),(0,c.jsx)("option",{value:"easeInOut",children:"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442 (Ease In-Out)"}),(0,c.jsx)("option",{value:"circOut",children:"\u0422\u043e\u0440\u043c\u043e\u0436\u0435\u043d\u0438\u0435 (Circ Out)"}),(0,c.jsx)("option",{value:"backOut",children:"\u0421 \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u043c (Back Out)"}),(0,c.jsx)("option",{value:"backIn",children:"\u0421 \u0440\u0430\u0437\u0433\u043e\u043d\u043e\u043c \u043d\u0430\u0437\u0430\u0434 (Back In)"}),(0,c.jsx)("option",{value:"anticipate",children:"\u041e\u0442\u0442\u044f\u0436\u043a\u0430 (Anticipate)"}),(0,c.jsx)("option",{value:"bounceOut",children:"\u041e\u0442\u0441\u043a\u043e\u043a (Bounce)"})]})]})]})]})},jK=e=>{let{isExpanded:t,onToggle:n,isParallaxActive:r,toggleParallax:o,masterParallax:i,onUpdateMaster:a,layers:l=[],onUpdateLayerParam:d,onToggleLayerOverflow:u,onToggleLayerParallax:p}=e;const h={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},sectionTitle:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},layerCard:{background:"#1e1e1e",border:"1px solid #333",borderRadius:"4px",padding:"6px 10px",marginBottom:"6px",display:"flex",alignItems:"center",gap:"10px"}},f=l.filter(e=>"folder"!==e.type).sort((e,t)=>t.z-e.z);return(0,c.jsxs)("div",{style:h.panel,children:[(0,c.jsxs)("div",{style:h.header,onClick:n,children:[(0,c.jsx)("input",{type:"checkbox",checked:r,onClick:e=>e.stopPropagation(),onChange:e=>o(e.target.checked),style:{cursor:"pointer",accentColor:"#7568ed"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u041f\u0430\u0440\u0430\u043b\u043b\u0430\u043a\u0441 (\u041f\u0441\u0435\u0432\u0434\u043e 3D)"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#7568ed",background:"rgba(117, 104, 237, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:r?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),t&&(0,c.jsxs)("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap",opacity:r?1:.4,filter:r?"none":"grayscale(100%)",pointerEvents:r?"auto":"none",transition:"opacity 0.3s, filter 0.3s",userSelect:r?"auto":"none"},children:[(0,c.jsxs)("div",{style:{flex:"1 1 200px",minWidth:"200px",borderRight:"1px solid #333",paddingRight:"20px"},children:[(0,c.jsx)("div",{style:h.sectionTitle,children:(0,c.jsx)("span",{children:"\ud83c\udf9b \u041e\u0431\u0449\u0438\u0435 (Master)"})}),(0,c.jsxs)("div",{style:h.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0438\u043b\u0430 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.05",style:h.rangeInput,value:i.intensity,onChange:e=>a(parseFloat(e.target.value),i.depth)}),(0,c.jsx)("span",{style:h.valueLabel,children:i.intensity.toFixed(2)})]})]}),(0,c.jsxs)("div",{style:h.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043d\u0438\u0446\u0430 \u0433\u043b\u0443\u0431\u0438\u043d\u044b (Z)"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"4",step:"0.1",style:h.rangeInput,value:i.depth,onChange:e=>a(i.intensity,parseFloat(e.target.value))}),(0,c.jsx)("span",{style:h.valueLabel,children:i.depth.toFixed(2)})]})]})]}),(0,c.jsxs)("div",{style:{flex:"1 1 240px",minWidth:"240px"},children:[(0,c.jsx)("div",{style:h.sectionTitle,children:(0,c.jsx)("span",{children:"\u2699 \u0421\u043b\u043e\u0438 (\u0411\u0435\u0437 \u043f\u0430\u043f\u043e\u043a)"})}),(0,c.jsxs)("div",{style:{maxHeight:"220px",overflowY:"auto",paddingRight:"4px"},children:[f.map(e=>{const t=void 0!==e.parallaxStrength?e.parallaxStrength:0,n=!0===e.disableParallax,r=e.z>50?"#4caf50":"#666";return(0,c.jsxs)("div",{style:s(s({},h.layerCard),{},{borderLeft:"3px solid ".concat(r),opacity:n?.5:1}),children:[(0,c.jsx)("input",{type:"checkbox",title:n?"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432 \u044d\u0444\u0444\u0435\u043a\u0442":"\u0418\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u0437 \u044d\u0444\u0444\u0435\u043a\u0442\u0430",checked:!n,onChange:()=>p(e.id),style:{cursor:"pointer",accentColor:"#4caf50",marginRight:"5px"}}),(0,c.jsxs)("label",{title:e.overflowVisible?"Overflow Visible":"Overflow Hidden",style:{display:"flex",alignItems:"center",cursor:"pointer",marginRight:"5px"},children:[(0,c.jsx)("input",{type:"checkbox",style:{display:"none"},checked:!!e.overflowVisible,onChange:()=>u(e.id)}),(0,c.jsx)("span",{style:{fontSize:"12px",filter:e.overflowVisible?"none":"grayscale(100%)",opacity:e.overflowVisible?1:.5},children:e.overflowVisible?"\ud83d\udc41":"\u2702"})]}),(0,c.jsxs)("div",{style:{width:"80px",display:"flex",flexDirection:"column"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"#fff"},children:e.name}),(0,c.jsxs)("span",{style:{fontSize:"9px",color:"#666"},children:["Z: ",e.z]})]}),(0,c.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("input",{type:"range",min:"-1",max:"5",step:"0.05",disabled:n,style:s(s({},h.rangeInput),{},{height:"4px"}),value:t,onChange:t=>d(e.id,"parallaxStrength",parseFloat(t.target.value))}),(0,c.jsx)("span",{style:{fontSize:"9px",width:"24px",textAlign:"right",color:t>2?"#ff9800":"#aaa"},children:t.toFixed(1)})]})]},e.id)}),0===f.length&&(0,c.jsx)("div",{style:{padding:"10px",color:"#777",fontStyle:"italic",textAlign:"center"},children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0441\u043b\u043e\u0435\u0432"})]})]})]})]})},_K=(e,t)=>{if(!e||!Array.isArray(e)||0===e.length)return null;const n=[...e].sort((e,t)=>e.t-t.t);if(t<=n[0].t)return n[0].v;if(t>=n[n.length-1].t)return n[n.length-1].v;for(let r=0;r<n.length-1;r++){const e=n[r],o=n[r+1];if(t>=e.t&&t<o.t){const n=(t-e.t)/(o.t-e.t);return e.v+n*(o.v-e.v)}}return n[n.length-1].v},EK=t=>{let{duration:n,currentTime:r,onTimeChange:o,tracks:i,onCopy:a,onPaste:l,onDelete:d,onKeyMove:u}=t;const p=(0,e.useRef)(null),h=(0,e.useRef)(u);(0,e.useEffect)(()=>{h.current=u},[u]);const f=(0,e.useMemo)(()=>{const e=new Set;return i&&Object.values(i).forEach(t=>{Array.isArray(t)&&t.forEach(t=>e.add(t.t))}),Array.from(e).sort((e,t)=>e-t)},[i]),g=f.some(e=>Math.abs(e-r)<.001);return(0,c.jsxs)("div",{style:{marginTop:10,marginBottom:10,userSelect:"none"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[(0,c.jsxs)("span",{style:{fontFamily:"monospace",color:"#e91e63",fontWeight:"bold",fontSize:"12px"},children:[r.toFixed(2),"s ",(0,c.jsxs)("span",{style:{color:"#666",fontSize:"10px"},children:["/ ",n,"s"]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,c.jsx)("button",{onClick:a,style:DK,children:"Copy"}),(0,c.jsx)("button",{onClick:l,style:DK,children:"Paste"}),(0,c.jsx)("button",{onClick:d,disabled:!g,style:s(s({},DK),{},{background:g?"#d32f2f":"#444",opacity:g?1:.5}),children:"Del"})]})]}),(0,c.jsxs)("div",{ref:p,onMouseDown:e=>{const t=e=>{if(!p.current)return;const t=p.current.getBoundingClientRect();let r=(e.clientX-t.left)/t.width*n;r<0&&(r=0),r>n&&(r=n);const i=10/t.width*n;let a,s=null,l=1/0;for(let n of f){const e=Math.abs(n-r);e<l&&(l=e,s=n)}a=null!==s&&l<=i?s:Math.round(20*r)/20,o(a)};t(e);const r=e=>{t(e)},i=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",i)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",i)},style:{height:26,background:"#1a1a1a",borderRadius:4,position:"relative",cursor:"ew-resize",border:"1px solid #444",overflow:"hidden"},children:[(0,c.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:"linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px)",backgroundSize:"".concat(100/(n>10?10:n),"% 100%")}}),f.map((e,t)=>{const i=Math.abs(e-r)<.001;return(0,c.jsx)("div",{onMouseDown:t=>((e,t)=>{e.stopPropagation();const r=e.clientX;let i=!1,a=t;const s=e=>{if(p.current&&(!i&&Math.abs(e.clientX-r)>3&&(i=!0),i)){const t=p.current.getBoundingClientRect();let r=(e.clientX-t.left)/t.width*n;r<0&&(r=0),r>n&&(r=n),r=Math.round(20*r)/20,Math.abs(r-a)>.001&&(h.current&&h.current(a,r),a=r)}},l=()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",l),i||o(t)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",l)})(t,e),style:{position:"absolute",left:"".concat(e/n*100,"%"),top:8,width:10,height:10,cursor:"pointer",background:i?"#ffeb3b":"#2196f3",transform:"translateX(-50%) rotate(45deg)",border:"1px solid #000",zIndex:4,boxShadow:"0 1px 2px rgba(0,0,0,0.5)"}},t)}),(0,c.jsx)("div",{style:{position:"absolute",left:"".concat(r/n*100,"%"),top:0,bottom:0,width:2,background:"#f44336",pointerEvents:"none",zIndex:3,boxShadow:"0 0 5px rgba(244, 67, 54, 0.6)"}})]})]})},DK={fontSize:"10px",background:"#333",border:"1px solid #555",color:"#eee",cursor:"pointer",padding:"3px 8px",borderRadius:3,transition:"background 0.2s"},MK=t=>{let{zone:n,onChange:r,currentTime:o=0,onTimeChange:i}=t;const[a,l]=(0,e.useState)(!1),d=n.animation||{enabled:!1,duration:10,loop:!0},u=d.enabled,p=["x","y","width","height","rotation","force"],h=(0,e.useRef)({original:null,current:null}),f=(e,t)=>{if(u&&d[e]&&d[e].length>0){const n=_K(d[e],o);return null!==n?n:t}return void 0!==n[e]?n[e]:t},g=(e,t)=>{const i=parseFloat(t);if(u){const t=s({},d),a=t[e]||[],l=a.findIndex(e=>Math.abs(e.t-o)<.001);if(l>=0){const n=[...a];n[l]=s(s({},n[l]),{},{v:i}),t[e]=n}else p.forEach(r=>{const a=t[r]?[...t[r]]:[];let s;if(r===e)s=i;else{const e=_K(a,o);if(null!==e)s=e;else{const e="width"===r||"height"===r?100:0;s=void 0!==n[r]?n[r]:e}}a.push({t:o,v:s}),a.sort((e,t)=>e.t-t.t),t[r]=a});r(s(s({},n),{},{animation:t}))}else r(s(s({},n),{},{[e]:i}))},m={row:{marginBottom:8},labelRow:{display:"flex",justifyContent:"space-between",marginBottom:2},label:{fontSize:"10px",color:"#aaa",display:"flex",alignItems:"center",gap:4},range:{width:"100%",height:4,accentColor:"#e91e63",cursor:"pointer"},val:{fontSize:"10px",color:"#fff",fontFamily:"monospace"},indicator:{width:6,height:6,borderRadius:"50%",background:"#e91e63"}};return(0,c.jsxs)("div",{style:{marginTop:10},children:[(0,c.jsxs)("div",{style:{marginBottom:8},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["point"===n.type?"\u0421\u0438\u043b\u0430 \u043f\u043e\u043b\u044f":"bounce"===n.mode?"\u0421\u0438\u043b\u0430 \u043e\u0442\u0441\u043a\u043e\u043a\u0430":"magnet"===n.mode?"\u0421\u0438\u043b\u0430 \u043c\u0430\u0433\u043d\u0438\u0442\u0430":"\u0421\u0438\u043b\u0430 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsx)("span",{style:m.val,children:"bounce"===n.mode?Math.round(f("force",n.force||0))+20:Math.round(f("force",n.force||0))})]}),(0,c.jsx)("input",{type:"range",min:"bounce"===n.mode?"0":"-20",max:"bounce"===n.mode?"45":"25",step:"1",style:s(s({},m.range),{},{accentColor:f("force",0)<0?"#ff5252":"#e91e63"}),value:"bounce"===n.mode?f("force",n.force||0)+20:f("force",n.force||0),onChange:e=>{const t=parseFloat(e.target.value),r="bounce"===n.mode?t-20:t;g("force",r)}})]}),(0,c.jsxs)("div",{style:{borderLeft:u?"2px solid #e91e63":"2px solid transparent",paddingLeft:8,transition:"all 0.2s"},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:8},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["\u041f\u043e\u0437. X ",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsxs)("span",{style:m.val,children:[Math.round(f("x",50)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:m.range,value:f("x",50),onChange:e=>g("x",e.target.value)})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["\u041f\u043e\u0437. Y ",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsxs)("span",{style:m.val,children:[Math.round(f("y",50)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:m.range,value:f("y",50),onChange:e=>g("y",e.target.value)})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:8},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["circle"===n.type?"\u0414\u0438\u0430\u043c\u0435\u0442\u0440":"\u0428\u0438\u0440\u0438\u043d\u0430"," ",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsxs)("span",{style:m.val,children:[Math.round(f("width",100)),"px"]})]}),(0,c.jsx)("input",{type:"range",min:"10",max:"1400",step:"10",style:m.range,value:f("width",100),onChange:e=>g("width",e.target.value)})]}),"rect"===n.type&&(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["\u0412\u044b\u0441\u043e\u0442\u0430 ",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsxs)("span",{style:m.val,children:[Math.round(f("height",100)),"px"]})]}),(0,c.jsx)("input",{type:"range",min:"10",max:"1000",step:"10",style:m.range,value:f("height",100),onChange:e=>g("height",e.target.value)})]})]}),"rect"===n.type&&(0,c.jsxs)("div",{style:{marginBottom:8},children:[(0,c.jsxs)("div",{style:m.labelRow,children:[(0,c.jsxs)("label",{style:m.label,children:["\u041f\u043e\u0432\u043e\u0440\u043e\u0442 ",u&&(0,c.jsx)("div",{style:m.indicator})]}),(0,c.jsxs)("span",{style:m.val,children:[Math.round(f("rotation",0)),"\xb0"]})]}),(0,c.jsx)("input",{type:"range",min:"-180",max:"180",step:"5",style:m.range,value:f("rotation",0),onChange:e=>g("rotation",e.target.value)})]})]}),(0,c.jsxs)("div",{style:{marginTop:15,borderTop:"1px solid #333",paddingTop:5},children:[(0,c.jsxs)("div",{onClick:()=>l(!a),style:{fontSize:"11px",fontWeight:"bold",color:"#ddd",cursor:"pointer",display:"flex",justifyContent:"space-between",padding:"6px 0",userSelect:"none"},children:[(0,c.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:["\u23f3 \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438",u&&(0,c.jsx)("span",{style:{fontSize:9,background:"#e91e63",color:"#fff",padding:"1px 4px",borderRadius:3},children:"REC"})]}),(0,c.jsx)("span",{children:a?"\u25b2":"\u25bc"})]}),a&&(0,c.jsxs)("div",{style:{background:"#222",padding:10,borderRadius:4,marginTop:5,border:"1px solid #333"},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",fontSize:11,color:u?"#fff":"#888",cursor:"pointer",fontWeight:"bold"},children:[(0,c.jsx)("input",{type:"checkbox",checked:u,onChange:e=>(e=>{let t=s(s({},d),{},{enabled:e});e&&(p.forEach(e=>{if(!t[e]||0===t[e].length){const r=void 0!==n[e]?n[e]:"width"===e||"height"===e?100:0;t[e]=[{t:0,v:r}]}}),i&&i(0)),r(s(s({},n),{},{animation:t}))})(e.target.checked),style:{marginRight:8,accentColor:"#e91e63"}}),"\u0410\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044e"]})}),u&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:10,alignItems:"flex-end"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:s(s({},m.label),{},{marginBottom:4}),children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"number",step:"0.1",min:"0.1",value:d.duration,onChange:e=>r(s(s({},n),{},{animation:s(s({},d),{},{duration:parseFloat(e.target.value)})})),style:{width:"100%",background:"#111",border:"1px solid #444",color:"#fff",fontSize:11,padding:"4px",borderRadius:3,boxSizing:"border-box"}})]}),(0,c.jsx)("div",{style:{marginBottom:5},children:(0,c.jsxs)("label",{style:{fontSize:10,color:"#ccc",display:"flex",alignItems:"center",gap:5,cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:d.loop,onChange:e=>r(s(s({},n),{},{animation:s(s({},d),{},{loop:e.target.checked})})),style:{accentColor:"#2196f3"}}),"\u0417\u0430\u0446\u0438\u043a\u043b\u0438\u0442\u044c (Loop)"]})})]}),(0,c.jsx)(EK,{duration:d.duration,currentTime:o,onTimeChange:i,tracks:d,onCopy:()=>{const e={};p.forEach(t=>{const n=f(t,null);null!==n&&(e[t]=n)}),localStorage.setItem("zone_anim_clipboard",JSON.stringify(e))},onPaste:()=>{const e=localStorage.getItem("zone_anim_clipboard");if(e)try{const t=JSON.parse(e),i=s({},d);Object.keys(t).forEach(e=>{const n=t[e],r=i[e]?[...i[e]]:[],a=r.findIndex(e=>Math.abs(e.t-o)<.001);a>=0?r[a].v=n:r.push({t:o,v:n}),r.sort((e,t)=>e.t-t.t),i[e]=r}),r(s(s({},n),{},{animation:i}))}catch(M2){console.error("Paste error",M2)}},onDelete:()=>{const e=s({},d);let t=!1;p.forEach(r=>{if(e[r]){const i=e[r].length;let a=e[r].filter(e=>Math.abs(e.t-o)>=.001);if(0===a.length&&i>0){const e=void 0!==n[r]?n[r]:0;a.push({t:0,v:e})}a.length!==i&&(e[r]=a,t=!0)}}),t&&r(s(s({},n),{},{animation:e}))},onKeyMove:(e,t)=>{h.current.original!==e&&(h.current={original:e,current:e});const o=s({},d);let a=!1;const l=h.current.current;p.forEach(n=>{if(o[n]){const r=[...o[n]];let i=r.findIndex(e=>Math.abs(e.t-l)<.001);-1===i&&(i=r.findIndex(t=>Math.abs(t.t-e)<.001)),-1!==i&&(r[i]=s(s({},r[i]),{},{t:t}),r.sort((e,t)=>e.t-t.t),o[n]=r,a=!0)}}),a&&(h.current.current=t,r(s(s({},n),{},{animation:o})),i&&i(t))}}),(0,c.jsxs)("div",{style:{fontSize:10,color:"#666",marginTop:8,lineHeight:1.4,borderTop:"1px dashed #333",paddingTop:6},children:["\u2139\ufe0f ",(0,c.jsx)("b",{children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435:"})," \u041a\u043b\u0438\u043a \u043f\u043e \u043a\u043b\u044e\u0447\u0443 \u2014 \u0432\u044b\u0431\u043e\u0440. \u041f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u0435 \u2014 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438."]})]}),!u&&(0,c.jsx)("div",{style:{fontSize:10,color:"#666",fontStyle:"italic",paddingLeft:22},children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f \u0437\u043e\u043d."})]})]})]})},TK=()=>({enabled:!0,count:500,spawnType:"stream",startDelay:0,preWarmSeconds:0,lifeTime:0,desyncLife:!0,speed:1,gravity:.15,wind:0,windShift:0,windZ:0,windZDir:1,airResistance:0,turbulenceEnabled:!1,turbulenceAmp:20,turbulenceFreq:.01,turbulenceZAmp:0,velocityStretch:0,velocityExStretch:0,rotateByVelocity:!1,rotate:0,rotateVar:0,color:"#ffffff",shape:"circle",size:2.5,stretchX:1,stretchY:1,blendMode:"normal",mixBlendMode:"normal",opacity:1,fadeInTime:0,opacityVar:0,colorVarHue:0,colorVarSat:0,colorVarLum:0,useSecondColor:!1,secondColor:"#000000",colorCycleTime:3,colorCycleLoop:!1,colorCycleReverse:!1,blur:0,spriteBlur:0,feather:0,flicker:0,flickerSpeed:1,pixelate:!1,pixelSize:4,pixelReduction:0,trailLength:0,trailDensity:5,trailSizeDecay:.5,sizeChange:1,sizeChangeSpeed:5,selfRotateSpeed:0,pulseSpeed:0,flipSpeed:0,zIndex:100,qualityScale:1,depth:.6,depthBalance:.5,depthSpeedDelta:0,opacityRestoreNear:0,opacityRestoreNearLimit:.7,opacityRestoreFar:0,opacityRestoreFarLimit:.3,deviationType:"sin",deviationStrength:3.5,deviationFreq:.03,generationType:"box",generationDir:90,areaScaleX:100,areaScaleY:100,areaOffsetX:0,areaOffsetY:0,areaRotation:0,pointPushForce:0,pointPushZ:0,showSpawnDebug:!0,mouseInteraction:!1,mouseType:"repel",mouseRadius:150,mouseForce:5,blockingZones:Array(5).fill(null).map((e,t)=>({id:t,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal",magnetStickiness:0,magnetRange:60,magnetScale:0})),hideZoneDebug:!1,cleanStuck:!1,cleanStuckTime:3}),IK=e=>{const t=TK();switch(e){case"snow":return s(s({},t),{},{type:"snow",spawnType:"stream",areaOffsetX:-12,areaOffsetY:0,areaScaleX:160,areaScaleY:100,blendMode:"normal",blockingZones:[{id:0,enabled:!1,x:50,y:79,width:1180,height:200,type:"rect",force:19,ignoreSize:0,borderRadius:0,rotation:0,mode:"magnet",magnetStickiness:100,magnetRange:5,magnetScale:300},{id:1,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal"}],blur:2,color:"#ffffff",count:1420,depth:1,depthBalance:.5,depthSpeedDelta:.9,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,flicker:.15,generationDir:90,generationType:"box",gravity:.05,mouseForce:5,mouseInteraction:!0,mouseRadius:150,mouseType:"magnet",opacity:1,opacityVar:.5,qualityScale:2,shape:"circle",size:2.2,speed:1,turbulenceAmp:50,turbulenceEnabled:!0,turbulenceFreq:.007,wind:2,zIndex:101});case"rain":return s(s({},t),{},{type:"rain",spawnType:"stream",areaOffsetX:-9,areaOffsetY:0,areaScaleX:118,areaScaleY:100,blendMode:"normal",blockingZones:[{id:0,enabled:!0,x:50,y:79,width:1180,height:200,type:"rect",force:-8,ignoreSize:0,borderRadius:0,rotation:0,mode:"bounce",magnetRange:280,magnetScale:300,magnetStickiness:100}],cleanStuck:!0,cleanStuckTime:.5,color:"#aaccff",count:1600,depth:1.3,depthBalance:.35,depthSpeedDelta:.4,desyncLife:!0,deviationFreq:.07,deviationStrength:12,deviationType:"sin",enabled:!0,flicker:.4,flickerSpeed:1,generationDir:90,generationType:"box",gravity:1.05,mouseForce:14,mouseInteraction:!0,mouseRadius:150,mouseType:"repel",opacity:1,opacityVar:.5,rotateByVelocity:!0,shape:"circle",size:5.5,speed:22,stretchX:.2,stretchY:5,turbulenceAmp:34,turbulenceEnabled:!0,turbulenceFreq:.027,velocityExStretch:.4,velocityStretch:5,spawnType:"warm",wind:1.5,zIndex:100});case"dust":return s(s({},t),{},{type:"dust",areaOffsetX:0,areaOffsetY:40,areaScaleX:100,areaScaleY:220,blendMode:"screen",color:"#fffff0",count:270,depth:1.2,depthBalance:.5,depthSpeedDelta:2,desyncLife:!0,deviationFreq:.015,deviationStrength:40,deviationType:"sin",enabled:!0,flicker:.2,flickerSpeed:3,generationDir:270,generationType:"box",gravity:0,mouseForce:5,mouseInteraction:!0,mouseRadius:320,mouseType:"repel",opacity:.6,opacityVar:1,shape:"circle",size:1.4,speed:-.1,turbulenceAmp:20,turbulenceEnabled:!0,turbulenceFreq:.001,zIndex:101,spawnType:"warm"});case"stars":return s(s({},t),{},{type:"snow",areaOffsetX:0,areaOffsetY:0,areaScaleX:100,areaScaleY:100,blendMode:"hard-light",color:"#ffe3c8",colorVarHue:5,colorVarLum:15,colorVarSat:2,count:1160,depth:1.4,depthBalance:.25,depthSpeedDelta:1.6,desyncLife:!0,deviationFreq:.06,deviationStrength:12,deviationType:"sin",enabled:!0,flicker:.5,flickerSpeed:1.5,flipSpeed:1.2,generationDir:90,generationType:"box",gravity:0,mouseForce:5,mouseInteraction:!1,mouseRadius:150,mouseType:"magnet",opacity:1,opacityVar:.5,pulseSpeed:.9,qualityScale:2,selfRotateSpeed:1.9,shape:"circle",size:1.1,speed:0,turbulenceAmp:2,turbulenceEnabled:!0,turbulenceFreq:.011,zIndex:101,spawnType:"warm"});case"sparks":return s(s({},t),{},{type:"snow",areaOffsetX:-35,areaOffsetY:-20,areaScaleX:100,areaScaleY:220,blendMode:"hard-light",blockingZones:[{id:0,enabled:!1,x:46,y:78,width:1060,height:200,type:"rect",force:2,ignoreSize:.5,borderRadius:180,rotation:0,mode:"bounce",magnetRange:20}],cleanStuck:!0,cleanStuckTime:.5,color:"#fff837",colorVarHue:4,colorVarLum:2,colorVarSat:6,count:1280,depth:1,depthBalance:.85,depthSpeedDelta:.9,desyncLife:!0,deviationFreq:.01,deviationStrength:11,deviationType:"sin",enabled:!0,flicker:0,flickerSpeed:.2,generationDir:200,generationType:"point",gravity:.8,lifeTime:3,mouseForce:5,mouseInteraction:!0,mouseRadius:320,mouseType:"repel",opacity:1,opacityVar:.5,rotate:-30,rotateByVelocity:!0,secondColor:"#ff763f",shape:"circle",size:3,speed:2.5,stretchX:1.3,stretchY:.7,turbulenceAmp:12,turbulenceEnabled:!0,turbulenceFreq:.007,useSecondColor:!0,velocityExStretch:.3,velocityStretch:2.9,spawnType:"stream",wind:3.5,zIndex:100});case"magic":return s(s({},t),{},{type:"snow",areaOffsetX:0,areaOffsetY:40,areaScaleX:100,areaScaleY:220,blendMode:"hard-light",blockingZones:[{id:0,enabled:!0,x:47,y:78,width:1100,height:200,type:"rect",force:18,ignoreSize:0,borderRadius:0,rotation:0,mode:"magnet",magnetRange:30,magnetStickiness:100,magnetScale:300}],blur:2,cleanStuck:!0,cleanStuckTime:.5,color:"#c67eff",count:1680,depth:1.6,depthBalance:.4,depthSpeedDelta:1,desyncLife:!1,deviationFreq:.03,deviationStrength:41,deviationType:"sin",enabled:!0,flicker:.15,flickerSpeed:5,generationDir:90,generationType:"cursor",gravity:.25,lifeTime:1,mouseForce:7,mouseInteraction:!0,mouseRadius:130,mouseType:"magnet",opacity:1,opacityVar:.5,qualityScale:2,shape:"circle",size:2.6,speed:1.8,turbulenceAmp:20,turbulenceEnabled:!0,turbulenceFreq:.034,spawnType:"warm",wind:0,zIndex:100});case"blackHole":return s(s({},t),{},{type:"snow",areaOffsetX:-35,areaOffsetY:15,areaScaleX:100,areaScaleY:220,blendMode:"hard-light",blockingZones:[{borderRadius:0,enabled:!0,force:-6,height:200,id:0,ignoreSize:0,mode:"normal",rotation:0,type:"point",width:1060,x:34,y:50,magnetRange:80,magnetStickiness:39,magnetScale:120,animation:{enabled:!1,duration:10,loop:!0,x:[{t:0,v:34}],y:[{t:0,v:50}]}},{borderRadius:0,enabled:!0,force:1,height:200,id:1,ignoreSize:.4,mode:"bounce",rotation:0,type:"circle",width:60,x:34,y:50,magnetRange:20}],cleanStuck:!0,cleanStuckTime:3.5,color:"#ffad61",count:1600,depth:.6,depthBalance:.45,depthSpeedDelta:0,desyncLife:!0,deviationFreq:.015,deviationStrength:17,deviationType:"sin",enabled:!0,flickerSpeed:.1,generationDir:260,generationType:"point",gravity:.2,lifeTime:11,mouseForce:4,mouseInteraction:!0,mouseRadius:320,mouseType:"repel",opacity:1,opacityVar:.5,qualityScale:2,rotateByVelocity:!0,secondColor:"#ffebcb",shape:"circle",size:2.1,speed:3,stretchX:1.1,stretchY:2.3,turbulenceAmp:9,turbulenceEnabled:!0,turbulenceFreq:.01,velocityExStretch:1,velocityStretch:.7,spawnType:"warm",zIndex:107});case"fireflies":return s(s({},t),{},{type:"fireflies",areaOffsetX:0,areaOffsetY:40,areaScaleX:100,areaScaleY:220,blendMode:"screen",blur:4,color:"#ccff00",count:160,depth:.9,depthBalance:.6,depthSpeedDelta:.1,desyncLife:!0,deviationFreq:.01,deviationStrength:40,deviationType:"sin",enabled:!0,flicker:.3,flickerSpeed:1.9,generationDir:90,generationType:"box",gravity:0,mouseForce:5,mouseInteraction:!0,mouseRadius:320,mouseType:"repel",opacity:.8,opacityVar:.5,pulseSpeed:2,shape:"circle",size:2.2,speed:.2,turbulenceAmp:20,turbulenceEnabled:!0,turbulenceFreq:.001,zIndex:100,spawnType:"warm"});case"sakura":return s(s({},t),{},{type:"confetti",areaOffsetX:-3,areaOffsetY:40,areaScaleX:106,areaScaleY:220,blendMode:"normal",blockingZones:[{id:0,enabled:!0,x:48,y:78,width:1120,height:190,type:"rect",force:-10,ignoreSize:.4,borderRadius:80,rotation:0,mode:"normal",magnetStickiness:94,magnetScale:220,magnetRange:20}],cleanStuck:!0,cleanStuckTime:.5,color:"#ff4081",count:100,depth:2,depthBalance:.2,depthSpeedDelta:1.6,desyncLife:!0,deviationFreq:.06,deviationStrength:50,deviationType:"sin",enabled:!0,fadeInTime:2.7,flickerSpeed:.1,flipSpeed:3.8,generationDir:90,generationType:"box",gravity:.05,lifeTime:11,mouseForce:5,mouseInteraction:!0,mouseRadius:450,mouseType:"repel",opacity:1,opacityVar:0,preWarmSeconds:5,qualityScale:2,rotateVar:155,selfRotateSpeed:2.3,shape:"circle",size:4.2,speed:.4,stretchX:.8,stretchY:1.2,turbulenceAmp:50,turbulenceEnabled:!0,turbulenceFreq:.002,wind:.5,zIndex:156});case"confetti":return s(s({},t),{},{type:"confetti",areaOffsetX:-12,areaOffsetY:40,areaScaleX:124,areaScaleY:220,blendMode:"normal",blockingZones:[{id:0,enabled:!1,x:48,y:78,width:1120,height:190,type:"rect",force:4,ignoreSize:.4,borderRadius:80,rotation:0,mode:"normal",magnetStickiness:94}],cleanStuck:!1,cleanStuckTime:.5,color:"#ff4081",count:150,depth:1,depthBalance:.5,depthSpeedDelta:.2,desyncLife:!0,deviationFreq:.03,deviationStrength:38,deviationType:"sin",enabled:!0,flicker:.15,flickerSpeed:1.5,flipSpeed:3.2,generationDir:0,generationType:"box",gravity:.1,lifeTime:7,mouseForce:5,mouseInteraction:!0,mouseRadius:320,mouseType:"magnet",opacity:1,opacityVar:0,preWarmSeconds:5,pulseSpeed:1.5,qualityScale:2,rotateVar:80,selfRotateSpeed:1.3,shape:"rect",size:4.2,speed:1.5,stretchX:.8,stretchY:1.2,turbulenceAmp:40,turbulenceEnabled:!0,turbulenceFreq:.007,wind:2,zIndex:156});case"smoke":return s(s({},t),{},{type:"smoke",airResistance:.014,areaOffsetX:5,areaOffsetY:15,areaRotation:0,areaScaleX:160,areaScaleY:100,blendMode:"plus",blockingZones:[{id:0,enabled:!1,x:50,y:79,width:1180,height:200,type:"rect",force:19,ignoreSize:0,borderRadius:0,rotation:0,mode:"magnet",magnetStickiness:100,magnetRange:5,magnetScale:300},{id:1,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal"}],blur:1,cleanStuck:!1,cleanStuckTime:3,color:"#dbe8ff",count:620,depth:1,depthBalance:.55,depthSpeedDelta:.2,desyncLife:!0,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,fadeInTime:.1,feather:0,flicker:.3,flickerSpeed:.6,flipSpeed:0,generationDir:245,generationType:"point",gravity:-.15,hideZoneDebug:!1,lifeTime:4,mixBlendMode:"screen",mouseForce:5,mouseInteraction:!0,mouseRadius:150,mouseType:"repel",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityVar:.5,pixelSize:4,pixelate:!1,pointPushForce:1,pointPushZ:0,preWarmSeconds:0,pulseSpeed:1.3,qualityScale:1,rotate:0,rotateByVelocity:!1,rotateVar:0,secondColor:"#000000",selfRotateSpeed:8.8,shape:"circle",showSpawnDebug:!0,size:2.3,sizeChange:1.9,sizeChangeSpeed:2,spawnType:"stream",speed:.4,spriteBlur:7.5,startDelay:0,stretchX:.7,stretchY:1.3,trailDensity:1,trailLength:0,trailSizeDecay:0,turbulenceAmp:10,turbulenceEnabled:!0,turbulenceFreq:.013,turbulenceZAmp:0,useSecondColor:!1,velocityExStretch:0,velocityStretch:0,warmStart:!0,wind:2.5,windShift:-.45,windZ:0,windZDir:1,zIndex:101,pixelReduction:0,opacityRestoreNearLimit:.7});case"fog":return s(s({},t),{},{type:"fog",airResistance:.062,areaOffsetX:5,areaOffsetY:15,areaRotation:0,areaScaleX:160,areaScaleY:100,blendMode:"plus",blockingZones:[{id:0,enabled:!1,x:50,y:79,width:1180,height:200,type:"rect",force:19,ignoreSize:0,borderRadius:0,rotation:0,mode:"magnet",magnetStickiness:100,magnetRange:5,magnetScale:300},{id:1,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal"}],blur:0,cleanStuck:!1,cleanStuckTime:3,color:"#9fbbef",count:1640,depth:1.7,depthBalance:.55,depthSpeedDelta:.1,desyncLife:!0,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,fadeInTime:2.8,feather:0,flicker:.1,flickerSpeed:.9,flipSpeed:0,generationDir:280,generationType:"line",gravity:-.15,hideZoneDebug:!1,lifeTime:4,mixBlendMode:"normal",mouseForce:5,mouseInteraction:!0,mouseRadius:150,mouseType:"repel",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityVar:.5,pixelSize:4,pixelate:!1,pointPushForce:1,pointPushZ:0,preWarmSeconds:0,pulseSpeed:.4,qualityScale:1,rotate:0,rotateByVelocity:!1,rotateVar:100,secondColor:"#000000",selfRotateSpeed:5,shape:"cloud",showSpawnDebug:!0,size:6,sizeChange:1.6,sizeChangeSpeed:2,spawnType:"stream",speed:0,spriteBlur:6,startDelay:0,stretchX:.7,stretchY:1.3,trailDensity:1,trailLength:0,trailSizeDecay:0,turbulenceAmp:2,turbulenceEnabled:!0,turbulenceFreq:.049,turbulenceZAmp:50,useSecondColor:!1,velocityExStretch:0,velocityStretch:0,warmStart:!0,wind:-.5,windShift:-.15,windZ:0,windZDir:1,zIndex:101,pixelReduction:0,opacityRestoreNearLimit:.7});case"leaves":return s(s({},t),{},{type:"leaves",airResistance:0,areaOffsetX:-3,areaOffsetY:40,areaRotation:0,areaScaleX:106,areaScaleY:220,blendMode:"normal",blockingZones:[{borderRadius:80,enabled:!0,force:-10,height:190,id:0,ignoreSize:.4,magnetRange:20,magnetScale:220,magnetStickiness:94,mode:"normal",rotation:0,type:"rect",width:1120,x:48,y:78}],blur:0,cleanStuck:!0,cleanStuckTime:.5,color:"#88a63e",colorCycleLoop:!1,colorCycleReverse:!1,colorCycleTime:3,colorVarHue:14,colorVarLum:13,colorVarSat:11,count:60,depth:2,depthBalance:.2,depthSpeedDelta:1.6,desyncLife:!0,deviationFreq:.06,deviationStrength:50,deviationType:"sin",enabled:!0,fadeInTime:.7,feather:0,flicker:0,flickerSpeed:.1,flipSpeed:1.1,generationDir:90,generationType:"box",gravity:.05,hideZoneDebug:!1,lifeTime:11,mixBlendMode:"normal",mouseForce:5,mouseInteraction:!0,mouseRadius:450,mouseType:"repel",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityRestoreNearLimit:.7,opacityVar:0,pixelReduction:0,pixelSize:4,pixelate:!1,pointPushForce:0,pointPushZ:0,preWarmSeconds:5,pulseSpeed:1.4,qualityScale:2,rotate:-180,rotateByVelocity:!1,rotateVar:35,secondColor:"#000000",selfRotateSpeed:2.3,shape:"leaf",showSpawnDebug:!0,size:6.7,sizeChange:.6,sizeChangeSpeed:5.5,spawnType:"stream",speed:.4,spriteBlur:0,startDelay:0,stretchX:.9,stretchY:1.1,trailDensity:5,trailLength:0,trailSizeDecay:.5,turbulenceAmp:50,turbulenceEnabled:!0,turbulenceFreq:.002,turbulenceZAmp:0,useSecondColor:!1,velocityExStretch:0,velocityStretch:5,warmStart:!0,wind:.5,windShift:0,windZ:0,windZDir:1,zIndex:156});case"bubbles":return s(s({},t),{},{type:"bubbles",airResistance:.045,areaOffsetX:-12,areaOffsetY:0,areaRotation:0,areaScaleX:160,areaScaleY:100,blendMode:"normal",blockingZones:[{id:0,enabled:!1,x:50,y:79,width:1180,height:200,type:"rect",force:19,ignoreSize:0,borderRadius:0,rotation:0,mode:"magnet",magnetStickiness:100,magnetRange:5,magnetScale:300},{id:1,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal"}],blur:2,cleanStuck:!1,cleanStuckTime:3,color:"#ffffff",count:1420,depth:1,depthBalance:.5,depthSpeedDelta:1.4,desyncLife:!0,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,fadeInTime:0,feather:0,flicker:.15,flickerSpeed:1,flipSpeed:0,generationDir:270,generationType:"box",gravity:-.05,hideZoneDebug:!1,lifeTime:0,mixBlendMode:"normal",mouseForce:5,mouseInteraction:!0,mouseRadius:150,mouseType:"magnet",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityRestoreNearLimit:.7,opacityVar:.5,pixelReduction:0,pixelSize:4,pixelate:!1,pointPushForce:0,pointPushZ:0,preWarmSeconds:0,pulseSpeed:1,qualityScale:2,rotate:0,rotateByVelocity:!1,rotateVar:0,secondColor:"#000000",selfRotateSpeed:2.4,shape:"ring",showSpawnDebug:!0,size:2.2,sizeChange:1,sizeChangeSpeed:5,spawnType:"stream",speed:1.2,spriteBlur:0,startDelay:0,stretchX:1,stretchY:1,trailDensity:5,trailLength:0,trailSizeDecay:.5,turbulenceAmp:50,turbulenceEnabled:!0,turbulenceFreq:.005,turbulenceZAmp:35,useSecondColor:!1,velocityExStretch:0,velocityStretch:0,warmStart:!0,wind:2,windShift:.1,windZ:0,windZDir:1,zIndex:101});case"waterfall":return s(s({},t),{},{type:"waterfall",airResistance:.006,areaOffsetX:15,areaOffsetY:-40,areaRotation:0,areaScaleX:8,areaScaleY:100,blendMode:"screen",blockingZones:[{id:0,enabled:!0,x:62,y:67,width:80,height:200,type:"circle",force:4,ignoreSize:.2,borderRadius:0,rotation:0,mode:"bounce",magnetStickiness:100,magnetRange:205,magnetScale:300},{id:1,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0,mode:"normal"}],blur:2,cleanStuck:!1,cleanStuckTime:3,color:"#a1c6ff",count:2e3,depth:1.4,depthBalance:.65,depthSpeedDelta:.7,desyncLife:!0,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,fadeInTime:0,feather:0,flicker:.05,flickerSpeed:2.5,flipSpeed:0,generationDir:90,generationType:"line",gravity:1.45,hideZoneDebug:!1,lifeTime:1,mixBlendMode:"screen",mouseForce:20,mouseInteraction:!0,mouseRadius:50,mouseType:"repel",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityRestoreNearLimit:.7,opacityVar:.5,pixelReduction:0,pixelSize:4,pixelate:!1,pointPushForce:0,pointPushZ:0,preWarmSeconds:0,pulseSpeed:2.7,qualityScale:2,rotate:-70,rotateByVelocity:!0,rotateVar:0,secondColor:"#000000",selfRotateSpeed:0,shape:"circle",showSpawnDebug:!0,size:4.2,sizeChange:.6,sizeChangeSpeed:1.5,spawnType:"stream",speed:.9,spriteBlur:1.5,startDelay:0,stretchX:1.6,stretchY:.4,trailDensity:8,trailLength:0,trailSizeDecay:.2,turbulenceAmp:5,turbulenceEnabled:!0,turbulenceFreq:.017,turbulenceZAmp:23,useSecondColor:!1,velocityExStretch:0,velocityStretch:5,warmStart:!0,wind:-1.5,windShift:.2,windZ:.2,windZDir:1,zIndex:101});case"fireworks":return s(s({},t),{},{airResistance:0,areaOffsetX:-15,areaOffsetY:10,areaRotation:0,areaScaleX:54,areaScaleY:100,blendMode:"normal",blockingZones:[{borderRadius:0,enabled:!1,force:19,height:200,id:0,ignoreSize:0,magnetRange:160,magnetScale:300,magnetStickiness:100,mode:"bounce",rotation:0,type:"point",width:740,x:7,y:77},{borderRadius:0,enabled:!1,force:10,height:200,id:1,ignoreSize:0,mode:"normal",rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:2,ignoreSize:0,rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:3,ignoreSize:0,rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:4,ignoreSize:0,rotation:0,type:"circle",width:200,x:50,y:50}],blur:2,cleanStuck:!1,cleanStuckTime:3,color:"#ffffff",count:5,depth:1,depthBalance:.5,depthSpeedDelta:.9,desyncLife:!0,deviationFreq:.07,deviationStrength:27,deviationType:"sin",enabled:!0,fadeInTime:0,feather:0,flicker:.2,flickerSpeed:.1,flipSpeed:0,generationDir:285,generationType:"line",gravity:-.2,hideZoneDebug:!1,lifeTime:1,mixBlendMode:"overlay",mouseForce:6,mouseInteraction:!0,mouseRadius:150,mouseType:"magnet",opacity:1,opacityRestoreFar:0,opacityRestoreFarLimit:.3,opacityRestoreNear:0,opacityRestoreNearLimit:.7,opacityVar:.5,pixelReduction:0,pixelSize:4,pixelate:!1,pointPushForce:0,pointPushZ:0,preWarmSeconds:0,pulseSpeed:0,qualityScale:2,rotate:0,rotateByVelocity:!1,rotateVar:0,secondColor:"#000000",selfRotateSpeed:0,shape:"circle",showSpawnDebug:!0,size:1.1,sizeChange:1,sizeChangeSpeed:.5,spawnType:"stream",speed:1,spriteBlur:0,startDelay:0,stretchX:1,stretchY:1,trailDensity:50,trailLength:60,trailSizeDecay:.15,turbulenceAmp:9,turbulenceEnabled:!0,turbulenceFreq:.007,turbulenceZAmp:0,useSecondColor:!1,velocityExStretch:0,velocityStretch:0,warmStart:!0,wind:1,windShift:0,windZ:0,windZDir:1,zIndex:101});case"fireworks_explosion":return s(s({},t),{},{airResistance:.049,areaOffsetX:0,areaOffsetY:0,areaScaleX:100,areaScaleY:100,blendMode:"plus",blockingZones:[{borderRadius:0,enabled:!1,force:15,height:200,id:0,ignoreSize:0,mode:"absorb",rotation:0,type:"point",width:180,x:46,y:52},{borderRadius:0,enabled:!1,force:10,height:200,id:1,ignoreSize:0,mode:"normal",rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:2,ignoreSize:0,mode:"normal",rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:3,ignoreSize:0,mode:"normal",rotation:0,type:"circle",width:200,x:50,y:50},{borderRadius:0,enabled:!1,force:10,height:200,id:4,ignoreSize:0,mode:"normal",rotation:0,type:"circle",width:200,x:50,y:50}],blur:0,cleanStuck:!1,color:"#ff2595",colorCycleTime:1,colorVarHue:0,colorVarLum:0,colorVarSat:0,count:1410,depth:.3,depthBalance:.05,depthSpeedDelta:.5,desyncLife:!0,deviationFreq:.03,deviationStrength:6,deviationType:"sin",enabled:!0,fadeInTime:0,feather:0,flicker:.15,flickerSpeed:5,flipSpeed:0,generationDir:90,generationType:"sub-layer",gravity:.85,lifeTime:.5,mixBlendMode:"plus-lighter",mouseForce:16,mouseInteraction:!1,mouseRadius:150,mouseType:"magnet",opacity:1,opacityRestoreNear:0,preWarmSeconds:0,pulseSpeed:0,qualityScale:1,rotate:0,rotateByVelocity:!0,rotateVar:0,secondColor:"#5444a0",selfRotateSpeed:0,shape:"circle",size:2.9,sizeChange:1,sizeChangeSpeed:.5,spawnType:"oneshot",speed:-.5,spriteBlur:0,stretchX:1,stretchY:1,trailDensity:6,trailLength:11,trailSizeDecay:.65,turbulenceAmp:46,turbulenceEnabled:!0,turbulenceFreq:.002,turbulenceZAmp:9,useSecondColor:!0,velocityExStretch:0,velocityStretch:5,warmStart:!0,wind:0,windShift:.1,zIndex:100});default:return t}},AK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P,B,L,N,U,V,W,H,G,X,Y,q,Z,$,K,J,Q,ee,te,ne,re,oe,ie,ae,se,le,ce,de,ue,pe,he,fe,ge,me,ve,ye,xe,be,we,Se,ke,Ce,je,_e,Ee,De,Me,Te,Ie,Ae,Oe,Re,ze,Fe,Pe,Be,Le,Ne,Ue,Ve,We,He,Ge;let{weatherSettings:Xe,onUpdateWeather:Ye,isExpanded:qe,onToggle:Ze,currentTime:$e,onTimeChange:Ke}=t;const Je={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},subHeader:{background:"#333",padding:"8px 12px",borderRadius:"4px",marginTop:"5px",marginBottom:"5px",fontSize:"11px",fontWeight:"600",color:"#ddd",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",border:"1px solid #3f3f3f",userSelect:"none"},subContent:{padding:"8px",borderLeft:"2px solid #444",marginLeft:"4px",marginBottom:"10px"},sectionTitle:{fontSize:"11px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"500",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},checkboxRow:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},layerCard:{background:"#1e1e1e",border:"1px solid #333",borderRadius:"4px",padding:"6px 10px",marginBottom:"6px",display:"flex",alignItems:"center",gap:"10px"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"},presetBtn:{flex:1,padding:"6px",border:"none",borderRadius:"4px",background:"#444",color:"#fff",fontSize:"11px",cursor:"pointer",transition:"background 0.2s"}},[Qe,et]=(0,e.useState)(null),[tt,nt]=(0,e.useState)(!1),[rt,ot]=(0,e.useState)(!1),[it,at]=(0,e.useState)(0),[st,lt]=(0,e.useState)(0),[ct,dt]=(0,e.useState)(!0),[ut,pt]=(0,e.useState)(null),ht=(0,e.useRef)(null),ft=(0,e.useRef)(null),[gt,mt]=(0,e.useState)(!1),[vt,yt]=(0,e.useState)(0),[xt,bt]=(0,e.useState)(0),[wt,St]=(0,e.useState)(!1),kt=(null===Xe||void 0===Xe?void 0:Xe.layers)||(Xe?[Xe]:[]),Ct=(0,e.useMemo)(()=>{const e=[...kt];for(;e.length<3;){const t=TK();t.enabled=!1,e.push(t)}return e},[kt]),jt=Ct[it],_t=e=>{const t=[...Ct];t[it]=s(s({},t[it]),e),Ye({layers:t,enabled:!0})},Et=e=>{pt(e),(e=>{const t=[...Ct];if("fireworks"===e){const e=IK("fireworks"),n=IK("fireworks_explosion");t[it]=s(s(s({},t[it]),e),{},{enabled:!0});const r=it+1;r<t.length?t[r]=s(s(s({},t[r]),n),{},{enabled:!0}):alert("\u0414\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0444\u0435\u0439\u0435\u0440\u0432\u0435\u0440\u043a\u0430 \u043d\u0443\u0436\u0435\u043d \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u044b\u0439 \u0441\u043b\u043e\u0439 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0421\u043b\u043e\u0439 1, \u0447\u0442\u043e\u0431\u044b \u0421\u043b\u043e\u0439 2 \u0441\u0442\u0430\u043b \u0432\u0437\u0440\u044b\u0432\u043e\u043c).")}else{const n=IK(e);t[it]=s(s(s({},t[it]),n),{},{enabled:!0});const r=it+1;r<t.length&&t[r].enabled&&(t[r]=s(s({},t[r]),{},{enabled:!1}))}Ye({layers:t,enabled:!0})})(e)},Dt=e=>{et(Qe===e?null:e)},Mt=(e,t)=>{const n=jt.blockingZones||[],r=Array(5).fill(null).map((e,t)=>n[t]||{id:t,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0});r[e]=s(s({},r[e]),t),_t({blockingZones:r})},Tt=jt.blockingZones&&jt.blockingZones[st]?jt.blockingZones[st]:{id:st,enabled:!1,x:50,y:50,width:200,height:200,type:"circle",force:10,ignoreSize:0,borderRadius:0,rotation:0},It=e=>{ft.current&&ft.current.scrollBy({left:150*e,behavior:"smooth"})};return(0,e.useEffect)(()=>{if(qe&&ft.current){const e=ft.current,t=t=>{0!==t.deltaY&&(t.preventDefault(),e.scrollLeft+=t.deltaY)};return e.addEventListener("wheel",t,{passive:!1}),()=>{e.removeEventListener("wheel",t)}}},[qe]),(0,c.jsxs)("div",{style:Je.panel,children:[(0,c.jsxs)("div",{style:Je.header,onClick:Ze,children:[(0,c.jsx)("input",{type:"checkbox",checked:!(null===Xe||void 0===Xe||!Xe.enabled),onClick:e=>e.stopPropagation(),onChange:e=>Ye({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#00bcd4"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u041f\u043e\u0433\u043e\u0434\u0430 \u0438 \u0427\u0430\u0441\u0442\u0438\u0446\u044b \u2744\ufe0f"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00bcd4",background:"rgba(0, 188, 212, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:null!==Xe&&void 0!==Xe&&Xe.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:qe?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),qe&&(0,c.jsxs)("div",{style:{padding:"0 5px"},children:[(0,c.jsx)("div",{style:{display:"flex",background:"#1a1a1a",borderRadius:"6px",padding:"4px",gap:"4px",marginBottom:"15px",border:"1px solid #333"},children:[0,1,2].map(e=>{const t=Ct[e],n=it===e,r=t.enabled;return(0,c.jsxs)("button",{onClick:()=>(e=>{if(it===e){const t=[...Ct],n=!t[e].enabled;t[e]=s(s({},t[e]),{},{enabled:n});const r={layers:t};n&&(r.enabled=!0),Ye(r)}else at(e)})(e),style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"6px",borderRadius:"4px",border:"none",cursor:"pointer",background:n?"#333":"transparent",color:n?"#fff":"#777",transition:"all 0.2s",fontSize:"11px",fontWeight:n?"bold":"normal",border:n?"1px solid #555":"1px solid transparent",position:"relative"},children:[(0,c.jsxs)("span",{children:["\u0421\u043b\u043e\u0439 ",e+1]}),(0,c.jsx)("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:r?"#00bcd4":"#444",boxShadow:r?"0 0 5px #00bcd4":"none",transition:"background 0.2s"}}),n&&(0,c.jsx)("div",{style:{position:"absolute",bottom:"-2px",left:"50%",transform:"translateX(-50%)",width:"30%",height:"2px",background:"#00bcd4",borderRadius:"2px"}})]},e)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666",textAlign:"center",marginTop:"-10px",marginBottom:"10px"},children:"\u041e\u0434\u0438\u043d \u043a\u043b\u0438\u043a \u2014 \u0432\u044b\u0431\u0440\u0430\u0442\u044c, \u0432\u0442\u043e\u0440\u043e\u0439 \u043a\u043b\u0438\u043a \u2014 \u0432\u043a\u043b/\u0432\u044b\u043a\u043b."}),(0,c.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,c.jsxs)("div",{style:{background:"#222",borderRadius:"8px",border:"1px solid #3a3a3a",display:"flex",alignItems:"stretch",height:"70px",overflow:"hidden"},children:[(0,c.jsx)("button",{onClick:()=>It(-1),style:{width:"24px",flexShrink:0,border:"none",background:"#333",color:"#aaa",cursor:"pointer",fontSize:"14px",borderRight:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center"},children:"\u2039"}),(0,c.jsxs)("div",{ref:ft,onMouseDown:e=>{mt(!0),yt(e.pageX-ft.current.offsetLeft),bt(ft.current.scrollLeft),ft.current&&(ft.current.style.cursor="grabbing")},onMouseLeave:()=>{mt(!1),ft.current&&(ft.current.style.cursor="grab")},onMouseUp:()=>{mt(!1),ft.current&&(ft.current.style.cursor="grab")},onMouseMove:e=>{if(!gt)return;e.preventDefault();const t=1.5*(e.pageX-ft.current.offsetLeft-vt);ft.current.scrollLeft=xt-t},style:{flex:1,display:"flex",gap:"8px",overflowX:"auto",alignItems:"center",padding:"0 8px",cursor:"grab",scrollbarWidth:"thin",scrollbarColor:"#444 #222"},className:"custom-scrollbar",children:[(0,c.jsx)("button",{onClick:e=>{e&&e.stopPropagation&&e.stopPropagation(),pt(null),(()=>{const e=TK();_t(e)})()},style:s(s({},Je.presetBtn),{},{flex:"0 0 auto",height:"40px",width:"40px",background:null===ut?"#d32f2f":"#444",color:"#fff",border:null===ut?"1px solid #ff5252":"1px solid transparent",borderRadius:"50%",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"}),children:"\u21bb"}),[{id:"snow",icon:"\u2744\ufe0f",label:"\u0421\u043d\u0435\u0433",color:"#fff"},{id:"rain",icon:"\ud83d\udca7",label:"\u0414\u043e\u0436\u0434\u044c",color:"#aaccff"},{id:"smoke",icon:"\ud83d\udca8",label:"\u0414\u044b\u043c",color:"#9fbbef"},{id:"fog",icon:"\ud83c\udf2b\ufe0f",label:"\u0422\u0443\u043c\u0430\u043d",color:"#cfd8dc"},{id:"dust",icon:"\ud83c\udf2c\ufe0f",label:"\u041f\u044b\u043b\u044c",color:"#fff8dc"},{id:"fireworks",icon:"\ud83c\udf86",label:"\u0421\u0430\u043b\u044e\u0442",color:"#ff4081"},{id:"stars",icon:"\ud83c\udf0c",label:"\u0417\u0432\u0451\u0437\u0434\u044b",color:"#ffe3c8"},{id:"fireflies",icon:"\u2728",label:"\u0421\u0432\u0435\u0442",color:"#ccff00"},{id:"magic",icon:"\ud83d\udd2e",label:"\u041c\u0430\u0433\u0438\u044f",color:"#c67eff"},{id:"sparks",icon:"\ud83d\udca5",label:"\u0418\u0441\u043a\u0440\u044b",color:"#fff837"},{id:"blackHole",icon:"\ud83d\udd73\ufe0f",label:"\u0414\u044b\u0440\u0430",color:"#ffad61"},{id:"waterfall",icon:"\ud83c\udf0a",label:"\u0412\u043e\u0434\u043e\u043f\u0430\u0434",color:"#4fc3f7"},{id:"sakura",icon:"\ud83c\udf38",label:"\u0421\u0430\u043a\u0443\u0440\u0430",color:"#ffb7c5"},{id:"leaves",icon:"\ud83c\udf42",label:"\u041b\u0438\u0441\u0442\u044c\u044f",color:"#88a63e"},{id:"bubbles",icon:"\ud83e\udee7",label:"\u041f\u0443\u0437\u044b\u0440\u0438",color:"#e0f7fa"},{id:"confetti",icon:"\ud83c\udf89",label:"\u041a\u043e\u043d\u0444\u0435\u0442\u0442\u0438",color:"#ff4081"}].map(e=>{const t=ut===e.id;return(0,c.jsxs)("button",{onClick:()=>Et(e.id),style:s(s({},Je.presetBtn),{},{flex:"0 0 auto",minWidth:"60px",height:"50px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px",padding:"4px",borderRadius:"6px",background:t?"rgba(0, 188, 212, 0.15)":"transparent",border:t?"1px solid ".concat(e.color):"1px solid transparent",color:t?e.color:"#ccc",transition:"all 0.1s"}),children:[(0,c.jsx)("span",{style:{fontSize:"18px",lineHeight:"1"},children:e.icon}),(0,c.jsx)("span",{style:{fontSize:"9px",fontWeight:t?"bold":"normal"},children:e.label})]},e.id)})]}),(0,c.jsx)("button",{onClick:()=>It(1),style:{width:"24px",flexShrink:0,border:"none",background:"#333",color:"#aaa",cursor:"pointer",fontSize:"14px",borderLeft:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center"},children:"\u203a"})]}),(0,c.jsx)("style",{children:"\n                            .custom-scrollbar::-webkit-scrollbar { height: 4px; }\n                            .custom-scrollbar::-webkit-scrollbar-track { background: #222; }\n                            .custom-scrollbar::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }\n                            .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #00bcd4; }\n                        "})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,c.jsxs)("div",{style:{padding:"8px",background:"rgba(255,255,255,0.03)",borderRadius:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0447\u0430\u0441\u0442\u0438\u0446"}),(0,c.jsx)("input",{type:"number",step:"10",style:{width:"50px",background:"#111",border:"1px solid #444",color:"#fff",fontSize:"10px",textAlign:"center",borderRadius:"3px"},value:null!==(n=jt.count)&&void 0!==n?n:100,onChange:e=>_t({count:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"10"}),(0,c.jsx)("input",{type:"range",min:"10",max:"2000",step:"10",value:null!==(r=jt.count)&&void 0!==r?r:100,onChange:e=>_t({count:parseInt(e.target.value)}),style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#00bcd4",margin:0})}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"2000"})]})]}),(0,c.jsxs)("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"6px",overflow:"hidden",border:tt?"1px solid rgba(255,255,255,0.1)":"1px solid transparent",transition:"all 0.2s ease"},children:[(0,c.jsxs)("div",{onClick:()=>nt(!tt),style:{padding:"8px 10px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:tt?"rgba(255,255,255,0.05)":"transparent",userSelect:"none"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{style:{fontSize:"12px"},children:"\ud83d\ude80"}),(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ddd",cursor:"pointer",fontWeight:500},children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f"})]}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#777",transform:tt?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"\u25bc"})]}),tt&&(0,c.jsxs)("div",{style:{padding:"8px 10px 12px 10px",display:"flex",flexDirection:"column",gap:"12px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0422\u0438\u043f \u0441\u043f\u0430\u0443\u043d\u0430"})}),(0,c.jsxs)("select",{style:s(s({},Je.selectInput),{},{width:"100%",padding:"6px",background:"#111",border:"1px solid #333",borderRadius:"4px",color:"#fff",fontSize:"11px"}),value:jt.spawnType||"stream",onChange:e=>_t({spawnType:e.target.value}),children:[(0,c.jsx)("option",{value:"stream",children:"\ud83c\udf0a \u041f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e\u0435 (Stream)"}),(0,c.jsx)("option",{value:"warm",children:"\u26a1 \u0421\u0440\u0430\u0437\u0443 \u043d\u0430 \u044d\u043a\u0440\u0430\u043d\u0435 (Warm)"}),(0,c.jsx)("option",{value:"burst",children:"\ud83d\udca5 \u0417\u0430\u043b\u043f\u043e\u043c (Burst Cycle)"}),(0,c.jsx)("option",{value:"oneshot",children:"\ud83d\uded1 \u041e\u0434\u0438\u043d \u0437\u0430\u043b\u043f (One Shot)"})]}),(0,c.jsxs)("div",{style:{fontSize:"9px",color:"#666",marginTop:"6px",fontStyle:"italic",lineHeight:"1.3",paddingLeft:"4px",borderLeft:"2px solid #333"},children:[(!jt.spawnType||"stream"===jt.spawnType)&&"\u0427\u0430\u0441\u0442\u0438\u0446\u044b \u0440\u043e\u0436\u0434\u0430\u044e\u0442\u0441\u044f \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (\u0437\u043c\u0435\u0439\u043a\u043e\u0439).","warm"===jt.spawnType&&"\u0427\u0430\u0441\u0442\u0438\u0446\u044b \u0441\u0440\u0430\u0437\u0443 \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u044e\u0442 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d.","burst"===jt.spawnType&&"\u0412\u044b\u0441\u0442\u0440\u0435\u043b \u043f\u0430\u0447\u043a\u043e\u0439 -> \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 ~2\u0441\u0435\u043a -> \u043f\u043e\u0432\u0442\u043e\u0440.","oneshot"===jt.spawnType&&"\u041e\u0434\u0438\u043d \u0440\u0430\u0437 \u0438 \u0432\u0441\u0451. \u0411\u0435\u0437 \u0440\u0435\u0441\u043f\u0430\u0443\u043d\u0430."]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"rgba(255,255,255,0.05)"}}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430 \u0441\u0442\u0430\u0440\u0442\u0430"}),(0,c.jsx)(PE,{text:"\u041f\u0430\u0443\u0437\u0430 \u043f\u0435\u0440\u0435\u0434 \u043f\u0435\u0440\u0432\u044b\u043c \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0447\u0430\u0441\u0442\u0438\u0446."})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"0.5",style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#ff9800",margin:0,height:"4px"}),value:null!==(o=jt.startDelay)&&void 0!==o?o:0,onChange:e=>_t({startDelay:parseFloat(e.target.value)})}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#ff9800",width:"30px",textAlign:"right",fontFamily:"monospace"},children:[null!==(i=jt.startDelay)&&void 0!==i?i:0,"s"]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u041f\u0440\u0435-\u0440\u0435\u043d\u0434\u0435\u0440 (warm-up)"}),(0,c.jsx)(PE,{text:"\u0421\u0438\u043c\u0443\u043b\u044f\u0446\u0438\u044f \u0444\u0438\u0437\u0438\u043a\u0438 \u0434\u043e \u043f\u043e\u043a\u0430\u0437\u0430 \u043a\u0430\u0434\u0440\u0430."})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.5",style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#00bcd4",margin:0,height:"4px"}),value:null!==(a=jt.preWarmSeconds)&&void 0!==a?a:0,onChange:e=>_t({preWarmSeconds:parseFloat(e.target.value)})}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#00bcd4",width:"30px",textAlign:"right",fontFamily:"monospace"},children:[null!==(l=jt.preWarmSeconds)&&void 0!==l?l:0,"s"]})]})]})]})]}),(0,c.jsxs)("div",{style:{padding:"8px",background:"rgba(255,255,255,0.03)",borderRadius:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430 (3D \u044d\u0444\u0444\u0435\u043a\u0442)"}),(0,c.jsx)("input",{type:"number",step:"0.1",style:{width:"40px",background:"#111",border:"1px solid #444",color:"#fff",fontSize:"10px",textAlign:"center",borderRadius:"3px"},value:null!==(d=jt.depth)&&void 0!==d?d:.5,onChange:e=>_t({depth:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"0"}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:null!==(u=jt.depth)&&void 0!==u?u:.5,onChange:e=>_t({depth:parseFloat(e.target.value)}),style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#00bcd4",margin:0})}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"2"})]})]}),(0,c.jsxs)("div",{style:{padding:"8px",background:"rgba(255,255,255,0.03)",borderRadius:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0430\u0434\u0435\u043d\u0438\u044f"}),(0,c.jsx)("input",{type:"number",step:"0.1",style:{width:"40px",background:"#111",border:"1px solid #444",color:"#fff",fontSize:"10px",textAlign:"center",borderRadius:"3px"},value:null!==(p=jt.speed)&&void 0!==p?p:1,onChange:e=>_t({speed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"-5"}),(0,c.jsx)("input",{type:"range",min:"-5",max:"5",step:"0.1",value:null!==(h=jt.speed)&&void 0!==h?h:1,onChange:e=>_t({speed:parseFloat(e.target.value)}),style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#00bcd4",margin:0})}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"+5"})]})]}),(0,c.jsxs)("div",{style:{padding:"8px",background:"rgba(255,255,255,0.03)",borderRadius:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043e\u043f\u0440\u043e\u0442\u0438\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u044b"}),(0,c.jsx)(PE,{text:"\u0422\u043e\u0440\u043c\u043e\u0437\u0438\u0442 \u0447\u0430\u0441\u0442\u0438\u0446\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u043a\u0430\u0434\u0440. 0 = \u0432\u0430\u043a\u0443\u0443\u043c, 0.2 = \u0432\u043e\u0434\u0430/\u0433\u0443\u0441\u0442\u043e\u0439 \u0442\u0443\u043c\u0430\u043d."})]}),(0,c.jsx)("input",{type:"number",step:"0.001",min:"0",max:"0.2",style:{width:"48px",background:"#111",border:"1px solid #444",color:"#fff",fontSize:"10px",textAlign:"center",borderRadius:"3px"},value:null!==(f=jt.airResistance)&&void 0!==f?f:0,onChange:e=>_t({airResistance:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"0"}),(0,c.jsx)("input",{type:"range",min:"0",max:"0.2",step:"0.001",value:null!==(g=jt.airResistance)&&void 0!==g?g:0,onChange:e=>_t({airResistance:parseFloat(e.target.value)}),style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#90a4ae",margin:0})}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#555"},children:"0.2"})]})]}),(0,c.jsxs)("div",{style:{background:"#222222",border:wt?"1px solid #303030":"1px solid transparent",borderRadius:"6px",marginBottom:"12px",overflow:"hidden",transition:"all 0.2s"},children:[(0,c.jsxs)("div",{onClick:()=>St(!wt),style:{padding:"8px 10px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",userSelect:"none",background:wt?"rgba(255,255,255,0.02)":"transparent"},children:[(0,c.jsx)("div",{style:{fontSize:"11px",color:"#7fbcd2",fontWeight:"bold"},children:"\ud83c\udf2c \u0412\u0435\u0442\u0435\u0440"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#777",transform:wt?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"\u25bc"})]}),wt&&(0,c.jsxs)("div",{style:{padding:"0 10px 10px 10px"},children:[(0,c.jsx)("div",{style:{display:"flex",gap:"10px",marginBottom:"8px"},children:(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",marginBottom:"4px",display:"block"},children:"\u0412\u0435\u0442\u0435\u0440 (X)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[(0,c.jsx)("input",{type:"number",step:"0.5",style:s(s({},Je.selectInput),{},{flex:1}),value:null!==(m=jt.wind)&&void 0!==m?m:0,onChange:e=>{const t=parseFloat(e.target.value),n={wind:t},r="box"===jt.generationType||!jt.generationType;if(ct&&r){const e=-6*t,r=100+Math.abs(12*t);n.areaOffsetX=e,n.areaScaleX=r}_t(n)}}),(0,c.jsxs)("label",{title:"\u0410\u0432\u0442\u043e-\u043f\u043e\u0434\u0433\u043e\u043d \u0437\u043e\u043d\u044b",style:{display:"flex",alignItems:"center",gap:"3px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:ct,onChange:e=>dt(e.target.checked),style:{width:"10px",height:"10px",accentColor:"#00bcd4"}}),(0,c.jsx)("span",{style:{fontSize:"9px",color:ct?"#00bcd4":"#666"},children:"AUTO"})]})]})]})}),(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0434\u0432\u0438\u0433 \u043f\u043e\u0442\u043e\u043a\u0430 (Curve)"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#7fbcd2"},children:null!==(v=jt.windShift)&&void 0!==v?v:0})]}),(0,c.jsx)("input",{type:"range",min:"-2",max:"2",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#7fbcd2"}),value:null!==(y=jt.windShift)&&void 0!==y?y:0,onChange:e=>_t({windShift:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666"},children:"*\u041f\u043b\u0430\u0432\u043d\u043e \u043c\u0435\u043d\u044f\u0435\u0442 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0435\u0442\u0430 (\u0434\u0443\u0433\u0430)"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",marginBottom:"4px",display:"block"},children:"\u0417\u0430\u0432\u0438\u0445\u0440\u0435\u043d\u0438\u0435"}),(0,c.jsx)("input",{type:"number",step:"0.1",style:s(s({},Je.selectInput),{},{width:"100%"}),value:null!==(x=jt.windZ)&&void 0!==x?x:0,onChange:e=>_t({windZ:parseFloat(e.target.value)}),title:"\u0421\u0438\u043b\u0430 \u0432\u0438\u0445\u0440\u044f. \u041d\u0438\u0437\u043a\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u2014 \u043b\u0451\u0433\u043a\u043e\u0435 \u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435, \u0432\u044b\u0441\u043e\u043a\u0438\u0435 \u2014 \u0442\u0443\u043d\u043d\u0435\u043b\u044c."})]}),(0,c.jsxs)("div",{style:{width:"80px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",marginBottom:"4px",display:"block"},children:"\u041f\u043e\u0442\u043e\u043a"}),(0,c.jsxs)("div",{style:{display:"flex",background:"#132538",borderRadius:"4px",overflow:"hidden",border:"1px solid #2a4560"},children:[(0,c.jsx)("button",{onClick:()=>_t({windZDir:1}),style:{flex:1,border:"none",cursor:"pointer",padding:"4px 0",background:1===(null!==(b=jt.windZDir)&&void 0!==b?b:1)?"#00bcd4":"transparent",color:1===(null!==(w=jt.windZDir)&&void 0!==w?w:1)?"#000":"#888",fontSize:"10px",fontWeight:"bold"},title:"\u041a \u0437\u0440\u0438\u0442\u0435\u043b\u044e",children:"IN"}),(0,c.jsx)("button",{onClick:()=>_t({windZDir:-1}),style:{flex:1,border:"none",cursor:"pointer",padding:"4px 0",background:-1===(null!==(S=jt.windZDir)&&void 0!==S?S:1)?"#ff5722":"transparent",color:-1===(null!==(k=jt.windZDir)&&void 0!==k?k:1)?"#000":"#888",fontSize:"10px",fontWeight:"bold"},title:"\u041e\u0442 \u0437\u0440\u0438\u0442\u0435\u043b\u044f",children:"OUT"})]})]})]})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"flex-end"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",marginBottom:"4px",display:"block"},children:"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0446\u0432\u0435\u0442"}),(0,c.jsx)(T$,{color:jt.color||"#ffffff",onChange:e=>_t({color:e})})]}),(0,c.jsxs)("div",{style:{width:"80px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc",marginBottom:"4px",display:"block"},children:"Z-Index"}),(0,c.jsx)("input",{type:"number",style:s(s({},Je.selectInput),{},{width:"100%"}),value:null!==(C=jt.zIndex)&&void 0!==C?C:100,onChange:e=>_t({zIndex:parseInt(e.target.value)})})]})]}),(0,c.jsxs)("details",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"4px",padding:"0"},children:[(0,c.jsx)("summary",{style:{fontSize:"10px",color:"#ccc",cursor:"pointer",outline:"none",padding:"6px 8px",userSelect:"none"},children:"\ud83c\udfa8 \u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0446\u0432\u0435\u0442\u0430"}),(0,c.jsx)("div",{style:{padding:"6px 8px",fontSize:"10px",color:"#ff5555",background:"rgba(255, 80, 80, 0.08)",borderBottom:"1px solid rgba(255,255,255,0.08)"},children:"\u26a0 \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0434\u0438\u043d\u0430\u043c\u0438\u043a\u0438 \u0438 \u0440\u0430\u0437\u0431\u0440\u043e\u0441\u0430 \u0446\u0432\u0435\u0442\u0430 \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("div",{style:{padding:"0 8px 8px 8px"},children:[(0,c.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px",marginTop:"5px"},children:[{label:"Hue",val:jt.colorVarHue,prop:"colorVarHue"},{label:"Sat",val:jt.colorVarSat,prop:"colorVarSat"},{label:"Lum",val:jt.colorVarLum,prop:"colorVarLum"}].map(e=>{var t,n;return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9px",color:"#aaa"},children:[(0,c.jsx)("span",{children:e.label}),(0,c.jsxs)("span",{children:[null!==(t=e.val)&&void 0!==t?t:0,"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},Je.rangeInput),{},{width:"100%",height:"4px",accentColor:"#00bcd4",margin:"4px 0"}),value:null!==(n=e.val)&&void 0!==n?n:0,onChange:t=>_t({[e.prop]:parseInt(t.target.value)})})]},e.prop)})}),(0,c.jsx)("hr",{style:{border:"0",borderTop:"1px solid rgba(255,255,255,0.1)",margin:"8px 0"}}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,c.jsx)("input",{type:"checkbox",id:"chkSecondColor",checked:jt.useSecondColor||!1,onChange:e=>_t({useSecondColor:e.target.checked}),style:{marginRight:"8px",accentColor:"#00bcd4"}}),(0,c.jsx)("label",{htmlFor:"chkSecondColor",style:{fontSize:"11px",color:"#ccc",cursor:"pointer"},children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u0442\u043e\u0440\u043e\u0439 \u0446\u0432\u0435\u0442"})]}),jt.useSecondColor&&(0,c.jsxs)("div",{style:{paddingLeft:"8px",borderLeft:"2px solid rgba(255,255,255,0.1)",display:"flex",flexDirection:"column",gap:"8px"},children:[(0,c.jsx)(T$,{color:jt.secondColor||"#000000",onChange:e=>_t({secondColor:e})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",whiteSpace:"nowrap"},children:"\u0426\u0438\u043a\u043b (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"range",min:"1",max:"10",step:"0.5",style:s(s({},Je.rangeInput),{},{flex:1,accentColor:"#00bcd4",margin:0}),value:null!==(j=jt.colorCycleTime)&&void 0!==j?j:3,onChange:e=>_t({colorCycleTime:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#777"},children:null!==(_=jt.colorCycleTime)&&void 0!==_?_:3})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,c.jsxs)("label",{style:{fontSize:"10px",color:"#aaa",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",style:{accentColor:"#00bcd4"},checked:jt.colorCycleLoop||!1,onChange:e=>_t({colorCycleLoop:e.target.checked})})," Loop"]}),(0,c.jsxs)("label",{style:{fontSize:"10px",color:"#aaa",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",style:{accentColor:"#00bcd4"},checked:jt.colorCycleReverse||!1,onChange:e=>_t({colorCycleReverse:e.target.checked})})," Reverse"]})]})]})]})]})]}),(0,c.jsx)("hr",{style:{border:"0",borderTop:"1px solid rgba(255,255,255,0.1)",margin:"10px 0"}}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("style"),children:[(0,c.jsx)("span",{children:"\ud83c\udfa8 \u0412\u0438\u0434, \u0426\u0432\u0435\u0442 \u0438 \u0420\u0435\u043d\u0434\u0435\u0440"}),(0,c.jsx)("span",{children:"style"===Qe?"\u25b2":"\u25bc"})]}),"style"===Qe&&(0,c.jsxs)("div",{style:Je.subContent,children:[(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\u0424\u043e\u0440\u043c\u0430 \u0447\u0430\u0441\u0442\u0438\u0446"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"4px"},children:[(0,c.jsx)("button",{title:"Circle",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"14px",background:"circle"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"circle"}),children:"\u25cf"}),(0,c.jsx)("button",{title:"Soft Circle",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"16px",textShadow:"0 0 4px white",background:"circle-soft"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"circle-soft"}),children:"\u2022"}),(0,c.jsx)("button",{title:"Rect",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"10px",background:"rect"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"rect"}),children:"\u25a0"}),(0,c.jsx)("button",{title:"Triangle",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"10px",background:"triangle"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"triangle"}),children:"\u25b2"}),(0,c.jsx)("button",{title:"Star",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"star"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"star"}),children:"\u2605"}),(0,c.jsx)("button",{title:"Ring",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"ring"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"ring"}),children:"\u25ce"}),(0,c.jsx)("button",{title:"Hexagon",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"14px",background:"hexagon"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"hexagon"}),children:"\u2b21"}),(0,c.jsx)("button",{title:"Diamond",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"diamond"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"diamond"}),children:"\u25c6"}),(0,c.jsx)("button",{title:"Cloud",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"cloud"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"cloud"}),children:"\u2601"}),(0,c.jsx)("button",{title:"Leaf",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"leaf"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"leaf"}),children:"\ud83c\udf42"}),(0,c.jsx)("button",{title:"Grass",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"grass"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"grass"}),children:" ) "}),(0,c.jsx)("button",{title:"Heart",style:s(s({},Je.presetBtn),{},{padding:"6px 0",fontSize:"12px",background:"heart"===jt.shape?"#00bcd4":"#444"}),onClick:()=>_t({shape:"heart"}),children:"\u2665"})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"12px"},children:[(0,c.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"3px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"\u0421\u043c\u0435\u0448\u0438\u0432\u0430\u043d\u0438\u0435 (\u0421\u043b\u043e\u0439)"}),(0,c.jsxs)("select",{style:s(s({},Je.selectInput),{},{width:"100%"}),value:jt.blendMode||"normal",onChange:e=>_t({blendMode:e.target.value}),children:[(0,c.jsxs)("optgroup",{label:"Basic",children:[(0,c.jsx)("option",{value:"normal",children:"Normal"}),(0,c.jsx)("option",{value:"screen",children:"Screen (\u0421\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"plus",children:"Add (\u0421\u0443\u043c\u043c\u0430)"})]}),(0,c.jsxs)("optgroup",{label:"Effects",children:[(0,c.jsx)("option",{value:"overlay",children:"Overlay"}),(0,c.jsx)("option",{value:"soft-light",children:"Soft Light"}),(0,c.jsx)("option",{value:"multiply",children:"Multiply (\u0422\u0435\u043d\u044c)"}),(0,c.jsx)("option",{value:"difference",children:"Difference"})]})]})]}),(0,c.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#00bcd4",display:"block",marginBottom:"3px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"\u041d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043d\u0430 \u0444\u043e\u043d"}),(0,c.jsxs)("select",{style:s(s({},Je.selectInput),{},{width:"100%"}),value:jt.mixBlendMode||"normal",onChange:e=>_t({mixBlendMode:e.target.value}),children:[(0,c.jsx)("option",{value:"normal",children:"\u041e\u0431\u044b\u0447\u043d\u043e\u0435"}),(0,c.jsx)("option",{value:"screen",children:"Screen (\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435)"}),(0,c.jsx)("option",{value:"overlay",children:"Overlay (\u041f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u0435)"}),(0,c.jsx)("option",{value:"multiply",children:"Multiply (\u0423\u043c\u043d\u043e\u0436\u0435\u043d\u0438\u0435)"}),(0,c.jsx)("option",{value:"color-dodge",children:"Color Dodge"}),(0,c.jsx)("option",{value:"plus-lighter",children:"Plus Lighter"}),(0,c.jsx)("option",{value:"hard-light",children:"Hard Light"}),(0,c.jsx)("option",{value:"difference",children:"Difference"})]})]})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 (Scale)"})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"8",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(E=jt.size)&&void 0!==E?E:3,onChange:e=>_t({size:parseFloat(e.target.value)})}),(0,c.jsxs)("details",{style:{marginTop:"8px",border:"1px solid #444",borderRadius:"4px",background:"rgba(0,0,0,0.2)"},children:[(0,c.jsxs)("summary",{style:{fontSize:"10px",color:"#aaa",padding:"5px 8px",cursor:"pointer",outline:"none",userSelect:"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("span",{children:"\u2604\ufe0f \u0428\u043b\u0435\u0439\u0444 (Ghost Trail)"}),(0,c.jsx)("span",{style:{color:(null!==(D=jt.trailLength)&&void 0!==D?D:0)>0?"#ff9800":"#666"},children:(null!==(M=jt.trailLength)&&void 0!==M?M:0)>0?"On":"Off"})]}),(0,c.jsxs)("div",{style:{padding:"8px",borderTop:"1px solid #444"},children:[(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0414\u043b\u0438\u043d\u0430 (Frames)"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#fff"},children:null!==(T=jt.trailLength)&&void 0!==T?T:0})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"60",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#ff9800"}),value:null!==(I=jt.trailLength)&&void 0!==I?I:0,onChange:e=>_t({trailLength:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c (\u041a\u043e\u043b-\u0432\u043e)"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#fff"},children:null!==(A=jt.trailDensity)&&void 0!==A?A:5})]}),(0,c.jsx)("input",{type:"range",min:"1",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#ffb74d"}),value:null!==(O=jt.trailDensity)&&void 0!==O?O:5,onChange:e=>_t({trailDensity:parseInt(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666"},children:"*\u0411\u043e\u043b\u044c\u0448\u0435 \u043f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c = \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0423\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u0438\u0435 \u043a \u0445\u0432\u043e\u0441\u0442\u0443"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#fff"},children:[Math.round(100*(null!==(R=jt.trailSizeDecay)&&void 0!==R?R:.5)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#ffe0b2"}),value:null!==(z=jt.trailSizeDecay)&&void 0!==z?z:.5,onChange:e=>_t({trailSizeDecay:parseFloat(e.target.value)})}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9px",color:"#666"},children:[(0,c.jsx)("span",{children:"\u0411\u0435\u0437 \u0438\u0437\u043c."}),(0,c.jsx)("span",{children:"\u0412 \u043d\u043e\u043b\u044c"})]})]})]})]}),(0,c.jsxs)("details",{style:{marginTop:"8px",border:"1px solid #444",borderRadius:"4px",background:"rgba(0,0,0,0.2)"},children:[(0,c.jsx)("summary",{style:{fontSize:"10px",color:"#aaa",padding:"5px 8px",cursor:"pointer",outline:"none",userSelect:"none"},children:"\u23f3 \u0420\u0430\u0437\u043c\u0435\u0440 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0414\u0438\u043d\u0430\u043c\u0438\u043a\u0430)"}),(0,c.jsxs)("div",{style:{padding:"8px",borderTop:"1px solid #444"},children:[(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00bcd4"},children:1===(null!==(F=jt.sizeChange)&&void 0!==F?F:1)?"\u041d\u0435\u0442":(null!==(P=jt.sizeChange)&&void 0!==P?P:1)+"x"})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"3",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:1===(null!==(B=jt.sizeChange)&&void 0!==B?B:1)?"#666":"#00bcd4"}),value:void 0!==jt.sizeChange?jt.sizeChange:1,onChange:e=>_t({sizeChange:parseFloat(e.target.value)})}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9px",color:"#666"},children:[(0,c.jsx)("span",{children:"0x (\u0418\u0441\u0447\u0435\u0437.)"}),(0,c.jsx)("span",{children:"1x (\u041d\u043e\u0440\u043c\u0430)"}),(0,c.jsx)("span",{children:"3x (\u0420\u043e\u0441\u0442)"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#aaa"},children:[null!==(L=jt.sizeChangeSpeed)&&void 0!==L?L:5," \u0441\u0435\u043a"]})]}),(0,c.jsx)("input",{type:"range",min:"0.5",max:"30",step:"0.5",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(N=jt.sizeChangeSpeed)&&void 0!==N?N:5,onChange:e=>_t({sizeChangeSpeed:parseFloat(e.target.value)})})]})]})]})]}),(0,c.jsxs)("details",{style:{marginTop:"8px",marginBottom:"10px",border:"1px solid #444",borderRadius:"4px",background:"rgba(0,0,0,0.2)"},children:[(0,c.jsx)("summary",{style:{fontSize:"10px",color:"#aaa",padding:"5px 8px",cursor:"pointer",outline:"none",userSelect:"none"},children:"\ud83d\udc41\ufe0f \u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0438 \u041c\u0435\u0440\u0446\u0430\u043d\u0438\u0435"}),(0,c.jsxs)("div",{style:{padding:"8px",borderTop:"1px solid #444"},children:[(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:Je.valueLabel,children:null!==(U=jt.opacity)&&void 0!==U?U:.8})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(V=jt.opacity)&&void 0!==V?V:.8,onChange:e=>_t({opacity:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043b\u0430\u0432\u043d\u043e\u0435 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 (Fade In)"}),(0,c.jsxs)("span",{style:Je.valueLabel,children:[null!==(W=jt.fadeInTime)&&void 0!==W?W:0,"s"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(H=jt.fadeInTime)&&void 0!==H?H:0,onChange:e=>_t({fadeInTime:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041c\u0435\u0440\u0446\u0430\u043d\u0438\u0435 (\u0421\u0438\u043b\u0430)"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(G=jt.flicker)&&void 0!==G?G:0,onChange:e=>_t({flicker:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043c\u0435\u0440\u0446\u0430\u043d\u0438\u044f"})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(X=jt.flickerSpeed)&&void 0!==X?X:1,onChange:e=>_t({flickerSpeed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{borderTop:"1px dashed #444",marginTop:"8px",paddingTop:"8px"},children:[(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#81d4fa"},children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c \u043d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0431\u043b\u0438\u0436\u043d\u0438\u0445"}),(0,c.jsx)(PE,{text:"\u0414\u0435\u043b\u0430\u0435\u0442 \u043a\u0440\u0443\u043f\u043d\u044b\u0435 \u0447\u0430\u0441\u0442\u0438\u0446\u044b (\u043f\u0435\u0440\u0435\u0434\u043d\u0438\u0439 \u043f\u043b\u0430\u043d) \u043d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u044b\u043c\u0438, \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u044f \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u0438."})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#81d4fa"}),value:null!==(Y=jt.opacityRestoreNear)&&void 0!==Y?Y:0,onChange:e=>_t({opacityRestoreNear:parseFloat(e.target.value)})})]}),jt.opacityRestoreNear>0&&(0,c.jsxs)("div",{style:s(s({},Je.row),{},{paddingLeft:"10px",marginTop:"-8px",borderLeft:"2px solid #81d4fa"}),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u21b3 \u041f\u043e\u0440\u043e\u0433 \u0437\u043e\u043d\u044b (Z)"}),(0,c.jsx)("span",{style:Je.valueLabel,children:null!==(q=jt.opacityRestoreNearLimit)&&void 0!==q?q:.7})]}),(0,c.jsx)("input",{type:"range",min:"0.5",max:"1.0",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#4ba3c7",height:"4px"}),value:null!==(Z=jt.opacityRestoreNearLimit)&&void 0!==Z?Z:.7,onChange:e=>_t({opacityRestoreNearLimit:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666"},children:"\u0427\u0430\u0441\u0442\u0438\u0446\u044b \u0431\u043b\u0438\u0436\u0435 \u044d\u0442\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u043d\u0443\u0442 \u043f\u043b\u043e\u0442\u043d\u0435\u0435."})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#b39ddb"},children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c \u043d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043b\u044c\u043d\u0438\u0445"}),(0,c.jsx)(PE,{text:"\u0414\u0435\u043b\u0430\u0435\u0442 \u043c\u0435\u043b\u043a\u0438\u0435 \u0447\u0430\u0441\u0442\u0438\u0446\u044b (\u0437\u0430\u0434\u043d\u0438\u0439 \u043f\u043b\u0430\u043d) \u043d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u044b\u043c\u0438."})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#b39ddb"}),value:null!==($=jt.opacityRestoreFar)&&void 0!==$?$:0,onChange:e=>_t({opacityRestoreFar:parseFloat(e.target.value)})})]}),jt.opacityRestoreFar>0&&(0,c.jsxs)("div",{style:s(s({},Je.row),{},{paddingLeft:"10px",marginTop:"-8px",borderLeft:"2px solid #b39ddb"}),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa"},children:"\u21b3 \u041f\u043e\u0440\u043e\u0433 \u0437\u043e\u043d\u044b (Z)"}),(0,c.jsx)("span",{style:Je.valueLabel,children:null!==(K=jt.opacityRestoreFarLimit)&&void 0!==K?K:.3})]}),(0,c.jsx)("input",{type:"range",min:"0.0",max:"0.5",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#9575cd",height:"4px"}),value:null!==(J=jt.opacityRestoreFarLimit)&&void 0!==J?J:.3,onChange:e=>_t({opacityRestoreFarLimit:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666"},children:"\u0427\u0430\u0441\u0442\u0438\u0446\u044b \u0434\u0430\u043b\u044c\u0448\u0435 \u044d\u0442\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u043d\u0443\u0442 \u043f\u043b\u043e\u0442\u043d\u0435\u0435."})]})]})]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"10px",marginTop:"10px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#666"},children:"\u0421\u043f\u043b\u044e\u0449\u0438\u0442\u044c X"}),(0,c.jsx)("input",{type:"number",step:"0.1",min:"0.1",style:Je.selectInput,value:null!==(Q=jt.stretchX)&&void 0!==Q?Q:1,onChange:e=>_t({stretchX:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#666"},children:"\u0421\u043f\u043b\u044e\u0449\u0438\u0442\u044c Y"}),(0,c.jsx)("input",{type:"number",step:"0.1",min:"0.1",style:Je.selectInput,value:null!==(ee=jt.stretchY)&&void 0!==ee?ee:1,onChange:e=>_t({stretchY:parseFloat(e.target.value)})})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"10px 0"}}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"5px",textTransform:"uppercase"},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 (Blur)"}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 (Blur)"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4"}),value:null!==(te=jt.blur)&&void 0!==te?te:0,onChange:e=>_t({blur:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u0441\u043f\u0440\u0430\u0439\u0442\u0430 (Softness)"}),(0,c.jsxs)("span",{style:Je.valueLabel,children:[null!==(ne=jt.spriteBlur)&&void 0!==ne?ne:0,"px"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"0.5",style:s(s({},Je.rangeInput),{},{accentColor:(null!==(re=jt.spriteBlur)&&void 0!==re?re:0)>0?"#b388ff":"#666"}),value:null!==(oe=jt.spriteBlur)&&void 0!==oe?oe:0,onChange:e=>_t({spriteBlur:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666",marginTop:"2px"},children:"*\u0420\u0430\u0437\u043c\u044b\u0432\u0430\u0435\u0442 \u0441\u0430\u043c\u0443 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443. \u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0434\u044b\u043c\u0430 \u0438 \u043e\u0431\u043b\u0430\u043a\u043e\u0432."})]}),"circle"===jt.shape&&(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0441\u0442\u0443\u0448\u0435\u0432\u043a\u0430 (Feather)"}),(0,c.jsxs)("span",{style:Je.valueLabel,children:[Math.round(100*(null!==(ie=jt.feather)&&void 0!==ie?ie:0)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:(null!==(ae=jt.feather)&&void 0!==ae?ae:0)>0?"#00bcd4":"#666"}),value:null!==(se=jt.feather)&&void 0!==se?se:0,onChange:e=>_t({feather:parseFloat(e.target.value)})})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"10px 0"}}),(0,c.jsx)("div",{style:Je.row,children:(0,c.jsxs)("div",{style:s(s({},Je.row),{},{marginTop:"15px",borderTop:"1px dashed #444",paddingTop:"10px"}),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0435\u043d\u0434\u0435\u0440\u0430 (Resolution)"}),(0,c.jsx)(PE,{text:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043a\u0430\u0436\u0434\u043e\u0439 \u0447\u0430\u0441\u0442\u0438\u0446\u044b. \u041f\u0440\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438 4 \u043a\u0440\u0443\u0433\u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u044f\u0442\u0441\u044f \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u0433\u043b\u0430\u0434\u043a\u0438\u043c\u0438, \u043d\u043e \u044d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0441\u043d\u0438\u0437\u0438\u0442\u044c FPS \u043d\u0430 \u0441\u043b\u0430\u0431\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u0445."})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"1",max:"7",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:jt.qualityScale>2?"#ff5252":"#00bcd4"}),value:null!==(le=jt.qualityScale)&&void 0!==le?le:1,onChange:e=>_t({qualityScale:parseInt(e.target.value)})}),(0,c.jsxs)("span",{style:s(s({},Je.valueLabel),{},{color:jt.qualityScale>2?"#ff5252":"#fff"}),children:["x",null!==(ce=jt.qualityScale)&&void 0!==ce?ce:1]})]}),(0,c.jsx)("div",{style:{fontSize:"9px",color:(null!==(de=jt.qualityScale)&&void 0!==de?de:1)>2?"#ff8a80":"#666",marginTop:"4px",fontStyle:"italic"},children:(null!==(ue=jt.qualityScale)&&void 0!==ue?ue:1)>2?"\u26a0\ufe0f \u0412\u044b\u0441\u043e\u043a\u043e\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e: \u043c\u043e\u0436\u0435\u0442 \u0441\u043d\u0438\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c":"\u041d\u0438\u0437\u043a\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442 \u0440\u0435\u0441\u0443\u0440\u0441\u044b (\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442: 1)"})]})})]}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("physics"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{children:"\ud83d\ude80"}),(0,c.jsx)("span",{style:{fontWeight:600},children:"\u0414\u0432\u0438\u0436\u0435\u043d\u0438\u0435 \u0438 \u0424\u0438\u0437\u0438\u043a\u0430"})]}),(0,c.jsx)("span",{style:{opacity:.6},children:"physics"===Qe?"\u25b2":"\u25bc"})]}),"physics"===Qe&&(0,c.jsxs)("div",{style:s(s({},Je.subContent),{},{display:"flex",flexDirection:"column",gap:"12px"}),children:[(0,c.jsxs)("div",{style:{background:"rgba(213, 0, 249, 0.03)",borderRadius:"6px",padding:"8px",borderLeft:"2px solid #d500f9",marginBottom:"5px"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#d500f9",fontWeight:700,marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u041f\u0438\u043a\u0441\u0435\u043b\u0438\u0437\u0430\u0446\u0438\u044f (Grid)"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:jt.pixelate||!1,onChange:e=>_t({pixelate:e.target.checked}),style:{accentColor:"#d500f9",width:"14px",height:"14px",cursor:"pointer"}}),(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",cursor:"pointer"},onClick:()=>_t({pixelate:!jt.pixelate}),children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u043a\u0443"})]}),jt.pixelate&&(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#d500f9",fontWeight:"bold"},children:[jt.pixelSize||4,"px"]})]}),jt.pixelate&&(0,c.jsxs)("div",{style:{marginTop:"4px",display:"flex",flexDirection:"column",gap:"6px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u044f\u0447\u0435\u0439\u043a\u0438"}),(0,c.jsxs)("span",{style:{fontSize:"9px",color:"#d500f9"},children:[jt.pixelSize||4,"px"]})]}),(0,c.jsx)("input",{type:"range",min:"2",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#d500f9",height:"4px"}),value:jt.pixelSize||4,onChange:e=>_t({pixelSize:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#ccc"},children:"\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u0439"}),(0,c.jsxs)("span",{style:{fontSize:"9px",color:"#d500f9"},children:[Math.round(100*(jt.pixelReduction||0)),"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#d500f9",height:"4px"}),value:jt.pixelReduction||0,onChange:e=>_t({pixelReduction:parseFloat(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#888",marginTop:"2px",fontStyle:"italic",lineHeight:"1.2"},children:"*\u0423\u0431\u0438\u0440\u0430\u0435\u0442 \u0447\u0430\u0441\u0442\u0438\u0446\u044b, \u043f\u043e\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0438 \u0442\u0443 \u0436\u0435 \u044f\u0447\u0435\u0439\u043a\u0443 \u0441\u0435\u0442\u043a\u0438."})]})]})]})]}),(0,c.jsxs)("div",{style:{background:"rgba(255,255,255,0.02)",borderRadius:"6px",padding:"8px",borderLeft:"2px solid #ff7043"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#ff7043",fontWeight:700,marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0438\u043b\u044b"}),(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ddd"},children:"\u0413\u0440\u0430\u0432\u0438\u0442\u0430\u0446\u0438\u044f"}),(0,c.jsx)(PE,{text:"\u041f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f = \u0432\u043d\u0438\u0437. \u041e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u0430\u044f = \u0432\u0432\u0435\u0440\u0445. 0 = \u043d\u0435\u0432\u0435\u0441\u043e\u043c\u043e\u0441\u0442\u044c."})]}),(0,c.jsx)("span",{style:{fontSize:"10px",color:jt.gravity>0?"#4caf50":jt.gravity<0?"#ff5252":"#888"},children:null===(pe=jt.gravity)||void 0===pe?void 0:pe.toFixed(2)})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[(0,c.jsx)("input",{type:"range",min:-.5,max:1.5,step:.05,style:s(s({},Je.rangeInput),{},{accentColor:"#ff7043",flex:1}),value:null!==(he=jt.gravity)&&void 0!==he?he:0,onChange:e=>_t({gravity:parseFloat(e.target.value)})}),(0,c.jsx)("input",{type:"number",min:-.5,max:1.5,step:.01,value:null!==(fe=jt.gravity)&&void 0!==fe?fe:"",onChange:e=>{const t=e.target.value;_t({gravity:""===t?null:parseFloat(t)})},style:{width:"64px",background:"#222",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"11px",padding:"2px 4px"}})]})]}),(0,c.jsx)("div",{style:{display:"flex",gap:"10px"},children:(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc",display:"block",marginBottom:"2px"},children:"\u0412\u0440\u0435\u043c\u044f \u0436\u0438\u0437\u043d\u0438"}),(0,c.jsx)("input",{type:"range",min:"0",max:"30",step:"0.5",style:s(s({},Je.rangeInput),{},{height:"4px",accentColor:"#ff7043"}),value:null!==(ge=jt.lifeTime)&&void 0!==ge?ge:0,onChange:e=>_t({lifeTime:parseFloat(e.target.value)})})]})})]}),(0,c.jsxs)("div",{style:{background:"rgba(118,255,3,0.03)",borderRadius:"6px",padding:"8px",borderLeft:"2px solid #76ff03",marginTop:"10px"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#76ff03",fontWeight:700,marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430 \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0430\u043a\u0441"}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0411\u0430\u043b\u0430\u043d\u0441 \u043f\u043b\u0430\u043d\u043e\u0432 (Back / Front)"}),(0,c.jsx)(PE,{text:"\u0412\u043b\u0435\u0432\u043e: \u0431\u043e\u043b\u044c\u0448\u0435 \u043c\u0435\u043b\u043a\u0438\u0445 \u0447\u0430\u0441\u0442\u0438\u0446 \u0441\u0437\u0430\u0434\u0438. \u0412\u043f\u0440\u0430\u0432\u043e: \u0431\u043e\u043b\u044c\u0448\u0435 \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u0441\u043f\u0435\u0440\u0435\u0434\u0438. \u0426\u0435\u043d\u0442\u0440: \u0440\u0430\u0432\u043d\u043e\u043c\u0435\u0440\u043d\u043e."})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9px",color:"#666",marginBottom:"2px"},children:[(0,c.jsx)("span",{children:"Back"}),(0,c.jsx)("span",{children:"Front"})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Je.rangeInput),{},{accentColor:"#76ff03"}),value:null!==(me=jt.depthBalance)&&void 0!==me?me:.5,onChange:e=>_t({depthBalance:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u044c \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438"}),(0,c.jsx)(PE,{text:"\u041d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0431\u044b\u0441\u0442\u0440\u0435\u0435 \u043b\u0435\u0442\u044f\u0442 \u043f\u0435\u0440\u0435\u0434\u043d\u0438\u0435 \u0447\u0430\u0441\u0442\u0438\u0446\u044b \u043f\u043e \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e \u0441 \u0437\u0430\u0434\u043d\u0438\u043c\u0438."})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#76ff03"}),value:null!==(ve=jt.depthSpeedDelta)&&void 0!==ve?ve:0,onChange:e=>_t({depthSpeedDelta:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{style:{background:"rgba(0, 0, 0, 0.4)",border:"1px solid rgba(0, 188, 212, 0.15)",borderRadius:"8px",overflow:"hidden"},children:[(0,c.jsxs)("div",{onClick:()=>ot(!rt),style:{padding:"8px 10px",background:"rgba(0, 188, 212, 0.05)",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:rt?"1px solid rgba(0, 188, 212, 0.1)":"none",transition:"background 0.2s"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"14px"},children:"\ud83d\udca8"}),(0,c.jsx)("span",{style:{fontSize:"11px",fontWeight:600,color:"#00bcd4",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0410\u044d\u0440\u043e\u0434\u0438\u043d\u0430\u043c\u0438\u043a\u0430"})]}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00bcd4",opacity:.7},children:rt?"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u25b2":"\u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u25bc"})]}),rt&&(0,c.jsxs)("div",{style:{padding:"10px",display:"flex",flexDirection:"column",gap:"12px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:s(s({},Je.checkboxRow),{},{marginBottom:jt.turbulenceEnabled?"8px":"0"}),children:[(0,c.jsx)("input",{type:"checkbox",checked:!!jt.turbulenceEnabled,onChange:e=>_t({turbulenceEnabled:e.target.checked}),style:{accentColor:"#00bcd4"}}),(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",marginLeft:"8px",fontWeight:500},children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0448\u0443\u043c \u0432\u0435\u0442\u0440\u0430"})]}),jt.turbulenceEnabled&&(0,c.jsxs)("div",{style:{paddingLeft:"8px",borderLeft:"2px solid rgba(0,188,212,0.3)",marginLeft:"4px"},children:[(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"10px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa",display:"block",marginBottom:"2px"},children:"\u0421\u0438\u043b\u0430 (XY)"}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(ye=jt.turbulenceAmp)&&void 0!==ye?ye:20,onChange:e=>_t({turbulenceAmp:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#81d4fa",display:"block",marginBottom:"2px"},children:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430 (Z)"}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(xe=jt.turbulenceZAmp)&&void 0!==xe?xe:0,onChange:e=>_t({turbulenceZAmp:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa",minWidth:"40px"},children:"\u0427\u0430\u0441\u0442\u043e\u0442\u0430"}),(0,c.jsx)("input",{type:"range",min:"0.001",max:"0.05",step:"0.001",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(be=jt.turbulenceFreq)&&void 0!==be?be:.01,onChange:e=>_t({turbulenceFreq:parseFloat(e.target.value)})})]})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"rgba(255,255,255,0.05)"}}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0422\u0440\u0430\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043f\u043e\u043b\u0435\u0442\u0430"}),(0,c.jsxs)("div",{style:{display:"flex",gap:2,background:"#222",padding:"2px",borderRadius:"4px",border:"1px solid #333"},children:[(0,c.jsx)("button",{style:s(s({},Je.presetBtn),{},{width:"35px",fontSize:"9px",padding:"2px",background:"linear"===jt.deviationType?"#00bcd4":"transparent",color:"linear"===jt.deviationType?"#000":"#888"}),onClick:()=>_t({deviationType:"linear"}),children:"Line"}),(0,c.jsx)("button",{style:s(s({},Je.presetBtn),{},{width:"35px",fontSize:"9px",padding:"2px",background:"sin"===jt.deviationType?"#00bcd4":"transparent",color:"sin"===jt.deviationType?"#000":"#888"}),onClick:()=>_t({deviationType:"sin"}),children:"Wave"})]})]}),"sin"===jt.deviationType&&(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa",display:"block",marginBottom:"2px"},children:"\u0410\u043c\u043f\u043b\u0438\u0442\u0443\u0434\u0430"}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(we=jt.deviationStrength)&&void 0!==we?we:10,onChange:e=>_t({deviationStrength:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#aaa",display:"block",marginBottom:"2px"},children:"\u0427\u0430\u0441\u0442\u043e\u0442\u0430"}),(0,c.jsx)("input",{type:"range",min:"0.005",max:"0.1",step:"0.005",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(Se=jt.deviationFreq)&&void 0!==Se?Se:.01,onChange:e=>_t({deviationFreq:parseFloat(e.target.value)})})]})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"rgba(255,255,255,0.05)"}}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#00bcd4",textTransform:"uppercase",fontWeight:600,display:"block",marginBottom:"8px"},children:"\u0412\u043b\u0438\u044f\u043d\u0438\u0435 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438"}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0410\u044d\u0440\u043e-\u0432\u044b\u0442\u044f\u0433\u0438\u0432\u0430\u043d\u0438\u0435"}),(0,c.jsx)("span",{style:{fontSize:"9px",color:"#666"},children:jt.velocityStretch>0?"\u0412\u043a\u043b":"\u0412\u044b\u043a\u043b"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"5",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4",flex:1}),value:null!==(ke=jt.velocityStretch)&&void 0!==ke?ke:0,onChange:e=>_t({velocityStretch:parseFloat(e.target.value)})}),jt.velocityStretch>0&&(0,c.jsx)("input",{type:"range",min:"0",max:"5",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4",flex:1,opacity:.7}),value:null!==(Ce=jt.velocityExStretch)&&void 0!==Ce?Ce:0,onChange:e=>_t({velocityExStretch:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:s(s({},Je.checkboxRow),{},{marginBottom:"6px"}),children:[(0,c.jsx)("input",{type:"checkbox",checked:!!jt.rotateByVelocity,onChange:e=>_t({rotateByVelocity:e.target.checked}),style:{accentColor:"#00bcd4"}}),(0,c.jsx)("label",{style:{fontSize:"10px",color:"#fff",marginLeft:"8px"},children:"\u0420\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0442\u044c \u043f\u043e \u043a\u0443\u0440\u0441\u0443 (Aim)"})]}),!jt.rotateByVelocity&&(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",paddingLeft:"20px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#666",display:"block"},children:"\u0423\u0433\u043e\u043b \u0441\u0442\u0430\u0440\u0442"}),(0,c.jsx)("input",{type:"range",min:"-180",max:"180",step:"5",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(je=jt.rotate)&&void 0!==je?je:0,onChange:e=>_t({rotate:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"9px",color:"#666",display:"block"},children:"\u0420\u0430\u043d\u0434\u043e\u043c \xb1"}),(0,c.jsx)("input",{type:"range",min:"0",max:"180",step:"5",style:s(s({},Je.rangeInput),{},{height:"3px"}),value:null!==(_e=jt.rotateVar)&&void 0!==_e?_e:0,onChange:e=>_t({rotateVar:parseInt(e.target.value)})})]})]})]})]})]})]}),(0,c.jsxs)("div",{style:{background:"rgba(255,152,0,0.05)",borderRadius:"6px",padding:"8px",border:"1px dashed rgba(255,152,0,0.2)"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#ffb74d",fontWeight:700,marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u041c\u0438\u043a\u0440\u043e-\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc",width:"50px"},children:"\u0421\u043f\u0438\u043d"}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#ff9100",flex:1,height:"4px"}),value:null!==(Ee=jt.selfRotateSpeed)&&void 0!==Ee?Ee:0,onChange:e=>_t({selfRotateSpeed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc",width:"50px"},children:"\u041f\u0443\u043b\u044c\u0441"}),(0,c.jsx)("input",{type:"range",min:"0",max:"5",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#ff9100",flex:1,height:"4px"}),value:null!==(De=jt.pulseSpeed)&&void 0!==De?De:0,onChange:e=>_t({pulseSpeed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc",width:"50px"},children:"3D Flip"}),(0,c.jsx)("input",{type:"range",min:"0",max:"5",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#ff9100",flex:1,height:"4px"}),value:null!==(Me=jt.flipSpeed)&&void 0!==Me?Me:0,onChange:e=>_t({flipSpeed:parseFloat(e.target.value)})})]})]})]})]}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("generator"),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,c.jsx)("span",{children:"\ud83d\udccd"}),(0,c.jsx)("span",{style:{fontWeight:600},children:"\u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 \u0438 \u0417\u043e\u043d\u0430"})]}),(0,c.jsx)("span",{style:{opacity:.6},children:"generator"===Qe?"\u25b2":"\u25bc"})]}),"generator"===Qe&&(0,c.jsxs)("div",{style:s(s({},Je.subContent),{},{display:"flex",flexDirection:"column",gap:"12px"}),children:[(0,c.jsxs)("div",{style:s(s({},Je.checkboxRow),{},{borderBottom:"1px solid rgba(255,255,255,0.05)",paddingBottom:"8px",marginBottom:"4px"}),children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px"},children:"\ud83d\udc41 \u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0433\u0438\u0437\u043c\u043e \u0441\u043f\u0430\u0443\u043d\u0430"}),(0,c.jsx)("input",{type:"checkbox",checked:!1!==jt.showSpawnDebug,onChange:e=>_t({showSpawnDebug:e.target.checked}),style:{accentColor:"#00e5ff",cursor:"pointer"}})]}),(0,c.jsxs)("div",{style:{paddingBottom:"8px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"8px"},children:"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0447\u0430\u0441\u0442\u0438\u0446:"}),(0,c.jsxs)("select",{style:s(s({},Je.selectInput),{},{width:"100%"}),value:jt.generationType||"box",onChange:e=>_t({generationType:e.target.value}),children:[(0,c.jsx)("option",{value:"box",children:"\ud83d\udce6 Box (\u041e\u0431\u043b\u0430\u0441\u0442\u044c)"}),(0,c.jsx)("option",{value:"line",children:"\ud83d\udccf Line (\u041b\u0438\u043d\u0438\u044f)"}),(0,c.jsx)("option",{value:"point",children:"\u25c9 Point (\u0422\u043e\u0447\u043a\u0430)"}),(0,c.jsx)("option",{value:"cursor",children:"\ud83d\udc46 Cursor (\u0418\u0437 \u043a\u0443\u0440\u0441\u043e\u0440\u0430)"}),it>0&&(0,c.jsx)("option",{value:"sub-layer",style:{color:"#ffeb3b",fontWeight:"bold"},children:"\ud83d\udca5 \u0418\u0437 \u043f\u0440\u043e\u0448\u043b\u043e\u0433\u043e \u0441\u043b\u043e\u044f (Death Link)"})]})]}),("point"===jt.generationType||"box"===jt.generationType||"line"===jt.generationType||!jt.generationType)&&(e=>{const t="box"===jt.generationType||!jt.generationType,n="line"===jt.generationType,r=[{deg:0,label:"\u25ba",name:"\u0412\u043f\u0440\u0430\u0432\u043e",color:"#00e5ff"},{deg:90,label:"\u25bc",name:"\u0412\u043d\u0438\u0437",color:"#4caf50"},{deg:180,label:"\u25c4",name:"\u0412\u043b\u0435\u0432\u043e",color:"#ff5252"},{deg:270,label:"\u25b2",name:"\u0412\u0432\u0435\u0440\u0445",color:"#ffc107"}],o=null!==(e=jt.generationDir)&&void 0!==e?e:90,i=r.find(e=>e.deg===o),a=(null===i||void 0===i?void 0:i.color)||"#ff9800";return(0,c.jsxs)("div",{style:{background:"rgba(255,255,255,0.02)",padding:"8px",borderRadius:"6px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#00e5ff",fontWeight:500},children:n?"\u041a\u0443\u0434\u0430 \u043b\u0435\u0442\u044f\u0442 (\xb0)":"\u041d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 ".concat(t?"(\u0421\u0442\u043e\u0440\u043e\u043d\u044b)":"(\xb0)")}),!t&&(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#00e5ff",background:"rgba(0,229,255,0.1)",padding:"1px 4px",borderRadius:"3px"},children:[o,"\xb0"]})]}),(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(0,c.jsx)("input",{type:"range",min:0,max:t?270:360,step:t?90:5,value:o,onChange:e=>_t({generationDir:parseInt(e.target.value)}),style:s(s({},Je.rangeInput),{},{accentColor:t?a:"#00e5ff",flex:1,height:"4px"})})}),t&&(0,c.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"4px",marginTop:"8px"},children:r.map(e=>{const t=e.deg===o;return(0,c.jsx)("div",{onClick:()=>_t({generationDir:e.deg}),title:e.name,style:{display:"flex",justifyContent:"center",alignItems:"center",height:"24px",fontSize:"14px",borderRadius:"4px",background:t?"rgba(".concat(parseInt(e.color.slice(1,3),16),", ").concat(parseInt(e.color.slice(3,5),16),", ").concat(parseInt(e.color.slice(5,7),16),", 0.2)"):"rgba(255,255,255,0.05)",border:"1px solid ".concat(t?e.color:"transparent"),color:t?e.color:"#666",cursor:"pointer",transition:"all 0.2s"},children:e.label},e.deg)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#555",marginTop:"6px",textAlign:"right"},children:t?"\u0424\u0438\u043a\u0441: ".concat(null===i||void 0===i?void 0:i.name):"0\xb0=Right, 90\xb0=Down"})]})})(),"line"===jt.generationType&&(0,c.jsxs)("div",{style:{background:"rgba(103, 58, 183, 0.1)",padding:"8px",borderRadius:"6px",border:"1px dashed rgba(103, 58, 183, 0.3)"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#b39ddb"},children:"\ud83d\udd04 \u041f\u043e\u0432\u043e\u0440\u043e\u0442 \u041b\u0438\u043d\u0438\u0438"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#fff"},children:[null!==(Te=jt.areaRotation)&&void 0!==Te?Te:0,"\xb0"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"360",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#b39ddb",width:"100%",marginBottom:"10px"}),value:null!==(Ie=jt.areaRotation)&&void 0!==Ie?Ie:0,onChange:e=>_t({areaRotation:parseInt(e.target.value)})})]}),"point"===jt.generationType&&(0,c.jsxs)("div",{style:{background:"rgba(255,235,59,0.05)",padding:"8px",borderRadius:"6px",border:"1px dashed rgba(255,235,59,0.2)"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ffeb3b"},children:"\ud83d\udca5 \u0412\u044b\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u043d\u0438\u0435"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#fff"},children:null!==(Ae=jt.pointPushForce)&&void 0!==Ae?Ae:0})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#ffeb3b",width:"100%",marginBottom:"10px"}),value:null!==(Oe=jt.pointPushForce)&&void 0!==Oe?Oe:0,onChange:e=>_t({pointPushForce:parseInt(e.target.value)})}),jt.pointPushForce>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#03a9f4"},children:"\ud83d\udcd0 \u0413\u043b\u0443\u0431\u0438\u043d\u0430 (Z)"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#fff"},children:[null!==(Re=jt.pointPushZ)&&void 0!==Re?Re:0,"\xb0"]})]}),(0,c.jsx)("input",{type:"range",min:"-90",max:"90",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#03a9f4",width:"100%"}),value:null!==(ze=jt.pointPushZ)&&void 0!==ze?ze:0,onChange:e=>_t({pointPushZ:parseInt(e.target.value)})})]})]}),("box"===jt.generationType||"line"===jt.generationType||!jt.generationType)&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#aaa",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0420\u0430\u0437\u043c\u0435\u0440\u044b \u0437\u043e\u043d\u044b"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#ccc"},children:"line"===jt.generationType?"\u0414\u043b\u0438\u043d\u0430":"\u0428\u0438\u0440\u0438\u043d\u0430 (X)"}),(0,c.jsx)("input",{type:"number",step:"1",style:s(s({},Je.selectInput),{},{width:"45px",padding:"2px",textAlign:"right",border:"none",background:"transparent",color:"#fff",fontWeight:500}),value:null!==(Fe=jt.areaScaleX)&&void 0!==Fe?Fe:100,onChange:e=>_t({areaScaleX:parseInt(e.target.value)})})]}),(0,c.jsx)("input",{type:"range",min:"1",max:"500",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4",width:"100%",margin:0}),value:null!==(Pe=jt.areaScaleX)&&void 0!==Pe?Pe:100,onChange:e=>_t({areaScaleX:parseInt(e.target.value)})})]}),"line"!==jt.generationType&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#ccc"},children:"\u0412\u044b\u0441\u043e\u0442\u0430 (Y)"}),(0,c.jsx)("input",{type:"number",step:"5",style:s(s({},Je.selectInput),{},{width:"45px",padding:"2px",textAlign:"right",border:"none",background:"transparent",color:"#fff",fontWeight:500}),value:null!==(Be=jt.areaScaleY)&&void 0!==Be?Be:100,onChange:e=>_t({areaScaleY:parseInt(e.target.value)})})]}),(0,c.jsx)("input",{type:"range",min:"10",max:"400",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#00bcd4",width:"100%",margin:0}),value:null!==(Le=jt.areaScaleY)&&void 0!==Le?Le:100,onChange:e=>_t({areaScaleY:parseInt(e.target.value)})})]})]}),("box"===jt.generationType||"point"===jt.generationType||"line"===jt.generationType||!jt.generationType)&&(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",borderTop:"1px solid rgba(255,255,255,0.05)",paddingTop:"12px",marginTop:"4px"},children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#aaa",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0446\u0435\u043d\u0442\u0440\u0430"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0434\u0432\u0438\u0433 \u043f\u043e X"}),(0,c.jsx)("input",{type:"number",step:"1",style:s(s({},Je.selectInput),{},{width:"45px",padding:"2px",textAlign:"right",border:"none",background:"transparent",color:"#fff",fontWeight:500}),value:null!==(Ne=jt.areaOffsetX)&&void 0!==Ne?Ne:0,onChange:e=>_t({areaOffsetX:parseInt(e.target.value)})})]}),(0,c.jsx)("input",{type:"range",min:"-200",max:"200",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#9e9e9e",width:"100%",margin:0}),value:null!==(Ue=jt.areaOffsetX)&&void 0!==Ue?Ue:0,onChange:e=>_t({areaOffsetX:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u0434\u0432\u0438\u0433 \u043f\u043e Y"}),(0,c.jsx)("input",{type:"number",step:"1",style:s(s({},Je.selectInput),{},{width:"45px",padding:"2px",textAlign:"right",border:"none",background:"transparent",color:"#fff",fontWeight:500}),value:null!==(Ve=jt.areaOffsetY)&&void 0!==Ve?Ve:0,onChange:e=>_t({areaOffsetY:parseInt(e.target.value)})})]}),(0,c.jsx)("input",{type:"range",min:"-200",max:"200",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#9e9e9e",width:"100%",margin:0}),value:null!==(We=jt.areaOffsetY)&&void 0!==We?We:0,onChange:e=>_t({areaOffsetY:parseInt(e.target.value)})})]})]}),"cursor"===jt.generationType&&(0,c.jsxs)("div",{style:{padding:"12px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"4px",textAlign:"center",fontSize:"11px",color:"#aaa",fontStyle:"italic"},children:["\u2728 \u0427\u0430\u0441\u0442\u0438\u0446\u044b \u0431\u0443\u0434\u0443\u0442 \u0440\u043e\u0436\u0434\u0430\u0442\u044c\u0441\u044f",(0,c.jsx)("br",{}),"\u0432 \u0442\u043e\u0447\u043a\u0435 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u0440\u0430 \u043c\u044b\u0448\u0438."]})]}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("interaction"),children:[(0,c.jsx)("span",{children:"\ud83d\udc46 \u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"}),(0,c.jsx)("span",{children:"interaction"===Qe?"\u25b2":"\u25bc"})]}),"interaction"===Qe&&(0,c.jsxs)("div",{style:Je.subContent,children:[(0,c.jsx)("div",{style:Je.checkboxRow,children:(0,c.jsxs)("label",{style:{fontSize:"11px",color:"#fff",display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!jt.mouseInteraction,onChange:e=>_t({mouseInteraction:e.target.checked}),style:{accentColor:"#00bcd4",cursor:"pointer"}}),"\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043c\u044b\u0448\u044c\u044e"]})}),jt.mouseInteraction&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"3px"},children:"\u0420\u0435\u0436\u0438\u043c \u043a\u0443\u0440\u0441\u043e\u0440\u0430"}),(0,c.jsxs)("select",{style:Je.selectInput,value:jt.mouseType||"repel",onChange:e=>_t({mouseType:e.target.value}),children:[(0,c.jsx)("option",{value:"repel",children:"\ud83d\udca8 \u041e\u0442\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u043d\u0438\u0435"}),(0,c.jsx)("option",{value:"magnet",children:"\ud83e\uddf2 \u041f\u0440\u0438\u043b\u0438\u043f\u0430\u043d\u0438\u0435 (\u041c\u0430\u0433\u043d\u0438\u0442)"})]})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0434\u0438\u0443\u0441 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f"})}),(0,c.jsx)("input",{type:"range",min:"50",max:"500",step:"10",style:s(s({},Je.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(He=jt.mouseRadius)&&void 0!==He?He:150,onChange:e=>_t({mouseRadius:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"magnet"===jt.mouseType?"\u0421\u0438\u043b\u0430 \u043f\u0440\u0438\u0442\u044f\u0433\u0438\u0432\u0430\u043d\u0438\u044f":"\u0421\u0438\u043b\u0430 \u043e\u0442\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u043d\u0438\u044f"})}),(0,c.jsx)("input",{type:"range",min:"1",max:"20",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#e91e63"}),value:null!==(Ge=jt.mouseForce)&&void 0!==Ge?Ge:5,onChange:e=>_t({mouseForce:parseInt(e.target.value)})})]})]})]}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("blocks"),children:[(0,c.jsx)("span",{children:"\u26d4 \u0411\u043b\u043e\u043a\u0438 \u0438 \u0417\u043e\u043d\u044b"}),(0,c.jsx)("span",{children:"blocks"===Qe?"\u25b2":"\u25bc"})]}),"blocks"===Qe&&(0,c.jsxs)("div",{style:Je.subContent,children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#aaa",marginBottom:"8px"},children:"\u0421\u0442\u0430\u0442\u0438\u0447\u043d\u044b\u0435 \u0437\u043e\u043d\u044b, \u043e\u0442\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u043b\u0438 \u043f\u0440\u0438\u0442\u044f\u0433\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0447\u0430\u0441\u0442\u0438\u0446\u044b."}),(0,c.jsxs)("div",{style:s(s({},Je.checkboxRow),{},{borderBottom:"1px solid #444",paddingBottom:"10px",marginBottom:"10px"}),children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",fontWeight:"bold"},children:"\ud83d\udc41 \u0421\u043a\u0440\u044b\u0442\u044c \u043a\u043e\u043d\u0442\u0443\u0440\u044b \u0437\u043e\u043d"}),(0,c.jsx)("input",{type:"checkbox",checked:jt.hideZoneDebug||!1,onChange:e=>_t({hideZoneDebug:e.target.checked}),style:{accentColor:"#00bcd4",cursor:"pointer"}})]}),(0,c.jsxs)("div",{style:{background:"rgba(233, 30, 99, 0.1)",padding:"8px",borderRadius:"4px",marginBottom:"15px",border:"1px dashed #e91e63"},children:[(0,c.jsxs)("div",{style:Je.checkboxRow,children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",fontWeight:"bold"},children:"\ud83e\uddf9 \u041e\u0447\u0438\u0449\u0430\u0442\u044c \u0437\u0430\u0441\u0442\u0440\u044f\u0432\u0448\u0438\u0435"}),(0,c.jsx)("input",{type:"checkbox",checked:jt.cleanStuck||!1,onChange:e=>_t({cleanStuck:e.target.checked}),style:{accentColor:"#e91e63"}})]}),jt.cleanStuck&&(0,c.jsxs)("div",{style:{marginTop:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc"},children:"\u0427\u0435\u0440\u0435\u0437 (\u0441\u0435\u043a):"}),(0,c.jsx)("input",{type:"number",min:"0.5",step:"0.5",style:s(s({},Je.selectInput),{},{width:"60px"}),value:jt.cleanStuckTime||3,onChange:e=>_t({cleanStuckTime:parseFloat(e.target.value)})}),(0,c.jsx)(PE,{text:"\u0415\u0441\u043b\u0438 \u0447\u0430\u0441\u0442\u0438\u0446\u0430 \u043f\u043e\u0447\u0442\u0438 \u043d\u0435 \u0434\u0432\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f, \u043e\u043d\u0430 \u043f\u043b\u0430\u0432\u043d\u043e \u0438\u0441\u0447\u0435\u0437\u043d\u0435\u0442 \u0438 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0441\u0432\u0435\u0440\u0445\u0443."})]})]}),(0,c.jsx)("div",{style:{display:"flex",gap:"5px",marginBottom:"15px"},children:[0,1,2,3,4].map(e=>(0,c.jsx)("button",{onClick:()=>lt(e),style:{flex:1,padding:"6px",border:"none",borderRadius:"4px",cursor:"pointer",background:st===e?"#e91e63":"#444",color:"#fff",fontSize:"11px",fontWeight:"bold"},children:e+1},e))}),(0,c.jsxs)("div",{style:{background:"rgba(0,0,0,0.2)",padding:"8px",borderRadius:"4px"},children:[(0,c.jsxs)("div",{style:Je.checkboxRow,children:[(0,c.jsxs)("label",{style:{fontSize:"11px",color:"#fff",fontWeight:"bold"},children:["\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0417\u043e\u043d\u0443 #",st+1]}),(0,c.jsx)("input",{type:"checkbox",checked:Tt.enabled,onChange:e=>Mt(st,{enabled:e.target.checked}),style:{accentColor:"#e91e63"}})]}),Tt.enabled&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"3px"},children:"\u0420\u0435\u0436\u0438\u043c"}),(0,c.jsxs)("select",{style:Je.selectInput,value:Tt.mode||"normal",onChange:e=>Mt(st,{mode:e.target.value}),children:[(0,c.jsx)("option",{value:"normal",children:"\ud83e\uddf1 \u0421\u0442\u0435\u043d\u0430"}),(0,c.jsx)("option",{value:"bounce",children:"\ud83c\udfc0 \u041e\u0442\u0441\u043a\u043e\u043a"}),(0,c.jsx)("option",{value:"magnet",children:"\ud83e\uddf2 \u041c\u0430\u0433\u043d\u0438\u0442"}),(0,c.jsx)("option",{value:"absorb",children:"\ud83d\udd73\ufe0f \u041f\u043e\u0433\u043b\u043e\u0449\u0435\u043d\u0438\u0435"})]})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"3px"},children:"\u0424\u043e\u0440\u043c\u0430"}),(0,c.jsxs)("select",{style:Je.selectInput,value:Tt.type,onChange:e=>Mt(st,{type:e.target.value}),children:[(0,c.jsx)("option",{value:"circle",children:"\u041a\u0440\u0443\u0433"}),(0,c.jsx)("option",{value:"rect",children:"\u041a\u0432\u0430\u0434\u0440\u0430\u0442"}),(0,c.jsx)("option",{value:"point",children:"\u25c9 \u0422\u043e\u0447\u043a\u0430 (\u041f\u043e\u043b\u0435)"})]})]})]}),("magnet"===Tt.mode||"bounce"===Tt.mode)&&(0,c.jsxs)("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"rgba(0, 229, 255, 0.05)",borderRadius:"4px",border:"1px solid rgba(0, 229, 255, 0.1)"},children:["magnet"===Tt.mode&&(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#00e5ff",display:"block",marginBottom:"3px"},children:"\u0421\u0438\u043b\u0430 \u043f\u0440\u0438\u043b\u0438\u043f\u0430\u043d\u0438\u044f"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#fff",fontFamily:"monospace"},children:[Tt.magnetStickiness||0,"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},Je.rangeInput),{},{accentColor:"#00e5ff"}),value:Tt.magnetStickiness||0,onChange:e=>Mt(st,{magnetStickiness:parseInt(e.target.value)})})]}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsxs)("label",{style:{fontSize:"10px",color:"#00e5ff",display:"block",marginBottom:"3px"},children:["bounce"===Tt.mode?"\u0420\u0430\u0434\u0438\u0443\u0441 \u043f\u043e\u043b\u044f (\u043f\u043e\u0434\u0443\u0448\u043a\u0430)":"\u0414\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u0445\u0432\u0430\u0442\u0430"," (px)"]}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#fff",fontFamily:"monospace"},children:void 0!==Tt.magnetRange?Tt.magnetRange:60})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"300",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#00e5ff"}),value:void 0!==Tt.magnetRange?Tt.magnetRange:60,onChange:e=>Mt(st,{magnetRange:parseInt(e.target.value)})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#888",marginTop:"2px"},children:"bounce"===Tt.mode?"\u0414\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u044f, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0444\u0438\u0433\u0443\u0440\u0430 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u043e\u0442\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u0442\u044c \u0447\u0430\u0441\u0442\u0438\u0446\u044b.":"\u0417\u043e\u043d\u0430, \u0433\u0434\u0435 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u0440\u043c\u043e\u0436\u0435\u043d\u0438\u0435."})]}),"magnet"===Tt.mode&&(0,c.jsxs)("div",{style:{marginBottom:"0px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#00e5ff",display:"block",marginBottom:"3px"},children:"\u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u0447\u0430\u0441\u0442\u0438\u0446"}),(0,c.jsxs)("span",{style:{fontSize:"10px",color:"#fff",fontFamily:"monospace"},children:["+",Tt.magnetScale||0,"%"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"300",step:"10",style:s(s({},Je.rangeInput),{},{accentColor:"#00e5ff"}),value:Tt.magnetScale||0,onChange:e=>Mt(st,{magnetScale:parseInt(e.target.value)})})]})]}),(0,c.jsx)(MK,{zone:Tt,onChange:e=>Mt(st,e),currentTime:$e||0,onTimeChange:Ke||(()=>{})}),(0,c.jsxs)("div",{style:s(s({},Je.row),{},{borderTop:"1px dashed #444",paddingTop:"10px"}),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0418\u0433\u043d\u043e\u0440 \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u0447\u0430\u0441\u0442\u0438\u0446"}),(0,c.jsx)(PE,{text:"0 = \u0412\u0441\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442. 1 = \u0422\u043e\u043b\u044c\u043a\u043e \u0441\u0430\u043c\u044b\u0435 \u043c\u0435\u043b\u043a\u0438\u0435 (\u0437\u0430\u0434\u043d\u0438\u0439 \u043f\u043b\u0430\u043d)."})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"0.9",step:"0.1",style:s(s({},Je.rangeInput),{},{accentColor:"#e91e63"}),value:Tt.ignoreSize,onChange:e=>Mt(st,{ignoreSize:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:Je.valueLabel,children:Tt.ignoreSize})]})]}),"rect"===Tt.type&&(0,c.jsxs)("div",{style:Je.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u0443\u0433\u043b\u043e\u0432 (Radius)"}),(0,c.jsx)(PE,{text:"0 = \u041a\u0432\u0430\u0434\u0440\u0430\u0442. \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c = \u041a\u0440\u0443\u0433 (\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u043e\u0439 \u0448\u0438\u0440\u0438\u043d\u044b/\u0432\u044b\u0441\u043e\u0442\u044b)."})]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"400",step:"5",style:s(s({},Je.rangeInput),{},{accentColor:"#e91e63"}),value:Tt.borderRadius||0,onChange:e=>Mt(st,{borderRadius:parseInt(e.target.value)})}),(0,c.jsxs)("span",{style:Je.valueLabel,children:[Tt.borderRadius||0,"px"]})]})]})]})]})]}),(0,c.jsxs)("div",{style:Je.subHeader,onClick:()=>Dt("io"),children:[(0,c.jsx)("span",{children:"\ud83d\udcbe \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438 \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),(0,c.jsx)("span",{children:"io"===Qe?"\u25b2":"\u25bc"})]}),"io"===Qe&&(0,c.jsxs)("div",{style:Je.subContent,children:[(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666",marginBottom:"10px"},children:"\u0418\u043c\u043f\u043e\u0440\u0442/\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u043b\u043e\u044f."}),(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\ud83d\udccb \u0411\u0443\u0444\u0435\u0440 \u043e\u0431\u043c\u0435\u043d\u0430 (\u0411\u044b\u0441\u0442\u0440\u043e)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsx)("button",{onClick:()=>{const e=JSON.stringify(jt,null,2);navigator.clipboard.writeText(e).then(()=>alert("\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u043b\u043e\u044f \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0432 \u0431\u0443\u0444\u0435\u0440! \ud83d\udccb")).catch(e=>console.error(e))},style:s(s({},Je.presetBtn),{},{background:"#444",border:"1px solid #555"}),title:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c JSON \u0432 \u0431\u0443\u0444\u0435\u0440",children:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,c.jsx)("button",{onClick:async()=>{try{const e=await navigator.clipboard.readText();if(!e)return;const t=JSON.parse(e),n=s(s(s({},TK()),t),{},{enabled:!0});_t(n),alert("\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b! \ud83d\udce5")}catch(e){console.error(e),alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 JSON \u0432 \u0431\u0443\u0444\u0435\u0440\u0435.")}},style:s(s({},Je.presetBtn),{},{background:"#444",border:"1px solid #555"}),title:"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c JSON \u0438\u0437 \u0431\u0443\u0444\u0435\u0440\u0430",children:"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c"})]})]}),(0,c.jsx)("hr",{style:{border:"0",borderTop:"1px dashed #444",margin:"10px 0"}}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#aaa",display:"block",marginBottom:"4px"},children:"\ud83d\udcc1 \u0424\u0430\u0439\u043b\u044b (JSON)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsx)("button",{onClick:()=>{const e=JSON.stringify(jt,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="weather_layer_".concat(it+1,"_").concat((new Date).toISOString().slice(0,10),".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},style:s(s({},Je.presetBtn),{},{background:"#00838f",color:"#fff"}),title:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a",children:"\ud83d\udcbe \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),(0,c.jsx)("button",{onClick:()=>ht.current&&ht.current.click(),style:s(s({},Je.presetBtn),{},{background:"#e65100",color:"#fff"}),title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a",children:"\ud83d\udcc2 \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"}),(0,c.jsx)("input",{type:"file",accept:".json",ref:ht,style:{display:"none"},onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result),n=s(s(s({},TK()),t),{},{enabled:!0});_t(n),alert("\u0424\u0430\u0439\u043b \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d! \ud83d\udcc2")}catch(t){console.error(t),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0447\u0442\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430.")}},n.readAsText(t),e.target.value=""}})]})]})]})]})]})},OK=e=>{let{title:t,isOpen:n,onToggle:r,children:o}=e;return(0,c.jsxs)("div",{style:{borderBottom:"1px solid #333",paddingBottom:"8px",marginBottom:"8px"},children:[(0,c.jsxs)("div",{onClick:r,style:{padding:"8px 4px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"11px",fontWeight:"600",color:"#888",textTransform:"uppercase",letterSpacing:"0.5px"},children:[t,(0,c.jsx)("span",{style:{transform:n?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),n&&(0,c.jsx)("div",{style:{padding:"0 4px",display:"flex",flexDirection:"column",gap:"12px"},children:o})]})},RK=e=>{let{label:t,value:n,children:r,subLabel:o,tooltip:i}=e;return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",color:"#ccc"},children:t}),i&&(0,c.jsx)(PE,{text:i})]}),void 0!==n&&(0,c.jsx)("span",{style:{fontSize:"10px",color:"#ffb450",fontFamily:"monospace"},children:n})]}),o&&(0,c.jsx)("span",{style:{fontSize:"10px",color:"#666"},children:o}),r]})},zK=e=>{let{value:t,min:n,max:r,step:o,onChange:i,accent:a="#ff9800"}=e;return(0,c.jsx)("input",{type:"range",min:n,max:r,step:o,value:t,onChange:e=>i(parseFloat(e.target.value)),style:{width:"100%",cursor:"pointer",height:"4px",accentColor:a,background:"rgba(255,255,255,0.1)",borderRadius:"2px",outline:"none"}})},FK=e=>{let{value:t,options:n,onChange:r}=e;return(0,c.jsx)("select",{value:t,onChange:e=>r(e.target.value),style:{width:"100%",padding:"6px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},children:n.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))})},PK=e=>{let{label:t,checked:n,onChange:r,tooltip:o}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:e=>{e.stopPropagation(),r(!n)},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{fontSize:"12px",color:"#ccc"},children:t}),o&&(0,c.jsx)(PE,{text:o})]}),(0,c.jsx)("div",{style:{width:"32px",height:"18px",background:n?"#ff9800":"#444",borderRadius:"10px",position:"relative",transition:"0.3s",flexShrink:0},children:(0,c.jsx)("div",{style:{width:"14px",height:"14px",background:"#fff",borderRadius:"50%",position:"absolute",top:"2px",left:n?"16px":"2px",transition:"0.3s"}})})]})},BK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P,B,L,N,U,V,W,H,G,X,Y,q,Z,$,K,J,Q,ee,te,ne,re,oe;let{settings:ie,onUpdate:ae,isExpanded:se,onToggle:le,assetsMap:ce,textureFiles:de}=t;const ue=(0,e.useRef)(null),[pe,he]=(0,e.useState)({general:!0,animation:!0,geometry:!1,layers:!1}),fe=e=>he(t=>s(s({},t),{},{[e]:!t[e]})),ge=ie||{},me=!!ge.enabled,[ve,ye]=(0,e.useState)(!1),xe={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",border:"1px solid #333"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",userSelect:"none"}},be={opacity:me?1:.5,pointerEvents:me?"auto":"none",transition:"opacity 0.3s ease"};return(0,c.jsxs)("div",{style:xe.panel,children:[(0,c.jsxs)("div",{style:xe.header,onClick:le,children:[(0,c.jsx)("input",{type:"checkbox",checked:me,onClick:e=>e.stopPropagation(),onChange:e=>ae({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#ff9800"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u0424\u043e\u043d\u0430\u0440\u0438\u043a \ud83d\udd26"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#ff9800",background:"rgba(255, 152, 0, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:me?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:se?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),se&&(0,c.jsxs)("div",{style:be,children:[(0,c.jsxs)(OK,{title:"\u0410\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0430 \u0438 \u0421\u0432\u0435\u0442",isOpen:pe.general,onToggle:()=>fe("general"),children:[(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,c.jsx)(RK,{label:"\u0426\u0432\u0435\u0442",children:(0,c.jsx)(T$,{color:ge.ambientColor||"#ffb450",onChange:e=>ae({ambientColor:e})})}),(0,c.jsx)("div",{style:{marginTop:"auto",marginBottom:"5px"},children:(0,c.jsx)(PK,{label:"\u041c\u043e\u043d\u043e\u0445\u0440\u043e\u043c",checked:!!ge.monochrome,onChange:e=>ae({monochrome:e}),tooltip:"\u0412 \u043c\u043e\u043d\u043e\u0445\u0440\u043e\u043c\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0446\u0432\u0435\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f. \u0421\u0432\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043a\u0430\u043a \u043c\u0430\u0441\u043a\u0430."})})]}),(0,c.jsx)(RK,{label:"\u0413\u0443\u0441\u0442\u043e\u0442\u0430 \u0442\u044c\u043c\u044b",value:null!==(n=ge.opacity)&&void 0!==n?n:.9,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(r=ge.opacity)&&void 0!==r?r:.9,onChange:e=>ae({opacity:e}),accent:"#aaa"})}),(0,c.jsx)(RK,{label:"\u0418\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0441\u0432\u0435\u0442\u0430",value:null!==(o=ge.lightIntensity)&&void 0!==o?o:1,children:(0,c.jsx)(zK,{min:0,max:2,step:.1,value:null!==(i=ge.lightIntensity)&&void 0!==i?i:1,onChange:e=>ae({lightIntensity:e})})})]}),(0,c.jsxs)(OK,{title:"\u0414\u0438\u043d\u0430\u043c\u0438\u043a\u0430",isOpen:pe.animation,onToggle:()=>fe("animation"),children:[(0,c.jsx)(RK,{label:"\u0420\u0435\u0436\u0438\u043c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438",children:(0,c.jsx)(FK,{value:ge.animationType||"none",options:[{value:"none",label:"Static (\u041d\u0435\u0442)"},{value:"candle",label:"Candle (\u041c\u0435\u0440\u0446\u0430\u043d\u0438\u0435)"},{value:"pulse",label:"Pulse (\u041f\u0443\u043b\u044c\u0441\u0430\u0446\u0438\u044f)"},{value:"broken",label:"Broken (\u0421\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0439)"},{value:"shake",label:"Shake (\u0422\u0440\u044f\u0441\u043a\u0430)"},{value:"dynamic",label:"Dynamic (\u041e\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438)"}],onChange:e=>ae({animationType:e})})}),"shake"===ge.animationType&&(0,c.jsx)("div",{style:{background:"#333",padding:"8px",borderRadius:"4px"},children:(0,c.jsx)(RK,{label:"\u0410\u043c\u043f\u043b\u0438\u0442\u0443\u0434\u0430 \u0442\u0440\u044f\u0441\u043a\u0438",value:null!==(a=ge.shakeAmplitude)&&void 0!==a?a:15,children:(0,c.jsx)(zK,{min:0,max:100,step:1,value:null!==(l=ge.shakeAmplitude)&&void 0!==l?l:15,onChange:e=>ae({shakeAmplitude:e})})})}),"dynamic"===ge.animationType&&(0,c.jsxs)("div",{style:{background:"rgba(255, 152, 0, 0.1)",padding:"8px",borderRadius:"4px",borderLeft:"2px solid #ff9800"},children:[(0,c.jsx)(RK,{label:"\u041f\u043e\u0440\u043e\u0433 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438",value:null!==(d=ge.dynamicSpeed)&&void 0!==d?d:30,children:(0,c.jsx)(zK,{min:1,max:100,step:1,value:null!==(u=ge.dynamicSpeed)&&void 0!==u?u:30,onChange:e=>ae({dynamicSpeed:e})})}),(0,c.jsx)("div",{style:{marginTop:"8px"},children:(0,c.jsx)(PK,{label:"\u0418\u043d\u0432\u0435\u0440\u0441\u0438\u044f \u043f\u0440\u0438 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0438",checked:!!ge.dynamicInvert,onChange:e=>ae({dynamicInvert:e}),tooltip:"\u0412\u041a\u041b: \u0413\u043e\u0440\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0438. \u0412\u042b\u041a\u041b: \u0413\u0430\u0441\u043d\u0435\u0442 \u043e\u0442 \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f."})})]}),(0,c.jsx)(RK,{label:"\u0412\u0435\u0441 (\u0418\u043d\u0435\u0440\u0446\u0438\u044f)",value:null!==(p=ge.lagIntensity)&&void 0!==p?p:.8,subLabel:"\u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430 \u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0430 \u043a\u0443\u0440\u0441\u043e\u0440\u043e\u043c",children:(0,c.jsx)(zK,{min:0,max:.99,step:.01,value:null!==(h=ge.lagIntensity)&&void 0!==h?h:.8,onChange:e=>ae({lagIntensity:e}),accent:"#7568ed"})})]}),(0,c.jsxs)(OK,{title:"\u0413\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u044f \u041b\u0443\u0447\u0430",isOpen:pe.geometry,onToggle:()=>fe("geometry"),children:[(0,c.jsx)(RK,{label:"\u041e\u0431\u0449\u0438\u0439 \u0440\u0430\u0434\u0438\u0443\u0441",value:null!==(f=ge.radius)&&void 0!==f?f:150,children:(0,c.jsx)(zK,{min:50,max:800,step:10,value:null!==(g=ge.radius)&&void 0!==g?g:150,onChange:e=>ae({radius:e})})}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,c.jsx)(RK,{label:"\u0421\u0436\u0430\u0442\u0438\u0435 \u043f\u043e X",value:null!==(m=ge.scaleX)&&void 0!==m?m:1,children:(0,c.jsx)(zK,{min:.1,max:2,step:.1,value:null!==(v=ge.scaleX)&&void 0!==v?v:1,onChange:e=>ae({scaleX:e}),accent:"#666"})}),(0,c.jsx)(RK,{label:"\u0421\u0436\u0430\u0442\u0438\u0435 \u043f\u043e Y",value:null!==(y=ge.scaleY)&&void 0!==y?y:1,children:(0,c.jsx)(zK,{min:.1,max:2,step:.1,value:null!==(x=ge.scaleY)&&void 0!==x?x:1,onChange:e=>ae({scaleY:e}),accent:"#666"})})]}),(0,c.jsx)(RK,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u0433\u0440\u0430\u043d\u0438\u0446 (Blur)",value:null!==(b=ge.holeBlur)&&void 0!==b?b:.3,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(w=ge.holeBlur)&&void 0!==w?w:.3,onChange:e=>ae({holeBlur:e})})})]}),(0,c.jsxs)(OK,{title:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430 (\u041f\u0440\u043e\u0435\u043a\u0446\u0438\u044f)",isOpen:pe.texture,onToggle:()=>fe("texture"),children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0443"}),(0,c.jsx)("input",{type:"checkbox",checked:(null===(S=ge.texture)||void 0===S?void 0:S.enabled)||!1,onChange:e=>ae({texture:s(s({},ge.texture),{},{enabled:e.target.checked})}),style:{accentColor:"#ff9800"}})]}),(null===(k=ge.texture)||void 0===k?void 0:k.enabled)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{display:"flex",background:"#1e1e1e",borderRadius:"4px",padding:"2px",marginBottom:"10px",border:"1px solid #444"},children:["file","preset"].map(e=>{var t,n,r;return(0,c.jsx)("div",{onClick:()=>ae({texture:s(s({},ge.texture),{},{type:e})}),style:{flex:1,textAlign:"center",padding:"4px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",background:((null===(t=ge.texture)||void 0===t?void 0:t.type)||"file")===e?"#ff9800":"transparent",color:((null===(n=ge.texture)||void 0===n?void 0:n.type)||"file")===e?"#000":"#888",fontWeight:((null===(r=ge.texture)||void 0===r?void 0:r.type)||"file")===e?"bold":"normal"},children:"file"===e?"\ud83d\udcc1 \u0424\u0430\u0439\u043b":"\u2699\ufe0f \u041f\u0440\u0435\u0441\u0435\u0442"},e)})}),"file"===((null===(C=ge.texture)||void 0===C?void 0:C.type)||"file")&&(0,c.jsx)("div",{style:{marginBottom:"10px"},children:(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flex:1,background:"#1e1e1e",border:"1px solid #444",padding:"5px 8px",borderRadius:"4px",fontSize:"11px",color:"#fff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:null===(j=ge.texture)||void 0===j?void 0:j.url,children:null!==(_=ge.texture)&&void 0!==_&&_.url?ge.texture.url.split("/").pop():"\u0424\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d"}),(0,c.jsx)("button",{onClick:()=>ye(!0),style:{background:"#444",border:"none",borderRadius:"4px",color:"#fff",padding:"5px 10px",cursor:"pointer",fontSize:"11px"},children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"})]})}),"preset"===(null===(E=ge.texture)||void 0===E?void 0:E.type)&&(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)(FK,{value:(null===(D=ge.texture)||void 0===D?void 0:D.presetType)||"noise",options:[{value:"noise",label:"Noise (\u0428\u0443\u043c)"},{value:"grid",label:"Grid (\u0421\u0435\u0442\u043a\u0430)"},{value:"scanlines",label:"Scanlines (\u041f\u043e\u043b\u043e\u0441\u044b)"},{value:"checkerboard",label:"Checker (\u0428\u0430\u0448\u043a\u0438)"},{value:"vignette",label:"Vignette (\u0412\u0438\u043d\u044c\u0435\u0442\u043a\u0430)"}],onChange:e=>ae({texture:s(s({},ge.texture),{},{presetType:e})})}),(0,c.jsx)("div",{style:{marginTop:"8px"},children:(0,c.jsx)(RK,{label:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c \u0443\u0437\u043e\u0440\u0430",value:null!==(M=null===(T=ge.texture)||void 0===T?void 0:T.presetScale)&&void 0!==M?M:50,children:(0,c.jsx)(zK,{min:10,max:200,step:5,value:null!==(I=null===(A=ge.texture)||void 0===A?void 0:A.presetScale)&&void 0!==I?I:50,onChange:e=>ae({texture:s(s({},ge.texture),{},{presetScale:e})})})})})]}),(0,c.jsx)(RK,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b",value:null!==(O=null===(R=ge.texture)||void 0===R?void 0:R.opacity)&&void 0!==O?O:.5,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(z=null===(F=ge.texture)||void 0===F?void 0:F.opacity)&&void 0!==z?z:.5,onChange:e=>ae({texture:s(s({},ge.texture),{},{opacity:e})})})}),(0,c.jsx)(RK,{label:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 (Zoom)",value:null!==(P=null===(B=ge.texture)||void 0===B?void 0:B.scale)&&void 0!==P?P:1,children:(0,c.jsx)(zK,{min:.1,max:3,step:.1,value:null!==(L=null===(N=ge.texture)||void 0===N?void 0:N.scale)&&void 0!==L?L:1,onChange:e=>ae({texture:s(s({},ge.texture),{},{scale:e})})})}),(0,c.jsx)(RK,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u043a\u0440\u0430\u0435\u0432",value:null!==(U=null===(V=ge.texture)||void 0===V?void 0:V.blur)&&void 0!==U?U:0,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(W=null===(H=ge.texture)||void 0===H?void 0:H.blur)&&void 0!==W?W:0,onChange:e=>ae({texture:s(s({},ge.texture),{},{blur:e})})})}),(0,c.jsx)("div",{style:{marginTop:"8px"},children:(0,c.jsx)(PK,{label:"\u041d\u0435 \u0441\u043c\u0435\u0449\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0443",checked:!(null===(G=ge.texture)||void 0===G||!G.fixedPos),onChange:e=>ae({texture:s(s({},ge.texture),{},{fixedPos:e})}),tooltip:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u0430 \u043a \u044d\u043a\u0440\u0430\u043d\u0443, \u0430 \u043d\u0435 \u043a \u0444\u043e\u043d\u0430\u0440\u0438\u043a\u0443 (\u044d\u0444\u0444\u0435\u043a\u0442 \u043f\u0440\u043e\u0441\u0432\u0435\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u0442\u0435\u043d\u044b)."})}),(0,c.jsxs)("div",{style:{marginTop:"8px"},children:[(0,c.jsx)("label",{style:{fontSize:"10px",color:"#ccc",display:"block",marginBottom:"4px"},children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsx)(FK,{value:(null===(X=ge.texture)||void 0===X?void 0:X.blend)||"overlay",onChange:e=>ae({texture:s(s({},ge.texture),{},{blend:e})}),options:[{value:"normal",label:"Normal"},{value:"multiply",label:"Multiply (\u0422\u0435\u043d\u0438)"},{value:"screen",label:"Screen (\u0421\u0432\u0435\u0442)"},{value:"overlay",label:"Overlay (\u041f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u0435)"},{value:"soft-light",label:"Soft Light"},{value:"hard-light",label:"Hard Light"}]})]})]})]}),(0,c.jsxs)(OK,{title:"\u0421\u043b\u043e\u0438 (\u042f\u0434\u0440\u043e \u0438 \u0428\u043b\u0435\u0439\u0444)",isOpen:pe.layers,onToggle:()=>fe("layers"),children:[(0,c.jsx)("div",{style:{fontSize:"10px",color:"#666",marginBottom:"8px",fontStyle:"italic"},children:"\u042d\u0442\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u043e\u043c \u041c\u043e\u043d\u043e\u0445\u0440\u043e\u043c\u0435."}),(0,c.jsxs)("div",{style:{background:"rgba(255,255,255,0.05)",padding:"8px",borderRadius:"4px"},children:[(0,c.jsx)("div",{style:{fontSize:"11px",fontWeight:"bold",marginBottom:"8px",color:"#fff"},children:"\u25cf \u042f\u0434\u0440\u043e (\u0426\u0435\u043d\u0442\u0440)"}),(0,c.jsx)(RK,{label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u044f\u0434\u0440\u0430",value:null!==(Y=ge.coreScale)&&void 0!==Y?Y:1,children:(0,c.jsx)(zK,{min:.1,max:3,step:.1,value:null!==(q=ge.coreScale)&&void 0!==q?q:1,onChange:e=>ae({coreScale:e}),accent:"#fff"})}),(0,c.jsx)(RK,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c",value:null!==(Z=ge.coreOpacity)&&void 0!==Z?Z:.5,children:(0,c.jsx)(zK,{min:0,max:1,step:.01,value:null!==($=ge.coreOpacity)&&void 0!==$?$:.5,onChange:e=>ae({coreOpacity:e}),accent:"#fff"})}),(0,c.jsx)(RK,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435",value:null!==(K=ge.coreBlur)&&void 0!==K?K:.1,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(J=ge.coreBlur)&&void 0!==J?J:.1,onChange:e=>ae({coreBlur:e}),accent:"#fff"})})]}),(0,c.jsxs)("div",{style:{background:"rgba(0,0,0,0.2)",padding:"8px",borderRadius:"4px"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,c.jsx)("span",{style:{fontSize:"11px",fontWeight:"bold",color:"#aaa"},children:"\u25cb \u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0448\u043b\u0435\u0439\u0444"}),(0,c.jsxs)("select",{value:ge.ambientBlend||"soft-light",onChange:e=>ae({ambientBlend:e.target.value}),style:{background:"transparent",border:"none",color:"#888",fontSize:"10px",textAlign:"right"},children:[(0,c.jsx)("option",{value:"normal",children:"Normal (\u041e\u0431\u044b\u0447\u043d\u044b\u0439)"}),(0,c.jsx)("option",{value:"soft-light",children:"Soft Light (\u041c\u044f\u0433\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"overlay",children:"Overlay (\u041f\u0435\u0440\u0435\u043a\u0440\u044b\u0442\u0438\u0435)"}),(0,c.jsx)("option",{value:"hard-light",children:"Hard Light (\u0416\u0451\u0441\u0442\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"screen",children:"Screen (\u042d\u043a\u0440\u0430\u043d / \u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435)"}),(0,c.jsx)("option",{value:"lighten",children:"Lighten (\u0417\u0430\u043c\u0435\u043d\u0430 \u0441\u0432\u0435\u0442\u043b\u044b\u043c)"}),(0,c.jsx)("option",{value:"color-dodge",children:"Color Dodge (\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u044b)"}),(0,c.jsx)("option",{value:"linear-dodge",children:"Linear Dodge (\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435)"}),(0,c.jsx)("option",{value:"vivid-light",children:"Vivid Light (\u042f\u0440\u043a\u0438\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"pin-light",children:"Pin Light (\u0422\u043e\u0447\u0435\u0447\u043d\u044b\u0439 \u0441\u0432\u0435\u0442)"}),(0,c.jsx)("option",{value:"luminosity",children:"Luminosity (\u0421\u0432\u0435\u0447\u0435\u043d\u0438\u0435 / \u042f\u0440\u043a\u043e\u0441\u0442\u044c)"}),(0,c.jsx)("option",{value:"plus-lighter",children:"Plus Lighter (\u0421\u0443\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0432\u0435\u0442\u0430)"})]})]}),(0,c.jsx)(RK,{label:"\u0428\u0438\u0440\u0438\u043d\u0430 \u0448\u043b\u0435\u0439\u0444\u0430",value:null!==(Q=ge.ambientScale)&&void 0!==Q?Q:1.5,children:(0,c.jsx)(zK,{min:.5,max:4,step:.1,value:null!==(ee=ge.ambientScale)&&void 0!==ee?ee:1.5,onChange:e=>ae({ambientScale:e}),accent:"#888"})}),(0,c.jsx)(RK,{label:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c",value:null!==(te=ge.ambientOpacity)&&void 0!==te?te:.3,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(ne=ge.ambientOpacity)&&void 0!==ne?ne:.3,onChange:e=>ae({ambientOpacity:e}),accent:"#888"})}),(0,c.jsx)(RK,{label:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435",value:null!==(re=ge.ambientBlur)&&void 0!==re?re:.8,children:(0,c.jsx)(zK,{min:0,max:1,step:.05,value:null!==(oe=ge.ambientBlur)&&void 0!==oe?oe:.8,onChange:e=>ae({ambientBlur:e}),accent:"#888"})})]})]}),(0,c.jsxs)("div",{style:{marginTop:"15px",paddingTop:"10px",borderTop:"1px solid #444",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,c.jsx)(PK,{label:"\u0420\u0435\u043d\u0434\u0435\u0440 \u043f\u043e\u0432\u0435\u0440\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430",checked:!1!==ge.renderOnTop,onChange:e=>ae({renderOnTop:e}),tooltip:"\u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 Z-Index 9000."}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"5px"},children:[(0,c.jsx)("button",{onClick:()=>{const e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(ge,null,2)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","flashlight_settings.json"),document.body.appendChild(t),t.click(),t.remove()},style:{flex:1,padding:"6px",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:"\ud83d\udcbe \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),(0,c.jsxs)("label",{style:{flex:1,padding:"6px",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",textAlign:"center",display:"block"},children:["\ud83d\udcc2 \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",(0,c.jsx)("input",{ref:ue,type:"file",accept:".json",style:{display:"none"},onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);"object"===typeof t?ae(t):alert("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a")}catch(t){console.error("Error loading settings:",t),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0447\u0442\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}},n.readAsText(t),e.target.value=""}})]})]})]})]}),(0,c.jsx)(UL,{isOpen:ve,onClose:()=>ye(!1),title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u0443 \u0434\u043b\u044f \u0441\u0432\u0435\u0442\u0430",assets:{sys_textures:{id:"sys_textures",name:"Textures",files:de||[]}},rootId:"sys_textures",allowedTypes:["png","jpg","jpeg","webp","svg"],assetsMap:ce,onSelect:e=>{ae({texture:s(s({},ge.texture),{},{url:e.local_path||e.file_id})}),ye(!1)}})]})},LK=[{value:"none",label:"\u041d\u0435\u0442"},{value:"candle",label:"\ud83d\udd6f\ufe0f \u0421\u0432\u0435\u0447\u0430 (\u0420\u0435\u0430\u043b\u0438\u0441\u0442\u0438\u0447\u043d\u0430\u044f)"},{value:"broken_lamp",label:"\u26a1 \u0421\u043b\u043e\u043c\u0430\u043d\u043d\u0430\u044f \u043b\u0430\u043c\u043f\u0430 (\u0421\u044e\u0436\u0435\u0442)"},{value:"pulse",label:"\ud83c\udf0a \u041f\u043b\u0430\u0432\u043d\u0430\u044f \u043f\u0443\u043b\u044c\u0441\u0430\u0446\u0438\u044f"},{value:"strobe",label:"\ud83d\udea8 \u0421\u0442\u0440\u043e\u0431\u043e\u0441\u043a\u043e\u043f"},{value:"tv",label:"\ud83d\udcfa \u0422\u0412 / \u041c\u043e\u043d\u0438\u0442\u043e\u0440"},{value:"thunder",label:"\u26c8\ufe0f \u0413\u0440\u043e\u0437\u0430 / \u041c\u043e\u043b\u043d\u0438\u044f"},{value:"beacon",label:"\ud83d\udea8 \u0410\u0432\u0430\u0440\u0438\u0439\u043d\u044b\u0439 \u043c\u0430\u044f\u043a (Double Flash)"}],NK=[{value:"none",label:"\u041d\u0435\u0442"},{value:"circular",label:"\ud83d\udd04 \u041f\u043e \u043a\u0440\u0443\u0433\u0443"},{value:"shake_horizontal",label:"\u2194\ufe0f \u0422\u0440\u044f\u0441\u043a\u0430 (\u0413\u043e\u0440\u0438\u0437.)"},{value:"shake_vertical",label:"\u2195\ufe0f \u0422\u0440\u044f\u0441\u043a\u0430 (\u0412\u0435\u0440\u0442.)"},{value:"chaotic",label:"\ud83c\udfb2 \u0425\u0430\u043e\u0442\u0438\u0447\u043d\u043e"},{value:"figure_eight",label:"\u267e\ufe0f \u0412\u043e\u0441\u044c\u043c\u0435\u0440\u043a\u0430"}],UK=[{label:"\u0411\u0430\u0437\u043e\u0432\u044b\u0435",options:[{value:"normal",label:"Normal"}]},{label:"\u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u0435 (Darken)",options:[{value:"darken",label:"Darken"},{value:"multiply",label:"Multiply"},{value:"color-burn",label:"Color Burn"}]},{label:"\u041e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u0435 (Lighten)",options:[{value:"lighten",label:"Lighten"},{value:"screen",label:"Screen"},{value:"color-dodge",label:"Color Dodge"},{value:"plus-lighter",label:"Add / Lighter"}]},{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0441\u0442 (Contrast)",options:[{value:"overlay",label:"Overlay"},{value:"soft-light",label:"Soft Light"},{value:"hard-light",label:"Hard Light"}]},{label:"\u0420\u0430\u0437\u043d\u0438\u0446\u0430 (Inversion)",options:[{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}]},{label:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b",options:[{value:"hue",label:"Hue"},{value:"saturation",label:"Saturation"},{value:"color",label:"Color"},{value:"luminosity",label:"Luminosity"}]}],VK=e=>{let{value:t,onChange:n,style:r}=e;return(0,c.jsx)("select",{value:t||"screen",onChange:e=>n(e.target.value),style:s({width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"11px"},r),children:UK.map(e=>(0,c.jsx)("optgroup",{label:e.label,style:{color:"#aaa"},children:e.options.map(e=>(0,c.jsx)("option",{value:e.value,style:{color:"#fff"},children:e.label},e.value))},e.label))})},WK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z;let{settings:F,onUpdate:P,isExpanded:B,onToggle:L,onSelectElement:N,selectedId:U,textEvents:V,lightAnimationData:W,onUpdateLightAnimation:H,lightAnimTime:G,setLightAnimTime:X,sceneLayers:Y=[]}=t;const[q,Z]=(0,e.useState)("settings"),[$,K]=(0,e.useState)(0),[J,Q]=(0,e.useState)(!1),ee=(0,e.useMemo)(()=>W&&W.activeGroupId&&W.groups.find(e=>e.id===W.activeGroupId)||null,[W]),te=ee&&ee.enabled,[ne,re]=(0,e.useState)(!1),[oe,ie]=(0,e.useState)("all"),[ae,se]=(0,e.useState)(!1),[le,ce]=(0,e.useState)(!1),[de,ue]=(0,e.useState)("all"),pe=(e,t,n)=>te&&ee?ZB(e,t,n||"#000000",ee,G):n||"#000000",he=(e,t,n)=>{if(te&&ee&&ee.elements&&ee.elements[e]){const n=BB(ee.elements[e],t,G);if(null!==n&&void 0!==n)return n}return n},fe=s({enabled:!1,globalBlendMode:"screen",ambientColor:"#000000",ambientDensity:.2,sources:[],obstacles:[]},F||{});(0,e.useEffect)(()=>{B||void 0===fe._previewTime||P(s(s({},fe),{},{_previewTime:void 0}))},[B,fe]);const ge=(e,t,n,r,o)=>{if(J)console.warn("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u043e \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f");else if(o(n),te&&ee){console.group("\ud83c\udfa8 Update Color Anim: ".concat(e," / ").concat(t)),console.log("Time:",G),console.log("Prev Value (\u0434\u043b\u044f \u043a\u043b\u044e\u0447\u0430 0s):",r),console.log("New Value (\u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430):",n);let o=s({},ee);o=NB(o,e,t,void 0!==r?r:n),o=LB(o,e,t,G,n);const i=o.elements[e],a=i?i[t]:[];console.log("Resulting Keyframes:",JSON.parse(JSON.stringify(a))),console.groupEnd();const l=W.groups.map(e=>e.id===ee.id?o:e);H(s(s({},W),{},{groups:l}))}},me=(e,t)=>{"ambientDensity"===e||"ambientColor"===e?ge("sl_ambient",e,t,fe[e],t=>P(s(s({},fe),{},{[e]:t}))):P(s(s({},fe),{},{[e]:t}))},ve=(e,t,n)=>{const r=(fe[e]||[]).find(e=>e.id===t);Object.keys(n).forEach(o=>{const i=n[o],a=r?r[o]:void 0,l=n=>{const r=(fe[e]||[]).map(e=>e.id===t?s(s({},e),{},{[o]:n}):e);P(s(s({},fe),{},{[e]:r}))};["coreRadius","coreOpacity","haloOpacity","haloSoftness","coreBanding","coreColor","haloColor","rotate","spotLength","spotWidth","spotShift","spotFade","spotBlur","spotPenumbra","spotSamples","coreLength","coreWidth","coreBlur","coreVOffset","coreRotate","density","shadowDensity","shadowBlur","shadowLength","shadowPenumbra","holeCount","holeBias","godRayLength","holeOpacity","godRayBlur"].includes(o)?ge(t,o,i,a,l):l(i)})},ye=(e,t)=>{P({[e]:fe[e].filter(e=>e.id!==t)})},xe=(e,t,n)=>{e.stopPropagation();const r=fe[t]||[],o=r.find(e=>e.id===n);if(!o)return;const i=s(s({},o),{},{id:"".concat("sources"===t?"src":"obs","_copy_").concat(Date.now()),x:(o.x||0)+20,y:(o.y||0)+20});P(s(s({},fe),{},{[t]:[...r,i]})),N&&N(i.id)},be=((0,e.useMemo)(()=>[{id:"sl_ambient",name:"Global Ambient (TBD)",type:"ambient"},...(fe.sources||[]).map((e,t)=>({id:e.id,name:"Light ".concat(t+1),type:"light_virtual"})),...(fe.obstacles||[]).map((e,t)=>({id:e.id,name:"Obstacle ".concat(t+1),type:"obstacle_virtual"}))],[fe.sources,fe.obstacles]),e=>{const t=W.groups.map(t=>t.id===e.id?e:t);H(s(s({},W),{},{groups:t}))}),we={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},tabBar:{display:"flex",gap:"4px",marginBottom:"10px",background:"#222",padding:"4px",borderRadius:"6px"},tab:e=>({flex:1,textAlign:"center",padding:"6px",fontSize:"12px",cursor:"pointer",borderRadius:"4px",background:e?"#444":"transparent",color:e?"#fff":"#888",fontWeight:e?"600":"400",transition:"0.2s"}),subHeader:{background:"#333",padding:"6px 10px",borderRadius:"4px",marginTop:"8px",marginBottom:"8px",fontSize:"11px",fontWeight:"600",color:"#ddd",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #3f3f3f",userSelect:"none"},groupLabel:{fontSize:"10px",color:"#888",textTransform:"uppercase",marginBottom:"6px",fontWeight:"bold",letterSpacing:"0.5px"},row:{display:"flex",flexDirection:"column",gap:"4px",marginBottom:"10px"},rowInline:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#ffeb3b",height:"6px"},valueLabel:{fontSize:"10px",color:"#ffeb3b",width:"30px",textAlign:"right",fontFamily:"monospace"},itemRow:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",background:"#222",borderRadius:"4px",marginBottom:"2px",border:"1px solid #333",cursor:"pointer",transition:"0.2s"},itemRowActive:{background:"#2f2f2f",border:"1px solid #ffeb3b"},nestedPanel:{padding:"8px",background:"#1e1e1e",borderRadius:"0 0 4px 4px",borderLeft:"1px solid #444",borderRight:"1px solid #444",borderBottom:"1px solid #444",marginBottom:"6px",marginTop:"-4px"},sectionBox:{borderLeft:"3px solid #555",padding:"0 0 0 10px",margin:"10px 0"}},[Se,ke]=(0,e.useState)(!0),[Ce,je]=(0,e.useState)(!1),[_e,Ee]=(0,e.useState)(!0),[De,Me]=(0,e.useState)(!0),[Te,Ie]=(0,e.useState)(!1),Ae="#607d8b",Oe="#ffca28",Re="#ff7043",ze="#26c6da",Fe="#ab47bc",Pe="#26a69a",Be="#5c6bc0",Le="#ef5350",Ne=s(s({},we),{},{sectionHeader:(e,t)=>({background:t?"".concat(e,"1a"):"#333",borderLeft:"3px solid ".concat(e),borderTop:"1px solid #444",borderRight:"1px solid #444",borderBottom:t?"none":"1px solid #444",padding:"8px 10px",borderRadius:t?"4px 4px 0 0":"4px",marginTop:"8px",fontSize:"12px",fontWeight:"600",color:t?e:"#eee",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",userSelect:"none",transition:"all 0.2s ease"}),sectionBody:e=>({padding:"10px",background:"".concat(e,"08"),borderLeft:"3px solid ".concat(e),borderRight:"1px solid #444",borderBottom:"1px solid #444",borderRadius:"0 0 4px 4px",marginBottom:"4px",marginLeft:"0"}),subGroup:{background:"rgba(0,0,0,0.3)",padding:"8px",borderRadius:"4px",marginBottom:"8px",border:"1px solid #3a3a3a"},subGroupHeader:{fontSize:"10px",fontWeight:"bold",color:"#aaa",textTransform:"uppercase",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",letterSpacing:"0.5px"},ctrlRow:{marginBottom:"8px"},labelRow:{display:"flex",justifyContent:"space-between",marginBottom:"3px"},label:{fontSize:"11px",color:"#ccc"},val:{fontSize:"10px",color:"#fff",fontFamily:"monospace",background:"#000",padding:"1px 4px",borderRadius:"3px"},rangeInput:{width:"100%",cursor:"pointer",height:"4px",borderRadius:"2px"},actionBtn:{background:"#444",border:"none",color:"#fff",borderRadius:"3px",cursor:"pointer",fontSize:"10px",padding:"3px 8px",transition:"0.2s",fontWeight:"bold"},perfIcon:{cursor:"help",fontSize:"10px",marginLeft:"4px"}}),Ue=e=>{let{isOpen:t}=e;return(0,c.jsx)("span",{style:{transform:t?"rotate(90deg)":"rotate(0deg)",display:"inline-block",transition:"0.2s",fontSize:"10px",color:"#888"},children:"\u25b6"})},[Ve,We]=(0,e.useState)({}),[He,Ge]=(0,e.useState)(!1),Xe=(e,t)=>{U===t?((e,t)=>{e.stopPropagation(),We(e=>s(s({},e),{},{[t]:!e[t]}))})(e,t):N&&N(t)},Ye=e=>({display:"inline-block",marginRight:"6px",fontSize:"10px",color:"#888",transform:e?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s",cursor:"pointer",padding:"2px"}),qe=(e,t)=>{const n=(fe.sources||[]).map(n=>{if("all"===oe||n.id===oe){const r=n[e]||{type:"none",speed:1,strength:10};return s(s({},n),{},{[e]:s(s({},r),t)})}return n});P(s(s({},fe),{},{sources:n}))},Ze=e=>{if(!fe.sources||0===fe.sources.length)return{type:"none",speed:1,strength:10};const t="all"===oe?fe.sources[0]:fe.sources.find(e=>e.id===oe);return(null===t||void 0===t?void 0:t[e])||{type:"none",speed:1,strength:10}},$e=Ze("presetLight"),Ke=Ze("presetMotion");(0,e.useEffect)(()=>{U&&(X(0),void 0!==fe._previewTime&&P(s(s({},fe),{},{_previewTime:void 0})))},[U]);const Je=()=>{if(!fe.sources||0===fe.sources.length)return 0;const e="all"===de?fe.sources[0]:fe.sources.find(e=>e.id===de);return(null===e||void 0===e?void 0:e.parallaxStrength)||0},Qe=()=>(0,c.jsx)("span",{title:"\u26a0\ufe0f \u0412\u044b\u0441\u043e\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043d\u0430 GPU/CPU \u043f\u0440\u0438 \u0432\u044b\u0441\u043e\u043a\u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u0445",children:(0,c.jsx)(PE,{text:"\u0412\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",icon:"\u26a0\ufe0f",color:"#ff9800"})}),et=function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,c.jsxs)("div",{style:Ne.sectionHeader(r,t),onClick:()=>n(!t),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)(Ue,{isOpen:t}),(0,c.jsx)("span",{children:e})]}),o&&(0,c.jsx)("div",{onClick:e=>e.stopPropagation(),children:o})]})};return(0,c.jsxs)("div",{style:Ne.panel,children:[(0,c.jsxs)("div",{style:Ne.header,onClick:L,children:[(0,c.jsx)("input",{type:"checkbox",checked:!!fe.enabled,onClick:e=>e.stopPropagation(),onChange:e=>P(s(s({},fe),{},{enabled:e.target.checked})),style:{cursor:"pointer",accentColor:Oe}}),(0,c.jsx)("span",{style:{flex:1},children:"Atmos / Lighting \ud83d\udca1"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:Oe,background:"".concat(Oe,"1a"),padding:"2px 6px",borderRadius:"4px"},children:fe.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:B?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),B&&fe.enabled&&(0,c.jsxs)("div",{style:{padding:"0 2px"},children:[et("\ud83c\udf0d \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u0430\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0430",Se,ke,Ae,(0,c.jsxs)("label",{style:{fontSize:"9px",color:"#aaa",display:"flex",gap:"4px",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:fe.hideUI,onChange:e=>me("hideUI",e.target.checked)})," Hide UI"]})),Se&&(0,c.jsxs)("div",{style:Ne.sectionBody(Ae),children:[(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83c\udfa8 \u0411\u0430\u0437\u0430"}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"})}),(0,c.jsx)(VK,{value:fe.globalBlendMode,onChange:e=>me("globalBlendMode",e)})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"\u0426\u0432\u0435\u0442 \u0442\u044c\u043c\u044b"})}),(0,c.jsx)("div",{style:{height:"20px"},children:(0,c.jsx)(T$,{color:pe("sl_ambient","ambientColor",fe.ambientColor),onChange:e=>me("ambientColor",e),disabled:J})})]}),(0,c.jsxs)("div",{style:{flex:2},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:Ne.val,children:he("sl_ambient","ambientDensity",fe.ambientDensity).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:Ne.rangeInput,value:he("sl_ambient","ambientDensity",fe.ambientDensity),onChange:e=>me("ambientDensity",parseFloat(e.target.value)),disabled:J})]})]})]}),(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\u2699\ufe0f \u0420\u0435\u043d\u0434\u0435\u0440\u0438\u043d\u0433"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),(0,c.jsx)("span",{style:Ne.val,children:null!==(n=fe.quality)&&void 0!==n?n:1})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"1",step:"0.1",style:Ne.rangeInput,value:null!==(r=fe.quality)&&void 0!==r?r:1,onChange:e=>me("quality",parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsxs)("span",{style:Ne.label,children:["Scale ",(0,c.jsx)(Qe,{})]}),(0,c.jsx)("span",{style:Ne.val,children:null!==(o=fe.resolutionScale)&&void 0!==o?o:1})]}),(0,c.jsx)("input",{type:"range",min:"0.125",max:"1",step:"0.125",style:Ne.rangeInput,value:null!==(i=fe.resolutionScale)&&void 0!==i?i:1,onChange:e=>me("resolutionScale",parseFloat(e.target.value))})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginTop:"8px"}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"Z-Index \u0441\u043b\u043e\u044f"}),(0,c.jsx)("span",{style:Ne.val,children:fe.zIndex||100})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1000",step:"10",style:Ne.rangeInput,value:fe.zIndex||100,onChange:e=>me("zIndex",parseInt(e.target.value))})]})]}),(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsxs)("div",{style:Ne.subGroupHeader,children:[(0,c.jsx)("input",{type:"checkbox",checked:fe.pixelMode||!1,onChange:e=>me("pixelMode",e.target.checked),style:{marginRight:"6px"}}),"\ud83d\udc7e Pixel Art"]}),fe.pixelMode&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043f\u0438\u043a\u0441\u0435\u043b\u044f"}),(0,c.jsxs)("span",{style:Ne.val,children:[fe.pixelSize||4,"px"]})]}),(0,c.jsx)("input",{type:"range",min:"1",max:"16",step:"1",style:Ne.rangeInput,value:fe.pixelSize||4,onChange:e=>me("pixelSize",parseInt(e.target.value))})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"Band / Dither"})}),(0,c.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"16",step:"1",title:"Banding",style:s(s({},Ne.rangeInput),{},{flex:1}),value:fe.pixelBanding||0,onChange:e=>me("pixelBanding",parseInt(e.target.value))}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",title:"Dithering",style:s(s({},Ne.rangeInput),{},{flex:1}),value:fe.pixelDithering||0,onChange:e=>me("pixelDithering",parseFloat(e.target.value))})]})]})]})]})]}),et("\ud83d\udca1 \u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438 \u0441\u0432\u0435\u0442\u0430 (".concat(fe.sources.length,")"),_e,Ee,Oe,(0,c.jsx)("button",{onClick:e=>{e.stopPropagation();const t="src_".concat(Date.now());P({sources:[...fe.sources||[],{id:t,x:400,y:300,radius:300,w:600,h:600,coreRadius:100,coreColor:"#ffffff",coreOpacity:1,coreSoftness:.1,haloColor:"#ffffff",haloOpacity:1,haloSoftness:.4,coreBanding:0}]}),N&&N(t)},style:Ne.actionBtn,children:"+ Add"})),_e&&(0,c.jsx)("div",{style:Ne.sectionBody(Oe),children:fe.sources.map((e,t)=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P;return(0,c.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,c.jsxs)("div",{style:s(s({},we.itemRow),e.id===U?we.itemRowActive:{}),onClick:t=>Xe(t,e.id),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:Ye(Ve[e.id]),children:"\u25b6"}),(0,c.jsxs)("span",{style:{fontSize:"11px",fontWeight:e.id===U?"bold":"normal",color:e.id===U?Oe:"#ccc"},children:[t+1,". ","spot"===e.type?"\ud83d\udd26 Spot":"\ud83d\udca1 Omni"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{style:{background:"transparent",border:"none",color:"#888",cursor:"pointer",fontSize:"12px",marginRight:"4px"},onClick:t=>xe(t,"sources",e.id),title:"\u0414\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c",children:"\u2750"}),(0,c.jsx)("button",{style:{background:"transparent",border:"none",color:"#f44",cursor:"pointer",fontSize:"14px"},onClick:t=>{t.stopPropagation(),ye("sources",e.id)},title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:"\xd7"})]})]}),Ve[e.id]&&(0,c.jsxs)("div",{style:s(s({},we.nestedPanel),{},{borderLeft:"2px solid ".concat(Oe)}),children:[(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\u2699\ufe0f \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"6px"},children:[(0,c.jsxs)("select",{value:e.type||"point",onChange:t=>ve("sources",e.id,{type:t.target.value}),style:{flex:1,padding:"2px",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"3px",fontSize:"10px"},children:[(0,c.jsx)("option",{value:"point",children:"Radial (Omni)"}),(0,c.jsx)("option",{value:"spot",children:"Spotlight (Beam)"})]}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(VK,{value:e.blendMode,onChange:t=>ve("sources",e.id,{blendMode:t})})})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043e\u0432\u043e\u0440\u043e\u0442"}),(0,c.jsxs)("span",{style:Ne.val,children:[Math.round(he(e.id,"rotate",e.rotate||0)),"\xb0"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"360",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"rotate",e.rotate||0),onChange:t=>ve("sources",e.id,{rotate:parseFloat(t.target.value)}),disabled:J})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{borderTop:"1px dashed #444",paddingTop:"6px",marginTop:"6px"}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u2744\ufe0f \u041f\u043e\u0434\u0441\u0432\u0435\u0442\u043a\u0430 \u0447\u0430\u0441\u0442\u0438\u0446"}),(0,c.jsxs)("span",{style:Ne.val,children:[null!==(n=e.particleInfluence)&&void 0!==n?n:1,"x"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"5",step:"0.1",style:Ne.rangeInput,value:void 0!==e.particleInfluence?e.particleInfluence:1,onChange:t=>ve("sources",e.id,{particleInfluence:parseFloat(t.target.value)})})]}),"spot"===e.type&&(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"2px solid ".concat(Oe),background:"rgba(255, 202, 40, 0.05)"}),children:[(0,c.jsx)("div",{style:s(s({},Ne.subGroupHeader),{},{color:Oe}),children:"\ud83d\udd26 \u041b\u0443\u0447 (Beam)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0414\u043b\u0438\u043d\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"spotLength",null!==(r=e.spotLength)&&void 0!==r?r:400))})]}),(0,c.jsx)("input",{type:"range",min:"50",max:"2000",step:"10",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotLength",null!==(o=e.spotLength)&&void 0!==o?o:400),onChange:t=>ve("sources",e.id,{spotLength:parseFloat(t.target.value)}),disabled:J})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0428\u0438\u0440\u0438\u043d\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"spotWidth",null!==(i=e.spotWidth)&&void 0!==i?i:1.5).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"50",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotWidth",null!==(a=e.spotWidth)&&void 0!==a?a:1.5),onChange:t=>ve("sources",e.id,{spotWidth:parseFloat(t.target.value)}),disabled:J})]})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 (Shift)"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"spotShift",null!==(l=e.spotShift)&&void 0!==l?l:0))})]}),(0,c.jsx)("input",{type:"range",min:"-500",max:"500",step:"10",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotShift",null!==(d=e.spotShift)&&void 0!==d?d:0),onChange:t=>ve("sources",e.id,{spotShift:parseFloat(t.target.value)}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{borderTop:"1px dashed #444",paddingTop:"6px",marginTop:"6px"}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0417\u0430\u0442\u0443\u0445\u0430\u043d\u0438\u0435 (Falloff)"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"spotFade",null!==(u=e.spotFade)&&void 0!==u?u:1).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotFade",null!==(p=e.spotFade)&&void 0!==p?p:1),onChange:t=>ve("sources",e.id,{spotFade:parseFloat(t.target.value)}),disabled:J})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u0435\u043d\u0443\u043c\u0431\u0440\u0430 (\u041a\u0440\u0430\u044f)"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"spotPenumbra",null!==(h=e.spotPenumbra)&&void 0!==h?h:0).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotPenumbra",null!==(f=e.spotPenumbra)&&void 0!==f?f:0),onChange:t=>ve("sources",e.id,{spotPenumbra:parseFloat(t.target.value)}),disabled:J})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"Blur (\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435)"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"spotBlur",null!==(g=e.spotBlur)&&void 0!==g?g:0).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"0.5",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotBlur",null!==(m=e.spotBlur)&&void 0!==m?m:0),onChange:t=>ve("sources",e.id,{spotBlur:parseFloat(t.target.value)}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsxs)("span",{style:Ne.label,children:["\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e (Samples) ",(0,c.jsx)(Qe,{})]}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"spotSamples",null!==(v=e.spotSamples)&&void 0!==v?v:8))})]}),(0,c.jsx)("input",{type:"range",min:"4",max:"32",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Oe}),value:he(e.id,"spotSamples",null!==(y=e.spotSamples)&&void 0!==y?y:8),onChange:t=>ve("sources",e.id,{spotSamples:parseInt(t.target.value)}),disabled:J})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"3px solid #4caf50"}),children:[(0,c.jsx)("div",{style:s(s({},Ne.subGroupHeader),{},{color:"#81c784"}),children:"\ud83d\udfe2 Core (\u0411\u043b\u0438\u043a/\u0417\u0432\u0435\u0437\u0434\u0430)"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0426\u0432\u0435\u0442 \u0431\u043b\u0438\u043a\u0430"}),(0,c.jsx)("div",{style:{width:"50px",height:"20px"},children:(0,c.jsx)(T$,{color:pe(e.id,"coreColor",e.coreColor),onChange:t=>ve("sources",e.id,{coreColor:t}),disabled:J})})]}),"spot"===e.type?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0414\u043b\u0438\u043d\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"coreLength",null!==(x=e.coreLength)&&void 0!==x?x:100))})]}),(0,c.jsx)("input",{type:"range",min:"10",max:"600",step:"5",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreLength",null!==(b=e.coreLength)&&void 0!==b?b:100),onChange:t=>ve("sources",e.id,{coreLength:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0428\u0438\u0440\u0438\u043d\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"coreWidth",null!==(w=e.coreWidth)&&void 0!==w?w:15))})]}),(0,c.jsx)("input",{type:"range",min:"1",max:"100",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreWidth",null!==(S=e.coreWidth)&&void 0!==S?S:15),onChange:t=>ve("sources",e.id,{coreWidth:+t.target.value}),disabled:J})]})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"coreBlur",null!==(k=e.coreBlur)&&void 0!==k?k:0).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreBlur",null!==(C=e.coreBlur)&&void 0!==C?C:0),onChange:t=>ve("sources",e.id,{coreBlur:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u0434\u0432\u0438\u0433 Y"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"coreVOffset",null!==(j=e.coreVOffset)&&void 0!==j?j:0))})]}),(0,c.jsx)("input",{type:"range",min:"-100",max:"100",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreVOffset",null!==(_=e.coreVOffset)&&void 0!==_?_:0),onChange:t=>ve("sources",e.id,{coreVOffset:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043e\u0432\u043e\u0440\u043e\u0442"}),(0,c.jsxs)("span",{style:Ne.val,children:[Math.round(he(e.id,"coreRotate",null!==(E=e.coreRotate)&&void 0!==E?E:0)),"\xb0"]})]}),(0,c.jsx)("input",{type:"range",min:"-90",max:"90",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreRotate",null!==(D=e.coreRotate)&&void 0!==D?D:0),onChange:t=>ve("sources",e.id,{coreRotate:+t.target.value}),disabled:J})]})]})]}):(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0430\u0434\u0438\u0443\u0441"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"coreRadius",null!==(M=e.coreRadius)&&void 0!==M?M:50))})]}),(0,c.jsx)("input",{type:"range",min:"1",max:(e.w||2*e.radius)/2,step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreRadius",null!==(T=e.coreRadius)&&void 0!==T?T:50),onChange:t=>ve("sources",e.id,{coreRadius:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginTop:"8px"}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"coreOpacity",null!==(I=e.coreOpacity)&&void 0!==I?I:1).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreOpacity",null!==(A=e.coreOpacity)&&void 0!==A?A:1),onChange:t=>ve("sources",e.id,{coreOpacity:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"Banding (\u041f\u043e\u043b\u043e\u0441\u044b)"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"coreBanding",null!==(O=e.coreBanding)&&void 0!==O?O:0))})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#4caf50"}),value:he(e.id,"coreBanding",null!==(R=e.coreBanding)&&void 0!==R?R:0),onChange:t=>ve("sources",e.id,{coreBanding:+t.target.value}),disabled:J})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"3px solid #2196f3"}),children:[(0,c.jsx)("div",{style:s(s({},Ne.subGroupHeader),{},{color:"#64b5f6"}),children:"\ud83d\udd35 Halo (\u0421\u0432\u0435\u0447\u0435\u043d\u0438\u0435)"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0426\u0432\u0435\u0442 \u043e\u0440\u0435\u043e\u043b\u0430"}),(0,c.jsx)("div",{style:{width:"50px",height:"20px"},children:(0,c.jsx)(T$,{color:pe(e.id,"haloColor",e.haloColor),onChange:t=>ve("sources",e.id,{haloColor:t}),disabled:J})})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0418\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"haloOpacity",null!==(z=e.haloOpacity)&&void 0!==z?z:.5).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:"#2196f3"}),value:he(e.id,"haloOpacity",null!==(F=e.haloOpacity)&&void 0!==F?F:.5),onChange:t=>ve("sources",e.id,{haloOpacity:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041c\u044f\u0433\u043a\u043e\u0441\u0442\u044c"}),(0,c.jsx)("span",{style:Ne.val,children:e.haloSoftness})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#2196f3"}),value:null!==(P=e.haloSoftness)&&void 0!==P?P:.6,onChange:t=>ve("sources",e.id,{haloSoftness:+t.target.value}),disabled:J})]})]})]})]},e.id)})}),et("\ud83e\uddf1 \u041f\u0440\u0435\u043f\u044f\u0442\u0441\u0442\u0432\u0438\u044f (".concat(fe.obstacles.length,")"),De,Me,Re,(0,c.jsx)("button",{onClick:e=>{e.stopPropagation();const t="obs_".concat(Date.now());P({obstacles:[...fe.obstacles||[],{id:t,x:500,y:300,w:100,h:100,rotate:0,castShadow:!0,density:1,shadowBlur:1,shadowLength:1e3,type:"rect",godRayBlur:0,holeOpacity:.5,godRayBlendMode:"lighter"}]}),N&&N(t)},style:Ne.actionBtn,children:"+ Add"})),De&&(0,c.jsx)("div",{style:Ne.sectionBody(Re),children:fe.obstacles.map((e,t)=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y;return(0,c.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,c.jsxs)("div",{style:s(s({},we.itemRow),e.id===U?we.itemRowActive:{}),onClick:t=>Xe(t,e.id),children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:Ye(Ve[e.id]),children:"\u25b6"}),(0,c.jsx)("input",{type:"checkbox",checked:e.castShadow,onClick:e=>e.stopPropagation(),onChange:t=>ve("obstacles",e.id,{castShadow:t.target.checked}),style:{marginRight:"6px",cursor:"pointer",accentColor:Re}}),(0,c.jsxs)("span",{style:{fontSize:"11px",color:e.id===U?Re:"#ccc"},children:[t+1,". ","circle"===e.type?"Circle":"Rect"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{style:{background:"transparent",border:"none",color:"#888",cursor:"pointer",fontSize:"12px",marginRight:"4px"},onClick:t=>xe(t,"obstacles",e.id),title:"\u0414\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c",children:"\u2750"}),(0,c.jsx)("button",{style:{background:"transparent",border:"none",color:"#f44",cursor:"pointer",fontSize:"14px"},onClick:t=>{t.stopPropagation(),ye("obstacles",e.id)},title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",children:"\xd7"})]})]}),Ve[e.id]&&e.castShadow&&(0,c.jsxs)("div",{style:s(s({},we.nestedPanel),{},{borderLeft:"2px solid ".concat(Re)}),children:[(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83d\udcd0 \u0413\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u044f"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"6px"},children:[(0,c.jsxs)("select",{value:e.type||"rect",onChange:t=>ve("obstacles",e.id,{type:t.target.value}),style:{flex:1,background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"3px",fontSize:"10px",padding:"2px"},children:[(0,c.jsx)("option",{value:"rect",children:"Rect"}),(0,c.jsx)("option",{value:"circle",children:"Circle"})]}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("input",{type:"range",min:"0",max:"360",style:s(s({},Ne.rangeInput),{},{accentColor:Re}),value:he(e.id,"rotate",e.rotate||0),onChange:t=>ve("obstacles",e.id,{rotate:+t.target.value}),disabled:J,title:"Rotate"})})]}),(0,c.jsx)("div",{style:s(s({},Ne.ctrlRow),{},{background:"rgba(0,0,0,0.2)",padding:"4px",borderRadius:"4px",marginBottom:0}),children:(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",width:"100%"},children:[(0,c.jsx)("span",{style:s(s({},Ne.label),{},{color:e.hideBody?Re:"#ccc"}),children:"\ud83d\udc7b \u0421\u043a\u0440\u044b\u0442\u044c \u0442\u0435\u043b\u043e (Shadow Only)"}),(0,c.jsx)("input",{type:"checkbox",checked:e.hideBody||!1,onChange:t=>ve("obstacles",e.id,{hideBody:t.target.checked}),style:{cursor:"pointer",accentColor:Re}})]})}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginTop:"6px"}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0442\u0435\u043b\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"density",void 0!==e.density?e.density:1).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:Re,opacity:e.hideBody?.3:1}),value:he(e.id,"density",void 0!==e.density?e.density:1),onChange:t=>ve("obstacles",e.id,{density:+t.target.value}),disabled:J||e.hideBody})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"3px solid #757575"}),children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83c\udf11 \u0422\u0435\u043d\u044c (Shadow)"}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c \u0442\u0435\u043d\u0438"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"shadowDensity",null!==(n=e.shadowDensity)&&void 0!==n?n:1).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:Re}),value:he(e.id,"shadowDensity",void 0!==e.shadowDensity?e.shadowDensity:1),onChange:t=>ve("obstacles",e.id,{shadowDensity:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"shadowBlur",null!==(r=e.shadowBlur)&&void 0!==r?r:1))})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Re}),value:he(e.id,"shadowBlur",null!==(o=e.shadowBlur)&&void 0!==o?o:1),onChange:t=>ve("obstacles",e.id,{shadowBlur:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u0435\u043d\u0443\u043c\u0431\u0440\u0430 (\u041a\u0440\u0430\u044f)"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"shadowPenumbra",null!==(i=e.shadowPenumbra)&&void 0!==i?i:0).toFixed(2)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Re}),value:he(e.id,"shadowPenumbra",null!==(a=e.shadowPenumbra)&&void 0!==a?a:0),onChange:t=>ve("obstacles",e.id,{shadowPenumbra:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsxs)("span",{style:Ne.label,children:["\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e (Samples) ",(0,c.jsx)(Qe,{})]}),(0,c.jsx)("span",{style:Ne.val,children:null!==(l=e.shadowSamples)&&void 0!==l?l:8})]}),(0,c.jsx)("input",{type:"range",min:"4",max:"32",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Re}),value:null!==(d=e.shadowSamples)&&void 0!==d?d:8,onChange:t=>ve("obstacles",e.id,{shadowSamples:+t.target.value}),disabled:J})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"3px solid #ff9800"}),children:[(0,c.jsx)("div",{style:s(s({},Ne.subGroupHeader),{},{color:"#ffcc80"}),children:"\ud83d\udd38 \u041f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u044c (Static)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"6px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("span",{style:Ne.label,children:"Roughness"}),(0,c.jsx)("input",{type:"range",min:"0",max:"20",step:"0.5",style:s(s({},Ne.rangeInput),{},{accentColor:"#ff9800"}),value:null!==(u=e.roughness)&&void 0!==u?u:0,onChange:t=>ve("obstacles",e.id,{roughness:+t.target.value})})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("span",{style:Ne.label,children:"Roundness"}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#ff9800"}),value:null!==(p=e.roughnessRoundness)&&void 0!==p?p:0,onChange:t=>ve("obstacles",e.id,{roughnessRoundness:+t.target.value})})]})]}),(0,c.jsxs)("div",{style:{marginBottom:0},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"Bias (\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435)"}),(0,c.jsx)("span",{style:Ne.val,children:null!==(h=e.roughnessBias)&&void 0!==h?h:.5})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#ff9800"}),value:null!==(f=e.roughnessBias)&&void 0!==f?f:.5,onChange:t=>ve("obstacles",e.id,{roughnessBias:+t.target.value})})]})]}),(0,c.jsxs)("div",{style:s(s({},Ne.subGroup),{},{borderLeft:"3px solid #8bc34a",background:"rgba(139, 195, 74, 0.05)"}),children:[(0,c.jsxs)("div",{style:s(s({},Ne.subGroupHeader),{},{color:"#aed581"}),children:["\ud83c\udf3f \u041b\u0443\u0447\u0438 (God Rays) ",(0,c.jsx)(Qe,{})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041a\u043e\u043b-\u0432\u043e \u043e\u0442\u0432\u0435\u0440\u0441\u0442\u0438\u0439"}),(0,c.jsx)("span",{style:Ne.val,children:Math.round(he(e.id,"holeCount",e.holeCount||0))})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:he(e.id,"holeCount",e.holeCount||0),onChange:t=>ve("obstacles",e.id,{holeCount:+t.target.value}),disabled:J})]}),e.holeCount>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginTop:"6px",padding:"4px",border:"1px dashed #8bc34a",borderRadius:"4px",marginBottom:"6px"},children:[(0,c.jsx)("div",{style:{fontSize:"9px",color:"#aed581",marginBottom:"4px",fontWeight:"bold"},children:"\u26a1 \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f"}),(0,c.jsxs)("select",{value:e.godRayAnimType||"none",onChange:t=>ve("obstacles",e.id,{godRayAnimType:t.target.value}),style:{width:"100%",padding:"2px",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"3px",fontSize:"10px",marginBottom:"4px"},children:[(0,c.jsx)("option",{value:"none",children:"\u041d\u0435\u0442 (\u0421\u0442\u0430\u0442\u0438\u043a\u0430)"}),(0,c.jsx)("option",{value:"shimmer",children:"\u2728 \u041c\u0435\u0440\u0446\u0430\u043d\u0438\u0435"}),(0,c.jsx)("option",{value:"leaves",children:"\ud83c\udf43 \u041b\u0438\u0441\u0442\u0432\u0430"}),(0,c.jsx)("option",{value:"turbulence",children:"\ud83c\udf2a\ufe0f \u0422\u0443\u0440\u0431\u0443\u043b\u0435\u043d\u0442\u043d\u043e\u0441\u0442\u044c"})]}),e.godRayAnimType&&"none"!==e.godRayAnimType&&(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("span",{style:Ne.val,children:[null!==(g=e.godRayAnimSpeed)&&void 0!==g?g:1,"x"]})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:null!==(m=e.godRayAnimSpeed)&&void 0!==m?m:1,onChange:t=>ve("obstacles",e.id,{godRayAnimSpeed:+t.target.value})})]})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0414\u043b\u0438\u043d\u0430 \u043b\u0443\u0447\u0435\u0439"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"godRayLength",null!==(v=e.godRayLength)&&void 0!==v?v:.97).toFixed(3)})]}),(0,c.jsx)("input",{type:"range",min:"0.90",max:"0.99",step:"0.001",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:he(e.id,"godRayLength",void 0!==e.godRayLength?e.godRayLength:.97),onChange:t=>ve("obstacles",e.id,{godRayLength:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u0438\u043b\u0430"}),(0,c.jsx)("input",{type:"range",min:"0",max:"3",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:he(e.id,"holeOpacity",void 0!==e.holeOpacity?e.holeOpacity:.5),onChange:t=>ve("obstacles",e.id,{holeOpacity:+t.target.value}),disabled:J})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("span",{style:Ne.label,children:"Blur"}),(0,c.jsx)("input",{type:"range",min:"0",max:"50",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:he(e.id,"godRayBlur",void 0!==e.godRayBlur?e.godRayBlur:0),onChange:t=>ve("obstacles",e.id,{godRayBlur:+t.target.value}),disabled:J})]})]}),(0,c.jsxs)("div",{style:{marginBottom:"6px"},children:[(0,c.jsx)("span",{style:Ne.label,children:"Ray Blend Mode"}),(0,c.jsx)(VK,{value:e.godRayBlendMode||"lighter",onChange:t=>ve("obstacles",e.id,{godRayBlendMode:t})})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0434\u044b\u0440 (Bias)"}),(0,c.jsx)("span",{style:Ne.val,children:he(e.id,"holeBias",null!==(y=e.holeBias)&&void 0!==y?y:.5).toFixed(1)})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:"#8bc34a"}),value:he(e.id,"holeBias",void 0!==e.holeBias?e.holeBias:.5),onChange:t=>ve("obstacles",e.id,{holeBias:+t.target.value}),disabled:J})]})]})]})]})]},e.id)})}),et("\u2744\ufe0f \u041e\u0441\u0432\u0435\u0449\u0435\u043d\u0438\u0435 \u0447\u0430\u0441\u0442\u0438\u0446",ae,se,ze),ae&&(0,c.jsxs)("div",{style:Ne.sectionBody(ze),children:[(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c \u0432 \u0442\u0435\u043d\u0438 (Ambient)"}),(0,c.jsx)("span",{style:Ne.val,children:null!==(a=fe.particleAmbient)&&void 0!==a?a:1})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:ze}),value:null!==(l=fe.particleAmbient)&&void 0!==l?l:1,onChange:e=>me("particleAmbient",parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{marginBottom:0}),children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043e\u0440\u043e\u0433 \u0441\u0432\u0435\u0442\u0430 (Threshold)"}),(0,c.jsx)("span",{style:Ne.val,children:null!==(d=fe.particleLightThreshold)&&void 0!==d?d:0})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"0.95",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:ze}),value:null!==(u=fe.particleLightThreshold)&&void 0!==u?u:0,onChange:e=>me("particleLightThreshold",parseFloat(e.target.value))}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#777",marginTop:"2px",fontStyle:"italic"},children:"0 = \u041f\u043b\u0430\u0432\u043d\u044b\u0439 \u0432\u0445\u043e\u0434, 0.9 = \u0420\u0435\u0437\u043a\u0430\u044f \u0433\u0440\u0430\u043d\u0438\u0446\u0430 \u0441\u0432\u0435\u0442\u0430"})]})]}),et("\ud83d\uddb1\ufe0f \u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 (Cursor)",Te,Ie,Fe,(0,c.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,c.jsx)("input",{type:"checkbox",checked:(null===(p=fe.cursorBlocker)||void 0===p?void 0:p.enabled)||!1,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker||{radius:50,softness:20}),{},{enabled:e.target.checked})})),style:{cursor:"pointer",accentColor:Fe}})})),Te&&(null===(h=fe.cursorBlocker)||void 0===h?void 0:h.enabled)&&(0,c.jsxs)("div",{style:Ne.sectionBody(Fe),children:[(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83d\uded1 \u0411\u043b\u043e\u043a\u0438\u0440\u0430\u0442\u043e\u0440 \u0441\u0432\u0435\u0442\u0430"}),(0,c.jsxs)("div",{style:s(s({},Ne.ctrlRow),{},{background:"rgba(0,0,0,0.2)",padding:"4px",borderRadius:"4px"}),children:[(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",width:"100%",marginBottom:"4px"},children:[(0,c.jsx)("span",{style:s(s({},Ne.label),{},{color:null!==(f=fe.cursorBlocker)&&void 0!==f&&f.hideBody?Fe:"#ccc"}),children:"\ud83d\udc7b \u0421\u043a\u0440\u044b\u0442\u044c \u0442\u0435\u043b\u043e (Hide Body)"}),(0,c.jsx)("input",{type:"checkbox",checked:(null===(g=fe.cursorBlocker)||void 0===g?void 0:g.hideBody)||!1,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{hideBody:e.target.checked})})),style:{cursor:"pointer",accentColor:Fe}})]}),(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0442\u0435\u043b\u0430"}),(0,c.jsx)("span",{style:Ne.val,children:void 0!==(null===(m=fe.cursorBlocker)||void 0===m?void 0:m.bodyOpacity)?fe.cursorBlocker.bodyOpacity:1})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Fe,opacity:null!==(v=fe.cursorBlocker)&&void 0!==v&&v.hideBody?.3:1}),value:void 0!==(null===(y=fe.cursorBlocker)||void 0===y?void 0:y.bodyOpacity)?fe.cursorBlocker.bodyOpacity:1,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{bodyOpacity:parseFloat(e.target.value)})})),disabled:null===(x=fe.cursorBlocker)||void 0===x?void 0:x.hideBody})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",marginTop:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0420\u0430\u0434\u0438\u0443\u0441"}),(0,c.jsx)("span",{style:Ne.val,children:null===(b=fe.cursorBlocker)||void 0===b?void 0:b.radius})]}),(0,c.jsx)("input",{type:"range",min:"10",max:"300",step:"5",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:(null===(w=fe.cursorBlocker)||void 0===w?void 0:w.radius)||50,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{radius:parseFloat(e.target.value)})}))})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"Softness"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"100",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:null!==(S=null===(k=fe.cursorBlocker)||void 0===k?void 0:k.softness)&&void 0!==S?S:20,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{softness:parseFloat(e.target.value)})}))})]})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c \u0442\u0435\u043d\u0438"}),(0,c.jsx)("span",{style:Ne.val,children:null!==(C=null===(j=fe.cursorBlocker)||void 0===j?void 0:j.density)&&void 0!==C?C:1})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:void 0!==(null===(_=fe.cursorBlocker)||void 0===_?void 0:_.density)?fe.cursorBlocker.density:1,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{density:parseFloat(e.target.value)})}))})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"Squeeze (\u0421\u043f\u043b\u044e\u0449\u0438\u0432\u0430\u043d\u0438\u0435)"})}),(0,c.jsx)("input",{type:"range",min:"0.0",max:"1.0",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:null!==(E=null===(D=fe.cursorBlocker)||void 0===D?void 0:D.squeeze)&&void 0!==E?E:0,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{squeeze:parseFloat(e.target.value)})}))})]})]}),(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83d\udd06 \u041b\u0443\u0447\u0438 \u043e\u0442 \u043a\u0443\u0440\u0441\u043e\u0440\u0430"}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041a\u043e\u043b-\u0432\u043e \u043b\u0443\u0447\u0435\u0439"}),(0,c.jsx)("span",{style:Ne.val,children:(null===(M=fe.cursorBlocker)||void 0===M?void 0:M.rayCount)||0})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"8",step:"1",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:(null===(T=fe.cursorBlocker)||void 0===T?void 0:T.rayCount)||0,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{rayCount:parseInt(e.target.value)})}))})]}),((null===(I=fe.cursorBlocker)||void 0===I?void 0:I.rayCount)||0)>0&&(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"\u0417\u0430\u0437\u043e\u0440 (Gap)"})}),(0,c.jsx)("input",{type:"range",min:"0.0",max:"0.8",step:"0.05",style:s(s({},Ne.rangeInput),{},{accentColor:Fe}),value:null!==(A=null===(O=fe.cursorBlocker)||void 0===O?void 0:O.rayGap)&&void 0!==A?A:.2,onChange:e=>P(s(s({},fe),{},{cursorBlocker:s(s({},fe.cursorBlocker),{},{rayGap:parseFloat(e.target.value)})}))})]})]})]}),et("\ud83c\udf0c \u041f\u0430\u0440\u0430\u043b\u043b\u0430\u043a\u0441 \u044d\u0444\u0444\u0435\u043a\u0442\u044b",le,ce,Pe,(0,c.jsx)("input",{type:"checkbox",checked:(null===(R=fe.parallax)||void 0===R?void 0:R.enabled)||!1,onChange:e=>P(s(s({},fe),{},{parallax:s(s({},fe.parallax||{}),{},{enabled:e.target.checked})})),style:{cursor:"pointer",accentColor:Pe},onClick:e=>e.stopPropagation()})),le&&(null===(z=fe.parallax)||void 0===z?void 0:z.enabled)&&(0,c.jsxs)("div",{style:Ne.sectionBody(Pe),children:[(0,c.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,c.jsx)("span",{style:Ne.label,children:"Target:"}),(0,c.jsxs)("select",{value:de,onChange:e=>ue(e.target.value),style:{width:"100%",padding:"2px",background:"#222",color:"#fff",border:"1px solid #444",borderRadius:"3px",fontSize:"10px"},children:[(0,c.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438 \u0441\u0432\u0435\u0442\u0430"}),(fe.sources||[]).map((e,t)=>(0,c.jsxs)("option",{value:e.id,children:[t+1,". Light Source"]},e.id))]})]}),(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u0438\u043b\u0430 (\u041c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c)"}),(0,c.jsxs)("span",{style:Ne.val,children:[Je().toFixed(1),"x"]})]}),(0,c.jsx)("input",{type:"range",min:"0",max:"10",step:"0.1",style:s(s({},Ne.rangeInput),{},{accentColor:Pe}),value:Je(),onChange:e=>(e=>{const t=(fe.sources||[]).map(t=>"all"===de||t.id===de?s(s({},t),{},{parallaxStrength:e}):t);P(s(s({},fe),{},{sources:t}))})(parseFloat(e.target.value))})]}),(0,c.jsx)("button",{onClick:async()=>{if("undefined"!==typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission)try{"granted"===await DeviceMotionEvent.requestPermission()?alert("\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0433\u0438\u0440\u043e\u0441\u043a\u043e\u043f\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d! \u042d\u0444\u0444\u0435\u043a\u0442 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0438."):alert("\u0412 \u0434\u043e\u0441\u0442\u0443\u043f\u0435 \u043e\u0442\u043a\u0430\u0437\u0430\u043d\u043e. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u0441\u0430\u0439\u0442\u0430.")}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u043f\u0440\u0430\u0432: "+M2.message)}else alert("\u041d\u0430 \u044d\u0442\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f. \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0441\u0430\u0439\u0442 \u043e\u0442\u043a\u0440\u044b\u0442 \u0447\u0435\u0440\u0435\u0437 HTTPS.")},style:s(s({},Ne.actionBtn),{},{width:"100%",marginTop:"6px",background:"#26a69a33",border:"1px solid #26a69a"}),children:"\ud83d\udd13 \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0413\u0438\u0440\u043e\u0441\u043a\u043e\u043f (Mobile)"})]}),et("\u26a1 \u041f\u0440\u0435\u0441\u0435\u0442\u044b \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438",ne,re,Be),ne&&(0,c.jsxs)("div",{style:Ne.sectionBody(Be),children:[(0,c.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,c.jsx)("span",{style:Ne.label,children:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043a:"}),(0,c.jsxs)("select",{value:oe,onChange:e=>ie(e.target.value),style:{width:"100%",padding:"2px",background:"#222",color:"#fff",border:"1px solid #444",borderRadius:"3px",marginTop:"2px",fontSize:"10px"},children:[(0,c.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438"}),(fe.sources||[]).map((e,t)=>(0,c.jsxs)("option",{value:e.id,children:[t+1,". Light Source"]},e.id))]})]}),(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83d\udca1 \u0421\u0432\u0435\u0442"}),(0,c.jsx)("select",{value:$e.type,onChange:e=>qe("presetLight",{type:e.target.value}),style:{width:"100%",padding:"2px",background:"#222",color:"#fff",border:"1px solid #444",borderRadius:"3px",marginBottom:"4px",fontSize:"10px"},children:LK.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))}),"none"!==$e.type&&(0,c.jsxs)("div",{style:Ne.ctrlRow,children:[(0,c.jsxs)("div",{style:Ne.labelRow,children:[(0,c.jsx)("span",{style:Ne.label,children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("span",{style:Ne.val,children:[$e.speed,"x"]})]}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:Ne.rangeInput,value:$e.speed,onChange:e=>qe("presetLight",{speed:parseFloat(e.target.value)})})]})]}),(0,c.jsxs)("div",{style:Ne.subGroup,children:[(0,c.jsx)("div",{style:Ne.subGroupHeader,children:"\ud83d\ude80 \u0414\u0432\u0438\u0436\u0435\u043d\u0438\u0435"}),(0,c.jsx)("select",{value:Ke.type,onChange:e=>qe("presetMotion",{type:e.target.value}),style:{width:"100%",padding:"2px",background:"#222",color:"#fff",border:"1px solid #444",borderRadius:"3px",marginBottom:"4px",fontSize:"10px"},children:NK.map(e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value))}),"none"!==Ke.type&&(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"Speed"})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:Ne.rangeInput,value:Ke.speed,onChange:e=>qe("presetMotion",{speed:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("div",{style:Ne.labelRow,children:(0,c.jsx)("span",{style:Ne.label,children:"Amp"})}),(0,c.jsx)("input",{type:"range",min:"1",max:"200",step:"1",style:Ne.rangeInput,value:Ke.strength,onChange:e=>qe("presetMotion",{strength:parseFloat(e.target.value)})})]})]})]})]}),(0,c.jsx)("div",{style:{height:"10px"}}),(0,c.jsxs)("div",{style:{marginBottom:"15px",border:"1px solid #444",borderRadius:"6px",overflow:"hidden",background:"#222"},children:[(0,c.jsxs)("div",{style:{padding:"8px 10px",cursor:J?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",background:te?"rgba(239, 83, 80, 0.15)":"#1e1e1e",borderBottom:te?"2px solid ".concat(Le):"none",transition:"all 0.2s ease",userSelect:"none"},onClick:()=>!J&&(e=>{if(e)if(W&&W.groups&&0!==W.groups.length){const e=W.groups.map(e=>e.id===W.activeGroupId?s(s({},e),{},{enabled:!0}):e);H(s(s({},W),{},{groups:e}))}else{const e={id:"light_group_1",name:"\u0421\u0432\u0435\u0442\u043e\u0432\u0430\u044f \u0441\u0446\u0435\u043d\u0430 1",enabled:!0,duration:10,trigger:"start",elements:{}};H({activeGroupId:e.id,groups:[e]})}else if(ee){const e=W.groups.map(e=>e.id===ee.id?s(s({},e),{},{enabled:!1}):e);H(s(s({},W),{},{groups:e}))}})(!te),children:[(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"600",color:te?Le:"#ccc"},children:J?"\u26d4 \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 (Play)":te?"\ud83d\udd34 REC (\u0417\u0430\u043f\u0438\u0441\u044c)":"\u23f1\ufe0f Timeline Off"})}),(0,c.jsx)("div",{style:{width:"32px",height:"16px",background:"#333",borderRadius:"10px",position:"relative",transition:"background 0.3s"},children:(0,c.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:te?Le:"#555",position:"absolute",top:"2px",left:te?"18px":"2px",transition:"all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)"}})})]}),te&&ee&&(0,c.jsxs)("div",{style:{padding:"10px",background:"#252525",borderTop:"1px solid #444"},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"10px",borderBottom:"1px dashed #444",paddingBottom:"8px"},children:[(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",color:"#ccc",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!1!==ee.loop,onChange:e=>be(s(s({},ee),{},{loop:e.target.checked})),disabled:J}),"Loop"]}),(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",color:"#ccc",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!ee.reverse,onChange:e=>be(s(s({},ee),{},{reverse:e.target.checked})),disabled:J}),"Reverse"]})]}),(0,c.jsx)(eK,{duration:ee.duration,onDurationChange:e=>be(s(s({},ee),{},{duration:e})),trigger:ee.trigger,onTriggerChange:e=>be(s(s({},ee),{},{trigger:e})),triggerLayerId:ee.triggerLayerId,onTriggerLayerIdChange:e=>be(s(s({},ee),{},{triggerLayerId:e})),restartOnClick:ee.restartOnClick,onRestartOnClickChange:e=>be(s(s({},ee),{},{restartOnClick:e})),snapStep:$,setSnapStep:K,onAddEvent:()=>{if(!ee)return;const e={id:"evt_".concat(Date.now()),time:G,name:"trigger"},t=s(s({},ee),{},{events:[...ee.events||[],e]});be(t)},isEnabled:!J,showEvents:!0,layers:Y,allowedTriggers:["start","click","text_event"],showTriggerTextTyping:!1,textEvents:V}),(0,c.jsx)("div",{style:{height:8}}),(0,c.jsx)(tK,{data:ee,onUpdateData:be,currentTime:G,onTimeChange:e=>{X(e),P(s(s({},fe),{},{_previewTime:e}))},selectedElementId:U||"sl_ambient",snapStep:$,isEnabled:!0,onPlayStateChange:Q})]})]})]})]})},HK=e=>{let{controls:t=[],onUpdate:n,layers:r=[],isExpanded:o,onToggle:i,textEvents:a=[],choices:l=[]}=e;const d=[{id:"colorCorrection",label:"\u0426\u0432\u0435\u0442\u043e\u043a\u043e\u0440\u0440\u0435\u043a\u0446\u0438\u044f"},{id:"textureOverlay",label:"\u0422\u0435\u043a\u0441\u0442\u0443\u0440\u0430"},{id:"camera",label:"\u041a\u0430\u043c\u0435\u0440\u0430"},{id:"parallax",label:"\u041f\u0430\u0440\u0430\u043b\u043b\u0430\u043a\u0441"},{id:"weather",label:"\u041f\u043e\u0433\u043e\u0434\u0430"},{id:"darkness",label:"\u0422\u0435\u043c\u043d\u043e\u0442\u0430/\u0424\u043e\u043d\u0430\u0440\u044c"},{id:"sceneLight",label:"\u0421\u0432\u0435\u0442 \u0441\u0446\u0435\u043d\u044b"},{id:"noise",label:"\u0428\u0443\u043c/VHS"},{id:"glitch",label:"\u0413\u043b\u0438\u0442\u0447"}],u={header:{background:"#333",padding:"10px",borderRadius:"4px",marginBottom:"5px",color:"#fff",fontWeight:"bold",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #444"},panel:{background:"#222",padding:"10px",borderRadius:"4px",marginBottom:"15px",border:"1px solid #333"},row:{display:"flex",gap:"5px",marginBottom:"8px",alignItems:"center"},btn:{cursor:"pointer",padding:"6px 10px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:"4px",fontSize:"11px"},select:{background:"#111",color:"#fff",border:"1px solid #444",padding:"4px",borderRadius:"3px",fontSize:"11px",flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0},label:{fontSize:"11px",color:"#aaa",width:"60px",flexShrink:0},divider:{height:1,background:"#444",margin:"8px 0"},removeBtn:{color:"#ff6b6b",cursor:"pointer",fontWeight:"bold",padding:"0 8px",fontSize:"14px"}},p=(e,r,o)=>{const i=[...t];i[e]=s(s({},i[e]),{},{[r]:o}),n(i)},h=(e,r,o,i)=>{const a=[...t],l=s({},a[e]),c=[...l.actions];c[r]=s(s({},c[r]),{},{[o]:i}),l.actions=c,a[e]=l,n(a)};return(0,c.jsxs)("div",{style:{marginBottom:10},children:[(0,c.jsxs)("div",{style:u.header,onClick:i,children:[(0,c.jsx)("span",{children:"\ud83c\udfae \u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435"}),(0,c.jsx)("span",{children:o?"\u25bc":"\u25ba"})]}),o&&(0,c.jsxs)("div",{style:u.panel,children:[(0,c.jsx)("div",{style:{marginBottom:10,fontSize:"12px",color:"#bbb",fontStyle:"italic",lineHeight:"1.4"},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c: \u043a\u0430\u043a\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438 \u043a\u043b\u0438\u043a\u0435 \u043d\u0430 \u0441\u043b\u043e\u0438."}),t.map((e,o)=>(0,c.jsxs)("div",{style:{background:"#2a2a2a",padding:"10px",borderRadius:"6px",marginBottom:"10px",border:"1px solid #3d3d3d"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,c.jsxs)("span",{style:{fontSize:"12px",fontWeight:"bold",color:"#4caf50"},children:["\u0421\u0432\u044f\u0437\u044c #",o+1]}),(0,c.jsx)("span",{style:u.removeBtn,onClick:()=>(e=>{const r=[...t];r.splice(e,1),n(r)})(o),children:"\u2715"})]}),(0,c.jsxs)("div",{style:u.row,children:[(0,c.jsx)("span",{style:u.label,children:"\u0422\u0440\u0438\u0433\u0433\u0435\u0440:"}),(0,c.jsxs)("select",{style:u.select,value:e.trigger,onChange:e=>p(o,"trigger",e.target.value),children:[(0,c.jsx)("option",{value:"click_layer",children:"\u041a\u043b\u0438\u043a \u043f\u043e \u0441\u043b\u043e\u044e"}),(0,c.jsx)("option",{value:"hover_layer",children:"\u041d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043d\u0430 \u0441\u043b\u043e\u0439"}),(0,c.jsx)("option",{value:"hover_button",children:"\u041d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443"})," ",(0,c.jsx)("option",{value:"text_event",children:"\u0421\u043e\u0431\u044b\u0442\u0438\u0435 \u0432 \u0442\u0435\u043a\u0441\u0442\u0435"})]})]}),("click_layer"===e.trigger||"hover_layer"===e.trigger)&&(0,c.jsxs)("div",{style:u.row,children:[(0,c.jsx)("span",{style:u.label,children:"\u0421\u043b\u043e\u0439:"}),(0,c.jsxs)("select",{style:u.select,value:e.triggerLayerId,onChange:e=>p(o,"triggerLayerId",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0439 --"}),r.map(e=>{const t=e.name||e.id,n=t.length>12?t.substring(0,12)+"...":t;return(0,c.jsxs)("option",{value:e.id,children:[n," (",e.type,")"]},e.id)})]})]}),"hover_button"===e.trigger&&(0,c.jsxs)("div",{style:u.row,children:[(0,c.jsx)("span",{style:u.label,children:"\u041a\u043d\u043e\u043f\u043a\u0430:"}),(0,c.jsxs)("select",{style:u.select,value:e.triggerLayerId,onChange:e=>p(o,"triggerLayerId",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 --"}),l&&l.length>0?l.map((e,t)=>{const n=e.text?e.text.substring(0,15):"Choice ".concat(t+1);return(0,c.jsxs)("option",{value:"btn_".concat(t),children:["btn_",t," (",n,")"]},t)}):[0,1,2,3,4].map(e=>(0,c.jsxs)("option",{value:"btn_".concat(e),children:["Button ",e+1," (btn_",e,")"]},e))]})]}),"text_event"===e.trigger&&(0,c.jsxs)("div",{style:u.row,children:[(0,c.jsx)("span",{style:u.label,children:"Event ID:"}),a&&a.length>0?(0,c.jsxs)("select",{style:u.select,value:e.eventName||"",onChange:e=>p(o,"eventName",e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 --"}),a.map(e=>(0,c.jsx)("option",{value:e,children:e},e))]}):(0,c.jsx)("input",{type:"text",placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: MyEvent1",style:s(s({},u.select),{},{padding:"5px"}),value:e.eventName||"",onChange:e=>p(o,"eventName",e.target.value),title:"\u0422\u0435\u0433\u0438 [[Event:Name]] \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u0432 \u0442\u0435\u043a\u0441\u0442\u0435. \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e."})]}),(0,c.jsx)("div",{style:u.divider}),(0,c.jsx)("div",{style:{marginBottom:6,fontSize:"11px",color:"#ddd",fontWeight:"bold"},children:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f (\u042d\u0444\u0444\u0435\u043a\u0442\u044b):"}),(!e.actions||0===e.actions.length)&&(0,c.jsx)("div",{style:{fontSize:"10px",color:"#666",marginBottom:5},children:"\u041d\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"}),e.actions&&e.actions.map((r,i)=>{return(0,c.jsxs)("div",{style:s(s({},u.row),{},{background:"#1a1a1a",padding:"6px",borderRadius:"4px",border:"1px solid #333"}),children:[(0,c.jsx)("select",{style:s(s({},u.select),{},{flex:2}),value:r.effectId,onChange:e=>h(o,i,"effectId",e.target.value),children:d.map(e=>(0,c.jsx)("option",{value:e.id,children:e.label},e.id))}),(0,c.jsx)("select",{style:s(s({},u.select),{},{flex:1}),value:r.mode,onChange:e=>h(o,i,"mode",e.target.value),children:(a=e.trigger,"text_event"===a?[{val:"on",label:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c"},{val:"off",label:"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c"}]:"hover_layer"===a||"hover_button"===a?[{val:"hover_hold_on",label:"\u0412\u043a\u043b \u043f\u043e\u043a\u0430 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u043e (Hold On)"},{val:"hover_hold_off",label:"\u0412\u044b\u043a\u043b \u043f\u043e\u043a\u0430 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u043e (Hold Off)"},{val:"on",label:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c (\u0415\u0434\u0438\u043d\u043e\u0440\u0430\u0437\u043e\u0432\u043e)"},{val:"off",label:"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c (\u0415\u0434\u0438\u043d\u043e\u0440\u0430\u0437\u043e\u0432\u043e)"}]:[{val:"toggle",label:"\u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c"},{val:"hold",label:"\u0417\u0430\u0436\u0430\u0442\u0438\u0435 (Hold)"},{val:"on",label:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c"},{val:"off",label:"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c"}]).map(e=>(0,c.jsx)("option",{value:e.val,children:e.label},e.val))}),(0,c.jsx)("span",{style:u.removeBtn,onClick:()=>((e,r)=>{const o=[...t],i=s({},o[e]),a=[...i.actions];a.splice(r,1),i.actions=a,o[e]=i,n(o)})(o,i),children:"\u2715"})]},i);var a}),(0,c.jsx)("button",{style:s(s({},u.btn),{},{width:"100%",marginTop:8}),onClick:()=>(e=>{const r=[...t],o=s({},r[e]);o.actions=[...o.actions||[],{effectId:"noise",mode:"toggle"}],r[e]=o,n(r)})(o),children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435"})]},e.id)),(0,c.jsx)("button",{style:s(s({},u.btn),{},{background:"#007bff",borderColor:"#0056b3",width:"100%",padding:"10px",fontWeight:"bold"}),onClick:()=>{const e={id:Date.now().toString(),trigger:"click_layer",triggerLayerId:r.length>0?r[0].id:"",eventName:"",actions:[]};n([...t,e])},children:"+ \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0432\u044f\u0437\u044c"})]})]})},GK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S;let{isParallaxActive:k,toggleParallax:C,masterParallax:j,onUpdateMaster:_,layers:E=[],onUpdateLayerParam:D,onToggleLayerOverflow:M,onToggleLayerParallax:T,effectControls:I,onUpdateEffectControls:A,darknessSettings:O,onUpdateDarkness:R,handleLayerSelect:z,selectedElementId:F,noiseSettings:P,onUpdateNoise:B,animationData:L,onUpdateAnimation:N,animTime:U,onAnimTimeChange:V,glitchSettings:W,onUpdateGlitch:H,choices:G=[],weatherSettings:X,onUpdateWeather:Y,sceneLayers:q,textEvents:Z,transitionSettings:$,onUpdateTransition:K,onPreviewTransition:J,currentTime:Q,onTimeChange:ee,cameraSettings:te,onUpdateCamera:ne,sceneLightSettings:re,onUpdateSceneLight:oe,colorSettings:ie,onUpdateColor:ae,textureSettings:se,onUpdateTexture:le,textureFiles:ce=[],assetsMap:de,onCopyEffects:ue,onPasteEffects:pe,canPasteEffects:he}=t;const[fe,ge]=(0,e.useState)(null),me=P||{enabled:!1,variant:"digital",opacity:.1,size:.5,speed:.5,monochrome:!0,scope:"global",vhsTracking:.5,vhsDistortion:.3},ve=W||{enabled:!1,intensity:.5,scope:"global",speed:.5,colorShift:.5,blocksDensity:.5},ye={panel:{background:"#2a2a2a",padding:"16px",borderRadius:"8px",width:"100%",border:"1px solid #333",display:"flex",flexDirection:"column",gap:"16px",fontFamily:"sans-serif",fontSize:"13px",color:"#eee",boxSizing:"border-box"},header:{fontWeight:"600",fontSize:"14px",color:"#fff",borderBottom:"1px solid #444",paddingBottom:"8px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",selectUser:"none"},subHeader:{background:"#333",padding:"8px 12px",borderRadius:"4px",marginTop:"5px",marginBottom:"5px",fontSize:"11px",fontWeight:"600",color:"#ddd",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",border:"1px solid #3f3f3f",userSelect:"none"},row:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"12px"},checkboxRow:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},rangeInput:{width:"100%",cursor:"pointer",accentColor:"#7568ed",height:"6px"},valueLabel:{fontSize:"10px",color:"#fff",width:"30px",textAlign:"right",fontFamily:"monospace"},selectInput:{width:"100%",padding:"4px",background:"#1e1e1e",color:"#fff",border:"1px solid #444",borderRadius:"4px",fontSize:"12px"}};return(0,c.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,c.jsx)(HK,{controls:I||[],onUpdate:A,layers:E,isExpanded:"controls"===fe,onToggle:()=>ge("controls"===fe?null:"controls"),textEvents:Z,choices:G}),(0,c.jsx)(xK,{settings:ie,onUpdate:ae,textureFiles:ce,textEvents:Z,isExpanded:"color"===fe,onToggle:()=>ge("color"===fe?null:"color"),availableLayers:E}),(0,c.jsx)(bK,{settings:se,onUpdate:le,textureFiles:ce,isExpanded:"texture"===fe,onToggle:()=>ge("texture"===fe?null:"texture"),isAnimMode:!1,currentTime:Q,assetsMap:de}),(0,c.jsx)(kK,{settings:te,onUpdate:ne,currentTime:Q,onTimeChange:ee,isExpanded:"camera"===fe,onToggle:()=>ge("camera"===fe?null:"camera")}),(0,c.jsx)(CK,{settings:$,onUpdate:K,onPreview:J,isExpanded:"transition"===fe,onToggle:()=>ge("transition"===fe?null:"transition")}),(0,c.jsx)(jK,{isExpanded:"parallax"===fe,onToggle:()=>ge("parallax"===fe?null:"parallax"),isParallaxActive:k,toggleParallax:C,masterParallax:j,onUpdateMaster:_,layers:E,onUpdateLayerParam:D,onToggleLayerOverflow:M,onToggleLayerParallax:T}),(0,c.jsx)(AK,{weatherSettings:X,onUpdateWeather:Y,isExpanded:"weather"===fe,onToggle:()=>ge("weather"===fe?null:"weather"),currentTime:Q,onTimeChange:ee,textEvents:Z}),(0,c.jsx)(BK,{settings:O,onUpdate:R,isExpanded:"darkness"===fe,onToggle:()=>ge("darkness"===fe?null:"darkness"),assetsMap:de,textureFiles:ce}),(0,c.jsx)(WK,{settings:re,onUpdate:oe,isExpanded:"sceneLight"===fe,onToggle:()=>ge("sceneLight"===fe?null:"sceneLight"),sceneLayers:q,onSelectElement:z,selectedId:F,lightAnimationData:L,onUpdateLightAnimation:N,textEvents:Z,lightAnimTime:U,setLightAnimTime:V}),(0,c.jsxs)("div",{style:ye.panel,children:[(0,c.jsxs)("div",{style:ye.header,onClick:()=>ge("noise"===fe?null:"noise"),children:[(0,c.jsx)("input",{type:"checkbox",checked:!!me.enabled,onClick:e=>e.stopPropagation(),onChange:e=>B({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#00e676"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u0417\u0435\u0440\u043d\u0438\u0441\u0442\u043e\u0441\u0442\u044c / VHS \ud83d\udcfa"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#00e676",background:"rgba(0, 230, 118, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:me.enabled?"vhs"===me.variant?"VHS":"Digital":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:"noise"===fe?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),"noise"===fe&&(0,c.jsxs)("div",{style:{padding:"0 5px"},children:[(0,c.jsx)("div",{style:{display:"flex",background:"#1e1e1e",borderRadius:"4px",padding:"2px",marginBottom:"12px",border:"1px solid #444"},children:["digital","vhs"].map(e=>(0,c.jsx)("div",{onClick:()=>B({variant:e}),style:{flex:1,textAlign:"center",padding:"6px",fontSize:"11px",cursor:"pointer",background:me.variant===e?"#333":"transparent",color:me.variant===e?"#fff":"#888",borderRadius:"3px",fontWeight:me.variant===e?"600":"400",textTransform:"uppercase"},children:e},e))}),(0,c.jsxs)("div",{style:ye.checkboxRow,children:[(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043e\u0432\u0435\u0440\u0445 \u0432\u0441\u0435\u0433\u043e (\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e)"})}),(0,c.jsx)("input",{type:"checkbox",checked:"global"===me.scope,onChange:e=>B({scope:e.target.checked?"global":"content"})})]}),"digital"===me.variant&&(0,c.jsxs)("div",{style:ye.checkboxRow,children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0427\u0435\u0440\u043d\u043e-\u0431\u0435\u043b\u044b\u0439 \u0448\u0443\u043c"}),(0,c.jsx)("input",{type:"checkbox",checked:!!me.monochrome,onChange:e=>B({monochrome:e.target.checked})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c / \u0421\u0438\u043b\u0430"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(n=me.opacity)&&void 0!==n?n:.1,onChange:e=>B({opacity:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:ye.valueLabel,children:me.opacity})]})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0437\u0435\u0440\u043d\u0430"})}),(0,c.jsx)("input",{type:"range",min:"0.5",max:"5",step:"0.5",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(r=me.size)&&void 0!==r?r:1,onChange:e=>B({size:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(o=me.speed)&&void 0!==o?o:.5,onChange:e=>B({speed:parseFloat(e.target.value)})})]}),"vhs"===me.variant&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"8px 0"}}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"8px"},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 VHS"}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"Tracking Lines (\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e)"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"3",step:"1",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(i=me.vhsTrackingStrength)&&void 0!==i?i:0,onChange:e=>B({vhsTrackingStrength:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:ye.valueLabel,children:null!==(a=me.vhsTrackingStrength)&&void 0!==a?a:0})]})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"Tracking Speed (\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c)"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(l=me.vhsTrackingSpeed)&&void 0!==l?l:1,onChange:e=>B({vhsTrackingSpeed:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:ye.valueLabel,children:null!==(d=me.vhsTrackingSpeed)&&void 0!==d?d:1})]})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0418\u0441\u043a\u0430\u0436\u0435\u043d\u0438\u044f (Distortion)"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#00e676"}),value:null!==(u=me.vhsDistortion)&&void 0!==u?u:.3,onChange:e=>B({vhsDistortion:parseFloat(e.target.value)})})]})]})]})]}),(0,c.jsxs)("div",{style:ye.panel,children:[(0,c.jsxs)("div",{style:ye.header,onClick:()=>ge("glitch"===fe?null:"glitch"),children:[(0,c.jsx)("input",{type:"checkbox",checked:!!ve.enabled,onClick:e=>e.stopPropagation(),onChange:e=>H({enabled:e.target.checked}),style:{cursor:"pointer",accentColor:"#ff4081"}}),(0,c.jsx)("span",{style:{flex:1},children:"\u041c\u0430\u0442\u0440\u0438\u0446\u0430 (Glitch) \ud83d\udc7e"}),(0,c.jsx)("span",{style:{fontSize:"10px",color:"#ff4081",background:"rgba(255, 64, 129, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:ve.enabled?"On":"Off"}),(0,c.jsx)("div",{style:{color:"#aaa",fontSize:"10px",transform:"glitch"===fe?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"},children:"\u25bc"})]}),"glitch"===fe&&(0,c.jsxs)("div",{style:{padding:"0 5px"},children:[(0,c.jsxs)("div",{style:ye.checkboxRow,children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043e\u0432\u0435\u0440\u0445 \u0432\u0441\u0435\u0433\u043e"}),(0,c.jsx)("input",{type:"checkbox",checked:"global"===ve.scope,onChange:e=>H({scope:e.target.checked?"global":"content"})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"1.5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(p=ve.speed)&&void 0!==p?p:.5,onChange:e=>H({speed:parseFloat(e.target.value)})})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"8px 0"}}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#ff8a80",marginBottom:"4px",fontWeight:"bold"},children:"1. \u0413\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0431\u043b\u043e\u043a\u0438"}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c (\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e)"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(h=ve.horzDensity)&&void 0!==h?h:0,onChange:e=>H({horzDensity:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0428\u0438\u0440\u0438\u043d\u0430 (X)"}),(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0412\u044b\u0441\u043e\u0442\u0430 (Y)"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),title:"\u0414\u043b\u0438\u043d\u0430 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u043e\u0441",value:null!==(f=ve.horzScaleX)&&void 0!==f?f:1,onChange:e=>H({horzScaleX:parseFloat(e.target.value)})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),title:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u043e\u0441",value:null!==(g=ve.horzScaleY)&&void 0!==g?g:1,onChange:e=>H({horzScaleY:parseFloat(e.target.value)})})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#333",margin:"4px 0"}}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#80d8ff",marginBottom:"4px",fontWeight:"bold"},children:"2. \u0412\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0431\u043b\u043e\u043a\u0438"}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c (\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e)"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(m=ve.vertDensity)&&void 0!==m?m:0,onChange:e=>H({vertDensity:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0428\u0438\u0440\u0438\u043d\u0430 (X)"}),(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0412\u044b\u0441\u043e\u0442\u0430 (Y)"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),title:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u043e\u0441",value:null!==(v=ve.vertScaleX)&&void 0!==v?v:1,onChange:e=>H({vertScaleX:parseFloat(e.target.value)})}),(0,c.jsx)("input",{type:"range",min:"0.1",max:"5",step:"0.1",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),title:"\u0414\u043b\u0438\u043d\u0430 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u043e\u0441",value:null!==(y=ve.vertScaleY)&&void 0!==y?y:1,onChange:e=>H({vertScaleY:parseFloat(e.target.value)})})]})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"8px 0"}}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"8px",fontWeight:"bold"},children:"\u0421\u0442\u0438\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0431\u043b\u043e\u043a\u043e\u0432"}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u0431\u043b\u043e\u043a\u043e\u0432"})}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(x=ve.blockOpacity)&&void 0!==x?x:1,onChange:e=>H({blockOpacity:parseFloat(e.target.value)})})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"\u0420\u0435\u0436\u0438\u043c \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("select",{style:ye.selectInput,value:ve.blockBlend||"lighter",onChange:e=>H({blockBlend:e.target.value}),children:[(0,c.jsx)("option",{value:"source-over",children:"Normal"}),(0,c.jsx)("option",{value:"lighter",children:"Lighter (Add)"}),(0,c.jsx)("option",{value:"screen",children:"Screen"}),(0,c.jsx)("option",{value:"overlay",children:"Overlay"}),(0,c.jsx)("option",{value:"difference",children:"Difference"}),(0,c.jsx)("option",{value:"multiply",children:"Multiply"})]})]}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#ccc"},children:"Lines Channel Shift"})}),(0,c.jsx)("div",{style:{fontSize:"9px",color:"#666",marginBottom:"2px"},children:"\u0421\u0434\u0432\u0438\u0433 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0430\u043c\u0438\u0445 \u0431\u043b\u043e\u043a\u043e\u0432"}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(b=ve.blockChannelShift)&&void 0!==b?b:0,onChange:e=>H({blockChannelShift:parseFloat(e.target.value)})})]}),(0,c.jsx)("div",{style:{height:"1px",background:"#444",margin:"8px 0"}}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#888",marginBottom:"8px",fontWeight:"bold"},children:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u0438\u0441\u043a\u0430\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("div",{style:ye.row,children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("label",{style:{fontSize:"11px",color:"#fff",fontWeight:"bold"},children:"Global RGB Split"})}),(0,c.jsx)("div",{style:{fontSize:"10px",color:"#aaa",marginBottom:"4px"},children:"\u0420\u0430\u0441\u0441\u043b\u043e\u0435\u043d\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u0432\u0441\u0435\u0433\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",style:s(s({},ye.rangeInput),{},{accentColor:"#ff4081"}),value:null!==(w=ve.globalShake)&&void 0!==w?w:0,onChange:e=>H({globalShake:parseFloat(e.target.value)})}),(0,c.jsx)("span",{style:ye.valueLabel,children:null!==(S=ve.globalShake)&&void 0!==S?S:0})]})]})]})]}),(0,c.jsxs)("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:"1px solid #333",display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{onClick:ue,style:{flex:1,padding:"10px",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"6px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},title:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432",children:"\ud83d\udccb \u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,c.jsx)("button",{onClick:pe,disabled:!he,style:{flex:1,padding:"10px",background:he?"#2e7d32":"#222",color:he?"#fff":"#555",border:he?"1px solid #4caf50":"1px solid #333",borderRadius:"6px",cursor:he?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},title:he?"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438\u0437 \u0431\u0443\u0444\u0435\u0440\u0430":"\u0411\u0443\u0444\u0435\u0440 \u043f\u0443\u0441\u0442",children:"\ud83d\udce5 \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c"})]})]})},XK=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P,B,L,N,U,V,W,H,G,X,Y;let{isGlobal:q,isMobileScreen:Z,layoutMode:$,setLayoutMode:K,selectedId:J,fragmentTab:Q,htmlData:ee,onUpdateAutosaveInterval:te,onExportState:ne,onImportState:re,onUpdateGlobalSettings:oe,onCopyEffects:ie,onPasteEffects:ae,canPasteEffects:se,onUpdateGrid:le,onUpdateMenu:ce,onToggleLayerParallax:de,onUpdateStyles:ue,onUpdateGlobalButtonCount:pe,onResetSettings:he,currentAnimData:fe,updateAnimationData:ge,animTime:me,setAnimTime:ve,selectedElementId:ye,availableLayers:xe,showTrajectories:be,sceneLayers:we,setShowTrajectories:Se,updateTextAnimSettings:ke,choices:Ce=[],onUpdateAudio:je,onUpdateAttributes:_e,masterParallax:Ee,onPasteLayer:De,onExportVideo:Me,setMasterParallax:Te,applyMasterParallax:Ie,toggleParallaxEffect:Ae,updateLayerParam:Oe,toggleLayerOverflow:Re,updateDarknessSettings:ze,updateWeatherSettings:Fe,updateNoiseSettings:Pe,updateGlitchSettings:Be,lightAnimationData:Le,onUpdateLightAnimation:Ne,lightAnimTime:Ue,setLightAnimTime:Ve,updateTransitionSettings:We,handleTransitionPreview:He,layersForPanel:Ge,addLayer:Xe,removeLayer:Ye,onBgChange:qe,multiSelectionIds:Ze,handleLayerSelect:$e,textureSettings:Ke,onUpdateTexture:Je,effectControls:Qe,onUpdateEffectControls:et,addLayerFolder:tt,toggleFolderCollapse:nt,toggleFolderVisibility:rt,handleFolderSelect:ot,onUpdateSceneLight:it,textEvents:at=[],sceneLightSettings:st,reorderLayersWithHierarchy:lt,currentResolution:ct,presets:dt,onAddCharacter:ut,currentMenuSettings:pt,globalButtonCount:ht,activeButtons:ft,customFonts:gt,weatherSettings:mt,cameraSettings:vt,updateCameraSettings:yt,colorSettings:xt,onUpdateColor:bt,textureFiles:wt,onOpenCharEditor:St,onReparentLayer:kt,onReorderLayersSmart:Ct,onOpenTextEditor:jt,sceneElements:_t,onUpdateElement:Et,assetsMap:Dt}=t;const[Mt,Tt]=(0,e.useState)(null),It=e=>({isOpen:Mt===e,onToggle:()=>(e=>{Tt(t=>t===e?null:e)})(e)}),At=(0,e.useMemo)(()=>_t?_t.find(e=>"text_area"===e.id):null,[_t]),Ot=(0,e.useMemo)(()=>_t&&ye&&ye.startsWith("btn_")?_t.find(e=>e.id===ye):null,[_t,ye]),Rt=(e,t)=>{Et&&Et(e,t)},zt=null===fe||void 0===fe||null===(n=fe.groups)||void 0===n?void 0:n.find(e=>e.id===fe.activeGroupId),Ft=(null===zt||void 0===zt?void 0:zt.enabled)||!1;return(0,c.jsxs)("div",{style:{padding:"15px",columnWidth:Z?"300px":"auto",columnGap:"15px",width:"100%"},children:[(0,c.jsx)("div",{style:{marginBottom:15,paddingBottom:10,borderBottom:"1px solid #333"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,c.jsx)("h2",{style:{margin:0,fontSize:"18px",display:"inline-block"},children:"\u0422\u0438\u043f \u043c\u0430\u043a\u0435\u0442\u0430"}),q&&(0,c.jsx)(PE,{text:"\u0412\u044b\u0431\u043e\u0440 \u0442\u0438\u043f\u0430 \u043c\u0430\u043a\u0435\u0442\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432..."})]})}),(0,c.jsxs)("div",{style:{display:"flex",marginBottom:"15px",background:"#333",borderRadius:"6px",padding:"4px",gap:"5px"},children:[(0,c.jsx)("button",{style:s(s({},zL.modeBtn("desktop"===$)),{},{flex:1,textAlign:"center",justifyContent:"center",cursor:"pointer"}),onClick:()=>K("desktop"),children:"\ud83d\udda5 Desktop"}),(0,c.jsx)("button",{style:s(s({},zL.modeBtn("mobile"===$)),{},{flex:1,textAlign:"center",justifyContent:"center",cursor:"pointer"}),onClick:()=>K("mobile"),children:"\ud83d\udcf1 Mobile"})]}),(0,c.jsxs)("div",{style:{marginBottom:15,paddingBottom:10,borderBottom:"1px solid #333"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,c.jsx)("h2",{style:{margin:0,fontSize:"18px",display:"inline-block"},children:q?"\ud83d\udee0 \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438":"\ud83c\udfac \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442: ".concat(J)}),q&&(0,c.jsx)(PE,{text:"\u0422\u0443\u0442 \u0432\u044b\u0441\u0442\u0430\u044f\u043b\u044f\u044e\u0442\u0441\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438..."})]}),q&&(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px",fontStyle:"italic"},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043c\u0430\u043a\u0435\u0442\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430, \u044d\u0442\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u0432\u0441\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u044b \u043f\u0440\u043e\u0435\u043a\u0442\u0430"})]}),q&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qZ,s(s({title:"\ud83d\udcbe \u041f\u0440\u043e\u0435\u043a\u0442 \u0438 \u0410\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435"},It("autosave")),{},{children:(0,c.jsx)(ZZ,{interval:ee.global_settings.autosave_interval,onUpdateInterval:te,onExport:ne,onImport:re})})),(0,c.jsx)(qZ,s(s({title:"\ud83d\udcfa \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0438 \u0420\u0435\u0436\u0438\u043c"},It("resolution")),{},{children:(0,c.jsx)(I$,{globalSettings:ee.global_settings,onUpdate:oe})})),(0,c.jsx)(qZ,s(s({title:"\ud83d\udccf \u0421\u0435\u0442\u043a\u0430"},It("grid")),{},{children:(0,c.jsx)(A$,{data:ee.global_settings.grid,onUpdate:le})})),(0,c.jsx)(qZ,s(s({title:"\u2699\ufe0f \u041a\u043d\u043e\u043f\u043a\u0430 \u041c\u0435\u043d\u044e (".concat("desktop"===$?"Desktop":"Mobile",")")},It("menu")),{},{children:(0,c.jsx)(z$,{data:pt,resolution:ct,onUpdate:ce})}))]}),(q||"settings"===Q)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(qZ,s(s({title:q?"\ud83c\udd70 \u0428\u0440\u0438\u0444\u0442\u044b \u0438 \u0422\u0435\u043a\u0441\u0442":"\ud83c\udd70 \u0428\u0440\u0438\u0444\u0442\u044b \u0438 \u0422\u0435\u043a\u0441\u0442 \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("fonts")),{},{children:(0,c.jsx)(P$,{scope:q?"global":"local",data:q?ee.global_settings.styles:null===(r=ee.fragments)||void 0===r||null===(o=r[J])||void 0===o?void 0:o.styles,onUpdate:ue,customFonts:gt,layoutMode:$})})),(0,c.jsx)(qZ,s(s({title:q?"\ud83d\udd32 \u0421\u0442\u0438\u043b\u044c \u0411\u043e\u043a\u0441\u0430 \u0422\u0435\u043a\u0441\u0442\u0430":"\ud83d\udd32 \u0421\u0442\u0438\u043b\u044c \u0411\u043e\u043a\u0441\u0430 \u0422\u0435\u043a\u0441\u0442\u0430 \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("text_box")),{},{children:(0,c.jsx)(J$,{mode:"text",scope:q?"global":"local",data:q?ee.global_settings.styles:null===(i=ee.fragments)||void 0===i||null===(a=i[J])||void 0===a?void 0:a.styles,assets:ee.assets,assetsMap:Dt,textures:wt,onUpdate:ue,layoutMode:$,onOpenTextEditor:jt,selectedElementId:ye,currentTextElement:At,onUpdateLayout:Rt,isAnimEnabled:Ft})})),(0,c.jsx)(qZ,s(s({title:q?"\ud83d\udd18 \u0421\u0442\u0438\u043b\u044c \u041a\u043d\u043e\u043f\u043e\u043a":"\ud83d\udd18 \u0421\u0442\u0438\u043b\u044c \u041a\u043d\u043e\u043f\u043e\u043a \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("buttons")),{},{children:(0,c.jsx)(J$,{mode:"buttons",scope:q?"global":"local",data:q?ee.global_settings.styles:null===(l=ee.fragments)||void 0===l||null===(d=l[J])||void 0===d?void 0:d.styles,assets:ee.assets,assetsMap:Dt,textures:wt,objects:(null===(u=ee.assets.sys_objects)||void 0===u?void 0:u.files)||[],activeButtons:ft,onUpdate:ue,layoutMode:$,buttonCount:ht,onUpdateButtonCount:pe,onOpenTextEditor:jt,selectedElementId:ye,currentButtonElement:Ot,onUpdateLayout:Rt,isAnimEnabled:Ft})})),(0,c.jsx)(qZ,s(s({title:q?"\ud83c\udfac \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f (Timeline)":"\ud83c\udfac \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("animation")),{},{children:(0,c.jsx)(sK,{data:fe,onUpdate:ge,currentTime:me,onTimeChange:ve,selectedElementId:ye,layers:xe,showTrajectories:be,setShowTrajectories:Se,textEvents:at})})),(0,c.jsx)(qZ,s(s({title:q?"\u2728 \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0422\u0435\u043a\u0441\u0442\u0430":"\u2728 \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0422\u0435\u043a\u0441\u0442\u0430 \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("text_anim")),{},{children:(0,c.jsx)(lK,{data:q?ee.global_settings.text_animation:s(s({},(null===(p=ee.global_settings)||void 0===p?void 0:p.text_animation)||{}),(null===(h=ee.fragments)||void 0===h||null===(f=h[J])||void 0===f?void 0:f.text_animation)||{}),layers:q?[]:(null===(g=ee.fragments)||void 0===g||null===(m=g[J])||void 0===m?void 0:m.layers)||[],onUpdate:ke,isGlobal:q})})),(0,c.jsx)(qZ,s(s({title:q?"\ud83d\udd0a \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0410\u0443\u0434\u0438\u043e \u0438 \u041c\u0443\u0437\u044b\u043a\u0430":"\ud83d\udd0a \u0410\u0443\u0434\u0438\u043e \u0438 \u041c\u0443\u0437\u044b\u043a\u0430 \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("audio")),{},{children:q?(0,c.jsxs)("div",{style:{marginBottom:15},children:[(0,c.jsx)("div",{style:{fontSize:13,fontWeight:"bold",color:"#aaa",marginBottom:5},children:"\ud83c\udf0d \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u0430 \u0438 \u0437\u0432\u0443\u043a\u043e\u0432"}),(0,c.jsx)(pK,{scope:"global",data:ee.global_settings.audio||{},assets:ee.assets,onUpdate:je})]}):(0,c.jsxs)("div",{style:{marginBottom:15},children:[(0,c.jsx)("div",{style:{fontSize:13,fontWeight:"bold",color:"#aaa",marginBottom:5},children:"\ud83c\udfac \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u043b\u0430\u0439\u0434\u0430"}),(0,c.jsx)(pK,{scope:"local",data:(null===(v=ee.fragments)||void 0===v||null===(y=v[J])||void 0===y?void 0:y.audio)||{},assets:ee.assets,layers:(null===(x=ee.fragments)||void 0===x||null===(b=x[J])||void 0===b?void 0:b.layers)||[],animationEvents:(null===zt||void 0===zt?void 0:zt.events)||[],textEvents:at,onUpdate:je})]})})),(0,c.jsx)(qZ,s(s({title:q?"\ud83d\udcca \u0410\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u0438 \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f":"\ud83d\udcca \u0410\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"},It("attributes")),{},{children:(0,c.jsx)(vK,{scope:q?"global":"local",settings:q?ee.global_settings.stats_settings||{}:(null===(w=ee.fragments)||void 0===w||null===(S=w[J])||void 0===S?void 0:S.stats_settings)||{},onUpdate:_e})})),(0,c.jsxs)("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #333",marginBottom:"20px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,c.jsx)("button",{onClick:Me,style:{width:"100%",padding:"12px",background:"#1a3e1a",color:"#6bff6b",border:"1px solid #4dff4d",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",textTransform:"uppercase",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},onMouseOver:e=>e.currentTarget.style.background="#255a25",onMouseOut:e=>e.currentTarget.style.background="#1a3e1a",children:"\ud83c\udfa5 \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a \u0432\u0438\u0434\u0435\u043e"}),(0,c.jsx)("button",{onClick:he,style:{width:"100%",padding:"12px",background:"#3e1a1a",color:"#ff6b6b",border:"1px solid #ff4d4d",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",textTransform:"uppercase",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},onMouseOver:e=>e.currentTarget.style.background="#5a1e1e",onMouseOut:e=>e.currentTarget.style.background="#3e1a1a",children:"\u26a0 \u0421\u0431\u0440\u043e\u0441 \u0432\u0441\u0435\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a"}),(0,c.jsx)("div",{style:{marginTop:"5px",fontSize:"11px",color:"#777",textAlign:"center",fontStyle:"italic",lineHeight:"1.4"},children:"\u0421\u0431\u0440\u043e\u0441 \u0443\u0434\u0430\u043b\u0438\u0442 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435, \u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442 \u0444\u0430\u0439\u043b\u044b."})]})]}),!q&&"effects"===Q&&(0,c.jsx)("div",{style:{width:"100%",display:"block",marginBottom:"15px"},children:(0,c.jsx)(GK,{isParallaxActive:(null===(k=ee.fragments)||void 0===k||null===(C=k[J])||void 0===C||null===(j=C.effects)||void 0===j||null===(_=j.parallax)||void 0===_?void 0:_.enabled)||!1,toggleParallax:Ae,masterParallax:Ee,onUpdateMaster:(e,t)=>{Te({intensity:e,depth:t}),Ie(e,t)},layers:(null===(E=ee.fragments)||void 0===E||null===(D=E[J])||void 0===D?void 0:D.layers)||[],onUpdateLayerParam:Oe,onToggleLayerOverflow:Re,darknessSettings:null===(M=ee.fragments)||void 0===M||null===(T=M[J])||void 0===T||null===(I=T.effects)||void 0===I?void 0:I.darkness,onUpdateDarkness:ze,noiseSettings:null===(A=ee.fragments)||void 0===A||null===(O=A[J])||void 0===O||null===(R=O.effects)||void 0===R?void 0:R.noise,weatherSettings:mt,onUpdateWeather:Fe,onUpdateNoise:Pe,glitchSettings:null===(z=ee.fragments)||void 0===z||null===(F=z[J])||void 0===F||null===(P=F.effects)||void 0===P?void 0:P.glitch,onUpdateGlitch:Be,transitionSettings:null===(B=ee.fragments)||void 0===B||null===(L=B[J])||void 0===L||null===(N=L.effects)||void 0===N?void 0:N.transition,onUpdateTransition:We,onCopyEffects:ie,onPasteEffects:ae,canPasteEffects:se,choices:Ce,onPreviewTransition:He,sceneLayers:we,colorSettings:xt,sceneLightSettings:st,onUpdateSceneLight:it,handleLayerSelect:$e,selectedElementId:ye,textEvents:at,onUpdateColor:bt,effectControls:null===(U=ee.fragments)||void 0===U||null===(V=U[J])||void 0===V||null===(W=V.effects)||void 0===W?void 0:W.effectControls,onUpdateEffectControls:et,onToggleLayerParallax:de,cameraSettings:vt,onUpdateCamera:yt,currentTime:me,onTimeChange:ve,textureSettings:Ke,onUpdateTexture:Je,textureFiles:wt,assetsMap:Dt,animationData:Le,onUpdateAnimation:Ne,animTime:Ue,onAnimTimeChange:Ve})}),!q&&"layers"===Q&&(0,c.jsx)("div",{style:{width:"100%",display:"block"},children:(0,c.jsx)($L,{layers:Ge,bgImage:null===(H=ee.fragments)||void 0===H||null===(G=H[J])||void 0===G?void 0:G.bg_image,assets:ee.assets,bgFiles:(null===(X=ee.assets)||void 0===X||null===(Y=X.sys_backgrounds)||void 0===Y?void 0:Y.files)||[],assetsMap:Dt,onAddLayer:Xe,onRemoveLayer:Ye,onUpdateLayerParam:Oe,onBgChange:qe,selectedLayerId:ye,selectedIds:Ze,onSelectLayer:$e,presets:dt,onAddCharacter:ut,onAddFolder:tt,onToggleFolderCollapse:nt,onToggleFolderVisibility:rt,onSelectFolder:ot,onReorderLayersWithHierarchy:lt,onReorderLayersSmart:Ct,onPasteLayer:De,onReparentLayer:kt,onOpenCharEditor:St})})]})};var YK=n(6159),qK=n.n(YK),ZK=n(2450);const $K=["src","url","local_path","file_id","bg_image","bg_music","text_box_texture","btn_texture","btn_global_object","click_sound","typing_sound","hover_sound","music_volume_sound","click_sound_override","background","button_texture","video","bg_video","image","music","sound","voice"],KK=async(e,t)=>{if(!e)return null;if(e.startsWith("data:"))return null;let n=e;if(t)if(t[e])n=t[e];else{const r=e.split("/").pop();t[r]&&(n=t[r])}try{const e=await fetch(n,{mode:"cors"});if(!e.ok)throw new Error("Fetch failed: ".concat(e.status));return await e.blob()}catch(M2){return console.warn("[Export] Failed to fetch: ".concat(e),M2),null}},JK=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=n,r.readAsDataURL(e)}),QK=e=>{const t=e.type;return t.includes("audio")?"assets/sys_audio":t.includes("video")?"assets/sys_videos":t.includes("font")?"assets/sys_fonts":t.includes("image")?"assets/sys_images":"assets/misc"},eJ=(e,t)=>{e&&"object"===typeof e&&(Array.isArray(e)?e.forEach(e=>eJ(e,t)):Object.keys(e).forEach(n=>{const r=e[n];$K.includes(n)&&"string"===typeof r&&""!==r.trim()?t.add(r):"btn_objects"===n&&"object"===typeof r?Object.values(r).forEach(e=>{"string"===typeof e&&t.add(e)}):"object"===typeof r&&eJ(r,t)}))},tJ=(e,t)=>{if(!e||!e.sys_fonts)return;const n=e=>{e.forEach(e=>{"folder"===e.type?e.files&&n(e.files):(e.file_id&&t.add(e.file_id),e.local_path&&t.add(e.local_path),e.url&&t.add(e.url))})},r=e.sys_fonts.files||e.sys_fonts;Array.isArray(r)&&n(r)},nJ=(e,t)=>{e&&"object"===typeof e&&(Array.isArray(e)?e.forEach(e=>nJ(e,t)):Object.keys(e).forEach(n=>{const r=e[n];if($K.includes(n)&&"string"===typeof r){const o=t(r);o&&(e[n]=o)}else"btn_objects"===n&&"object"===typeof r?Object.keys(r).forEach(e=>{const n=r[e];if("string"===typeof n){const o=t(n);o&&(r[e]=o)}}):"object"===typeof r&&nJ(r,t)}))},rJ=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zip",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=Array.from(document.getElementsByTagName("script")),r=Array.from(document.getElementsByTagName("link"));let o="",i="";for(let a of r)if("stylesheet"===a.rel&&a.href)if(a.href.includes(window.location.hostname))try{const n=await(await fetch(a.href)).text();if("zip"===e){const e="style_".concat(Date.now(),".css");t.file("css/".concat(e),n),o+='<link rel="stylesheet" href="./css/'.concat(e,'">\n')}else o+="<style>\n".concat(n,"\n</style>\n")}catch(M2){}else o+='<link rel="stylesheet" href="'.concat(a.href,'">\n');for(let a of n)if(a.src&&a.src.includes(window.location.hostname)&&!a.src.includes("hot-update"))try{const n=await(await fetch(a.src)).blob();if("zip"===e){const e=a.src.split("/").pop().split("?")[0];t.file("js/".concat(e),n),i+='<script defer src="./js/'.concat(e,'"><\/script>\n')}else{const e=(await n.text()).replace(/<\/script>/g,"<\\/script>");i+="<script defer>".concat(e,"<\/script>\n")}}catch(M2){}return{headHtml:o,bodyHtml:i}},oJ=async function(e,t,n){var r;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!n||!t)return;a&&a("\ud83d\udce6 \u0421\u0431\u043e\u0440\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432...");const l=new(qK()),c=new Set,d={story:t,visuals:n};eJ(d,c),tJ(o,c);const u=(e=>{const t=new Map,n=(e,r)=>{Array.isArray(e)&&e.forEach(e=>{if(e)if("folder"===e.type||"character_folder"===e.type){const t=(e.name||"Folder").replace(/[\\/:*?"<>|]/g,"_"),o="".concat(r,"/").concat(t);e.files&&n(e.files,o),e.children&&n(e.children,o)}else{let n=e.name||"file_".concat(Date.now());if(n=n.replace(/\.+$/,""),e.extension){const t=e.extension.replace(/^\.+/,"");n.toLowerCase().endsWith(".".concat(t.toLowerCase()))||(n="".concat(n,".").concat(t))}const o="".concat(r,"/").concat(n);e.file_id&&t.set(e.file_id,o),e.local_path&&t.set(e.local_path,o),e.url&&t.set(e.url,o),e.src&&t.set(e.src,o)}})};return e&&Object.keys(e).forEach(t=>{const r=e[t],o="assets/".concat(t),i=Array.isArray(r)?r:r.files||[];n(i,o)}),t})(o),p=new Map,h=new Set;let f=[];s?(f=Array.from(u.keys()),f=f.concat(Array.from(c))):f=Array.from(c);const g=[...new Set(f)];for(let k=0;k<g.length;k+=5){const e=g.slice(k,k+5),t=Math.round(k/g.length*100);a&&a("\ud83d\udce6 \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432: ".concat(t,"% (").concat(k,"/").concat(g.length,")")),await Promise.all(e.map(async e=>{if(h.has(e))return;h.add(e);const t=await KK(e,i);if(!t)return;let n="";if(u.has(e))n=u.get(e);else{const r=QK(t);let o=e.split("/").pop().split("?")[0].replace(/[^a-zA-Z0-9\-_.]/g,"_");if(!o.includes(".")){const e=t.type.split("/")[1]||"dat";o+=".".concat(e)}n="".concat(r,"/").concat(o)}l.file(n,t),p.set(e,"./".concat(n))}))}a&&a("\u2699\ufe0f \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 JSON \u0434\u0430\u043d\u043d\u044b\u0445...");const m=JSON.parse(JSON.stringify(d));nJ(m,e=>p.has(e)?p.get(e):e);const v=null===(r=m.visuals.assets)||void 0===r?void 0:r.sys_fonts;m.visuals.assets={},v&&(m.visuals.assets.sys_fonts=v);const{headHtml:y,bodyHtml:x}=await rJ("zip",l),b="window.IS_OFFLINE_EXPORT = true; window.OFFLINE_GAME_DATA = ".concat(JSON.stringify(m),";");l.file("game_data.js",b);const w='<!DOCTYPE html>\n<html lang="ru">\n<head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />\n    <title>'.concat(t.title||"Visual Novel","</title>\n    <style>body{margin:0;background:#000;overflow:hidden}#root{width:100vw;height:100vh}</style>\n    ").concat(y,'\n</head>\n<body>\n    <div id="root"></div>\n    <script src="./game_data.js"><\/script>\n    ').concat(x,"\n</body>\n</html>");l.file("index.html",w),a&&a("\ud83d\udddc \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f ZIP (\u044d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0437\u0430\u043d\u044f\u0442\u044c \u0432\u0440\u0435\u043c\u044f)...");const S=await l.generateAsync({type:"blob"});a&&a("\u2705 \u0413\u043e\u0442\u043e\u0432\u043e! \u041d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435."),(0,ZK.saveAs)(S,"".concat(t.title||"Project","_Offline.zip"))},iJ="game-assets-v1",aJ=new Set,sJ={isDead:!1,failures:0,THRESHOLD:2,shouldTry:e=>!!e&&((!sJ.isDead||!e.startsWith("http"))&&!aJ.has(e)),recordFailure:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";e&&aJ.add(e),sJ.failures++,console.warn("[CATBOX][FAIL]",e,t,{failures:sJ.failures}),sJ.failures>=sJ.THRESHOLD&&(sJ.isDead||(console.error("\ud83d\udc80 CDN \u043f\u043e\u043c\u0435\u0447\u0435\u043d \u043a\u0430\u043a DEAD"),sJ.isDead=!0))},reset:()=>{sJ.isDead=!1,sJ.failures=0,aJ.clear()},resolveUrl:(e,t)=>e?t?sJ.isDead&&"string"===typeof e&&e.startsWith("http")?(console.warn("[BREAKER BLOCKED] \u0418\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u044e \u0432\u043d\u0435\u0448\u043d\u0438\u0439 URL \u0438\u0437-\u0437\u0430 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438: ".concat(e)),t):aJ.has(e)?t:e:e:t},lJ="https://game-cors-proxy.fumybot.workers.dev/?",cJ=async e=>{if(!e)return!1;const t=lJ+e;if(!sJ.shouldTry(t))return console.info("[CATBOX][SKIP]",t),!1;try{const e=new AbortController,n=setTimeout(()=>e.abort(),2e3),r=await fetch(t,{method:"HEAD",signal:e.signal,headers:{"X-Requested-With":"XMLHttpRequest"}});return clearTimeout(n),console.info("[CATBOX][HEAD OK]",t,{status:r.status,type:r.type}),!0}catch(M2){return console.warn("[CATBOX][HEAD FAIL]",t,M2.name,M2.message),sJ.recordFailure(t,"fetch failed"),!1}},dJ=e=>{const t=new Set;if(!e)return t;const n=e.visuals||{},r=n.global_settings||e.global_settings||{},o=n.fragments||e.fragments||{},i=n.assets||e.assets||{},a=e=>{e&&("string"===typeof e&&t.add(e),"object"===typeof e&&(e.file_id&&t.add(e.file_id),e.src&&t.add(e.src),e.url&&t.add(e.url)))};r.audio&&(a(r.audio.music_volume_sound),a(r.audio.hover_sound),a(r.audio.click_sound),a(r.audio.typing_sound),Array.isArray(r.audio.playlist)&&r.audio.playlist.forEach(e=>a(e.src||e.file_id))),["menu_mobile","menu_desktop"].forEach(e=>{const t=r[e];t&&(a(t.background),a(t.button_texture))}),r.styles&&(a(r.styles.text_box_texture),a(r.styles.btn_texture),a(r.styles.btn_global_object),r.styles.btn_objects&&Object.values(r.styles.btn_objects).forEach(a)),Object.keys(o).forEach(e=>{const t=o[e];var n,r;(a(t.bg_image),a(t.bg_video),a(t.bg_music),t.audio&&(t.audio.music&&a(t.audio.music.src||t.audio.music.file_id),a(t.audio.click_sound_override),Array.isArray(t.audio.sfx)&&t.audio.sfx.forEach(e=>a(e.src||e.file_id))),t.effects)&&(t.effects.darkness&&t.effects.darkness.texture&&a(t.effects.darkness.texture),t.effects.textureOverlay&&t.effects.textureOverlay.url&&a(t.effects.textureOverlay.url),null!==(n=t.effects.colorCorrection)&&void 0!==n&&null!==(r=n.texture)&&void 0!==r&&r.url&&a(t.effects.colorCorrection.texture.url));t.layers&&t.layers.forEach(e=>{a(e.src),a(e.file_id),e.videoSrc&&a(e.videoSrc)}),t.styles&&(a(t.styles.text_box_texture),a(t.styles.btn_texture),a(t.styles.btn_global_object),t.styles.btn_objects&&Object.values(t.styles.btn_objects).forEach(a)),["layout_override_desktop","layout_override_mobile"].forEach(e=>{const n=t[e];n&&(Object.values(n).forEach(e=>{a(e.src),a(e.file_id)}),n.bg_layout&&(a(n.bg_layout.src),a(n.bg_layout.file_id)))}),t.media&&Array.isArray(t.media)&&t.media.forEach(e=>a(e.file_id))});const s=e=>{e&&e.files&&e.files.forEach(e=>{if("folder"===e.type||"character_folder"===e.type)s(e);else{const t=(e.name||"").toLowerCase();(t.endsWith(".ttf")||t.endsWith(".otf")||t.endsWith(".woff")||t.endsWith(".woff2"))&&(a(e.local_path),a(e.url))}})};i.sys_fonts&&s(i.sys_fonts);const l=n.character_presets||e.character_presets||{};return Object.values(l).forEach(e=>{Object.values(e).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{a(e.src),a(e.file_id)})})}),t},uJ=e=>{const t=new Map,n=e=>{if(!e)return null;if(e.startsWith("http")||e.startsWith("data:")||e.startsWith("blob:"))return e;if(window.IS_OFFLINE_EXPORT)return e;let t=e.replace(/\\/g,"/");return t.startsWith("/")||(t="/"+t),t},r=e=>{e&&e.files&&e.files.forEach(e=>{"folder"===e.type||"character_folder"===e.type?r(e):(e=>{if(!e)return;const r=e.file_id||e.local_path||e.src;if(!r)return;const o=e.url||(e.src&&e.src.startsWith("http")?e.src:null),i=e.local_path||(e.src&&!e.src.startsWith("http")?e.src:null),a=n(i);if(t.has(r)){const n=t.get(r);[e.file_id,e.local_path,e.url,e.src].filter(Boolean).forEach(e=>n.aliases.add(e)),!n.local&&a&&(n.local=a)}else t.set(r,{id:r,remote:o,local:a,aliases:new Set([e.file_id,e.local_path,e.url,e.src].filter(Boolean))})})(e)})},o=(e.visuals||{}).assets||e.assets||{};Object.values(o).forEach(r);return dJ(e).forEach(e=>{let r=!1;for(const n of t.values()){if(n.aliases.has(e)){r=!0;break}try{if(n.aliases.has(decodeURIComponent(e))||n.aliases.has(encodeURI(e))){r=!0;break}}catch(M2){}}if(!r){const r=e.startsWith("http"),o=r?null:n(e),i=new Set([e]);o&&(i.add(o),i.add(o.substring(1)),i.add("."+o)),t.set(e,{id:e,remote:r?e:null,local:o,aliases:i})}}),Array.from(t.values())},pJ=e=>new Promise(t=>setTimeout(t,e)),hJ=async(e,t,n)=>{if(window.IS_OFFLINE_EXPORT){console.log("[OFFLINE MODE] Skipping fetch/blob logic. Using direct relative paths.");const r=uJ(e),o={};return r.forEach(e=>{const t=e.local||e.remote;t&&e.aliases.forEach(e=>{o[e]=t;try{o[decodeURIComponent(e)]=t}catch(M2){}})}),t&&t(100,100,"\u0413\u043e\u0442\u043e\u0432\u043e"),void(n&&n(o))}const r="caches"in window;let o=null;if(r)try{o=await caches.open(iJ)}catch(M2){console.warn("[CACHE ERROR]",M2)}const i=uJ(e),a=i.length;let s=0;const l={},c=async e=>{let n=Date.now();const r=e=>{const r=((Date.now()-n)/1e3).toFixed(1);t&&t(s,a,"[".concat(r,"s] ").concat(e))},i=e.id.length>20?"..."+e.id.slice(-20):e.id,c=new Request("https://game-cache/file/".concat(encodeURIComponent(e.id)));let d=null,u=null,p=null,h="network";if(o)try{const e=await o.match(c);e&&(d=e,h="cache",r("[CACHE HIT] ".concat(i)))}catch(M2){}if(!d){const t=sJ.resolveUrl(e.remote,e.local),n=t&&t.startsWith("http"),o=n?lJ+t:t;if(o){"network"===h&&r("[NET CONNECTING] ".concat(i));try{const t=new AbortController,a=setTimeout(()=>t.abort(),6e4),s=await fetch(o,{mode:"cors",referrerPolicy:"no-referrer",signal:t.signal,headers:n?{"X-Requested-With":"XMLHttpRequest"}:{}});if(clearTimeout(a),s.ok)d=s;else if(r("[HTTP ".concat(s.status,"] Error fetching ").concat(i)),n&&e.local){r("[FALLBACK] Trying local path...");const t=await fetch(e.local);t.ok&&(d=t)}}catch(M2){r("[NET ERR] ".concat(M2.name,": ").concat(M2.message))}}}if(d)try{if(u=await d.blob(),u.size>0){if(p=URL.createObjectURL(u),o&&"network"===h)try{await o.put(c,new Response(u,{headers:d.headers}))}catch(g){console.warn("Cache write failed",g)}r("[DONE] ".concat(i," (").concat((u.size/1024).toFixed(1),"KB)"))}else r("[BLOB ZERO] Empty file: ".concat(i))}catch(M2){r("[BLOB FAIL] ".concat(M2.message))}const f=p||e.local||e.remote;f&&e.aliases.forEach(e=>{l[e]=f}),s++,t&&t(s,a,"[LOADED] ".concat(i))};for(let d=0;d<a;d+=4){const e=i.slice(d,d+4);await Promise.all(e.map(c)),d+4<a&&await pJ(50)}n&&n(l)},fJ=async e=>{if("caches"in window)try{const t=await caches.open(iJ),n=Object.entries(e);console.log("[CACHE] Pre-populating ".concat(n.length," files...")),await Promise.all(n.map(async e=>{let[n,r]=e;const o=new Request("https://game-cache/file/".concat(encodeURIComponent(n))),i=new Response(r,{status:200,statusText:"OK",headers:{"Content-Type":r.type||"application/octet-stream","Content-Length":r.size.toString()}});await t.put(o,i)})),console.log("[CACHE] Population complete.")}catch(M2){console.error("[CACHE] Population failed:",M2)}},gJ=(t,n,r,o,i)=>{var a;const[l,c]=(0,e.useState)({}),[d,u]=(0,e.useState)(null),[p,h]=(0,e.useState)({current:0,total:0,statusText:"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f...",logs:[]}),[f,g]=(0,e.useState)(!0),[m,v]=(0,e.useState)(!1),[y,x]=(0,e.useState)(!1),[b,w]=(0,e.useState)(!1),[S,k]=(0,e.useState)(null),C=async e=>{const r=[],o=(e,n)=>{e&&e.files&&e.files.forEach(e=>{if("folder"===e.type||"character_folder"===e.type){const t=n?"".concat(n,"/").concat(e.name):e.name;o(e,t)}else if(e.file_id){const o=(e=>{if(!e||!t)return null;const n="/files/".concat(t,"/"),r=e.indexOf(n);if(-1!==r){const t=e.substring(r+n.length),o=t.lastIndexOf("/");if(o>0)return t.substring(0,o)}return null})(e.local_path)||n;r.push({item:e,targetFolder:o})}})};if(Object.keys(e).forEach(t=>{const n=e[t];o(n,t)}),0===r.length)return!1;h({current:0,total:r.length,statusText:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432..."});let i=!1,a=0;for(let l=0;l<r.length;l+=4){const e=r.slice(l,l+4);await Promise.all(e.map(async e=>{let{item:r,targetFolder:o}=e,l=!1;if(r.url){await cJ(r.url)&&(l=!0)}if(!l)try{const e=await fetch("/api/html/ensure_local/".concat(t,"/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_id:r.file_id,type:r.type||"image",extension:r.extension||"png",target_folder:o})});if(!e.ok)return void console.warn("Server error restoring ".concat(r.name,": ").concat(e.status));const a=await e.json();"ok"===a.status&&a.local_path&&(i=!0,r.local_path=a.local_path)}catch(M2){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438:",r.name,M2)}a++,h(e=>s(s({},e),{},{current:a}))}))}return i};(0,e.useEffect)(()=>{if(!t||!n)return;(async()=>{try{h({current:0,total:100,statusText:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430..."});const[e,r]=await Promise.all([fetch("/api/story/".concat(t,"/").concat(n)).then(e=>e.json()),fetch("/api/html/data/".concat(t,"/").concat(n)).then(e=>e.json())]);r.assets&&await C(r.assets),r.global_settings||(r.global_settings={});const o=PZ(r,e);u(e),k(o),h(e=>s(s({},e),{},{statusText:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u044d\u0448\u0430..."}));await(async e=>{if(!("caches"in window))return!1;try{const t=await caches.open(iJ),n=uJ(e);if(0===n.length)return!0;let r=0;return await Promise.all(n.map(async e=>{const n=new Request("https://game-cache/file/".concat(encodeURIComponent(e.id)));await t.match(n)&&r++})),r>=.95*n.length}catch(M2){return console.warn("Cache check failed:",M2),!1}})(o)?(console.log("[SmartLoad] Assets found in cache. Skipping source selection."),j(o)):w(!0)}catch(e){console.error(e),h({current:0,total:0,statusText:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438!"})}})()},[t,n]);const j=e=>{o(e),w(!1),hJ(e,(e,t,n)=>{h(r=>({current:e,total:t,statusText:"".concat(Math.round(e/t*100),"%"),logs:[...r.logs||[],n].slice(-50)}))},e=>{c(e),g(!1)})},_=e=>{const t={},n={},r=e=>{e&&e.files&&e.files.forEach(e=>{if("folder"===e.type||"character_folder"===e.type)r(e);else{const r=e.file_id;if(!r)return;if(e.local_path){t[e.local_path]=r;const n=e.local_path.replace(/\\/g,"/");t[n]=r,n.startsWith("/")?t[n.substring(1)]=r:t["/"+n]=r}const o=e.name||(e.local_path?e.local_path.split("/").pop():null);if(o&&(n[o.toLowerCase()]=r),e.src&&"string"===typeof e.src&&!e.src.startsWith("data:")){const t=e.src.split("/").pop().split("?")[0];t&&(n[t.toLowerCase()]=r)}}})};return Object.values(e).forEach(r),{fullMap:t,filenameMap:n}},E=async function(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||r;if(o){v(!0);try{await fetch("/api/html/data/".concat(t,"/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),e||alert("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e!")}catch(M2){console.error(M2)}finally{v(!1)}}},D=(0,e.useRef)(r);(0,e.useEffect)(()=>{D.current=r},[r]),(0,e.useEffect)(()=>{var e;const t=null===r||void 0===r||null===(e=r.global_settings)||void 0===e?void 0:e.autosave_interval;if(!t||t<=0)return;const n=setInterval(()=>{D.current&&E(D.current,!0)},60*t*1e3);return()=>clearInterval(n)},[null===r||void 0===r||null===(a=r.global_settings)||void 0===a?void 0:a.autosave_interval]);const M=(e,t)=>{if(!e.files)return null;const n=e.files.map(e=>{if("folder"===e.type||"character_folder"===e.type)return M(e,t);const n=e.file_id&&t.has(e.file_id)||e.local_path&&t.has(e.local_path)||e.url&&t.has(e.url)||e.src&&t.has(e.src),r=(e.name||"").toLowerCase(),o=r.endsWith(".ttf")||r.endsWith(".otf")||r.endsWith(".woff");return n||o?e:null}).filter(Boolean);return 0!==n.length||e.isSystem?s(s({},e),{},{files:n}):null};return{story:d,setStory:u,assetsMap:l,setAssetsMap:c,loadingProgress:p,isResourcesLoading:f,isSaving:m,isExporting:y,saveProjectData:E,runExport:async(e,t)=>{if(d&&r){x(!0),await E(null,!0);try{const o=JSON.parse(JSON.stringify(r)),i="full_zip"===e;if(i)t&&t("\ud83d\udce6 \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u0440\u043e\u0435\u043a\u0442\u0430...");else{const e=dJ(o);if(o.assets){const t={};Object.keys(o.assets).forEach(n=>{const r=o.assets[n];r.isSystem=!0;const i=M(r,e);i&&(t[n]=i)}),o.assets=t}}"zip"===e||i?await oJ(n,d,o,o.assets,l,t,i):"single"===e&&await async function(e,t,n){var r;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5?arguments[5]:void 0;if(!n||!t)return;a&&a("\ud83d\udcc4 \u0410\u043d\u0430\u043b\u0438\u0437 \u0430\u0441\u0441\u0435\u0442\u043e\u0432...");const s=new Set,l={story:t,visuals:n};eJ(l,s),tJ(o,s);const c=new Map,d=new Set,u=Array.from(s);for(let x=0;x<u.length;x+=5){const e=u.slice(x,x+5),t=Math.round(x/u.length*100);a&&a("\ud83d\udcc4 \u041a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 (Base64): ".concat(t,"%")),await Promise.all(e.map(async e=>{if(d.has(e))return;d.add(e);const t=await KK(e,i);if(!t)return;const n=await JK(t);c.set(e,n)}))}a&&a("\ud83d\udcc4 \u0421\u0431\u043e\u0440\u043a\u0430 HTML \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b...");const p=JSON.parse(JSON.stringify(l));nJ(p,e=>c.has(e)?c.get(e):e);const h=null===(r=p.visuals.assets)||void 0===r?void 0:r.sys_fonts;p.visuals.assets={},h&&(p.visuals.assets.sys_fonts=h);const{headHtml:f,bodyHtml:g}=await rJ("single"),m="<script>window.IS_OFFLINE_EXPORT = true; window.OFFLINE_GAME_DATA = ".concat(JSON.stringify(p),";<\/script>"),v='<!DOCTYPE html>\n<html lang="ru">\n<head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />\n    <title>'.concat(t.title||"Visual Novel","</title>\n    <style>body{margin:0;background:#000;overflow:hidden}#root{width:100vw;height:100vh}</style>\n    ").concat(f,'\n</head>\n<body>\n    <div id="root"></div>\n    ').concat(m,"\n    ").concat(g,"\n</body>\n</html>");a&&a("\u2705 \u0413\u043e\u0442\u043e\u0432\u043e! \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 HTML...");const y=new Blob([v],{type:"text/html;charset=utf-8"});(0,ZK.saveAs)(y,"".concat(t.title||"Project","_Single.html"))}(n,d,o,o.assets,l,t)}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0430: "+M2.message)}finally{x(!1)}}},handleImportState:e=>{if(!e)return;const t=new FileReader;t.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!t.global_settings||!t.fragments)return void alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0444\u0430\u0439\u043b.");window.confirm("\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0437\u0430\u043c\u0435\u043d\u0438\u0442 \u0432\u0441\u0435 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c?")&&(o(t),await E(t,!1))}catch(t){console.error(t),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0447\u0442\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}},t.readAsText(e)},handleResetSettings:async()=>{if(window.confirm("\u0412\u041d\u0418\u041c\u0410\u041d\u0418\u0415: \u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0412\u0421\u0415 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438? \u0424\u0430\u0439\u043b\u044b \u043e\u0441\u0442\u0430\u043d\u0443\u0442\u0441\u044f. \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0435\u043b\u044c\u0437\u044f.")){v(!0);try{const e={global_settings:{},fragments:{},assets:r.assets},t=PZ(e,d);o(t),await E(t,!1)}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430: "+M2.message)}finally{v(!1)}}},showAssetSourceModal:b,handleSourceNetwork:()=>{S&&j(S)},handleSourceZip:async e=>{if(e&&S){h({current:0,total:0,statusText:"\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b ZIP...",logs:[]});try{const t=await qK().loadAsync(e),{fullMap:n,filenameMap:r}=_(S.assets),o={},i=Object.keys(t.files),a=uJ(S),l=a.length;let c=0;const d=[];for(const e of i){if(t.files[e].dir)continue;if(e.endsWith(".html")||e.endsWith(".js")||e.endsWith(".css"))continue;let i=e;i.startsWith("assets/")&&(i=i.substring(7)),i=i.replace(/\\/g,"/");const s=i.split("/").pop().toLowerCase();let l=n[i]||n["/"+i];if(l||(l=r[s]),l){const n=await t.files[e].async("blob");o[l]=n,a.forEach(e=>{(e.local||e.remote||e.id).split("/").pop().toLowerCase()===s&&e.id!==l&&(o[e.id]=n)}),c++,d.push(e)}}const u=Object.keys(o).length;if(u<l){const e=a.filter(e=>!o[e.id]).map(e=>(e.local||e.remote||e.id).split("/").pop()).filter((e,t,n)=>n.indexOf(e)===t).slice(0,15),t=l-u,n="\n                        ------------------------------------------------\n                        \ud83d\udd0d \u0414\u0418\u0410\u0413\u041d\u041e\u0421\u0422\u0418\u041a\u0410:\n                        \u041e\u0436\u0438\u0434\u0430\u043b\u043e\u0441\u044c \u0444\u0430\u0439\u043b\u043e\u0432: ".concat(l,"\n                        \u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0432 \u0430\u0440\u0445\u0438\u0432\u0435: ").concat(u,"\n\n                        \u274c \u041d\u0415 \u041d\u0410\u0419\u0414\u0415\u041d\u041e (").concat(t," \u0448\u0442):\n                        ").concat(e.map(e=>"- ".concat(e)).join("\n"),"\n                        ").concat(t>15?"... \u0438 \u0434\u0440\u0443\u0433\u0438\u0435":"","\n\n                        \u2705 \u041f\u0420\u0418\u041c\u0415\u0420\u042b \u0422\u041e\u0413\u041e, \u0427\u0422\u041e \u0415\u0421\u0422\u042c \u0412 ZIP:\n                        ").concat(d.slice(0,5).map(e=>"+ ".concat(e)).join("\n"),"\n                        ...\n                        ------------------------------------------------");console.log(n);if(!window.confirm("\u26a0\ufe0f \u041f\u0420\u041e\u0411\u041b\u0415\u041c\u0410 \u0421\u041e \u0421\u0422\u0420\u0423\u041a\u0422\u0423\u0420\u041e\u0419 \u0410\u0420\u0425\u0418\u0412\u0410\n\n"+"\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0444\u0430\u0439\u043b\u043e\u0432: ".concat(u," \u0438\u0437 ").concat(l,".\n")+"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e: ".concat(t,".\n\n")+"\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432:\n".concat(e.join(", "),"\n\n")+"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 OK, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0442\u043e, \u0447\u0442\u043e \u0435\u0441\u0442\u044c (\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0438\u0437 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0430).\n\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u041e\u0442\u043c\u0435\u043d\u0430, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432."))return void h({current:0,total:0,statusText:"\u041e\u0442\u043c\u0435\u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c"})}h(e=>s(s({},e),{},{statusText:"\u041a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 ".concat(u," \u0444\u0430\u0439\u043b\u043e\u0432...")})),await fJ(o),j(S)}catch(M2){alert("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0447\u0442\u0435\u043d\u0438\u044f ZIP:\n"+M2.message),console.error(M2)}}},handleSourceFolder:async e=>{if(e&&S){h({current:0,total:0,statusText:"\u0410\u043d\u0430\u043b\u0438\u0437 \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u043f\u0430\u043f\u043a\u0435...",logs:[]});try{const{fullMap:t,filenameMap:n}=_(S.assets),r={},o=uJ(S),i=o.length;let a=0;const l=[];Array.from(e).forEach(e=>{const i=e.webkitRelativePath||e.name,s=e.name.toLowerCase(),c=i.split("/").slice(1).join("/");let d=t[c]||t["/"+c];if(!d&&c.startsWith("assets/")){const e=c.substring(7);d=t[e]||t["/"+e]}d||(d=n[s]),d&&(r[d]=e,o.forEach(t=>{(t.local||t.remote||t.id).split("/").pop().toLowerCase()===s&&t.id!==d&&(r[t.id]=e)}),a++,l.push(i))});const c=Object.keys(r).length;if(c<i){const e=o.filter(e=>!r[e.id]).map(e=>(e.local||e.remote||e.id).split("/").pop()).filter((e,t,n)=>n.indexOf(e)===t).slice(0,15),t=i-c;if(!window.confirm("\u26a0\ufe0f \u0412 \u041f\u0410\u041f\u041a\u0415 \u041d\u0415 \u0425\u0412\u0410\u0422\u0410\u0415\u0422 \u0424\u0410\u0419\u041b\u041e\u0412\n\n"+"\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ".concat(c," \u0438\u0437 ").concat(i,".\n")+"\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442: ".concat(t,".\n\n")+"\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 (\u043f\u0440\u0438\u043c\u0435\u0440\u044b):\n".concat(e.join(", "),"\n\n")+"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 OK, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u0441 \u0442\u0435\u043c, \u0447\u0442\u043e \u0435\u0441\u0442\u044c."))return void h({current:0,total:0,statusText:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0432\u044b\u0431\u043e\u0440\u0430..."})}h(e=>s(s({},e),{},{statusText:"\u041a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 ".concat(c," \u0444\u0430\u0439\u043b\u043e\u0432...")})),await fJ(r),j(S)}catch(M2){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043f\u0430\u043f\u043a\u0438:\n"+M2.message),console.error(M2)}}}}},mJ=(e,t)=>{const n=e.filter(e=>e.parentId===t);if(0===n.length)return{minX:0,minY:0,w:0,h:0,hasContent:!1};let r=1/0,o=1/0,i=-1/0,a=-1/0,s=!1;return n.forEach(t=>{let n=t.x||0,l=t.y||0,c=t.w||0,d=t.h||0;if("folder"===t.type){const r=mJ(e,t.id);r.hasContent&&(n=(t.x||0)+r.minX,l=(t.y||0)+r.minY,c=r.w,d=r.h)}c>0&&d>0&&(s=!0,n<r&&(r=n),l<o&&(o=l),n+c>i&&(i=n+c),l+d>a&&(a=l+d))}),s?{minX:r,minY:o,w:i-r,h:a-o,hasContent:!0}:{minX:0,minY:0,w:100,h:100,hasContent:!1}},vJ=(e,t)=>{const n=e.find(e=>e.id===t);if(!n)return;console.log("[AddLayer-Recalc] Folder ".concat(n.name," (").concat(n.id,") BEFORE: x=").concat(n.x,", y=").concat(n.y,", w=").concat(n.w,", h=").concat(n.h));const r=e.filter(e=>e.parentId===t);if(0===r.length)return n.w=100,void(n.h=100);let o=1/0,i=1/0,a=-1/0,s=-1/0;if(r.forEach(e=>{const t=e.x||0,n=e.y||0,r=e.w||0,l=e.h||0;t<o&&(o=t),n<i&&(i=n),t+r>a&&(a=t+r),n+l>s&&(s=n+l)}),o===1/0)return;const l=o,c=i;console.log("[AddLayer-Recalc] Shift Detected: dx=".concat(l,", dy=").concat(c)),n.x=(n.x||0)+l,n.y=(n.y||0)+c,n.w=a-o,n.h=s-i,console.log("[AddLayer-Recalc] Folder AFTER: x=".concat(n.x,", y=").concat(n.y,", w=").concat(n.w,", h=").concat(n.h)),r.forEach(e=>{const t=e.x||0,n=e.y||0;e.x=t-l,e.y=n-c,console.log("[AddLayer-Recalc] Child ".concat(e.name," shifted: ").concat(t,",").concat(n," -> ").concat(e.x,",").concat(e.y))}),n.parentId&&vJ(e,n.parentId)},yJ=(e,t)=>{let n=[];const r=e.filter(e=>e.parentId===t);return r.sort((e,t)=>(t.z||0)-(e.z||0)),r.forEach(t=>{n.push(t.id),"folder"===t.type&&(n=[...n,...yJ(e,t.id)])}),n},xJ=e=>{const t=e.filter(e=>!e.parentId).sort((e,t)=>(t.z||0)-(e.z||0)),n=t=>{let r=[];return t.forEach(t=>{r.push(t);const o=e.filter(e=>e.parentId===t.id).sort((e,t)=>(t.z||0)-(e.z||0));o.length>0&&(r=[...r,...n(o)])}),r},r=n(t),o=r.length;r.forEach((e,t)=>{e.z=o-t+4})},bJ=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=[];let i=e;for(;i;)o.unshift(i),i=t.find(e=>e.id===i.parentId);let a={x:0,y:0,rotate:0,scaleX:1,scaleY:1};return o.forEach(e=>{const t=((e,t,n)=>{const r=t[e.id]||{},o=n[e.id]||{};return{x:void 0!==r.x?r.x:void 0!==o.x?o.x:e.x||0,y:void 0!==r.y?r.y:void 0!==o.y?o.y:e.y||0,w:void 0!==r.w?r.w:void 0!==o.w?o.w:e.w||0,h:void 0!==r.h?r.h:void 0!==o.h?o.h:e.h||0,rotate:void 0!==r.rotate?r.rotate:void 0!==o.rotate?o.rotate:e.rotate||0,scaleX:void 0!==r.scaleX?r.scaleX:void 0!==o.scaleX?o.scaleX:e.scaleX||1,scaleY:void 0!==r.scaleY?r.scaleY:void 0!==o.scaleY?o.scaleY:e.scaleY||1}})(e,n,r),o=(a.w||0)/2,i=(a.h||0)/2,s=t.x-o,l=t.y-i,c=s*a.scaleX,d=l*a.scaleY,u=a.rotate*Math.PI/180,p=Math.cos(u),h=Math.sin(u),f=c*p-d*h,g=c*h+d*p;a.x=a.x+o+f,a.y=a.y+i+g,a.rotate+=t.rotate,a.scaleX*=t.scaleX,a.scaleY*=t.scaleY,a.w=t.w,a.h=t.h}),a},wJ=function(t,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=!n,a="mobile"===r?"layout_override_mobile":"layout_override_desktop",l=(0,e.useCallback)(()=>{t(e=>{const t=e.fragments[n];if(!t)return;t.layers||(t.layers=[]);const r=t.layers.reduce((e,t)=>Math.max(e,t.z||0),0),o={id:"folder_".concat(Date.now()),name:"\u041d\u043e\u0432\u0430\u044f \u043f\u0430\u043f\u043a\u0430",type:"folder",visible:!0,collapsed:!1,x:0,y:0,w:0,h:0,opacity:1,z:r+1};t.layers.push(o)})},[t,n]),c=(0,e.useCallback)((e,s)=>{t(t=>{var l;const c=t.fragments[n];if(!c||!c.layers)return;const u=c.layers.findIndex(t=>t.id===e);if(-1===u)return;const p=c.layers[u];if(p.parentId===s)return;const h=p.parentId,f=c[a]||{},g=bJ(p,c.layers,f,o),m=(e=>{const t=f[e.id]||{};return{x:void 0!==t.x?t.x:e.x||0,y:void 0!==t.y?t.y:e.y||0,w:void 0!==t.w?t.w:e.w||0,h:void 0!==t.h?t.h:e.h||0,rotate:void 0!==t.rotate?t.rotate:e.rotate||0,scaleX:void 0!==t.scaleX?t.scaleX:e.scaleX||1,scaleY:void 0!==t.scaleY?t.scaleY:e.scaleY||1}})(p);p.w=m.w,p.h=m.h,c[a]&&c[a][p.id]&&(delete c[a][p.id].x,delete c[a][p.id].y,delete c[a][p.id].w,delete c[a][p.id].h),p.parentId=s;let v=0,y=0;if(s){const e=c.layers.find(e=>e.id===s);if(e){const l=bJ(e,c.layers,f,o),u=((e,t)=>{const n=(t.w||0)/2,r=(t.h||0)/2,o=e.x-(t.x+n),i=e.y-(t.y+r),a=-t.rotate*Math.PI/180,s=Math.cos(a),l=Math.sin(a),c=o*l+i*s;return{x:(o*s-i*l)/(t.scaleX||1)+n,y:c/(t.scaleY||1)+r}})(g,l);v=g.x-u.x,y=g.y-u.y,p.x=u.x,p.y=u.y,p.rotate=g.rotate-l.rotate;const h=c.layers.filter(e=>e.parentId===s&&e.id!==p.id).reduce((e,t)=>Math.max(e,t.z||0),0);p.z=h+1;const m=c.layers.filter(e=>e.parentId===s),{folderUpdates:x,childrenUpdates:b}=HZ(e,m,f,o);Object.assign(e,x),c[a]&&c[a][e.id]&&(delete c[a][e.id].x,delete c[a][e.id].y,delete c[a][e.id].w,delete c[a][e.id].h),m.forEach(e=>{if(b[e.id]){const o=e.x||0,s=e.y||0;e.x=b[e.id].x,e.y=b[e.id].y;const l=o-e.x,u=s-e.y;e.id===p.id?(v+=l,y+=u):d(t,n,e.id,l,u,i,r),c[a]&&c[a][e.id]&&(delete c[a][e.id].x,delete c[a][e.id].y)}}),e.collapsed=!1}}else{const e=p.x||0,t=p.y||0;p.x=g.x,p.y=g.y,p.rotate=g.rotate,v=e-p.x,y=t-p.y;const n=c.layers.filter(e=>!e.parentId&&e.id!==p.id).reduce((e,t)=>Math.max(e,t.z||0),0);p.z=n+1}if(d(t,n,p.id,v,y,i,r),h){const e=c.layers.find(e=>e.id===h);if(e){const s=c.layers.filter(e=>e.parentId===h),{folderUpdates:l,childrenUpdates:u}=HZ(e,s,f,o);Object.assign(e,l),s.forEach(e=>{if(u[e.id]){const o=e.x||0,s=e.y||0;e.x=u[e.id].x,e.y=u[e.id].y;const l=o-e.x,p=s-e.y;d(t,n,e.id,l,p,i,r),c[a]&&c[a][e.id]&&(delete c[a][e.id].x,delete c[a][e.id].y)}})}}const x=null===(l=t.fragments[n])||void 0===l?void 0:l.layers;x&&xJ(x)})},[t,n,r,o]),d=(e,t,n,r,o,i,a)=>{var s,l;if(Math.abs(r)<.01&&Math.abs(o)<.01)return;const c="mobile"===a?"animations_mobile":"animations_desktop",d=i?null===(s=e.global_settings)||void 0===s?void 0:s[c]:null===(l=e.fragments[t])||void 0===l?void 0:l[c];if(d&&d.groups){const e=d.groups.findIndex(e=>e.id===d.activeGroupId);if(-1!==e){let t=d.groups[e];t=WB(t,n,"x",r),t=WB(t,n,"y",o),d.groups[e]=t,console.log("[AnimShift] Adjusted animation for ".concat(n,": dx=").concat(r,", dy=").concat(o))}}};return{addLayer:e=>{n&&t(t=>{t.fragments[n]||(t.fragments[n]={});const r=t.fragments[n];r.layers||(r.layers=[]);(Array.isArray(e)?e:[e]).forEach((e,t)=>{const n=e.name.toLowerCase().endsWith(".mp4"),i={id:"layer_"+Date.now()+"_"+t+"_"+Math.random().toString(36).substr(2,6),type:n?"video":"image",src:e.local_path,name:e.name,x:void 0!==e.x?e.x:100,y:void 0!==e.y?e.y:100,w:300,h:400,z:9999+t,opacity:1,blendMode:"normal",visible:!0,overflowVisible:!1,folderId:e.folderId||void 0,parentId:void 0},a=e.targetParentId||(e.folderId&&!e.folderId.startsWith("sys_")?e.folderId:void 0);if(a&&(i.parentId=a,void 0===e.x&&(i.x=0,i.y=0)),console.log("[AddLayer] Created ".concat(i.id," at ").concat(i.x,",").concat(i.y,". Parent: ").concat(i.parentId)),r.layers.unshift(i),i.parentId){const e=r.layers.find(e=>e.id===i.parentId),t=r.layers.filter(e=>e.parentId===i.parentId);if(e){const{folderUpdates:n,childrenUpdates:r}=HZ(e,t,{},o);Object.assign(e,n),t.forEach(e=>{r[e.id]&&Object.assign(e,r[e.id])})}}}),xJ(r.layers)})},removeLayer:e=>{n&&t(t=>{var r;const o=t.fragments[n];if(o&&o.layers){const t=o.layers.find(t=>t.id===e),n=t?t.parentId:null,r=(e,t)=>{let n=[];return t.filter(t=>t.parentId===e).forEach(e=>{n.push(e.id),n=[...n,...r(e.id,t)]}),n},i=[e,...r(e,o.layers)];o.layers=o.layers.filter(e=>!i.includes(e.id)),n&&vJ(o.layers,n)}null!==(r=t.fragments[n])&&void 0!==r&&r.layers&&xJ(t.fragments[n].layers)})},reorderLayersSmart:(e,r)=>{n&&e!==r&&t(t=>{const o=t.fragments[n];if(!o||!o.layers)return;const i=o.layers.find(t=>t.id===e),a=o.layers.find(e=>e.id===r);if(!i||!a)return;let s;s=(i.z||0)>(a.z||0)?(a.z||0)-.5:(a.z||0)+.5;const l=yJ(o.layers,e),c=[e,...l],d=s-(i.z||0);o.layers.forEach(e=>{c.includes(e.id)&&(e.z=(e.z||0)+d)}),xJ(o.layers)})},reparentLayer:c,addLayerFolder:l,groupLayers:e=>{n&&e&&0!==e.length&&t(t=>{const a=t.fragments[n].layers,s=a.filter(t=>e.includes(t.id));if(0===s.length)return;const l=s[0].parentId,c="mobile"===r?"layout_override_mobile":"layout_override_desktop",d=t.fragments[n][c]||{},u=s.reduce((e,t)=>Math.max(e,t.z||0),0),p="grp_"+Date.now(),h={id:p,type:"folder",name:"\u0413\u0440\u0443\u043f\u043f\u0430",collapsed:!1,visible:!0,x:0,y:0,w:100,h:100,rotate:0,opacity:1,parentId:l,z:u};a.unshift(h),s.forEach(e=>{e.parentId=p});const{folderUpdates:f,childrenUpdates:g}=HZ(h,s,d,o);Object.assign(h,f);const m=f.x,v=f.y;s.forEach(e=>{var o,a;g[e.id]&&(e.x=g[e.id].x,e.y=g[e.id].y);const s="mobile"===r?"animations_mobile":"animations_desktop";let l=i?null===(o=t.global_settings)||void 0===o?void 0:o[s]:null===(a=t.fragments[n])||void 0===a?void 0:a[s];if(l&&l.groups){const t=l.groups.findIndex(e=>e.id===l.activeGroupId);if(-1!==t){let n=l.groups[t];n=WB(n,e.id,"x",m),n=WB(n,e.id,"y",v),l.groups[t]=n}}}),xJ(a)})},toggleFolderCollapse:e=>{n&&t(t=>{const r=t.fragments[n].layers.find(t=>t.id===e);r&&(r.collapsed=!r.collapsed)})},toggleFolderVisibility:e=>{n&&t(t=>{const r=t.fragments[n].layers.find(t=>t.id===e);r&&(r.visible=!r.visible)})},reorderLayersWithHierarchy:e=>{n&&t(t=>{t.fragments[n].layers=e;const r=e.length;e.forEach((e,t)=>{e.z=r-t+10})})},pasteFullLayer:e=>{n&&e&&e.root&&t(t=>{const r=t.fragments[n];r.layers||(r.layers=[]);const{root:o,children:i,params:a}=e,l={},c="copy_"+Date.now()+"_"+Math.random().toString(36).substr(2,5);l[o.id]=c;const d=s(s({},o),{},{id:c,name:o.name+" (Copy)",parentId:void 0,z:9999});a?(void 0!==a.x&&(d.x=a.x+20),void 0!==a.y&&(d.y=a.y+20),void 0!==a.w&&(d.w=a.w),void 0!==a.h&&(d.h=a.h),void 0!==a.rotate&&(d.rotate=a.rotate)):(d.x=(o.x||0)+20,d.y=(o.y||0)+20);const u=[d];i&&i.length>0&&(i.forEach(e=>{const t="copy_"+Date.now()+"_"+Math.random().toString(36).substr(2,5);l[e.id]=t;const n=s(s({},e),{},{id:t});u.push(n)}),u.forEach(e=>{e.parentId&&l[e.parentId]&&(e.parentId=l[e.parentId])})),r.layers=[...u,...r.layers],xJ(r.layers)})},addCharacterToScene:async function(e,r,o,i){var a;let l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!n)return;const d=o.sys_characters,u=null===d||void 0===d||null===(a=d.files)||void 0===a?void 0:a.find(t=>t.id===e);if(!u)return;const p=e=>{let t=[];return e.files&&e.files.forEach(e=>{t.push(e),"folder"!==e.type&&"character_folder"!==e.type||(t=[...t,...p(e)])}),t},h=p(u),f=Date.now(),g="char_".concat(u.name.replace(/[^a-zA-Z0-9]/g,""),"_").concat(f);let m=[];const v=u.presets||{};if(r&&"Default"!==r&&v[r]){let e=[...v[r]];const t={};e.forEach(e=>{t[e.id]=e});const n=e=>{const r=t[e];return!r||!1!==r.visible&&(!r.parentId||n(r.parentId))},o=e.filter(e=>c&&Array.isArray(c)?c.includes(e.id):!l||n(e.id)),i={};o.forEach(e=>{i[e.id]="cl_".concat(f,"_").concat(Math.random().toString(36).substr(2,6))}),m=o.map(e=>{let t=e.src,n=null;"image"===e.type&&(e.file_id&&(n=h.find(t=>t.file_id===e.file_id||t.id===e.file_id)),n||(n=h.find(t=>t.name===e.name||t.name===e.name+".png")),n&&(t=n.local_path));const r=e.parentId&&i[e.parentId]?i[e.parentId]:g;return s(s({},e),{},{id:i[e.id],src:t,file_id:n?n.file_id||n.id:e.file_id,parentId:r,folderId:"sys_characters",z:0})})}else{let e=u.structure||{layers:u.files};if(!e)return;const t=(e,n)=>{var r,o,i,a,s;const d=e.id||e._uniqueId;if(c&&Array.isArray(c)){if(!c.includes(d))return}else if(l&&!1===e.visible)return;const u="cl_".concat(f,"_").concat(Math.random().toString(36).substr(2,6)),p=e.children||e.files||e.layers||[],g=p.length>0;let v=null,y=null;if(!g){let t=null;e.file_id&&(t=h.find(t=>t.file_id===e.file_id||t.id===e.file_id)),t||(t=h.find(t=>t.name===e.name||t.name===e.name+".png")),t?(v=t.local_path,y=t.file_id||t.id):v=e.local_path}m.push({id:u,name:e.name,type:g?"folder":"image",parentId:n,folderId:"sys_characters",visible:!1!==e.visible,opacity:null!==(r=e.opacity)&&void 0!==r?r:1,blendMode:e.blendMode||"normal",x:null!==(o=null!==(i=e.x)&&void 0!==i?i:e.left)&&void 0!==o?o:0,y:null!==(a=null!==(s=e.y)&&void 0!==s?s:e.top)&&void 0!==a?a:0,w:e.width||0,h:e.height||0,rotate:e.rotate||0,src:v,file_id:y,collapsed:!0,z:0}),p.forEach(e=>t(e,u))};(e.layers||e.files||[]).forEach(e=>t(e,g))}await Promise.all(m.map(async e=>{if("image"===e.type&&e.src&&(!e.w||!e.h))try{const t=await new Promise(t=>{const n=new Image;n.onload=()=>t({w:n.naturalWidth,h:n.naturalHeight}),n.onerror=()=>t({w:100,h:100}),n.src=e.src});e.w=t.w,e.h=t.h}catch(M2){}}));const y=mJ(m,g),x=y.hasContent?y.minX:0,b=y.hasContent?y.minY:0,w=y.hasContent?y.w:100,S=y.hasContent?y.h:100,k=m.map(e=>e.parentId===g?s(s({},e),{},{x:(e.x||0)-x,y:(e.y||0)-b}):e),C={id:g,type:"folder",name:"".concat(u.name," ").concat("Default"!==r?"(".concat(r,")"):""),folderId:"sys_characters",collapsed:!0,visible:!0,z:0,opacity:1,x:x,y:b,w:w,h:S,rotate:0};return t(e=>{e.fragments[n]||(e.fragments[n]={});const t=e.fragments[n];t.layers||(t.layers=[]),t.layers=[C,...k,...t.layers];const r=t.layers.length;t.layers.forEach((e,t)=>{e.z=r-t+10})}),g}}},SJ=e=>{let{isOpen:t,isExporting:n,exportStatus:r,onClose:o,onExport:i,storyId:a,userId:s,onToggleBot:l,webgameReady:d}=e;if(!t||!a)return null;const u=window.location.origin,p="".concat(u,"/").concat(s,"_").concat(a,"/html/play"),h="https://t.me/FoxNovel_bot?start=".concat(a),f=e=>{navigator.clipboard.writeText(e),alert("\u0421\u0441\u044b\u043b\u043a\u0430 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430!")};return(0,c.jsxs)("div",{className:"export-modal-overlay",children:[(0,c.jsxs)("div",{className:"export-modal-content",children:[(0,c.jsx)("h2",{style:{marginTop:0,marginBottom:"20px",textAlign:"center"},children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0438 \u042d\u043a\u0441\u043f\u043e\u0440\u0442"}),n?(0,c.jsxs)("div",{style:{textAlign:"center",padding:"30px"},children:[(0,c.jsx)("div",{style:{fontSize:"2rem",marginBottom:"15px"},children:"\u23f3"}),(0,c.jsx)("div",{style:{fontSize:"1.1rem",color:"#ccc"},children:r||"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432..."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{marginBottom:"25px",paddingBottom:"20px",borderBottom:"1px solid #333"},children:[(0,c.jsx)("h3",{style:{fontSize:"1rem",color:"#b388ff",marginTop:0},children:"\ud83d\udd17 \u041f\u0440\u044f\u043c\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 (Web)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"15px"},children:[(0,c.jsx)("input",{readOnly:!0,value:p,className:"link-input"}),(0,c.jsx)("button",{onClick:()=>f(p),className:"copy-btn",children:"\ud83d\udccb"})]}),(0,c.jsxs)("label",{className:"checkbox-label",children:[(0,c.jsx)("input",{type:"checkbox",checked:!!d,onChange:e=>l(e.target.checked),style:{transform:"scale(1.2)"}}),(0,c.jsx)("span",{children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043e\u043d\u043b\u0430\u0439\u043d \u0447\u0435\u0440\u0435\u0437 \u0431\u043e\u0442\u0430"})]}),d&&(0,c.jsxs)("div",{style:{marginTop:"15px",animation:"fadeIn 0.3s"},children:[(0,c.jsx)("div",{style:{fontSize:"0.85rem",color:"#28a745",marginBottom:"5px",fontWeight:"bold"},children:"\ud83e\udd16 \u0421\u0441\u044b\u043b\u043a\u0430 \u0434\u043b\u044f Telegram:"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("input",{readOnly:!0,value:h,className:"link-input bot-link-input"}),(0,c.jsx)("button",{onClick:()=>f(h),className:"copy-btn bot-copy-btn",children:"\ud83d\udccb"})]})]})]}),(0,c.jsx)("h3",{style:{fontSize:"1rem",color:"#ccc",marginTop:0},children:"\ud83d\udce6 \u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0444\u0430\u0439\u043b\u043e\u0432"}),(0,c.jsxs)("div",{className:"export-row",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontWeight:"bold"},children:"Game Build (ZIP)"}),(0,c.jsx)("div",{className:"sub-text",children:"\u0414\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0438\u043d\u0433, itch.io. \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0441\u0431\u043e\u0440\u043a\u0438 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 .exe \u0438\u043b\u0438 apk"})]}),(0,c.jsx)("button",{onClick:()=>i("zip"),className:"download-btn green",children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"})]}),(0,c.jsxs)("div",{className:"export-row border-blue",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontWeight:"bold",color:"#66b3ff"},children:"Source Code (ZIP)"}),(0,c.jsx)("div",{className:"sub-text",children:"\u041f\u043e\u043b\u043d\u044b\u0439 \u0431\u044d\u043a\u0430\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 (JSON + Assets). \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u0435\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430"})]}),(0,c.jsx)("button",{onClick:()=>i("full_zip"),className:"download-btn blue",children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"})]}),(0,c.jsxs)("div",{className:"export-row border-red",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:{fontWeight:"bold",color:"#ff7b7b"},children:"Single HTML"}),(0,c.jsx)("div",{className:"sub-text",children:"\u041e\u0434\u0438\u043d \u0444\u0430\u0439\u043b. \u0412\u0441\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0432\u043d\u0443\u0442\u0440\u0438 (Base64). \u041f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u0438\u0433\u0440 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0447\u0435\u0440\u0435\u0437 \u043e\u0434\u0438\u043d html \u0444\u0430\u0439\u043b"})]}),(0,c.jsx)("button",{onClick:()=>i("single"),className:"download-btn red",children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"20px"},children:(0,c.jsx)("button",{onClick:o,className:"close-btn-outline",children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]})]}),(0,c.jsx)("style",{children:"\n                .export-modal-overlay {\n                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n                    background: rgba(0,0,0,0.8); z-index: 10000;\n                    display: flex; align-items: center; justify-content: center;\n                }\n                .export-modal-content {\n                    background: #1e1e1e; width: 550px; maxWidth: 90%; padding: 25px;\n                    border-radius: 12px; border: 1px solid #444; color: #fff;\n                    box-shadow: 0 10px 40px rgba(0,0,0,0.6); max-height: 90vh; overflow-y: auto;\n                }\n                .link-input {\n                    flex: 1; background: #111; border: 1px solid #444; color: #aaa;\n                    padding: 8px; border-radius: 4px; font-family: monospace;\n                }\n                .copy-btn {\n                    background: #444; border: none; color: #fff; borderRadius: 4px;\n                    cursor: pointer; padding: 0 12px; transition: 0.2s;\n                }\n                .copy-btn:hover { background: #555; }\n                \n                .checkbox-label {\n                    display: flex; align-items: center; gap: 10px; cursor: pointer;\n                    background: #2a2a2a; padding: 12px; border-radius: 6px;\n                    border: 1px solid #333; transition: 0.2s;\n                }\n                .checkbox-label:hover { background: #333; border-color: #555; }\n                \n                .bot-link-input { border-color: #28a745; color: #28a745; background: #1a2e1e; }\n                .bot-copy-btn { background: #28a745; }\n                .bot-copy-btn:hover { background: #218838; }\n\n                .export-row {\n                    margin-bottom: 10px; padding: 12px; background: #2a2a2a;\n                    border-radius: 6px; display: flex; align-items: center;\n                    justify-content: space-between; border: 1px solid transparent;\n                }\n                .border-blue { border-color: #007acc; }\n                .border-red { border-color: #d9534f; }\n                .sub-text { font-size: 0.75rem; color: #888; }\n                \n                .download-btn { color: #fff; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; }\n                .download-btn.green { background: #4CAF50; }\n                .download-btn.blue { background: #007acc; }\n                .download-btn.red { background: #d9534f; }\n                \n                .close-btn-outline {\n                    background: transparent; color: #aaa; border: 1px solid #444;\n                    padding: 10px 20px; border-radius: 4px; cursor: pointer;\n                }\n                .close-btn-outline:hover { border-color: #fff; color: #fff; }\n\n                @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n            "})]})},kJ=e=>{if(!e||0===e.length)return[];const t="dynamic-custom-fonts";let n=document.getElementById(t);n||(n=document.createElement("style"),n.id=t,document.head.appendChild(n));let r="";const o=[];return e.forEach(e=>{let t=e.url||e.src||e.local_path;if(!t||t.includes("/")||t.includes(".")||(t=e.src||e.local_path),t){const n=(e.name?e.name.replace(/\.(ttf|otf|woff|woff2)$/i,""):"CustomFont").trim();t.startsWith("data:")||t.startsWith("http")||t.startsWith("blob:")||(t=t.replace(/\\/g,"/"),t.startsWith("/")||window.IS_OFFLINE_EXPORT||(t="/"+t)),r+='\n                @font-face {\n                    font-family: "'.concat(n,'";\n                    src: url("').concat(t,'");\n                    font-weight: normal;\n                    font-style: normal;\n                    font-display: swap;\n                }\n            '),o.push(n)}}),n.innerHTML=r,o},CJ=["url","timeout","responseType"];var jJ;"p".charCodeAt(0),"H".charCodeAt(0),"Y".charCodeAt(0),"s".charCodeAt(0);const _J="[modern-screenshot]",EJ="undefined"!==typeof window,DJ=EJ&&"Worker"in window,MJ=(EJ&&window,EJ&&window,EJ?null===(jJ=window.navigator)||void 0===jJ?void 0:jJ.userAgent:""),TJ=MJ.includes("Chrome"),IJ=MJ.includes("AppleWebKit")&&!TJ,AJ=MJ.includes("Firefox"),OJ=e=>1===e.nodeType,RJ=e=>"object"===typeof e.className,zJ=e=>"image"===e.tagName,FJ=e=>OJ(e)&&"undefined"!==typeof e.style&&!RJ(e),PJ=e=>8===e.nodeType,BJ=e=>"IMG"===e.tagName,LJ=e=>"VIDEO"===e.tagName,NJ=e=>"SLOT"===e.tagName;function UJ(e){var t;const n=null===e||void 0===e||null===(t=e.createElement)||void 0===t?void 0:t.call(e,"canvas");return n&&(n.height=n.width=1),Boolean(n)&&"toDataURL"in n&&Boolean(n.toDataURL("image/webp").includes("image/webp"))}const VJ=e=>e.startsWith("data:");function WJ(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(EJ&&e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;if(!EJ)return e;const n=HJ().implementation.createHTMLDocument(),r=n.createElement("base"),o=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(o),t&&(r.href=t),o.href=e,o.href}function HJ(e){var t;return null!==(t=e&&OJ(e)?null===e||void 0===e?void 0:e.ownerDocument:e)&&void 0!==t?t:window.document}const GJ="http://www.w3.org/2000/svg";function XJ(e,t,n){const r=HJ(n).createElementNS(GJ,"svg");return r.setAttributeNS(null,"width",e.toString()),r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"viewBox","0 0 ".concat(e," ").concat(t)),r}function YJ(e,t){let n=(new XMLSerializer).serializeToString(e);return t&&(n=n.replace(/[\0-\x08\x0B\f\x0E-\x1F\uD800-\uDFFF\uFFFE\uFFFF]/g,"")),"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n))}function qJ(e,t){return new Promise((n,r)=>{const o=new FileReader;o.onload=()=>n(o.result),o.onerror=()=>r(o.error),o.onabort=()=>r(new Error("Failed read blob to ".concat(t))),"dataUrl"===t?o.readAsDataURL(e):"arrayBuffer"===t&&o.readAsArrayBuffer(e)})}const ZJ=e=>qJ(e,"dataUrl");function $J(e,t){const n=HJ(t).createElement("img");return n.decoding="sync",n.loading="eager",n.src=e,n}function KJ(e,t){return new Promise(n=>{const{timeout:r,ownerDocument:o,onError:i,onWarn:a}=null!==t&&void 0!==t?t:{},s="string"===typeof e?$J(e,HJ(o)):e;let l=null,c=null;function d(){var e;n(s),l&&clearTimeout(l),null===(e=c)||void 0===e||e()}if(r&&(l=setTimeout(d,r)),LJ(s)){const e=s.currentSrc||s.src;if(!e)return s.poster?KJ(s.poster,t).then(n):d();if(s.readyState>=2)return d();const r=d,o=t=>{null===a||void 0===a||a("Failed video load",e,t),null===i||void 0===i||i(t),d()};c=()=>{s.removeEventListener("loadeddata",r),s.removeEventListener("error",o)},s.addEventListener("loadeddata",r,{once:!0}),s.addEventListener("error",o,{once:!0})}else{const e=zJ(s)?s.href.baseVal:s.currentSrc||s.src;if(!e)return d();const t=async()=>{if(BJ(s)&&"decode"in s)try{await s.decode()}catch(t){null===a||void 0===a||a("Failed to decode image, trying to render anyway",s.dataset.originalSrc||e,t)}d()},n=t=>{null===a||void 0===a||a("Failed image load",s.dataset.originalSrc||e,t),d()};if(BJ(s)&&s.complete)return t();c=()=>{s.removeEventListener("load",t),s.removeEventListener("error",n)},s.addEventListener("load",t,{once:!0}),s.addEventListener("error",n,{once:!0})}})}const JJ=function(){let e=0;return()=>(e+=1,"u".concat("0000".concat((Math.random()*36**4|0).toString(36)).slice(-4)).concat(e))}();function QJ(e){return null===e||void 0===e?void 0:e.split(",").map(e=>e.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let eQ=0;function tQ(e){const t="".concat(_J,"[#").concat(eQ,"]");return eQ++,{time:n=>e&&console.time("".concat(t," ").concat(n)),timeEnd:n=>e&&console.timeEnd("".concat(t," ").concat(n)),warn:function(){return e&&function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.warn(_J,...t)}(...arguments)}}}function nQ(e){return{cache:e?"no-cache":"force-cache"}}async function rQ(e,t){return(e=>e&&"__CONTEXT__"in e)(e)?e:async function(e,t){var n,r,o,i,a;const{scale:l=1,workerUrl:c,workerNumber:d=1}=t||{},u=Boolean(null===t||void 0===t?void 0:t.debug),p=null===(n=null===t||void 0===t?void 0:t.features)||void 0===n||n,h=null!==(r=e.ownerDocument)&&void 0!==r?r:EJ?window.document:void 0,f=null!==(o=null===(i=e.ownerDocument)||void 0===i?void 0:i.defaultView)&&void 0!==o?o:EJ?window:void 0,g=new Map,m=s(s({width:0,height:0,quality:1,type:"image/png",scale:l,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:u,fetch:s({requestInit:nQ(null===t||void 0===t||null===(a=t.fetch)||void 0===a?void 0:a.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1},null===t||void 0===t?void 0:t.fetch),fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:d,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1},t),{},{__CONTEXT__:!0,log:tQ(u),node:e,ownerDocument:h,ownerWindow:f,dpi:1===l?null:96*l,svgStyleElement:oQ(h),svgDefsElement:null===h||void 0===h?void 0:h.createElementNS(GJ,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:DJ&&c&&d?d:0})].map(()=>{try{const e=new Worker(c);return e.onmessage=async e=>{const{url:t,result:n}=e.data;var r,o,i,a;n?null===(r=g.get(t))||void 0===r||null===(o=r.resolve)||void 0===o||o.call(r,n):null===(i=g.get(t))||void 0===i||null===(a=i.reject)||void 0===a||a.call(i,new Error("Error receiving message from worker: ".concat(t)))},e.onmessageerror=e=>{var t,n;const{url:r}=e.data;null===(t=g.get(r))||void 0===t||null===(n=t.reject)||void 0===n||n.call(t,new Error("Error receiving message from worker: ".concat(r)))},e}catch(e){return m.log.warn("Failed to new Worker",e),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:"".concat([UJ(h)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(","),";q=0.8"),requests:g,drawImageCount:0,tasks:[],features:p,isEnable:e=>{var t,n;return"restoreScrollPosition"===e?"boolean"!==typeof p&&(null!==(n=p[e])&&void 0!==n&&n):"boolean"===typeof p?p:null===(t=p[e])||void 0===t||t},shadowRoots:[]});m.log.time("wait until load"),await async function(e,t){FJ(e)&&(BJ(e)||LJ(e)?await KJ(e,t):await Promise.all(["img","video"].flatMap(n=>Array.from(e.querySelectorAll(n)).map(e=>KJ(e,t)))))}(e,{timeout:m.timeout,onWarn:m.log.warn}),m.log.timeEnd("wait until load");const{width:v,height:y}=function(e,t){let{width:n,height:r}=t;if(OJ(e)&&(!n||!r)){const t=e.getBoundingClientRect();n=n||t.width||Number(e.getAttribute("width"))||0,r=r||t.height||Number(e.getAttribute("height"))||0}return{width:n,height:r}}(e,m);return m.width=v,m.height=y,m}(e,s(s({},t),{},{autoDestruct:!0}))}function oQ(e){if(!e)return;const t=e.createElement("style"),n=t.ownerDocument.createTextNode("\n.______background-clip--text {\n  background-clip: text;\n  -webkit-background-clip: text;\n}\n");return t.appendChild(n),t}async function iQ(e,t){const{log:n,timeout:r,drawImageCount:o,drawImageInterval:i}=t;n.time("image to canvas");const a=await KJ(e,{timeout:r,onWarn:t.log.warn}),{canvas:s,context2d:l}=function(e,t){const{width:n,height:r,scale:o,backgroundColor:i,maximumCanvasSize:a}=t,s=e.createElement("canvas");s.width=Math.floor(n*o),s.height=Math.floor(r*o),s.style.width="".concat(n,"px"),s.style.height="".concat(r,"px"),a&&(s.width>a||s.height>a)&&(s.width>a&&s.height>a?s.width>s.height?(s.height*=a/s.width,s.width=a):(s.width*=a/s.height,s.height=a):s.width>a?(s.height*=a/s.width,s.width=a):(s.width*=a/s.height,s.height=a));const l=s.getContext("2d");l&&i&&(l.fillStyle=i,l.fillRect(0,0,s.width,s.height));return{canvas:s,context2d:l}}(e.ownerDocument,t),c=()=>{try{null===l||void 0===l||l.drawImage(a,0,0,s.width,s.height)}catch(e){t.log.warn("Failed to drawImage",e)}};if(c(),t.isEnable("fixSvgXmlDecode"))for(let d=0;d<o;d++)await new Promise(e=>{setTimeout(()=>{null===l||void 0===l||l.clearRect(0,0,s.width,s.height),c(),e()},d+i)});return t.drawImageCount=0,n.timeEnd("image to canvas"),s}function aQ(e,t){if(e.ownerDocument)try{const t=e.toDataURL();if("data:,"!==t)return $J(t,e.ownerDocument)}catch(i){t.log.warn("Failed to clone canvas",i)}const n=e.cloneNode(!1),r=e.getContext("2d"),o=n.getContext("2d");try{return r&&o&&o.putImageData(r.getImageData(0,0,e.width,e.height),0,0),n}catch(i){t.log.warn("Failed to clone canvas",i)}return n}function sQ(e,t){return(e=>"CANVAS"===e.tagName)(e)?aQ(e,t):(e=>"IFRAME"===e.tagName)(e)?function(e,t){try{var n;if(null!==e&&void 0!==e&&null!==(n=e.contentDocument)&&void 0!==n&&n.body)return yQ(e.contentDocument.body,t)}catch(r){t.log.warn("Failed to clone iframe",r)}return e.cloneNode(!1)}(e,t):BJ(e)?function(e){const t=e.cloneNode(!1);return e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager"),t}(e):LJ(e)?async function(e,t){if(e.ownerDocument&&!e.currentSrc&&e.poster)return $J(e.poster,e.ownerDocument);const n=e.cloneNode(!1);n.crossOrigin="anonymous",e.currentSrc&&e.currentSrc!==e.src&&(n.src=e.currentSrc);const r=n.ownerDocument;if(r){let i=!0;if(await KJ(n,{onError:()=>i=!1,onWarn:t.log.warn}),!i)return e.poster?$J(e.poster,e.ownerDocument):n;n.currentTime=e.currentTime,await new Promise(e=>{n.addEventListener("seeked",e,{once:!0})});const a=r.createElement("canvas");a.width=e.offsetWidth,a.height=e.offsetHeight;try{const e=a.getContext("2d");e&&e.drawImage(n,0,0,a.width,a.height)}catch(o){return t.log.warn("Failed to clone video",o),e.poster?$J(e.poster,e.ownerDocument):n}return aQ(a,t)}return n}(e,t):e.cloneNode(!1)}const lQ=["width","height","-webkit-text-fill-color"],cQ=["stroke","fill"];function dQ(e,t,n){const{defaultComputedStyles:r}=n,o=e.nodeName.toLowerCase(),i=RJ(e)&&"svg"!==o,a=i?cQ.map(t=>[t,e.getAttribute(t)]).filter(e=>{let[,t]=e;return null!==t}):[],s=[i&&"svg",o,a.map((e,t)=>"".concat(e,"=").concat(t)).join(","),t].filter(Boolean).join(":");if(r.has(s))return r.get(s);const l=function(e){let t=e.sandbox;if(!t){const{ownerDocument:r}=e;try{r&&(t=r.createElement("iframe"),t.id="__SANDBOX__".concat(JJ()),t.width="0",t.height="0",t.style.visibility="hidden",t.style.position="fixed",r.body.appendChild(t),t.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',e.sandbox=t)}catch(n){e.log.warn("Failed to getSandBox",n)}}return t}(n),c=null===l||void 0===l?void 0:l.contentWindow;if(!c)return new Map;const d=null===c||void 0===c?void 0:c.document;let u,p;i?(u=d.createElementNS(GJ,"svg"),p=u.ownerDocument.createElementNS(u.namespaceURI,o),a.forEach(e=>{let[t,n]=e;p.setAttributeNS(null,t,n)}),u.appendChild(p)):u=p=d.createElement(o),p.textContent=" ",d.body.appendChild(u);const h=c.getComputedStyle(p,t),f=new Map;for(let g=h.length,m=0;m<g;m++){const e=h.item(m);lQ.includes(e)||f.set(e,h.getPropertyValue(e))}return d.body.removeChild(u),r.set(s,f),f}function uQ(e,t,n){const r=new Map,o=[],i=new Map;if(n)for(const l of n)s(l);else for(let l=e.length,c=0;c<l;c++){s(e.item(c))}for(let l=o.length,c=0;c<l;c++){var a;null===(a=i.get(o[c]))||void 0===a||a.forEach((e,t)=>r.set(t,e))}function s(n){const a=e.getPropertyValue(n),s=e.getPropertyPriority(n),l=n.lastIndexOf("-"),c=l>-1?n.substring(0,l):void 0;if(c){let e=i.get(c);e||(e=new Map,i.set(c,e)),e.set(n,[a,s])}(t.get(n)!==a||s)&&(c?o.push(c):r.set(n,[a,s]))}return r}const pQ=["::before","::after"],hQ=["::-webkit-scrollbar","::-webkit-scrollbar-button","::-webkit-scrollbar-thumb","::-webkit-scrollbar-track","::-webkit-scrollbar-track-piece","::-webkit-scrollbar-corner","::-webkit-resizer"];const fQ=new Set(["symbol"]);async function gQ(e,t,n,r,o){if(OJ(n)&&((e=>"STYLE"===e.tagName)(n)||(e=>"SCRIPT"===e.tagName)(n)))return;if(r.filter&&!r.filter(n))return;fQ.has(t.nodeName)||fQ.has(n.nodeName)?r.currentParentNodeStyle=void 0:r.currentParentNodeStyle=r.currentNodeStyle;const i=await yQ(n,r,!1,o);r.isEnable("restoreScrollPosition")&&function(e,t){if(!FJ(e)||!FJ(t))return;const{scrollTop:n,scrollLeft:r}=e;if(!n&&!r)return;const{transform:o}=t.style,i=new DOMMatrix(o),{a:a,b:s,c:l,d:c}=i;i.a=1,i.b=0,i.c=0,i.d=1,i.translateSelf(-r,-n),i.a=a,i.b=s,i.c=l,i.d=c,t.style.transform=i.toString()}(e,i),t.appendChild(i)}async function mQ(e,t,n,r){let o=e.firstChild;var i;OJ(e)&&(e.shadowRoot&&(o=null===(i=e.shadowRoot)||void 0===i?void 0:i.firstChild,n.shadowRoots.push(e.shadowRoot)));for(let a=o;a;a=a.nextSibling)if(!PJ(a))if(OJ(a)&&NJ(a)&&"function"===typeof a.assignedNodes){const o=a.assignedNodes();for(let i=0;i<o.length;i++)await gQ(e,t,o[i],n,r)}else await gQ(e,t,a,n,r)}const vQ=/^[\w-:]+$/;async function yQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;const{ownerDocument:o,ownerWindow:i,fontFamilies:a,onCloneEachNode:s}=t;if(o&&(e=>3===e.nodeType)(e))return r&&/\S/.test(e.data)&&r(e.data),o.createTextNode(e.data);if(o&&i&&OJ(e)&&(FJ(e)||RJ(e))){var l,c;const r=await sQ(e,t);if(t.isEnable("removeAbnormalAttributes")){const e=r.getAttributeNames();for(let t=e.length,n=0;n<t;n++){const t=e[n];vQ.test(t)||r.removeAttribute(t)}}const o=t.currentNodeStyle=function(e,t,n,r){var o;const{ownerWindow:i,includeStyleProperties:a,currentParentNodeStyle:s}=r,l=t.style,c=i.getComputedStyle(e),d=dQ(e,null,r);null===s||void 0===s||s.forEach((e,t)=>{d.delete(t)});const u=uQ(c,d,a);var p,h,f;u.delete("transition-property"),u.delete("all"),u.delete("d"),u.delete("content"),n&&(u.delete("margin-top"),u.delete("margin-right"),u.delete("margin-bottom"),u.delete("margin-left"),u.delete("margin-block-start"),u.delete("margin-block-end"),u.delete("margin-inline-start"),u.delete("margin-inline-end"),u.set("box-sizing",["border-box",""])),"text"===(null===(o=u.get("background-clip"))||void 0===o?void 0:o[0])&&t.classList.add("______background-clip--text"),TJ&&(u.has("font-kerning")||u.set("font-kerning",["normal",""]),"hidden"!==(null===(p=u.get("overflow-x"))||void 0===p?void 0:p[0])&&"hidden"!==(null===(h=u.get("overflow-y"))||void 0===h?void 0:h[0])||"ellipsis"!==(null===(f=u.get("text-overflow"))||void 0===f?void 0:f[0])||e.scrollWidth!==e.clientWidth||u.set("text-overflow",["clip",""]));for(let g=l.length,m=0;m<g;m++)l.removeProperty(l.item(m));return u.forEach((e,t)=>{let[n,r]=e;l.setProperty(t,n,r)}),u}(e,r,n,t);n&&function(e,t){const{backgroundColor:n,width:r,height:o,style:i}=t,a=e.style;if(n&&a.setProperty("background-color",n,"important"),r&&a.setProperty("width","".concat(r,"px"),"important"),o&&a.setProperty("height","".concat(o,"px"),"important"),i)for(const s in i)a[s]=i[s]}(r,t);let i=!1;if(t.isEnable("copyScrollbar")){var d,u;const t=[null===(d=o.get("overflow-x"))||void 0===d?void 0:d[0],null===(u=o.get("overflow-y"))||void 0===u?void 0:u[0]];i=t.includes("scroll")||(t.includes("auto")||t.includes("overlay"))&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}const p=null===(l=o.get("text-transform"))||void 0===l?void 0:l[0],h=QJ(null===(c=o.get("font-family"))||void 0===c?void 0:c[0]),f=h?e=>{"uppercase"===p?e=e.toUpperCase():"lowercase"===p?e=e.toLowerCase():"capitalize"===p&&(e=e[0].toUpperCase()+e.substring(1)),h.forEach(t=>{let n=a.get(t);n||a.set(t,n=new Set),e.split("").forEach(e=>n.add(e))})}:void 0;return function(e,t,n,r,o){const{ownerWindow:i,svgStyleElement:a,svgStyles:s,currentNodeStyle:l}=r;function c(n){var a;const c=i.getComputedStyle(e,n);let d=c.getPropertyValue("content");if(!d||"none"===d)return;null===o||void 0===o||o(d),d=d.replace(/(')|(")|(counter\(.+\))/g,"");const u=[JJ()],p=dQ(e,n,r);null===l||void 0===l||l.forEach((e,t)=>{p.delete(t)});const h=uQ(c,p,r.includeStyleProperties);h.delete("content"),h.delete("-webkit-locale"),"text"===(null===(a=h.get("background-clip"))||void 0===a?void 0:a[0])&&t.classList.add("______background-clip--text");const f=["content: '".concat(d,"';")];if(h.forEach((e,t)=>{let[n,r]=e;f.push("".concat(t,": ").concat(n).concat(r?" !important":"",";"))}),1===f.length)return;try{t.className=[t.className,...u].join(" ")}catch(v){return void r.log.warn("Failed to copyPseudoClass",v)}const g=f.join("\n  ");let m=s.get(g);m||(m=[],s.set(g,m)),m.push(".".concat(u[0]).concat(n))}a&&i&&(pQ.forEach(c),n&&hQ.forEach(c))}(e,r,i,t,f),function(e,t){((e=>"TEXTAREA"===e.tagName)(e)||(e=>"INPUT"===e.tagName)(e)||(e=>"SELECT"===e.tagName)(e))&&t.setAttribute("value",e.value)}(e,r),LJ(e)||await mQ(e,r,t,f),await(null===s||void 0===s?void 0:s(r)),r}const p=e.cloneNode(!1);return await mQ(e,p,t),await(null===s||void 0===s?void 0:s(p)),p}function xQ(e,t){const{url:n,requestType:r="text",responseType:o="text",imageDom:i}=t;let a=n;const{timeout:c,acceptOfImage:d,requests:u,fetchFn:p,fetch:{requestInit:h,bypassingCache:f,placeholderImage:g},font:m,workers:v,fontFamilies:y}=e;"image"===r&&(IJ||AJ)&&e.drawImageCount++;let x=u.get(n);if(!x){f&&f instanceof RegExp&&f.test(a)&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());const t=r.startsWith("font")&&m&&m.minify,b=new Set;if(t){r.split(";")[1].split(",").forEach(e=>{y.has(e)&&y.get(e).forEach(e=>b.add(e))})}const w=t&&b.size,S=s({url:a,timeout:c,responseType:w?"arrayBuffer":o,headers:"image"===r?{accept:d}:void 0},h);x={type:r,resolve:void 0,reject:void 0,response:null},x.response=(async()=>{if(p&&"image"===r){const e=await p(n);if(e)return e}return!IJ&&n.startsWith("http")&&v.length?new Promise((e,t)=>{v[u.size&v.length-1].postMessage(s({rawUrl:n},S)),x.resolve=e,x.reject=t}):function(e){const{url:t,timeout:n,responseType:r}=e,o=l(e,CJ),i=new AbortController,a=n?setTimeout(()=>i.abort(),n):void 0;return fetch(t,s({signal:i.signal},o)).then(e=>{if(!e.ok)throw new Error("Failed fetch, not 2xx response",{cause:e});switch(r){case"arrayBuffer":return e.arrayBuffer();case"dataUrl":return e.blob().then(ZJ);default:return e.text()}}).finally(()=>clearTimeout(a))}(S)})().catch(t=>{if(u.delete(n),"image"===r&&g)return e.log.warn("Failed to fetch image base64, trying to use placeholder image",a),"string"===typeof g?g:g(i);throw t}),u.set(n,x)}return x.response}async function bQ(e,t,n,r){if(!wQ(e))return e;for(const[i,a]of function(e,t){const n=[];return e.replace(SQ,(e,r,o)=>(n.push([o,WJ(o,t)]),e)),n.filter(e=>{let[t]=e;return!VJ(t)})}(e,t))try{const t=await xQ(n,{url:a,requestType:r?"image":"text",responseType:"dataUrl"});e=e.replace(kQ(i),"$1".concat(t,"$3"))}catch(o){n.log.warn("Failed to fetch css data url",i,o)}return e}function wQ(e){return/url\((['"]?)([^'"]+?)\1\)/.test(e)}const SQ=/url\((['"]?)([^'"]+?)\1\)/g;function kQ(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp("(url\\(['\"]?)(".concat(t,")(['\"]?\\))"),"g")}const CQ=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function jQ(e,t){const{tasks:n}=t;OJ(e)&&((BJ(e)||zJ(e))&&n.push(...function(e,t){if(BJ(e)){const n=e.currentSrc||e.src;if(!VJ(n))return[xQ(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(t=>{t&&(e.srcset="",e.dataset.originalSrc=n,e.src=t||"")})];(IJ||AJ)&&t.drawImageCount++}else if(RJ(e)&&!VJ(e.href.baseVal)){const n=e.href.baseVal;return[xQ(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(t=>{t&&(e.dataset.originalSrc=n,e.href.baseVal=t||"")})]}return[]}(e,t)),(e=>"use"===e.tagName)(e)&&n.push(...function(e,t){var n;const{ownerDocument:r,svgDefsElement:o}=t,i=null!==(n=e.getAttribute("href"))&&void 0!==n?n:e.getAttribute("xlink:href");if(!i)return[];const[a,s]=i.split("#");if(s){const n="#".concat(s),i=t.shadowRoots.reduce((e,t)=>null!==e&&void 0!==e?e:t.querySelector("svg ".concat(n)),null===r||void 0===r?void 0:r.querySelector("svg ".concat(n)));if(a&&e.setAttribute("href",n),null!==o&&void 0!==o&&o.querySelector(n))return[];if(i)return null===o||void 0===o||o.appendChild(i.cloneNode(!0)),[];if(a)return[xQ(t,{url:a,responseType:"text"}).then(e=>{null===o||void 0===o||o.insertAdjacentHTML("beforeend",e)})]}return[]}(e,t))),FJ(e)&&n.push(...function(e,t){return CQ.map(n=>{const r=e.getPropertyValue(n);return r&&"none"!==r?((IJ||AJ)&&t.drawImageCount++,bQ(r,null,t,!0).then(t=>{t&&r!==t&&e.setProperty(n,t,e.getPropertyPriority(n))})):null}).filter(Boolean)}(e.style,t)),e.childNodes.forEach(e=>{jQ(e,t)})}async function _Q(e,t){const{ownerDocument:n,svgStyleElement:r,fontFamilies:o,fontCssTexts:i,tasks:a,font:s}=t;if(n&&r&&o.size)if(s&&s.cssText){const e=IQ(s.cssText,t);r.appendChild(n.createTextNode("".concat(e,"\n")))}else{const e=Array.from(n.styleSheets).filter(e=>{try{return"cssRules"in e&&Boolean(e.cssRules.length)}catch(n){return t.log.warn("Error while reading CSS rules from ".concat(e.href),n),!1}});await Promise.all(e.flatMap(e=>Array.from(e.cssRules).map(async(n,r)=>{if("CSSImportRule"===n.constructor.name){let i=r+1;const a=n.href;let s="";try{s=await xQ(t,{url:a,requestType:"text",responseType:"text"})}catch(o){t.log.warn("Error fetch remote css import from ".concat(a),o)}const l=s.replace(SQ,(e,t,n)=>e.replace(n,WJ(n,a)));for(const n of function(e){if(null==e)return[];const t=[];let n=e.replace(EQ,"");for(;;){const e=DQ.exec(n);if(!e)break;t.push(e[0])}n=n.replace(DQ,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=r.exec(n);if(e)o.lastIndex=r.lastIndex;else{if(e=o.exec(n),!e)break;r.lastIndex=o.lastIndex}t.push(e[0])}return t}(l))try{e.insertRule(n,n.startsWith("@import")?i+=1:e.cssRules.length)}catch(o){t.log.warn("Error inserting rule from remote css import",{rule:n,error:o})}}})));e.flatMap(e=>Array.from(e.cssRules)).filter(e=>{var t;return"CSSFontFaceRule"===e.constructor.name&&wQ(e.style.getPropertyValue("src"))&&(null===(t=QJ(e.style.getPropertyValue("font-family")))||void 0===t?void 0:t.some(e=>o.has(e)))}).forEach(e=>{const o=e,s=i.get(o.cssText);s?r.appendChild(n.createTextNode("".concat(s,"\n"))):a.push(bQ(o.cssText,o.parentStyleSheet?o.parentStyleSheet.href:null,t).then(e=>{e=IQ(e,t),i.set(o.cssText,e),r.appendChild(n.createTextNode("".concat(e,"\n")))}))})}}const EQ=/(\/\*[\s\S]*?\*\/)/g,DQ=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;const MQ=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,TQ=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function IQ(e,t){const{font:n}=t,r=n?null===n||void 0===n?void 0:n.preferredFormat:void 0;return r?e.replace(TQ,e=>{for(;;){const[t,,n]=MQ.exec(e)||[];if(!n)return"";if(n===r)return"src: ".concat(t,";")}}):e}async function AQ(e,t){const n=await rQ(e,t);if(OJ(n.node)&&RJ(n.node))return n.node;const{ownerDocument:r,log:o,tasks:i,svgStyleElement:a,svgDefsElement:s,svgStyles:l,font:c,progress:d,autoDestruct:u,onCloneNode:p,onEmbedNode:h,onCreateForeignObjectSvg:f}=n;o.time("clone node");const g=await yQ(n.node,n,!0);if(a&&r){let e="";l.forEach((t,n)=>{e+="".concat(t.join(",\n")," {\n  ").concat(n,"\n}\n")}),a.appendChild(r.createTextNode(e))}o.timeEnd("clone node"),await(null===p||void 0===p?void 0:p(g)),!1!==c&&OJ(g)&&(o.time("embed web font"),await _Q(0,n),o.timeEnd("embed web font")),o.time("embed node"),jQ(g,n);const m=i.length;let v=0;null===d||void 0===d||d(v,m),await Promise.all([...Array.from({length:4})].map(async()=>{for(;;){const t=i.pop();if(!t)break;try{await t}catch(e){n.log.warn("Failed to run task",e)}null===d||void 0===d||d(++v,m)}})),o.timeEnd("embed node"),await(null===h||void 0===h?void 0:h(g));const y=function(e,t){const{width:n,height:r}=t,o=XJ(n,r,e.ownerDocument),i=o.ownerDocument.createElementNS(o.namespaceURI,"foreignObject");return i.setAttributeNS(null,"x","0%"),i.setAttributeNS(null,"y","0%"),i.setAttributeNS(null,"width","100%"),i.setAttributeNS(null,"height","100%"),i.append(e),o.appendChild(i),o}(g,n);return s&&y.insertBefore(s,y.children[0]),a&&y.insertBefore(a,y.children[0]),u&&function(e){if(e.ownerDocument=void 0,e.ownerWindow=void 0,e.svgStyleElement=void 0,e.svgDefsElement=void 0,e.svgStyles.clear(),e.defaultComputedStyles.clear(),e.sandbox){try{e.sandbox.remove()}catch(t){e.log.warn("Failed to destroyContext",t)}e.sandbox=void 0}e.workers=[],e.fontFamilies.clear(),e.fontCssTexts.clear(),e.requests.clear(),e.tasks=[],e.shadowRoots=[]}(n),await(null===f||void 0===f?void 0:f(y)),y}async function OQ(e,t){const n=await rQ(e,t),r=await AQ(n),o=YJ(r,n.isEnable("removeControlCharacter"));var i;n.autoDestruct||(n.svgStyleElement=oQ(n.ownerDocument),n.svgDefsElement=null===(i=n.ownerDocument)||void 0===i?void 0:i.createElementNS(GJ,"defs"),n.svgStyles.clear());const a=$J(o,r.ownerDocument);return await iQ(a,n)}var RQ,zQ,FQ,PQ,BQ,LQ,NQ,UQ,VQ=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},WQ=(e,t,n)=>(VQ(e,t,"read from private field"),n?n.call(e):t.get(e)),HQ=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},GQ=(e,t,n,r)=>(VQ(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),XQ=(e,t,n)=>(VQ(e,t,"access private method"),n),YQ=new Uint8Array(8),qQ=new DataView(YQ.buffer),ZQ=e=>[(e%256+256)%256],$Q=e=>(qQ.setUint16(0,e,!1),[YQ[0],YQ[1]]),KQ=e=>(qQ.setInt16(0,e,!1),[YQ[0],YQ[1]]),JQ=e=>(qQ.setUint32(0,e,!1),[YQ[1],YQ[2],YQ[3]]),QQ=e=>(qQ.setUint32(0,e,!1),[YQ[0],YQ[1],YQ[2],YQ[3]]),e0=e=>(qQ.setInt32(0,e,!1),[YQ[0],YQ[1],YQ[2],YQ[3]]),t0=e=>(qQ.setUint32(0,Math.floor(e/2**32),!1),qQ.setUint32(4,e,!1),[YQ[0],YQ[1],YQ[2],YQ[3],YQ[4],YQ[5],YQ[6],YQ[7]]),n0=e=>(qQ.setInt16(0,256*e,!1),[YQ[0],YQ[1]]),r0=e=>(qQ.setInt32(0,65536*e,!1),[YQ[0],YQ[1],YQ[2],YQ[3]]),o0=e=>(qQ.setInt32(0,2**30*e,!1),[YQ[0],YQ[1],YQ[2],YQ[3]]),i0=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Array(e.length).fill(null).map((t,n)=>e.charCodeAt(n));return t&&n.push(0),n},a0=e=>e&&e[e.length-1],s0=e=>{let t;for(let n of e)(!t||n.presentationTimestamp>t.presentationTimestamp)&&(t=n);return t},l0=function(e,t){let n=e*t;return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?Math.round(n):n},c0=e=>{let t=e*(Math.PI/180),n=Math.cos(t),r=Math.sin(t);return[n,r,0,-r,n,0,0,0,1]},d0=c0(0),u0=e=>[r0(e[0]),r0(e[1]),o0(e[2]),r0(e[3]),r0(e[4]),o0(e[5]),r0(e[6]),r0(e[7]),o0(e[8])],p0=e=>e?"object"!==typeof e?e:Array.isArray(e)?e.map(p0):Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,p0(n)]})):e,h0=e=>e>=0&&e<2**32,f0=(e,t,n)=>({type:e,contents:t&&new Uint8Array(t.flat(10)),children:n}),g0=(e,t,n,r,o)=>f0(e,[ZQ(t),JQ(n),null!==r&&void 0!==r?r:[]],o),m0=e=>({type:"mdat",largeSize:e}),v0=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f0("moov",null,[y0(t,e),...e.map(e=>x0(e,t)),n?H0(e):null])},y0=(e,t)=>{let n=l0(Math.max(0,...t.filter(e=>e.samples.length>0).map(e=>{const t=s0(e.samples);return t.presentationTimestamp+t.duration})),l2),r=Math.max(...t.map(e=>e.id))+1,o=!h0(e)||!h0(n),i=o?t0:QQ;return g0("mvhd",+o,0,[i(e),i(e),QQ(l2),i(n),r0(1),n0(1),Array(10).fill(0),u0(d0),Array(24).fill(0),QQ(r)])},x0=(e,t)=>f0("trak",null,[b0(e,t),w0(e,t)]),b0=(e,t)=>{let n,r=s0(e.samples),o=l0(r?r.presentationTimestamp+r.duration:0,l2),i=!h0(t)||!h0(o),a=i?t0:QQ;return n="video"===e.info.type?"number"===typeof e.info.rotation?c0(e.info.rotation):e.info.rotation:d0,g0("tkhd",+i,3,[a(t),a(t),QQ(e.id),QQ(0),a(o),Array(8).fill(0),$Q(0),$Q(0),n0("audio"===e.info.type?1:0),$Q(0),u0(n),r0("video"===e.info.type?e.info.width:0),r0("video"===e.info.type?e.info.height:0)])},w0=(e,t)=>f0("mdia",null,[S0(e,t),k0("video"===e.info.type?"vide":"soun"),C0(e)]),S0=(e,t)=>{let n=s0(e.samples),r=l0(n?n.presentationTimestamp+n.duration:0,e.timescale),o=!h0(t)||!h0(r),i=o?t0:QQ;return g0("mdhd",+o,0,[i(t),i(t),QQ(e.timescale),i(r),$Q(21956),$Q(0)])},k0=e=>g0("hdlr",0,0,[i0("mhlr"),i0(e),QQ(0),QQ(0),QQ(0),i0("mp4-muxer-hdlr",!0)]),C0=e=>f0("minf",null,["video"===e.info.type?j0():_0(),E0(),T0(e)]),j0=()=>g0("vmhd",0,1,[$Q(0),$Q(0),$Q(0),$Q(0)]),_0=()=>g0("smhd",0,0,[$Q(0),$Q(0)]),E0=()=>f0("dinf",null,[D0()]),D0=()=>g0("dref",0,0,[QQ(1)],[M0()]),M0=()=>g0("url ",0,1),T0=e=>{const t=e.compositionTimeOffsetTable.length>1||e.compositionTimeOffsetTable.some(e=>0!==e.sampleCompositionTimeOffset);return f0("stbl",null,[I0(e),B0(e),L0(e),N0(e),U0(e),V0(e),t?W0(e):null])},I0=e=>g0("stsd",0,0,[QQ(1)],["video"===e.info.type?A0(t1[e.info.codec],e):P0(r1[e.info.codec],e)]),A0=(e,t)=>f0(e,[Array(6).fill(0),$Q(1),$Q(0),$Q(0),Array(12).fill(0),$Q(t.info.width),$Q(t.info.height),QQ(4718592),QQ(4718592),QQ(0),$Q(1),Array(32).fill(0),$Q(24),KQ(65535)],[n1[t.info.codec](t),t.info.decoderConfig.colorSpace?F0(t):null]),O0={bt709:1,bt470bg:5,smpte170m:6},R0={bt709:1,smpte170m:6,"iec61966-2-1":13},z0={rgb:0,bt709:1,bt470bg:5,smpte170m:6},F0=e=>f0("colr",[i0("nclx"),$Q(O0[e.info.decoderConfig.colorSpace.primaries]),$Q(R0[e.info.decoderConfig.colorSpace.transfer]),$Q(z0[e.info.decoderConfig.colorSpace.matrix]),ZQ((e.info.decoderConfig.colorSpace.fullRange?1:0)<<7)]),P0=(e,t)=>f0(e,[Array(6).fill(0),$Q(1),$Q(0),$Q(0),QQ(0),$Q(t.info.numberOfChannels),$Q(16),$Q(0),$Q(0),r0(t.info.sampleRate)],[o1[t.info.codec](t)]),B0=e=>g0("stts",0,0,[QQ(e.timeToSampleTable.length),e.timeToSampleTable.map(e=>[QQ(e.sampleCount),QQ(e.sampleDelta)])]),L0=e=>{if(e.samples.every(e=>"key"===e.type))return null;let t=[...e.samples.entries()].filter(e=>{let[,t]=e;return"key"===t.type});return g0("stss",0,0,[QQ(t.length),t.map(e=>{let[t]=e;return QQ(t+1)})])},N0=e=>g0("stsc",0,0,[QQ(e.compactlyCodedChunkTable.length),e.compactlyCodedChunkTable.map(e=>[QQ(e.firstChunk),QQ(e.samplesPerChunk),QQ(1)])]),U0=e=>g0("stsz",0,0,[QQ(0),QQ(e.samples.length),e.samples.map(e=>QQ(e.size))]),V0=e=>e.finalizedChunks.length>0&&a0(e.finalizedChunks).offset>=2**32?g0("co64",0,0,[QQ(e.finalizedChunks.length),e.finalizedChunks.map(e=>t0(e.offset))]):g0("stco",0,0,[QQ(e.finalizedChunks.length),e.finalizedChunks.map(e=>QQ(e.offset))]),W0=e=>g0("ctts",0,0,[QQ(e.compositionTimeOffsetTable.length),e.compositionTimeOffsetTable.map(e=>[QQ(e.sampleCount),QQ(e.sampleCompositionTimeOffset)])]),H0=e=>f0("mvex",null,e.map(G0)),G0=e=>g0("trex",0,0,[QQ(e.id),QQ(1),QQ(0),QQ(0),QQ(0)]),X0=(e,t)=>f0("moof",null,[Y0(e),...t.map(Z0)]),Y0=e=>g0("mfhd",0,0,[QQ(e)]),q0=e=>{let t=0,n=0,r="delta"===e.type;return n|=+r,t|=r?1:2,t<<24|n<<16},Z0=e=>f0("traf",null,[$0(e),K0(e),J0(e)]),$0=e=>{var t;let n=0;n|=8,n|=16,n|=32,n|=131072;let r=null!==(t=e.currentChunk.samples[1])&&void 0!==t?t:e.currentChunk.samples[0],o={duration:r.timescaleUnitsToNextSample,size:r.size,flags:q0(r)};return g0("tfhd",0,131128,[QQ(e.id),QQ(o.duration),QQ(o.size),QQ(o.flags)])},K0=e=>g0("tfdt",1,0,[t0(l0(e.currentChunk.startTimestamp,e.timescale))]),J0=e=>{let t=e.currentChunk.samples.map(e=>e.timescaleUnitsToNextSample),n=e.currentChunk.samples.map(e=>e.size),r=e.currentChunk.samples.map(q0),o=e.currentChunk.samples.map(t=>l0(t.presentationTimestamp-t.decodeTimestamp,e.timescale)),i=new Set(t),a=new Set(n),s=new Set(r),l=new Set(o),c=2===s.size&&r[0]!==r[1],d=i.size>1,u=a.size>1,p=!c&&s.size>1,h=l.size>1||[...l].some(e=>0!==e),f=0;return f|=1,f|=4*+c,f|=256*+d,f|=512*+u,f|=1024*+p,f|=2048*+h,g0("trun",1,f,[QQ(e.currentChunk.samples.length),QQ(e.currentChunk.offset-e.currentChunk.moofOffset||0),c?QQ(r[0]):[],e.currentChunk.samples.map((e,i)=>[d?QQ(t[i]):[],u?QQ(n[i]):[],p?QQ(r[i]):[],h?e0(o[i]):[]])])},Q0=(e,t)=>g0("tfra",1,0,[QQ(e.id),QQ(63),QQ(e.finalizedChunks.length),e.finalizedChunks.map(n=>[t0(l0(n.startTimestamp,e.timescale)),t0(n.moofOffset),QQ(t+1),QQ(1),QQ(1)])]),e1=()=>g0("mfro",0,0,[QQ(0)]),t1={avc:"avc1",hevc:"hvc1",vp9:"vp09",av1:"av01"},n1={avc:e=>e.info.decoderConfig&&f0("avcC",[...new Uint8Array(e.info.decoderConfig.description)]),hevc:e=>e.info.decoderConfig&&f0("hvcC",[...new Uint8Array(e.info.decoderConfig.description)]),vp9:e=>{if(!e.info.decoderConfig)return null;let t=e.info.decoderConfig;if(!t.colorSpace)throw new Error("'colorSpace' is required in the decoder config for VP9.");let n=t.codec.split("."),r=Number(n[1]),o=Number(n[2]),i=0+(Number(n[3])<<4)+Number(t.colorSpace.fullRange);return g0("vpcC",1,0,[ZQ(r),ZQ(o),ZQ(i),ZQ(2),ZQ(2),ZQ(2),$Q(0)])},av1:()=>f0("av1C",[129,0,0,0])},r1={aac:"mp4a",opus:"Opus"},o1={aac:e=>{let t=new Uint8Array(e.info.decoderConfig.description);return g0("esds",0,0,[QQ(58753152),ZQ(32+t.byteLength),$Q(1),ZQ(0),QQ(75530368),ZQ(18+t.byteLength),ZQ(64),ZQ(21),JQ(0),QQ(130071),QQ(130071),QQ(92307584),ZQ(t.byteLength),...t,QQ(109084800),ZQ(1),ZQ(2)])},opus:e=>{var t;let n=3840,r=0;const o=null===(t=e.info.decoderConfig)||void 0===t?void 0:t.description;if(o){if(o.byteLength<18)throw new TypeError("Invalid decoder description provided for Opus; must be at least 18 bytes long.");const e=ArrayBuffer.isView(o)?new DataView(o.buffer,o.byteOffset,o.byteLength):new DataView(o);n=e.getUint16(10,!0),r=e.getInt16(14,!0)}return f0("dOps",[ZQ(0),ZQ(e.info.numberOfChannels),$Q(n),QQ(e.info.sampleRate),n0(r),ZQ(0)])}},i1=(Symbol("isTarget"),class{}),a1=class extends i1{constructor(){super(...arguments),this.buffer=null}},s1=class extends i1{constructor(e){if(super(),this.options=e,"object"!==typeof e)throw new TypeError("StreamTarget requires an options object to be passed to its constructor.");if(e.onData){if("function"!==typeof e.onData)throw new TypeError("options.onData, when provided, must be a function.");if(e.onData.length<2)throw new TypeError("options.onData, when provided, must be a function that takes in at least two arguments (data and position). Ignoring the position argument, which specifies the byte offset at which the data is to be written, can lead to broken outputs.")}if(void 0!==e.chunked&&"boolean"!==typeof e.chunked)throw new TypeError("options.chunked, when provided, must be a boolean.");if(void 0!==e.chunkSize&&(!Number.isInteger(e.chunkSize)||e.chunkSize<1024))throw new TypeError("options.chunkSize, when provided, must be an integer and not smaller than 1024.")}},l1=class extends i1{constructor(e,t){if(super(),this.stream=e,this.options=t,!(e instanceof FileSystemWritableFileStream))throw new TypeError("FileSystemWritableFileStreamTarget requires a FileSystemWritableFileStream instance.");if(void 0!==t&&"object"!==typeof t)throw new TypeError("FileSystemWritableFileStreamTarget's options, when provided, must be an object.");if(t&&void 0!==t.chunkSize&&(!Number.isInteger(t.chunkSize)||t.chunkSize<=0))throw new TypeError("options.chunkSize, when provided, must be a positive integer")}},c1=class{constructor(){this.pos=0,HQ(this,RQ,new Uint8Array(8)),HQ(this,zQ,new DataView(WQ(this,RQ).buffer)),this.offsets=new WeakMap}seek(e){this.pos=e}writeU32(e){WQ(this,zQ).setUint32(0,e,!1),this.write(WQ(this,RQ).subarray(0,4))}writeU64(e){WQ(this,zQ).setUint32(0,Math.floor(e/2**32),!1),WQ(this,zQ).setUint32(4,e,!1),this.write(WQ(this,RQ).subarray(0,8))}writeAscii(e){for(let t=0;t<e.length;t++)WQ(this,zQ).setUint8(t%8,e.charCodeAt(t)),t%8===7&&this.write(WQ(this,RQ));e.length%8!==0&&this.write(WQ(this,RQ).subarray(0,e.length%8))}writeBox(e){if(this.offsets.set(e,this.pos),e.contents&&!e.children){var t;this.writeBoxHeader(e,null!==(t=e.size)&&void 0!==t?t:e.contents.byteLength+8),this.write(e.contents)}else{var n;let t=this.pos;if(this.writeBoxHeader(e,0),e.contents&&this.write(e.contents),e.children)for(let n of e.children)n&&this.writeBox(n);let r=this.pos,o=null!==(n=e.size)&&void 0!==n?n:r-t;this.seek(t),this.writeBoxHeader(e,o),this.seek(r)}}writeBoxHeader(e,t){this.writeU32(e.largeSize?1:t),this.writeAscii(e.type),e.largeSize&&this.writeU64(t)}measureBoxHeader(e){return 8+(e.largeSize?8:0)}patchBox(e){let t=this.pos;this.seek(this.offsets.get(e)),this.writeBox(e),this.seek(t)}measureBox(e){if(e.contents&&!e.children){return this.measureBoxHeader(e)+e.contents.byteLength}{let t=this.measureBoxHeader(e);if(e.contents&&(t+=e.contents.byteLength),e.children)for(let n of e.children)n&&(t+=this.measureBox(n));return t}}};RQ=new WeakMap,zQ=new WeakMap;var d1=class extends c1{constructor(e){super(),HQ(this,NQ),HQ(this,FQ,void 0),HQ(this,PQ,new ArrayBuffer(65536)),HQ(this,BQ,new Uint8Array(WQ(this,PQ))),HQ(this,LQ,0),GQ(this,FQ,e)}write(e){XQ(this,NQ,UQ).call(this,this.pos+e.byteLength),WQ(this,BQ).set(e,this.pos),this.pos+=e.byteLength,GQ(this,LQ,Math.max(WQ(this,LQ),this.pos))}finalize(){XQ(this,NQ,UQ).call(this,this.pos),WQ(this,FQ).buffer=WQ(this,PQ).slice(0,Math.max(WQ(this,LQ),this.pos))}};FQ=new WeakMap,PQ=new WeakMap,BQ=new WeakMap,LQ=new WeakMap,NQ=new WeakSet,UQ=function(e){let t=WQ(this,PQ).byteLength;for(;t<e;)t*=2;if(t===WQ(this,PQ).byteLength)return;let n=new ArrayBuffer(t),r=new Uint8Array(n);r.set(WQ(this,BQ),0),GQ(this,PQ,n),GQ(this,BQ,r)};var u1,p1,h1,f1,g1,m1,v1,y1,x1,b1,w1,S1,k1,C1=class extends c1{constructor(e){var t,n,r,o;super(),HQ(this,m1),HQ(this,y1),HQ(this,b1),HQ(this,S1),HQ(this,u1,void 0),HQ(this,p1,[]),HQ(this,h1,void 0),HQ(this,f1,void 0),HQ(this,g1,[]),GQ(this,u1,e),GQ(this,h1,null!==(t=null===(n=e.options)||void 0===n?void 0:n.chunked)&&void 0!==t&&t),GQ(this,f1,null!==(r=null===(o=e.options)||void 0===o?void 0:o.chunkSize)&&void 0!==r?r:16777216)}write(e){WQ(this,p1).push({data:e.slice(),start:this.pos}),this.pos+=e.byteLength}flush(){if(0===WQ(this,p1).length)return;let e=[],t=[...WQ(this,p1)].sort((e,t)=>e.start-t.start);e.push({start:t[0].start,size:t[0].data.byteLength});for(let o=1;o<t.length;o++){let n=e[e.length-1],r=t[o];r.start<=n.start+n.size?n.size=Math.max(n.size,r.start+r.data.byteLength-n.start):e.push({start:r.start,size:r.data.byteLength})}for(let o of e){o.data=new Uint8Array(o.size);for(let e of WQ(this,p1))o.start<=e.start&&e.start<o.start+o.size&&o.data.set(e.data,e.start-o.start);var n,r;if(WQ(this,h1))XQ(this,m1,v1).call(this,o.data,o.start),XQ(this,S1,k1).call(this);else null===(n=(r=WQ(this,u1).options).onData)||void 0===n||n.call(r,o.data,o.start)}WQ(this,p1).length=0}finalize(){WQ(this,h1)&&XQ(this,S1,k1).call(this,!0)}};u1=new WeakMap,p1=new WeakMap,h1=new WeakMap,f1=new WeakMap,g1=new WeakMap,m1=new WeakSet,v1=function(e,t){let n=WQ(this,g1).findIndex(e=>e.start<=t&&t<e.start+WQ(this,f1));-1===n&&(n=XQ(this,b1,w1).call(this,t));let r=WQ(this,g1)[n],o=t-r.start,i=e.subarray(0,Math.min(WQ(this,f1)-o,e.byteLength));r.data.set(i,o);let a={start:o,end:o+i.byteLength};if(XQ(this,y1,x1).call(this,r,a),0===r.written[0].start&&r.written[0].end===WQ(this,f1)&&(r.shouldFlush=!0),WQ(this,g1).length>2){for(let e=0;e<WQ(this,g1).length-1;e++)WQ(this,g1)[e].shouldFlush=!0;XQ(this,S1,k1).call(this)}i.byteLength<e.byteLength&&XQ(this,m1,v1).call(this,e.subarray(i.byteLength),t+i.byteLength)},y1=new WeakSet,x1=function(e,t){let n=0,r=e.written.length-1,o=-1;for(;n<=r;){let i=Math.floor(n+(r-n+1)/2);e.written[i].start<=t.start?(n=i+1,o=i):r=i-1}for(e.written.splice(o+1,0,t),(-1===o||e.written[o].end<t.start)&&o++;o<e.written.length-1&&e.written[o].end>=e.written[o+1].start;)e.written[o].end=Math.max(e.written[o].end,e.written[o+1].end),e.written.splice(o+1,1)},b1=new WeakSet,w1=function(e){let t={start:Math.floor(e/WQ(this,f1))*WQ(this,f1),data:new Uint8Array(WQ(this,f1)),written:[],shouldFlush:!1};return WQ(this,g1).push(t),WQ(this,g1).sort((e,t)=>e.start-t.start),WQ(this,g1).indexOf(t)},S1=new WeakSet,k1=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(let r=0;r<WQ(this,g1).length;r++){let o=WQ(this,g1)[r];if(o.shouldFlush||e){for(let e of o.written){var t,n;null===(t=(n=WQ(this,u1).options).onData)||void 0===t||t.call(n,o.data.subarray(e.start,e.end),o.start+e.start)}WQ(this,g1).splice(r--,1)}}};var j1,_1,E1,D1,M1,T1,I1,A1,O1,R1,z1,F1,P1,B1,L1,N1,U1,V1,W1,H1,G1,X1,Y1,q1,Z1,$1,K1,J1,Q1,e2,t2,n2,r2,o2,i2,a2,s2=class extends C1{constructor(e){var t;super(new s1({onData:(t,n)=>e.stream.write({type:"write",data:t,position:n}),chunked:!0,chunkSize:null===(t=e.options)||void 0===t?void 0:t.chunkSize}))}},l2=1e3,c2=["avc","hevc","vp9","av1"],d2=["aac","opus"],u2=["strict","offset","cross-track-offset"],p2=class{constructor(e){if(HQ(this,P1),HQ(this,L1),HQ(this,U1),HQ(this,W1),HQ(this,G1),HQ(this,Y1),HQ(this,Z1),HQ(this,K1),HQ(this,Q1),HQ(this,t2),HQ(this,r2),HQ(this,i2),HQ(this,j1,void 0),HQ(this,_1,void 0),HQ(this,E1,void 0),HQ(this,D1,void 0),HQ(this,M1,null),HQ(this,T1,null),HQ(this,I1,Math.floor(Date.now()/1e3)+2082844800),HQ(this,A1,[]),HQ(this,O1,1),HQ(this,R1,[]),HQ(this,z1,[]),HQ(this,F1,!1),XQ(this,P1,B1).call(this,e),e.video=p0(e.video),e.audio=p0(e.audio),e.fastStart=p0(e.fastStart),this.target=e.target,GQ(this,j1,s({firstTimestampBehavior:"strict"},e)),e.target instanceof a1)GQ(this,_1,new d1(e.target));else if(e.target instanceof s1)GQ(this,_1,new C1(e.target));else{if(!(e.target instanceof l1))throw new Error("Invalid target: ".concat(e.target));GQ(this,_1,new s2(e.target))}XQ(this,W1,H1).call(this),XQ(this,L1,N1).call(this)}addVideoChunk(e,t,n,r){if(!(e instanceof EncodedVideoChunk))throw new TypeError("addVideoChunk's first argument (sample) must be of type EncodedVideoChunk.");if(t&&"object"!==typeof t)throw new TypeError("addVideoChunk's second argument (meta), when provided, must be an object.");if(void 0!==n&&(!Number.isFinite(n)||n<0))throw new TypeError("addVideoChunk's third argument (timestamp), when provided, must be a non-negative real number.");if(void 0!==r&&!Number.isFinite(r))throw new TypeError("addVideoChunk's fourth argument (compositionTimeOffset), when provided, must be a real number.");let o=new Uint8Array(e.byteLength);e.copyTo(o),this.addVideoChunkRaw(o,e.type,null!==n&&void 0!==n?n:e.timestamp,e.duration,t,r)}addVideoChunkRaw(e,t,n,r,o,i){if(!(e instanceof Uint8Array))throw new TypeError("addVideoChunkRaw's first argument (data) must be an instance of Uint8Array.");if("key"!==t&&"delta"!==t)throw new TypeError("addVideoChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(n)||n<0)throw new TypeError("addVideoChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(r)||r<0)throw new TypeError("addVideoChunkRaw's fourth argument (duration) must be a non-negative real number.");if(o&&"object"!==typeof o)throw new TypeError("addVideoChunkRaw's fifth argument (meta), when provided, must be an object.");if(void 0!==i&&!Number.isFinite(i))throw new TypeError("addVideoChunkRaw's sixth argument (compositionTimeOffset), when provided, must be a real number.");if(XQ(this,i2,a2).call(this),!WQ(this,j1).video)throw new Error("No video track declared.");if("object"===typeof WQ(this,j1).fastStart&&WQ(this,M1).samples.length===WQ(this,j1).fastStart.expectedVideoChunks)throw new Error("Cannot add more video chunks than specified in 'fastStart' (".concat(WQ(this,j1).fastStart.expectedVideoChunks,")."));let a=XQ(this,Y1,q1).call(this,WQ(this,M1),e,t,n,r,o,i);if("fragmented"===WQ(this,j1).fastStart&&WQ(this,T1)){for(;WQ(this,z1).length>0&&WQ(this,z1)[0].decodeTimestamp<=a.decodeTimestamp;){let e=WQ(this,z1).shift();XQ(this,Z1,$1).call(this,WQ(this,T1),e)}a.decodeTimestamp<=WQ(this,T1).lastDecodeTimestamp?XQ(this,Z1,$1).call(this,WQ(this,M1),a):WQ(this,R1).push(a)}else XQ(this,Z1,$1).call(this,WQ(this,M1),a)}addAudioChunk(e,t,n){if(!(e instanceof EncodedAudioChunk))throw new TypeError("addAudioChunk's first argument (sample) must be of type EncodedAudioChunk.");if(t&&"object"!==typeof t)throw new TypeError("addAudioChunk's second argument (meta), when provided, must be an object.");if(void 0!==n&&(!Number.isFinite(n)||n<0))throw new TypeError("addAudioChunk's third argument (timestamp), when provided, must be a non-negative real number.");let r=new Uint8Array(e.byteLength);e.copyTo(r),this.addAudioChunkRaw(r,e.type,null!==n&&void 0!==n?n:e.timestamp,e.duration,t)}addAudioChunkRaw(e,t,n,r,o){if(!(e instanceof Uint8Array))throw new TypeError("addAudioChunkRaw's first argument (data) must be an instance of Uint8Array.");if("key"!==t&&"delta"!==t)throw new TypeError("addAudioChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(n)||n<0)throw new TypeError("addAudioChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(r)||r<0)throw new TypeError("addAudioChunkRaw's fourth argument (duration) must be a non-negative real number.");if(o&&"object"!==typeof o)throw new TypeError("addAudioChunkRaw's fifth argument (meta), when provided, must be an object.");if(XQ(this,i2,a2).call(this),!WQ(this,j1).audio)throw new Error("No audio track declared.");if("object"===typeof WQ(this,j1).fastStart&&WQ(this,T1).samples.length===WQ(this,j1).fastStart.expectedAudioChunks)throw new Error("Cannot add more audio chunks than specified in 'fastStart' (".concat(WQ(this,j1).fastStart.expectedAudioChunks,")."));let i=XQ(this,Y1,q1).call(this,WQ(this,T1),e,t,n,r,o);if("fragmented"===WQ(this,j1).fastStart&&WQ(this,M1)){for(;WQ(this,R1).length>0&&WQ(this,R1)[0].decodeTimestamp<=i.decodeTimestamp;){let e=WQ(this,R1).shift();XQ(this,Z1,$1).call(this,WQ(this,M1),e)}i.decodeTimestamp<=WQ(this,M1).lastDecodeTimestamp?XQ(this,Z1,$1).call(this,WQ(this,T1),i):WQ(this,z1).push(i)}else XQ(this,Z1,$1).call(this,WQ(this,T1),i)}finalize(){if(WQ(this,F1))throw new Error("Cannot finalize a muxer more than once.");if("fragmented"===WQ(this,j1).fastStart){for(let e of WQ(this,R1))XQ(this,Z1,$1).call(this,WQ(this,M1),e);for(let e of WQ(this,z1))XQ(this,Z1,$1).call(this,WQ(this,T1),e);XQ(this,t2,n2).call(this,!1)}else WQ(this,M1)&&XQ(this,Q1,e2).call(this,WQ(this,M1)),WQ(this,T1)&&XQ(this,Q1,e2).call(this,WQ(this,T1));let e=[WQ(this,M1),WQ(this,T1)].filter(Boolean);if("in-memory"===WQ(this,j1).fastStart){let t;for(let r=0;r<2;r++){let n=v0(e,WQ(this,I1)),r=WQ(this,_1).measureBox(n);t=WQ(this,_1).measureBox(WQ(this,D1));let o=WQ(this,_1).pos+r+t;for(let e of WQ(this,A1)){e.offset=o;for(let{data:n}of e.samples)o+=n.byteLength,t+=n.byteLength}if(o<2**32)break;t>=2**32&&(WQ(this,D1).largeSize=!0)}let n=v0(e,WQ(this,I1));WQ(this,_1).writeBox(n),WQ(this,D1).size=t,WQ(this,_1).writeBox(WQ(this,D1));for(let e of WQ(this,A1))for(let t of e.samples)WQ(this,_1).write(t.data),t.data=null}else if("fragmented"===WQ(this,j1).fastStart){let t=WQ(this,_1).pos,n=(e=>f0("mfra",null,[...e.map(Q0),e1()]))(e);WQ(this,_1).writeBox(n);let r=WQ(this,_1).pos-t;WQ(this,_1).seek(WQ(this,_1).pos-4),WQ(this,_1).writeU32(r)}else{let t=WQ(this,_1).offsets.get(WQ(this,D1)),n=WQ(this,_1).pos-t;WQ(this,D1).size=n,WQ(this,D1).largeSize=n>=2**32,WQ(this,_1).patchBox(WQ(this,D1));let r=v0(e,WQ(this,I1));if("object"===typeof WQ(this,j1).fastStart){WQ(this,_1).seek(WQ(this,E1)),WQ(this,_1).writeBox(r);let e=t-WQ(this,_1).pos;WQ(this,_1).writeBox((e=>({type:"free",size:e}))(e))}else WQ(this,_1).writeBox(r)}XQ(this,r2,o2).call(this),WQ(this,_1).finalize(),GQ(this,F1,!0)}};j1=new WeakMap,_1=new WeakMap,E1=new WeakMap,D1=new WeakMap,M1=new WeakMap,T1=new WeakMap,I1=new WeakMap,A1=new WeakMap,O1=new WeakMap,R1=new WeakMap,z1=new WeakMap,F1=new WeakMap,P1=new WeakSet,B1=function(e){if("object"!==typeof e)throw new TypeError("The muxer requires an options object to be passed to its constructor.");if(!(e.target instanceof i1))throw new TypeError("The target must be provided and an instance of Target.");if(e.video){if(!c2.includes(e.video.codec))throw new TypeError("Unsupported video codec: ".concat(e.video.codec));if(!Number.isInteger(e.video.width)||e.video.width<=0)throw new TypeError("Invalid video width: ".concat(e.video.width,". Must be a positive integer."));if(!Number.isInteger(e.video.height)||e.video.height<=0)throw new TypeError("Invalid video height: ".concat(e.video.height,". Must be a positive integer."));const t=e.video.rotation;if("number"===typeof t&&![0,90,180,270].includes(t))throw new TypeError("Invalid video rotation: ".concat(t,". Has to be 0, 90, 180 or 270."));if(Array.isArray(t)&&(9!==t.length||t.some(e=>"number"!==typeof e)))throw new TypeError("Invalid video transformation matrix: ".concat(t.join()));if(void 0!==e.video.frameRate&&(!Number.isInteger(e.video.frameRate)||e.video.frameRate<=0))throw new TypeError("Invalid video frame rate: ".concat(e.video.frameRate,". Must be a positive integer."))}if(e.audio){if(!d2.includes(e.audio.codec))throw new TypeError("Unsupported audio codec: ".concat(e.audio.codec));if(!Number.isInteger(e.audio.numberOfChannels)||e.audio.numberOfChannels<=0)throw new TypeError("Invalid number of audio channels: ".concat(e.audio.numberOfChannels,". Must be a positive integer."));if(!Number.isInteger(e.audio.sampleRate)||e.audio.sampleRate<=0)throw new TypeError("Invalid audio sample rate: ".concat(e.audio.sampleRate,". Must be a positive integer."))}if(e.firstTimestampBehavior&&!u2.includes(e.firstTimestampBehavior))throw new TypeError("Invalid first timestamp behavior: ".concat(e.firstTimestampBehavior));if("object"===typeof e.fastStart){if(e.video){if(void 0===e.fastStart.expectedVideoChunks)throw new TypeError("'fastStart' is an object but is missing property 'expectedVideoChunks'.");if(!Number.isInteger(e.fastStart.expectedVideoChunks)||e.fastStart.expectedVideoChunks<0)throw new TypeError("'expectedVideoChunks' must be a non-negative integer.")}if(e.audio){if(void 0===e.fastStart.expectedAudioChunks)throw new TypeError("'fastStart' is an object but is missing property 'expectedAudioChunks'.");if(!Number.isInteger(e.fastStart.expectedAudioChunks)||e.fastStart.expectedAudioChunks<0)throw new TypeError("'expectedAudioChunks' must be a non-negative integer.")}}else if(![!1,"in-memory","fragmented"].includes(e.fastStart))throw new TypeError("'fastStart' option must be false, 'in-memory', 'fragmented' or an object.");if(void 0!==e.minFragmentDuration&&(!Number.isFinite(e.minFragmentDuration)||e.minFragmentDuration<0))throw new TypeError("'minFragmentDuration' must be a non-negative number.")},L1=new WeakSet,N1=function(){var e,t;if(WQ(this,_1).writeBox((t={holdsAvc:"avc"===(null===(e=WQ(this,j1).video)||void 0===e?void 0:e.codec),fragmented:"fragmented"===WQ(this,j1).fastStart}).fragmented?f0("ftyp",[i0("iso5"),QQ(512),i0("iso5"),i0("iso6"),i0("mp41")]):f0("ftyp",[i0("isom"),QQ(512),i0("isom"),t.holdsAvc?i0("avc1"):[],i0("mp41")])),GQ(this,E1,WQ(this,_1).pos),"in-memory"===WQ(this,j1).fastStart)GQ(this,D1,m0(!1));else if("fragmented"===WQ(this,j1).fastStart);else{if("object"===typeof WQ(this,j1).fastStart){let e=XQ(this,U1,V1).call(this);WQ(this,_1).seek(WQ(this,_1).pos+e)}GQ(this,D1,m0(!0)),WQ(this,_1).writeBox(WQ(this,D1))}XQ(this,r2,o2).call(this)},U1=new WeakSet,V1=function(){if("object"!==typeof WQ(this,j1).fastStart)return;let e=0,t=[WQ(this,j1).fastStart.expectedVideoChunks,WQ(this,j1).fastStart.expectedAudioChunks];for(let n of t)n&&(e+=8*Math.ceil(2/3*n),e+=4*n,e+=12*Math.ceil(2/3*n),e+=4*n,e+=8*n);return e+=4096,e},W1=new WeakSet,H1=function(){var e,t;WQ(this,j1).video&&GQ(this,M1,{id:1,info:{type:"video",codec:WQ(this,j1).video.codec,width:WQ(this,j1).video.width,height:WQ(this,j1).video.height,rotation:null!==(e=WQ(this,j1).video.rotation)&&void 0!==e?e:0,decoderConfig:null},timescale:null!==(t=WQ(this,j1).video.frameRate)&&void 0!==t?t:57600,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]});if(WQ(this,j1).audio&&(GQ(this,T1,{id:WQ(this,j1).video?2:1,info:{type:"audio",codec:WQ(this,j1).audio.codec,numberOfChannels:WQ(this,j1).audio.numberOfChannels,sampleRate:WQ(this,j1).audio.sampleRate,decoderConfig:null},timescale:WQ(this,j1).audio.sampleRate,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),"aac"===WQ(this,j1).audio.codec)){let e=XQ(this,G1,X1).call(this,2,WQ(this,j1).audio.sampleRate,WQ(this,j1).audio.numberOfChannels);WQ(this,T1).info.decoderConfig={codec:WQ(this,j1).audio.codec,description:e,numberOfChannels:WQ(this,j1).audio.numberOfChannels,sampleRate:WQ(this,j1).audio.sampleRate}}},G1=new WeakSet,X1=function(e,t,n){let r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350].indexOf(t),o=n,i="";i+=e.toString(2).padStart(5,"0"),i+=r.toString(2).padStart(4,"0"),15===r&&(i+=t.toString(2).padStart(24,"0")),i+=o.toString(2).padStart(4,"0");let a=8*Math.ceil(i.length/8);i=i.padEnd(a,"0");let s=new Uint8Array(i.length/8);for(let l=0;l<i.length;l+=8)s[l/8]=parseInt(i.slice(l,l+8),2);return s},Y1=new WeakSet,q1=function(e,t,n,r,o,i,a){let s=r/1e6,l=(r-(null!==a&&void 0!==a?a:0))/1e6,c=o/1e6,d=XQ(this,K1,J1).call(this,s,l,e);return s=d.presentationTimestamp,l=d.decodeTimestamp,null!==i&&void 0!==i&&i.decoderConfig&&(null===e.info.decoderConfig?e.info.decoderConfig=i.decoderConfig:Object.assign(e.info.decoderConfig,i.decoderConfig)),{presentationTimestamp:s,decodeTimestamp:l,duration:c,data:t,size:t.byteLength,type:n,timescaleUnitsToNextSample:l0(c,e.timescale)}},Z1=new WeakSet,$1=function(e,t){"fragmented"!==WQ(this,j1).fastStart&&e.samples.push(t);const n=l0(t.presentationTimestamp-t.decodeTimestamp,e.timescale);if(null!==e.lastTimescaleUnits){let r=l0(t.decodeTimestamp,e.timescale,!1),o=Math.round(r-e.lastTimescaleUnits);if(e.lastTimescaleUnits+=o,e.lastSample.timescaleUnitsToNextSample=o,"fragmented"!==WQ(this,j1).fastStart){let t=a0(e.timeToSampleTable);1===t.sampleCount?(t.sampleDelta=o,t.sampleCount++):t.sampleDelta===o?t.sampleCount++:(t.sampleCount--,e.timeToSampleTable.push({sampleCount:2,sampleDelta:o}));const r=a0(e.compositionTimeOffsetTable);r.sampleCompositionTimeOffset===n?r.sampleCount++:e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:n})}}else e.lastTimescaleUnits=0,"fragmented"!==WQ(this,j1).fastStart&&(e.timeToSampleTable.push({sampleCount:1,sampleDelta:l0(t.duration,e.timescale)}),e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:n}));e.lastSample=t;let r=!1;if(e.currentChunk){let n=t.presentationTimestamp-e.currentChunk.startTimestamp;if("fragmented"===WQ(this,j1).fastStart){var o,i;let a=null!==(o=WQ(this,M1))&&void 0!==o?o:WQ(this,T1);const s=null!==(i=WQ(this,j1).minFragmentDuration)&&void 0!==i?i:1;e===a&&"key"===t.type&&n>=s&&(r=!0,XQ(this,t2,n2).call(this))}else r=n>=.5}else r=!0;r&&(e.currentChunk&&XQ(this,Q1,e2).call(this,e),e.currentChunk={startTimestamp:t.presentationTimestamp,samples:[]}),e.currentChunk.samples.push(t)},K1=new WeakSet,J1=function(e,t,n){const r="strict"===WQ(this,j1).firstTimestampBehavior,o=-1===n.lastDecodeTimestamp;if(r&&o&&0!==t)throw new Error("The first chunk for your media track must have a timestamp of 0 (received DTS=".concat(t,").Non-zero first timestamps are often caused by directly piping frames or audio data from a MediaStreamTrack into the encoder. Their timestamps are typically relative to the age of thedocument, which is probably what you want.\n\nIf you want to offset all timestamps of a track such that the first one is zero, set firstTimestampBehavior: 'offset' in the options.\n"));if("offset"===WQ(this,j1).firstTimestampBehavior||"cross-track-offset"===WQ(this,j1).firstTimestampBehavior){let r;var i,a,s,l;if(void 0===n.firstDecodeTimestamp&&(n.firstDecodeTimestamp=t),"offset"===WQ(this,j1).firstTimestampBehavior)r=n.firstDecodeTimestamp;else r=Math.min(null!==(i=null===(a=WQ(this,M1))||void 0===a?void 0:a.firstDecodeTimestamp)&&void 0!==i?i:1/0,null!==(s=null===(l=WQ(this,T1))||void 0===l?void 0:l.firstDecodeTimestamp)&&void 0!==s?s:1/0);t-=r,e-=r}if(t<n.lastDecodeTimestamp)throw new Error("Timestamps must be monotonically increasing (DTS went from ".concat(1e6*n.lastDecodeTimestamp," to ").concat(1e6*t,")."));return n.lastDecodeTimestamp=t,{presentationTimestamp:e,decodeTimestamp:t}},Q1=new WeakSet,e2=function(e){if("fragmented"===WQ(this,j1).fastStart)throw new Error("Can't finalize individual chunks if 'fastStart' is set to 'fragmented'.");if(e.currentChunk)if(e.finalizedChunks.push(e.currentChunk),WQ(this,A1).push(e.currentChunk),0!==e.compactlyCodedChunkTable.length&&a0(e.compactlyCodedChunkTable).samplesPerChunk===e.currentChunk.samples.length||e.compactlyCodedChunkTable.push({firstChunk:e.finalizedChunks.length,samplesPerChunk:e.currentChunk.samples.length}),"in-memory"!==WQ(this,j1).fastStart){e.currentChunk.offset=WQ(this,_1).pos;for(let t of e.currentChunk.samples)WQ(this,_1).write(t.data),t.data=null;XQ(this,r2,o2).call(this)}else e.currentChunk.offset=0},t2=new WeakSet,n2=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("fragmented"!==WQ(this,j1).fastStart)throw new Error("Can't finalize a fragment unless 'fastStart' is set to 'fragmented'.");let t=[WQ(this,M1),WQ(this,T1)].filter(e=>e&&e.currentChunk);if(0===t.length)return;let n=(r=this,o=O1,{set _(e){GQ(r,o,e,i)},get _(){return WQ(r,o,a)}})._++;var r,o,i,a;if(1===n){let e=v0(t,WQ(this,I1),!0);WQ(this,_1).writeBox(e)}let s=WQ(this,_1).pos,l=X0(n,t);WQ(this,_1).writeBox(l);{let e=m0(!1),n=0;for(let o of t)for(let e of o.currentChunk.samples)n+=e.size;let r=WQ(this,_1).measureBox(e)+n;r>=2**32&&(e.largeSize=!0,r=WQ(this,_1).measureBox(e)+n),e.size=r,WQ(this,_1).writeBox(e)}for(let u of t){u.currentChunk.offset=WQ(this,_1).pos,u.currentChunk.moofOffset=s;for(let e of u.currentChunk.samples)WQ(this,_1).write(e.data),e.data=null}let c=WQ(this,_1).pos;WQ(this,_1).seek(WQ(this,_1).offsets.get(l));let d=X0(n,t);WQ(this,_1).writeBox(d),WQ(this,_1).seek(c);for(let u of t)u.finalizedChunks.push(u.currentChunk),WQ(this,A1).push(u.currentChunk),u.currentChunk=null;e&&XQ(this,r2,o2).call(this)},r2=new WeakSet,o2=function(){WQ(this,_1)instanceof C1&&WQ(this,_1).flush()},i2=new WeakSet,a2=function(){if(WQ(this,F1))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")};const h2={overlay:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.85)",backdropFilter:"blur(5px)",zIndex:12e3,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"'Inter', system-ui, -apple-system, sans-serif"},modal:{backgroundColor:"#1e1e1e",borderRadius:"16px",border:"1px solid #333",boxShadow:"0 20px 50px rgba(0,0,0,0.5)",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden",color:"#e0e0e0"},header:{padding:"20px 24px",borderBottom:"1px solid #333",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#252525"},title:{margin:0,fontSize:"18px",fontWeight:600,color:"#fff"},body:{padding:"24px",display:"flex",flexDirection:"column",gap:"20px",overflowY:"auto"},warningBox:{backgroundColor:"rgba(255, 152, 0, 0.1)",borderLeft:"4px solid #f57c00",padding:"16px",borderRadius:"4px",marginBottom:"10px",display:"flex",gap:"12px",alignItems:"flex-start"},warningText:{fontSize:"14px",color:"#ffb74d",lineHeight:"1.5",margin:0},previewContainer:{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#000",backgroundImage:"radial-gradient(#333 1px, transparent 1px)",backgroundSize:"20px 20px",borderRadius:"8px",border:"1px solid #333",padding:"20px",minHeight:"300px",position:"relative",overflow:"hidden"},controlsGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px",color:"#888",fontWeight:600},input:{backgroundColor:"#2c2c2c",border:"1px solid #444",borderRadius:"6px",padding:"10px 12px",color:"#fff",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},footer:{padding:"20px 24px",backgroundColor:"#252525",borderTop:"1px solid #333",display:"flex",justifyContent:"flex-end",gap:"12px"},btn:{padding:"10px 24px",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:"pointer",border:"none",transition:"all 0.2s"},btnPrimary:{background:"linear-gradient(135deg, #2196f3 0%, #1976d2 100%)",color:"white",boxShadow:"0 4px 15px rgba(33, 150, 243, 0.3)"},btnSecondary:{background:"transparent",border:"1px solid #555",color:"#ccc"},btnDestructive:{background:"#ef5350",color:"white"},progressBarContainer:{width:"100%",height:"8px",backgroundColor:"#333",borderRadius:"4px",overflow:"hidden",marginTop:"10px"},progressBarFill:{height:"100%",backgroundColor:"#2196f3",transition:"width 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}},f2=async()=>{await document.fonts.ready,await new Promise(e=>setTimeout(e,50)),await new Promise(e=>requestAnimationFrame(()=>requestAnimationFrame(e)))},g2=e=>{try{const t=e.getContext("2d");return 0!==t.getImageData(e.width/2,e.height/2,1,1).data[3]}catch(M2){return!0}},m2=async e=>{if(!e)return;const t=Array.from(e.querySelectorAll("img")).map(e=>e.complete&&0!==e.naturalHeight?Promise.resolve():e.src?new Promise(t=>{e.onload=t,e.onerror=()=>t()}):Promise.resolve());await Promise.race([Promise.all(t),new Promise(e=>setTimeout(e,2e3))])},v2=()=>(0,c.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.jsx)("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",stroke:"#ff9800",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M12 8V12",stroke:"#ff9800",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M12 16H12.01",stroke:"#ff9800",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),y2=t=>{let{isOpen:n,onClose:r,sceneElements:o,resolution:i,activeFragmentData:a,computedStyles:l,weatherSettings:d,cameraSettings:u,textAnimSettings:p,animationSettings:h,assetsMap:f,fps:g=60,duration:m=5}=t;const[v,y]=(0,e.useState)(0),[x,b]=(0,e.useState)(""),[w,S]=(0,e.useState)(!1),[k,C]=(0,e.useState)(0),[j,_]=(0,e.useState)(m),[E,D]=(0,e.useState)(g),[M,T]=(0,e.useState)(.5),I=(0,e.useRef)(null),A=(0,e.useRef)(!1),O=e=>e&&null!==f&&void 0!==f&&f[e]?f[e]:e,R=(0,e.useMemo)(()=>o?o.map(e=>s(s({},e),{},{src:O(e.src)})):[],[o,f]),z=(0,e.useMemo)(()=>{if(!l)return{};const e=s({},l);if(["textBoxTexture","btnTexture","btnGlobalObject"].forEach(t=>{e[t]&&(e[t]=O(e[t]))}),e.btnObjects){const t={};Object.keys(e.btnObjects).forEach(n=>{t[n]=O(e.btnObjects[n])}),e.btnObjects=t}return e},[l,f]);(0,e.useEffect)(()=>{if(n){y(0),b("\u0413\u043e\u0442\u043e\u0432 \u043a \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0443"),C(0),A.current=!1,_(m);const e=Math.min(.9*window.innerWidth-100,900),t=Math.min(.5*window.innerHeight,400),n=e/i.width,r=t/i.height;T(.9*Math.min(n,r,1))}},[n,i,m]);return n?(0,c.jsx)("div",{style:h2.overlay,children:(0,c.jsxs)("div",{style:h2.modal,children:[(0,c.jsxs)("div",{style:h2.header,children:[(0,c.jsx)("h3",{style:h2.title,children:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0432\u0438\u0434\u0435\u043e (MP4)"}),!w&&(0,c.jsx)("button",{onClick:r,style:{background:"none",border:"none",color:"#666",fontSize:"24px",cursor:"pointer",padding:0,lineHeight:1},children:"\xd7"})]}),(0,c.jsxs)("div",{style:h2.body,children:[(0,c.jsxs)("div",{style:h2.warningBox,children:[(0,c.jsx)("div",{style:{minWidth:24},children:(0,c.jsx)(v2,{})}),(0,c.jsx)("p",{style:h2.warningText,children:"\u041c\u043e\u0434\u0443\u043b\u044c \u0432 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435. \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043d\u0435 \u0432\u0441\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b \u043e\u0448\u0438\u0431\u043a\u0438. \u0415\u0441\u043b\u0438 \u043c\u043e\u0449\u043d\u043e\u0441\u0442\u044c \u0432\u0430\u0448\u0435\u0433\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 - \u043b\u0443\u0447\u0448\u0435 \u0437\u0430\u0445\u0432\u0430\u0442\u0438\u0442\u0435 \u0432\u0438\u0434\u0435\u043e \u0441 \u044d\u043a\u0440\u0430\u043d\u0430 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u043c\u0438 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438."})]}),(0,c.jsx)("div",{style:h2.previewContainer,children:(0,c.jsx)("div",{style:{width:i.width,height:i.height,transform:"scale(".concat(M,")"),transformOrigin:"center center",boxShadow:"0 0 20px rgba(0,0,0,0.5)"},children:(0,c.jsx)("div",{ref:I,style:{width:"100%",height:"100%",background:"transparent"},children:(0,c.jsx)(RL,{isRendering:w,currentTime:k,cameraLinearTime:k,globalEffectTime:k,elements:R,activeFragmentData:a,resolution:i,isGlobal:!1,isEditor:!1,computedStyles:z,weatherSettings:d,cameraSettings:u,textAnimSettings:p,animationSettings:h,assetsMap:f,gameAreaBg:"transparent"})})})}),w?(0,c.jsxs)("div",{style:{textAlign:"center",padding:"10px 0"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5,fontSize:14,color:"#ccc"},children:[(0,c.jsx)("span",{children:x}),(0,c.jsxs)("span",{children:[v,"%"]})]}),(0,c.jsx)("div",{style:h2.progressBarContainer,children:(0,c.jsx)("div",{style:s(s({},h2.progressBarFill),{},{width:"".concat(v,"%")})})})]}):(0,c.jsxs)("div",{style:h2.controlsGrid,children:[(0,c.jsxs)("div",{style:h2.inputGroup,children:[(0,c.jsx)("label",{style:h2.label,children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c (\u0441\u0435\u043a)"}),(0,c.jsx)("input",{type:"number",min:"1",max:"60",style:h2.input,value:j,onChange:e=>_(Number(e.target.value))})]}),(0,c.jsxs)("div",{style:h2.inputGroup,children:[(0,c.jsx)("label",{style:h2.label,children:"\u041a\u0430\u0434\u0440\u043e\u0432 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443 (FPS)"}),(0,c.jsx)("input",{type:"number",min:"24",max:"60",style:h2.input,value:E,onChange:e=>D(Number(e.target.value))})]})]})]}),(0,c.jsx)("div",{style:h2.footer,children:w?(0,c.jsx)("button",{onClick:()=>A.current=!0,style:s(s({},h2.btn),h2.btnDestructive),children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0435\u043d\u0434\u0435\u0440"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:r,style:s(s({},h2.btn),h2.btnSecondary),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:async()=>{if(!window.VideoEncoder)return void alert("\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 WebCodecs.");S(!0),A.current=!1;const e=i.width%2===0?i.width:i.width-1,t=i.height%2===0?i.height:i.height-1,n=Math.ceil(j*E),o=1e6/E,a=new p2({target:new a1,video:{codec:"avc",width:e,height:t,frameRate:E},fastStart:"in-memory"}),s=new window.VideoEncoder({output:(e,t)=>a.addVideoChunk(e,t),error:e=>{console.error("VideoEncoder Error:",e),A.current=!0,b("\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0435\u043a\u0430: ".concat(e.message))}});s.configure({codec:"avc1.4d002a",width:e,height:t,bitrate:8e6,framerate:E});try{I.current&&await OQ(I.current,{width:100,height:100,scale:1});for(let r=0;r<n&&!A.current;r++){const i=r/E;if(C(i),await f2(),!I.current)continue;let a;await m2(I.current);let c=0;const d=3;let u=!1;for(;c<d&&!u;)try{if(a=await OQ(I.current,{width:e,height:t,scale:1,backgroundColor:"#000000",style:{transform:"none",transformOrigin:"top left",margin:0,padding:0},quality:1,features:{removeControlCharacter:!0},filter:e=>{var t;return!(null!==(t=e.classList)&&void 0!==t&&t.contains("exclude-from-render"))}}),!g2(a))throw new Error("Empty frame detected");u=!0}catch(l){c++,await new Promise(e=>setTimeout(e,100))}if(!a){console.error("Frame ".concat(r," completely failed"));continue}const p=new window.VideoFrame(a,{timestamp:r*o,duration:o});s.encodeQueueSize>5&&await new Promise(e=>setTimeout(e,20));const h=r%(2*E)===0;s.encode(p,{keyFrame:h}),p.close(),y(Math.round(r/n*100)),b("\u0420\u0435\u043d\u0434\u0435\u0440\u0438\u043d\u0433: ".concat(i.toFixed(1),"s / ").concat(j,"s"))}if(!A.current){b("\u0424\u0438\u043d\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0444\u0430\u0439\u043b\u0430..."),await s.flush(),a.finalize();const{buffer:e}=a.target,t=new Blob([e],{type:"video/mp4"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="video_render_".concat(Date.now(),".mp4"),r.click(),URL.revokeObjectURL(n)}}catch(l){console.error(l),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u043d\u0434\u0435\u0440\u0430: ".concat(l.message))}finally{"closed"!==s.state&&s.close(),S(!1),A.current||r()}},style:s(s({},h2.btn),h2.btnPrimary),children:"\u041d\u0430\u0447\u0430\u0442\u044c \u044d\u043a\u0441\u043f\u043e\u0440\u0442"})]})})]})}):null},x2=["x","y","w","h","rotate","opacity","scaleX","scaleY","visible","brightness","contrast","saturate","hueRotate","blur","grayscale","sepia"],b2=()=>{var t,n,r,o,i,a,l,d,u,p,h,f,g,m,v,y,x,b,w,S,k,C,j,_,E,D,M,T,I,A,O,R,z,F,P,B,L,N,U,V,W,H,G;tM();let X=null,Y=null;const q=window.location.pathname.split("/")[1];if(q&&q.includes("_")){const e=q.split("_");X=e[0],Y=e[1]}const{state:Z,setState:$,setStateQuietly:K,undo:J,redo:Q,canUndo:ee,canRedo:te,setInitState:ne}=lU(null),[re,oe]=(0,e.useState)(null),ie=null===re,[ae,se]=(0,e.useState)(null),[le,ce]=(0,e.useState)([]),[de,ue]=(0,e.useState)("layers"),[pe,he]=(0,e.useState)({materials:!1,main:!0}),[fe,ge]=(0,e.useState)(!1),[me,ve]=(0,e.useState)(""),[ye,xe]=(0,e.useState)(null),[be,we]=(0,e.useState)(0),[Se,ke]=(0,e.useState)(window.innerWidth<768),[Ce,je]=(0,e.useState)(window.innerWidth>=768),[_e,Ee]=(0,e.useState)("desktop"),De="mobile"===_e?"sceneLight_mobile":"sceneLight_desktop",[Me,Te]=(0,e.useState)(null),[Ie,Ae]=(0,e.useState)({intensity:1,depth:1}),[Oe,Re]=(0,e.useState)(!1),[ze,Fe]=(0,e.useState)(!1),[Pe,Be]=(0,e.useState)(0),[Le,Ne]=(0,e.useState)(0),[Ue,Ve]=(0,e.useState)([]),[We,He]=(0,e.useState)(!1),[Ge,Xe]=(0,e.useState)(!1),Ye=(0,e.useMemo)(()=>{var e,t;return ie||null===Z||void 0===Z||null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||!t.effects?{}:Z.fragments[re].effects.textureOverlay||{}},[Z,re,ie]),qe=e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.textureOverlay||(t.fragments[re].effects.textureOverlay={enabled:!1,opacity:.5,mode:"stretch"}),Object.assign(t.fragments[re].effects.textureOverlay,e)}),Ze=()=>{var e,t;if(!re||null===Z||void 0===Z||null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||!t.effects)return;const n=JSON.parse(JSON.stringify(Z.fragments[re].effects));xe(n),alert("\u042d\u0444\u0444\u0435\u043a\u0442\u044b \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0432 \u0431\u0443\u0444\u0435\u0440!")},$e=()=>{if(!re||!ye)return;window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b? \u042d\u0442\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0448\u0435\u0442 \u0412\u0421\u0415 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 (\u043f\u043e\u0433\u043e\u0434\u0430, \u0441\u0432\u0435\u0442, \u043a\u0430\u043c\u0435\u0440\u0430, \u0433\u043b\u0438\u0442\u0447 \u0438 \u0442.\u0434.) \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.")&&$(e=>{e.fragments[re]||(e.fragments[re]={}),e.fragments[re].effects=JSON.parse(JSON.stringify(ye))})},Ke=(0,e.useMemo)(()=>{var e,t;if(ie||null===Z||void 0===Z||null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||!t.effects)return{};const n=Z.fragments[re].effects;return fL(n,_e)||{}},[Z,re,_e,ie]),{settingsHeight:Je,sidebarWidth:Qe,settingsWidth:et,startResizingMobile:tt,startResizingSidebar:nt,startResizingSettings:rt}=(()=>{const[t,n]=(0,e.useState)(260),[r,o]=(0,e.useState)(260),[i,a]=(0,e.useState)(320),s=(0,e.useRef)(null),l=(0,e.useCallback)(()=>{s.current="mobile_panel",document.body.style.userSelect="none",document.body.style.cursor="row-resize"},[]),c=(0,e.useCallback)(()=>{s.current="sidebar",document.body.style.userSelect="none",document.body.style.cursor="col-resize"},[]),d=(0,e.useCallback)(()=>{s.current="desktop_panel",document.body.style.userSelect="none",document.body.style.cursor="col-resize"},[]),u=(0,e.useCallback)(()=>{s.current=null,document.body.style.userSelect="",document.body.style.cursor=""},[]),p=(0,e.useCallback)(e=>{if(!s.current)return;const t=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY;if("mobile_panel"===s.current){const e=50;let t=r-e;const o=window.innerHeight-e-100;t<50&&(t=50),t>o&&(t=o),n(t)}else if("sidebar"===s.current){let e=t;e<150&&(e=150),e>500&&(e=500),o(e)}else if("desktop_panel"===s.current){let e=window.innerWidth-t;e<200&&(e=200),e>600&&(e=600),a(e)}},[]);return(0,e.useEffect)(()=>(window.addEventListener("mousemove",p),window.addEventListener("mouseup",u),window.addEventListener("touchmove",p,{passive:!1}),window.addEventListener("touchend",u),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",u),window.removeEventListener("touchmove",p),window.removeEventListener("touchend",u)}),[p,u]),{settingsHeight:t,sidebarWidth:r,settingsWidth:i,startResizingMobile:l,startResizingSidebar:c,startResizingSettings:d}})();(0,e.useEffect)(()=>(document.body.classList.add("dark-mode"),()=>{document.body.classList.remove("dark-mode")}),[]);const{story:ot,setStory:it,assetsMap:at,setAssetsMap:st,loadingProgress:lt,isResourcesLoading:ct,isSaving:dt,isExporting:ut,saveProjectData:pt,runExport:ht,handleImportState:ft,handleResetSettings:gt,showAssetSourceModal:mt,handleSourceNetwork:vt,handleSourceZip:yt,handleSourceFolder:xt}=gJ(X,Y,Z,$),bt=(e,t,n,r)=>{e.forEach(o=>{o.parentId===t&&(o.x*=n,o.y*=r,o.w*=n,o.h*=r,"folder"===o.type&&bt(e,o.id,n,r))})},wt=()=>{if(ie)gt();else{const e="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u044d\u0442\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430? \u041e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u0441\u044f, \u043d\u043e \u0441\u043b\u043e\u0438 \u0438 \u0444\u0430\u0439\u043b\u044b \u043e\u0441\u0442\u0430\u043d\u0443\u0442\u0441\u044f.";window.confirm(e)&&($(e=>{if(e.fragments&&e.fragments[re]){const t=e.fragments[re];t.styles={},t.effects={},t.layout_override_desktop={},t.layout_override_mobile={},t.bg_layout&&(t.bg_layout={}),t.animations_desktop=null,t.animations_mobile=null,t.text_animation={},t.audio={},t.stats_settings={}}}),Ae({intensity:1,depth:1}))}},St=(0,e.useCallback)(()=>{var e,t,n;if(!Z)return UB(null);const r="mobile"===_e?"animations_mobile":"animations_desktop";let o;return o=ie?null===(e=Z.global_settings)||void 0===e?void 0:e[r]:null===(t=Z.fragments)||void 0===t||null===(n=t[re])||void 0===n?void 0:n[r],UB(o)},[Z,ie,re,_e]),kt=St(),Ct=e=>e&&e.groups?e.groups.find(t=>t.id===e.activeGroupId):null,jt=(0,e.useMemo)(()=>{const e=Ct(kt),t={};return e&&e.enabled&&e.elements&&Object.keys(e.elements).forEach(n=>{const r=e.elements[n];t[n]={},x2.forEach(e=>{const o=BB(r,e,Pe);null!==o&&void 0!==o&&(t[n][e]=o)})}),t},[kt,Pe]),_t=wJ($,re,_e,jt),Et=(0,e.useCallback)(()=>Z&&ot?UZ({htmlData:Z,story:ot,selectedId:re,layoutMode:_e}):[],[Z,ot,re,_e]),Dt=(0,e.useMemo)(()=>{var e,t;return ie||null===Z||void 0===Z||null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||!t.effects?{}:Z.fragments[re].effects.camera||{}},[Z,re,ie]),Mt=(0,e.useMemo)(()=>{var e,t;return ie||null===Z||void 0===Z||null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||!t.effects?{}:Z.fragments[re].effects.colorCorrection||{}},[Z,re,ie]),Tt=Et(),It=(0,e.useCallback)((e,t)=>{st(n=>s(s({},n),{},{[e]:t}))},[st]),At=(e,t)=>{$(n=>{const r="mobile"===_e?"layout_mobile":"layout_desktop",o="mobile"===_e?"layout_override_mobile":"layout_override_desktop",i=!ie,a=ie?n.global_settings:n.fragments[re];if(!a)return;let s=null;if(i&&a.layers&&(s=a.layers.find(t=>t.id===e)),s&&s.parentId){const n=s.parentId,i=a.layers.find(e=>e.id===n);if(i){Object.assign(s,t);let l={};ie?(l=a[r]||{},l[e]&&Object.assign(l[e],t)):(l=a[o]||{},l[e]&&Object.assign(l[e],t));const c=a.layers.filter(e=>e.parentId===n),{folderUpdates:d,childrenUpdates:u}=HZ(i,c,l);Object.assign(i,d);const p=ie?a[r]||(a[r]={}):a[o]||(a[o]={});return p[i.id]||(p[i.id]={}),Object.assign(p[i.id],d),void c.forEach(e=>{u[e.id]&&(e.x=u[e.id].x,e.y=u[e.id].y,p[e.id]||(p[e.id]={}),Object.assign(p[e.id],u[e.id]))})}}let l=null;if(ie){const t=a[r]||(a[r]={});l=t[e]||(t[e]={})}else{const n=a[o]||(a[o]={});if(l="bg_image"===e?n.bg_layout||(n.bg_layout={}):n[e]||(n[e]={}),s&&"folder"===s.type&&(void 0!==t.w||void 0!==t.h)){const n=void 0!==l.w?l.w:s.w,r=void 0!==l.h?l.h:s.h;if(n&&r&&t.w&&t.h){const o=t.w/n,i=t.h/r;1===o&&1===i||bt(a.layers||[],e,o,i)}}}l&&Object.assign(l,t)})},Ot=e=>{const t=e.groups.findIndex(t=>t.id===e.activeGroupId);if(-1!==t){const n=[...e.groups];let r=n[t];const o=r.elements||{};Object.keys(o).forEach(e=>{const t=o[e],n=Tt.find(t=>t.id===e);n&&Object.keys(t).forEach(o=>{const i=t[o];Array.isArray(i)&&0===i.length&&(r=NB(r,e,o,n[o]))})}),n[t]=r,e=s(s({},e),{},{groups:n})}$(t=>{const n="mobile"===_e?"animations_mobile":"animations_desktop";ie?t.global_settings[n]=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re][n]=e)})},Rt=(e,t)=>{const n=Ct(kt),r=Tt.find(t=>t.id===e);if(n&&n.enabled&&r){const o=VB(kt.groups,n.id,e);if(o)return void console.warn("Layer ".concat(e,' is blocked by group "').concat(o,'"'));let i=n,a=!1;if(Object.keys(t).forEach(n=>{if(x2.includes(n)){var o;const u=null===(o=i.elements)||void 0===o?void 0:o[e],p=BB(u,n,Pe);let h=r[n];void 0===h&&(h=["brightness","contrast","saturate"].includes(n)?1:0);if(c=null!==p?p:h,d=t[n],"number"===typeof c&&"number"===typeof d?Math.abs(c-d)>.001:c!==d){if(i=NB(i,e,n,h),i=LB(i,e,n,Pe,t[n]),["x","y","w","h","rotate","scaleX","scaleY"].includes(n)){var s,l;const t=null===(s=i.elements)||void 0===s||null===(l=s[e])||void 0===l?void 0:l.opacity;t&&0!==t.length||(i=LB(i,e,"opacity",0,1))}a=!0}}var c,d}),a){const e=s(s({},kt),{},{groups:kt.groups.map(e=>e.id===n.id?i:e)});Ot(e)}r.parentId&&n&&n.enabled;("folder"===r.type&&(void 0!==t.w||void 0!==t.h)||r.parentId&&!n)&&At(e,t)}else At(e,t)},zt=(e,t)=>{var n,r,o,i;const a=null===(n=Z.fragments)||void 0===n||null===(r=n[re])||void 0===r||null===(o=r.effects)||void 0===o||null===(i=o[De])||void 0===i?void 0:i.animation,l=Ct(a),c=l&&l.enabled;$(n=>{const r=n.fragments[re];if(!r.effects||!r.effects[De])return;const o=r.effects[De];let i=null,a={};const d=(o.sources||[]).findIndex(t=>t.id===e);if(-1!==d){if(i=o.sources[d],a=s({},i),Object.assign(i,t),t.w||t.h){const e=t.w||i.w||2*i.radius,n=t.h||i.h||2*i.radius;i.radius=Math.max(e,n)/2}}else{const n=(o.obstacles||[]).findIndex(t=>t.id===e);-1!==n&&(i=o.obstacles[n],a=s({},i),Object.assign(i,t))}if(i&&c){let r=n.fragments[re].effects[De].animation.groups.find(e=>e.id===l.id);if(r){Object.keys(t).forEach(n=>{var o;["x","y","w","h","rotate"].includes(n)&&(r=NB(r,e,n,null!==(o=a[n])&&void 0!==o?o:0),r=LB(r,e,n,be,t[n]))});const o=n.fragments[re].effects[De].animation.groups.findIndex(e=>e.id===r.id);-1!==o&&(n.fragments[re].effects[De].animation.groups[o]=r)}}})};(0,e.useEffect)(()=>{var e,t;const n=((null===Z||void 0===Z||null===(e=Z.assets)||void 0===e||null===(t=e.sys_fonts)||void 0===t?void 0:t.files)||[]).map(e=>{const t=at[e.file_id]||at[e.local_path]||e.url||e.local_path;return s(s({},e),{},{url:t})}),r=kJ(n);Ve(r.sort())},[null===Z||void 0===Z||null===(t=Z.assets)||void 0===t?void 0:t.sys_fonts,at]),(0,e.useEffect)(()=>{const e=()=>{const e=window.innerWidth<768;ke(e),je(!e)};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,e.useEffect)(()=>{const e=e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName))return;const t=e.ctrlKey||e.metaKey,n="KeyZ"===e.code;t&&n&&(e.preventDefault(),e.shiftKey?Q():J())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[J,Q]),(0,e.useEffect)(()=>{var e,t;if(Me&&null!==Z&&void 0!==Z&&null!==(e=Z.fragments)&&void 0!==e&&null!==(t=e[re])&&void 0!==t&&t.layers){Z.fragments[re].layers.find(e=>e.id===Me)&&(Lt(Me),Te(null))}},[Z,Me,re]),(0,e.useEffect)(()=>{re&&ue("layers")},[re]),(0,e.useEffect)(()=>{var e,t,n;if(re&&null!==Z&&void 0!==Z&&null!==(e=Z.fragments)&&void 0!==e&&null!==(t=e[re])&&void 0!==t&&null!==(n=t.effects)&&void 0!==n&&n.parallax){var r,o;const e=Z.fragments[re].effects.parallax;Ae({intensity:null!==(r=e.intensity)&&void 0!==r?r:1,depth:null!==(o=e.depth)&&void 0!==o?o:1})}else Ae({intensity:1,depth:1})},[re,Z]);const Ft=()=>{var e,t,n;const r=St(),o=Ct(r),i={};o&&o.enabled&&o.elements&&Object.keys(o.elements).forEach(e=>{const t=o.elements[e],n={};x2.forEach(e=>{const r=BB(t,e,Pe);null!==r&&void 0!==r&&(n[e]=r)}),Object.keys(n).length>0&&(i[e]=n)});let a=UZ({htmlData:Z,story:ot,selectedId:re,layoutMode:_e,animOverrides:i,assetsMap:at});const s="mobile"===_e?"sceneLight_mobile":"sceneLight_desktop",l=null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t||null===(n=t.effects)||void 0===n?void 0:n[s];if(!ie&&re&&null!==l&&void 0!==l&&l.enabled){const e=l,t=e.animation,n=Ct(t),r=(e,t,r)=>{var o;if(n&&n.enabled&&null!==(o=n.elements)&&void 0!==o&&o[e]){const r=BB(n.elements[e],t,be);if(null!==r&&void 0!==r)return r}return r};e.sources&&!e.hideUI&&e.sources.forEach(e=>{const t=void 0!==e.w?e.w:2*(e.radius||300),n=void 0!==e.h?e.h:2*(e.radius||300),o=void 0!==e.w,i=o?e.x:e.x-(e.radius||300),s=o?e.y:e.y-(e.radius||300),l=e.rotate||0;a.push({id:e.id,type:"light_virtual",x:r(e.id,"x",i),y:r(e.id,"y",s),w:r(e.id,"w",t),h:r(e.id,"h",n),rotate:r(e.id,"rotate",l),z:9999,isVirtual:!0,shape:"circle"})}),e.obstacles&&!e.hideUI&&e.obstacles.forEach(e=>{a.push({id:e.id,type:"obstacle_virtual",x:r(e.id,"x",e.x),y:r(e.id,"y",e.y),w:r(e.id,"w",e.w),h:r(e.id,"h",e.h),rotate:r(e.id,"rotate",e.rotate||0),z:9999,isVirtual:!0,shape:e.type})})}return a},Pt=()=>{var e,t,n,r;if(!Z)return[];const o=(null===(e=Z.fragments)||void 0===e||null===(t=e[re])||void 0===t?void 0:t.layers)||[];if(!re||0===o.length)return o;const i="mobile"===_e?"layout_override_mobile":"layout_override_desktop",a=(null===(n=Z.fragments)||void 0===n||null===(r=n[re])||void 0===r?void 0:r[i])||{},l=o.map(e=>{const t=a[e.id];return t?s(s({},e),t):e}),c=Ct(kt);return c&&c.enabled?l.map(e=>{var t;const n=c.elements?c.elements[e.id]:null,r=s({},e);if(n&&x2.forEach(e=>{const t=BB(n,e,Pe);null!==t&&void 0!==t&&(r[e]=t)}),null!==(t=c.layerAnimation)&&void 0!==t&&t.enabled){const t=GB(c.layerAnimation,e.id,Pe);if(t&&t.handled){const e=void 0!==r.opacity?r.opacity:1;r.opacity=e*t.opacityFactor,r.opacity>.001?r.visible=!0:r.visible=!1}}return r}):l},Bt=()=>Ne(e=>e+1),Lt=e=>{se(e),ce([])},Nt=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){let i=[...le];if(0===i.length&&ae){var t,n,r,o;"folder"===(null===(t=Z.fragments)||void 0===t||null===(n=t[re])||void 0===n||null===(r=n.layers)||void 0===r||null===(o=r.find(e=>e.id===ae))||void 0===o?void 0:o.type)||ae===e||i.push(ae)}i.includes(e)?i=i.filter(t=>t!==e):i.push(e),ce(i),i.length>0?se(i.includes(e)?e:i[i.length-1]):se(null)}else se(e),ce([])},Ut=e=>{$(t=>{ie?(t.global_settings||(t.global_settings={}),t.global_settings.styles=e):(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].styles=e)})},Vt=(e,t,n)=>{if("object"===typeof t&&null!==t)return void Rt(e,t);const r=t;["opacity","x","y","w","h","rotate","scaleX","scaleY","visible"].includes(r)?Rt(e,{[r]:n}):re&&$(t=>{const o=t.fragments[re];if(o&&o.layers){const t=o.layers.find(t=>t.id===e);t&&(t[r]=n)}})},Wt=e=>{re&&$(t=>{t.fragments[re]||(t.fragments[re]={});const n=t.fragments[re];if(n.effects||(n.effects={}),n.effects.parallax||(n.effects.parallax={}),n.effects.parallax.enabled=e,e){if(n.effects.parallax.intensity=.2,n.effects.parallax.depth=1,n.layers){const e=n.layers.length;n.layers.forEach((t,n)=>{const r=e<=1?0:(e-1-n)/(e-1);t.parallaxStrength=Math.round(20*(.2+r*r))/20})}Ae({intensity:.2,depth:1})}})},Ht=e=>{re&&$(t=>{const n=t.fragments[re];if(n&&n.layers){const t=n.layers.find(t=>t.id===e);t&&(t.disableParallax=!t.disableParallax)}})},Gt="mobile"===_e?"resolution_mobile":"resolution_desktop",Xt=(null===Z||void 0===Z||null===(n=Z.global_settings)||void 0===n?void 0:n[Gt])||("mobile"===_e?{width:480,height:800}:{width:1280,height:720}),Yt=re&&null!==ot&&void 0!==ot&&null!==(r=ot.fragments)&&void 0!==r&&r[re]?s(s({},ot.fragments[re]),(null===Z||void 0===Z||null===(o=Z.fragments)||void 0===o?void 0:o[re])||{}):null,qt=(null===Yt||void 0===Yt?void 0:Yt.choices)||[],Zt=(0,e.useMemo)(()=>{if(null===Yt||void 0===Yt||!Yt.text)return[];const e=[...Yt.text.matchAll(/\[\[Event:([^\]]+)\]\]/g)];return[...new Set(e.map(e=>e[1].trim()))]},[null===Yt||void 0===Yt?void 0:Yt.text]),$t=(0,e.useMemo)(()=>{var e,t,n;const r=(null===Z||void 0===Z||null===(e=Z.global_settings)||void 0===e?void 0:e.text_animation)||{},o=(null===Z||void 0===Z||null===(t=Z.fragments)||void 0===t||null===(n=t[re])||void 0===n?void 0:n.text_animation)||{},i=void 0!==o.enabled?o.enabled:r.enabled||!1;return s(s(s({},r),o),{},{enabled:i})},[Z,re]),Kt=(e,t)=>{re&&$(n=>{const r=n.fragments[re];if(r&&(r.effects||(r.effects={}),r.effects.parallax||(r.effects.parallax={}),r.effects.parallax.intensity=e,r.effects.parallax.depth=t,r.layers)){const n=r.layers.length;r.layers.forEach((r,o)=>{const i=n<=1?0:(n-1-o)/(n-1);r.parallaxStrength=Math.round(20*(e+i*i*t))/20})}})};if(mt)return(0,c.jsx)("div",{style:{width:"100vw",height:"100vh",background:"#111",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"sans-serif",zIndex:9999},children:(0,c.jsxs)("div",{style:{background:"#222",padding:"30px",borderRadius:"12px",border:"1px solid #444",maxWidth:"400px",width:"90%",textAlign:"center"},children:[(0,c.jsx)("h2",{style:{marginTop:0},children:"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432"}),(0,c.jsx)("p",{style:{color:"#aaa",marginBottom:"20px"},children:"\u041e\u0442\u043a\u0443\u0434\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b (\u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438, \u0437\u0432\u0443\u043a)?"}),(0,c.jsx)("button",{onClick:vt,style:s(s({},zL.btn),{},{width:"100%",padding:"12px",marginBottom:"10px",background:"#007bff",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"16px"}),children:"\ud83c\udf10 \u0418\u0437 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0430 (\u0421\u0435\u0440\u0432\u0435\u0440)"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[(0,c.jsxs)("label",{style:{flex:1,cursor:"pointer",background:"#28a745",padding:"12px",borderRadius:"6px",fontSize:"14px"},children:["\ud83d\udddc ZIP \u0410\u0440\u0445\u0438\u0432",(0,c.jsx)("input",{type:"file",accept:".zip",hidden:!0,onChange:e=>yt(e.target.files[0])})]}),(0,c.jsxs)("label",{style:{flex:1,cursor:"pointer",background:"#6c757d",padding:"12px",borderRadius:"6px",fontSize:"14px"},children:["\ud83d\udcc2 \u041f\u0430\u043f\u043a\u0430 Assets",(0,c.jsx)("input",{type:"file",webkitdirectory:"",directory:"",hidden:!0,onChange:e=>xt(e.target.files)})]})]}),(0,c.jsx)("p",{style:{fontSize:"12px",color:"#666",marginTop:"10px"},children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 ZIP \u0438\u043b\u0438 \u041f\u0430\u043f\u043a\u0443, \u0435\u0441\u043b\u0438 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u043c\u0435\u0434\u043b\u0435\u043d\u043d\u044b\u0439 \u0438\u043b\u0438 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043e\u0444\u043b\u0430\u0439\u043d."})]})});if(!ot||!Z||ct)return(0,c.jsx)(XZ,{loadingProgress:lt});const Jt={};Object.keys(ot.fragments).forEach(e=>{const t=e.includes("_")?e.split("_")[0]:"other",n=t.charAt(0).toUpperCase()+t.slice(1);Jt[n]||(Jt[n]=[]),Jt[n].push(e)});const Qt=Object.keys(Jt).sort(),en="mobile"===_e?"menu_mobile":"menu_desktop",tn=(e,t)=>{$(n=>{var r;const o=null===(r=n.assets)||void 0===r?void 0:r.sys_characters;if(!o||!o.files)return;const i=o.files.find(t=>t.id===e);i&&(i.presets=t)})},nn=async function(){const e=await _t.addCharacterToScene(...arguments);e&&Te(e)};return(0,c.jsxs)("div",{style:zL.container,children:[(0,c.jsx)("style",{children:"\n         html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #111; }\n         * { box-sizing: border-box; }\n         ::-webkit-scrollbar { width: 8px; height: 8px; }\n         ::-webkit-scrollbar-track { background: #1e1e1e; }\n         ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }\n         ::-webkit-scrollbar-thumb:hover { background: #555; }\n         /* \u0424\u0418\u041a\u0421 IOS: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c 100dvh \u0434\u043b\u044f body, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044c \u0441\u043a\u0440\u043e\u043b\u043b\u0430 \u0441\u0430\u043c\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f */\n         html, body { height: 100dvh; max-height: 100dvh; }\n       "}),(0,c.jsx)(SJ,{isOpen:ze,isExporting:ut,exportStatus:me,onClose:()=>Fe(!1),onExport:async e=>{ve("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f..."),await ht(e,ve),Fe(!1)},storyId:Y,userId:X,webgameReady:null===ot||void 0===ot?void 0:ot.webgame_ready,onToggleBot:async e=>{if(Y&&X)try{(await fetch("/api/story/".concat(X,"/").concat(Y,"/webgame"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webgame_ready:e})})).ok?it(t=>s(s({},t),{},{webgame_ready:e})):alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0438\u0441\u0442\u043e\u0440\u0438\u0438")}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c")}}}),(0,c.jsx)(YZ,{sidebarOpen:Ce,isMobileScreen:Se,sidebarWidth:Qe,setSidebarOpen:je,userId:X,storyId:Y,selectedId:re,setSelectedId:oe,fragmentTab:de,setFragmentTab:ue,groups:Jt,sortedKeys:Qt,openSpoilers:pe,setOpenSpoilers:he,onExportClick:()=>Fe(!0),onEditLogic:()=>{pt().then(()=>{window.location.href="/".concat(X,"_").concat(Y)})}}),!Se&&(0,c.jsx)("div",{onMouseDown:nt,style:{width:"5px",background:"#111",borderLeft:"1px solid #333",borderRight:"1px solid #333",cursor:"col-resize",zIndex:90,position:"relative"}}),Se&&Ce&&(0,c.jsx)("div",{style:zL.overlay,onClick:()=>je(!1)}),(0,c.jsxs)("div",{style:s(s({},zL.main),{},{flexDirection:"column"}),children:[(0,c.jsxs)("div",{style:zL.header,children:[Se&&(0,c.jsx)("button",{style:zL.hamburger,onClick:()=>je(!Ce),children:"\u2630"}),(0,c.jsxs)("div",{style:{marginRight:"auto",display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("span",{style:{fontWeight:"bold"},children:"Visual Editor"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"2px"},children:[(0,c.jsx)("button",{onClick:J,disabled:!ee,style:{background:"transparent",border:"1px solid #444",color:ee?"#fff":"#555",cursor:ee?"pointer":"default",borderRadius:"4px 0 0 4px",padding:"4px 8px"},children:"\u21b6"}),(0,c.jsx)("button",{onClick:Q,disabled:!te,style:{background:"transparent",border:"1px solid #444",borderLeft:"none",color:te?"#fff":"#555",cursor:te?"pointer":"default",borderRadius:"0 4px 4px 0",padding:"4px 8px"},children:"\u21b7"})]})]}),(0,c.jsx)("button",{onClick:()=>{pt(null,!0).then(()=>{window.open("/".concat(X,"_").concat(Y,"/html/play"),"_blank")})},style:{padding:"5px 15px",background:"#007bff",border:"none",color:"#fff",borderRadius:4,marginRight:"10px",cursor:"pointer"},children:"\u25b6 Play"}),(0,c.jsx)("button",{onClick:()=>pt(),style:{padding:"5px 10px",background:dt?"#555":"#28a745",border:"none",color:"#fff",borderRadius:4},children:dt?"...":"Save"})]}),(0,c.jsx)("div",{style:s(s({},zL.content),{},{flexDirection:Se?"column":"row",overflow:"hidden"}),children:"materials"===re?(0,c.jsx)("div",{style:{flex:1,width:"100%",height:"100%",overflow:"hidden"},children:(0,c.jsx)(bU,{assetsData:Z.assets,onUpdate:e=>{$(s(s({},Z),{},{assets:e})),pt(s(s({},Z),{},{assets:e}),!0)},userId:X,storyId:Y,assetsMap:at,onRegisterAsset:It,presets:Z.character_presets||{},onSavePresets:tn,resolution:Xt,onOpenCharEditor:()=>ge(!0)})}):(0,c.jsxs)(c.Fragment,{children:[Se&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{flexShrink:0,background:"#1e1e1e",height:"".concat(Je,"px"),overflowY:"auto",paddingBottom:"calc(env(safe-area-inset-bottom) + 20px)"},children:(0,c.jsx)(XK,{isGlobal:ie,isMobileScreen:Se,layoutMode:_e,setLayoutMode:Ee,selectedId:re,fragmentTab:de,htmlData:Z,onUpdateGlobalSettings:e=>$(s(s({},Z),{},{global_settings:e})),onUpdateGrid:e=>$(t=>{Object.assign(t.global_settings.grid||(t.global_settings.grid={}),e)}),onUpdateMenu:e=>$(t=>{t.global_settings[en]=e}),onUpdateStyles:Ut,presets:Z.character_presets||{},onOpenCharEditor:()=>ge(!0),onOpenTextEditor:()=>He(!0),onToggleLayerParallax:Ht,sceneElements:Ft(),textEvents:Zt,choices:qt,onCopyEffects:Ze,onPasteEffects:$e,canPasteEffects:!!ye,textureSettings:Ye,onUpdateTexture:qe,effectControls:null===(i=Z.fragments)||void 0===i||null===(a=i[re])||void 0===a||null===(l=a.effects)||void 0===l?void 0:l.effectControls,onUpdateEffectControls:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.effectControls=e}),sceneLayers:Pt(),sceneLightSettings:null===(d=Z.fragments)||void 0===d||null===(u=d[re])||void 0===u||null===(p=u.effects)||void 0===p?void 0:p[De],onUpdateSceneLight:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects[De]||(t.fragments[re].effects[De]={enabled:!1}),Object.assign(t.fragments[re].effects[De],e)}),lightAnimationData:null===(h=Z.fragments)||void 0===h||null===(f=h[re])||void 0===f||null===(g=f.effects)||void 0===g||null===(m=g[De])||void 0===m?void 0:m.animation,onUpdateLightAnimation:e=>$(t=>{const n=t.fragments[re].effects[De];n&&(n.animation=e)}),lightAnimTime:be,setLightAnimTime:we,onUpdateElement:(e,t)=>{e.startsWith("sl_")||e.startsWith("src_")||e.startsWith("obs_")?zt(e,t):Rt(e,t)},onAddCharacter:nn,onUpdateAutosaveInterval:e=>$(t=>{t.global_settings||(t.global_settings={}),t.global_settings.autosave_interval=e}),onExportState:()=>{const e=new Blob([JSON.stringify(Z,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="project_".concat(Y,".json"),n.click()},onImportState:ft,onUpdateGlobalButtonCount:e=>$(t=>{const n="mobile"===_e?"layout_mobile":"layout_desktop";t.global_settings[n]||(t.global_settings[n]={}),t.global_settings[n].template_button_count=e}),onResetSettings:wt,textureFiles:(null===Z||void 0===Z||null===(v=Z.assets)||void 0===v||null===(y=v.sys_textures)||void 0===y?void 0:y.files)||[],currentAnimData:kt,updateAnimationData:Ot,animTime:Pe,setAnimTime:Be,selectedElementId:ae,availableLayers:ie?[]:(null===(x=Z.fragments)||void 0===x||null===(b=x[re])||void 0===b?void 0:b.layers)||[],showTrajectories:Oe,setShowTrajectories:Re,updateTextAnimSettings:e=>$(t=>{ie?t.global_settings.text_animation=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].text_animation=e)}),onReparentLayer:_t.reparentLayer,onUpdateAudio:e=>$(t=>{ie?t.global_settings.audio=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].audio=e)}),onUpdateAttributes:e=>$(t=>{ie?t.global_settings.stats_settings=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].stats_settings=e)}),masterParallax:Ie,setMasterParallax:Ae,applyMasterParallax:Kt,toggleParallaxEffect:Wt,updateLayerParam:Vt,toggleLayerOverflow:e=>{re&&$(t=>{const n=t.fragments[re].layers.find(t=>t.id===e);n&&(n.overflowVisible=!n.overflowVisible)})},updateDarknessSettings:e=>{re&&$(t=>{const n=t.fragments[re];n.effects||(n.effects={}),n.effects.darkness||(n.effects.darkness={enabled:!1,opacity:.95,radius:150,monochrome:!1}),Object.assign(n.effects.darkness,e)})},weatherSettings:Ke,updateWeatherSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={});const n="mobile"===_e?"weather_mobile":"weather_desktop";"mobile"===_e&&!t.fragments[re].effects[n]&&t.fragments[re].effects.weather_desktop&&(t.fragments[re].effects[n]=JSON.parse(JSON.stringify(t.fragments[re].effects.weather_desktop))),t.fragments[re].effects[n]||(t.fragments[re].effects[n]={enabled:!1,type:"snow",count:100,zIndex:100}),Object.assign(t.fragments[re].effects[n],e)}),updateNoiseSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.noise||(t.fragments[re].effects.noise={enabled:!1,opacity:.1,size:1,speed:.5,monochrome:!0,scope:"global"}),Object.assign(t.fragments[re].effects.noise,e)}),updateGlitchSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.glitch||(t.fragments[re].effects.glitch={enabled:!1,intensity:.5,scope:"global"}),Object.assign(t.fragments[re].effects.glitch,e)}),updateTransitionSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.transition||(t.fragments[re].effects.transition={enabled:!1,type:"fade",duration:.5}),Object.assign(t.fragments[re].effects.transition,e)}),handleTransitionPreview:Bt,colorSettings:Mt,onUpdateColor:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.colorCorrection||(t.fragments[re].effects.colorCorrection={enabled:!1}),Object.assign(t.fragments[re].effects.colorCorrection,e)}),onExportVideo:()=>Xe(!0),layersForPanel:Pt(),onReorderLayersSmart:_t.reorderLayersSmart,addLayer:_t.addLayer,removeLayer:_t.removeLayer,onBgChange:e=>$(t=>{t.fragments[re]&&(t.fragments[re].bg_image=e)}),multiSelectionIds:le,handleLayerSelect:Nt,addLayerFolder:_t.addLayerFolder,toggleFolderCollapse:_t.toggleFolderCollapse,toggleFolderVisibility:_t.toggleFolderVisibility,handleFolderSelect:Lt,reorderLayersWithHierarchy:_t.reorderLayersWithHierarchy,assetsMap:at,currentResolution:Xt,currentMenuSettings:Z.global_settings[en]||{},globalButtonCount:(null===(w=Z.global_settings["mobile"===_e?"layout_mobile":"layout_desktop"])||void 0===w?void 0:w.template_button_count)||2,activeButtons:Ft().filter(e=>"button"===e.type).map(e=>{if(!ie&&null!==qt&&void 0!==qt&&qt[e.index]){const t=qt[e.index];return s(s({},e),{},{text:"object"===typeof t?t.text:t})}return e}),customFonts:Ue,cameraSettings:Dt,updateCameraSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.camera||(t.fragments[re].effects.camera={enabled:!1}),Object.assign(t.fragments[re].effects.camera,e)}),onPasteLayer:_t.pasteFullLayer})}),(0,c.jsx)("div",{style:zL.resizer,onMouseDown:tt,onTouchStart:tt,children:(0,c.jsx)("div",{style:zL.resizerIcon})})]}),(0,c.jsx)("div",{style:{flex:1,position:"relative",overflow:"hidden",background:"#111",minHeight:0},children:(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,c.jsx)("div",{style:{width:"100%",height:"100%",background:(null===Z||void 0===Z||null===(S=Z.global_settings)||void 0===S?void 0:S.game_area_bg_color)||"#000",position:"relative",overflow:"hidden"},children:(0,c.jsx)(FZ,{elements:Ft(),resolution:Xt,selectedElementId:ae,onSelectElement:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;se(e),ce(t||[])},activeFragmentData:Yt,externalSelectionIds:le,isGlobal:ie,textAnimSettings:$t,canvasBg:Z.global_settings.canvas_bg_color||"#1a1a1a",gameAreaBg:Z.global_settings.game_area_bg_color||"#ffffff",computedStyles:GZ(Z,re,_e),layoutMode:_e,savedView:(null===(k=Z.global_settings)||void 0===k?void 0:k["mobile"===_e?"editor_view_mobile":"editor_view_desktop"])||null,gridSettings:Z.global_settings.grid,menuSettings:Z.global_settings[en]||{},onUpdateElement:(e,t)=>{e.startsWith("sl_")||e.startsWith("src_")||e.startsWith("obs_")?zt(e,t):Rt(e,t)},onUpdateElements:e=>{const t=Ct(kt);$(n=>{var r,o;const i="mobile"===_e?"layout_mobile":"layout_desktop",a="mobile"===_e?"layout_override_mobile":"layout_override_desktop",s="mobile"===_e?"animations_mobile":"animations_desktop";let l=ie?null===(r=n.global_settings)||void 0===r?void 0:r[s]:null===(o=n.fragments[re])||void 0===o?void 0:o[s],c=null;t&&t.enabled&&l&&l.groups&&(c=l.groups.find(e=>e.id===t.id)),Object.entries(e).forEach(e=>{let[t,r]=e;const o=Tt.find(e=>e.id===t);if(c&&o){Object.keys(r).forEach(e=>{if(x2.includes(e)){let a=o[e];if(void 0===a&&(a=["brightness","contrast","saturate","scaleX","scaleY","opacity"].includes(e)?1:0),c=NB(c,t,e,a),c=LB(c,t,e,Pe,r[e]),["x","y","w","h","rotate"].includes(e)){var n,i;const e=null===(n=c.elements)||void 0===n||null===(i=n[t])||void 0===i?void 0:i.opacity;e&&0!==e.length||(c=LB(c,t,"opacity",0,1))}}});const e=l.groups.findIndex(e=>e.id===c.id);-1!==e&&(l.groups[e]=c)}else if(ie)n.global_settings[i]||(n.global_settings[i]={}),Object.assign(n.global_settings[i][t]||(n.global_settings[i][t]={}),r);else{n.fragments[re]||(n.fragments[re]={}),n.fragments[re][a]||(n.fragments[re][a]={});const e=n.fragments[re][a];e[t]||(e[t]={}),Object.assign(e[t],r),"bg_image"===t&&(e.bg_layout||(e.bg_layout={}),Object.assign(e.bg_layout,r))}})})},showTrajectories:Oe,onUpdateGrid:e=>$(t=>{Object.assign(t.global_settings.grid||(t.global_settings.grid={}),e)}),staticElements:Tt,onTimeChange:Be,animationSettings:Ct(kt),currentTime:Pe,onUpdateView:e=>K(t=>{t.global_settings["mobile"===_e?"editor_view_mobile":"editor_view_desktop"]=e}),statsSettings:LZ(Z,re),textAnimSettings:BZ(Z,re),typingSoundUrl:null===(C=Z.global_settings)||void 0===C||null===(j=C.audio)||void 0===j?void 0:j.typing_sound,previewTrigger:"preview-".concat(Le),transitionSettings:(null===Z||void 0===Z||null===(_=Z.fragments)||void 0===_||null===(E=_[re])||void 0===E||null===(D=E.effects)||void 0===D?void 0:D.transition)||{enabled:!1},layoutMode:_e,weatherSettings:Ke,cameraSettings:Dt,assetsMap:at,lightAnimTime:be,onStartLightAnimation:e=>console.log("Light Animation Triggered by Layer Click",{restart:e})})})})}),!Se&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{onMouseDown:rt,style:{width:"5px",background:"#111",borderLeft:"1px solid #333",borderRight:"1px solid #333",cursor:"col-resize",zIndex:10}}),(0,c.jsx)("div",{style:{width:"".concat(et,"px"),flexShrink:0,background:"#1e1e1e",overflowY:"auto",borderLeft:"1px solid #333"},children:(0,c.jsx)(XK,{isGlobal:ie,isMobileScreen:Se,layoutMode:_e,setLayoutMode:Ee,selectedId:re,fragmentTab:de,htmlData:Z,onUpdateAutosaveInterval:e=>$(t=>{t.global_settings||(t.global_settings={}),t.global_settings.autosave_interval=e}),onExportState:()=>{const e=new Blob([JSON.stringify(Z,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="project_".concat(Y,".json"),n.click()},onImportState:ft,onUpdateGlobalSettings:e=>$(s(s({},Z),{},{global_settings:e})),onUpdateGrid:e=>$(t=>{Object.assign(t.global_settings.grid||(t.global_settings.grid={}),e)}),onUpdateMenu:e=>$(t=>{t.global_settings[en]=e}),onUpdateStyles:Ut,onUpdateGlobalButtonCount:e=>$(t=>{const n="mobile"===_e?"layout_mobile":"layout_desktop";t.global_settings[n]||(t.global_settings[n]={}),t.global_settings[n].template_button_count=e}),onResetSettings:wt,onCopyEffects:Ze,onPasteEffects:$e,canPasteEffects:!!ye,sceneElements:Ft(),textEvents:Zt,sceneLayers:Pt(),choices:qt,sceneLightSettings:null===(M=Z.fragments)||void 0===M||null===(T=M[re])||void 0===T||null===(I=T.effects)||void 0===I?void 0:I[De],effectControls:null===(A=Z.fragments)||void 0===A||null===(O=A[re])||void 0===O||null===(R=O.effects)||void 0===R?void 0:R.effectControls,onUpdateEffectControls:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.effectControls=e}),onUpdateSceneLight:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects[De]||(t.fragments[re].effects[De]={enabled:!1}),Object.assign(t.fragments[re].effects[De],e)}),onUpdateElement:(e,t)=>{e.startsWith("sl_")||e.startsWith("src_")||e.startsWith("obs_")?zt(e,t):Rt(e,t)},lightAnimationData:null===(z=Z.fragments)||void 0===z||null===(F=z[re])||void 0===F||null===(P=F.effects)||void 0===P||null===(B=P[De])||void 0===B?void 0:B.animation,onUpdateLightAnimation:e=>$(t=>{const n=t.fragments[re].effects[De];n&&(n.animation=e)}),lightAnimTime:be,setLightAnimTime:we,textureSettings:Ye,onUpdateTexture:qe,onToggleLayerParallax:Ht,onOpenCharEditor:()=>ge(!0),presets:Z.character_presets||{},onReorderLayersSmart:_t.reorderLayersSmart,onAddCharacter:nn,onReparentLayer:_t.reparentLayer,onExportVideo:()=>Xe(!0),currentAnimData:kt,updateAnimationData:Ot,onOpenTextEditor:()=>He(!0),animTime:Pe,setAnimTime:Be,textureFiles:(null===Z||void 0===Z||null===(L=Z.assets)||void 0===L||null===(N=L.sys_textures)||void 0===N?void 0:N.files)||[],colorSettings:Mt,onUpdateColor:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.colorCorrection||(t.fragments[re].effects.colorCorrection={enabled:!1}),Object.assign(t.fragments[re].effects.colorCorrection,e)}),selectedElementId:ae,assetsMap:at,availableLayers:ie?[]:(null===(U=Z.fragments)||void 0===U||null===(V=U[re])||void 0===V?void 0:V.layers)||[],showTrajectories:Oe,setShowTrajectories:Re,updateTextAnimSettings:e=>$(t=>{ie?t.global_settings.text_animation=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].text_animation=e)}),onUpdateAudio:e=>$(t=>{ie?t.global_settings.audio=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].audio=e)}),onUpdateAttributes:e=>$(t=>{ie?t.global_settings.stats_settings=e:(t.fragments[re]||(t.fragments[re]={}),t.fragments[re].stats_settings=e)}),masterParallax:Ie,setMasterParallax:Ae,applyMasterParallax:Kt,toggleParallaxEffect:Wt,updateLayerParam:Vt,toggleLayerOverflow:e=>{re&&$(t=>{const n=t.fragments[re].layers.find(t=>t.id===e);n&&(n.overflowVisible=!n.overflowVisible)})},updateDarknessSettings:e=>{re&&$(t=>{const n=t.fragments[re];n.effects||(n.effects={}),n.effects.darkness||(n.effects.darkness={enabled:!1,opacity:.95,radius:150,monochrome:!1}),Object.assign(n.effects.darkness,e)})},weatherSettings:Ke,updateWeatherSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={});const n="mobile"===_e?"weather_mobile":"weather_desktop";"mobile"===_e&&!t.fragments[re].effects[n]&&t.fragments[re].effects.weather_desktop&&(t.fragments[re].effects[n]=JSON.parse(JSON.stringify(t.fragments[re].effects.weather_desktop))),t.fragments[re].effects[n]||(t.fragments[re].effects[n]={enabled:!1,type:"snow",count:100,zIndex:100}),Object.assign(t.fragments[re].effects[n],e)}),updateNoiseSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.noise||(t.fragments[re].effects.noise={enabled:!1,opacity:.1,size:1,speed:.5,monochrome:!0,scope:"global"}),Object.assign(t.fragments[re].effects.noise,e)}),updateGlitchSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.glitch||(t.fragments[re].effects.glitch={enabled:!1,intensity:.5,scope:"global"}),Object.assign(t.fragments[re].effects.glitch,e)}),updateTransitionSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.transition||(t.fragments[re].effects.transition={enabled:!1,type:"fade",duration:.5}),Object.assign(t.fragments[re].effects.transition,e)}),handleTransitionPreview:Bt,layersForPanel:Pt(),addLayer:_t.addLayer,removeLayer:_t.removeLayer,onBgChange:e=>$(t=>{t.fragments[re]&&(t.fragments[re].bg_image=e)}),multiSelectionIds:le,handleLayerSelect:Nt,addLayerFolder:_t.addLayerFolder,toggleFolderCollapse:_t.toggleFolderCollapse,toggleFolderVisibility:_t.toggleFolderVisibility,handleFolderSelect:Lt,reorderLayersWithHierarchy:_t.reorderLayersWithHierarchy,currentResolution:Xt,currentMenuSettings:Z.global_settings[en]||{},globalButtonCount:(null===(W=Z.global_settings["mobile"===_e?"layout_mobile":"layout_desktop"])||void 0===W?void 0:W.template_button_count)||2,activeButtons:Ft().filter(e=>"button"===e.type).map(e=>{if(!ie&&null!==qt&&void 0!==qt&&qt[e.index]){const t=qt[e.index];return s(s({},e),{},{text:"object"===typeof t?t.text:t})}return e}),customFonts:Ue,cameraSettings:Dt,updateCameraSettings:e=>$(t=>{t.fragments[re].effects||(t.fragments[re].effects={}),t.fragments[re].effects.camera||(t.fragments[re].effects.camera={enabled:!1}),Object.assign(t.fragments[re].effects.camera,e)}),onPasteLayer:_t.pasteFullLayer})})]})]})})]}),We&&re&&(null===ot||void 0===ot||null===(H=ot.fragments)||void 0===H?void 0:H[re])&&(0,c.jsx)(Uk,{initialHtml:ot.fragments[re].text||"",onSave:async e=>{if(re&&X&&Y)try{await Xl(X,Y,re,e),it(t=>t&&t.fragments&&t.fragments[re]?s(s({},t),{},{fragments:s(s({},t.fragments),{},{[re]:s(s({},t.fragments[re]),{},{text:e})})}):t),He(!1)}catch(M2){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430: ".concat(M2.message))}},onCancel:()=>He(!1),userId:X,storyId:Y}),(0,c.jsx)(hU,{isOpen:fe,onClose:()=>ge(!1),assets:Z.assets,onSavePresets:tn,resolution:Xt,assetsMap:at}),(0,c.jsx)(y2,{isOpen:Ge,onClose:()=>Xe(!1),sceneElements:Ft(),resolution:Xt,activeFragmentData:Yt,computedStyles:GZ(Z,re,_e),weatherSettings:Ke,cameraSettings:Dt,textAnimSettings:BZ(Z,re),animationSettings:Ct(kt),assetsMap:at,duration:(null===(G=Ct(kt))||void 0===G?void 0:G.duration)||5,fps:30})]})};function w2(e){const t=String(e).trim(),n=t.match(/^([+\-])\s*\((-?\d+)-(-?\d+)\)$/);if(n)return{type:"modify_range",op:n[1],value:[parseInt(n[2]),parseInt(n[3])]};const r=t.match(/^(-?\d+)-(-?\d+)$/);return r?{type:"set_range",op:null,value:[parseInt(r[1]),parseInt(r[2])]}:t.startsWith("+")||t.startsWith("-")?{type:"modify",op:t[0],value:parseInt(t.slice(1))}:t.startsWith(">")||t.startsWith("<")||t.startsWith("=")?{type:"check",op:t[0],value:parseInt(t.slice(1))}:{type:"set",op:null,value:parseInt(t)}}function S2(e,t,n,r){const o=t[e.toLowerCase().trim()]||0;let i=!1;if((">"===n&&o>r||"<"===n&&o<r||"="===n&&o===r)&&(i=!0),i)return{passed:!0,reason:null};let a="";a=">"===n?"\u0431\u043e\u043b\u044c\u0448\u0435 ".concat(r):"<"===n?"\u043c\u0435\u043d\u044c\u0448\u0435 ".concat(r):"\u0440\u0430\u0432\u043d\u043e ".concat(r);return{passed:!1,reason:'\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 "'.concat(e,'" \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430. \u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e ').concat(a,". \u0422\u0435\u043a\u0443\u0449\u0435\u0435: ").concat(o)}}function k2(e,t){let n=s({},e),r=[];return t.forEach(e=>{var t;const o=null===(t=e.stat)||void 0===t?void 0:t.toLowerCase().trim();if(!o)return;const i=w2(e.value);let a=0;if(a="set_range"===i.type||"modify_range"===i.type?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e>t&&([e,t]=[t,e]);const r=[];for(let s=e;s<=t;s++)r.push(s);if(!n||0===n.length)return r[Math.floor(Math.random()*r.length)];let o=new Array(r.length).fill(1);n.forEach(n=>{const r=n.value,i=n.prob;if(r>=e&&r<=t){const t=r-e,n=1+i/100;o[t]*=n,o[t]<0&&(o[t]=0)}});const i=o.reduce((e,t)=>e+t,0);if(0===i)return r[Math.floor(Math.random()*r.length)];let a=Math.random()*i;for(let s=0;s<r.length;s++)if(a-=o[s],a<=0)return r[s];return r[r.length-1]}(i.value[0],i.value[1],e.modifiers):i.value,"check"===i.type);else if("set"===i.type||"set_range"===i.type)n[o]=a,e.hide||r.push("".concat(e.stat,": \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e ").concat(a));else if("modify"===i.type||"modify_range"===i.type){const t=n[o]||0;"+"===i.op?(n[o]=t+a,e.hide||r.push("".concat(e.stat,": +").concat(a))):(n[o]=t-a,e.hide||r.push("".concat(e.stat,": -").concat(a)))}}),{newStats:n,updates:r}}const C2=t=>{let{authorId:n,storyId:r,playerId:o,currentFragId:i,playerStats:a,gameData:l,activeFragmentText:c,setCurrentFragId:d,setPlayerStats:u,setNotifications:p,isOfflineMode:h}=t;const[f,g]=(0,e.useState)(!1),[m,v]=(0,e.useState)({}),y="vn_saves_".concat(r||"offline"),x="vn_progress_".concat(r||"offline"),b=()=>{try{return JSON.parse(localStorage.getItem(y)||"{}")}catch(M2){return{}}},w=e=>{localStorage.setItem(y,JSON.stringify(e))};return{isMenuOpen:f,setIsMenuOpen:g,savesList:m,handleOpenMenu:async()=>{if(g(!0),h)v(b());else try{const e=await Gl(0,r,o);v(e||{})}catch(M2){console.error("Failed to load saves",M2)}},handleSaveGame:async()=>{var e;const t=c?c.slice(0,20)+"...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",n=(null===l||void 0===l||null===(e=l.story)||void 0===e?void 0:e.title)||"\u0418\u0441\u0442\u043e\u0440\u0438\u044f",s={fragment_id:i,stats:a,text_preview:t,story_title:n,timestamp:Date.now()};if(h)try{const e=b();e["save_"+Date.now()]=s,w(e),v(e),alert("\u0418\u0433\u0440\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430 (Offline)!")}catch(M2){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432 LocalStorage (\u043c\u0435\u0441\u0442\u043e \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u043e\u0441\u044c?)")}else try{await async function(e,t,n,r){await fetch("/api/html/saves/".concat(t,"/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}(0,r,o,s);const e=await Gl(0,r,o);v(e),alert("\u0418\u0433\u0440\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430!")}catch(M2){console.error(M2),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435")}},handleLoadGame:async e=>{if(!e)return;u(e.stats||{}),d(e.fragment_id||"main_1"),g(!1);const t={fragment_id:e.fragment_id||"main_1",current_effects:e.stats||{},timestamp:Date.now()};h?localStorage.setItem(x,JSON.stringify(t)):Hl(0,r,o,t)},handleDeleteSave:async e=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435?"))if(h){const t=b();delete t[e],w(t),v(t)}else try{await async function(e,t,n,r){await fetch("/api/html/saves/".concat(t,"/").concat(n,"/").concat(r),{method:"DELETE"})}(0,r,o,e),v(t=>{const n=s({},t);return delete n[e],n})}catch(M2){console.error(M2)}},handleRestartGame:async()=>{window.confirm("\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0438\u0433\u0440\u0443? \u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0431\u0443\u0434\u0435\u0442 \u0441\u0431\u0440\u043e\u0448\u0435\u043d.")&&(d("main_1"),u({}),p&&p([]),g(!1),h?localStorage.removeItem(x):await async function(e,t,n){await fetch("/api/html/progress/".concat(t,"/").concat(n),{method:"DELETE"})}(0,r,o))}}},j2=function(t,n,r,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{music:.5,sfx:1};const a=(0,e.useRef)(null),s=(0,e.useRef)(null),l=(0,e.useRef)([]),c=(0,e.useRef)(null),d=(0,e.useRef)(0),u=(0,e.useRef)(new Set),p=(0,e.useRef)([]),h=(0,e.useRef)(0),f=(0,e.useRef)(!0),g=(0,e.useRef)(i);(0,e.useEffect)(()=>{g.current=i},[i]),(0,e.useEffect)(()=>{a.current&&(a.current.volume=.5*i.music),s.current&&!s.current._isFading&&(s.current.volume=1*i.music),l.current.forEach(e=>{if(e.audio){const t=void 0!==e.config.volume?e.config.volume:1;e.audio.volume=t*i.sfx}})},[i.music,i.sfx]);const m=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sfx";if(!e)return null;const o=new Audio(e);o.loop=t,o._rawSrc=e,o._isFading=!1;const i=g.current,a="music"===r?i.music:i.sfx;return o.volume=n*a,o},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(!e)return;if(e.paused)return void(e.currentTime=0);e._isFading=!0;const n=e.volume,r=.05,o=setInterval(()=>{e.volume>r?e.volume=Math.max(0,e.volume-r):(e.volume=0,e.pause(),e.currentTime=0,e._isFading=!1,clearInterval(o),u.current.delete(o))},t/(n/r||1));u.current.add(o),e._fadeInterval=o},y=(0,e.useCallback)((e,t)=>{if(!e)return;const n=e.play();void 0!==n&&n.catch(e=>{"NotAllowedError"===e.name&&console.warn("[Audio] Autoplay blocked for ".concat(t))})},[]),x=(0,e.useCallback)(()=>{var e,n;if(!f.current)return;const r=(null===t||void 0===t||null===(e=t.audio)||void 0===e?void 0:e.playlist)||[];if(0===r.length)return;const o=(null===t||void 0===t||null===(n=t.audio)||void 0===n?void 0:n.playlist_mode)||"loop";if(a.current){if(!a.current.paused)return;a.current.pause(),a.current.currentTime=0}let i=r[h.current];i||(h.current=0,i=r[0]);const s=m(i.src,!1,.5,"music");s&&(s.onended=()=>{f.current&&(h.current="shuffle"===o?Math.floor(Math.random()*r.length):(h.current+1)%r.length,a.current=null,x())},a.current=s,y(s,"global"))},[t,y]),b=(0,e.useMemo)(()=>JSON.stringify({id:r,audio:null===n||void 0===n?void 0:n.audio}),[r,n]);(0,e.useEffect)(()=>{if(!n&&!t)return;const e=(null===n||void 0===n?void 0:n.audio)||{},o=e.music||{action:"continue"};if("play"===o.action){f.current=!1,a.current&&a.current.pause();const e=s.current;if(e&&e._rawSrc===o.src)!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return;e._fadeInterval&&(clearInterval(e._fadeInterval),u.current.delete(e._fadeInterval),e._fadeInterval=null),e._isFading=!1;const n=1*t;e.volume=n,e.paused&&e.play().catch(e=>{})}(e,g.current.music);else{s.current&&v(s.current,500);const e=o.src;if(e){const t=1e3*(o.start_delay||0),n=setTimeout(()=>{const t=m(e,"loop"===o.on_finish,1,"music");t&&(s.current=t,"return_global"===o.on_finish&&(t.onended=()=>{s.current=null,f.current=!0,x()}),y(t,"local"))},t);p.current.push(n)}}}else if("stop"===o.action){if(f.current=!1,a.current&&v(a.current,1e3),s.current){const e=1e3*(o.stop_delay||0);if(e>0){const t=setTimeout(()=>v(s.current),e);p.current.push(t)}else v(s.current,500)}}else"main_1"===r&&(f.current=!0,s.current&&(v(s.current,500),s.current=null)),s.current||f.current&&(a.current&&a.current.paused?y(a.current,"global"):a.current||x());return l.current.forEach(e=>{e.audio&&(e.audio.pause(),e.audio.currentTime=0)}),l.current=[],e.sfx&&e.sfx.forEach(e=>{const t={config:e,audio:null,id:e.id},n=()=>{const n=m(e.src,!0===e.loop,e.volume||1,"sfx");n&&(t.audio=n,y(n,"sfx"))};if("start"===e.trigger)n();else if("timer"===e.trigger){const t=setTimeout(n,1e3*(e.trigger_val||0));p.current.push(t)}if("timer"===e.stop_trigger){const n=setTimeout(()=>{t.audio&&v(t.audio,500)},1e3*(e.stop_val||0));p.current.push(n)}l.current.push(t)}),()=>{p.current.forEach(e=>clearTimeout(e)),p.current=[],l.current.forEach(e=>{e.audio&&(e.audio.pause(),e.audio.currentTime=0)})}},[b,t,x,y,r]);const w=(0,e.useCallback)(()=>{var e,r;const o=null===n||void 0===n||null===(e=n.audio)||void 0===e?void 0:e.click_sound_override,i=null===t||void 0===t||null===(r=t.audio)||void 0===r?void 0:r.click_sound,a=o||i;if(a){const e=Date.now();if(e-d.current<150)return;d.current=e,c.current&&(c.current.pause(),c.current.currentTime=0);const t=new Audio(a);t.volume=.5*g.current.sfx,c.current=t,t.play().catch(e=>{})}},[n,t]);return{playClickSound:w,handleLayerClick:(0,e.useCallback)(e=>{l.current.forEach(t=>{if("click_layer"===t.config.trigger&&t.config.trigger_val===e){const e=m(t.config.src,!1,t.config.volume,"sfx");e&&(t.audio&&t.audio.pause(),t.audio=e,e.play().catch(e=>{}))}"click_layer"===t.config.stop_trigger&&t.config.stop_val===e&&t.audio&&v(t.audio,300)})},[]),handleLayerVisibilityUpdate:(0,e.useCallback)((e,t)=>{const n=g.current.sfx;l.current.forEach(r=>{if("layer_visibility"===r.config.trigger&&r.config.trigger_val===e){const e=r.config.visibility_mode||"hard",o=void 0!==r.config.volume?r.config.volume:1,i=void 0===r.config.loop||r.config.loop;let a=0;t>0&&(a="smooth"===e?o*n*t:o*n),a=Math.max(0,Math.min(1,a)),a>0?!r.audio||r.audio.paused?(r.audio||(r.audio=m(r.config.src,i,o,"sfx")),r.audio&&(r.audio.volume=a,y(r.audio,"sfx"))):Math.abs(r.audio.volume-a)>.001&&(r.audio.volume=a):r.audio&&!r.audio.paused&&(r.audio.pause(),r.audio.currentTime=0)}})},[]),handleAnimationEvent:(0,e.useCallback)(e=>{l.current.forEach(t=>{if("animation_event"===t.config.trigger&&t.config.trigger_val===e){const e=m(t.config.src,!0===t.config.loop,t.config.volume||1,"sfx");e&&(t.audio&&(t.audio.pause(),t.audio.currentTime=0),t.audio=e,y(e,"sfx"))}"animation_event"===t.config.stop_trigger&&t.config.stop_val===e&&t.audio&&v(t.audio,500)})},[y]),handleTextEvent:(0,e.useCallback)(e=>{l.current.forEach(t=>{if("text_event"===t.config.trigger&&t.config.trigger_val===e){const e=m(t.config.src,!0===t.config.loop,t.config.volume||1,"sfx");e&&(t.audio&&(t.audio.pause(),t.audio.currentTime=0),t.audio=e,y(e,"sfx"))}"text_event"===t.config.stop_trigger&&t.config.stop_val===e&&t.audio&&v(t.audio,500)})},[y])}},_2=t=>{let{isOpen:n,onClose:r,onConfirm:o}=t;const[i,a]=(0,e.useState)("initial"),[l]=(0,e.useState)(()=>"user_"+Math.random().toString(36).substr(2,9)),[d,u]=(0,e.useState)(""),[p,h]=(0,e.useState)("");if(!n)return null;const f={marginTop:"15px",padding:"10px 20px",cursor:"pointer",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"5px",fontSize:"14px",width:"100%"},g=s(s({},f),{},{backgroundColor:"#333",border:"1px solid #555",marginTop:"10px"});return(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.85)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"Arial, sans-serif"},children:(0,c.jsxs)("div",{style:{backgroundColor:"#1a1a1a",padding:"25px",borderRadius:"12px",width:"90%",maxWidth:"400px",color:"#fff",border:"1px solid #444",textAlign:"center",boxShadow:"0 0 20px rgba(0,0,0,0.5)"},children:[(0,c.jsx)("h3",{style:{margin:"0 0 15px 0"},children:"\u26a0\ufe0f \u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0418\u0433\u0440\u043e\u043a\u0430"}),"initial"===i?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{style:{fontSize:"14px",lineHeight:"1.5",color:"#ccc"},children:"\u0412\u044b \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u0438\u0433\u0440\u0443 \u043f\u043e \u043f\u0440\u044f\u043c\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435, \u0430 \u043d\u0435 \u0447\u0435\u0440\u0435\u0437 Telegram-\u0431\u043e\u0442\u0430. \u0427\u0442\u043e\u0431\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438, \u0432\u0430\u043c \u043d\u0443\u0436\u0435\u043d \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 ID."}),(0,c.jsxs)("div",{style:{margin:"20px 0",padding:"15px",background:"#222",borderRadius:"8px",border:"1px dashed #666"},children:[(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888",marginBottom:"5px"},children:"\u0412\u0430\u0448 \u043d\u043e\u0432\u044b\u0439 ID:"}),(0,c.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",letterSpacing:"1px",color:"#4CAF50"},children:l})]}),(0,c.jsx)("p",{style:{fontSize:"12px",color:"#888"},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u044d\u0442\u043e\u0442 ID! \u0415\u0441\u043b\u0438 \u0432\u044b \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u0435 \u043a\u044d\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430, \u0432\u0430\u043c \u043f\u0440\u0438\u0434\u0435\u0442\u0441\u044f \u0432\u0432\u0435\u0441\u0442\u0438 \u0435\u0433\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e, \u0447\u0442\u043e\u0431\u044b \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441."}),(0,c.jsx)("button",{style:f,onClick:()=>{o(l)},children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u044d\u0442\u043e\u0442 ID"}),(0,c.jsx)("button",{style:g,onClick:()=>a("input"),children:"\u0423 \u043c\u0435\u043d\u044f \u0443\u0436\u0435 \u0435\u0441\u0442\u044c ID"}),(0,c.jsx)("button",{style:s(s({},g),{},{backgroundColor:"transparent",border:"none",fontSize:"12px"}),onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430 (\u0411\u0435\u0437 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0439)"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{style:{fontSize:"14px",color:"#ccc"},children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 ID, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u0440\u0430\u043d\u0435\u0435:"}),(0,c.jsx)("input",{type:"text",placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: user_x7z9...",value:d,onChange:e=>{u(e.target.value),h("")},style:{width:"100%",padding:"10px",marginTop:"10px",backgroundColor:"#333",border:"1px solid #555",color:"#fff",borderRadius:"4px",boxSizing:"border-box"}}),p&&(0,c.jsx)("div",{style:{color:"#ff5555",fontSize:"12px",marginTop:"5px"},children:p}),(0,c.jsx)("button",{style:f,onClick:()=>{const e=d.trim();e.length<3?h("ID \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439"):o(e)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,c.jsx)("button",{style:g,onClick:()=>{a("initial"),h("")},children:"\u041d\u0430\u0437\u0430\u0434"})]})]})})},E2=t=>{var n,r,o,i,a,l,d,u,p,h,f,g,m;let{playerId:v}=t;const y=window.IS_OFFLINE_EXPORT||!!window.OFFLINE_GAME_DATA,[x,b]=(0,e.useState)(()=>{if(y)return"offline_player";if(v&&"undefined"!==v&&"null"!==v)return v;return localStorage.getItem("vn_custom_player_id")||null}),[w,S]=(0,e.useState)(!1),[k,C]=(0,e.useState)(null),j=window.location.pathname.match(/\/([^_]+)_(.+)\/html\/play$/),_=j?j[1]:"offline_author",E=j?j[2]:"offline_story",[D,M]=(0,e.useState)({}),[T,I]=(0,e.useState)(null),[A,O]=(0,e.useState)(0),[R,z]=(0,e.useState)({current:0,total:0,logs:[]}),F=(0,e.useRef)(null),[P,B]=(0,e.useState)(null),[L,N]=(0,e.useState)({}),[U,V]=(0,e.useState)(!0),[W,H]=(0,e.useState)(null),[G,X]=(0,e.useState)("main_1"),[Y,q]=(0,e.useState)({}),[Z,$]=(0,e.useState)([]);(0,e.useEffect)(()=>{M({})},[G]);const[K,J]=(0,e.useState)({scale:1,mode:"desktop",resolution:{width:1280,height:720}}),Q=(0,e.useRef)(!1),ee=(0,e.useRef)(new Map),[te,ne]=(null===P||void 0===P||null===(n=P.visuals)||void 0===n||null===(r=n.global_settings)||void 0===r||null===(o=r.audio)||void 0===o||o.typing_sound,(0,e.useState)(0)),[re,oe]=(0,e.useState)(0),[ie,ae]=(0,e.useState)({}),se=(0,e.useRef)(0),le=(0,e.useRef)(null),ce=(0,e.useRef)(null),de=(0,e.useRef)(null),ue=(0,e.useRef)(0),pe="mobile"===K.mode?"animations_mobile":"animations_desktop";(0,e.useEffect)(()=>{U&&F.current&&F.current.scrollIntoView({behavior:"smooth"})},[R.logs,U]);const he=(e,t,n,r)=>{var o;if(!t||!e)return[];const i=(null===(o=(t.visuals||{}).fragments)||void 0===o?void 0:o[e])||{},a=[],s=e=>n[e]||e;i.bg_image&&(i.bg_image.endsWith(".mp4")||a.push(s(i.bg_image))),i.layers&&i.layers.forEach(e=>{const t=e.file_id||e.src;t&&!t.endsWith(".mp4")&&a.push(s(t))});const l=i.styles||{};return["text_box_texture","btn_texture","btn_global_object"].forEach(e=>{const t=l[e]||l["".concat(e,"_mobile")]||l["".concat(e,"_desktop")];t&&a.push(s(t))}),l.btn_objects&&Object.values(l.btn_objects).forEach(e=>a.push(s(e))),a},fe=(0,e.useMemo)(()=>{var e,t,n;const r=(null===P||void 0===P||null===(e=P.visuals)||void 0===e?void 0:e.global_settings)||{},o=(null===P||void 0===P||null===(t=P.visuals)||void 0===t||null===(n=t.fragments)||void 0===n?void 0:n[G])||{},i=r[pe]||r.animations,a=o[pe]||o.animations,s=a&&(a.groups||a.elements)?a:i;return UB(s).groups||[]},[P,G,pe]),[ge,me]=(0,e.useState)({musicVolume:.5,sfxVolume:1,textSpeed:1,isParallaxOff:!1,isFullscreen:!1}),ve=(0,e.useMemo)(()=>({music:ge.musicVolume,sfx:ge.sfxVolume}),[ge.musicVolume,ge.sfxVolume]),{playClickSound:ye,handleLayerClick:xe,handleLayerVisibilityUpdate:be,handleAnimationEvent:we,handleTextEvent:Se}=j2(U?null:null===P||void 0===P||null===(i=P.visuals)||void 0===i?void 0:i.global_settings,U?null:null===P||void 0===P||null===(a=P.visuals)||void 0===a||null===(l=a.fragments)||void 0===l?void 0:l[G],G,L,ve);(0,e.useEffect)(()=>{const e={};fe.forEach(t=>{t.enabled&&"start"===t.trigger&&(e[t.id]=0)}),ae(e),ne(0),oe(0),Pe(0);const t=performance.now();se.current=t,ue.current=t},[fe,G]);const ke=Object.keys(ie).length>0;(0,e.useEffect)(()=>{if(!ke)return void(ce.current&&cancelAnimationFrame(ce.current));ue.current=performance.now();const e=t=>{const n=(t-ue.current)/1e3;ue.current=t;const r=n>.1?.1:n;ae(e=>{const t=s({},e);let n=!1;return Object.keys(e).forEach(o=>{const i=fe.find(e=>e.id===o);if(!i)return delete t[o],void(n=!0);const a=e[o];let s=a+r;const l=i.duration||1;i.events&&i.events.length>0&&i.events.forEach(e=>{e.time>a&&e.time<=s&&we(e.name)}),s>=l&&(i.loop?(i.events&&i.events.forEach(e=>{e.time>a&&e.time<=l&&we(e.name)}),s%=l):(s=l,de.current&&de.current.groupId===o&&(de.current.action(),de.current=null))),e[o]!==s&&(t[o]=s,n=!0)}),n?t:e}),ce.current=requestAnimationFrame(e)};return ce.current=requestAnimationFrame(e),()=>{ce.current&&cancelAnimationFrame(ce.current)}},[ke,fe,we]);const Ce=(e,t,n)=>{const r=e||{enabled:!1};return void 0!==n[t]?s(s({},r),{},{enabled:n[t]}):r},je=(null===P||void 0===P||null===(d=P.visuals)||void 0===d||null===(u=d.fragments)||void 0===u||null===(p=u[G])||void 0===p?void 0:p.effects)||{},_e=(0,e.useMemo)(()=>Ce(je.noise,"noise",D),[je.noise,D]),Ee=(0,e.useMemo)(()=>Ce(je.glitch,"glitch",D),[je.glitch,D]),De=(0,e.useMemo)(()=>Ce(je.darkness,"darkness",D),[je.darkness,D]),Me=(0,e.useMemo)(()=>Ce(je.textureOverlay,"textureOverlay",D),[je.textureOverlay,D]),Te=(0,e.useMemo)(()=>{var e;if(ge.isParallaxOff)return!1;const t=(null===(e=je.parallax)||void 0===e?void 0:e.enabled)||!1;return void 0!==D.parallax?D.parallax:t},[je.parallax,D,ge.isParallaxOff]),Ie=(0,e.useMemo)(()=>{const e="mobile"===K.mode?"sceneLight_mobile":"sceneLight_desktop",t=je[e]||je.sceneLight;return Ce(t,"sceneLight",D)},[je,K.mode,D]),Ae=(0,e.useMemo)(()=>{var e,t,n,r,o,i,a,l;if(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||null===(r=n.effects)||void 0===r||!r.colorCorrection)return null;const c=null===P||void 0===P||null===(o=P.visuals)||void 0===o||null===(i=o.fragments)||void 0===i||null===(a=i[G])||void 0===a||null===(l=a.effects)||void 0===l?void 0:l.colorCorrection;return c&&void 0!==D.colorCorrection?s(s({},c),{},{enabled:D.colorCorrection}):c},[P,G,D]),Oe=(0,e.useMemo)(()=>{var e,t,n;const r=null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n?void 0:n.effects;if(!r)return null;const o=r["mobile"===K.mode?"sceneLight_mobile":"sceneLight_desktop"]||r.sceneLight;return null===o||void 0===o?void 0:o.animation},[P,G,K.mode]),Re=(0,e.useMemo)(()=>{var e;return Oe&&Oe.activeGroupId?null===(e=Oe.groups)||void 0===e?void 0:e.find(e=>e.id===Oe.activeGroupId):null},[Oe]),ze=(0,e.useMemo)(()=>{var e,t,n,r,o;return((null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||null===(r=n.effects)||void 0===r||null===(o=r.sceneLight)||void 0===o?void 0:o.sources)||[]).some(e=>e.presetLight&&"none"!==e.presetLight.type||e.presetMotion&&"none"!==e.presetMotion.type)},[P,G]),[Fe,Pe]=(0,e.useState)(0),[Be,Le]=(0,e.useState)(!1);(0,e.useEffect)(()=>{Pe(0)},[G]),(0,e.useEffect)(()=>{const e=(null===Re||void 0===Re?void 0:Re.enabled)&&(!Re.trigger||"start"===Re.trigger);Le(!(!e&&!ze))},[Re,ze]),(0,e.useEffect)(()=>{if(!Be)return;let e,t=performance.now();const n=()=>{const r=performance.now(),o=(r-t)/1e3;t=r,Pe(e=>e+o),e=requestAnimationFrame(n)};return e=requestAnimationFrame(n),()=>cancelAnimationFrame(e)},[Be]);const[Ne,Ue]=(0,e.useState)(0),[Ve,We]=(0,e.useState)(!1);(0,e.useEffect)(()=>{Ue(0);const e=null===Ae||void 0===Ae?void 0:Ae.animation;null===e||void 0===e||!e.enabled||e.trigger&&"start"!==e.trigger?We(!1):We(!0)},[G,Ae]),(0,e.useEffect)(()=>{var e;if(!Ve||null===Ae||void 0===Ae||null===(e=Ae.animation)||void 0===e||!e.enabled)return;let t,n=performance.now();const r=()=>{const e=performance.now(),o=(e-n)/1e3;n=e,Ue(e=>e+o),t=requestAnimationFrame(r)};return t=requestAnimationFrame(r),()=>cancelAnimationFrame(t)},[Ve,Ae]);const He=(0,e.useMemo)(()=>{var e,t,n,r,o,i,a;if(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||!n.effects)return{};const l=(null===P||void 0===P||null===(r=P.visuals)||void 0===r||null===(o=r.fragments)||void 0===o||null===(i=o[G])||void 0===i||null===(a=i.effects)||void 0===a?void 0:a.camera)||{};return void 0!==D.camera?s(s({},l),{},{enabled:D.camera}):l},[P,G,D]),Ge=(0,e.useMemo)(()=>{if(!P||!P.story.fragments[G])return"";return function(e,t){if(!e)return"";let n=e;const r={};return Object.keys(t).forEach(e=>{r[e.trim().toLowerCase()]=t[e]}),n=n.replace(/\{\{\s*([a-zA-Z\u0430-\u044f\u0410-\u042f\u0451\u04010-9_]+)\s*:\s*([<>=])\s*(\d+)(?:\s*-\s*(\d+))?\s*\}\}([\s\S]*?)\{\{\s*\1\s*\}\}/gi,(e,t,n,o,i,a)=>{const s=t.trim().toLowerCase(),l=r[s]||0,c=parseInt(o);let d=c;if(i){const e=parseInt(i);d=Math.floor(Math.random()*(Math.abs(e-c)+1))+Math.min(c,e)}let u=!1;return(">"===n&&l>d||"<"===n&&l<d||"="===n&&l===d)&&(u=!0),u?a:""}),n=n.replace(/\{\{\{\s*([a-zA-Z\u0430-\u044f\u0410-\u042f\u0451\u04010-9_]+)\s*\}\}\}/gi,(e,t)=>{const n=t.trim().toLowerCase();return void 0!==r[n]?r[n]:"0"}),n}(P.story.fragments[G].text,Y)},[P,G,Y]),Xe=(0,e.useMemo)(()=>{var e,t;if(!P)return{text:"",choices:[]};const n=P.story.fragments[G];if(!n)return{text:"",choices:[]};const r=(null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t?void 0:t[G])||{},o=(n.choices||[]).map((e,t)=>{const n=e.effects||[];let r=!0,o=!1,i=null,a=[];for(let s of n){const e=w2(s.value);if("check"===e.type){const t=S2(s.stat,Y,e.op,e.value);t.passed?s.hide||a.push({stat:"",value:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430",isError:!1}):s.hide?r=!1:(o=!0,i||(i=t.reason),a.push({stat:"",value:t.reason,isError:!0}))}}if(!r)return null;const l=(e.text||"").trim(),c=/^\d+$/.test(l),d=c?parseInt(l,10):null;return s(s({},e),{},{isDisabled:o,lockReason:i,visibleChecks:a,originalIndex:t,isTimer:c,timerSeconds:d})}).filter(Boolean);return{text:Ge,choices:o,effects:r.effects||{}}},[P,G,Y,Ge]),Ye=(0,e.useMemo)(()=>{var e,t,n,r,o;const i=(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.global_settings)||void 0===t?void 0:t.animations)||{},a=(null===P||void 0===P||null===(n=P.visuals)||void 0===n||null===(r=n.fragments)||void 0===r||null===(o=r[G])||void 0===o?void 0:o.animations)||{};return void 0!==a.enabled?a:i},[P,G]),qe=(0,e.useMemo)(()=>{var e,t,n;const r=null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n?void 0:n.effects,o="mobile"===K.mode?"weather_mobile":"weather_desktop",i=(null===r||void 0===r?void 0:r[o])||(null===r||void 0===r?void 0:r.weather);if(!i||!i.enabled)return!1;return(i.layers||[i]).some(e=>!(!e.blockingZones||!Array.isArray(e.blockingZones))&&e.blockingZones.some(e=>e.enabled&&e.animation&&e.animation.enabled))},[P,G,K.mode]),Ze=(0,e.useMemo)(()=>{var e,t,n,r;const o=null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||null===(r=n.effects)||void 0===r?void 0:r.colorCorrection;return o&&o.enabled&&o.animation&&o.animation.enabled},[P,G]),$e=Ye.enabled||qe||He.enabled||Ze||(null===Re||void 0===Re?void 0:Re.enabled);(0,e.useEffect)(()=>{if(!P||U)return;ee.current.size>150&&ee.current.clear();const e=new Set(he(G,P,L,K.mode));e.forEach(e=>{e&&!ee.current.has(e)&&ee.current.set(e,!0)});const t=Xe.choices.map(e=>e.target).filter(e=>e&&P.story.fragments[e]);[...new Set(t)].forEach(t=>{he(t,P,L,K.mode).forEach(t=>{e.has(t)||ee.current.has(t)||(e=>{if(!e)return;if(ee.current.has(e))return;const t=new Image;t.src=e,ee.current.set(e,t),t.decode&&t.decode().catch(e=>{})})(t)})})},[G,P,Xe,L,K.mode,U]),(0,e.useEffect)(()=>{if(!$e)return ne(0),oe(0),Pe(0),void(le.current&&cancelAnimationFrame(le.current));const e=Ye.enabled?Ye.duration||10:99999999;null===Re||void 0===Re||Re.duration;se.current=performance.now();const t=n=>{const r=performance.now(),o=(r-se.current)/1e3;se.current=r;const i=o>.1?.1:o;oe(e=>e+i),ne(t=>{let n=t+i;const r=!Ye.enabled||Ye.loop;return n>=e&&(r?n%=e:n=e),n}),le.current=requestAnimationFrame(t)};return le.current=requestAnimationFrame(t),()=>{le.current&&cancelAnimationFrame(le.current)}},[$e,Ye,G,Re]),(0,e.useEffect)(()=>{const e=document.body.style.margin,t=document.body.style.overflow,n=document.documentElement.style.overflow,r=document.body.style.backgroundColor,o=document.body.style.touchAction;document.body.style.margin="0",document.body.style.padding="0",document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.backgroundColor="#000",document.body.style.touchAction="pinch-zoom",document.body.style.touchAction="pinch-zoom";const i=e=>{e.touches.length>1||e.cancelable&&e.preventDefault()};return document.addEventListener("touchmove",i,{passive:!1}),()=>{document.body.style.margin=e,document.body.style.overflow=t,document.documentElement.style.overflow=n,document.body.style.backgroundColor=r,document.body.style.touchAction=o,document.removeEventListener("touchmove",i)}},[]);const[Ke,Je]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=()=>{me(e=>s(s({},e),{},{isFullscreen:!!document.fullscreenElement}))};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]);(0,e.useEffect)(()=>{const e=y?"offline_story":E;(async()=>{try{let t;if(y){if(console.log("Loading offline data..."),t=window.OFFLINE_GAME_DATA,!t)throw new Error("No offline data found");try{const t="vn_progress_".concat(e),n=localStorage.getItem(t);if(n){const e=JSON.parse(n);e.fragment_id&&X(e.fragment_id),e.current_effects&&q(e.current_effects)}}catch(M2){console.warn("Offline load error",M2)}}else{if(!_||!E)return;const e=await fetch("/api/html/play-data/".concat(_,"/").concat(E));if(!e.ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438");if(t=await e.json(),x)try{const e=await async function(e,t,n){try{const e=await fetch("/api/html_story_settings/".concat(t,"/").concat(n));return e.ok?await e.json():null}catch(M2){return null}}(0,E,x);e&&(e.fragment_id&&X(e.fragment_id),e.current_effects&&q(e.current_effects))}catch(M2){console.warn("\u041d\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",M2)}}B(t),hJ(t,(e,t,n)=>z(r=>({current:e,total:t,logs:[...r.logs||[],n].slice(-50)})),e=>{N(e),setTimeout(()=>V(!1),500)})}catch(t){console.error("Critical Load Error:",t),H(t.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438")}})()},[_,E,x,y]),(0,e.useEffect)(()=>{var e,t,n;if(!P)return;const r=(null===(e=P.visuals)||void 0===e||null===(t=e.assets)||void 0===t?void 0:t.sys_fonts)||(null===(n=P.assets)||void 0===n?void 0:n.sys_fonts);let o=[];if(Array.isArray(r)?o=r:null!==r&&void 0!==r&&r.files&&(o=r.files),!o||0===o.length)return;const i=o.map(e=>{const t=L[e.file_id]||L[e.local_path]||L[e.url]||e.url||e.local_path;return s(s({},e),{},{url:t})});kJ(i)},[P,L]),(0,e.useEffect)(()=>{if(!P)return;const e=()=>{var e;const t=(null===(e=P.visuals)||void 0===e?void 0:e.global_settings)||{},n=t.play_mode||"adaptive",r=t.resolution_desktop||{width:1280,height:720},o=t.resolution_mobile||{width:480,height:800};let i="desktop";i="desktop_only"===n?"desktop":"mobile_only"===n||window.innerWidth<768?"mobile":"desktop";const a="mobile"===i?o:r,s=window.devicePixelRatio||1,l=window.visualViewport?window.visualViewport.width:window.innerWidth,c=(window.visualViewport?window.visualViewport.height:window.innerHeight)*s,d=l*s/a.width,u=c/a.height;let p=Math.min(d,u);p>1&&(p=1);J({scale:p/s,mode:i,resolution:a})};return window.addEventListener("resize",e),window.visualViewport&&window.visualViewport.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e),window.visualViewport&&window.visualViewport.removeEventListener("resize",e)}},[P]);const Qe=(e,t)=>{if(Q.current)return;Q.current=!0;const{newStats:n,updates:r}=k2(Y,t||[]);if(q(n),e&&P.story.fragments[e]){X(e);const t=y?E||"offline":E,r={fragment_id:e,current_effects:n,timestamp:Date.now()};y?localStorage.setItem("vn_progress_".concat(t),JSON.stringify(r)):x&&Hl(0,E,x,r)}setTimeout(()=>{Q.current=!1},500)},et=e=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const n=Date.now();I({text:e,type:t,id:n})}(e||"\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b","fail")},tt=(0,e.useMemo)(()=>{var e,t,n,r,o;const i=(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.global_settings)||void 0===t?void 0:t.stats_settings)||{},a=(null===P||void 0===P||null===(n=P.visuals)||void 0===n||null===(r=n.fragments)||void 0===r||null===(o=r[G])||void 0===o?void 0:o.stats_settings)||{};return s(s({},i),a)},[P,G]);(0,e.useEffect)(()=>{const e=Xe.choices.filter(e=>e.isTimer&&!e.isDisabled);if(e.length>0){e.sort((e,t)=>e.timerSeconds-t.timerSeconds);const t=e[0],n=setTimeout(()=>{Qe(t.target,t.effects)},1e3*t.timerSeconds);return()=>clearTimeout(n)}},[Xe,G]);const nt=(0,e.useMemo)(()=>{var e,t,n,r,o;const i=(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.global_settings)||void 0===t?void 0:t.text_animation)||{},a=(null===P||void 0===P||null===(n=P.visuals)||void 0===n||null===(r=n.fragments)||void 0===r||null===(o=r[G])||void 0===o?void 0:o.text_animation)||{};return s(s({},i),a)},[P,G]),rt=(0,e.useMemo)(()=>{var e,t,n,r,o;return!ge.isParallaxOff&&(P&&(null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||null===(r=n.effects)||void 0===r||null===(o=r.parallax)||void 0===o?void 0:o.enabled)||!1)},[P,G,ge.isParallaxOff]),{parallaxOffset:ot}=xL(!1,rt),it=C2({authorId:_,storyId:y?E||"offline":E,playerId:x,currentFragId:G,playerStats:Y,gameData:P,activeFragmentText:Xe.text,setCurrentFragId:X,setPlayerStats:q,setNotifications:$,isOfflineMode:y}),at=(e,t,n)=>{var r,o,i,a;const l=null===P||void 0===P||null===(r=P.visuals)||void 0===r||null===(o=r.fragments)||void 0===o||null===(i=o[G])||void 0===i||null===(a=i.effects)||void 0===a?void 0:a.effectControls;if("hover"===n&&console.groupCollapsed('\ud83d\uddb1\ufe0f [DEBUG] Hover Processing: "'.concat(e,'" (').concat(t,")")),!l||!Array.isArray(l))return void("hover"===n&&console.groupEnd());const c=l.filter(t=>{let r=!1;if("text"===n)r="text_event"===t.trigger&&t.eventName===e;else if("hover"===n){r=("hover_layer"===t.trigger||"hover_button"===t.trigger)&&t.triggerLayerId===e,t.triggerLayerId===e&&console.log("Checking Binding (Trigger: ".concat(t.trigger,"): Match = ").concat(r))}else r="click_layer"===t.trigger&&t.triggerLayerId===e;return r});"hover"===n&&console.log("Found ".concat(c.length," active bindings.")),0!==c.length?M(e=>{var r,o,i;const a=s({},e),l=(null===P||void 0===P||null===(r=P.visuals)||void 0===r||null===(o=r.fragments)||void 0===o||null===(i=o[G])||void 0===i?void 0:i.effects)||{};return c.forEach((e,r)=>{e.actions.forEach((o,i)=>{const s=o.effectId,c=o.mode;"hover"===n&&console.log("\ud83d\ude80 Binding #".concat(r," Action #").concat(i,': Effect="').concat(s,'", Mode="').concat(c,'"'));let d=!1;const u=l[s];u&&u.enabled&&(d=!0);const p=void 0!==a[s]?a[s]:d;let h;"text_event"===e.trigger?h="on"===c||"off"!==c&&("toggle"!==c||!p):"hover_layer"===e.trigger||"hover_button"===e.trigger?"hover_hold_on"===c||"hold"===c?("down"===t&&(h=!0),"up"===t&&(h=!1)):"hover_hold_off"===c?("down"===t&&(h=!1),"up"===t&&(h=!0)):"on"===c?"down"===t&&(h=!0):"off"===c?"down"===t&&(h=!1):console.warn('\u26a0\ufe0f Unknown mode for HOVER: "'.concat(c,'". Expected: hover_hold_on/off or hold')):"click_layer"===e.trigger&&("hold"===c?("down"===t&&(h=!0),"up"===t&&(h=!1)):"down"===t&&("on"===c?h=!0:"off"===c?h=!1:"toggle"===c&&(h=!p))),void 0!==h?(a[s]=h,"hover"===n&&console.log("\u2705 [APPLY] ".concat(s," -> ").concat(h," (Phase: ").concat(t,")"))):"hover"===n&&console.log("\u23ed\ufe0f [SKIP] No change defined for Phase: ".concat(t))})}),"hover"===n&&console.groupEnd(),a}):"hover"===n&&console.groupEnd()},st=(0,e.useMemo)(()=>{var e;return((null===P||void 0===P||null===(e=P.visuals)||void 0===e?void 0:e.global_settings)||{})["mobile"===K.mode?"menu_mobile":"menu_desktop"]||{}},[P,K.mode]),lt=(0,e.useMemo)(()=>{var e,t,n,r;if(!P)return[];const o=L||{},i=P.visuals||{},a=(null===(e=i.fragments)||void 0===e?void 0:e[G])||{},l=i.global_settings||{},c=K.mode,d="mobile"===c?"layout_mobile":"layout_desktop",u="mobile"===c?"layout_override_mobile":"layout_override_desktop",p=K.resolution,h=l[d]||{},f=[],g=e=>{if(!e)return null;const t=o[e]||e;return window.IS_OFFLINE_EXPORT&&(t.startsWith("./")||t.startsWith("assets/")||t.startsWith("data:")||(console.warn("[OFFLINE WARNING] \u041f\u043e\u0434\u043e\u0437\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0443\u0442\u044c \u0430\u0441\u0441\u0435\u0442\u0430 (\u043d\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439):",t),console.warn("   - \u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043b\u044e\u0447:",e))),t};let m=a.bg_image;if(m){var v,y,x,b,w;const e=(null===(v=a[u])||void 0===v?void 0:v.bg_layout)||a.bg_layout||{},t=g(m);f.push({id:"bg_image",type:m&&m.endsWith(".mp4")?"bg_video":"bg_image",src:t,x:null!==(y=e.x)&&void 0!==y?y:0,y:null!==(x=e.y)&&void 0!==x?x:0,w:null!==(b=e.w)&&void 0!==b?b:p.width,h:null!==(w=e.h)&&void 0!==w?w:p.height,z:0,parallaxStrength:e.parallaxStrength})}a.layers&&a.layers.forEach(e=>{var t;const n=(null===(t=a[u])||void 0===t?void 0:t[e.id])||{},r=e.file_id||e.src,o=g(r),i=s(s(s({},e),n),{},{src:o,x:void 0!==n.x?n.x:e.x||0});f.push(i)});let S=h.stat_box||{x:10,y:10,w:200,h:100,z:200};null!==(t=a[u])&&void 0!==t&&t.stat_box&&(S=s(s({},S),a[u].stat_box)),f.push(s(s({},S),{},{id:"stat_box",type:"stat_box",z:200}));const k=s(s({},(null===(n=i.global_settings)||void 0===n?void 0:n.stats_settings)||{}),a.stats_settings||{});if(k.p_stats_enabled){var C;const e=void 0!==k.p_stats_w?k.p_stats_w:200,t=void 0!==k.p_stats_h?k.p_stats_h:150;let n=p.width-e-20;n<0&&(n=10);let r={id:"player_stats_box",type:"player_stats_box",x:n,y:10,w:e,h:t,z:200,rotate:0};h.player_stats_box&&(r=s(s({},r),h.player_stats_box)),null!==(C=a[u])&&void 0!==C&&C.player_stats_box?r=s(s({},r),a[u].player_stats_box):void 0!==k.p_stats_x&&(r.x=k.p_stats_x,r.y=k.p_stats_y),f.push(s(s({},r),{},{z:200}))}let j=h.text_area||{x:50,y:p.height-250,w:p.width-100,h:200,z:100};null!==(r=a[u])&&void 0!==r&&r.text_area&&(j=s(s({},j),a[u].text_area)),f.push(s(s({},j),{},{id:"text_area",type:"text_area",text:Xe.text}));const _=Xe.choices.filter(e=>!e.isTimer),E=_.length,D=60*E+10*(E-1),M=p.height/2-D/2;let T=0;return Xe.choices.forEach((e,t)=>{var n;if(e.isTimer)return;if(e.text&&e.text.includes("{No_btn}"))return;const r=e.originalIndex,o="btn_".concat(r),i=M+70*T,l=s(s(s({},{x:p.width/2-150,y:i,w:300,h:60,z:105+r}),h[o]||{}),(null===(n=a[u])||void 0===n?void 0:n[o])||{});f.push(s(s({},l),{},{id:o,type:"button",index:t,target:e.target,effects:e.effects,text:e.text,isDisabled:e.isDisabled,lockReason:e.lockReason,visibleChecks:e.visibleChecks})),T++}),f.sort((e,t)=>(e.z||0)-(t.z||0)),f},[P,G,K,Xe,L]),[ct,dt]=(0,e.useState)(null),ut=(0,e.useMemo)(()=>{var e,t,n;if(!P)return{};const r=P.visuals||{},o=(null===(e=r.global_settings)||void 0===e?void 0:e.styles)||{},i=(null===(t=r.fragments)||void 0===t||null===(n=t[G])||void 0===n?void 0:n.styles)||{},a="mobile"===K.mode?"_mobile":"_desktop",s=(e,t)=>{const n=e+a;return void 0!==i[n]&&null!==i[n]&&""!==i[n]?i[n]:void 0!==o[n]&&null!==o[n]&&""!==o[n]?o[n]:void 0!==i[e]&&""!==i[e]&&null!==i[e]?i[e]:void 0!==o[e]&&""!==o[e]&&null!==o[e]?o[e]:t},l=e=>e&&"string"===typeof e?e.startsWith("blob:")||e.startsWith("data:")?e:L&&L[e]?L[e]:e:e;return{fontFamily:s("font_family","Arial"),textSize:s("text_size",16),textColor:s("text_color","#ffffff"),textOpacity:s("text_opacity",1),textLineHeight:s("text_line_height",1.5),textParagraphSpacing:s("text_paragraph_spacing",10),textBoxBgColor:s("text_box_bg_color","#000000"),textBoxOpacity:s("text_box_opacity",.7),textBoxBorderRadius:s("text_box_border_radius",0),textBoxBorderWidth:s("text_box_border_width",0),textBoxBorderColor:s("text_box_border_color","#ffffff"),textBoxBorderOpacity:s("text_box_border_opacity",1),textBoxTexture:l(s("text_box_texture",null)),textBoxTextureOpacity:s("text_box_texture_opacity",1),textBoxTextureBlend:s("text_box_texture_blend","normal"),textBoxTextureScaleX:s("text_box_texture_scale_x",100),textBoxTextureScaleY:s("text_box_texture_scale_y",100),textBoxTextureOffsetX:s("text_box_texture_offset_x",50),textBoxTextureOffsetY:s("text_box_texture_offset_y",50),textAlign:s("text_align","left"),textOffsetX:s("text_offset_x",0),textOffsetY:s("text_offset_y",0),textSeparatorSide:s("text_separator_side","none"),textSeparatorPos:s("text_separator_pos",70),textSeparatorVisualEnabled:s("text_separator_visual_enabled",!1),textSeparatorLineOrient:s("text_separator_line_orient","vertical"),textSeparatorLinePos:s("text_separator_line_pos",50),textSeparatorColor:s("text_separator_color","#ffffff"),textSeparatorWidth:s("text_separator_width",1),textSeparatorOpacity:s("text_separator_opacity",1),btnMode:s("btn_mode","box"),btnTexture:l(s("btn_texture",null)),btnTextureOpacity:s("btn_texture_opacity",1),btnTextureBlend:s("btn_texture_blend","normal"),btnTextureScaleX:s("btn_texture_scale_x",100),btnTextureScaleY:s("btn_texture_scale_y",100),btnTextureOffsetX:s("btn_texture_offset_x",50),btnTextureOffsetY:s("btn_texture_offset_y",50),btnGlobalObject:l(s("btn_global_object",null)),btnObjects:(()=>{const e=s("btn_objects",{}),t={};return Object.keys(e).forEach(n=>{t[n]=l(e[n])}),t})(),btnObjectOpacity:s("btn_object_opacity",1),btnObjectBlend:s("btn_object_blend","normal"),btnObjectScaleX:s("btn_object_scale_x",100),btnObjectScaleY:s("btn_object_scale_y",100),btnObjectOffsetX:s("btn_object_offset_x",50),btnObjectOffsetY:s("btn_object_offset_y",50),btnHoverEnabled:s("btn_hover_enabled",!1),btnHoverColor:s("btn_hover_color","#666666"),btnObjectHoverEnabled:s("btn_object_hover_enabled",!1),btnObjectHoverColor:s("btn_object_hover_color","#ffffff"),btnTextSize:s("btn_text_size",14),btnTextColor:s("btn_text_color","#ffffff"),btnTextOpacity:s("btn_text_opacity",1),btnBgColor:s("btn_bg_color","#444444"),btnBgOpacity:s("btn_bg_opacity",1),btnOpacity:s("btn_opacity",1),btnBorderColor:s("btn_border_color","#ffffff"),btnBorderWidth:s("btn_border_width",0),btnBorderOpacity:s("btn_border_opacity",1),btnBorderRadius:s("btn_border_radius",0),btnHideTextMap:s("btn_hide_text_map",{})}},[P,G,K.mode]),pt=(0,e.useMemo)(()=>{if(!Xe||!Xe.choices)return null;const e=Xe.choices.find(e=>e.text&&e.text.includes("{No_btn}"));if(e)return{targetId:e.target,effects:e.effects,isDisabled:e.isDisabled,lockReason:e.lockReason};const t=ut.click_anywhere_target;if(t){const e=parseInt(t.replace("btn_",""),10),n=Xe.choices.find(t=>t.originalIndex===e);if(n)return{targetId:n.target,effects:n.effects,isDisabled:n.isDisabled,lockReason:n.lockReason}}return null},[Xe,ut]),ht=(null===P||void 0===P||null===(h=P.visuals)||void 0===h?void 0:h.global_settings)||{},ft=ht.canvas_bg_color||"#000000",gt=ht.game_area_bg_color||"#ffffff",mt=(0,e.useMemo)(()=>{var e,t,n,r;if(!P||!G)return{enabled:!1};const o=null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||null===(r=n.effects)||void 0===r?void 0:r.transition;return o&&o.enabled?o:{enabled:!1,type:"fade",duration:0}},[P,G]),vt=(0,e.useMemo)(()=>{var e,t,n;if(null===P||void 0===P||null===(e=P.visuals)||void 0===e||null===(t=e.fragments)||void 0===t||null===(n=t[G])||void 0===n||!n.effects)return null;const r=fL(P.visuals.fragments[G].effects,K.mode);return r&&void 0!==D.weather?s(s({},r),{},{enabled:D.weather}):r},[P,G,K.mode,D]);let yt=gt;"flash_white"===mt.type&&(yt="white"),"flash_black"===mt.type&&(yt="black");if(U){const e=R.total>0?Math.round(R.current/R.total*100):0;return(0,c.jsxs)("div",{style:{width:"100vw",height:"100vh",background:"#111",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#fff",fontFamily:"monospace"},children:[(0,c.jsx)("div",{style:{marginBottom:"20px",fontSize:"24px",fontWeight:"bold"},children:R.total>0?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432...":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445..."}),R.total>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{width:"300px",height:"10px",background:"#333",borderRadius:"5px",overflow:"hidden",marginBottom:"10px",boxShadow:"0 0 10px rgba(0,0,0,0.5)"},children:(0,c.jsx)("div",{style:{width:"".concat(e,"%"),height:"100%",background:"linear-gradient(90deg, #4caf50, #81c784)",transition:"width 0.3s ease-out"}})}),(0,c.jsxs)("div",{style:{fontSize:"14px",color:"#aaa",marginBottom:"15px"},children:["\u0424\u0430\u0439\u043b\u044b: ",R.current," \u0438\u0437 ",R.total," (",e,"%)"]}),(0,c.jsxs)("div",{style:{width:"95%",maxWidth:"600px",height:"300px",background:"#000",border:"1px solid #333",borderRadius:"4px",padding:"10px",overflowY:"auto",fontSize:"10px",textAlign:"left",display:"flex",flexDirection:"column",gap:"3px"},children:[R.logs&&R.logs.map((e,t)=>{return(0,c.jsx)("div",{style:{color:(n=e,n?n.includes("[ERR]")||n.includes("[TIMEOUT]")||n.includes("[HTTP 4")||n.includes("[HTTP 5")?"#ff5555":n.includes("[FALLBACK]")?"#ffff55":n.includes("[DONE]")||n.includes("[HTTP 200]")?"#55ff55":n.includes("[NET]")?"#55ffff":"#cccccc":"#cccccc"),borderBottom:"1px solid #1a1a1a",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e},t);var n}),(0,c.jsx)("div",{ref:F})]})]}):(0,c.jsx)("div",{style:{fontSize:"14px",color:"#666"},children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435..."})]})}return W?(0,c.jsx)("div",{style:{color:"red",background:"#000",height:"100vh",padding:20},children:W}):(0,c.jsxs)("div",{onContextMenu:e=>e.preventDefault(),style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:ft,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:[(0,c.jsx)(jB,{isOpen:Ke,onClose:()=>Je(!1),settings:ge,onUpdateSettings:(e,t)=>me(n=>s(s({},n),{},{[e]:t})),onToggleFullscreen:()=>{document.fullscreenElement?document.exitFullscreen().then(()=>me(e=>s(s({},e),{},{isFullscreen:!1}))).catch(console.error):document.documentElement.requestFullscreen().then(()=>me(e=>s(s({},e),{},{isFullscreen:!0}))).catch(console.error)}}),(0,c.jsx)(_2,{isOpen:w,onClose:()=>{S(!1),C(null)},onConfirm:e=>{localStorage.setItem("vn_custom_player_id",e),b(e),S(!1),"save"===k?setTimeout(()=>{it.handleOpenMenu(),dt("save")},50):"load"===k&&setTimeout(()=>{it.handleOpenMenu(),dt("load")},50),C(null)}}),(0,c.jsx)(DB,{isOpen:!!ct,mode:ct,onClose:()=>dt(null),saves:it.savesList,title:"save"===ct?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0433\u0440\u0443".concat(x?" (ID: ".concat(x,")"):""):"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0433\u0440\u0443".concat(x?" (ID: ".concat(x,")"):""),onAction:(e,t)=>{"save"===ct?("new"===e&&it.handleSaveGame(),"delete"===e&&it.handleDeleteSave(t)):("object"===typeof e&&(it.handleLoadGame(e),dt(null)),"delete"===e&&it.handleDeleteSave(t))}}),(0,c.jsxs)("div",{style:{width:K.resolution.width,height:K.resolution.height,position:"relative",transform:"scale(".concat(K.scale,")"),transformOrigin:"center center",backgroundColor:yt},children:[(0,c.jsx)(MB,{messages:Z,onClose:()=>$([])}),(0,c.jsx)("div",{style:{width:K.resolution.width,height:K.resolution.height,position:"relative",overflow:"hidden"},children:(0,c.jsx)(IZ,{currentFragId:G,transitionCfg:mt,children:(0,c.jsx)(RL,{elements:lt,activeFragmentData:Xe,isGlobal:!1,gameAreaBg:yt,noiseSettings:_e,glitchSettings:Ee,darknessSettings:De,sceneLightSettings:Ie,textureSettings:Me,isParallaxEnabled:Te,menuSettings:st,assetsMap:L,isMenuOpen:it.isMenuOpen,onTextEvent:e=>{var t;console.log('\ud83d\udce8 [SceneRenderer -> Player] Received Text Event: "'.concat(e,'"')),Se(e),(e=>{const t=fe.filter(t=>t.enabled&&"text_event"===t.trigger&&t.triggerLayerId===e);t.length>0&&ae(e=>{const n=s({},e);return t.forEach(e=>{n[e.id]=0}),ue.current=performance.now(),n})})(e),null!==Ae&&void 0!==Ae&&null!==(t=Ae.animation)&&void 0!==t&&t.enabled&&"text_event"===Ae.animation.trigger&&Ae.animation.triggerLayerId===e&&(We(!0),Ae.animation.restartOnClick&&Ue(0)),null!==Re&&void 0!==Re&&Re.enabled&&"text_event"===Re.trigger&&Re.triggerLayerId===e&&(Le(!0),Re.restartOnClick&&Pe(0)),at(e,"trigger","text")},onStartColorAnimation:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];We(!0),e&&Ue(0)},lightAnimTime:Fe,onStartLightAnimation:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Le(!0),e&&Pe(0)},onSetMenuOpen:it.setIsMenuOpen,onMenuSave:()=>{x||y?(it.handleOpenMenu(),dt("save")):(C("save"),S(!0))},onMenuLoad:()=>{x||y?(it.handleOpenMenu(),dt("load")):(C("load"),S(!0))},onMenuRestart:it.handleRestartGame,onUpdateLayerOpacity:be,onMenuSettings:()=>Je(!0),colorSettings:Ae,colorAnimTime:Ne,computedStyles:ut,resolution:K.resolution,playerStats:Y,statsSettings:tt,layoutMode:K.mode,cameraSettings:He,weatherSettings:vt,isParallaxEnabled:rt,parallaxOffset:ot,textAnimSettings:nt,typingSoundUrl:null===P||void 0===P||null===(f=P.visuals)||void 0===f||null===(g=f.global_settings)||void 0===g||null===(m=g.audio)||void 0===m?void 0:m.typing_sound,animationSettings:Ye,currentTime:te,cameraLinearTime:re,runningAnimations:ie,allAnimGroups:fe,onBackgroundClick:()=>{pt&&(pt.isDisabled?et(pt.lockReason):Qe(pt.targetId,pt.effects))},textSpeedMultiplier:ge.textSpeed,sfxVolume:ge.sfxVolume,globalEffectTime:A,notificationState:T,onCloseNotification:()=>{I(null)},onElementClick:(e,t)=>{"mousedown"!==e.type&&"touchstart"!==e.type||xe(t);let n="click";"mouseenter"===e.type&&(n="hover"),"click"!==e.type&&at(t,"down",n);const r=(e=>{const t=fe.filter(t=>t.enabled&&"click"===t.trigger&&t.triggerLayerId===e);return t.length>0?(ae(e=>{const n=s({},e);return t.forEach(e=>{n[e.id]=0}),se.current=performance.now(),n}),t[0].id):null})(t),o=lt.find(e=>e.id===t);!o||"button"!==o.type||o.isDisabled||"mousedown"!==e.type&&"touchstart"!==e.type||ye(),"click"===e.type&&o&&"button"===o.type&&(o.isDisabled?et(o.lockReason):r?de.current={groupId:r,action:()=>Qe(o.target,o.effects)}:Qe(o.target,o.effects))},onElementRelease:(e,t)=>{let n="click";"leave"===t&&(n="hover"),at(e,"up",n)}})})})]})]})},D2=()=>{var e,t,n,r;if(window.IS_OFFLINE_EXPORT)return(0,c.jsx)(E2,{playerId:"offline_user"});const o=window.location.pathname,i=(null===(e=window.Telegram)||void 0===e||null===(t=e.WebApp)||void 0===t||null===(n=t.initDataUnsafe)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.id)||null;console.log("Current Player ID:",i);const a=o.match(/^\/([^_]+)_(.+)\/html\/play$/),s=o.match(/^\/([^_]+)_(.+)\/html$/),l=o.match(/^\/([^_]+)_(.+)$/),d=o.match(/^\/([^_]+)$/);if(a)return(0,c.jsx)(E2,{playerId:i});if(s){const e=s[1],t=s[2];return(0,c.jsx)(b2,{userId:e,storyId:t})}return!l||s||a?d?(0,c.jsx)(tD,{userId:d[1]}):(0,c.jsx)("div",{style:{color:"white",textAlign:"center",marginTop:20},children:"404 Not Found"}):(0,c.jsx)(il,{children:(0,c.jsx)(LE,{realUserId:i})})};t.createRoot(document.getElementById("root")).render((0,c.jsxs)(e.StrictMode,{children:[(0,c.jsx)(D2,{}),"  "]}))})()})();
//# sourceMappingURL=main.1c2e84d0.js.map