/*! For license information please see main.62667385.js.LICENSE.txt */
(()=>{var e={14:e=>{e.exports=function(){return!1}},61:e=>{e.exports=function(e,t){return e<t}},111:(e,t,n)=>{var o=n(1069),r=0;e.exports=function(e){var t=++r;return o(e)+t}},127:(e,t,n)=>{var o=n(2125);e.exports=function(e,t){return o(e,t,"pre")}},141:e=>{e.exports=function(e){return void 0===e}},143:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},149:e=>{e.exports=function(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}},191:(e,t,n)=>{"use strict";var o=n(5750);e.exports=i;var r="\0";function i(e){this._isDirected=!o.has(e,"directed")||e.directed,this._isMultigraph=!!o.has(e,"multigraph")&&e.multigraph,this._isCompound=!!o.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=o.constant(void 0),this._defaultEdgeLabelFn=o.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function s(e,t){e[t]?e[t]++:e[t]=1}function a(e,t){--e[t]||delete e[t]}function l(e,t,n,r){var i=""+t,s=""+n;if(!e&&i>s){var a=i;i=s,s=a}return i+"\x01"+s+"\x01"+(o.isUndefined(r)?"\0":r)}function c(e,t){return l(e,t.v,t.w,t.name)}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(e){return this._label=e,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(e){return o.isFunction(e)||(e=o.constant(e)),this._defaultNodeLabelFn=e,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return o.keys(this._nodes)},i.prototype.sources=function(){var e=this;return o.filter(this.nodes(),function(t){return o.isEmpty(e._in[t])})},i.prototype.sinks=function(){var e=this;return o.filter(this.nodes(),function(t){return o.isEmpty(e._out[t])})},i.prototype.setNodes=function(e,t){var n=arguments,r=this;return o.each(e,function(e){n.length>1?r.setNode(e,t):r.setNode(e)}),this},i.prototype.setNode=function(e,t){return o.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=r,this._children[e]={},this._children[r][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},i.prototype.node=function(e){return this._nodes[e]},i.prototype.hasNode=function(e){return o.has(this._nodes,e)},i.prototype.removeNode=function(e){var t=this;if(o.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],o.each(this.children(e),function(e){t.setParent(e)}),delete this._children[e]),o.each(o.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],o.each(o.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},i.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(o.isUndefined(t))t=r;else{for(var n=t+="";!o.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},i.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},i.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==r)return t}},i.prototype.children=function(e){if(o.isUndefined(e)&&(e=r),this._isCompound){var t=this._children[e];if(t)return o.keys(t)}else{if(e===r)return this.nodes();if(this.hasNode(e))return[]}},i.prototype.predecessors=function(e){var t=this._preds[e];if(t)return o.keys(t)},i.prototype.successors=function(e){var t=this._sucs[e];if(t)return o.keys(t)},i.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return o.union(t,this.successors(e))},i.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},i.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;o.each(this._nodes,function(n,o){e(o)&&t.setNode(o,n)}),o.each(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))});var r={};function i(e){var o=n.parent(e);return void 0===o||t.hasNode(o)?(r[e]=o,o):o in r?r[o]:i(o)}return this._isCompound&&o.each(t.nodes(),function(e){t.setParent(e,i(e))}),t},i.prototype.setDefaultEdgeLabel=function(e){return o.isFunction(e)||(e=o.constant(e)),this._defaultEdgeLabelFn=e,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return o.values(this._edgeObjs)},i.prototype.setPath=function(e,t){var n=this,r=arguments;return o.reduce(e,function(e,o){return r.length>1?n.setEdge(e,o,t):n.setEdge(e,o),o}),this},i.prototype.setEdge=function(){var e,t,n,r,i=!1,a=arguments[0];"object"===typeof a&&null!==a&&"v"in a?(e=a.v,t=a.w,n=a.name,2===arguments.length&&(r=arguments[1],i=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=""+e,t=""+t,o.isUndefined(n)||(n=""+n);var c=l(this._isDirected,e,t,n);if(o.has(this._edgeLabels,c))return i&&(this._edgeLabels[c]=r),this;if(!o.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[c]=i?r:this._defaultEdgeLabelFn(e,t,n);var u=function(e,t,n,o){var r=""+t,i=""+n;if(!e&&r>i){var s=r;r=i,i=s}var a={v:r,w:i};o&&(a.name=o);return a}(this._isDirected,e,t,n);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[c]=u,s(this._preds[t],e),s(this._sucs[e],t),this._in[t][c]=u,this._out[e][c]=u,this._edgeCount++,this},i.prototype.edge=function(e,t,n){var o=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[o]},i.prototype.hasEdge=function(e,t,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return o.has(this._edgeLabels,r)},i.prototype.removeEdge=function(e,t,n){var o=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),r=this._edgeObjs[o];return r&&(e=r.v,t=r.w,delete this._edgeLabels[o],delete this._edgeObjs[o],a(this._preds[t],e),a(this._sucs[e],t),delete this._in[t][o],delete this._out[e][o],this._edgeCount--),this},i.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=o.values(n);return t?o.filter(r,function(e){return e.v===t}):r}},i.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=o.values(n);return t?o.filter(r,function(e){return e.w===t}):r}},i.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},247:(e,t,n)=>{var o=n(5750),r=n(8808);e.exports=function(e){return o.filter(r(e),function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])})}},310:(e,t,n)=>{var o=n(1817),r=n(5990),i=n(6140);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:o(r(e))}},320:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},388:(e,t,n)=>{var o=n(8208),r=n(5641);function i(e,t,n){for(var r;t.length&&(r=o.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}e.exports=function(e,t){var n=r.partition(e,function(e){return o.has(e,"barycenter")}),s=n.lhs,a=o.sortBy(n.rhs,function(e){return-e.i}),l=[],c=0,u=0,d=0;s.sort((h=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:h?t.i-e.i:e.i-t.i})),d=i(l,a,d),o.forEach(s,function(e){d+=e.vs.length,l.push(e.vs),c+=e.barycenter*e.weight,u+=e.weight,d=i(l,a,d)});var h;var f={vs:o.flatten(l,!0)};u&&(f.barycenter=c/u,f.weight=u);return f}},396:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},438:(e,t,n)=>{var o=n(2622);e.exports=function(e){return o(this,e).get(e)}},449:(e,t,n)=>{var o=n(6924),r=n(2761);e.exports=function(e){return r(e)&&"[object Set]"==o(e)}},450:(e,t,n)=>{var o=n(755),r=n(5647),i=n(4416),s=n(6272),a=r(function(e){return i(o(e,1,s,!0))});e.exports=a},474:(e,t,n)=>{var o=n(3204),r=n(8122),i=n(6571);e.exports=function(e){return i(e)?o(e,!0):r(e)}},539:(e,t,n)=>{var o=n(9742),r=n(7498),i=n(3279);e.exports=function(e){return e&&e.length?o(e,i,r):void 0}},550:(e,t,n)=>{"use strict";var o=n(8208),r=n(5819),i=n(4308),s=n(9791),a=n(1987),l=n(8381),c=n(7938).Graph,u=n(5641);function d(e,t,n){return o.map(t,function(t){return a(e,t,n)})}function h(e,t){var n=new c;o.forEach(e,function(e){var r=e.graph().root,i=s(e,r,n,t);o.forEach(i.vs,function(t,n){e.node(t).order=n}),l(e,n,i.vs)})}function f(e,t){o.forEach(t,function(t){o.forEach(t,function(t,n){e.node(t).order=n})})}e.exports=function(e){var t=u.maxRank(e),n=d(e,o.range(1,t+1),"inEdges"),s=d(e,o.range(t-1,-1,-1),"outEdges"),a=r(e);f(e,a);for(var l,c=Number.POSITIVE_INFINITY,p=0,m=0;m<4;++p,++m){h(p%2?n:s,p%4>=2),a=u.buildLayerMatrix(e);var g=i(e,a);g<c&&(m=0,l=o.cloneDeep(a),c=g)}f(e,l)}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},620:(e,t,n)=>{var o=n(6913),r=n(4052),i=n(2761);e.exports=function(e){return"string"==typeof e||!r(e)&&i(e)&&"[object String]"==o(e)}},644:e=>{e.exports=function(e){return e!==e}},705:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},723:(e,t,n)=>{var o=n(7529),r=n(7171),i=n(9096),s=n(4052);e.exports=function(e,t){return(s(e)?o:r)(e,i(t,3))}},726:e=>{e.exports=function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n,e););return e}},755:(e,t,n)=>{var o=n(8895),r=n(7116);e.exports=function e(t,n,i,s,a){var l=-1,c=t.length;for(i||(i=r),a||(a=[]);++l<c;){var u=t[l];n>0&&i(u)?n>1?e(u,n-1,i,s,a):o(a,u):s||(a[a.length]=u)}return a}},793:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},801:(e,t,n)=>{var o=n(1141),r=n(6686),i=n(9841),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=o(e);var n=a.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):s.test(e)?NaN:+e}},819:(e,t,n)=>{var o=n(755);e.exports=function(e){return(null==e?0:e.length)?o(e,1):[]}},914:(e,t,n)=>{var o=n(9841);e.exports=function(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},929:(e,t,n)=>{var o=n(3211),r=n(6571),i=n(9194),s=n(6686);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?r(n)&&i(t,n.length):"string"==a&&t in n)&&o(n[t],e)}},1069:(e,t,n)=>{var o=n(8541);e.exports=function(e){return null==e?"":o(e)}},1097:(e,t,n)=>{var o=n(5750),r=n(191);function i(e){return o.map(e.nodes(),function(t){var n=e.node(t),r=e.parent(t),i={v:t};return o.isUndefined(n)||(i.value=n),o.isUndefined(r)||(i.parent=r),i})}function s(e){return o.map(e.edges(),function(t){var n=e.edge(t),r={v:t.v,w:t.w};return o.isUndefined(t.name)||(r.name=t.name),o.isUndefined(n)||(r.value=n),r})}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:i(e),edges:s(e)};o.isUndefined(e.graph())||(t.value=o.clone(e.graph()));return t},read:function(e){var t=new r(e.options).setGraph(e.value);return o.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),o.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}}},1104:(e,t,n)=>{var o=n(6614),r=n(8673);e.exports=function(e,t){return e&&o(t,r(t),e)}},1141:(e,t,n)=>{var o=n(143),r=/^\s+/;e.exports=function(e){return e?e.slice(0,o(e)+1).replace(r,""):e}},1143:(e,t,n)=>{var o=n(3028)(Object.keys,Object);e.exports=o},1153:(e,t,n)=>{"use strict";var o=n(5043),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,i={},c=null,u=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,o)&&!l.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:r,type:e,key:c,ref:u,props:i,_owner:a.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1163:(e,t,n)=>{var o=n(5647),r=n(3211),i=n(929),s=n(474),a=Object.prototype,l=a.hasOwnProperty,c=o(function(e,t){e=Object(e);var n=-1,o=t.length,c=o>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(o=1);++n<o;)for(var u=t[n],d=s(u),h=-1,f=d.length;++h<f;){var p=d[h],m=e[p];(void 0===m||r(m,a[p])&&!l.call(e,p))&&(e[p]=u[p])}return e});e.exports=c},1170:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1268:(e,t,n)=>{var o=n(5428),r=n(7574),i=n(6832),s=i&&i.isTypedArray,a=s?r(s):o;e.exports=a},1277:(e,t,n)=>{"use strict";var o=n(8208),r=n(5641),i=n(9558).positionX;e.exports=function(e){(function(e){var t=r.buildLayerMatrix(e),n=e.graph().ranksep,i=0;o.forEach(t,function(t){var r=o.max(o.map(t,function(t){return e.node(t).height}));o.forEach(t,function(t){e.node(t).y=i+r/2}),i+=r+n})})(e=r.asNonCompoundGraph(e)),o.forEach(i(e),function(t,n){e.node(n).x=t})}},1295:(e,t,n)=>{var o=n(9812),r=o?o.prototype:void 0,i=r?r.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},1310:e=>{e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},1340:(e,t,n)=>{var o=n(3211);e.exports=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1}},1516:(e,t,n)=>{var o=n(2929);e.exports=function(e){var t=new e.constructor(e.byteLength);return new o(t).set(new o(e)),t}},1558:e=>{e.exports=function(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}},1609:(e,t,n)=>{var o=n(6614),r=n(474);e.exports=function(e){return o(e,r(e))}},1629:(e,t,n)=>{var o=n(6913),r=n(6686);e.exports=function(e){if(!r(e))return!1;var t=o(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1632:(e,t,n)=>{var o=n(4724),r=n(6311),i=n(7168);e.exports=function(e){return r(e)?i(e):o(e)}},1714:(e,t,n)=>{var o=n(1340);e.exports=function(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}},1733:(e,t,n)=>{var o=n(1775),r=n(4664),i=n(9096);e.exports=function(e,t){var n={};return t=i(t,3),r(e,function(e,r,i){o(n,r,t(e,r,i))}),n}},1740:(e,t,n)=>{var o=n(7132);e.exports=function(e){return o(e,4)}},1775:(e,t,n)=>{var o=n(5654);e.exports=function(e,t,n){"__proto__"==t&&o?o(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1817:(e,t,n)=>{var o=n(6686),r=Object.create,i=function(){function e(){}return function(t){if(!o(t))return{};if(r)return r(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},1896:(e,t,n)=>{var o=n(2125);e.exports=function(e,t){return o(e,t,"post")}},1946:(e,t,n)=>{var o=n(1340);e.exports=function(e){return o(this.__data__,e)>-1}},1980:e=>{e.exports=function(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}},1981:(e,t,n)=>{"use strict";var o=n(8208);function r(e){o.forEach(e.nodes(),function(t){i(e.node(t))}),o.forEach(e.edges(),function(t){i(e.edge(t))})}function i(e){var t=e.width;e.width=e.height,e.height=t}function s(e){e.y=-e.y}function a(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||r(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){o.forEach(e.nodes(),function(t){s(e.node(t))}),o.forEach(e.edges(),function(t){var n=e.edge(t);o.forEach(n.points,s),o.has(n,"y")&&s(n)})}(e);"lr"!==t&&"rl"!==t||(!function(e){o.forEach(e.nodes(),function(t){a(e.node(t))}),o.forEach(e.edges(),function(t){var n=e.edge(t);o.forEach(n.points,a),o.has(n,"x")&&a(n)})}(e),r(e))}}},1987:(e,t,n)=>{var o=n(8208),r=n(7938).Graph;e.exports=function(e,t,n){var i=function(e){var t;for(;e.hasNode(t=o.uniqueId("_root")););return t}(e),s=new r({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(t){return e.node(t)});return o.forEach(e.nodes(),function(r){var a=e.node(r),l=e.parent(r);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(r),s.setParent(r,l||i),o.forEach(e[n](r),function(t){var n=t.v===r?t.w:t.v,i=s.edge(n,r),a=o.isUndefined(i)?0:i.weight;s.setEdge(n,r,{weight:e.edge(t).weight+a})}),o.has(a,"minRank")&&s.setNode(r,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}},2070:(e,t,n)=>{var o=n(7937)(n(6552),"Set");e.exports=o},2074:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},2117:(e,t,n)=>{var o=n(6741),r=n(9057);e.exports=function(e,t){return null!=e&&r(e,t,o)}},2125:(e,t,n)=>{var o=n(5750);function r(e,t,n,i,s,a){o.has(i,t)||(i[t]=!0,n||a.push(t),o.each(s(t),function(t){r(e,t,n,i,s,a)}),n&&a.push(t))}e.exports=function(e,t,n){o.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),s=[],a={};return o.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);r(e,t,"post"===n,a,i,s)}),s}},2154:(e,t,n)=>{var o=n(5575),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(o){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(t,e)?t[e]:void 0}},2322:(e,t,n)=>{var o=n(6913),r=n(5990),i=n(2761),s=Function.prototype,a=Object.prototype,l=s.toString,c=a.hasOwnProperty,u=l.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=o(e))return!1;var t=r(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==u}},2330:(e,t,n)=>{"use strict";var o=n(5043);var r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=o.useState,s=o.useEffect,a=o.useLayoutEffect,l=o.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(o){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=i({inst:{value:n,getSnapshot:t}}),r=o[0].inst,u=o[1];return a(function(){r.value=n,r.getSnapshot=t,c(r)&&u({inst:r})},[e,n,t]),s(function(){return c(r)&&u({inst:r}),e(function(){c(r)&&u({inst:r})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:u},2460:(e,t,n)=>{"use strict";var o=n(5758).longestPath,r=n(3088),i=n(4501);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:a(e);break;case"tight-tree":!function(e){o(e),r(e)}(e);break;case"longest-path":s(e)}};var s=o;function a(e){i(e)}},2520:(e,t,n)=>{var o=n(5816),r=n(9096),i=n(9140),s=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var l=null==n?0:i(n);return l<0&&(l=s(a+l,0)),o(e,r(t,3),l)}},2536:(e,t,n)=>{var o=n(149),r=n(2969),i=n(9096),s=n(8883),a=n(320),l=n(7574),c=n(5893),u=n(3279),d=n(4052);e.exports=function(e,t,n){t=t.length?o(t,function(e){return d(e)?function(t){return r(t,1===e.length?e[0]:e)}:e}):[u];var h=-1;t=o(t,l(i));var f=s(e,function(e,n,r){return{criteria:o(t,function(t){return t(e)}),index:++h,value:e}});return a(f,function(e,t){return c(e,t,n)})}},2541:e=>{e.exports=function(e){return function(){return e}}},2580:(e,t,n)=>{e.exports=n(5491)},2587:e=>{e.exports=function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}},2597:(e,t,n)=>{var o=n(4052),r=n(9841),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(o(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!r(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},2616:(e,t,n)=>{var o=n(4008),r=n(5857)(function(e,t){return null==e?{}:o(e,t)});e.exports=r},2622:(e,t,n)=>{var o=n(705);e.exports=function(e,t){var n=e.__data__;return o(t)?n["string"==typeof t?"string":"hash"]:n.map}},2662:(e,t,n)=>{var o=n(5575);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o&&void 0===t?"__lodash_hash_undefined__":t,this}},2717:(e,t,n)=>{var o=n(726),r=n(1817),i=n(4664),s=n(9096),a=n(5990),l=n(4052),c=n(4543),u=n(1629),d=n(6686),h=n(1268);e.exports=function(e,t,n){var f=l(e),p=f||c(e)||h(e);if(t=s(t,4),null==n){var m=e&&e.constructor;n=p?f?new m:[]:d(e)&&u(m)?r(a(e)):{}}return(p?o:i)(e,function(e,o,r){return t(n,e,o,r)}),n}},2730:(e,t,n)=>{"use strict";var o=n(5043),r=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,o,r,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,o){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,o){if(null===t||"undefined"===typeof t||function(e,t,n,o){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,o)&&(n=null),o||null===r?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,o=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),M=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var j=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var R,F=Object.assign;function z(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var L=!1;function B(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var o=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){o=c}e.call(t.prototype)}else{try{throw Error()}catch(c){o=c}e()}}catch(c){if(c&&o&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),i=o.stack.split("\n"),s=r.length-1,a=i.length-1;1<=s&&0<=a&&r[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==i[a]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function V(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case k:return"Portal";case E:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case M:return(e.displayName||"Context")+".Consumer";case D:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function U(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=U(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){o=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=U(e)?e.checked?"true":"false":e.value),(e=o)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function G(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){G(e,t);var n=W(t.value),o=t.type;if(null!=n)"number"===o?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,o){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&o&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(o&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),o=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=o&&(e.defaultValue=""+o)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,o){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var o=0===n.indexOf("--"),r=me(n,t[n],o);"float"===n&&(n="cssFloat"),o?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ce=null,Se=null;function Ee(e){if(e=xr(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=kr(t),ke(e.stateNode,e.type,t))}}function De(e){Ce?Se?Se.push(e):Se=[e]:Ce=e}function Me(){if(Ce){var e=Ce,t=Se;if(Se=Ce=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ne(e,t){return e(t)}function Ae(){}var Oe=!1;function Te(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Ne(e,t,n)}finally{Oe=!1,(null!==Ce||null!==Se)&&(Ae(),Me())}}function _e(e,t){var n=e.stateNode;if(null===n)return null;var o=kr(n);if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var je=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){je=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){je=!1}function Ie(e,t,n,o,r,i,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Re=!1,Fe=null,ze=!1,Le=null,Be={onError:function(e){Re=!0,Fe=e}};function Ve(e,t,n,o,r,i,s,a,l){Re=!1,Fe=null,Ie.apply(Be,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(He(e)!==e)throw Error(i(188))}function Ue(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,o=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(o=r.return)){n=o;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return We(r),e;if(s===o)return We(r),t;s=s.sibling}throw Error(i(188))}if(n.return!==o.return)n=r,o=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,o=s;break}if(l===o){a=!0,o=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,o=r;break}if(l===o){a=!0,o=s,n=r;break}l=l.sibling}if(!a)throw Error(i(189))}}if(n.alternate!==o)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Xe=r.unstable_shouldYield,Ze=r.unstable_requestPaint,Ge=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,ot=r.unstable_IdlePriority,rt=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var o=0,r=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?o=dt(a):0!==(i&=s)&&(o=dt(i))}else 0!==(s=n&~r)?o=dt(s):0!==i&&(o=dt(i));if(0===o)return 0;if(0!==t&&t!==o&&0===(t&r)&&((r=o&-o)>=(i=t&-t)||16===r&&0!==(4194240&i)))return t;if(0!==(4&o)&&(o|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)r=1<<(n=31-st(t)),o|=e[n],t&=~r;return o}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-st(n),r=1<<o;r&t|e[o]&t&&(e[o]|=t),n&=~r}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Ct,St,Et,Dt=!1,Mt=[],Nt=null,At=null,Ot=null,Tt=new Map,_t=new Map,jt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(t.pointerId)}}function Rt(e,t,n,o,r,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:i,targetContainers:[r]},null!==t&&(null!==(t=xr(t))&&kt(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=br(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void Et(e.priority,function(){Ct(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xr(n))&&kt(t),e.blockedOn=n,!1;var o=new(n=e.nativeEvent).constructor(n.type,n);xe=o,n.target.dispatchEvent(o),xe=null,t.shift()}return!0}function Lt(e,t,n){zt(e)&&n.delete(t)}function Bt(){Dt=!1,null!==Nt&&zt(Nt)&&(Nt=null),null!==At&&zt(At)&&(At=null),null!==Ot&&zt(Ot)&&(Ot=null),Tt.forEach(Lt),_t.forEach(Lt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Dt||(Dt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function Ht(e){function t(t){return Vt(t,e)}if(0<Mt.length){Vt(Mt[0],e);for(var n=1;n<Mt.length;n++){var o=Mt[n];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==Nt&&Vt(Nt,e),null!==At&&Vt(At,e),null!==Ot&&Vt(Ot,e),Tt.forEach(t),_t.forEach(t),n=0;n<jt.length;n++)(o=jt[n]).blockedOn===e&&(o.blockedOn=null);for(;0<jt.length&&null===(n=jt[0]).blockedOn;)Ft(n),null===n.blockedOn&&jt.shift()}var $t=x.ReactCurrentBatchConfig,Wt=!0;function Ut(e,t,n,o){var r=bt,i=$t.transition;$t.transition=null;try{bt=1,Kt(e,t,n,o)}finally{bt=r,$t.transition=i}}function qt(e,t,n,o){var r=bt,i=$t.transition;$t.transition=null;try{bt=4,Kt(e,t,n,o)}finally{bt=r,$t.transition=i}}function Kt(e,t,n,o){if(Wt){var r=Xt(e,t,n,o);if(null===r)Uo(e,t,o,Yt,n),It(e,o);else if(function(e,t,n,o,r){switch(t){case"focusin":return Nt=Rt(Nt,e,t,n,o,r),!0;case"dragenter":return At=Rt(At,e,t,n,o,r),!0;case"mouseover":return Ot=Rt(Ot,e,t,n,o,r),!0;case"pointerover":var i=r.pointerId;return Tt.set(i,Rt(Tt.get(i)||null,e,t,n,o,r)),!0;case"gotpointercapture":return i=r.pointerId,_t.set(i,Rt(_t.get(i)||null,e,t,n,o,r)),!0}return!1}(r,e,t,n,o))o.stopPropagation();else if(It(e,o),4&t&&-1<Pt.indexOf(e)){for(;null!==r;){var i=xr(r);if(null!==i&&wt(i),null===(i=Xt(e,t,n,o))&&Uo(e,t,o,Yt,n),i===r)break;r=i}null!==r&&o.stopPropagation()}else Uo(e,t,o,null,n)}}var Yt=null;function Xt(e,t,n,o){if(Yt=null,null!==(e=br(e=we(o))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Gt=null,Jt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Jt,o=n.length,r="value"in Gt?Gt.value:Gt.textContent,i=r.length;for(e=0;e<o&&n[e]===r[e];e++);var s=o-e;for(t=1;t<=s&&n[o-t]===r[i-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function rn(e){function t(t,n,o,r,i){for(var s in this._reactName=t,this._targetInst=o,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:on,this.isPropagationStopped=on,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),dn=F({},cn,{view:0,detail:0}),hn=rn(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=rn(fn),mn=rn(F({},fn,{dataTransfer:0})),gn=rn(F({},dn,{relatedTarget:0})),vn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(yn),xn=rn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function En(){return Sn}var Dn=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Mn=rn(Dn),Nn=rn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=rn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),On=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_n=rn(Tn),jn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,In=null;u&&"documentMode"in document&&(In=document.documentMode);var Rn=u&&"TextEvent"in window&&!In,Fn=u&&(!Pn||In&&8<In&&11>=In),zn=String.fromCharCode(32),Ln=!1;function Bn(e,t){switch(e){case"keyup":return-1!==jn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Un(e,t,n,o){De(o),0<(t=Ko(t,"onChange")).length&&(n=new un("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Yn(e){Lo(e,0)}function Xn(e){if(K(wr(e)))return e}function Zn(e,t){if("change"===e)return t}var Gn=!1;if(u){var Jn;if(u){var Qn="oninput"in document;if(!Qn){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),Qn="function"===typeof eo.oninput}Jn=Qn}else Jn=!1;Gn=Jn&&(!document.documentMode||9<document.documentMode)}function to(){qn&&(qn.detachEvent("onpropertychange",no),Kn=qn=null)}function no(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Un(t,Kn,e,we(e)),Te(Yn,t)}}function oo(e,t,n){"focusin"===e?(to(),Kn=n,(qn=t).attachEvent("onpropertychange",no)):"focusout"===e&&to()}function ro(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function io(e,t){if("click"===e)return Xn(t)}function so(e,t){if("input"===e||"change"===e)return Xn(t)}var ao="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lo(e,t){if(ao(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var r=n[o];if(!d.call(t,r)||!ao(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uo(e,t){var n,o=co(e);for(e=0;o;){if(3===o.nodeType){if(n=e+o.textContent.length,e<=t&&n>=t)return{node:o,offset:t-e};e=n}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=co(o)}}function ho(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ho(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fo(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(o){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function po(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mo(e){var t=fo(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ho(n.ownerDocument.documentElement,n)){if(null!==o&&po(n))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,i=Math.min(o.start,r);o=void 0===o.end?i:Math.min(o.end,r),!e.extend&&i>o&&(r=o,o=i,i=r),r=uo(n,i);var s=uo(n,o);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),i>o?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var go=u&&"documentMode"in document&&11>=document.documentMode,vo=null,yo=null,bo=null,xo=!1;function wo(e,t,n){var o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xo||null==vo||vo!==Y(o)||("selectionStart"in(o=vo)&&po(o)?o={start:o.selectionStart,end:o.selectionEnd}:o={anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},bo&&lo(bo,o)||(bo=o,0<(o=Ko(yo,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=vo)))}function ko(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Co={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionend:ko("Transition","TransitionEnd")},So={},Eo={};function Do(e){if(So[e])return So[e];if(!Co[e])return e;var t,n=Co[e];for(t in n)if(n.hasOwnProperty(t)&&t in Eo)return So[e]=n[t];return e}u&&(Eo=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);var Mo=Do("animationend"),No=Do("animationiteration"),Ao=Do("animationstart"),Oo=Do("transitionend"),To=new Map,_o="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jo(e,t){To.set(e,t),l(t,[e])}for(var Po=0;Po<_o.length;Po++){var Io=_o[Po];jo(Io.toLowerCase(),"on"+(Io[0].toUpperCase()+Io.slice(1)))}jo(Mo,"onAnimationEnd"),jo(No,"onAnimationIteration"),jo(Ao,"onAnimationStart"),jo("dblclick","onDoubleClick"),jo("focusin","onFocus"),jo("focusout","onBlur"),jo(Oo,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ro));function zo(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,o,r,s,a,l,c){if(Ve.apply(this,arguments),Re){if(!Re)throw Error(i(198));var u=Fe;Re=!1,Fe=null,ze||(ze=!0,Le=u)}}(o,t,void 0,e),e.currentTarget=null}function Lo(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var o=e[n],r=o.event;o=o.listeners;e:{var i=void 0;if(t)for(var s=o.length-1;0<=s;s--){var a=o[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;zo(r,a,c),i=l}else for(s=0;s<o.length;s++){if(l=(a=o[s]).instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;zo(r,a,c),i=l}}}if(ze)throw e=Le,ze=!1,Le=null,e}function Bo(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var o=e+"__bubble";n.has(o)||(Wo(t,e,2,!1),n.add(o))}function Vo(e,t,n){var o=0;t&&(o|=4),Wo(n,e,o,t)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function $o(e){if(!e[Ho]){e[Ho]=!0,s.forEach(function(t){"selectionchange"!==t&&(Fo.has(t)||Vo(t,!1,e),Vo(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ho]||(t[Ho]=!0,Vo("selectionchange",!1,t))}}function Wo(e,t,n,o){switch(Zt(t)){case 1:var r=Ut;break;case 4:r=qt;break;default:r=Kt}n=r.bind(null,t,n,e),r=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),o?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Uo(e,t,n,o,r){var i=o;if(0===(1&t)&&0===(2&t)&&null!==o)e:for(;;){if(null===o)return;var s=o.tag;if(3===s||4===s){var a=o.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=o.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=br(a)))return;if(5===(l=s.tag)||6===l){o=i=s;continue e}a=a.parentNode}}o=o.return}Te(function(){var o=i,r=we(n),s=[];e:{var a=To.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Mn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Mo:case No:case Ao:l=vn;break;case Oo:l=On;break;case"scroll":l=hn;break;case"wheel":l=_n;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=o;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=_e(p,h))&&u.push(qo(p,m,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!br(c)&&!c[mr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=o,null!==(c=(c=n.relatedTarget||n.toElement)?br(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=o),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:wr(l),f=null==c?a:wr(c),(a=new u(m,p+"leave",l,n,r)).target=d,a.relatedTarget=f,m=null,br(r)===o&&((u=new u(h,p+"enter",c,n,r)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Yo(f))p++;for(f=0,m=h;m;m=Yo(m))f++;for(;0<p-f;)u=Yo(u),p--;for(;0<f-p;)h=Yo(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yo(u),h=Yo(h)}u=null}else u=null;null!==l&&Xo(s,a,l,u,!1),null!==c&&null!==d&&Xo(s,d,c,u,!0)}if("select"===(l=(a=o?wr(o):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Zn;else if(Wn(a))if(Gn)g=so;else{g=ro;var v=oo}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=io);switch(g&&(g=g(e,o))?Un(s,g,n,r):(v&&v(e,a,o),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=o?wr(o):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(vo=v,yo=o,bo=null);break;case"focusout":bo=yo=vo=null;break;case"mousedown":xo=!0;break;case"contextmenu":case"mouseup":case"dragend":xo=!1,wo(s,n,r);break;case"selectionchange":if(go)break;case"keydown":case"keyup":wo(s,n,r)}var y;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(y=en()):(Jt="value"in(Gt=r)?Gt.value:Gt.textContent,Hn=!0)),0<(v=Ko(o,b)).length&&(b=new xn(b,e,null,n,r),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Vn(n))&&(b.data=y))),(y=Rn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Ln=!0,zn);case"textInput":return(e=t.data)===zn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Pn&&Bn(e,t)?(e=en(),Qt=Jt=Gt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(o=Ko(o,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:o}),r.data=y))}Lo(s,t)})}function qo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ko(e,t){for(var n=t+"Capture",o=[];null!==e;){var r=e,i=r.stateNode;5===r.tag&&null!==i&&(r=i,null!=(i=_e(e,n))&&o.unshift(qo(e,i,r)),null!=(i=_e(e,t))&&o.push(qo(e,i,r))),e=e.return}return o}function Yo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xo(e,t,n,o,r){for(var i=t._reactName,s=[];null!==n&&n!==o;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===o)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=_e(n,i))&&s.unshift(qo(n,l,a)):r||null!=(l=_e(n,i))&&s.push(qo(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Zo=/\r\n?/g,Go=/\u0000|\uFFFD/g;function Jo(e){return("string"===typeof e?e:""+e).replace(Zo,"\n").replace(Go,"")}function Qo(e,t,n){if(t=Jo(t),Jo(e)!==t&&n)throw Error(i(425))}function er(){}var tr=null,nr=null;function or(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rr="function"===typeof setTimeout?setTimeout:void 0,ir="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(lr)}:rr;function lr(e){setTimeout(function(){throw e})}function cr(e,t){var n=t,o=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===o)return e.removeChild(r),void Ht(t);o--}else"$"!==n&&"$?"!==n&&"$!"!==n||o++;n=r}while(n);Ht(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),fr="__reactFiber$"+hr,pr="__reactProps$"+hr,mr="__reactContainer$"+hr,gr="__reactEvents$"+hr,vr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function br(e){var t=e[fr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mr]||n[fr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[fr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function xr(e){return!(e=e[fr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function kr(e){return e[pr]||null}var Cr=[],Sr=-1;function Er(e){return{current:e}}function Dr(e){0>Sr||(e.current=Cr[Sr],Cr[Sr]=null,Sr--)}function Mr(e,t){Sr++,Cr[Sr]=e.current,e.current=t}var Nr={},Ar=Er(Nr),Or=Er(!1),Tr=Nr;function _r(e,t){var n=e.type.contextTypes;if(!n)return Nr;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r,i={};for(r in n)i[r]=t[r];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function jr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pr(){Dr(Or),Dr(Ar)}function Ir(e,t,n){if(Ar.current!==Nr)throw Error(i(168));Mr(Ar,t),Mr(Or,n)}function Rr(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,"function"!==typeof o.getChildContext)return n;for(var r in o=o.getChildContext())if(!(r in t))throw Error(i(108,$(e)||"Unknown",r));return F({},n,o)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nr,Tr=Ar.current,Mr(Ar,e),Mr(Or,Or.current),!0}function zr(e,t,n){var o=e.stateNode;if(!o)throw Error(i(169));n?(e=Rr(e,t,Tr),o.__reactInternalMemoizedMergedChildContext=e,Dr(Or),Dr(Ar),Mr(Ar,e)):Dr(Or),Mr(Or,n)}var Lr=null,Br=!1,Vr=!1;function Hr(e){null===Lr?Lr=[e]:Lr.push(e)}function $r(){if(!Vr&&null!==Lr){Vr=!0;var e=0,t=bt;try{var n=Lr;for(bt=1;e<n.length;e++){var o=n[e];do{o=o(!0)}while(null!==o)}Lr=null,Br=!1}catch(r){throw null!==Lr&&(Lr=Lr.slice(e+1)),Ke(Qe,$r),r}finally{bt=t,Vr=!1}}return null}var Wr=[],Ur=0,qr=null,Kr=0,Yr=[],Xr=0,Zr=null,Gr=1,Jr="";function Qr(e,t){Wr[Ur++]=Kr,Wr[Ur++]=qr,qr=e,Kr=t}function ei(e,t,n){Yr[Xr++]=Gr,Yr[Xr++]=Jr,Yr[Xr++]=Zr,Zr=e;var o=Gr;e=Jr;var r=32-st(o)-1;o&=~(1<<r),n+=1;var i=32-st(t)+r;if(30<i){var s=r-r%5;i=(o&(1<<s)-1).toString(32),o>>=s,r-=s,Gr=1<<32-st(t)+r|n<<r|o,Jr=i+e}else Gr=1<<i|n<<r|o,Jr=e}function ti(e){null!==e.return&&(Qr(e,1),ei(e,1,0))}function ni(e){for(;e===qr;)qr=Wr[--Ur],Wr[Ur]=null,Kr=Wr[--Ur],Wr[Ur]=null;for(;e===Zr;)Zr=Yr[--Xr],Yr[Xr]=null,Jr=Yr[--Xr],Yr[Xr]=null,Gr=Yr[--Xr],Yr[Xr]=null}var oi=null,ri=null,ii=!1,si=null;function ai(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oi=e,ri=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oi=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Zr?{id:Gr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oi=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ii){var t=ri;if(t){var n=t;if(!li(e,t)){if(ci(e))throw Error(i(418));t=ur(n.nextSibling);var o=oi;t&&li(e,t)?ai(o,n):(e.flags=-4097&e.flags|2,ii=!1,oi=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,oi=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oi=e}function hi(e){if(e!==oi)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!or(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw fi(),Error(i(418));for(;t;)ai(e,t),t=ur(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ur(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=oi?ur(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ri;e;)e=ur(e.nextSibling)}function pi(){ri=oi=null,ii=!1}function mi(e){null===si?si=[e]:si.push(e)}var gi=x.ReactCurrentBatchConfig;function vi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var o=n.stateNode}if(!o)throw Error(i(147,e));var r=o,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var o=t.deletions;null===o?(t.deletions=[n],t.flags|=16):o.push(n)}}function n(n,o){if(!e)return null;for(;null!==o;)t(n,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=jc(e,t)).index=0,e.sibling=null,e}function s(t,n,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<n?(t.flags|=2,n):o:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,o){return null===t||6!==t.tag?((t=Fc(n,e.mode,o)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,o){var i=n.type;return i===C?d(e,t,n.props.children,o,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===_&&bi(i)===t.type)?((o=r(t,n.props)).ref=vi(e,t,n),o.return=e,o):((o=Pc(n.type,n.key,n.props,null,e.mode,o)).ref=vi(e,t,n),o.return=e,o)}function u(e,t,n,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,o)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,o,i){return null===t||7!==t.tag?((t=Ic(n,e.mode,o,i)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=vi(e,null,t),n.return=e,n;case k:return(t=zc(t,e.mode,n)).return=e,t;case _:return h(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Ic(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function f(e,t,n,o){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(e,t,n,o):null;case k:return n.key===r?u(e,t,n,o):null;case _:return f(e,t,(r=n._init)(n._payload),o)}if(te(n)||I(n))return null!==r?null:d(e,t,n,o,null);yi(e,n)}return null}function p(e,t,n,o,r){if("string"===typeof o&&""!==o||"number"===typeof o)return l(t,e=e.get(n)||null,""+o,r);if("object"===typeof o&&null!==o){switch(o.$$typeof){case w:return c(t,e=e.get(null===o.key?n:o.key)||null,o,r);case k:return u(t,e=e.get(null===o.key?n:o.key)||null,o,r);case _:return p(e,t,n,(0,o._init)(o._payload),r)}if(te(o)||I(o))return d(t,e=e.get(n)||null,o,r,null);yi(t,o)}return null}function m(r,i,a,l){for(var c=null,u=null,d=i,m=i=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(r,d,a[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),i=s(v,i,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(r,d),ii&&Qr(r,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(r,a[m],l))&&(i=s(d,i,m),null===u?c=d:u.sibling=d,u=d);return ii&&Qr(r,m),c}for(d=o(r,d);m<a.length;m++)null!==(g=p(d,r,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),i=s(g,i,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(r,e)}),ii&&Qr(r,m),c}function g(r,a,l,c){var u=I(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(r,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),a=s(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),ii&&Qr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(r,y.value,c))&&(a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return ii&&Qr(r,g),u}for(m=o(r,m);!y.done;g++,y=l.next())null!==(y=p(m,r,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(r,e)}),ii&&Qr(r,g),u}return function e(o,i,s,l){if("object"===typeof s&&null!==s&&s.type===C&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,u=i;null!==u;){if(u.key===c){if((c=s.type)===C){if(7===u.tag){n(o,u.sibling),(i=r(u,s.props.children)).return=o,o=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===_&&bi(c)===u.type){n(o,u.sibling),(i=r(u,s.props)).ref=vi(o,u,s),i.return=o,o=i;break e}n(o,u);break}t(o,u),u=u.sibling}s.type===C?((i=Ic(s.props.children,o.mode,l,s.key)).return=o,o=i):((l=Pc(s.type,s.key,s.props,null,o.mode,l)).ref=vi(o,i,s),l.return=o,o=l)}return a(o);case k:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(o,i.sibling),(i=r(i,s.children||[])).return=o,o=i;break e}n(o,i);break}t(o,i),i=i.sibling}(i=zc(s,o.mode,l)).return=o,o=i}return a(o);case _:return e(o,i,(u=s._init)(s._payload),l)}if(te(s))return m(o,i,s,l);if(I(s))return g(o,i,s,l);yi(o,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(o,i.sibling),(i=r(i,s)).return=o,o=i):(n(o,i),(i=Fc(s,o.mode,l)).return=o,o=i),a(o)):n(o,i)}}var wi=xi(!0),ki=xi(!1),Ci=Er(null),Si=null,Ei=null,Di=null;function Mi(){Di=Ei=Si=null}function Ni(e){var t=Ci.current;Dr(Ci),e._currentValue=t}function Ai(e,t,n){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Oi(e,t){Si=e,Di=Ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(Di!==e)if(e={context:e,memoizedValue:t,next:null},null===Ei){if(null===Si)throw Error(i(308));Ei=e,Si.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var _i=null;function ji(e){null===_i?_i=[e]:_i.push(e)}function Pi(e,t,n,o){var r=t.interleaved;return null===r?(n.next=n,ji(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ii(e,o)}function Ii(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function Fi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Li(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,0!==(2&Nl)){var r=o.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),o.pending=t,Ii(e,n)}return null===(r=o.interleaved)?(t.next=t,ji(o)):(t.next=r.next,r.next=t),o.interleaved=t,Ii(e,n)}function Vi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Hi(e,t){var n=e.updateQueue,o=e.alternate;if(null!==o&&n===(o=o.updateQueue)){var r=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?r=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?r=i=t:i=i.next=t}else r=i=t;return n={baseState:o.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:o.shared,effects:o.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $i(e,t,n,o){var r=e.updateQueue;Ri=!1;var i=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=r.baseState;for(s=0,u=c=l=null,a=i;;){var h=a.lane,f=a.eventTime;if((o&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=F({},d,h);break e;case 2:Ri=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===i&&(r.shared.lanes=0);Rl|=s,e.lanes=s,e.memoizedState=d}}function Wi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],r=o.callback;if(null!==r){if(o.callback=null,o=n,"function"!==typeof r)throw Error(i(191,r));r.call(o)}}}var Ui={},qi=Er(Ui),Ki=Er(Ui),Yi=Er(Ui);function Xi(e){if(e===Ui)throw Error(i(174));return e}function Zi(e,t){switch(Mr(Yi,t),Mr(Ki,e),Mr(qi,Ui),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Dr(qi),Mr(qi,t)}function Gi(){Dr(qi),Dr(Ki),Dr(Yi)}function Ji(e){Xi(Yi.current);var t=Xi(qi.current),n=le(t,e.type);t!==n&&(Mr(Ki,e),Mr(qi,n))}function Qi(e){Ki.current===e&&(Dr(qi),Dr(Ki))}var es=Er(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function os(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var rs=x.ReactCurrentDispatcher,is=x.ReactCurrentBatchConfig,ss=0,as=null,ls=null,cs=null,us=!1,ds=!1,hs=0,fs=0;function ps(){throw Error(i(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ao(e[n],t[n]))return!1;return!0}function gs(e,t,n,o,r,s){if(ss=s,as=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Qs:ea,e=n(o,r),ds){s=0;do{if(ds=!1,hs=0,25<=s)throw Error(i(301));s+=1,cs=ls=null,t.updateQueue=null,rs.current=ta,e=n(o,r)}while(ds)}if(rs.current=Js,t=null!==ls&&null!==ls.next,ss=0,cs=ls=as=null,us=!1,t)throw Error(i(300));return e}function vs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?as.memoizedState=cs=e:cs=cs.next=e,cs}function bs(){if(null===ls){var e=as.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?as.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?as.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function ws(e){var t=bs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=ls,r=o.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}o.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,o=o.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((ss&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),o=u.hasEagerState?u.eagerState:e(o,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=o):c=c.next=h,as.lanes|=d,Rl|=d}u=u.next}while(null!==u&&u!==s);null===c?a=o:c.next=l,ao(o,t.memoizedState)||(ba=!0),t.memoizedState=o,t.baseState=a,t.baseQueue=c,n.lastRenderedState=o}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,as.lanes|=s,Rl|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ks(e){var t=bs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);ao(s,t.memoizedState)||(ba=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,o]}function Cs(){}function Ss(e,t){var n=as,o=bs(),r=t(),s=!ao(o.memoizedState,r);if(s&&(o.memoizedState=r,ba=!0),o=o.queue,Rs(Ms.bind(null,n,o,e),[e]),o.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ts(9,Ds.bind(null,n,o,r,t),void 0,null),null===Al)throw Error(i(349));0!==(30&ss)||Es(n,t,r)}return r}function Es(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ds(e,t,n,o){t.value=n,t.getSnapshot=o,Ns(t)&&As(e)}function Ms(e,t,n){return n(function(){Ns(t)&&As(e)})}function Ns(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ao(e,n)}catch(o){return!0}}function As(e){var t=Ii(e,1);null!==t&&nc(t,e,1,-1)}function Os(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ys.bind(null,as,e),[t.memoizedState,e]}function Ts(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function _s(){return bs().memoizedState}function js(e,t,n,o){var r=ys();as.flags|=e,r.memoizedState=Ts(1|t,n,void 0,void 0===o?null:o)}function Ps(e,t,n,o){var r=bs();o=void 0===o?null:o;var i=void 0;if(null!==ls){var s=ls.memoizedState;if(i=s.destroy,null!==o&&ms(o,s.deps))return void(r.memoizedState=Ts(t,n,i,o))}as.flags|=e,r.memoizedState=Ts(1|t,n,i,o)}function Is(e,t){return js(8390656,8,e,t)}function Rs(e,t){return Ps(2048,8,e,t)}function Fs(e,t){return Ps(4,2,e,t)}function zs(e,t){return Ps(4,4,e,t)}function Ls(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ps(4,4,Ls.bind(null,t,e),n)}function Vs(){}function Hs(e,t){var n=bs();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&ms(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=bs();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&ms(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ao(n,t)||(n=mt(),as.lanes|=n,Rl|=n,e.baseState=!0),t)}function Us(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var o=is.transition;is.transition={};try{e(!1),t()}finally{bt=n,is.transition=o}}function qs(){return bs().memoizedState}function Ks(e,t,n){var o=tc(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},Xs(e))Zs(t,n);else if(null!==(n=Pi(e,t,n,o))){nc(n,e,o,ec()),Gs(n,t,o)}}function Ys(e,t,n){var o=tc(e),r={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xs(e))Zs(t,r);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(r.hasEagerState=!0,r.eagerState=a,ao(a,s)){var l=t.interleaved;return null===l?(r.next=r,ji(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Pi(e,t,r,o))&&(nc(n,e,o,r=ec()),Gs(n,t,o))}}function Xs(e){var t=e.alternate;return e===as||null!==t&&t===as}function Zs(e,t){ds=us=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gs(e,t,n){if(0!==(4194240&n)){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Js={readContext:Ti,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Qs={readContext:Ti,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:Is,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,js(4194308,4,Ls.bind(null,t,e),n)},useLayoutEffect:function(e,t){return js(4194308,4,e,t)},useInsertionEffect:function(e,t){return js(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=ys();return t=void 0!==n?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=Ks.bind(null,as,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Os,useDebugValue:Vs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Os(!1),t=e[0];return e=Us.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=as,r=ys();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Al)throw Error(i(349));0!==(30&ss)||Es(o,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Is(Ms.bind(null,o,s,e),[e]),o.flags|=2048,Ts(9,Ds.bind(null,o,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Al.identifierPrefix;if(ii){var n=Jr;t=":"+t+"R"+(n=(Gr&~(1<<32-st(Gr)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ti,useCallback:Hs,useContext:Ti,useEffect:Rs,useImperativeHandle:Bs,useInsertionEffect:Fs,useLayoutEffect:zs,useMemo:$s,useReducer:ws,useRef:_s,useState:function(){return ws(xs)},useDebugValue:Vs,useDeferredValue:function(e){return Ws(bs(),ls.memoizedState,e)},useTransition:function(){return[ws(xs)[0],bs().memoizedState]},useMutableSource:Cs,useSyncExternalStore:Ss,useId:qs,unstable_isNewReconciler:!1},ta={readContext:Ti,useCallback:Hs,useContext:Ti,useEffect:Rs,useImperativeHandle:Bs,useInsertionEffect:Fs,useLayoutEffect:zs,useMemo:$s,useReducer:ks,useRef:_s,useState:function(){return ks(xs)},useDebugValue:Vs,useDeferredValue:function(e){var t=bs();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[ks(xs)[0],bs().memoizedState]},useMutableSource:Cs,useSyncExternalStore:Ss,useId:qs,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function oa(e,t,n,o){n=null===(n=n(o,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=ec(),r=tc(e),i=Li(o,r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,r))&&(nc(t,e,r,o),Vi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=ec(),r=tc(e),i=Li(o,r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,r))&&(nc(t,e,r,o),Vi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),o=tc(e),r=Li(n,o);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Bi(e,r,o))&&(nc(t,e,o,n),Vi(t,e,o))}};function ia(e,t,n,o,r,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lo(n,o)||!lo(r,i))}function sa(e,t,n){var o=!1,r=Nr,i=t.contextType;return"object"===typeof i&&null!==i?i=Ti(i):(r=jr(t)?Tr:Ar.current,i=(o=null!==(o=t.contextTypes)&&void 0!==o)?_r(e,r):Nr),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function aa(e,t,n,o){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,o),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function la(e,t,n,o){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Fi(e);var i=t.contextType;"object"===typeof i&&null!==i?r.context=Ti(i):(i=jr(t)?Tr:Ar.current,r.context=_r(e,i)),r.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(oa(e,t,i,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),$i(e,n,r,o),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",o=t;do{n+=V(o),o=o.return}while(o);var r=n}catch(i){r="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ha="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Li(-1,n)).tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){Wl||(Wl=!0,Ul=o),da(0,t)},n}function pa(e,t,n){(n=Li(-1,n)).tag=3;var o=e.type.getDerivedStateFromError;if("function"===typeof o){var r=t.value;n.payload=function(){return o(r)},n.callback=function(){da(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof o&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var o=e.pingCache;if(null===o){o=e.pingCache=new ha;var r=new Set;o.set(t,r)}else void 0===(r=o.get(t))&&(r=new Set,o.set(t,r));r.has(n)||(r.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,o,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Li(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ya=x.ReactCurrentOwner,ba=!1;function xa(e,t,n,o){t.child=null===e?ki(t,null,n,o):wi(t,e.child,n,o)}function wa(e,t,n,o,r){n=n.render;var i=t.ref;return Oi(t,r),o=gs(e,t,n,o,i,r),n=vs(),null===e||ba?(ii&&n&&ti(t),t.flags|=1,xa(e,t,o,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function ka(e,t,n,o,r){if(null===e){var i=n.type;return"function"!==typeof i||_c(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,o,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ca(e,t,i,o,r))}if(i=e.child,0===(e.lanes&r)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lo)(s,o)&&e.ref===t.ref)return Wa(e,t,r)}return t.flags|=1,(e=jc(i,o)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,n,o,r){if(null!==e){var i=e.memoizedProps;if(lo(i,o)&&e.ref===t.ref){if(ba=!1,t.pendingProps=o=i,0===(e.lanes&r))return t.lanes=e.lanes,Wa(e,t,r);0!==(131072&e.flags)&&(ba=!0)}}return Da(e,t,n,o,r)}function Sa(e,t,n){var o=t.pendingProps,r=o.children,i=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(jl,_l),_l|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mr(jl,_l),_l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==i?i.baseLanes:n,Mr(jl,_l),_l|=o}else null!==i?(o=i.baseLanes|n,t.memoizedState=null):o=n,Mr(jl,_l),_l|=o;return xa(e,t,r,n),t.child}function Ea(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Da(e,t,n,o,r){var i=jr(n)?Tr:Ar.current;return i=_r(t,i),Oi(t,r),n=gs(e,t,n,o,i,r),o=vs(),null===e||ba?(ii&&o&&ti(t),t.flags|=1,xa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function Ma(e,t,n,o,r){if(jr(n)){var i=!0;Fr(t)}else i=!1;if(Oi(t,r),null===t.stateNode)$a(e,t),sa(t,n,o),la(t,n,o,r),o=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ti(c):c=_r(t,c=jr(n)?Tr:Ar.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==o||l!==c)&&aa(t,s,o,c),Ri=!1;var h=t.memoizedState;s.state=h,$i(t,o,s,r),l=t.memoizedState,a!==o||h!==l||Or.current||Ri?("function"===typeof u&&(oa(t,n,u,o),l=t.memoizedState),(a=Ri||ia(t,n,a,o,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),s.props=o,s.state=l,s.context=c,o=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),o=!1)}else{s=t.stateNode,zi(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ti(l):l=_r(t,l=jr(n)?Tr:Ar.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,s,o,l),Ri=!1,h=t.memoizedState,s.state=h,$i(t,o,s,r);var p=t.memoizedState;a!==d||h!==p||Or.current||Ri?("function"===typeof f&&(oa(t,n,f,o),p=t.memoizedState),(c=Ri||ia(t,n,c,o,h,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(o,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(o,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=p),s.props=o,s.state=p,s.context=l,o=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),o=!1)}return Na(e,t,n,o,i,r)}function Na(e,t,n,o,r,i){Ea(e,t);var s=0!==(128&t.flags);if(!o&&!s)return r&&zr(t,n,!1),Wa(e,t,i);o=t.stateNode,ya.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&s?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,a,i)):xa(e,t,a,i),t.memoizedState=o.state,r&&zr(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Ir(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ir(0,t.context,!1),Zi(e,t.containerInfo)}function Oa(e,t,n,o,r){return pi(),mi(r),t.flags|=256,xa(e,t,n,o),t.child}var Ta,_a,ja,Pa,Ia={dehydrated:null,treeContext:null,retryLane:0};function Ra(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var o,r=t.pendingProps,s=es.current,a=!1,l=0!==(128&t.flags);if((o=l)||(o=(null===e||null!==e.memoizedState)&&0!==(2&s)),o?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Mr(es,1&s),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Rc(l,r,0,null),e=Ic(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ra(n),t.memoizedState=Ia,e):za(t,l));if(null!==(s=e.memoizedState)&&null!==(o=s.dehydrated))return function(e,t,n,o,r,s,a){if(n)return 256&t.flags?(t.flags&=-257,La(e,t,a,o=ua(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=o.fallback,r=t.mode,o=Rc({mode:"visible",children:o.children},r,0,null),(s=Ic(s,r,a,null)).flags|=2,o.return=t,s.return=t,o.sibling=s,t.child=o,0!==(1&t.mode)&&wi(t,e.child,null,a),t.child.memoizedState=Ra(a),t.memoizedState=Ia,s);if(0===(1&t.mode))return La(e,t,a,null);if("$!"===r.data){if(o=r.nextSibling&&r.nextSibling.dataset)var l=o.dgst;return o=l,La(e,t,a,o=ua(s=Error(i(419)),o,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(o=Al)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(o.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Ii(e,r),nc(o,e,r,-1))}return mc(),La(e,t,a,o=ua(Error(i(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,ri=ur(r.nextSibling),oi=t,ii=!0,si=null,null!==e&&(Yr[Xr++]=Gr,Yr[Xr++]=Jr,Yr[Xr++]=Zr,Gr=e.id,Jr=e.overflow,Zr=t),t=za(t,o.children),t.flags|=4096,t)}(e,t,l,r,o,s,n);if(a){a=r.fallback,l=t.mode,o=(s=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=jc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==o?a=jc(o,a):(a=Ic(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Ra(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ia,r}return e=(a=e.child).sibling,r=jc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function za(e,t){return(t=Rc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function La(e,t,n,o){return null!==o&&mi(o),wi(t,e.child,null,n),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),Ai(e.return,t,n)}function Va(e,t,n,o,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=o,i.tail=n,i.tailMode=r)}function Ha(e,t,n){var o=t.pendingProps,r=o.revealOrder,i=o.tail;if(xa(e,t,o.children,n),0!==(2&(o=es.current)))o=1&o|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Mr(es,o),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Va(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ts(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Va(t,!0,n,null,i);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $a(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=jc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=jc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ua(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function qa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,o=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=14680064&r.subtreeFlags,o|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=r.subtreeFlags,o|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Ka(e,t,n){var o=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qa(t),null;case 1:case 17:return jr(t.type)&&Pr(),qa(t),null;case 3:return o=t.stateNode,Gi(),Dr(Or),Dr(Ar),os(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==si&&(sc(si),si=null))),_a(e,t),qa(t),null;case 5:Qi(t);var r=Xi(Yi.current);if(n=t.type,null!==e&&null!=t.stateNode)ja(e,t,n,o,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(i(166));return qa(t),null}if(e=Xi(qi.current),hi(t)){o=t.stateNode,n=t.type;var s=t.memoizedProps;switch(o[fr]=t,o[pr]=s,e=0!==(1&t.mode),n){case"dialog":Bo("cancel",o),Bo("close",o);break;case"iframe":case"object":case"embed":Bo("load",o);break;case"video":case"audio":for(r=0;r<Ro.length;r++)Bo(Ro[r],o);break;case"source":Bo("error",o);break;case"img":case"image":case"link":Bo("error",o),Bo("load",o);break;case"details":Bo("toggle",o);break;case"input":Z(o,s),Bo("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},Bo("invalid",o);break;case"textarea":re(o,s),Bo("invalid",o)}for(var l in ye(n,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?o.textContent!==c&&(!0!==s.suppressHydrationWarning&&Qo(o.textContent,c,e),r=["children",c]):"number"===typeof c&&o.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Qo(o.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bo("scroll",o)}switch(n){case"input":q(o),Q(o,s,!0);break;case"textarea":q(o),se(o);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(o.onclick=er)}o=r,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof o.is?e=l.createElement(n,{is:o.is}):(e=l.createElement(n),"select"===n&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,n),e[fr]=t,e[pr]=o,Ta(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,o),n){case"dialog":Bo("cancel",e),Bo("close",e),r=o;break;case"iframe":case"object":case"embed":Bo("load",e),r=o;break;case"video":case"audio":for(r=0;r<Ro.length;r++)Bo(Ro[r],e);r=o;break;case"source":Bo("error",e),r=o;break;case"img":case"image":case"link":Bo("error",e),Bo("load",e),r=o;break;case"details":Bo("toggle",e),r=o;break;case"input":Z(e,o),r=X(e,o),Bo("invalid",e);break;case"option":default:r=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},r=F({},o,{value:void 0}),Bo("invalid",e);break;case"textarea":re(e,o),r=oe(e,o),Bo("invalid",e)}for(s in ye(n,r),c=r)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Bo("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":q(e),Q(e,o,!1);break;case"textarea":q(e),se(e);break;case"option":null!=o.value&&e.setAttribute("value",""+W(o.value));break;case"select":e.multiple=!!o.multiple,null!=(s=o.value)?ne(e,!!o.multiple,s,!1):null!=o.defaultValue&&ne(e,!!o.multiple,o.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=er)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qa(t),null;case 6:if(e&&null!=t.stateNode)Pa(e,t,e.memoizedProps,o);else{if("string"!==typeof o&&null===t.stateNode)throw Error(i(166));if(n=Xi(Yi.current),Xi(qi.current),hi(t)){if(o=t.stateNode,n=t.memoizedProps,o[fr]=t,(s=o.nodeValue!==n)&&null!==(e=oi))switch(e.tag){case 3:Qo(o.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qo(o.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(o=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[fr]=t,t.stateNode=o}return qa(t),null;case 13:if(Dr(es),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))fi(),pi(),t.flags|=98560,s=!1;else if(s=hi(t),null!==o&&null!==o.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[fr]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qa(t),s=!1}else null!==si&&(sc(si),si=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((o=null!==o)!==(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Pl&&(Pl=3):mc())),null!==t.updateQueue&&(t.flags|=4),qa(t),null);case 4:return Gi(),_a(e,t),null===e&&$o(t.stateNode.containerInfo),qa(t),null;case 10:return Ni(t.type._context),qa(t),null;case 19:if(Dr(es),null===(s=t.memoizedState))return qa(t),null;if(o=0!==(128&t.flags),null===(l=s.rendering))if(o)Ua(s,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Ua(s,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;null!==n;)e=o,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mr(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ge()>Hl&&(t.flags|=128,o=!0,Ua(s,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=ts(l))){if(t.flags|=128,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ua(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ii)return qa(t),null}else 2*Ge()-s.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,o=!0,Ua(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ge(),t.sibling=null,n=es.current,Mr(es,o?1&n|2:1&n),t):(qa(t),null);case 22:case 23:return dc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&0!==(1&t.mode)?0!==(1073741824&_l)&&(qa(t),6&t.subtreeFlags&&(t.flags|=8192)):qa(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ya(e,t){switch(ni(t),t.tag){case 1:return jr(t.type)&&Pr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Gi(),Dr(Or),Dr(Ar),os(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qi(t),null;case 13:if(Dr(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Dr(es),null;case 4:return Gi(),null;case 10:return Ni(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ta=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_a=function(){},ja=function(e,t,n,o){var r=e.memoizedProps;if(r!==o){e=t.stateNode,Xi(qi.current);var i,s=null;switch(n){case"input":r=X(e,r),o=X(e,o),s=[];break;case"select":r=F({},r,{value:void 0}),o=F({},o,{value:void 0}),s=[];break;case"textarea":r=oe(e,r),o=oe(e,o),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof o.onClick&&(e.onclick=er)}for(u in ye(n,o),n=null,r)if(!o.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in o){var c=o[u];if(l=null!=r?r[u]:void 0,o.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bo("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Pa=function(e,t,n,o){n!==o&&(t.flags|=4)};var Xa=!1,Za=!1,Ga="function"===typeof WeakSet?WeakSet:Set,Ja=null;function Qa(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(o){Sc(e,t,o)}else n.current=null}function el(e,t,n){try{n()}catch(o){Sc(e,t,o)}}var tl=!1;function nl(e,t,n){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var r=o=o.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,void 0!==i&&el(t,n,i)}r=r.next}while(r!==o)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fr],delete t[pr],delete t[gr],delete t[vr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=er));else if(4!==o&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==o&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Za||Qa(n,t);case 6:var o=ul,r=dl;ul=null,hl(e,t,n),dl=r,null!==(ul=o)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),Ht(e)):cr(ul,n.stateNode));break;case 4:o=ul,r=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=o,dl=r;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(o=n.updateQueue)&&null!==(o=o.lastEffect))){r=o=o.next;do{var i=r,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&el(n,t,s),r=r.next}while(r!==o)}hl(e,t,n);break;case 1:if(!Za&&(Qa(n,t),"function"===typeof(o=n.stateNode).componentWillUnmount))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(a){Sc(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Za=(o=Za)||null!==n.memoizedState,hl(e,t,n),Za=o):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ga),t.forEach(function(t){var o=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(o,o))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var r=n[o];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));fl(s,a,r),ul=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Sc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&o){try{nl(3,e,e.return),ol(3,e)}catch(g){Sc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&o&&null!==n&&Qa(n,n.return);break;case 5:if(ml(t,e),vl(e),512&o&&null!==n&&Qa(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){Sc(e,e.return,g)}}if(4&o&&null!=(r=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&G(r,s),be(l,a);var u=be(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(l){case"input":J(r,s);break;case"textarea":ie(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(r,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(r,!!s.multiple,s.defaultValue,!0):ne(r,!!s.multiple,s.multiple?[]:"",!1))}r[pr]=s}catch(g){Sc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&o){if(null===e.stateNode)throw Error(i(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(g){Sc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Vl=Ge())),4&o&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(u=Za)||d,ml(t,e),Za=u):ml(t,e),vl(e),8192&o){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Ja=e,d=e.child;null!==d;){for(h=Ja=d;null!==Ja;){switch(p=(f=Ja).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Qa(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){o=f,n=f.return;try{t=o,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Sc(o,n,g)}}break;case 5:Qa(f,f.return);break;case 22:if(null!==f.memoizedState){wl(h);continue}}null!==p?(p.return=f,Ja=p):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Sc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&o&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var o=n;break e}n=n.return}throw Error(i(160))}switch(o.tag){case 5:var r=o.stateNode;32&o.flags&&(he(r,""),o.flags&=-33),cl(e,al(e),r);break;case 3:case 4:var s=o.stateNode.containerInfo;ll(e,al(e),s);break;default:throw Error(i(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Ja=e,bl(e,t,n)}function bl(e,t,n){for(var o=0!==(1&e.mode);null!==Ja;){var r=Ja,i=r.child;if(22===r.tag&&o){var s=null!==r.memoizedState||Xa;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Za;a=Xa;var c=Za;if(Xa=s,(Za=l)&&!c)for(Ja=r;null!==Ja;)l=(s=Ja).child,22===s.tag&&null!==s.memoizedState?kl(r):null!==l?(l.return=s,Ja=l):kl(r);for(;null!==i;)Ja=i,bl(i,t,n),i=i.sibling;Ja=r,Xa=a,Za=c}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==i?(i.return=r,Ja=i):xl(e)}}function xl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||ol(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Za)if(null===n)o.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);o.componentDidUpdate(r,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wi(t,s,o);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wi(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(i(163))}Za||512&t.flags&&rl(t)}catch(f){Sc(t,t.return,f)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function wl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function kl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ol(4,t)}catch(l){Sc(t,n,l)}break;case 1:var o=t.stateNode;if("function"===typeof o.componentDidMount){var r=t.return;try{o.componentDidMount()}catch(l){Sc(t,r,l)}}var i=t.return;try{rl(t)}catch(l){Sc(t,i,l)}break;case 5:var s=t.return;try{rl(t)}catch(l){Sc(t,s,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var Cl,Sl=Math.ceil,El=x.ReactCurrentDispatcher,Dl=x.ReactCurrentOwner,Ml=x.ReactCurrentBatchConfig,Nl=0,Al=null,Ol=null,Tl=0,_l=0,jl=Er(0),Pl=0,Il=null,Rl=0,Fl=0,zl=0,Ll=null,Bl=null,Vl=0,Hl=1/0,$l=null,Wl=!1,Ul=null,ql=null,Kl=!1,Yl=null,Xl=0,Zl=0,Gl=null,Jl=-1,Ql=0;function ec(){return 0!==(6&Nl)?Ge():-1!==Jl?Jl:Jl=Ge()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Tl?Tl&-Tl:null!==gi.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function nc(e,t,n,o){if(50<Zl)throw Zl=0,Gl=null,Error(i(185));vt(e,n,o),0!==(2&Nl)&&e===Al||(e===Al&&(0===(2&Nl)&&(Fl|=n),4===Pl&&ac(e,Tl)),oc(e,o),1===n&&0===Nl&&0===(1&t.mode)&&(Hl=Ge()+500,Br&&$r()))}function oc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),a=1<<s,l=r[s];-1===l?0!==(a&n)&&0===(a&o)||(r[s]=ft(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}}(e,t);var o=ht(e,e===Al?Tl:0);if(0===o)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Br=!0,Hr(e)}(lc.bind(null,e)):Hr(lc.bind(null,e)),ar(function(){0===(6&Nl)&&$r()}),n=null;else{switch(xt(o)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=ot}n=Ac(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Jl=-1,Ql=0,0!==(6&Nl))throw Error(i(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var o=ht(e,e===Al?Tl:0);if(0===o)return null;if(0!==(30&o)||0!==(o&e.expiredLanes)||t)t=gc(e,o);else{t=o;var r=Nl;Nl|=2;var s=pc();for(Al===e&&Tl===t||($l=null,Hl=Ge()+500,hc(e,t));;)try{yc();break}catch(l){fc(e,l)}Mi(),El.current=s,Nl=r,null!==Ol?t=0:(Al=null,Tl=0,t=Pl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(o=r,t=ic(e,r))),1===t)throw n=Il,hc(e,0),ac(e,o),oc(e,Ge()),n;if(6===t)ac(e,o);else{if(r=e.current.alternate,0===(30&o)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var o=0;o<n.length;o++){var r=n[o],i=r.getSnapshot;r=r.value;try{if(!ao(i(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,o))&&(0!==(s=pt(e))&&(o=s,t=ic(e,s))),1===t))throw n=Il,hc(e,0),ac(e,o),oc(e,Ge()),n;switch(e.finishedWork=r,e.finishedLanes=o,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Bl,$l);break;case 3:if(ac(e,o),(130023424&o)===o&&10<(t=Vl+500-Ge())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&o)!==o){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=rr(wc.bind(null,e,Bl,$l),t);break}wc(e,Bl,$l);break;case 4:if(ac(e,o),(4194240&o)===o)break;for(t=e.eventTimes,r=-1;0<o;){var a=31-st(o);s=1<<a,(a=t[a])>r&&(r=a),o&=~s}if(o=r,10<(o=(120>(o=Ge()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Sl(o/1960))-o)){e.timeoutHandle=rr(wc.bind(null,e,Bl,$l),o);break}wc(e,Bl,$l);break;default:throw Error(i(329))}}}return oc(e,Ge()),e.callbackNode===n?rc.bind(null,e):null}function ic(e,t){var n=Ll;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=n,null!==t&&sc(t)),e}function sc(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function ac(e,t){for(t&=~zl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),o=1<<n;e[n]=-1,t&=~o}}function lc(e){if(0!==(6&Nl))throw Error(i(327));kc();var t=ht(e,0);if(0===(1&t))return oc(e,Ge()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var o=pt(e);0!==o&&(t=o,n=ic(e,o))}if(1===n)throw n=Il,hc(e,0),ac(e,t),oc(e,Ge()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Bl,$l),oc(e,Ge()),null}function cc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Hl=Ge()+500,Br&&$r())}}function uc(e){null!==Yl&&0===Yl.tag&&0===(6&Nl)&&kc();var t=Nl;Nl|=1;var n=Ml.transition,o=bt;try{if(Ml.transition=null,bt=1,e)return e()}finally{bt=o,Ml.transition=n,0===(6&(Nl=t))&&$r()}}function dc(){_l=jl.current,Dr(jl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ir(n)),null!==Ol)for(n=Ol.return;null!==n;){var o=n;switch(ni(o),o.tag){case 1:null!==(o=o.type.childContextTypes)&&void 0!==o&&Pr();break;case 3:Gi(),Dr(Or),Dr(Ar),os();break;case 5:Qi(o);break;case 4:Gi();break;case 13:case 19:Dr(es);break;case 10:Ni(o.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,Ol=e=jc(e.current,null),Tl=_l=t,Pl=0,Il=null,zl=Fl=Rl=0,Bl=Ll=null,null!==_i){for(t=0;t<_i.length;t++)if(null!==(o=(n=_i[t]).interleaved)){n.interleaved=null;var r=o.next,i=n.pending;if(null!==i){var s=i.next;i.next=r,o.next=s}n.pending=o}_i=null}return e}function fc(e,t){for(;;){var n=Ol;try{if(Mi(),rs.current=Js,us){for(var o=as.memoizedState;null!==o;){var r=o.queue;null!==r&&(r.pending=null),o=o.next}us=!1}if(ss=0,cs=ls=as=null,ds=!1,hs=0,Dl.current=null,null===n||null===n.return){Pl=1,Il=t,Ol=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ma(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(s,u,t),mc();break e}c=Error(i(426))}else if(ii&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),mi(ca(c,l));break e}}s=c=ca(c,l),4!==Pl&&(Pl=2),null===Ll?Ll=[s]:Ll.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,fa(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,pa(s,l,t));break e}}s=s.return}while(null!==s)}xc(n)}catch(x){t=x,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function pc(){var e=El.current;return El.current=Js,null===e?Js:e}function mc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Al||0===(268435455&Rl)&&0===(268435455&Fl)||ac(Al,Tl)}function gc(e,t){var n=Nl;Nl|=2;var o=pc();for(Al===e&&Tl===t||($l=null,hc(e,t));;)try{vc();break}catch(r){fc(e,r)}if(Mi(),Nl=n,El.current=o,null!==Ol)throw Error(i(261));return Al=null,Tl=0,Pl}function vc(){for(;null!==Ol;)bc(Ol)}function yc(){for(;null!==Ol&&!Xe();)bc(Ol)}function bc(e){var t=Cl(e.alternate,e,_l);e.memoizedProps=e.pendingProps,null===t?xc(e):Ol=t,Dl.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ka(n,t,_l)))return void(Ol=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Ol=n);if(null===e)return Pl=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Pl&&(Pl=5)}function wc(e,t,n){var o=bt,r=Ml.transition;try{Ml.transition=null,bt=1,function(e,t,n,o){do{kc()}while(null!==Yl);if(0!==(6&Nl))throw Error(i(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),i=1<<r;t[r]=0,o[r]=-1,e[r]=-1,n&=~i}}(e,s),e===Al&&(Ol=Al=null,Tl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Ac(tt,function(){return kc(),null})),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Ml.transition,Ml.transition=null;var a=bt;bt=1;var l=Nl;Nl|=4,Dl.current=null,function(e,t){if(tr=Wt,po(e=fo())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var r=o.anchorOffset,s=o.focusNode;o=o.focusOffset;try{n.nodeType,s.nodeType}catch(w){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==r&&3!==h.nodeType||(l=a+r),h!==s||0!==o&&3!==h.nodeType||(c=a+o),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===r&&(l=a),f===s&&++d===o&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nr={focusedElem:e,selectionRange:n},Wt=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}m=tl,tl=!1}(e,n),gl(n,e),mo(nr),Wt=!!tr,nr=tr=null,e.current=n,yl(n,e,r),Ze(),Nl=l,bt=a,Ml.transition=s}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Xl=r),s=e.pendingLanes,0===s&&(ql=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),oc(e,Ge()),null!==t)for(o=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],o(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Ul,Ul=null,e;0!==(1&Xl)&&0!==e.tag&&kc(),s=e.pendingLanes,0!==(1&s)?e===Gl?Zl++:(Zl=0,Gl=e):Zl=0,$r()}(e,t,n,o)}finally{Ml.transition=r,bt=o}return null}function kc(){if(null!==Yl){var e=xt(Xl),t=Ml.transition,n=bt;try{if(Ml.transition=null,bt=16>e?16:e,null===Yl)var o=!1;else{if(e=Yl,Yl=null,Xl=0,0!==(6&Nl))throw Error(i(331));var r=Nl;for(Nl|=4,Ja=e.current;null!==Ja;){var s=Ja,a=s.child;if(0!==(16&Ja.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ja=u;null!==Ja;){var d=Ja;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Ja=h;else for(;null!==Ja;){var f=(d=Ja).sibling,p=d.return;if(il(d),d===u){Ja=null;break}if(null!==f){f.return=p,Ja=f;break}Ja=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ja=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Ja=y;break e}Ja=s.return}}var b=e.current;for(Ja=b;null!==Ja;){var x=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,Ja=x;else e:for(a=b;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(k){Sc(l,l.return,k)}if(l===a){Ja=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Ja=w;break e}Ja=l.return}}if(Nl=r,$r(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(k){}o=!0}return o}finally{bt=n,Ml.transition=t}}return!1}function Cc(e,t,n){e=Bi(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),oc(e,t))}function Sc(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var o=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof o.componentDidCatch&&(null===ql||!ql.has(o))){t=Bi(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),oc(t,e));break}}t=t.return}}function Ec(e,t,n){var o=e.pingCache;null!==o&&o.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Tl&n)===n&&(4===Pl||3===Pl&&(130023424&Tl)===Tl&&500>Ge()-Vl?hc(e,0):zl|=n),oc(e,t)}function Dc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ii(e,t))&&(vt(e,t,n),oc(e,n))}function Mc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Dc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(i(314))}null!==o&&o.delete(t),Dc(e,n)}function Ac(e,t){return Ke(e,t)}function Oc(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,o){return new Oc(e,t,n,o)}function _c(e){return!(!(e=e.prototype)||!e.isReactComponent)}function jc(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,o,r,s){var a=2;if(o=e,"function"===typeof e)_c(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case C:return Ic(n.children,r,s,t);case S:a=8,r|=8;break;case E:return(e=Tc(12,n,t,2|r)).elementType=E,e.lanes=s,e;case A:return(e=Tc(13,n,t,r)).elementType=A,e.lanes=s,e;case O:return(e=Tc(19,n,t,r)).elementType=O,e.lanes=s,e;case j:return Rc(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case D:a=10;break e;case M:a=9;break e;case N:a=11;break e;case T:a=14;break e;case _:a=16,o=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Tc(a,n,t,r)).elementType=e,t.type=o,t.lanes=s,t}function Ic(e,t,n,o){return(e=Tc(7,e,o,t)).lanes=n,e}function Rc(e,t,n,o){return(e=Tc(22,e,o,t)).elementType=j,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,o,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=o,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,o,r,i,s,a,l){return e=new Lc(e,t,n,a,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Tc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fi(i),e}function Vc(e){if(!e)return Nr;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(jr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(jr(n))return Rr(e,n,t)}return t}function Hc(e,t,n,o,r,i,s,a,l){return(e=Bc(n,o,!0,e,0,i,0,a,l)).context=Vc(null),n=e.current,(i=Li(o=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,r),e.current.lanes=r,vt(e,r,o),oc(e,o),e}function $c(e,t,n,o){var r=t.current,i=ec(),s=tc(r);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Li(i,s)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Bi(r,t,s))&&(nc(e,r,s,i),Vi(e,r,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Uc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Uc(e,t),(e=e.alternate)&&Uc(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Or.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),pi();break;case 5:Ji(t);break;case 1:jr(t.type)&&Fr(t);break;case 4:Zi(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,r=t.memoizedProps.value;Mr(Ci,o._currentValue),o._currentValue=r;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(Mr(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(Mr(es,1&es.current),null!==(e=Wa(e,t,n))?e.sibling:null);Mr(es,1&es.current);break;case 19:if(o=0!==(n&t.childLanes),0!==(128&e.flags)){if(o)return Ha(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mr(es,es.current),o)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Wa(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,ii&&0!==(1048576&t.flags)&&ei(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;$a(e,t),e=t.pendingProps;var r=_r(t,Ar.current);Oi(t,n),r=gs(null,t,o,e,r,n);var s=vs();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,jr(o)?(s=!0,Fr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fi(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,la(t,o,e,n),t=Na(null,t,o,!0,s,n)):(t.tag=0,ii&&s&&ti(t),xa(null,t,r,n),t=t.child),t;case 16:o=t.elementType;e:{switch($a(e,t),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"===typeof e)return _c(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===T)return 14}return 2}(o),e=na(o,e),r){case 0:t=Da(null,t,o,e,n);break e;case 1:t=Ma(null,t,o,e,n);break e;case 11:t=wa(null,t,o,e,n);break e;case 14:t=ka(null,t,o,na(o.type,e),n);break e}throw Error(i(306,o,""))}return t;case 0:return o=t.type,r=t.pendingProps,Da(e,t,o,r=t.elementType===o?r:na(o,r),n);case 1:return o=t.type,r=t.pendingProps,Ma(e,t,o,r=t.elementType===o?r:na(o,r),n);case 3:e:{if(Aa(t),null===e)throw Error(i(387));o=t.pendingProps,r=(s=t.memoizedState).element,zi(e,t),$i(t,o,null,n);var a=t.memoizedState;if(o=a.element,s.isDehydrated){if(s={element:o,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Oa(e,t,o,n,r=ca(Error(i(423)),t));break e}if(o!==r){t=Oa(e,t,o,n,r=ca(Error(i(424)),t));break e}for(ri=ur(t.stateNode.containerInfo.firstChild),oi=t,ii=!0,si=null,n=ki(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),o===r){t=Wa(e,t,n);break e}xa(e,t,o,n)}t=t.child}return t;case 5:return Ji(t),null===e&&ui(t),o=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,or(o,r)?a=null:null!==s&&or(o,s)&&(t.flags|=32),Ea(e,t),xa(e,t,a,n),t.child;case 6:return null===e&&ui(t),null;case 13:return Fa(e,t,n);case 4:return Zi(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=wi(t,null,o,n):xa(e,t,o,n),t.child;case 11:return o=t.type,r=t.pendingProps,wa(e,t,o,r=t.elementType===o?r:na(o,r),n);case 7:return xa(e,t,t.pendingProps,n),t.child;case 8:case 12:return xa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,Mr(Ci,o._currentValue),o._currentValue=a,null!==s)if(ao(s.value,a)){if(s.children===r.children&&!Or.current){t=Wa(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===o){if(1===s.tag){(c=Li(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ai(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(i(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ai(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}xa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,o=t.pendingProps.children,Oi(t,n),o=o(r=Ti(r)),t.flags|=1,xa(e,t,o,n),t.child;case 14:return r=na(o=t.type,t.pendingProps),ka(e,t,o,r=na(o.type,r),n);case 15:return Ca(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,r=t.pendingProps,r=t.elementType===o?r:na(o,r),$a(e,t),t.tag=1,jr(o)?(e=!0,Fr(t)):e=!1,Oi(t,n),sa(t,o,r),la(t,o,r,n),Na(null,t,o,!0,e,n);case 19:return Ha(e,t,n);case 22:return Sa(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Qc(e,t,n,o,r){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof r){var a=r;r=function(){var e=Wc(s);a.call(e)}}$c(t,s,e,r)}else s=function(e,t,n,o,r){if(r){if("function"===typeof o){var i=o;o=function(){var e=Wc(s);i.call(e)}}var s=Hc(t,o,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[mr]=s.current,$o(8===e.nodeType?e.parentNode:e),uc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof o){var a=o;o=function(){var e=Wc(l);a.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[mr]=l.current,$o(8===e.nodeType?e.parentNode:e),uc(function(){$c(t,l,n,o)}),l}(n,t,e,r,o);return Wc(s)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));$c(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){$c(null,e,null,null)}),t[mr]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jt.length&&0!==t&&t<jt[n].priority;n++);jt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),oc(t,Ge()),0===(6&Nl)&&(Hl=Ge()+500,$r()))}break;case 13:uc(function(){var t=Ii(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),qc(e,1)}},kt=function(e){if(13===e.tag){var t=Ii(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tc(e),n=Ii(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},St=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var r=kr(o);if(!r)throw Error(i(90));K(o),J(o,r)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=cc,Ae=uc;var eu={usingClientEntryPoint:!1,Events:[xr,wr,kr,De,Me,cc]},tu={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ue(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{rt=ou.inject(nu),it=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(i(200));return function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==o?null:""+o,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zc(e))throw Error(i(299));var n=!1,o="",r=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,o,r),e[mr]=t.current,$o(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ue(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Gc(t))throw Error(i(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zc(e))throw Error(i(405));var o=null!=n&&n.hydratedSources||null,r=!1,s="",a=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,r,0,s,a),e[mr]=t.current,$o(e),o)for(e=0;e<o.length;e++)r=(r=(n=o[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Xc(t)},t.render=function(e,t,n){if(!Gc(t))throw Error(i(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Gc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc(function(){Qc(null,null,e,!1,function(){e._reactRootContainer=null,e[mr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Gc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Qc(e,t,n,!1,o)},t.version="18.3.1-next-f1338f8080-20240426"},2759:(e,t,n)=>{var o=n(9421),r=n(5652),i=n(9096),s=n(6487),a=n(4052);e.exports=function(e,t,n){var l=a(e)?o:s,c=arguments.length<3;return l(e,i(t,4),n,c,r)}},2761:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2777:(e,t,n)=>{var o=n(5193),r=n(2761),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(e){return r(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=l},2786:(e,t,n)=>{"use strict";var o=n(8208),r=n(5641);e.exports={run:function(e){e.graph().dummyChains=[],o.forEach(e.edges(),function(t){!function(e,t){var n,o,i,s=t.v,a=e.node(s).rank,l=t.w,c=e.node(l).rank,u=t.name,d=e.edge(t),h=d.labelRank;if(c===a+1)return;for(e.removeEdge(t),i=0,++a;a<c;++i,++a)d.points=[],o={width:0,height:0,edgeLabel:d,edgeObj:t,rank:a},n=r.addDummyNode(e,"edge",o,"_d"),a===h&&(o.width=d.width,o.height=d.height,o.dummy="edge-label",o.labelpos=d.labelpos),e.setEdge(s,n,{weight:d.weight},u),0===i&&e.graph().dummyChains.push(n),s=n;e.setEdge(s,l,{weight:d.weight},u)}(e,t)})},undo:function(e){o.forEach(e.graph().dummyChains,function(t){var n,o=e.node(t),r=o.edgeLabel;for(e.setEdge(o.edgeObj,r);o.dummy;)n=e.successors(t)[0],e.removeNode(t),r.points.push({x:o.x,y:o.y}),"edge-label"===o.dummy&&(r.x=o.x,r.y=o.y,r.width=o.width,r.height=o.height),t=n,o=e.node(t)})}}},2866:(e,t,n)=>{var o=n(2969);e.exports=function(e){return function(t){return o(t,e)}}},2929:(e,t,n)=>{var o=n(6552).Uint8Array;e.exports=o},2969:(e,t,n)=>{var o=n(5324),r=n(914);e.exports=function(e,t){for(var n=0,i=(t=o(t,e)).length;null!=e&&n<i;)e=e[r(t[n++])];return n&&n==i?e:void 0}},3028:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},3088:(e,t,n)=>{"use strict";var o=n(8208),r=n(7938).Graph,i=n(5758).slack;function s(e,t){return o.forEach(e.nodes(),function n(r){o.forEach(t.nodeEdges(r),function(o){var s=o.v,a=r===s?o.w:s;e.hasNode(a)||i(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))})}),e.nodeCount()}function a(e,t){return o.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return i(t,n)})}function l(e,t,n){o.forEach(e.nodes(),function(e){t.node(e).rank+=n})}e.exports=function(e){var t,n,o=new r({directed:!1}),c=e.nodes()[0],u=e.nodeCount();o.setNode(c,{});for(;s(o,e)<u;)t=a(o,e),n=o.hasNode(t.v)?i(e,t):-i(e,t),l(o,e,n);return o}},3097:(e,t,n)=>{var o=n(2969);e.exports=function(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}},3130:(e,t,n)=>{var o=n(8208),r=n(7938).Graph,i=n(6684);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new r,s=0,a=0;o.forEach(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),o.forEach(e.edges(),function(e){var o=n.edge(e.v,e.w)||0,r=t(e),i=o+r;n.setEdge(e.v,e.w,i),a=Math.max(a,n.node(e.v).out+=r),s=Math.max(s,n.node(e.w).in+=r)});var c=o.range(a+s+3).map(function(){return new i}),u=s+1;return o.forEach(n.nodes(),function(e){l(c,u,n.node(e))}),{graph:n,buckets:c,zeroIdx:u}}(e,t||s),c=function(e,t,n){var o,r=[],i=t[t.length-1],s=t[0];for(;e.nodeCount();){for(;o=s.dequeue();)a(e,t,n,o);for(;o=i.dequeue();)a(e,t,n,o);if(e.nodeCount())for(var l=t.length-2;l>0;--l)if(o=t[l].dequeue()){r=r.concat(a(e,t,n,o,!0));break}}return r}(n.graph,n.buckets,n.zeroIdx);return o.flatten(o.map(c,function(t){return e.outEdges(t.v,t.w)}),!0)};var s=o.constant(1);function a(e,t,n,r,i){var s=i?[]:void 0;return o.forEach(e.inEdges(r.v),function(o){var r=e.edge(o),a=e.node(o.v);i&&s.push({v:o.v,w:o.w}),a.out-=r,l(t,n,a)}),o.forEach(e.outEdges(r.v),function(o){var r=e.edge(o),i=o.w,s=e.node(i);s.in-=r,l(t,n,s)}),e.removeNode(r.v),s}function l(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},3204:(e,t,n)=>{var o=n(3343),r=n(2777),i=n(4052),s=n(4543),a=n(9194),l=n(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),u=!n&&r(e),d=!n&&!u&&s(e),h=!n&&!u&&!d&&l(e),f=n||u||d||h,p=f?o(e.length,String):[],m=p.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||p.push(g);return p}},3211:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},3223:(e,t,n)=>{var o=n(3868),r=n(4353),i=n(8710),s=n(1980),a=n(310),l=n(2777),c=n(4052),u=n(6272),d=n(4543),h=n(1629),f=n(6686),p=n(2322),m=n(1268),g=n(3737),v=n(1609);e.exports=function(e,t,n,y,b,x,w){var k=g(e,n),C=g(t,n),S=w.get(C);if(S)o(e,n,S);else{var E=x?x(k,C,n+"",e,t,w):void 0,D=void 0===E;if(D){var M=c(C),N=!M&&d(C),A=!M&&!N&&m(C);E=C,M||N||A?c(k)?E=k:u(k)?E=s(k):N?(D=!1,E=r(C,!0)):A?(D=!1,E=i(C,!0)):E=[]:p(C)||l(C)?(E=k,l(k)?E=v(k):f(k)&&!h(k)||(E=a(C))):D=!1}D&&(w.set(C,E),b(E,C,y,x,w),w.delete(C)),o(e,n,E)}}},3253:(e,t,n)=>{var o=n(5538),r=n(3868),i=n(4258),s=n(3223),a=n(6686),l=n(474),c=n(3737);e.exports=function e(t,n,u,d,h){t!==n&&i(n,function(i,l){if(h||(h=new o),a(i))s(t,n,l,u,e,d,h);else{var f=d?d(c(t,l),i,l+"",t,n,h):void 0;void 0===f&&(f=i),r(t,l,f)}},l)}},3279:e=>{e.exports=function(e){return e}},3331:(e,t,n)=>{var o=n(9676),r=n(929),i=n(7303);e.exports=function(e){return function(t,n,s){return s&&"number"!=typeof s&&r(t,n,s)&&(n=s=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),s=void 0===s?t<n?1:-1:i(s),o(t,n,s,e)}}},3343:e=>{e.exports=function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}},3366:(e,t,n)=>{var o=n(7894),r=n(9057);e.exports=function(e,t){return null!=e&&r(e,t,o)}},3411:(e,t,n)=>{var o=n(149),r=n(9096),i=n(8883),s=n(4052);e.exports=function(e,t){return(s(e)?o:i)(e,r(t,3))}},3440:(e,t,n)=>{var o=n(6552)["__core-js_shared__"];e.exports=o},3516:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},3577:(e,t,n)=>{e.exports={graphlib:n(7938),layout:n(6675),debug:n(3774),util:{time:n(5641).time,notime:n(5641).notime},version:n(5185)}},3668:(e,t,n)=>{var o=n(8902),r=n(2587),i=n(8114);e.exports=function(e,t,n,s,a,l){var c=1&n,u=e.length,d=t.length;if(u!=d&&!(c&&d>u))return!1;var h=l.get(e),f=l.get(t);if(h&&f)return h==t&&f==e;var p=-1,m=!0,g=2&n?new o:void 0;for(l.set(e,t),l.set(t,e);++p<u;){var v=e[p],y=t[p];if(s)var b=c?s(y,v,p,t,e,l):s(v,y,p,e,t,l);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!r(t,function(e,t){if(!i(g,t)&&(v===e||a(v,e,n,s,l)))return g.push(t)})){m=!1;break}}else if(v!==y&&!a(v,y,n,s,l)){m=!1;break}}return l.delete(e),l.delete(t),m}},3713:(e,t,n)=>{var o=n(6140),r=n(1143),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!o(e))return r(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3737:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}},3774:(e,t,n)=>{var o=n(8208),r=n(5641),i=n(7938).Graph;e.exports={debugOrdering:function(e){var t=r.buildLayerMatrix(e),n=new i({compound:!0,multigraph:!0}).setGraph({});return o.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),o.forEach(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name)}),o.forEach(t,function(e,t){var r="layer"+t;n.setNode(r,{rank:"same"}),o.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t})}),n}}},3781:(e,t,n)=>{var o=n(9417),r=n(8673);e.exports=function(e){for(var t=r(e),n=t.length;n--;){var i=t[n],s=e[i];t[n]=[i,s,o(s)]}return t}},3868:(e,t,n)=>{var o=n(1775),r=n(3211);e.exports=function(e,t,n){(void 0!==n&&!r(e[t],n)||void 0===n&&!(t in e))&&o(e,t,n)}},3892:e=>{e.exports=function(e){return this.__data__.has(e)}},3932:(e,t,n)=>{var o=n(396),r=n(2866),i=n(2597),s=n(914);e.exports=function(e){return i(e)?o(s(e)):r(e)}},4008:(e,t,n)=>{var o=n(7449),r=n(3366);e.exports=function(e,t){return o(e,t,function(t,n){return r(e,n)})}},4020:e=>{e.exports=function(e,t,n){for(var o=n-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}},4052:e=>{var t=Array.isArray;e.exports=t},4065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},4079:(e,t,n)=>{var o=n(8259),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=o(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(r,function(e,n,o,r){t.push(o?r.replace(i,"$1"):n||e)}),t});e.exports=s},4160:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}},4190:(e,t,n)=>{var o=n(1340);e.exports=function(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,C={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,o){var r,i={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,r)&&!S.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(1===l)i.children=o;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:a,props:i,_owner:C.current}}function D(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var M=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,r,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case o:l=!0}}if(l)return s=s(l=e),e=""===i?"."+N(l,0):i,w(s)?(r="",null!=e&&(r=e.replace(M,"$&/")+"/"),A(s,t,r,"",function(e){return e})):null!=s&&(D(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(M,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var u=i+N(a=e[c],c);l+=A(a,t,r,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=A(a=a.value,t,r,u=i+N(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,n){if(null==e)return e;var o=[],r=0;return A(e,o,"","",function(e){return t.call(n,e,r++)}),o}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _={current:null},j={transition:null},P={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:j,ReactCurrentOwner:C};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return O(e,function(){t++}),t},toArray:function(e){return O(e,function(e){return e})||[]},only:function(e){if(!D(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=I,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=C.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=o;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=D,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=j.transition;j.transition={};try{e()}finally{j.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return _.current.useCallback(e,t)},t.useContext=function(e){return _.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return _.current.useDeferredValue(e)},t.useEffect=function(e,t){return _.current.useEffect(e,t)},t.useId=function(){return _.current.useId()},t.useImperativeHandle=function(e,t,n){return _.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return _.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return _.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return _.current.useMemo(e,t)},t.useReducer=function(e,t,n){return _.current.useReducer(e,t,n)},t.useRef=function(e){return _.current.useRef(e)},t.useState=function(e){return _.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return _.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return _.current.useTransition()},t.version="18.3.1"},4258:(e,t,n)=>{var o=n(5906)();e.exports=o},4262:(e,t,n)=>{var o=n(8895),r=n(4052);e.exports=function(e,t,n){var i=t(e);return r(e)?i:o(i,n(e))}},4308:(e,t,n)=>{"use strict";var o=n(8208);function r(e,t,n){for(var r=o.zipObject(n,o.map(n,function(e,t){return t})),i=o.flatten(o.map(t,function(t){return o.sortBy(o.map(e.outEdges(t),function(t){return{pos:r[t.w],weight:e.edge(t).weight}}),"pos")}),!0),s=1;s<n.length;)s<<=1;var a=2*s-1;s-=1;var l=o.map(new Array(a),function(){return 0}),c=0;return o.forEach(i.forEach(function(e){var t=e.pos+s;l[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=l[t+1]),l[t=t-1>>1]+=e.weight;c+=e.weight*n})),c}e.exports=function(e,t){for(var n=0,o=1;o<t.length;++o)n+=r(e,t[o-1],t[o]);return n}},4320:(e,t,n)=>{var o=n(3713),r=n(6924),i=n(2777),s=n(4052),a=n(6571),l=n(4543),c=n(6140),u=n(1268),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||i(e)))return!e.length;var t=r(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!o(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},4353:(e,t,n)=>{e=n.nmd(e);var o=n(6552),r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,s=i&&i.exports===r?o.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,o=a?a(n):new e.constructor(n);return e.copy(o),o}},4391:(e,t,n)=>{"use strict";var o=n(7950);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},4416:(e,t,n)=>{var o=n(8902),r=n(5866),i=n(1558),s=n(8114),a=n(8182),l=n(2074);e.exports=function(e,t,n){var c=-1,u=r,d=e.length,h=!0,f=[],p=f;if(n)h=!1,u=i;else if(d>=200){var m=t?null:a(e);if(m)return l(m);h=!1,u=s,p=new o}else p=t?[]:f;e:for(;++c<d;){var g=e[c],v=t?t(g):g;if(g=n||0!==g?g:0,h&&v===v){for(var y=p.length;y--;)if(p[y]===v)continue e;t&&p.push(v),f.push(g)}else u(p,v,n)||(p!==f&&p.push(v),f.push(g))}return f}},4428:(e,t,n)=>{var o=n(5750);function r(){this._arr=[],this._keyIndices={}}e.exports=r,r.prototype.size=function(){return this._arr.length},r.prototype.keys=function(){return this._arr.map(function(e){return e.key})},r.prototype.has=function(e){return o.has(this._keyIndices,e)},r.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},r.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},r.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!o.has(n,e)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1},r.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},r.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},r.prototype._heapify=function(e){var t=this._arr,n=2*e,o=n+1,r=e;n<t.length&&(r=t[n].priority<t[r].priority?n:r,o<t.length&&(r=t[o].priority<t[r].priority?o:r),r!==e&&(this._swap(e,r),this._heapify(r)))},r.prototype._decrease=function(e){for(var t,n=this._arr,o=n[e].priority;0!==e&&!(n[t=e>>1].priority<o);)this._swap(e,t),e=t},r.prototype._swap=function(e,t){var n=this._arr,o=this._keyIndices,r=n[e],i=n[t];n[e]=i,n[t]=r,o[i.key]=e,o[r.key]=t}},4501:(e,t,n)=>{"use strict";var o=n(8208),r=n(3088),i=n(5758).slack,s=n(5758).longestPath,a=n(7938).alg.preorder,l=n(7938).alg.postorder,c=n(5641).simplify;function u(e){e=c(e),s(e);var t,n=r(e);for(f(n),d(n,e);t=m(n);)v(n,e,t,g(n,e,t))}function d(e,t){var n=l(e,e.nodes());n=n.slice(0,n.length-1),o.forEach(n,function(n){!function(e,t,n){var o=e.node(n),r=o.parent;e.edge(n,r).cutvalue=h(e,t,n)}(e,t,n)})}function h(e,t,n){var r=e.node(n).parent,i=!0,s=t.edge(n,r),a=0;return s||(i=!1,s=t.edge(r,n)),a=s.weight,o.forEach(t.nodeEdges(n),function(o){var s,l,c=o.v===n,u=c?o.w:o.v;if(u!==r){var d=c===i,h=t.edge(o).weight;if(a+=d?h:-h,s=n,l=u,e.hasEdge(s,l)){var f=e.edge(n,u).cutvalue;a+=d?-f:f}}}),a}function f(e,t){arguments.length<2&&(t=e.nodes()[0]),p(e,{},1,t)}function p(e,t,n,r,i){var s=n,a=e.node(r);return t[r]=!0,o.forEach(e.neighbors(r),function(i){o.has(t,i)||(n=p(e,t,n,i,r))}),a.low=s,a.lim=n++,i?a.parent=i:delete a.parent,n}function m(e){return o.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g(e,t,n){var r=n.v,s=n.w;t.hasEdge(r,s)||(r=n.w,s=n.v);var a=e.node(r),l=e.node(s),c=a,u=!1;a.lim>l.lim&&(c=l,u=!0);var d=o.filter(t.edges(),function(t){return u===y(e,e.node(t.v),c)&&u!==y(e,e.node(t.w),c)});return o.minBy(d,function(e){return i(t,e)})}function v(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),f(e),d(e,t),function(e,t){var n=o.find(e.nodes(),function(e){return!t.node(e).parent}),r=a(e,n);r=r.slice(1),o.forEach(r,function(n){var o=e.node(n).parent,r=t.edge(n,o),i=!1;r||(r=t.edge(o,n),i=!0),t.node(n).rank=t.node(o).rank+(i?r.minlen:-r.minlen)})}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=u,u.initLowLimValues=f,u.initCutValues=d,u.calcCutValue=h,u.leaveEdge=m,u.enterEdge=g,u.exchangeEdges=v},4543:(e,t,n)=>{e=n.nmd(e);var o=n(6552),r=n(14),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?o.Buffer:void 0,l=(a?a.isBuffer:void 0)||r;e.exports=l},4545:(e,t,n)=>{var o=n(7160);e.exports=function(){this.__data__=new o,this.size=0}},4552:(e,t,n)=>{var o=n(9812),r=Object.prototype,i=r.hasOwnProperty,s=r.toString,a=o?o.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var o=!0}catch(l){}var r=s.call(e);return o&&(t?e[a]=n:delete e[a]),r}},4570:(e,t,n)=>{var o=n(5647),r=n(929);e.exports=function(e){return o(function(t,n){var o=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,a&&r(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++o<i;){var l=n[o];l&&e(t,l,o,s)}return t})}},4657:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},4664:(e,t,n)=>{var o=n(4258),r=n(8673);e.exports=function(e,t){return e&&o(e,t,r)}},4677:(e,t,n)=>{var o=n(3253),r=n(4570)(function(e,t,n){o(e,t,n)});e.exports=r},4724:(e,t,n)=>{var o=n(396)("length");e.exports=o},4757:(e,t,n)=>{var o=n(6552);e.exports=function(){return o.Date.now()}},4816:(e,t,n)=>{var o=n(7251),r=n(7159),i=n(438),s=n(9394),a=n(6874);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,e.exports=l},5029:(e,t,n)=>{var o=n(6989),r=n(3097),i=n(3366),s=n(2597),a=n(9417),l=n(1310),c=n(914);e.exports=function(e,t){return s(e)&&a(t)?l(c(e),t):function(n){var s=r(n,e);return void 0===s&&s===t?i(n,e):o(t,s,3)}}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5051:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5111:(e,t,n)=>{var o=n(3279);e.exports=function(e){return"function"==typeof e?e:o}},5119:(e,t,n)=>{var o=n(6614),r=n(474);e.exports=function(e,t){return e&&o(t,r(t),e)}},5146:(e,t,n)=>{var o=n(8208),r=n(5641);function i(e,t,n,s,a,l,c){var u=e.children(c);if(u.length){var d=r.addBorderNode(e,"_bt"),h=r.addBorderNode(e,"_bb"),f=e.node(c);e.setParent(d,c),f.borderTop=d,e.setParent(h,c),f.borderBottom=h,o.forEach(u,function(o){i(e,t,n,s,a,l,o);var r=e.node(o),u=r.borderTop?r.borderTop:o,f=r.borderBottom?r.borderBottom:o,p=r.borderTop?s:2*s,m=u!==f?1:a-l[c]+1;e.setEdge(d,u,{weight:p,minlen:m,nestingEdge:!0}),e.setEdge(f,h,{weight:p,minlen:m,nestingEdge:!0})}),e.parent(c)||e.setEdge(t,d,{weight:0,minlen:a+l[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:n})}e.exports={run:function(e){var t=r.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(r,i){var s=e.children(r);s&&s.length&&o.forEach(s,function(e){n(e,i+1)}),t[r]=i}return o.forEach(e.children(),function(e){n(e,1)}),t}(e),s=o.max(o.values(n))-1,a=2*s+1;e.graph().nestingRoot=t,o.forEach(e.edges(),function(t){e.edge(t).minlen*=a});var l=function(e){return o.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}(e)+1;o.forEach(e.children(),function(o){i(e,t,a,l,s,n,o)}),e.graph().nodeRankFactor=a},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,o.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}}},5185:e=>{e.exports="0.8.5"},5193:(e,t,n)=>{var o=n(6913),r=n(2761);e.exports=function(e){return r(e)&&"[object Arguments]"==o(e)}},5204:(e,t,n)=>{var o=n(7937)(n(6552),"Map");e.exports=o},5324:(e,t,n)=>{var o=n(4052),r=n(2597),i=n(4079),s=n(1069);e.exports=function(e,t){return o(e)?e:r(e,t)?[e]:i(s(e))}},5387:(e,t,n)=>{var o=n(7937)(n(6552),"Promise");e.exports=o},5428:(e,t,n)=>{var o=n(6913),r=n(6173),i=n(2761),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&r(e.length)&&!!s[o(e)]}},5491:(e,t,n)=>{var o=n(726),r=n(5652),i=n(5111),s=n(4052);e.exports=function(e,t){return(s(e)?o:r)(e,i(t))}},5538:(e,t,n)=>{var o=n(7160),r=n(4545),i=n(793),s=n(7760),a=n(3892),l=n(6788);function c(e){var t=this.__data__=new o(e);this.size=t.size}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=a,c.prototype.set=l,e.exports=c},5575:(e,t,n)=>{var o=n(7937)(Object,"create");e.exports=o},5636:(e,t,n)=>{var o=n(1170),r=Math.max;e.exports=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var i=arguments,s=-1,a=r(i.length-t,0),l=Array(a);++s<a;)l[s]=i[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=i[s];return c[t]=n(l),o(e,this,c)}}},5640:(e,t,n)=>{var o=n(3713),r=n(6924),i=n(6571),s=n(620),a=n(1632);e.exports=function(e){if(null==e)return 0;if(i(e))return s(e)?a(e):e.length;var t=r(e);return"[object Map]"==t||"[object Set]"==t?e.size:o(e).length}},5641:(e,t,n)=>{"use strict";var o=n(8208),r=n(7938).Graph;function i(e,t,n,r){var i;do{i=o.uniqueId(r)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function s(e){return o.max(o.map(e.nodes(),function(t){var n=e.node(t).rank;if(!o.isUndefined(n))return n}))}e.exports={addDummyNode:i,simplify:function(e){var t=(new r).setGraph(e.graph());return o.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),o.forEach(e.edges(),function(n){var o=t.edge(n.v,n.w)||{weight:0,minlen:1},r=e.edge(n);t.setEdge(n.v,n.w,{weight:o.weight+r.weight,minlen:Math.max(o.minlen,r.minlen)})}),t},asNonCompoundGraph:function(e){var t=new r({multigraph:e.isMultigraph()}).setGraph(e.graph());return o.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),o.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=o.map(e.nodes(),function(t){var n={};return o.forEach(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return o.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=o.map(e.nodes(),function(t){var n={};return o.forEach(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return o.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,o,r=e.x,i=e.y,s=t.x-r,a=t.y-i,l=e.width/2,c=e.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*l>Math.abs(s)*c?(a<0&&(c=-c),n=c*s/a,o=c):(s<0&&(l=-l),n=l,o=l*a/s);return{x:r+n,y:i+o}},buildLayerMatrix:function(e){var t=o.map(o.range(s(e)+1),function(){return[]});return o.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;o.isUndefined(i)||(t[i][r.order]=n)}),t},normalizeRanks:function(e){var t=o.min(o.map(e.nodes(),function(t){return e.node(t).rank}));o.forEach(e.nodes(),function(n){var r=e.node(n);o.has(r,"rank")&&(r.rank-=t)})},removeEmptyRanks:function(e){var t=o.min(o.map(e.nodes(),function(t){return e.node(t).rank})),n=[];o.forEach(e.nodes(),function(o){var r=e.node(o).rank-t;n[r]||(n[r]=[]),n[r].push(o)});var r=0,i=e.graph().nodeRankFactor;o.forEach(n,function(t,n){o.isUndefined(t)&&n%i!==0?--r:r&&o.forEach(t,function(t){e.node(t).rank+=r})})},addBorderNode:function(e,t,n,o){var r={width:0,height:0};arguments.length>=4&&(r.rank=n,r.order=o);return i(e,"border",r,t)},maxRank:s,partition:function(e,t){var n={lhs:[],rhs:[]};return o.forEach(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n},time:function(e,t){var n=o.now();try{return t()}finally{console.log(e+" time: "+(o.now()-n)+"ms")}},notime:function(e,t){return t()}}},5647:(e,t,n)=>{var o=n(3279),r=n(5636),i=n(6350);e.exports=function(e,t){return i(r(e,t,o),e+"")}},5652:(e,t,n)=>{var o=n(4664),r=n(6516)(o);e.exports=r},5654:(e,t,n)=>{var o=n(7937),r=function(){try{var e=o(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=r},5673:(e,t,n)=>{"use strict";var o=n(8208),r=n(3130);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?r(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},r={};function i(s){o.has(r,s)||(r[s]=!0,n[s]=!0,o.forEach(e.outEdges(s),function(e){o.has(n,e.w)?t.push(e):i(e.w)}),delete n[s])}return o.forEach(e.nodes(),i),t}(e);o.forEach(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,o.uniqueId("rev"))})},undo:function(e){o.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var o=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,o)}})}}},5713:e=>{e.exports=function(){}},5750:(e,t,n)=>{var o;try{o={clone:n(1740),constant:n(2541),each:n(2580),filter:n(723),has:n(2117),isArray:n(4052),isEmpty:n(4320),isFunction:n(1629),isUndefined:n(141),keys:n(8673),map:n(3411),reduce:n(2759),size:n(5640),transform:n(2717),union:n(450),values:n(6727)}}catch(r){}o||(o=window._),e.exports=o},5752:(e,t,n)=>{var o=n(9395),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,s,a){var l=1&n,c=o(e),u=c.length;if(u!=o(t).length&&!l)return!1;for(var d=u;d--;){var h=c[d];if(!(l?h in t:r.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=l;++d<u;){var v=e[h=c[d]],y=t[h];if(i)var b=l?i(y,v,h,t,e,a):i(v,y,h,e,t,a);if(!(void 0===b?v===y||s(v,y,n,i,a):b)){m=!1;break}g||(g="constructor"==h)}if(m&&!g){var x=e.constructor,w=t.constructor;x==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w||(m=!1)}return a.delete(e),a.delete(t),m}},5758:(e,t,n)=>{"use strict";var o=n(8208);e.exports={longestPath:function(e){var t={};o.forEach(e.sources(),function n(r){var i=e.node(r);if(o.has(t,r))return i.rank;t[r]=!0;var s=o.min(o.map(e.outEdges(r),function(t){return n(t.w)-e.edge(t).minlen}));return s!==Number.POSITIVE_INFINITY&&void 0!==s&&null!==s||(s=0),i.rank=s})},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},5791:(e,t,n)=>{var o=n(6924),r=n(2761);e.exports=function(e){return r(e)&&"[object Map]"==o(e)}},5797:(e,t,n)=>{var o=n(4816);function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var s=e.apply(this,o);return n.cache=i.set(r,s)||i,s};return n.cache=new(r.Cache||o),n}r.Cache=o,e.exports=r},5816:e=>{e.exports=function(e,t,n,o){for(var r=e.length,i=n+(o?1:-1);o?i--:++i<r;)if(t(e[i],i,e))return i;return-1}},5819:(e,t,n)=>{"use strict";var o=n(8208);e.exports=function(e){var t={},n=o.filter(e.nodes(),function(t){return!e.children(t).length}),r=o.max(o.map(n,function(t){return e.node(t).rank})),i=o.map(o.range(r+1),function(){return[]});var s=o.sortBy(n,function(t){return e.node(t).rank});return o.forEach(s,function n(r){if(o.has(t,r))return;t[r]=!0;var s=e.node(r);i[s.rank].push(r),o.forEach(e.successors(r),n)}),i}},5822:(e,t,n)=>{var o=n(5750),r=n(4428);e.exports=function(e,t,n,o){return function(e,t,n,o){var i,s,a={},l=new r,c=function(e){var t=e.v!==i?e.v:e.w,o=a[t],r=n(e),c=s.distance+r;if(r<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+r);c<o.distance&&(o.distance=c,o.predecessor=i,l.decrease(t,c))};e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},l.add(e,n)});for(;l.size()>0&&(i=l.removeMin(),(s=a[i]).distance!==Number.POSITIVE_INFINITY);)o(i).forEach(c);return a}(e,String(t),n||i,o||function(t){return e.outEdges(t)})};var i=o.constant(1)},5857:(e,t,n)=>{var o=n(819),r=n(5636),i=n(6350);e.exports=function(e){return i(r(e,void 0,o),e+"")}},5866:(e,t,n)=>{var o=n(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&o(e,t,0)>-1}},5893:(e,t,n)=>{var o=n(6599);e.exports=function(e,t,n){for(var r=-1,i=e.criteria,s=t.criteria,a=i.length,l=n.length;++r<a;){var c=o(i[r],s[r]);if(c)return r>=l?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}},5906:e=>{e.exports=function(e){return function(t,n,o){for(var r=-1,i=Object(t),s=o(t),a=s.length;a--;){var l=s[e?a:++r];if(!1===n(i[l],l,i))break}return t}}},5921:(e,t,n)=>{var o=n(449),r=n(7574),i=n(6832),s=i&&i.isSet,a=s?r(s):o;e.exports=a},5972:(e,t,n)=>{var o=n(8208),r=n(5641);function i(e,t,n,o,i,s){var a={width:0,height:0,rank:s,borderType:t},l=i[t][s-1],c=r.addDummyNode(e,"border",a,n);i[t][s]=c,e.setParent(c,o),l&&e.setEdge(l,c,{weight:1})}e.exports=function(e){o.forEach(e.children(),function t(n){var r=e.children(n),s=e.node(n);if(r.length&&o.forEach(r,t),o.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var a=s.minRank,l=s.maxRank+1;a<l;++a)i(e,"borderLeft","_bl",n,s,a),i(e,"borderRight","_br",n,s,a)}})}},5990:(e,t,n)=>{var o=n(3028)(Object.getPrototypeOf,Object);e.exports=o},5992:(e,t,n)=>{var o=n(5750);e.exports=function(e){var t,n={},r=[];function i(r){o.has(n,r)||(n[r]=!0,t.push(r),o.each(e.successors(r),i),o.each(e.predecessors(r),i))}return o.each(e.nodes(),function(e){t=[],i(e),t.length&&r.push(t)}),r}},6095:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},6140:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},6173:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6179:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6272:(e,t,n)=>{var o=n(6571),r=n(2761);e.exports=function(e){return r(e)&&o(e)}},6297:(e,t,n)=>{var o=n(8208);e.exports=function(e,t){return o.map(t,function(t){var n=e.inEdges(t);if(n.length){var r=o.reduce(n,function(t,n){var o=e.edge(n),r=e.node(n.v);return{sum:t.sum+o.weight*r.order,weight:t.weight+o.weight}},{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}})}},6311:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6326:(e,t,n)=>{var o=n(8895),r=n(5990),i=n(9621),s=n(7828),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)o(t,i(e)),e=r(e);return t}:s;e.exports=a},6350:(e,t,n)=>{var o=n(8325),r=n(6578)(o);e.exports=r},6368:(e,t,n)=>{var o=n(5750),r=n(191),i=n(4428);e.exports=function(e,t){var n,s=new r,a={},l=new i;function c(e){var o=e.v===n?e.w:e.v,r=l.priority(o);if(void 0!==r){var i=t(e);i<r&&(a[o]=n,l.decrease(o,i))}}if(0===e.nodeCount())return s;o.each(e.nodes(),function(e){l.add(e,Number.POSITIVE_INFINITY),s.setNode(e)}),l.decrease(e.nodes()[0],0);var u=!1;for(;l.size()>0;){if(n=l.removeMin(),o.has(a,n))s.setEdge(n,a[n]);else{if(u)throw new Error("Input graph is not connected: "+e);u=!0}e.nodeEdges(n).forEach(c)}return s}},6399:(e,t,n)=>{var o=n(5538),r=n(3668),i=n(9987),s=n(5752),a=n(6924),l=n(4052),c=n(4543),u=n(1268),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,m,g,v){var y=l(e),b=l(t),x=y?h:a(e),w=b?h:a(t),k=(x=x==d?f:x)==f,C=(w=w==d?f:w)==f,S=x==w;if(S&&c(e)){if(!c(t))return!1;y=!0,k=!1}if(S&&!k)return v||(v=new o),y||u(e)?r(e,t,n,m,g,v):i(e,t,x,n,m,g,v);if(!(1&n)){var E=k&&p.call(e,"__wrapped__"),D=C&&p.call(t,"__wrapped__");if(E||D){var M=E?e.value():e,N=D?t.value():t;return v||(v=new o),g(M,N,n,m,v)}}return!!S&&(v||(v=new o),s(e,t,n,m,g,v))}},6434:(e,t,n)=>{var o=n(7132);e.exports=function(e){return o(e,5)}},6467:(e,t,n)=>{var o=n(8208);e.exports=function(e){var t=function(e){var t={},n=0;function r(i){var s=n;o.forEach(e.children(i),r),t[i]={low:s,lim:n++}}return o.forEach(e.children(),r),t}(e);o.forEach(e.graph().dummyChains,function(n){for(var o=e.node(n),r=o.edgeObj,i=function(e,t,n,o){var r,i,s=[],a=[],l=Math.min(t[n].low,t[o].low),c=Math.max(t[n].lim,t[o].lim);r=n;do{r=e.parent(r),s.push(r)}while(r&&(t[r].low>l||c>t[r].lim));i=r,r=o;for(;(r=e.parent(r))!==i;)a.push(r);return{path:s.concat(a.reverse()),lca:i}}(e,t,r.v,r.w),s=i.path,a=i.lca,l=0,c=s[l],u=!0;n!==r.w;){if(o=e.node(n),u){for(;(c=s[l])!==a&&e.node(c).maxRank<o.rank;)l++;c===a&&(u=!1)}if(!u){for(;l<s.length-1&&e.node(c=s[l+1]).minRank<=o.rank;)l++;c=s[l]}e.setParent(n,c),n=e.successors(n)[0]}})}},6487:e=>{e.exports=function(e,t,n,o,r){return r(e,function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)}),n}},6516:(e,t,n)=>{var o=n(6571);e.exports=function(e,t){return function(n,r){if(null==n)return n;if(!o(n))return e(n,r);for(var i=n.length,s=t?i:-1,a=Object(n);(t?s--:++s<i)&&!1!==r(a[s],s,a););return n}}},6532:(e,t,n)=>{var o=n(5538),r=n(6989);e.exports=function(e,t,n,i){var s=n.length,a=s,l=!i;if(null==e)return!a;for(e=Object(e);s--;){var c=n[s];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<a;){var u=(c=n[s])[0],d=e[u],h=c[1];if(l&&c[2]){if(void 0===d&&!(u in e))return!1}else{var f=new o;if(i)var p=i(d,h,u,e,t,f);if(!(void 0===p?r(h,d,3,i,f):p))return!1}}return!0}},6552:(e,t,n)=>{var o=n(7105),r="object"==typeof self&&self&&self.Object===Object&&self,i=o||r||Function("return this")();e.exports=i},6571:(e,t,n)=>{var o=n(1629),r=n(6173);e.exports=function(e){return null!=e&&r(e.length)&&!o(e)}},6578:e=>{var t=Date.now;e.exports=function(e){var n=0,o=0;return function(){var r=t(),i=16-(r-o);if(o=r,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},6599:(e,t,n)=>{var o=n(9841);e.exports=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e===e,s=o(e),a=void 0!==t,l=null===t,c=t===t,u=o(t);if(!l&&!u&&!s&&e>t||s&&a&&c&&!l&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!s&&!u&&e<t||u&&n&&i&&!r&&!s||l&&n&&i||!a&&i||!c)return-1}return 0}},6600:(e,t,n)=>{var o=n(7937)(n(6552),"WeakMap");e.exports=o},6604:(e,t,n)=>{var o=n(3331)();e.exports=o},6614:(e,t,n)=>{var o=n(8420),r=n(1775);e.exports=function(e,t,n,i){var s=!n;n||(n={});for(var a=-1,l=t.length;++a<l;){var c=t[a],u=i?i(n[c],e[c],c,n,e):void 0;void 0===u&&(u=e[c]),s?r(n,c,u):o(n,c,u)}return n}},6675:(e,t,n)=>{"use strict";var o=n(8208),r=n(5673),i=n(2786),s=n(2460),a=n(5641).normalizeRanks,l=n(6467),c=n(5641).removeEmptyRanks,u=n(5146),d=n(5972),h=n(1981),f=n(550),p=n(1277),m=n(5641),g=n(7938).Graph;e.exports=function(e,t){var n=t&&t.debugTiming?m.time:m.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return function(e){var t=new g({multigraph:!0,compound:!0}),n=D(e.graph());return t.setGraph(o.merge({},y,E(n,v),o.pick(n,b))),o.forEach(e.nodes(),function(n){var r=D(e.node(n));t.setNode(n,o.defaults(E(r,x),w)),t.setParent(n,e.parent(n))}),o.forEach(e.edges(),function(n){var r=D(e.edge(n));t.setEdge(n,o.merge({},C,E(r,k),o.pick(r,S)))}),t}(e)});n("  runLayout",function(){!function(e,t){t("    makeSpaceForEdgeLabels",function(){!function(e){var t=e.graph();t.ranksep/=2,o.forEach(e.edges(),function(n){var o=e.edge(n);o.minlen*=2,"c"!==o.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?o.width+=o.labeloffset:o.height+=o.labeloffset)})}(e)}),t("    removeSelfEdges",function(){!function(e){o.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}(e)}),t("    acyclic",function(){r.run(e)}),t("    nestingGraph.run",function(){u.run(e)}),t("    rank",function(){s(m.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){!function(e){o.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var o=e.node(t.v),r={rank:(e.node(t.w).rank-o.rank)/2+o.rank,e:t};m.addDummyNode(e,"edge-proxy",r,"_ep")}})}(e)}),t("    removeEmptyRanks",function(){c(e)}),t("    nestingGraph.cleanup",function(){u.cleanup(e)}),t("    normalizeRanks",function(){a(e)}),t("    assignRankMinMax",function(){!function(e){var t=0;o.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=o.max(t,r.maxRank))}),e.graph().maxRank=t}(e)}),t("    removeEdgeLabelProxies",function(){!function(e){o.forEach(e.nodes(),function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}(e)}),t("    normalize.run",function(){i.run(e)}),t("    parentDummyChains",function(){l(e)}),t("    addBorderSegments",function(){d(e)}),t("    order",function(){f(e)}),t("    insertSelfEdges",function(){!function(e){var t=m.buildLayerMatrix(e);o.forEach(t,function(t){var n=0;o.forEach(t,function(t,r){var i=e.node(t);i.order=r+n,o.forEach(i.selfEdges,function(t){m.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},"_se")}),delete i.selfEdges})})}(e)}),t("    adjustCoordinateSystem",function(){h.adjust(e)}),t("    position",function(){p(e)}),t("    positionSelfEdges",function(){!function(e){o.forEach(e.nodes(),function(t){var n=e.node(t);if("selfedge"===n.dummy){var o=e.node(n.e.v),r=o.x+o.width/2,i=o.y,s=n.x-r,a=o.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:r+2*s/3,y:i-a},{x:r+5*s/6,y:i-a},{x:r+s,y:i},{x:r+5*s/6,y:i+a},{x:r+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}(e)}),t("    removeBorderNodes",function(){!function(e){o.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),s=e.node(o.last(n.borderLeft)),a=e.node(o.last(n.borderRight));n.width=Math.abs(a.x-s.x),n.height=Math.abs(i.y-r.y),n.x=s.x+n.width/2,n.y=r.y+n.height/2}}),o.forEach(e.nodes(),function(t){"border"===e.node(t).dummy&&e.removeNode(t)})}(e)}),t("    normalize.undo",function(){i.undo(e)}),t("    fixupEdgeLabelCoords",function(){!function(e){o.forEach(e.edges(),function(t){var n=e.edge(t);if(o.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}(e)}),t("    undoCoordinateSystem",function(){h.undo(e)}),t("    translateGraph",function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,s=e.graph(),a=s.marginx||0,l=s.marginy||0;function c(e){var o=e.x,s=e.y,a=e.width,l=e.height;t=Math.min(t,o-a/2),n=Math.max(n,o+a/2),r=Math.min(r,s-l/2),i=Math.max(i,s+l/2)}o.forEach(e.nodes(),function(t){c(e.node(t))}),o.forEach(e.edges(),function(t){var n=e.edge(t);o.has(n,"x")&&c(n)}),t-=a,r-=l,o.forEach(e.nodes(),function(n){var o=e.node(n);o.x-=t,o.y-=r}),o.forEach(e.edges(),function(n){var i=e.edge(n);o.forEach(i.points,function(e){e.x-=t,e.y-=r}),o.has(i,"x")&&(i.x-=t),o.has(i,"y")&&(i.y-=r)}),s.width=n-t+a,s.height=i-r+l}(e)}),t("    assignNodeIntersects",function(){!function(e){o.forEach(e.edges(),function(t){var n,o,r=e.edge(t),i=e.node(t.v),s=e.node(t.w);r.points?(n=r.points[0],o=r.points[r.points.length-1]):(r.points=[],n=s,o=i),r.points.unshift(m.intersectRect(i,n)),r.points.push(m.intersectRect(s,o))})}(e)}),t("    reversePoints",function(){!function(e){o.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}(e)}),t("    acyclic.undo",function(){r.undo(e)})}(t,n)}),n("  updateInputGraph",function(){!function(e,t){o.forEach(e.nodes(),function(n){var o=e.node(n),r=t.node(n);o&&(o.x=r.x,o.y=r.y,t.children(n).length&&(o.width=r.width,o.height=r.height))}),o.forEach(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,o.has(i,"x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)})})};var v=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],x=["width","height"],w={width:0,height:0},k=["minlen","weight","width","height","labeloffset"],C={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function E(e,t){return o.mapValues(o.pick(e,t),Number)}function D(e){var t={};return o.forEach(e,function(e,n){t[n.toLowerCase()]=e}),t}},6684:e=>{function t(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function o(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=t,t.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},t.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},t.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,o)),n=n._prev;return"["+e.join(", ")+"]"}},6686:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6704:e=>{e.exports=function(e){return this.__data__.has(e)}},6727:(e,t,n)=>{var o=n(6983),r=n(8673);e.exports=function(e){return null==e?[]:o(e,r(e))}},6741:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},6745:(e,t,n)=>{var o=n(9742),r=n(61),i=n(3279);e.exports=function(e){return e&&e.length?o(e,i,r):void 0}},6788:(e,t,n)=>{var o=n(7160),r=n(5204),i=n(4816);e.exports=function(e,t){var n=this.__data__;if(n instanceof o){var s=n.__data__;if(!r||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(e,t),this.size=n.size,this}},6806:(e,t,n)=>{var o=n(1516);e.exports=function(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},6832:(e,t,n)=>{e=n.nmd(e);var o=n(7105),r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,s=i&&i.exports===r&&o.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=a},6874:(e,t,n)=>{var o=n(2622);e.exports=function(e,t){var n=o(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}},6913:(e,t,n)=>{var o=n(9812),r=n(4552),i=n(6095),s=o?o.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?r(e):i(e)}},6924:(e,t,n)=>{var o=n(7685),r=n(5204),i=n(5387),s=n(2070),a=n(6600),l=n(6913),c=n(6996),u="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",m=c(o),g=c(r),v=c(i),y=c(s),b=c(a),x=l;(o&&x(new o(new ArrayBuffer(1)))!=p||r&&x(new r)!=u||i&&x(i.resolve())!=d||s&&x(new s)!=h||a&&x(new a)!=f)&&(x=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,o=n?c(n):"";if(o)switch(o){case m:return p;case g:return u;case v:return d;case y:return h;case b:return f}return t}),e.exports=x},6945:(e,t,n)=>{var o=n(5750);e.exports=function(e,t,n){return function(e,t,n){var o={},r=e.nodes();return r.forEach(function(e){o[e]={},o[e][e]={distance:0},r.forEach(function(t){e!==t&&(o[e][t]={distance:Number.POSITIVE_INFINITY})}),n(e).forEach(function(n){var r=n.v===e?n.w:n.v,i=t(n);o[e][r]={distance:i,predecessor:e}})}),r.forEach(function(e){var t=o[e];r.forEach(function(n){var i=o[n];r.forEach(function(n){var o=i[e],r=t[n],s=i[n],a=o.distance+r.distance;a<s.distance&&(s.distance=a,s.predecessor=r.predecessor)})})}),o}(e,t||r,n||function(t){return e.outEdges(t)})};var r=o.constant(1)},6954:(e,t,n)=>{var o=n(1629),r=n(7857),i=n(6686),s=n(6996),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||r(e))&&(o(e)?h:a).test(s(e))}},6983:(e,t,n)=>{var o=n(149);e.exports=function(e,t){return o(t,function(t){return e[t]})}},6989:(e,t,n)=>{var o=n(6399),r=n(2761);e.exports=function e(t,n,i,s,a){return t===n||(null==t||null==n||!r(t)&&!r(n)?t!==t&&n!==n:o(t,n,i,s,e,a))}},6996:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},7105:(e,t,n)=>{var o="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=o},7116:(e,t,n)=>{var o=n(9812),r=n(2777),i=n(4052),s=o?o.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||r(e)||!!(s&&e&&e[s])}},7132:(e,t,n)=>{var o=n(5538),r=n(726),i=n(8420),s=n(1104),a=n(5119),l=n(4353),c=n(1980),u=n(8124),d=n(9075),h=n(9395),f=n(8592),p=n(6924),m=n(8268),g=n(8630),v=n(310),y=n(4052),b=n(4543),x=n(7887),w=n(6686),k=n(5921),C=n(8673),S=n(474),E="[object Arguments]",D="[object Function]",M="[object Object]",N={};N[E]=N["[object Array]"]=N["[object ArrayBuffer]"]=N["[object DataView]"]=N["[object Boolean]"]=N["[object Date]"]=N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Map]"]=N["[object Number]"]=N[M]=N["[object RegExp]"]=N["[object Set]"]=N["[object String]"]=N["[object Symbol]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N["[object Error]"]=N[D]=N["[object WeakMap]"]=!1,e.exports=function e(t,n,A,O,T,_){var j,P=1&n,I=2&n,R=4&n;if(A&&(j=T?A(t,O,T,_):A(t)),void 0!==j)return j;if(!w(t))return t;var F=y(t);if(F){if(j=m(t),!P)return c(t,j)}else{var z=p(t),L=z==D||"[object GeneratorFunction]"==z;if(b(t))return l(t,P);if(z==M||z==E||L&&!T){if(j=I||L?{}:v(t),!P)return I?d(t,a(j,t)):u(t,s(j,t))}else{if(!N[z])return T?t:{};j=g(t,z,P)}}_||(_=new o);var B=_.get(t);if(B)return B;_.set(t,j),k(t)?t.forEach(function(o){j.add(e(o,n,A,o,t,_))}):x(t)&&t.forEach(function(o,r){j.set(r,e(o,n,A,r,t,_))});var V=F?void 0:(R?I?f:h:I?S:C)(t);return r(V||t,function(o,r){V&&(o=t[r=o]),i(j,r,e(o,n,A,r,t,_))}),j}},7159:(e,t,n)=>{var o=n(2622);e.exports=function(e){var t=o(this,e).delete(e);return this.size-=t?1:0,t}},7160:(e,t,n)=>{var o=n(7563),r=n(9935),i=n(4190),s=n(1946),a=n(1714);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,e.exports=l},7168:e=>{var t="\\ud800-\\udfff",n="["+t+"]",o="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+o+"|"+r+")"+"?",c="[\\ufe0e\\ufe0f]?",u=c+l+("(?:\\u200d(?:"+[i,s,a].join("|")+")"+c+l+")*"),d="(?:"+[i+o+"?",o,s,a,n].join("|")+")",h=RegExp(r+"(?="+r+")|"+d+u,"g");e.exports=function(e){for(var t=h.lastIndex=0;h.test(e);)++t;return t}},7171:(e,t,n)=>{var o=n(5652);e.exports=function(e,t){var n=[];return o(e,function(e,o,r){t(e,o,r)&&n.push(e)}),n}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,r=e[o];if(!(0<i(r,t)))break e;e[o]=t,e[n]=r,n=o}}function o(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,r=e.length,s=r>>>1;o<s;){var a=2*(o+1)-1,l=e[a],c=a+1,u=e[c];if(0>i(l,n))c<r&&0>i(u,l)?(e[o]=u,e[c]=n,o=c):(e[o]=l,e[a]=n,o=a);else{if(!(c<r&&0>i(u,n)))break e;e[o]=u,e[c]=n,o=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=o(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=o(u)}}function w(e){if(g=!1,x(e),!m)if(null!==o(c))m=!0,j(k);else{var t=o(u);null!==t&&P(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,y(D),D=-1),p=!0;var i=f;try{for(x(n),h=o(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===o(c)&&r(c),x(n)}else r(c);h=o(c)}if(null!==h)var l=!0;else{var d=o(u);null!==d&&P(w,d.startTime-n),l=!1}return l}finally{h=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,S=!1,E=null,D=-1,M=5,N=-1;function A(){return!(t.unstable_now()-N<M)}function O(){if(null!==E){var e=t.unstable_now();N=e;var n=!0;try{n=E(!0,e)}finally{n?C():(S=!1,E=null)}}else S=!1}if("function"===typeof b)C=function(){b(O)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,_=T.port2;T.port1.onmessage=O,C=function(){_.postMessage(null)}}else C=function(){v(O,0)};function j(e){E=e,S||(S=!0,C())}function P(e,n){D=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,j(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===o(c)&&e===o(u)&&(g?(y(D),D=-1):g=!0,P(w,i-s))):(e.sortIndex=a,n(c,e),m||p||(m=!0,j(k))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7251:(e,t,n)=>{var o=n(8724),r=n(7160),i=n(5204);e.exports=function(){this.size=0,this.__data__={hash:new o,map:new(i||r),string:new o}}},7303:(e,t,n)=>{var o=n(801),r=1/0;e.exports=function(e){return e?(e=o(e))===r||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},7424:(e,t,n)=>{var o=n(755),r=n(2536),i=n(5647),s=n(929),a=i(function(e,t){if(null==e)return[];var n=t.length;return n>1&&s(e,t[0],t[1])?t=[]:n>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),r(e,o(t,1),[])});e.exports=a},7449:(e,t,n)=>{var o=n(2969),r=n(9261),i=n(5324);e.exports=function(e,t,n){for(var s=-1,a=t.length,l={};++s<a;){var c=t[s],u=o(e,c);n(u,c)&&r(l,i(c,e),u)}return l}},7498:e=>{e.exports=function(e,t){return e>t}},7529:e=>{e.exports=function(e,t){for(var n=-1,o=null==e?0:e.length,r=0,i=[];++n<o;){var s=e[n];t(s,n,e)&&(i[r++]=s)}return i}},7563:e=>{e.exports=function(){this.__data__=[],this.size=0}},7574:e=>{e.exports=function(e){return function(t){return e(t)}}},7615:(e,t,n)=>{var o=n(5575);e.exports=function(){this.__data__=o?o(null):{},this.size=0}},7685:(e,t,n)=>{var o=n(7937)(n(6552),"DataView");e.exports=o},7717:(e,t,n)=>{var o=n(4258),r=n(5111),i=n(474);e.exports=function(e,t){return null==e?e:o(e,r(t),i)}},7760:e=>{e.exports=function(e){return this.__data__.get(e)}},7828:e=>{e.exports=function(){return[]}},7857:(e,t,n)=>{var o=n(3440),r=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!r&&r in e}},7887:(e,t,n)=>{var o=n(5791),r=n(7574),i=n(6832),s=i&&i.isMap,a=s?r(s):o;e.exports=a},7894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7937:(e,t,n)=>{var o=n(6954),r=n(4657);e.exports=function(e,t){var n=r(e,t);return o(n)?n:void 0}},7938:(e,t,n)=>{var o;try{o=n(9207)}catch(r){}o||(o=window.graphlib),e.exports=o},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8114:e=>{e.exports=function(e,t){return e.has(t)}},8122:(e,t,n)=>{var o=n(6686),r=n(6140),i=n(3516),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!o(e))return i(e);var t=r(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},8124:(e,t,n)=>{var o=n(6614),r=n(9621);e.exports=function(e,t){return o(e,r(e),t)}},8129:(e,t,n)=>{var o=n(8420),r=n(9377);e.exports=function(e,t){return r(e||[],t||[],o)}},8182:(e,t,n)=>{var o=n(2070),r=n(5713),i=n(2074),s=o&&1/i(new o([,-0]))[1]==1/0?function(e){return new o(e)}:r;e.exports=s},8208:(e,t,n)=>{var o;try{o={cloneDeep:n(6434),constant:n(2541),defaults:n(1163),each:n(2580),filter:n(723),find:n(8990),flatten:n(819),forEach:n(5491),forIn:n(7717),has:n(2117),isUndefined:n(141),last:n(4065),map:n(3411),mapValues:n(1733),max:n(539),merge:n(4677),min:n(6745),minBy:n(9364),now:n(4757),pick:n(2616),range:n(6604),reduce:n(2759),sortBy:n(7424),uniqueId:n(111),values:n(6727),zipObject:n(8129)}}catch(r){}o||(o=window._),e.exports=o},8259:(e,t,n)=>{var o=n(5797);e.exports=function(e){var t=o(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},8268:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,o=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(o.index=e.index,o.input=e.input),o}},8311:e=>{e.exports="2.1.8"},8325:(e,t,n)=>{var o=n(2541),r=n(5654),i=n(3279),s=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:o(t),writable:!0})}:i;e.exports=s},8353:(e,t,n)=>{var o=n(5750);function r(e){var t={},n={},r=[];if(o.each(e.sinks(),function s(a){if(o.has(n,a))throw new i;o.has(t,a)||(n[a]=!0,t[a]=!0,o.each(e.predecessors(a),s),delete n[a],r.push(a))}),o.size(t)!==e.nodeCount())throw new i;return r}function i(){}e.exports=r,r.CycleException=i,i.prototype=new Error},8381:(e,t,n)=>{var o=n(8208);e.exports=function(e,t,n){var r,i={};o.forEach(n,function(n){for(var o,s,a=e.parent(n);a;){if((o=e.parent(a))?(s=i[o],i[o]=a):(s=r,r=a),s&&s!==a)return void t.setEdge(s,a);a=o}})}},8396:(e,t,n)=>{"use strict";var o=n(8208);e.exports=function(e,t){var n={};return o.forEach(e,function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};o.isUndefined(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)}),o.forEach(t.edges(),function(e){var t=n[e.v],r=n[e.w];o.isUndefined(t)||o.isUndefined(r)||(r.indegree++,t.out.push(n[e.w]))}),function(e){var t=[];function n(e){return function(t){t.merged||(o.isUndefined(t.barycenter)||o.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,o=0;e.weight&&(n+=e.barycenter*e.weight,o+=e.weight);t.weight&&(n+=t.barycenter*t.weight,o+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/o,e.weight=o,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return function(n){n.in.push(t),0===--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),o.forEach(i.in.reverse(),n(i)),o.forEach(i.out,r(i))}return o.map(o.filter(t,function(e){return!e.merged}),function(e){return o.pick(e,["vs","i","barycenter","weight"])})}(o.filter(n,function(e){return!e.indegree}))}},8420:(e,t,n)=>{var o=n(1775),r=n(3211),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];i.call(e,t)&&r(s,n)&&(void 0!==n||t in e)||o(e,t,n)}},8443:(e,t,n)=>{"use strict";e.exports=n(9717)},8468:(e,t,n)=>{var o=n(5816),r=n(644),i=n(4020);e.exports=function(e,t,n){return t===t?i(e,t,n):o(e,r,n)}},8541:(e,t,n)=>{var o=n(9812),r=n(149),i=n(4052),s=n(9841),a=o?o.prototype:void 0,l=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return r(t,e)+"";if(s(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},8582:(e,t,n)=>{e.exports={components:n(5992),dijkstra:n(5822),dijkstraAll:n(8976),findCycles:n(247),floydWarshall:n(6945),isAcyclic:n(9825),postorder:n(1896),preorder:n(127),prim:n(6368),tarjan:n(8808),topsort:n(8353)}},8592:(e,t,n)=>{var o=n(4262),r=n(6326),i=n(474);e.exports=function(e){return o(e,i,r)}},8630:(e,t,n)=>{var o=n(1516),r=n(6806),i=n(8962),s=n(1295),a=n(8710);e.exports=function(e,t,n){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return o(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return r(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return i(e);case"[object Symbol]":return s(e)}}},8673:(e,t,n)=>{var o=n(3204),r=n(3713),i=n(6571);e.exports=function(e){return i(e)?o(e):r(e)}},8710:(e,t,n)=>{var o=n(1516);e.exports=function(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},8724:(e,t,n)=>{var o=n(7615),r=n(5051),i=n(2154),s=n(8734),a=n(2662);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,e.exports=l},8734:(e,t,n)=>{var o=n(5575),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return o?void 0!==t[e]:r.call(t,e)}},8808:(e,t,n)=>{var o=n(5750);e.exports=function(e){var t=0,n=[],r={},i=[];function s(a){var l=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach(function(e){o.has(r,e)?r[e].onStack&&(l.lowlink=Math.min(l.lowlink,r[e].index)):(s(e),l.lowlink=Math.min(l.lowlink,r[e].lowlink))}),l.lowlink===l.index){var c,u=[];do{c=n.pop(),r[c].onStack=!1,u.push(c)}while(a!==c);i.push(u)}}return e.nodes().forEach(function(e){o.has(r,e)||s(e)}),i}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8883:(e,t,n)=>{var o=n(5652),r=n(6571);e.exports=function(e,t){var n=-1,i=r(e)?Array(e.length):[];return o(e,function(e,o,r){i[++n]=t(e,o,r)}),i}},8895:e=>{e.exports=function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}},8902:(e,t,n)=>{var o=n(4816),r=n(6179),i=n(6704);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=r,s.prototype.has=i,e.exports=s},8962:e=>{var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},8976:(e,t,n)=>{var o=n(5822),r=n(5750);e.exports=function(e,t,n){return r.transform(e.nodes(),function(r,i){r[i]=o(e,i,t,n)},{})}},8990:(e,t,n)=>{var o=n(9995)(n(2520));e.exports=o},9057:(e,t,n)=>{var o=n(5324),r=n(2777),i=n(4052),s=n(9194),a=n(6173),l=n(914);e.exports=function(e,t,n){for(var c=-1,u=(t=o(t,e)).length,d=!1;++c<u;){var h=l(t[c]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++c!=u?d:!!(u=null==e?0:e.length)&&a(u)&&s(h,u)&&(i(e)||r(e))}},9075:(e,t,n)=>{var o=n(6614),r=n(6326);e.exports=function(e,t){return o(e,r(e),t)}},9096:(e,t,n)=>{var o=n(9256),r=n(5029),i=n(3279),s=n(4052),a=n(3932);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?r(e[0],e[1]):o(e):a(e)}},9140:(e,t,n)=>{var o=n(7303);e.exports=function(e){var t=o(e),n=t%1;return t===t?n?t-n:t:0}},9194:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var o=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==o||"symbol"!=o&&t.test(e))&&e>-1&&e%1==0&&e<n}},9207:(e,t,n)=>{var o=n(9383);e.exports={Graph:o.Graph,json:n(1097),alg:n(8582),version:o.version}},9256:(e,t,n)=>{var o=n(6532),r=n(3781),i=n(1310);e.exports=function(e){var t=r(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}},9261:(e,t,n)=>{var o=n(8420),r=n(5324),i=n(9194),s=n(6686),a=n(914);e.exports=function(e,t,n,l){if(!s(e))return e;for(var c=-1,u=(t=r(t,e)).length,d=u-1,h=e;null!=h&&++c<u;){var f=a(t[c]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(c!=d){var m=h[f];void 0===(p=l?l(m,f,h):void 0)&&(p=s(m)?m:i(t[c+1])?[]:{})}o(h,f,p),h=h[f]}return e}},9364:(e,t,n)=>{var o=n(9742),r=n(9096),i=n(61);e.exports=function(e,t){return e&&e.length?o(e,r(t,2),i):void 0}},9377:e=>{e.exports=function(e,t,n){for(var o=-1,r=e.length,i=t.length,s={};++o<r;){var a=o<i?t[o]:void 0;n(s,e[o],a)}return s}},9383:(e,t,n)=>{e.exports={Graph:n(191),version:n(8311)}},9394:(e,t,n)=>{var o=n(2622);e.exports=function(e){return o(this,e).has(e)}},9395:(e,t,n)=>{var o=n(4262),r=n(9621),i=n(8673);e.exports=function(e){return o(e,i,r)}},9417:(e,t,n)=>{var o=n(6686);e.exports=function(e){return e===e&&!o(e)}},9421:e=>{e.exports=function(e,t,n,o){var r=-1,i=null==e?0:e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n}},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9558:(e,t,n)=>{"use strict";var o=n(8208),r=n(7938).Graph,i=n(5641);function s(e,t){var n={};return o.reduce(t,function(t,r){var i=0,s=0,a=t.length,c=o.last(r);return o.forEach(r,function(t,u){var d=function(e,t){if(e.node(t).dummy)return o.find(e.predecessors(t),function(t){return e.node(t).dummy})}(e,t),h=d?e.node(d).order:a;(d||t===c)&&(o.forEach(r.slice(s,u+1),function(t){o.forEach(e.predecessors(t),function(o){var r=e.node(o),s=r.order;!(s<i||h<s)||r.dummy&&e.node(t).dummy||l(n,o,t)})}),s=u+1,i=h)}),r}),n}function a(e,t){var n={};function r(t,r,i,s,a){var c;o.forEach(o.range(r,i),function(r){c=t[r],e.node(c).dummy&&o.forEach(e.predecessors(c),function(t){var o=e.node(t);o.dummy&&(o.order<s||o.order>a)&&l(n,t,c)})})}return o.reduce(t,function(t,n){var i,s=-1,a=0;return o.forEach(n,function(o,l){if("border"===e.node(o).dummy){var c=e.predecessors(o);c.length&&(i=e.node(c[0]).order,r(n,a,l,s,i),a=l,s=i)}r(n,a,n.length,i,t.length)}),n}),n}function l(e,t,n){if(t>n){var o=t;t=n,n=o}var r=e[t];r||(e[t]=r={}),r[n]=!0}function c(e,t,n){if(t>n){var r=t;t=n,n=r}return o.has(e[t],n)}function u(e,t,n,r){var i={},s={},a={};return o.forEach(t,function(e){o.forEach(e,function(e,t){i[e]=e,s[e]=e,a[e]=t})}),o.forEach(t,function(e){var t=-1;o.forEach(e,function(e){var l=r(e);if(l.length){l=o.sortBy(l,function(e){return a[e]});for(var u=(l.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var f=l[d];s[e]===e&&t<a[f]&&!c(n,e,f)&&(s[f]=e,s[e]=i[e]=i[f],t=a[f])}}})}),{root:i,align:s}}function d(e,t,n,i,s){var a={},l=function(e,t,n,i){var s=new r,a=e.graph(),l=function(e,t,n){return function(r,i,s){var a,l=r.node(i),c=r.node(s),u=0;if(u+=l.width/2,o.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":a=-l.width/2;break;case"r":a=l.width/2}if(a&&(u+=n?a:-a),a=0,u+=(l.dummy?t:e)/2,u+=(c.dummy?t:e)/2,u+=c.width/2,o.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(u+=n?a:-a),a=0,u}}(a.nodesep,a.edgesep,i);return o.forEach(t,function(t){var r;o.forEach(t,function(t){var o=n[t];if(s.setNode(o),r){var i=n[r],a=s.edge(i,o);s.setEdge(i,o,Math.max(l(e,t,r),a||0))}r=t})}),s}(e,t,n,s),c=s?"borderLeft":"borderRight";function u(e,t){for(var n=l.nodes(),o=n.pop(),r={};o;)r[o]?e(o):(r[o]=!0,n.push(o),n=n.concat(t(o))),o=n.pop()}return u(function(e){a[e]=l.inEdges(e).reduce(function(e,t){return Math.max(e,a[t.v]+l.edge(t))},0)},l.predecessors.bind(l)),u(function(t){var n=l.outEdges(t).reduce(function(e,t){return Math.min(e,a[t.w]-l.edge(t))},Number.POSITIVE_INFINITY),o=e.node(t);n!==Number.POSITIVE_INFINITY&&o.borderType!==c&&(a[t]=Math.max(a[t],n))},l.successors.bind(l)),o.forEach(i,function(e){a[e]=a[n[e]]}),a}function h(e,t){return o.minBy(o.values(t),function(t){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return o.forIn(t,function(t,o){var i=function(e,t){return e.node(t).width}(e,o)/2;n=Math.max(t+i,n),r=Math.min(t-i,r)}),n-r})}function f(e,t){var n=o.values(t),r=o.min(n),i=o.max(n);o.forEach(["u","d"],function(n){o.forEach(["l","r"],function(s){var a,l=n+s,c=e[l];if(c!==t){var u=o.values(c);(a="l"===s?r-o.min(u):i-o.max(u))&&(e[l]=o.mapValues(c,function(e){return e+a}))}})})}function p(e,t){return o.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=o.sortBy(o.map(e,r));return(i[1]+i[2])/2})}e.exports={positionX:function(e){var t,n=i.buildLayerMatrix(e),r=o.merge(s(e,n),a(e,n)),l={};o.forEach(["u","d"],function(i){t="u"===i?n:o.values(n).reverse(),o.forEach(["l","r"],function(n){"r"===n&&(t=o.map(t,function(e){return o.values(e).reverse()}));var s=("u"===i?e.predecessors:e.successors).bind(e),a=u(e,t,r,s),c=d(e,t,a.root,a.align,"r"===n);"r"===n&&(c=o.mapValues(c,function(e){return-e})),l[i+n]=c})});var c=h(e,l);return f(l,c),p(l,e.graph().align)},findType1Conflicts:s,findType2Conflicts:a,addConflict:l,hasConflict:c,verticalAlignment:u,horizontalCompaction:d,alignCoordinates:f,findSmallestWidthAlignment:h,balance:p}},9621:(e,t,n)=>{var o=n(7529),r=n(7828),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),o(s(e),function(t){return i.call(e,t)}))}:r;e.exports=a},9676:e=>{var t=Math.ceil,n=Math.max;e.exports=function(e,o,r,i){for(var s=-1,a=n(t((o-e)/(r||1)),0),l=Array(a);a--;)l[i?a:++s]=e,e+=r;return l}},9717:(e,t,n)=>{"use strict";var o=n(5043),r=n(9461);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=r.useSyncExternalStore,a=o.useRef,l=o.useEffect,c=o.useMemo,u=o.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var d=a(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=c(function(){function e(e){if(!l){if(l=!0,s=e,e=o(e),void 0!==r&&h.hasValue){var t=h.value;if(r(t,e))return a=t}return a=e}if(t=a,i(s,e))return t;var n=o(e);return void 0!==r&&r(t,n)?(s=e,t):(s=e,a=n)}var s,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,o,r]);var f=s(e,d[0],d[1]);return l(function(){h.hasValue=!0,h.value=f},[f]),u(f),f}},9742:(e,t,n)=>{var o=n(9841);e.exports=function(e,t,n){for(var r=-1,i=e.length;++r<i;){var s=e[r],a=t(s);if(null!=a&&(void 0===l?a===a&&!o(a):n(a,l)))var l=a,c=s}return c}},9791:(e,t,n)=>{var o=n(8208),r=n(6297),i=n(8396),s=n(388);e.exports=function e(t,n,a,l){var c=t.children(n),u=t.node(n),d=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,f={};d&&(c=o.filter(c,function(e){return e!==d&&e!==h}));var p=r(t,c);o.forEach(p,function(n){if(t.children(n.v).length){var r=e(t,n.v,a,l);f[n.v]=r,o.has(r,"barycenter")&&(i=n,s=r,o.isUndefined(i.barycenter)?(i.barycenter=s.barycenter,i.weight=s.weight):(i.barycenter=(i.barycenter*i.weight+s.barycenter*s.weight)/(i.weight+s.weight),i.weight+=s.weight))}var i,s});var m=i(p,a);!function(e,t){o.forEach(e,function(e){e.vs=o.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}(m,f);var g=s(m,l);if(d&&(g.vs=o.flatten([d,g.vs,h],!0),t.predecessors(d).length)){var v=t.node(t.predecessors(d)[0]),y=t.node(t.predecessors(h)[0]);o.has(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+v.order+y.order)/(g.weight+2),g.weight+=2}return g}},9812:(e,t,n)=>{var o=n(6552).Symbol;e.exports=o},9825:(e,t,n)=>{var o=n(8353);e.exports=function(e){try{o(e)}catch(t){if(t instanceof o.CycleException)return!1;throw t}return!0}},9841:(e,t,n)=>{var o=n(6913),r=n(2761);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==o(e)}},9935:(e,t,n)=>{var o=n(1340),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=o(t,e);return!(n<0)&&(n==t.length-1?t.pop():r.call(t,n,1),--this.size,!0)}},9987:(e,t,n)=>{var o=n(9812),r=n(2929),i=n(3211),s=n(3668),a=n(4160),l=n(2074),c=o?o.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,n,o,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new r(e),new r(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&o;if(f||(f=l),e.size!=t.size&&!p)return!1;var m=h.get(e);if(m)return m==t;o|=2,h.set(e,t);var g=s(f(e),f(t),o,c,d,h);return h.delete(e),g;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},9995:(e,t,n)=>{var o=n(9096),r=n(6571),i=n(8673);e.exports=function(e){return function(t,n,s){var a=Object(t);if(!r(t)){var l=o(n,3);t=i(t),n=function(e){return l(a[e],e,a)}}var c=e(t,n,s);return c>-1?a[l?t[c]:c]:void 0}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o](i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{"use strict";var e=n(5043),t=n(4391);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function i(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=n(579);function u(e){if("string"===typeof e||"number"===typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,o=0;o<e.length;o++)""!==(n=u(e[o]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var d={value:()=>{}};function h(){for(var e,t=0,n=arguments.length,o={};t<n;++t){if(!(e=arguments[t]+"")||e in o||/[\s.]/.test(e))throw new Error("illegal type: "+e);o[e]=[]}return new f(o)}function f(e){this._=e}function p(e,t){for(var n,o=0,r=e.length;o<r;++o)if((n=e[o]).name===t)return n.value}function m(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=d,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=n&&e.push({name:t,value:n}),e}f.prototype=h.prototype={constructor:f,on:function(e,t){var n,o,r=this._,i=(o=r,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!o.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),s=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++s<a;)if(n=(e=i[s]).type)r[n]=m(r[n],e.name,t);else if(null==t)for(n in r)r[n]=m(r[n],e.name,null);return this}for(;++s<a;)if((n=(e=i[s]).type)&&(n=p(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new f(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,o,r=new Array(n),i=0;i<n;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(o=this._[e]).length;i<n;++i)o[i].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};const g=h;function v(){}function y(e){return null==e?v:function(){return this.querySelector(e)}}function b(){return[]}function x(e){return null==e?b:function(){return this.querySelectorAll(e)}}function w(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function k(e){return function(){return this.matches(e)}}function C(e){return function(t){return t.matches(e)}}var S=Array.prototype.find;function E(){return this.firstElementChild}var D=Array.prototype.filter;function M(){return Array.from(this.children)}function N(e){return new Array(e.length)}function A(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function O(e,t,n,o,r,i){for(var s,a=0,l=t.length,c=i.length;a<c;++a)(s=t[a])?(s.__data__=i[a],o[a]=s):n[a]=new A(e,i[a]);for(;a<l;++a)(s=t[a])&&(r[a]=s)}function T(e,t,n,o,r,i,s){var a,l,c,u=new Map,d=t.length,h=i.length,f=new Array(d);for(a=0;a<d;++a)(l=t[a])&&(f[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?r[a]=l:u.set(c,l));for(a=0;a<h;++a)c=s.call(e,i[a],a,i)+"",(l=u.get(c))?(o[a]=l,l.__data__=i[a],u.delete(c)):n[a]=new A(e,i[a]);for(a=0;a<d;++a)(l=t[a])&&u.get(f[a])===l&&(r[a]=l)}function _(e){return e.__data__}function j(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function P(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}A.prototype={constructor:A,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var I="http://www.w3.org/1999/xhtml";const R={svg:"http://www.w3.org/2000/svg",xhtml:I,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function F(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),R.hasOwnProperty(t)?{space:R[t],local:e}:e}function z(e){return function(){this.removeAttribute(e)}}function L(e){return function(){this.removeAttributeNS(e.space,e.local)}}function B(e,t){return function(){this.setAttribute(e,t)}}function V(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function H(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function $(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function W(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function U(e){return function(){this.style.removeProperty(e)}}function q(e,t,n){return function(){this.style.setProperty(e,t,n)}}function K(e,t,n){return function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Y(e,t){return e.style.getPropertyValue(t)||W(e).getComputedStyle(e,null).getPropertyValue(t)}function X(e){return function(){delete this[e]}}function Z(e,t){return function(){this[e]=t}}function G(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function J(e){return e.trim().split(/^|\s+/)}function Q(e){return e.classList||new ee(e)}function ee(e){this._node=e,this._names=J(e.getAttribute("class")||"")}function te(e,t){for(var n=Q(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function ne(e,t){for(var n=Q(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function oe(e){return function(){te(this,e)}}function re(e){return function(){ne(this,e)}}function ie(e,t){return function(){(t.apply(this,arguments)?te:ne)(this,e)}}function se(){this.textContent=""}function ae(e){return function(){this.textContent=e}}function le(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ce(){this.innerHTML=""}function ue(e){return function(){this.innerHTML=e}}function de(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function he(){this.nextSibling&&this.parentNode.appendChild(this)}function fe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===I&&t.documentElement.namespaceURI===I?t.createElement(e):t.createElementNS(n,e)}}function me(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ge(e){var t=F(e);return(t.local?me:pe)(t)}function ve(){return null}function ye(){var e=this.parentNode;e&&e.removeChild(this)}function be(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function we(e){return function(){var t=this.__on;if(t){for(var n,o=0,r=-1,i=t.length;o<i;++o)n=t[o],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function ke(e,t,n){return function(){var o,r=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(r)for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),void(o.value=t);this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Ce(e,t,n){var o=W(e),r=o.CustomEvent;"function"===typeof r?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Se(e,t){return function(){return Ce(this,e,t)}}function Ee(e,t){return function(){return Ce(this,e,t.apply(this,arguments))}}ee.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var De=[null];function Me(e,t){this._groups=e,this._parents=t}function Ne(){return new Me([[document.documentElement]],De)}Me.prototype=Ne.prototype={constructor:Me,select:function(e){"function"!==typeof e&&(e=y(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,s,a=t[r],l=a.length,c=o[r]=new Array(l),u=0;u<l;++u)(i=a[u])&&(s=e.call(i,i.__data__,u,a))&&("__data__"in i&&(s.__data__=i.__data__),c[u]=s);return new Me(o,this._parents)},selectAll:function(e){e="function"===typeof e?w(e):x(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s,a=t[i],l=a.length,c=0;c<l;++c)(s=a[c])&&(o.push(e.call(s,s.__data__,c,a)),r.push(s));return new Me(o,r)},selectChild:function(e){return this.select(null==e?E:function(e){return function(){return S.call(this.children,e)}}("function"===typeof e?e:C(e)))},selectChildren:function(e){return this.selectAll(null==e?M:function(e){return function(){return D.call(this.children,e)}}("function"===typeof e?e:C(e)))},filter:function(e){"function"!==typeof e&&(e=k(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,s=t[r],a=s.length,l=o[r]=[],c=0;c<a;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new Me(o,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,_);var n,o=t?T:O,r=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var s=i.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=r[u],h=i[u],f=h.length,p=j(e.call(d,d&&d.__data__,u,r)),m=p.length,g=l[u]=new Array(m),v=a[u]=new Array(m);o(d,h,g,v,c[u]=new Array(f),p,t);for(var y,b,x=0,w=0;x<m;++x)if(y=g[x]){for(x>=w&&(w=x+1);!(b=v[w])&&++w<m;);y._next=b||null}}return(a=new Me(a,r))._enter=l,a._exit=c,a},enter:function(){return new Me(this._enter||this._groups.map(N),this._parents)},exit:function(){return new Me(this._exit||this._groups.map(N),this._parents)},join:function(e,t,n){var o=this.enter(),r=this,i=this.exit();return"function"===typeof e?(o=e(o))&&(o=o.selection()):o=o.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?i.remove():n(i),o&&r?o.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var c,u=n[l],d=o[l],h=u.length,f=a[l]=new Array(h),p=0;p<h;++p)(c=u[p]||d[p])&&(f[p]=c);for(;l<r;++l)a[l]=n[l];return new Me(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o,r=e[t],i=r.length-1,s=r[i];--i>=0;)(o=r[i])&&(s&&4^o.compareDocumentPosition(s)&&s.parentNode.insertBefore(o,s),s=o);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=P);for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s,a=n[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new Me(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r,i=t[n],s=0,a=i.length;s<a;++s)(r=i[s])&&e.call(r,r.__data__,s,i);return this},attr:function(e,t){var n=F(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((null==t?n.local?L:z:"function"===typeof t?n.local?$:H:n.local?V:B)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?U:"function"===typeof t?K:q)(e,t,null==n?"":n)):Y(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?X:"function"===typeof t?G:Z)(e,t)):this.node()[e]},classed:function(e,t){var n=J(e+"");if(arguments.length<2){for(var o=Q(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each(("function"===typeof t?ie:t?oe:re)(n,t))},text:function(e){return arguments.length?this.each(null==e?se:("function"===typeof e?le:ae)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ce:("function"===typeof e?de:ue)(e)):this.node().innerHTML},raise:function(){return this.each(he)},lower:function(){return this.each(fe)},append:function(e){var t="function"===typeof e?e:ge(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"===typeof e?e:ge(e),o=null==t?ve:"function"===typeof t?t:y(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})},remove:function(){return this.each(ye)},clone:function(e){return this.select(e?xe:be)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var o,r,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),s=i.length;if(!(arguments.length<2)){for(a=t?ke:we,o=0;o<s;++o)this.each(a(i[o],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(o=0,l=a[c];o<s;++o)if((r=i[o]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?Ee:Se)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o,r=e[t],i=0,s=r.length;i<s;++i)(o=r[i])&&(yield o)}};const Ae=Ne;function Oe(e){return"string"===typeof e?new Me([[document.querySelector(e)]],[document.documentElement]):new Me([[e]],De)}function Te(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,[(o=o.matrixTransform(t.getScreenCTM().inverse())).x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const _e={passive:!1},je={capture:!0,passive:!1};function Pe(e){e.stopImmediatePropagation()}function Ie(e){e.preventDefault(),e.stopImmediatePropagation()}function Re(e){var t=e.document.documentElement,n=Oe(e).on("dragstart.drag",Ie,je);"onselectstart"in t?n.on("selectstart.drag",Ie,je):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Fe(e,t){var n=e.document.documentElement,o=Oe(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ie,je),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ze=e=>()=>e;function Le(e,t){let{sourceEvent:n,subject:o,target:r,identifier:i,active:s,x:a,y:l,dx:c,dy:u,dispatch:d}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:o,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}function Be(e){return!e.ctrlKey&&!e.button}function Ve(){return this.parentNode}function He(e,t){return null==t?{x:e.x,y:e.y}:t}function $e(){return navigator.maxTouchPoints||"ontouchstart"in this}function We(){var e,t,n,o,r=Be,i=Ve,s=He,a=$e,l={},c=g("start","drag","end"),u=0,d=0;function h(e){e.on("mousedown.drag",f).filter(a).on("touchstart.drag",v).on("touchmove.drag",y,_e).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!o&&r.call(this,s,a)){var l=x(this,i.call(this,s,a),s,a,"mouse");l&&(Oe(s.view).on("mousemove.drag",p,je).on("mouseup.drag",m,je),Re(s.view),Pe(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function p(o){if(Ie(o),!n){var r=o.clientX-e,i=o.clientY-t;n=r*r+i*i>d}l.mouse("drag",o)}function m(e){Oe(e.view).on("mousemove.drag mouseup.drag",null),Fe(e.view,n),Ie(e),l.mouse("end",e)}function v(e,t){if(r.call(this,e,t)){var n,o,s=e.changedTouches,a=i.call(this,e,t),l=s.length;for(n=0;n<l;++n)(o=x(this,a,e,t,s[n].identifier,s[n]))&&(Pe(e),o("start",e,s[n]))}}function y(e){var t,n,o=e.changedTouches,r=o.length;for(t=0;t<r;++t)(n=l[o[t].identifier])&&(Ie(e),n("drag",e,o[t]))}function b(e){var t,n,r=e.changedTouches,i=r.length;for(o&&clearTimeout(o),o=setTimeout(function(){o=null},500),t=0;t<i;++t)(n=l[r[t].identifier])&&(Pe(e),n("end",e,r[t]))}function x(e,t,n,o,r,i){var a,d,f,p=c.copy(),m=Te(i||n,t);if(null!=(f=s.call(e,new Le("beforestart",{sourceEvent:n,target:h,identifier:r,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),o)))return a=f.x-m[0]||0,d=f.y-m[1]||0,function n(i,s,c){var g,v=m;switch(i){case"start":l[r]=n,g=u++;break;case"end":delete l[r],--u;case"drag":m=Te(c||s,t),g=u}p.call(i,e,new Le(i,{sourceEvent:s,subject:f,target:h,identifier:r,active:g,x:m[0]+a,y:m[1]+d,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:p}),o)}}return h.filter=function(e){return arguments.length?(r="function"===typeof e?e:ze(!!e),h):r},h.container=function(e){return arguments.length?(i="function"===typeof e?e:ze(e),h):i},h.subject=function(e){return arguments.length?(s="function"===typeof e?e:ze(e),h):s},h.touchable=function(e){return arguments.length?(a="function"===typeof e?e:ze(!!e),h):a},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,h):Math.sqrt(d)},h}Le.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ue(e){return((e=Math.exp(e))+1/e)/2}const qe=function e(t,n,o){function r(e,r){var i,s,a=e[0],l=e[1],c=e[2],u=r[0],d=r[1],h=r[2],f=u-a,p=d-l,m=f*f+p*p;if(m<1e-12)s=Math.log(h/c)/t,i=function(e){return[a+e*f,l+e*p,c*Math.exp(t*e*s)]};else{var g=Math.sqrt(m),v=(h*h-c*c+o*m)/(2*c*n*g),y=(h*h-c*c-o*m)/(2*h*n*g),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);s=(x-b)/t,i=function(e){var o,r=e*s,i=Ue(b),u=c/(n*g)*(i*(o=t*r+b,((o=Math.exp(2*o))-1)/(o+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[a+u*f,l+u*p,c*i/Ue(t*r+b)]}}return i.duration=1e3*s*t/Math.SQRT2,i}return r.rho=function(t){var n=Math.max(.001,+t),o=n*n;return e(n,o,o*o)},r}(Math.SQRT2,2,4);var Ke,Ye,Xe=0,Ze=0,Ge=0,Je=0,Qe=0,et=0,tt="object"===typeof performance&&performance.now?performance:Date,nt="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ot(){return Qe||(nt(rt),Qe=tt.now()+et)}function rt(){Qe=0}function it(){this._call=this._time=this._next=null}function st(e,t,n){var o=new it;return o.restart(e,t,n),o}function at(){Qe=(Je=tt.now())+et,Xe=Ze=0;try{!function(){ot(),++Xe;for(var e,t=Ke;t;)(e=Qe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Xe}()}finally{Xe=0,function(){var e,t,n=Ke,o=1/0;for(;n;)n._call?(o>n._time&&(o=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Ke=t);Ye=e,ct(o)}(),Qe=0}}function lt(){var e=tt.now(),t=e-Je;t>1e3&&(et-=t,Je=e)}function ct(e){Xe||(Ze&&(Ze=clearTimeout(Ze)),e-Qe>24?(e<1/0&&(Ze=setTimeout(at,e-tt.now()-et)),Ge&&(Ge=clearInterval(Ge))):(Ge||(Je=tt.now(),Ge=setInterval(lt,1e3)),Xe=1,nt(at)))}function ut(e,t,n){var o=new it;return t=null==t?0:+t,o.restart(n=>{o.stop(),e(n+t)},t,n),o}it.prototype=st.prototype={constructor:it,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?ot():+n)+(null==t?0:+t),this._next||Ye===this||(Ye?Ye._next=this:Ke=this,Ye=this),this._call=e,this._time=n,ct()},stop:function(){this._call&&(this._call=null,this._time=1/0,ct())}};var dt=g("start","end","cancel","interrupt"),ht=[];function ft(e,t,n,o,r,i){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var o,r=e.__transition;function i(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(i){var c,u,d,h;if(1!==n.state)return l();for(c in r)if((h=r[c]).name===n.name){if(3===h.state)return ut(s);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(ut(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(i))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,o=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(o[++u]=h);o.length=u+1}}function a(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,s=o.length;++i<s;)o[i].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var o in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=st(i,0,n.time)}(e,n,{name:t,index:o,group:r,on:dt,tween:ht,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function pt(e,t){var n=gt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function mt(e,t){var n=gt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function gt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vt(e,t){var n,o,r,i=e.__transition,s=!0;if(i){for(r in t=null==t?null:t+"",i)(n=i[r]).name===t?(o=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(o?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[r]):s=!1;s&&delete e.__transition}}function yt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var bt,xt=180/Math.PI,wt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function kt(e,t,n,o,r,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*xt,skewX:Math.atan(l)*xt,scaleX:s,scaleY:a}}function Ct(e,t,n,o){function r(e){return e.length?e.pop()+" ":""}return function(i,s){var a=[],l=[];return i=e(i),s=e(s),function(e,o,r,i,s,a){if(e!==r||o!==i){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:yt(e,r)},{i:l-2,x:yt(o,i)})}else(r||i)&&s.push("translate("+r+t+i+n)}(i.translateX,i.translateY,s.translateX,s.translateY,a,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(r(n)+"rotate(",null,o)-2,x:yt(e,t)})):t&&n.push(r(n)+"rotate("+t+o)}(i.rotate,s.rotate,a,l),function(e,t,n,i){e!==t?i.push({i:n.push(r(n)+"skewX(",null,o)-2,x:yt(e,t)}):t&&n.push(r(n)+"skewX("+t+o)}(i.skewX,s.skewX,a,l),function(e,t,n,o,i,s){if(e!==n||t!==o){var a=i.push(r(i)+"scale(",null,",",null,")");s.push({i:a-4,x:yt(e,n)},{i:a-2,x:yt(t,o)})}else 1===n&&1===o||i.push(r(i)+"scale("+n+","+o+")")}(i.scaleX,i.scaleY,s.scaleX,s.scaleY,a,l),i=s=null,function(e){for(var t,n=-1,o=l.length;++n<o;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var St=Ct(function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wt:kt(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Et=Ct(function(e){return null==e?wt:(bt||(bt=document.createElementNS("http://www.w3.org/2000/svg","g")),bt.setAttribute("transform",e),(e=bt.transform.baseVal.consolidate())?kt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):wt)},", ",")",")");function Dt(e,t){var n,o;return function(){var r=mt(this,e),i=r.tween;if(i!==n)for(var s=0,a=(o=n=i).length;s<a;++s)if(o[s].name===t){(o=o.slice()).splice(s,1);break}r.tween=o}}function Mt(e,t,n){var o,r;if("function"!==typeof n)throw new Error;return function(){var i=mt(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}i.tween=r}}function Nt(e,t,n){var o=e._id;return e.each(function(){var e=mt(this,o);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return gt(e,o).value[t]}}function At(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ot(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Tt(){}var _t=.7,jt=1/_t,Pt="\\s*([+-]?\\d+)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ft=/^#([0-9a-f]{3,8})$/,zt=new RegExp("^rgb\\(".concat(Pt,",").concat(Pt,",").concat(Pt,"\\)$")),Lt=new RegExp("^rgb\\(".concat(Rt,",").concat(Rt,",").concat(Rt,"\\)$")),Bt=new RegExp("^rgba\\(".concat(Pt,",").concat(Pt,",").concat(Pt,",").concat(It,"\\)$")),Vt=new RegExp("^rgba\\(".concat(Rt,",").concat(Rt,",").concat(Rt,",").concat(It,"\\)$")),Ht=new RegExp("^hsl\\(".concat(It,",").concat(Rt,",").concat(Rt,"\\)$")),$t=new RegExp("^hsla\\(".concat(It,",").concat(Rt,",").concat(Rt,",").concat(It,"\\)$")),Wt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ut(){return this.rgb().formatHex()}function qt(){return this.rgb().formatRgb()}function Kt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ft.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Yt(t):3===n?new Gt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Xt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Xt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=zt.exec(e))?new Gt(t[1],t[2],t[3],1):(t=Lt.exec(e))?new Gt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Bt.exec(e))?Xt(t[1],t[2],t[3],t[4]):(t=Vt.exec(e))?Xt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ht.exec(e))?on(t[1],t[2]/100,t[3]/100,1):(t=$t.exec(e))?on(t[1],t[2]/100,t[3]/100,t[4]):Wt.hasOwnProperty(e)?Yt(Wt[e]):"transparent"===e?new Gt(NaN,NaN,NaN,0):null}function Yt(e){return new Gt(e>>16&255,e>>8&255,255&e,1)}function Xt(e,t,n,o){return o<=0&&(e=t=n=NaN),new Gt(e,t,n,o)}function Zt(e,t,n,o){return 1===arguments.length?((r=e)instanceof Tt||(r=Kt(r)),r?new Gt((r=r.rgb()).r,r.g,r.b,r.opacity):new Gt):new Gt(e,t,n,null==o?1:o);var r}function Gt(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}function Jt(){return"#".concat(nn(this.r)).concat(nn(this.g)).concat(nn(this.b))}function Qt(){const e=en(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(tn(this.r),", ").concat(tn(this.g),", ").concat(tn(this.b)).concat(1===e?")":", ".concat(e,")"))}function en(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function nn(e){return((e=tn(e))<16?"0":"")+e.toString(16)}function on(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new sn(e,t,n,o)}function rn(e){if(e instanceof sn)return new sn(e.h,e.s,e.l,e.opacity);if(e instanceof Tt||(e=Kt(e)),!e)return new sn;if(e instanceof sn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,l=(i+r)/2;return a?(s=t===i?(n-o)/a+6*(n<o):n===i?(o-t)/a+2:(t-n)/a+4,a/=l<.5?i+r:2-i-r,s*=60):a=l>0&&l<1?0:s,new sn(s,a,l,e.opacity)}function sn(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}function an(e){return(e=(e||0)%360)<0?e+360:e}function ln(e){return Math.max(0,Math.min(1,e||0))}function cn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function un(e,t,n,o,r){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*n+(1+3*e+3*i-3*s)*o+s*r)/6}At(Tt,Kt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ut,formatHex:Ut,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return rn(this).formatHsl()},formatRgb:qt,toString:qt}),At(Gt,Zt,Ot(Tt,{brighter(e){return e=null==e?jt:Math.pow(jt,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?_t:Math.pow(_t,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Gt(tn(this.r),tn(this.g),tn(this.b),en(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jt,formatHex:Jt,formatHex8:function(){return"#".concat(nn(this.r)).concat(nn(this.g)).concat(nn(this.b)).concat(nn(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Qt,toString:Qt})),At(sn,function(e,t,n,o){return 1===arguments.length?rn(e):new sn(e,t,n,null==o?1:o)},Ot(Tt,{brighter(e){return e=null==e?jt:Math.pow(jt,e),new sn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?_t:Math.pow(_t,e),new sn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new Gt(cn(e>=240?e-240:e+120,r,o),cn(e,r,o),cn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new sn(an(this.h),ln(this.s),ln(this.l),en(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=en(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(an(this.h),", ").concat(100*ln(this.s),"%, ").concat(100*ln(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const dn=e=>()=>e;function hn(e,t){return function(n){return e+n*t}}function fn(e){return 1===(e=+e)?pn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}(t,n,e):dn(isNaN(t)?n:t)}}function pn(e,t){var n=t-e;return n?hn(e,n):dn(isNaN(e)?t:e)}const mn=function e(t){var n=fn(t);function o(e,t){var o=n((e=Zt(e)).r,(t=Zt(t)).r),r=n(e.g,t.g),i=n(e.b,t.b),s=pn(e.opacity,t.opacity);return function(t){return e.r=o(t),e.g=r(t),e.b=i(t),e.opacity=s(t),e+""}}return o.gamma=e,o}(1);function gn(e){return function(t){var n,o,r=t.length,i=new Array(r),s=new Array(r),a=new Array(r);for(n=0;n<r;++n)o=Zt(t[n]),i[n]=o.r||0,s[n]=o.g||0,a[n]=o.b||0;return i=e(i),s=e(s),a=e(a),o.opacity=1,function(e){return o.r=i(e),o.g=s(e),o.b=a(e),o+""}}}gn(function(e){var t=e.length-1;return function(n){var o=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[o],i=e[o+1],s=o>0?e[o-1]:2*r-i,a=o<t-1?e[o+2]:2*i-r;return un((n-o/t)*t,s,r,i,a)}}),gn(function(e){var t=e.length;return function(n){var o=Math.floor(((n%=1)<0?++n:n)*t),r=e[(o+t-1)%t],i=e[o%t],s=e[(o+1)%t],a=e[(o+2)%t];return un((n-o/t)*t,r,i,s,a)}});var vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yn=new RegExp(vn.source,"g");function bn(e,t){var n,o,r,i=vn.lastIndex=yn.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=vn.exec(e))&&(o=yn.exec(t));)(r=o.index)>i&&(r=t.slice(i,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:yt(n,o)})),i=yn.lastIndex;return i<t.length&&(r=t.slice(i),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,o=0;o<t;++o)a[(n=l[o]).i]=n.x(e);return a.join("")})}function xn(e,t){var n;return("number"===typeof t?yt:t instanceof Kt?mn:(n=Kt(t))?(t=n,mn):bn)(e,t)}function wn(e){return function(){this.removeAttribute(e)}}function kn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Cn(e,t,n){var o,r,i=n+"";return function(){var s=this.getAttribute(e);return s===i?null:s===o?r:r=t(o=s,n)}}function Sn(e,t,n){var o,r,i=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===o?r:r=t(o=s,n)}}function En(e,t,n){var o,r,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===o&&a===r?i:(r=a,i=t(o=s,l));this.removeAttribute(e)}}function Dn(e,t,n){var o,r,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===o&&a===r?i:(r=a,i=t(o=s,l));this.removeAttributeNS(e.space,e.local)}}function Mn(e,t){var n,o;function r(){var r=t.apply(this,arguments);return r!==o&&(n=(o=r)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Nn(e,t){var n,o;function r(){var r=t.apply(this,arguments);return r!==o&&(n=(o=r)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,r)),n}return r._value=t,r}function An(e,t){return function(){pt(this,e).delay=+t.apply(this,arguments)}}function On(e,t){return t=+t,function(){pt(this,e).delay=t}}function Tn(e,t){return function(){mt(this,e).duration=+t.apply(this,arguments)}}function _n(e,t){return t=+t,function(){mt(this,e).duration=t}}var jn=Ae.prototype.constructor;function Pn(e){return function(){this.style.removeProperty(e)}}var In=0;function Rn(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Fn(){return++In}var zn=Ae.prototype;Rn.prototype=function(e){return Ae().transition(e)}.prototype={constructor:Rn,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=y(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a,l,c=o[s],u=c.length,d=i[s]=new Array(u),h=0;h<u;++h)(a=c[h])&&(l=e.call(a,a.__data__,h,c))&&("__data__"in a&&(l.__data__=a.__data__),d[h]=l,ft(d[h],t,n,h,d,gt(a,n)));return new Rn(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=x(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l,c=o[a],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,f=e.call(l,l.__data__,d,c),p=gt(l,n),m=0,g=f.length;m<g;++m)(h=f[m])&&ft(h,t,n,m,f,p);i.push(f),s.push(l)}return new Rn(i,s,t,n)},selectChild:zn.selectChild,selectChildren:zn.selectChildren,filter:function(e){"function"!==typeof e&&(e=k(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,s=t[r],a=s.length,l=o[r]=[],c=0;c<a;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&l.push(i);return new Rn(o,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l,c=t[a],u=n[a],d=c.length,h=s[a]=new Array(d),f=0;f<d;++f)(l=c[f]||u[f])&&(h[f]=l);for(;a<o;++a)s[a]=t[a];return new Rn(s,this._parents,this._name,this._id)},selection:function(){return new jn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Fn(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s,a=o[i],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=gt(s,t);ft(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Rn(o,this._parents,e,n)},call:zn.call,nodes:zn.nodes,node:zn.node,size:zn.size,empty:zn.empty,each:zn.each,on:function(e,t){var n=this._id;return arguments.length<2?gt(this.node(),n).on.on(e):this.each(function(e,t,n){var o,r,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?pt:mt;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}(n,e,t))},attr:function(e,t){var n=F(e),o="transform"===n?Et:xn;return this.attrTween(e,"function"===typeof t?(n.local?Dn:En)(n,o,Nt(this,"attr."+e,t)):null==t?(n.local?kn:wn)(n):(n.local?Sn:Cn)(n,o,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var o=F(e);return this.tween(n,(o.local?Mn:Nn)(o,t))},style:function(e,t,n){var o="transform"===(e+="")?St:xn;return null==t?this.styleTween(e,function(e,t){var n,o,r;return function(){var i=Y(this,e),s=(this.style.removeProperty(e),Y(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}(e,o)).on("end.style."+e,Pn(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var o,r,i;return function(){var s=Y(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=Y(this,e)),s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a))}}(e,o,Nt(this,"style."+e,t))).each(function(e,t){var n,o,r,i,s="style."+t,a="end."+s;return function(){var l=mt(this,e),c=l.on,u=null==l.value[s]?i||(i=Pn(t)):void 0;c===n&&r===u||(o=(n=c).copy()).on(a,r=u),l.on=o}}(this._id,e)):this.styleTween(e,function(e,t,n){var o,r,i=n+"";return function(){var s=Y(this,e);return s===i?null:s===o?r:r=t(o=s,n)}}(e,o,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==t)return this.tween(o,null);if("function"!==typeof t)throw new Error;return this.tween(o,function(e,t,n){var o,r;function i(){var i=t.apply(this,arguments);return i!==r&&(o=(r=i)&&function(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}(e,i,n)),o}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Nt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function o(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&function(e){return function(t){this.textContent=e.call(this,t)}}(o)),t}return o._value=e,o}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o,r=gt(this.node(),n).tween,i=0,s=r.length;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((null==t?Dt:Mt)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?An:On)(t,e)):gt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Tn:_n)(t,e)):gt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){mt(this,e).ease=t}}(t,e)):gt(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;mt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){0===--r&&i()}};n.each(function(){var n=mt(this,o),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t}),0===r&&i()})},[Symbol.iterator]:zn[Symbol.iterator]};var Ln={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Bn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Ae.prototype.interrupt=function(e){return this.each(function(){vt(this,e)})},Ae.prototype.transition=function(e){var t,n;e instanceof Rn?(t=e._id,e=e._name):(t=Fn(),(n=Ln).time=ot(),e=null==e?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s,a=o[i],l=a.length,c=0;c<l;++c)(s=a[c])&&ft(s,e,t,c,a,n||Bn(s,t));return new Rn(o,this._parents,e,t)};const Vn=e=>()=>e;function Hn(e,t){let{sourceEvent:n,target:o,transform:r,dispatch:i}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function $n(e,t,n){this.k=e,this.x=t,this.y=n}$n.prototype={constructor:$n,scale:function(e){return 1===e?this:new $n(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new $n(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Wn=new $n(1,0,0);function Un(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Wn;return e.__zoom}function qn(e){e.stopImmediatePropagation()}function Kn(e){e.preventDefault(),e.stopImmediatePropagation()}function Yn(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function Xn(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Zn(){return this.__zoom||Wn}function Gn(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Jn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qn(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function eo(){var e,t,n,o=Yn,r=Xn,i=Qn,s=Gn,a=Jn,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=qe,h=g("start","zoom","end"),f=0,p=10;function m(e){e.property("__zoom",Zn).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",E).filter(a).on("touchstart.zoom",D).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new $n(t,e.x,e.y)}function y(e,t,n){var o=t[0]-n[0]*e.k,r=t[1]-n[1]*e.k;return o===e.x&&r===e.y?e:new $n(e.k,o,r)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,t,n,o){e.on("start.zoom",function(){w(this,arguments).event(o).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(o).end()}).tween("zoom",function(){var e=this,i=arguments,s=w(e,i).event(o),a=r.apply(e,i),l=null==n?b(a):"function"===typeof n?n.apply(e,i):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,h="function"===typeof t?t.apply(e,i):t,f=d(u.invert(l).concat(c/u.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new $n(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}})}function w(e,t,n){return!n&&e.__zooming||new k(e,t)}function k(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=r.apply(e,t),this.taps=0}function C(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(o.apply(this,arguments)){var a=w(this,n).event(e),u=this.__zoom,d=Math.max(l[0],Math.min(l[1],u.k*Math.pow(2,s.apply(this,arguments)))),h=Te(e);if(a.wheel)a.mouse[0][0]===h[0]&&a.mouse[0][1]===h[1]||(a.mouse[1]=u.invert(a.mouse[0]=h)),clearTimeout(a.wheel);else{if(u.k===d)return;a.mouse=[h,u.invert(h)],vt(this),a.start()}Kn(e),a.wheel=setTimeout(function(){a.wheel=null,a.end()},150),a.zoom("mouse",i(y(v(u,d),a.mouse[0],a.mouse[1]),a.extent,c))}}function S(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];if(!n&&o.apply(this,arguments)){var a=e.currentTarget,l=w(this,r,!0).event(e),u=Oe(e.view).on("mousemove.zoom",function(e){if(Kn(e),!l.moved){var t=e.clientX-h,n=e.clientY-p;l.moved=t*t+n*n>f}l.event(e).zoom("mouse",i(y(l.that.__zoom,l.mouse[0]=Te(e,a),l.mouse[1]),l.extent,c))},!0).on("mouseup.zoom",function(e){u.on("mousemove.zoom mouseup.zoom",null),Fe(e.view,l.moved),Kn(e),l.event(e).end()},!0),d=Te(e,a),h=e.clientX,p=e.clientY;Re(e.view),qn(e),l.mouse=[d,this.__zoom.invert(d)],vt(this),l.start()}}function E(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(o.apply(this,arguments)){var a=this.__zoom,l=Te(e.changedTouches?e.changedTouches[0]:e,this),d=a.invert(l),h=a.k*(e.shiftKey?.5:2),f=i(y(v(a,h),l,d),r.apply(this,n),c);Kn(e),u>0?Oe(this).transition().duration(u).call(x,f,l,e):Oe(this).call(m.transform,f,l,e)}}function D(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];if(o.apply(this,arguments)){var a,l,c,u,d=n.touches,h=d.length,f=w(this,i,n.changedTouches.length===h).event(n);for(qn(n),l=0;l<h;++l)u=[u=Te(c=d[l],this),this.__zoom.invert(u),c.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,a=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),a&&(f.taps<2&&(t=u[0],e=setTimeout(function(){e=null},500)),vt(this),f.start())}}function M(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var r,s,a,l,u=w(this,n).event(e),d=e.changedTouches,h=d.length;for(Kn(e),r=0;r<h;++r)a=Te(s=d[r],this),u.touch0&&u.touch0[2]===s.identifier?u.touch0[0]=a:u.touch1&&u.touch1[2]===s.identifier&&(u.touch1[0]=a);if(s=u.that.__zoom,u.touch1){var f=u.touch0[0],p=u.touch0[1],m=u.touch1[0],g=u.touch1[1],b=(b=m[0]-f[0])*b+(b=m[1]-f[1])*b,x=(x=g[0]-p[0])*x+(x=g[1]-p[1])*x;s=v(s,Math.sqrt(b/x)),a=[(f[0]+m[0])/2,(f[1]+m[1])/2],l=[(p[0]+g[0])/2,(p[1]+g[1])/2]}else{if(!u.touch0)return;a=u.touch0[0],l=u.touch0[1]}u.zoom("touch",i(y(s,a,l),u.extent,c))}}function N(e){for(var o=arguments.length,r=new Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];if(this.__zooming){var s,a,l=w(this,r).event(e),c=e.changedTouches,u=c.length;for(qn(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),s=0;s<u;++s)a=c[s],l.touch0&&l.touch0[2]===a.identifier?delete l.touch0:l.touch1&&l.touch1[2]===a.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(a=Te(a,this),Math.hypot(t[0]-a[0],t[1]-a[1])<p)){var d=Oe(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return m.transform=function(e,t,n,o){var r=e.selection?e.selection():e;r.property("__zoom",Zn),e!==r?x(e,t,n,o):r.interrupt().each(function(){w(this,arguments).event(o).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()})},m.scaleBy=function(e,t,n,o){m.scaleTo(e,function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)},n,o)},m.scaleTo=function(e,t,n,o){m.transform(e,function(){var e=r.apply(this,arguments),o=this.__zoom,s=null==n?b(e):"function"===typeof n?n.apply(this,arguments):n,a=o.invert(s),l="function"===typeof t?t.apply(this,arguments):t;return i(y(v(o,l),s,a),e,c)},n,o)},m.translateBy=function(e,t,n,o){m.transform(e,function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)},null,o)},m.translateTo=function(e,t,n,o,s){m.transform(e,function(){var e=r.apply(this,arguments),s=this.__zoom,a=null==o?b(e):"function"===typeof o?o.apply(this,arguments):o;return i(Wn.translate(a[0],a[1]).scale(s.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)},o,s)},k.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Oe(this.that).datum();h.call(e,this.that,new Hn(e,{sourceEvent:this.sourceEvent,target:m,type:e,transform:this.that.__zoom,dispatch:h}),t)}},m.wheelDelta=function(e){return arguments.length?(s="function"===typeof e?e:Vn(+e),m):s},m.filter=function(e){return arguments.length?(o="function"===typeof e?e:Vn(!!e),m):o},m.touchable=function(e){return arguments.length?(a="function"===typeof e?e:Vn(!!e),m):a},m.extent=function(e){return arguments.length?(r="function"===typeof e?e:Vn([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):r},m.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],m):[l[0],l[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(i=e,m):i},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(d=e,m):d},m.on=function(){var e=h.on.apply(h,arguments);return e===h?m:e},m.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,m):Math.sqrt(f)},m.tapDistance=function(e){return arguments.length?(p=+e,m):p},m}function to(e,t){var n,o=t?t.length:0,r=e?Math.min(o,e.length):0,i=new Array(r),s=new Array(o);for(n=0;n<r;++n)i[n]=io(e[n],t[n]);for(;n<o;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=i[n](e);return s}}function no(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function oo(e,t){var n,o={},r={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?o[n]=io(e[n],t[n]):r[n]=t[n];return function(e){for(n in o)r[n]=o[n](e);return r}}function ro(e,t){t||(t=[]);var n,o=e?Math.min(t.length,e.length):0,r=t.slice();return function(i){for(n=0;n<o;++n)r[n]=e[n]*(1-i)+t[n]*i;return r}}function io(e,t){var n,o,r=typeof t;return null==t||"boolean"===r?dn(t):("number"===r?yt:"string"===r?(n=Kt(t))?(t=n,mn):bn:t instanceof Kt?mn:t instanceof Date?no:(o=t,!ArrayBuffer.isView(o)||o instanceof DataView?Array.isArray(t)?to:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?oo:yt:ro))(e,t)}Un.prototype=$n.prototype;const so=["inProgress"],ao=()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",lo=e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),co=()=>"The React Flow parent container needs a width and a height to render the graph.",uo=()=>"Only child nodes can use a parent extent.",ho=()=>"Can't create edge. An edge needs a source and a target.",fo=e=>'Marker type "'.concat(e,"\" doesn't exist."),po=(e,t)=>{let{id:n,sourceHandle:o,targetHandle:r}=t;return"Couldn't create edge for ".concat(e,' handle id: "').concat("source"===e?o:r,'", edge id: ').concat(n,".")},mo=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",go=e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),vo=e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),yo=()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",bo=()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.",xo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wo=["Enter"," ","Escape"],ko={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":e=>{let{direction:t,x:n,y:o}=e;return"Moved selected node ".concat(t,". New position, x: ").concat(n,", y: ").concat(o)},"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Co,So,Eo;!function(e){e.Strict="strict",e.Loose="loose"}(Co||(Co={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(So||(So={})),function(e){e.Partial="partial",e.Full="full"}(Eo||(Eo={}));const Do={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Mo,No,Ao;!function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(Mo||(Mo={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(No||(No={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(Ao||(Ao={}));const Oo={[Ao.Left]:Ao.Right,[Ao.Right]:Ao.Left,[Ao.Top]:Ao.Bottom,[Ao.Bottom]:Ao.Top};function To(e){return null===e?null:e?"valid":"invalid"}const _o=e=>"id"in e&&"source"in e&&"target"in e,jo=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Po=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{width:o,height:r}=lr(e),i=null!==(t=e.origin)&&void 0!==t?t:n,s=o*i[0],a=r*i[1];return{x:e.position.x-s,y:e.position.y-a}},Io=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===e.size)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(e=>{if(void 0===t.filter||t.filter(e)){const t=Xo(e);n=Uo(n,t)}}),Ko(n)},Ro=function(e,t){let[n,o,r]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const l=a(a({},nr(t,[n,o,r])),{},{width:t.width/r,height:t.height/r}),c=[];for(const a of e.values()){var u,d,h,f,p,m;const{measured:e,selectable:t=!0,hidden:n=!1}=a;if(s&&!t||n)continue;const o=null!==(u=null!==(d=null!==(h=e.width)&&void 0!==h?h:a.width)&&void 0!==d?d:a.initialWidth)&&void 0!==u?u:null,r=null!==(f=null!==(p=null!==(m=e.height)&&void 0!==m?m:a.height)&&void 0!==p?p:a.initialHeight)&&void 0!==f?f:null,g=Go(l,Yo(a)),v=(null!==o&&void 0!==o?o:0)*(null!==r&&void 0!==r?r:0),y=i&&g>0;(!a.internals.handleBounds||y||g>=v||a.dragging)&&c.push(a)}return c};async function Fo(e,t){var n,o,r;let{nodes:i,width:s,height:a,panZoom:l,minZoom:c,maxZoom:u}=e;if(0===i.size)return Promise.resolve(!0);const d=function(e,t){const n=new Map,o=null!==t&&void 0!==t&&t.nodes?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{!e.measured.width||!e.measured.height||!(null===t||void 0===t?void 0:t.includeHiddenNodes)&&e.hidden||o&&!o.has(e.id)||n.set(e.id,e)}),n}(i,t),h=Io(d),f=ir(h,s,a,null!==(n=null===t||void 0===t?void 0:t.minZoom)&&void 0!==n?n:c,null!==(o=null===t||void 0===t?void 0:t.maxZoom)&&void 0!==o?o:u,null!==(r=null===t||void 0===t?void 0:t.padding)&&void 0!==r?r:.1);return await l.setViewport(f,{duration:null===t||void 0===t?void 0:t.duration,ease:null===t||void 0===t?void 0:t.ease,interpolate:null===t||void 0===t?void 0:t.interpolate}),Promise.resolve(!0)}function zo(e){var t,n,o;let{nodeId:r,nextPosition:i,nodeLookup:s,nodeOrigin:a=[0,0],nodeExtent:l,onError:c}=e;const u=s.get(r),d=u.parentId?s.get(u.parentId):void 0,{x:h,y:f}=d?d.internals.positionAbsolute:{x:0,y:0},p=null!==(t=u.origin)&&void 0!==t?t:a;let m=l;if("parent"!==u.extent||u.expandParent)d&&ar(u.extent)&&(m=[[u.extent[0][0]+h,u.extent[0][1]+f],[u.extent[1][0]+h,u.extent[1][1]+f]]);else if(d){const e=d.measured.width,t=d.measured.height;e&&t&&(m=[[h,f],[h+e,f+t]])}else null===c||void 0===c||c("005",uo());const g=ar(m)?Vo(i,m,u.measured):i;return void 0!==u.measured.width&&void 0!==u.measured.height||null===c||void 0===c||c("015",bo()),{position:{x:g.x-h+(null!==(n=u.measured.width)&&void 0!==n?n:0)*p[0],y:g.y-f+(null!==(o=u.measured.height)&&void 0!==o?o:0)*p[1]},positionAbsolute:g}}async function Lo(e){let{nodesToRemove:t=[],edgesToRemove:n=[],nodes:o,edges:r,onBeforeDelete:i}=e;const s=new Set(t.map(e=>e.id)),a=[];for(const f of o){if(!1===f.deletable)continue;const e=s.has(f.id),t=!e&&f.parentId&&a.find(e=>e.id===f.parentId);(e||t)&&a.push(f)}const l=new Set(n.map(e=>e.id)),c=r.filter(e=>!1!==e.deletable),u=((e,t)=>{const n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))})(a,c),d=u;for(const f of c){l.has(f.id)&&!d.find(e=>e.id===f.id)&&d.push(f)}if(!i)return{edges:d,nodes:a};const h=await i({nodes:a,edges:d});return"boolean"===typeof h?h?{edges:d,nodes:a}:{edges:[],nodes:[]}:h}const Bo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},Vo=function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},o=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return{x:Bo(n.x,o[0][0],o[1][0]-(null!==(e=null===r||void 0===r?void 0:r.width)&&void 0!==e?e:0)),y:Bo(n.y,o[0][1],o[1][1]-(null!==(t=null===r||void 0===r?void 0:r.height)&&void 0!==t?t:0))}};function Ho(e,t,n){const{width:o,height:r}=lr(n),{x:i,y:s}=n.internals.positionAbsolute;return Vo(e,[[i,s],[i+o,s+r]],t)}const $o=(e,t,n)=>e<t?Bo(Math.abs(e-t),1,t)/t:e>n?-Bo(Math.abs(e-n),1,t)/t:0,Wo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return[$o(e.x,o,t.width-o)*n,$o(e.y,o,t.height-o)*n]},Uo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),qo=e=>{let{x:t,y:n,width:o,height:r}=e;return{x:t,y:n,x2:t+o,y2:n+r}},Ko=e=>{let{x:t,y:n,x2:o,y2:r}=e;return{x:t,y:n,width:o-t,height:r-n}},Yo=function(e){var t,n,o,r,i,s,a,l;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{x:u,y:d}=jo(e)?e.internals.positionAbsolute:Po(e,c);return{x:u,y:d,width:null!==(t=null!==(n=null!==(o=null===(r=e.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0,height:null!==(i=null!==(s=null!==(a=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==a?a:e.height)&&void 0!==s?s:e.initialHeight)&&void 0!==i?i:0}},Xo=function(e){var t,n,o,r,i,s,a,l;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];const{x:u,y:d}=jo(e)?e.internals.positionAbsolute:Po(e,c);return{x:u,y:d,x2:u+(null!==(t=null!==(n=null!==(o=null===(r=e.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0),y2:d+(null!==(i=null!==(s=null!==(a=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==a?a:e.height)&&void 0!==s?s:e.initialHeight)&&void 0!==i?i:0)}},Zo=(e,t)=>Ko(Uo(qo(e),qo(t))),Go=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Jo=e=>Qo(e.width)&&Qo(e.height)&&Qo(e.x)&&Qo(e.y),Qo=e=>!isNaN(e)&&isFinite(e),er=(e,t)=>{0},tr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return{x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}},nr=function(e,t){let{x:n,y:o}=e,[r,i,s]=t;const a={x:(n-r)/s,y:(o-i)/s};return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?tr(a,arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1]):a},or=(e,t)=>{let{x:n,y:o}=e,[r,i,s]=t;return{x:n*s+r,y:o*s+i}};function rr(e,t){if("number"===typeof e)return Math.floor(.5*(t-t/(1+e)));if("string"===typeof e&&e.endsWith("px")){const t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"===typeof e&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error('[React Flow] The padding value "'.concat(e,'" is invalid. Please provide a number or a string with a valid unit (px or %).')),0}const ir=(e,t,n,o,r,i)=>{const s=function(e,t,n){if("string"===typeof e||"number"===typeof e){const o=rr(e,n),r=rr(e,t);return{top:o,right:r,bottom:o,left:r,x:2*r,y:2*o}}if("object"===typeof e){var o,r,i,s,a,l,c,u;const d=rr(null!==(o=null!==(r=e.top)&&void 0!==r?r:e.y)&&void 0!==o?o:0,n),h=rr(null!==(i=null!==(s=e.bottom)&&void 0!==s?s:e.y)&&void 0!==i?i:0,n),f=rr(null!==(a=null!==(l=e.left)&&void 0!==l?l:e.x)&&void 0!==a?a:0,t),p=rr(null!==(c=null!==(u=e.right)&&void 0!==u?u:e.x)&&void 0!==c?c:0,t);return{top:d,right:p,bottom:h,left:f,x:f+p,y:d+h}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(i,t,n),a=(t-s.x)/e.width,l=(n-s.y)/e.height,c=Math.min(a,l),u=Bo(c,o,r),d=t/2-(e.x+e.width/2)*u,h=n/2-(e.y+e.height/2)*u,f=function(e,t,n,o,r,i){const{x:s,y:a}=or(e,[t,n,o]),{x:l,y:c}=or({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=r-l,d=i-c;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}(e,d,h,u,t,n),p=Math.min(f.left-s.left,0),m=Math.min(f.top-s.top,0);return{x:d-p+Math.min(f.right-s.right,0),y:h-m+Math.min(f.bottom-s.bottom,0),zoom:u}},sr=()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator)||void 0===e||null===(e=e.userAgent)||void 0===e?void 0:e.indexOf("Mac"))>=0};function ar(e){return void 0!==e&&"parent"!==e}function lr(e){var t,n,o,r,i,s,a,l;return{width:null!==(t=null!==(n=null!==(o=null===(r=e.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:e.width)&&void 0!==n?n:e.initialWidth)&&void 0!==t?t:0,height:null!==(i=null!==(s=null!==(a=null===(l=e.measured)||void 0===l?void 0:l.height)&&void 0!==a?a:e.height)&&void 0!==s?s:e.initialHeight)&&void 0!==i?i:0}}function cr(e){var t,n,o,r,i,s;return void 0!==(null!==(t=null!==(n=null===(o=e.measured)||void 0===o?void 0:o.width)&&void 0!==n?n:e.width)&&void 0!==t?t:e.initialWidth)&&void 0!==(null!==(r=null!==(i=null===(s=e.measured)||void 0===s?void 0:s.height)&&void 0!==i?i:e.height)&&void 0!==r?r:e.initialHeight)}function ur(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;const i=a({},e),s=o.get(n);if(s){var l,c;const e=s.origin||r;i.x+=s.internals.positionAbsolute.x-(null!==(l=t.width)&&void 0!==l?l:0)*e[0],i.y+=s.internals.positionAbsolute.y-(null!==(c=t.height)&&void 0!==c?c:0)*e[1]}return i}function dr(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function hr(e){return a(a({},ko),e||{})}function fr(e,t){var n,o;let{snapGrid:r=[0,0],snapToGrid:i=!1,transform:s,containerBounds:l}=t;const{x:c,y:u}=br(e),d=nr({x:c-(null!==(n=null===l||void 0===l?void 0:l.left)&&void 0!==n?n:0),y:u-(null!==(o=null===l||void 0===l?void 0:l.top)&&void 0!==o?o:0)},s),{x:h,y:f}=i?tr(d,r):d;return a({xSnapped:h,ySnapped:f},d)}const pr=e=>({width:e.offsetWidth,height:e.offsetHeight}),mr=e=>{var t,n;return(null===e||void 0===e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||(null===(n=window)||void 0===n?void 0:n.document)},gr=["INPUT","SELECT","TEXTAREA"];function vr(e){var t;const n=(null===(t=e.composedPath)||void 0===t||null===(t=t.call(e))||void 0===t?void 0:t[0])||e.target;if(1!==(null===n||void 0===n?void 0:n.nodeType))return!1;return gr.includes(n.nodeName)||n.hasAttribute("contenteditable")||!!n.closest(".nokey")}const yr=e=>"clientX"in e,br=(e,t)=>{var n,o,r,i;const s=yr(e),a=s?e.clientX:null===(n=e.touches)||void 0===n?void 0:n[0].clientX,l=s?e.clientY:null===(o=e.touches)||void 0===o?void 0:o[0].clientY;return{x:a-(null!==(r=null===t||void 0===t?void 0:t.left)&&void 0!==r?r:0),y:l-(null!==(i=null===t||void 0===t?void 0:t.top)&&void 0!==i?i:0)}},xr=(e,t,n,o,r)=>{const i=t.querySelectorAll(".".concat(e));return i&&i.length?Array.from(i).map(t=>{const i=t.getBoundingClientRect();return a({id:t.getAttribute("data-handleid"),type:e,nodeId:r,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/o,y:(i.top-n.top)/o},pr(t))}):null};function wr(e){let{sourceX:t,sourceY:n,targetX:o,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:a,targetControlY:l}=e;const c=.125*t+.375*i+.375*a+.125*o,u=.125*n+.375*s+.375*l+.125*r;return[c,u,Math.abs(c-t),Math.abs(u-n)]}function kr(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Cr(e){let{pos:t,x1:n,y1:o,x2:r,y2:i,c:s}=e;switch(t){case Ao.Left:return[n-kr(n-r,s),o];case Ao.Right:return[n+kr(r-n,s),o];case Ao.Top:return[n,o-kr(o-i,s)];case Ao.Bottom:return[n,o+kr(i-o,s)]}}function Sr(e){let{sourceX:t,sourceY:n,sourcePosition:o=Ao.Bottom,targetX:r,targetY:i,targetPosition:s=Ao.Top,curvature:a=.25}=e;const[l,c]=Cr({pos:o,x1:t,y1:n,x2:r,y2:i,c:a}),[u,d]=Cr({pos:s,x1:r,y1:i,x2:t,y2:n,c:a}),[h,f,p,m]=wr({sourceX:t,sourceY:n,targetX:r,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return["M".concat(t,",").concat(n," C").concat(l,",").concat(c," ").concat(u,",").concat(d," ").concat(r,",").concat(i),h,f,p,m]}function Er(e){let{sourceX:t,sourceY:n,targetX:o,targetY:r}=e;const i=Math.abs(o-t)/2,s=o<t?o+i:o-i,a=Math.abs(r-n)/2;return[s,r<n?r+a:r-a,i,a]}function Dr(e){let{sourceNode:t,targetNode:n,width:o,height:r,transform:i}=e;const s=Uo(Xo(t),Xo(n));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const a={x:-i[0]/i[2],y:-i[1]/i[2],width:o/i[2],height:r/i[2]};return Go(a,Ko(s))>0}const Mr=e=>{let{source:t,sourceHandle:n,target:o,targetHandle:r}=e;return"xy-edge__".concat(t).concat(n||"","-").concat(o).concat(r||"")};function Nr(e){let{sourceX:t,sourceY:n,targetX:o,targetY:r}=e;const[i,s,a,l]=Er({sourceX:t,sourceY:n,targetX:o,targetY:r});return["M ".concat(t,",").concat(n,"L ").concat(o,",").concat(r),i,s,a,l]}const Ar={[Ao.Left]:{x:-1,y:0},[Ao.Right]:{x:1,y:0},[Ao.Top]:{x:0,y:-1},[Ao.Bottom]:{x:0,y:1}},Or=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Tr(e){let{source:t,sourcePosition:n=Ao.Bottom,target:o,targetPosition:r=Ao.Top,center:i,offset:s}=e;const a=Ar[n],l=Ar[r],c={x:t.x+a.x*s,y:t.y+a.y*s},u={x:o.x+l.x*s,y:o.y+l.y*s},d=(e=>{let{source:t,sourcePosition:n=Ao.Bottom,target:o}=e;return n===Ao.Left||n===Ao.Right?t.x<o.x?{x:1,y:0}:{x:-1,y:0}:t.y<o.y?{x:0,y:1}:{x:0,y:-1}})({source:c,sourcePosition:n,target:u}),h=0!==d.x?"x":"y",f=d[h];let p,m,g=[];const v={x:0,y:0},y={x:0,y:0},[b,x,w,k]=Er({sourceX:t.x,sourceY:t.y,targetX:o.x,targetY:o.y});if(a[h]*l[h]===-1){var C,S;p=null!==(C=i.x)&&void 0!==C?C:b,m=null!==(S=i.y)&&void 0!==S?S:x;const e=[{x:p,y:c.y},{x:p,y:u.y}],t=[{x:c.x,y:m},{x:u.x,y:m}];g=a[h]===f?"x"===h?e:t:"x"===h?t:e}else{const e=[{x:c.x,y:u.y}],i=[{x:u.x,y:c.y}];if(g="x"===h?a.x===f?i:e:a.y===f?e:i,n===r){const e=Math.abs(t[h]-o[h]);if(e<=s){const n=Math.min(s-1,s-e);a[h]===f?v[h]=(c[h]>t[h]?-1:1)*n:y[h]=(u[h]>o[h]?-1:1)*n}}if(n!==r){const t="x"===h?"y":"x",n=a[h]===l[t],o=c[t]>u[t],r=c[t]<u[t];(1===a[h]&&(!n&&o||n&&r)||1!==a[h]&&(!n&&r||n&&o))&&(g="x"===h?e:i)}const d={x:c.x+v.x,y:c.y+v.y},b={x:u.x+y.x,y:u.y+y.y};Math.max(Math.abs(d.x-g[0].x),Math.abs(b.x-g[0].x))>=Math.max(Math.abs(d.y-g[0].y),Math.abs(b.y-g[0].y))?(p=(d.x+b.x)/2,m=g[0].y):(p=g[0].x,m=(d.y+b.y)/2)}return[[t,{x:c.x+v.x,y:c.y+v.y},...g,{x:u.x+y.x,y:u.y+y.y},o],p,m,w,k]}function _r(e){let{sourceX:t,sourceY:n,sourcePosition:o=Ao.Bottom,targetX:r,targetY:i,targetPosition:s=Ao.Top,borderRadius:a=5,centerX:l,centerY:c,offset:u=20}=e;const[d,h,f,p,m]=Tr({source:{x:t,y:n},sourcePosition:o,target:{x:r,y:i},targetPosition:s,center:{x:l,y:c},offset:u}),g=d.reduce((e,t,n)=>{let o="";return o=n>0&&n<d.length-1?function(e,t,n,o){const r=Math.min(Or(e,t)/2,Or(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return"L".concat(i," ").concat(s);if(e.y===s){const t=e.x<n.x?-1:1,o=e.y<n.y?1:-1;return"L ".concat(i+r*t,",").concat(s,"Q ").concat(i,",").concat(s," ").concat(i,",").concat(s+r*o)}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return"L ".concat(i,",").concat(s+r*l,"Q ").concat(i,",").concat(s," ").concat(i+r*a,",").concat(s)}(d[n-1],t,d[n+1],a):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y),e+=o},"");return[g,h,f,p,m]}function jr(e){var t;return e&&!!(e.internals.handleBounds||null!==(t=e.handles)&&void 0!==t&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Pr(e){if(!e)return null;const t=[],n=[];for(const i of e){var o,r;i.width=null!==(o=i.width)&&void 0!==o?o:1,i.height=null!==(r=i.height)&&void 0!==r?r:1,"source"===i.type?t.push(i):"target"===i.type&&n.push(i)}return{source:t,target:n}}function Ir(e,t){var n,o,r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ao.Left,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=(null!==(n=null===t||void 0===t?void 0:t.x)&&void 0!==n?n:0)+e.internals.positionAbsolute.x,l=(null!==(o=null===t||void 0===t?void 0:t.y)&&void 0!==o?o:0)+e.internals.positionAbsolute.y,{width:c,height:u}=null!==t&&void 0!==t?t:lr(e);if(s)return{x:a+c/2,y:l+u/2};switch(null!==(r=null===t||void 0===t?void 0:t.position)&&void 0!==r?r:i){case Ao.Top:return{x:a+c/2,y:l};case Ao.Right:return{x:a+c,y:l+u/2};case Ao.Bottom:return{x:a+c/2,y:l+u};case Ao.Left:return{x:a,y:l+u/2}}}function Rr(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function Fr(e,t){if(!e)return"";if("string"===typeof e)return e;const n=t?"".concat(t,"__"):"";return"".concat(n).concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&"))}const zr={nodeOrigin:[0,0],nodeExtent:xo,elevateNodesOnSelect:!0,defaults:{}},Lr=a(a({},zr),{},{checkEquality:!0});function Br(e,t){const n=a({},e);for(const o in t)void 0!==t[o]&&(n[o]=t[o]);return n}function Vr(e,t,n,o){const r=Br(Lr,o);let i=e.length>0;const s=new Map(t),l=null!==r&&void 0!==r&&r.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const f of e){var c;let e=s.get(f.id);if(r.checkEquality&&f===(null===(c=e)||void 0===c?void 0:c.internals.userNode))t.set(f.id,e);else{var u,d,h;const n=Po(f,r.nodeOrigin),o=ar(f.extent)?f.extent:r.nodeExtent,i=Vo(n,o,lr(f));e=a(a(a({},r.defaults),f),{},{measured:{width:null===(u=f.measured)||void 0===u?void 0:u.width,height:null===(d=f.measured)||void 0===d?void 0:d.height},internals:{positionAbsolute:i,handleBounds:f.measured?null===(h=e)||void 0===h?void 0:h.internals.handleBounds:void 0,z:$r(f,l),userNode:f}}),t.set(f.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(i=!1),f.parentId&&Hr(e,t,n,o)}return i}function Hr(e,t,n,o){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:s}=Br(zr,o),l=e.parentId,c=t.get(l);if(!c)return void console.warn("Parent node ".concat(l," not found. Please make sure that parent nodes are in front of their child nodes in the nodes array."));!function(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n);const u=r?1e3:0,{x:d,y:h,z:f}=function(e,t,n,o,r){var i;const{x:s,y:a}=t.internals.positionAbsolute,l=lr(e),c=Po(e,n),u=ar(e.extent)?Vo(c,e.extent,l):c;let d=Vo({x:s+u.x,y:a+u.y},o,l);"parent"===e.extent&&(d=Ho(d,l,t));const h=$r(e,r),f=null!==(i=t.internals.z)&&void 0!==i?i:0;return{x:d.x,y:d.y,z:f>=h?f+1:h}}(e,c,i,s,u),{positionAbsolute:p}=e.internals,m=d!==p.x||h!==p.y;(m||f!==e.internals.z)&&t.set(e.id,a(a({},e),{},{internals:a(a({},e.internals),{},{positionAbsolute:m?{x:d,y:h}:p,z:f})}))}function $r(e,t){return(Qo(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Wr(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0];const r=[],i=new Map;for(const l of e){var s,a;const e=t.get(l.parentId);if(!e)continue;const n=null!==(s=null===(a=i.get(l.parentId))||void 0===a?void 0:a.expandedRect)&&void 0!==s?s:Yo(e),o=Zo(n,l.rect);i.set(l.parentId,{expandedRect:o,parent:e})}return i.size>0&&i.forEach((t,i)=>{var s;let{expandedRect:a,parent:l}=t;const c=l.internals.positionAbsolute,u=lr(l),d=null!==(s=l.origin)&&void 0!==s?s:o,h=a.x<c.x?Math.round(Math.abs(c.x-a.x)):0,f=a.y<c.y?Math.round(Math.abs(c.y-a.y)):0,p=Math.max(u.width,Math.round(a.width)),m=Math.max(u.height,Math.round(a.height)),g=(p-u.width)*d[0],v=(m-u.height)*d[1];var y;(h>0||f>0||g||v)&&(r.push({id:i,type:"position",position:{x:l.position.x-h+g,y:l.position.y-f+v}}),null===(y=n.get(i))||void 0===y||y.forEach(t=>{e.some(e=>e.id===t.id)||r.push({id:t.id,type:"position",position:{x:t.position.x+h,y:t.position.y+f}})}));(u.width<a.width||u.height<a.height||h||f)&&r.push({id:i,type:"dimensions",setAttributes:!0,dimensions:{width:p+(h?d[0]*h-g:0),height:m+(f?d[1]*f-v:0)}})}),r}function Ur(e,t,n,o,r,i){let s=r;const a=o.get(s)||new Map;o.set(s,a.set(n,t)),s="".concat(r,"-").concat(e);const l=o.get(s)||new Map;if(o.set(s,l.set(n,t)),i){s="".concat(r,"-").concat(e,"-").concat(i);const a=o.get(s)||new Map;o.set(s,a.set(n,t))}}function qr(e,t,n){e.clear(),t.clear();for(const o of n){const{source:n,target:r,sourceHandle:i=null,targetHandle:s=null}=o,a={edgeId:o.id,source:n,target:r,sourceHandle:i,targetHandle:s},l="".concat(n,"-").concat(i,"--").concat(r,"-").concat(s);Ur("source",a,"".concat(r,"-").concat(s,"--").concat(n,"-").concat(i),e,n,i),Ur("target",a,l,e,r,s),t.set(o.id,o)}}function Kr(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return!!n&&(!!n.selected||Kr(n,t))}function Yr(e,t,n){let o=e;do{var r,i,s;if(null!==(r=o)&&void 0!==r&&null!==(i=r.matches)&&void 0!==i&&i.call(r,t))return!0;if(o===n)return!1;o=null===(s=o)||void 0===s?void 0:s.parentElement}while(o);return!1}function Xr(e){var t,n;let{nodeId:o,dragItems:r,nodeLookup:i,dragging:s=!0}=e;const l=[];for(const[d,h]of r){var c;const e=null===(c=i.get(d))||void 0===c?void 0:c.internals.userNode;e&&l.push(a(a({},e),{},{position:h.position,dragging:s}))}if(!o)return[l[0],l];const u=null===(t=i.get(o))||void 0===t?void 0:t.internals.userNode;return[u?a(a({},u),{},{position:(null===(n=r.get(o))||void 0===n?void 0:n.position)||u.position,dragging:s}):l[0],l]}function Zr(e){let{onNodeMouseDown:t,getStoreItems:n,onDragStart:o,onDrag:r,onDragStop:i}=e,s={x:null,y:null},a=0,l=new Map,c=!1,u={x:0,y:0},d=null,h=!1,f=null,p=!1,m=!1;return{update:function(e){let{noDragClassName:g,handleSelector:v,domNode:y,isSelectable:b,nodeId:x,nodeClickDistance:w=0}=e;function k(e,t){let{x:o,y:i}=e;const{nodeLookup:a,nodeExtent:c,snapGrid:u,snapToGrid:d,nodeOrigin:h,onNodeDrag:f,onSelectionDrag:p,onError:g,updateNodePositions:v}=n();s={x:o,y:i};let y=!1,b={x:0,y:0,x2:0,y2:0};if(l.size>1&&c){const e=Io(l);b=qo(e)}for(const[n,r]of l){if(!a.has(n))continue;let e={x:o-r.distance.x,y:i-r.distance.y};d&&(e=tr(e,u));let t=[[c[0][0],c[0][1]],[c[1][0],c[1][1]]];if(l.size>1&&c&&!r.extent){const{positionAbsolute:e}=r.internals,n=e.x-b.x+c[0][0],o=e.x+r.measured.width-b.x2+c[1][0];t=[[n,e.y-b.y+c[0][1]],[o,e.y+r.measured.height-b.y2+c[1][1]]]}const{position:s,positionAbsolute:f}=zo({nodeId:n,nextPosition:e,nodeLookup:a,nodeExtent:t,nodeOrigin:h,onError:g});y=y||r.position.x!==s.x||r.position.y!==s.y,r.position=s,r.internals.positionAbsolute=f}if(m=m||y,y&&(v(l,!0),t&&(r||f||!x&&p))){const[e,n]=Xr({nodeId:x,dragItems:l,nodeLookup:a});null===r||void 0===r||r(t,l,e,n),null===f||void 0===f||f(t,e,n),x||null===p||void 0===p||p(t,n)}}async function C(){if(!d)return;const{transform:e,panBy:t,autoPanSpeed:o,autoPanOnNodeDrag:r}=n();if(!r)return c=!1,void cancelAnimationFrame(a);const[i,l]=Wo(u,d,o);var h,f;0===i&&0===l||(s.x=(null!==(h=s.x)&&void 0!==h?h:0)-i/e[2],s.y=(null!==(f=s.y)&&void 0!==f?f:0)-l/e[2],await t({x:i,y:l})&&k(s,null));a=requestAnimationFrame(C)}function S(e){const{nodeLookup:r,multiSelectionActive:i,nodesDraggable:a,transform:c,snapGrid:u,snapToGrid:f,selectNodesOnDrag:p,onNodeDragStart:m,onSelectionDragStart:g,unselectNodesAndEdges:v}=n();var y;(h=!0,p&&b||i||!x)||(null!==(y=r.get(x))&&void 0!==y&&y.selected||v());b&&p&&x&&(null===t||void 0===t||t(x));const w=fr(e.sourceEvent,{transform:c,snapGrid:u,snapToGrid:f,containerBounds:d});if(s=w,l=function(e,t,n,o){const r=new Map;for(const[a,l]of e)if((l.selected||l.id===o)&&(!l.parentId||!Kr(l,e))&&(l.draggable||t&&"undefined"===typeof l.draggable)){const t=e.get(a);var i,s;t&&r.set(a,{id:a,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:null!==(i=t.measured.width)&&void 0!==i?i:0,height:null!==(s=t.measured.height)&&void 0!==s?s:0}})}return r}(r,a,w,x),l.size>0&&(o||m||!x&&g)){const[t,n]=Xr({nodeId:x,dragItems:l,nodeLookup:r});null===o||void 0===o||o(e.sourceEvent,l,t,n),null===m||void 0===m||m(e.sourceEvent,t,n),x||null===g||void 0===g||g(e.sourceEvent,n)}}f=Oe(y);const E=We().clickDistance(w).on("start",e=>{const{domNode:t,nodeDragThreshold:o,transform:r,snapGrid:i,snapToGrid:a}=n();d=(null===t||void 0===t?void 0:t.getBoundingClientRect())||null,p=!1,m=!1,0===o&&S(e);const l=fr(e.sourceEvent,{transform:r,snapGrid:i,snapToGrid:a,containerBounds:d});s=l,u=br(e.sourceEvent,d)}).on("drag",e=>{const{autoPanOnNodeDrag:t,transform:o,snapGrid:r,snapToGrid:i,nodeDragThreshold:a,nodeLookup:f}=n(),m=fr(e.sourceEvent,{transform:o,snapGrid:r,snapToGrid:i,containerBounds:d});if(("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||x&&!f.has(x))&&(p=!0),!p){if(!c&&t&&h&&(c=!0,C()),!h){var g,v;const t=m.xSnapped-(null!==(g=s.x)&&void 0!==g?g:0),n=m.ySnapped-(null!==(v=s.y)&&void 0!==v?v:0);Math.sqrt(t*t+n*n)>a&&S(e)}(s.x!==m.xSnapped||s.y!==m.ySnapped)&&l&&h&&(u=br(e.sourceEvent,d),k(m,e.sourceEvent))}}).on("end",e=>{if(h&&!p&&(c=!1,h=!1,cancelAnimationFrame(a),l.size>0)){const{nodeLookup:t,updateNodePositions:o,onNodeDragStop:r,onSelectionDragStop:s}=n();if(m&&(o(l,!1),m=!1),i||r||!x&&s){const[n,o]=Xr({nodeId:x,dragItems:l,nodeLookup:t,dragging:!1});null===i||void 0===i||i(e.sourceEvent,l,n,o),null===r||void 0===r||r(e.sourceEvent,n,o),x||null===s||void 0===s||s(e.sourceEvent,o)}}}).filter(e=>{const t=e.target;return!e.button&&(!g||!Yr(t,".".concat(g),y))&&(!v||Yr(t,v,y))});f.call(E)},destroy:function(){var e;null===(e=f)||void 0===e||e.on(".drag",null)}}}function Gr(e,t,n,o){let r=[],i=1/0;const s=function(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(const i of t.values())Go(r,Yo(i))>0&&o.push(i);return o}(e,n,t+250);for(const f of s){var l,c,u,d;const n=[...null!==(l=null===(c=f.internals.handleBounds)||void 0===c?void 0:c.source)&&void 0!==l?l:[],...null!==(u=null===(d=f.internals.handleBounds)||void 0===d?void 0:d.target)&&void 0!==u?u:[]];for(const s of n){if(o.nodeId===s.nodeId&&o.type===s.type&&o.id===s.id)continue;const{x:n,y:l}=Ir(f,s,s.position,!0),c=Math.sqrt(Math.pow(n-e.x,2)+Math.pow(l-e.y,2));c>t||(c<i?(r=[a(a({},s),{},{x:n,y:l})],i=c):c===i&&r.push(a(a({},s),{},{x:n,y:l})))}}if(!r.length)return null;if(r.length>1){var h;const e="source"===o.type?"target":"source";return null!==(h=r.find(t=>t.type===e))&&void 0!==h?h:r[0]}return r[0]}function Jr(e,t,n,o,r){var i,s,l,c,u,d;let h=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const f=o.get(e);if(!f)return null;const p="strict"===r?null===(i=f.internals.handleBounds)||void 0===i?void 0:i[t]:[...null!==(s=null===(l=f.internals.handleBounds)||void 0===l?void 0:l.source)&&void 0!==s?s:[],...null!==(c=null===(u=f.internals.handleBounds)||void 0===u?void 0:u.target)&&void 0!==c?c:[]],m=null!==(d=n?null===p||void 0===p?void 0:p.find(e=>e.id===n):null===p||void 0===p?void 0:p[0])&&void 0!==d?d:null;return m&&h?a(a({},m),Ir(f,m,m.position,!0)):m}function Qr(e,t){return e||(null!==t&&void 0!==t&&t.classList.contains("target")?"target":null!==t&&void 0!==t&&t.classList.contains("source")?"source":null)}const ei=()=>!0;function ti(e,t){let{handle:n,connectionMode:o,fromNodeId:r,fromHandleId:i,fromType:s,doc:a,lib:l,flowId:c,isValidConnection:u=ei,nodeLookup:d}=t;const h="target"===s,f=n?a.querySelector(".".concat(l,'-flow__handle[data-id="').concat(c,"-").concat(null===n||void 0===n?void 0:n.nodeId,"-").concat(null===n||void 0===n?void 0:n.id,"-").concat(null===n||void 0===n?void 0:n.type,'"]')):null,{x:p,y:m}=br(e),g=a.elementFromPoint(p,m),v=null!==g&&void 0!==g&&g.classList.contains("".concat(l,"-flow__handle"))?g:f,y={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const e=Qr(void 0,v),t=v.getAttribute("data-nodeid"),n=v.getAttribute("data-handleid"),s=v.classList.contains("connectable"),a=v.classList.contains("connectableend");if(!t||!e)return y;const l={source:h?t:r,sourceHandle:h?n:i,target:h?r:t,targetHandle:h?i:n};y.connection=l;const c=s&&a&&(o===Co.Strict?h&&"source"===e||!h&&"target"===e:t!==r||n!==i);y.isValid=c&&u(l),y.toHandle=Jr(t,e,n,d,o,!0)}return y}const ni={onPointerDown:function(e,t){let{connectionMode:n,connectionRadius:o,handleId:r,nodeId:i,edgeUpdaterType:s,isTarget:c,domNode:u,nodeLookup:d,lib:h,autoPanOnConnect:f,flowId:p,panBy:m,cancelConnection:g,onConnectStart:v,onConnect:y,onConnectEnd:b,isValidConnection:x=ei,onReconnectEnd:w,updateConnection:k,getTransform:C,getFromHandle:S,autoPanSpeed:E,dragThreshold:D=1}=t;const M=mr(e.target);let N,A=0;const{x:O,y:T}=br(e),_=null===M||void 0===M?void 0:M.elementFromPoint(O,T),j=Qr(s,_),P=null===u||void 0===u?void 0:u.getBoundingClientRect();let I=!1;if(!P||!j)return;const R=Jr(i,j,r,d,n);if(!R)return;let F=br(e,P),z=!1,L=null,B=!1,V=null;function H(){if(!f||!P)return;const[e,t]=Wo(F,P,E);m({x:e,y:t}),A=requestAnimationFrame(H)}const $=a(a({},R),{},{nodeId:i,type:j,position:R.position}),W=d.get(i);let U={inProgress:!0,isValid:null,from:Ir(W,$,Ao.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:W,to:F,toHandle:null,toPosition:Oo[$.position],toNode:null};function q(){I=!0,k(U),null===v||void 0===v||v(e,{nodeId:i,handleId:r,handleType:j})}function K(e){if(!I){const{x:t,y:n}=br(e),o=t-O,r=n-T;if(!(o*o+r*r>D*D))return;q()}if(!S()||!$)return void Y(e);const t=C();F=br(e,P),N=Gr(nr(F,t,!1,[1,1]),o,d,$),z||(H(),z=!0);const s=ti(e,{handle:N,connectionMode:n,fromNodeId:i,fromHandleId:r,fromType:c?"target":"source",isValidConnection:x,doc:M,lib:h,flowId:p,nodeLookup:d});V=s.handleDomNode,L=s.connection,B=function(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}(!!N,s.isValid);const l=a(a({},U),{},{isValid:B,to:s.toHandle&&B?or({x:s.toHandle.x,y:s.toHandle.y},t):F,toHandle:s.toHandle,toPosition:B&&s.toHandle?s.toHandle.position:Oo[$.position],toNode:s.toHandle?d.get(s.toHandle.nodeId):null});B&&N&&U.toHandle&&l.toHandle&&U.toHandle.type===l.toHandle.type&&U.toHandle.nodeId===l.toHandle.nodeId&&U.toHandle.id===l.toHandle.id&&U.to.x===l.to.x&&U.to.y===l.to.y||(k(l),U=l)}function Y(e){if(I){(N||V)&&L&&B&&(null===y||void 0===y||y(L));const{inProgress:t}=U,n=a(a({},l(U,so)),{},{toPosition:U.toHandle?U.toPosition:null});null===b||void 0===b||b(e,n),s&&(null===w||void 0===w||w(e,n))}g(),cancelAnimationFrame(A),z=!1,B=!1,L=null,V=null,M.removeEventListener("mousemove",K),M.removeEventListener("mouseup",Y),M.removeEventListener("touchmove",K),M.removeEventListener("touchend",Y)}0===D&&q(),M.addEventListener("mousemove",K),M.addEventListener("mouseup",Y),M.addEventListener("touchmove",K),M.addEventListener("touchend",Y)},isValid:ti};const oi=e=>({x:e.x,y:e.y,zoom:e.k}),ri=e=>{let{x:t,y:n,zoom:o}=e;return Wn.translate(t,n).scale(o)},ii=(e,t)=>e.target.closest(".".concat(t)),si=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),ai=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,li=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ai,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const r="number"===typeof t&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},ci=e=>{const t=e.ctrlKey&&sr()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function ui(e){let{domNode:t,minZoom:n,maxZoom:o,paneClickDistance:r,translateExtent:i,viewport:s,onPanZoom:a,onPanZoomStart:l,onPanZoomEnd:c,onDraggingChange:u}=e;const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=t.getBoundingClientRect(),f=eo().clickDistance(!Qo(r)||r<0?0:r).scaleExtent([n,o]).translateExtent(i),p=Oe(t).call(f);b({x:s.x,y:s.y,zoom:Bo(s.zoom,n,o)},[[0,0],[h.width,h.height]],i);const m=p.on("wheel.zoom"),g=p.on("dblclick.zoom");function v(e,t){return p?new Promise(n=>{null===f||void 0===f||f.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?io:qe).transform(li(p,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function y(){f.on("zoom",null)}async function b(e,t,n){const o=ri(e),r=null===f||void 0===f?void 0:f.constrain()(o,t,n);return r&&await v(r),new Promise(e=>e(r))}return f.wheelDelta(ci),{update:function(e){let{noWheelClassName:t,noPanClassName:n,onPaneContextMenu:o,userSelectionActive:r,panOnScroll:i,panOnDrag:s,panOnScrollMode:h,panOnScrollSpeed:v,preventScrolling:b,zoomOnPinch:x,zoomOnScroll:w,zoomOnDoubleClick:k,zoomActivationKeyPressed:C,lib:S,onTransformChange:E}=e;r&&!d.isZoomingOrPanning&&y();const D=i&&!C&&!r?function(e){let{zoomPanValues:t,noWheelClassName:n,d3Selection:o,d3Zoom:r,panOnScrollMode:i,panOnScrollSpeed:s,zoomOnPinch:a,onPanZoomStart:l,onPanZoom:c,onPanZoomEnd:u}=e;return e=>{if(ii(e,n))return!1;e.preventDefault(),e.stopImmediatePropagation();const d=o.property("__zoom").k||1;if(e.ctrlKey&&a){const t=Te(e),n=ci(e),i=d*Math.pow(2,n);return void r.scaleTo(o,i,t,e)}const h=1===e.deltaMode?20:1;let f=i===So.Vertical?0:e.deltaX*h,p=i===So.Horizontal?0:e.deltaY*h;!sr()&&e.shiftKey&&i!==So.Vertical&&(f=e.deltaY*h,p=0),r.translateBy(o,-f/d*s,-p/d*s,{internal:!0});const m=oi(o.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling||(t.isPanScrolling=!0,null===l||void 0===l||l(e,m)),t.isPanScrolling&&(null===c||void 0===c||c(e,m),t.panScrollTimeout=setTimeout(()=>{null===u||void 0===u||u(e,m),t.isPanScrolling=!1},150))}}({zoomPanValues:d,noWheelClassName:t,d3Selection:p,d3Zoom:f,panOnScrollMode:h,panOnScrollSpeed:v,zoomOnPinch:x,onPanZoomStart:l,onPanZoom:a,onPanZoomEnd:c}):function(e){let{noWheelClassName:t,preventScrolling:n,d3ZoomHandler:o}=e;return function(e,r){const i="wheel"===e.type,s=!n&&i&&!e.ctrlKey,a=ii(e,t);if(e.ctrlKey&&i&&a&&e.preventDefault(),s||a)return null;e.preventDefault(),o.call(this,e,r)}}({noWheelClassName:t,preventScrolling:b,d3ZoomHandler:m});if(p.on("wheel.zoom",D,{passive:!1}),!r){const e=function(e){let{zoomPanValues:t,onDraggingChange:n,onPanZoomStart:o}=e;return e=>{var r,i,s;if(null!==(r=e.sourceEvent)&&void 0!==r&&r.internal)return;const a=oi(e.transform);t.mouseButton=(null===(i=e.sourceEvent)||void 0===i?void 0:i.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=a,"mousedown"===(null===(s=e.sourceEvent)||void 0===s?void 0:s.type)&&n(!0),o&&(null===o||void 0===o||o(e.sourceEvent,a))}}({zoomPanValues:d,onDraggingChange:u,onPanZoomStart:l});f.on("start",e);const t=function(e){let{zoomPanValues:t,panOnDrag:n,onPaneContextMenu:o,onTransformChange:r,onPanZoom:i}=e;return e=>{var s,a,l;t.usedRightMouseButton=!(!o||!si(n,null!==(s=t.mouseButton)&&void 0!==s?s:0)),null!==(a=e.sourceEvent)&&void 0!==a&&a.sync||r([e.transform.x,e.transform.y,e.transform.k]),!i||null!==(l=e.sourceEvent)&&void 0!==l&&l.internal||null===i||void 0===i||i(e.sourceEvent,oi(e.transform))}}({zoomPanValues:d,panOnDrag:s,onPaneContextMenu:!!o,onPanZoom:a,onTransformChange:E});f.on("zoom",t);const n=function(e){let{zoomPanValues:t,panOnDrag:n,panOnScroll:o,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:s}=e;return e=>{var a,l,c,u;if((null===(a=e.sourceEvent)||void 0===a||!a.internal)&&(t.isZoomingOrPanning=!1,s&&si(n,null!==(l=t.mouseButton)&&void 0!==l?l:0)&&!t.usedRightMouseButton&&e.sourceEvent&&s(e.sourceEvent),t.usedRightMouseButton=!1,r(!1),i&&(c=t.prevViewport,u=e.transform,c.x!==u.x||c.y!==u.y||c.zoom!==u.k))){const n=oi(e.transform);t.prevViewport=n,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{null===i||void 0===i||i(e.sourceEvent,n)},o?150:0)}}}({zoomPanValues:d,panOnDrag:s,panOnScroll:i,onPaneContextMenu:o,onPanZoomEnd:c,onDraggingChange:u});f.on("end",n)}const M=function(e){let{zoomActivationKeyPressed:t,zoomOnScroll:n,zoomOnPinch:o,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:s,userSelectionActive:a,noWheelClassName:l,noPanClassName:c,lib:u}=e;return e=>{var d;const h=t||n,f=o&&e.ctrlKey;if(1===e.button&&"mousedown"===e.type&&(ii(e,"".concat(u,"-flow__node"))||ii(e,"".concat(u,"-flow__edge"))))return!0;if(!r&&!h&&!i&&!s&&!o)return!1;if(a)return!1;if(ii(e,l)&&"wheel"===e.type)return!1;if(ii(e,c)&&("wheel"!==e.type||i&&"wheel"===e.type&&!t))return!1;if(!o&&e.ctrlKey&&"wheel"===e.type)return!1;if(!o&&"touchstart"===e.type&&(null===(d=e.touches)||void 0===d?void 0:d.length)>1)return e.preventDefault(),!1;if(!h&&!i&&!f&&"wheel"===e.type)return!1;if(!r&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(r)&&!r.includes(e.button)&&"mousedown"===e.type)return!1;const p=Array.isArray(r)&&r.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&p}}({zoomActivationKeyPressed:C,panOnDrag:s,zoomOnScroll:w,panOnScroll:i,zoomOnDoubleClick:k,zoomOnPinch:x,userSelectionActive:r,noPanClassName:n,noWheelClassName:t,lib:S});f.filter(M),k?p.on("dblclick.zoom",g):p.on("dblclick.zoom",null)},destroy:y,setViewport:async function(e,t){const n=ri(e);return await v(n,t),new Promise(e=>e(n))},setViewportConstrained:b,getViewport:function(){const e=p?Un(p.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return p?new Promise(n=>{null===f||void 0===f||f.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?io:qe).scaleTo(li(p,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return p?new Promise(n=>{null===f||void 0===f||f.interpolate("linear"===(null===t||void 0===t?void 0:t.interpolate)?io:qe).scaleBy(li(p,null===t||void 0===t?void 0:t.duration,null===t||void 0===t?void 0:t.ease,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){null===f||void 0===f||f.scaleExtent(e)},setTranslateExtent:function(e){null===f||void 0===f||f.translateExtent(e)},syncViewport:function(e){if(p){const t=ri(e),n=p.property("__zoom");n.k===e.zoom&&n.x===e.x&&n.y===e.y||null===f||void 0===f||f.transform(p,t,null,{sync:!0})}},setClickDistance:function(e){const t=!Qo(e)||e<0?0:e;null===f||void 0===f||f.clickDistance(t)}}}var di;!function(e){e.Line="line",e.Handle="handle"}(di||(di={}));function hi(e,t){return Math.max(0,t-e)}function fi(e,t){return Math.max(0,e-t)}function pi(e,t,n){return Math.max(0,t-e,e-n)}function mi(e,t){return e?!t:t}const gi={width:0,height:0,x:0,y:0},vi=a(a({},gi),{},{pointerX:0,pointerY:0,aspectRatio:1});function yi(e,t,n){var o,r;const i=t.position.x+e.position.x,s=t.position.y+e.position.y,a=null!==(o=e.measured.width)&&void 0!==o?o:0,l=null!==(r=e.measured.height)&&void 0!==r?r:0,c=n[0]*a,u=n[1]*l;return[[i-c,s-u],[i+a-c,s+l-u]]}function bi(e){let{domNode:t,nodeId:n,getStoreItems:o,onChange:r,onEnd:i}=e;const s=Oe(t);return{update:function(e){let{controlPosition:t,boundaries:l,keepAspectRatio:c,resizeDirection:u,onResizeStart:d,onResize:h,onResizeEnd:f,shouldResize:p}=e,m=a({},gi),g=a({},vi);const v=function(e){return{isHorizontal:e.includes("right")||e.includes("left"),isVertical:e.includes("bottom")||e.includes("top"),affectsX:e.includes("left"),affectsY:e.includes("top")}}(t);let y,b,x,w,k=null,C=[];const S=We().on("start",e=>{var t,r,i,s,l;const{nodeLookup:c,transform:u,snapGrid:h,snapToGrid:f,nodeOrigin:p,paneDomNode:v}=o();if(y=c.get(n),!y)return;k=null!==(t=null===v||void 0===v?void 0:v.getBoundingClientRect())&&void 0!==t?t:null;const{xSnapped:S,ySnapped:E}=fr(e.sourceEvent,{transform:u,snapGrid:h,snapToGrid:f,containerBounds:k});m={width:null!==(r=y.measured.width)&&void 0!==r?r:0,height:null!==(i=y.measured.height)&&void 0!==i?i:0,x:null!==(s=y.position.x)&&void 0!==s?s:0,y:null!==(l=y.position.y)&&void 0!==l?l:0},g=a(a({},m),{},{pointerX:S,pointerY:E,aspectRatio:m.width/m.height}),b=void 0,y.parentId&&("parent"===y.extent||y.expandParent)&&(b=c.get(y.parentId),x=b&&"parent"===y.extent?function(e){return[[0,0],[e.measured.width,e.measured.height]]}(b):void 0),C=[],w=void 0;for(const[o,d]of c)if(d.parentId===n&&(C.push({id:o,position:a({},d.position),extent:d.extent}),"parent"===d.extent||d.expandParent)){var D;const e=yi(d,y,null!==(D=d.origin)&&void 0!==D?D:p);w=w?[[Math.min(e[0][0],w[0][0]),Math.min(e[0][1],w[0][1])],[Math.max(e[1][0],w[1][0]),Math.max(e[1][1],w[1][1])]]:e}null===d||void 0===d||d(e,a({},m))}).on("drag",e=>{var t;const{transform:n,snapGrid:i,snapToGrid:s,nodeOrigin:d}=o(),f=fr(e.sourceEvent,{transform:n,snapGrid:i,snapToGrid:s,containerBounds:k}),S=[];if(!y)return;const{x:E,y:D,width:M,height:N}=m,A={},O=null!==(t=y.origin)&&void 0!==t?t:d,{width:T,height:_,x:j,y:P}=function(e,t,n,o,r,i,s,a){let{affectsX:l,affectsY:c}=t;const{isHorizontal:u,isVertical:d}=t,h=u&&d,{xSnapped:f,ySnapped:p}=n,{minWidth:m,maxWidth:g,minHeight:v,maxHeight:y}=o,{x:b,y:x,width:w,height:k,aspectRatio:C}=e;let S=Math.floor(u?f-e.pointerX:0),E=Math.floor(d?p-e.pointerY:0);const D=w+(l?-S:S),M=k+(c?-E:E),N=-i[0]*w,A=-i[1]*k;let O=pi(D,m,g),T=pi(M,v,y);if(s){let e=0,t=0;l&&S<0?e=hi(b+S+N,s[0][0]):!l&&S>0&&(e=fi(b+D+N,s[1][0])),c&&E<0?t=hi(x+E+A,s[0][1]):!c&&E>0&&(t=fi(x+M+A,s[1][1])),O=Math.max(O,e),T=Math.max(T,t)}if(a){let e=0,t=0;l&&S>0?e=fi(b+S,a[0][0]):!l&&S<0&&(e=hi(b+D,a[1][0])),c&&E>0?t=fi(x+E,a[0][1]):!c&&E<0&&(t=hi(x+M,a[1][1])),O=Math.max(O,e),T=Math.max(T,t)}if(r){if(u){const e=pi(D/C,v,y)*C;if(O=Math.max(O,e),s){let e=0;e=!l&&!c||l&&!c&&h?fi(x+A+D/C,s[1][1])*C:hi(x+A+(l?S:-S)/C,s[0][1])*C,O=Math.max(O,e)}if(a){let e=0;e=!l&&!c||l&&!c&&h?hi(x+D/C,a[1][1])*C:fi(x+(l?S:-S)/C,a[0][1])*C,O=Math.max(O,e)}}if(d){const e=pi(M*C,m,g)/C;if(T=Math.max(T,e),s){let e=0;e=!l&&!c||c&&!l&&h?fi(b+M*C+N,s[1][0])/C:hi(b+(c?E:-E)*C+N,s[0][0])/C,T=Math.max(T,e)}if(a){let e=0;e=!l&&!c||c&&!l&&h?hi(b+M*C,a[1][0])/C:fi(b+(c?E:-E)*C,a[0][0])/C,T=Math.max(T,e)}}}E+=E<0?T:-T,S+=S<0?O:-O,r&&(h?D>M*C?E=(mi(l,c)?-S:S)/C:S=(mi(l,c)?-E:E)*C:u?(E=S/C,c=l):(S=E*C,l=c));const _=l?b+S:b,j=c?x+E:x;return{width:w+(l?-S:S),height:k+(c?-E:E),x:i[0]*S*(l?-1:1)+_,y:i[1]*E*(c?-1:1)+j}}(g,v,f,l,c,O,x,w),I=T!==M,R=_!==N,F=j!==E&&I,z=P!==D&&R;if(!F&&!z&&!I&&!R)return;if((F||z||1===O[0]||1===O[1])&&(A.x=F?j:m.x,A.y=z?P:m.y,m.x=A.x,m.y=A.y,C.length>0)){const e=j-E,t=P-D;for(const n of C)n.position={x:n.position.x-e+O[0]*(T-M),y:n.position.y-t+O[1]*(_-N)},S.push(n)}if((I||R)&&(A.width=!I||u&&"horizontal"!==u?m.width:T,A.height=!R||u&&"vertical"!==u?m.height:_,m.width=A.width,m.height=A.height),b&&y.expandParent){var L,B;const e=O[0]*(null!==(L=A.width)&&void 0!==L?L:0);A.x&&A.x<e&&(m.x=e,g.x=g.x-(A.x-e));const t=O[1]*(null!==(B=A.height)&&void 0!==B?B:0);A.y&&A.y<t&&(m.y=t,g.y=g.y-(A.y-t))}const V=function(e){let{width:t,prevWidth:n,height:o,prevHeight:r,affectsX:i,affectsY:s}=e;const a=t-n,l=o-r,c=[a>0?1:a<0?-1:0,l>0?1:l<0?-1:0];return a&&i&&(c[0]=-1*c[0]),l&&s&&(c[1]=-1*c[1]),c}({width:m.width,prevWidth:M,height:m.height,prevHeight:N,affectsX:v.affectsX,affectsY:v.affectsY}),H=a(a({},m),{},{direction:V});!1!==(null===p||void 0===p?void 0:p(e,H))&&(null===h||void 0===h||h(e,H),r(A,S))}).on("end",e=>{null===f||void 0===f||f(e,a({},m)),null===i||void 0===i||i(a({},m))});s.call(S)},destroy:function(){s.on(".drag",null)}}}var xi=n(8443);const wi=e=>{let t;const n=new Set,o=(e,o)=>{const r="function"===typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=o?o:"object"!==typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,i={setState:o,getState:r,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(o,r,i);return i},ki=e=>e?wi(e):wi;const{useDebugValue:Ci}=e,{useSyncExternalStoreWithSelector:Si}=xi,Ei=e=>e;function Di(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ei,n=arguments.length>2?arguments[2]:void 0;const o=Si(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Ci(o),o}const Mi=(e,t)=>{const n=ki(e),o=function(e){return Di(n,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t)};return Object.assign(o,n),o};function Ni(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var Ai=n(7950);const Oi=["position","children","className","style"],Ti=["type","position","isValidConnection","isConnectable","isConnectableStart","isConnectableEnd","id","onConnect","children","className","onMouseDown","onTouchStart"],_i=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"],ji=["path","labelX","labelY","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","interactionWidth"],Pi=["id"],Ii=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","onSelectionStart","onSelectionEnd","onBeforeDelete","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","selectionOnDrag","selectionMode","panActivationKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","edgesReconnectable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","paneClickDistance","nodeClickDistance","children","onReconnect","onReconnectStart","onReconnectEnd","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","reconnectRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","disableKeyboardA11y","autoPanOnConnect","autoPanOnNodeDrag","autoPanSpeed","connectionRadius","isValidConnection","onError","style","id","nodeDragThreshold","connectionDragThreshold","viewport","onViewportChange","width","height","colorMode","debug","onScroll","ariaLabelConfig"],Ri=["children","className"],Fi=(0,e.createContext)(null),zi=Fi.Provider,Li=ao();function Bi(t,n){const o=(0,e.useContext)(Fi);if(null===o)throw new Error(Li);return Di(o,t,n)}function Vi(){const t=(0,e.useContext)(Fi);if(null===t)throw new Error(Li);return(0,e.useMemo)(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Hi={display:"none"},$i={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Wi="react-flow__node-desc",Ui="react-flow__edge-desc",qi=e=>e.ariaLiveMessage,Ki=e=>e.ariaLabelConfig;function Yi(e){let{rfId:t}=e;const n=Bi(qi);return(0,c.jsx)("div",{id:"".concat("react-flow__aria-live","-").concat(t),"aria-live":"assertive","aria-atomic":"true",style:$i,children:n})}function Xi(e){let{rfId:t,disableKeyboardA11y:n}=e;const o=Bi(Ki);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{id:"".concat(Wi,"-").concat(t),style:Hi,children:n?o["node.a11yDescription.default"]:o["node.a11yDescription.keyboardDisabled"]}),(0,c.jsx)("div",{id:"".concat(Ui,"-").concat(t),style:Hi,children:o["edge.a11yDescription.default"]}),!n&&(0,c.jsx)(Yi,{rfId:t})]})}const Zi=(0,e.forwardRef)((e,t)=>{let{position:n="top-left",children:o,className:r,style:i}=e,s=l(e,Oi);const d="".concat(n).split("-");return(0,c.jsx)("div",a(a({className:u(["react-flow__panel",r,...d]),style:i,ref:t},s),{},{children:o}))});function Gi(e){let{proOptions:t,position:n="bottom-right"}=e;return null!==t&&void 0!==t&&t.hideAttribution?null:(0,c.jsx)(Zi,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,c.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}Zi.displayName="Panel";const Ji=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Qi=e=>e.id;function es(e,t){return Ni(e.selectedNodes.map(Qi),t.selectedNodes.map(Qi))&&Ni(e.selectedEdges.map(Qi),t.selectedEdges.map(Qi))}function ts(t){let{onSelectionChange:n}=t;const o=Vi(),{selectedNodes:r,selectedEdges:i}=Bi(Ji,es);return(0,e.useEffect)(()=>{const e={nodes:r,edges:i};null===n||void 0===n||n(e),o.getState().onSelectionChangeHandlers.forEach(t=>t(e))},[r,i,n]),null}const ns=e=>!!e.onSelectionChangeHandlers;function rs(e){let{onSelectionChange:t}=e;const n=Bi(ns);return t||n?(0,c.jsx)(ts,{onSelectionChange:t}):null}const is=[0,0],ss={x:0,y:0,zoom:1},as=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig","rfId"],ls=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),cs={translateExtent:xo,nodeOrigin:is,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function us(t){const{setNodes:n,setEdges:o,setMinZoom:r,setMaxZoom:i,setTranslateExtent:s,setNodeExtent:a,reset:l,setDefaultNodesAndEdges:c,setPaneClickDistance:u}=Bi(ls,Ni),d=Vi();(0,e.useEffect)(()=>(c(t.defaultNodes,t.defaultEdges),()=>{h.current=cs,l()}),[]);const h=(0,e.useRef)(cs);return(0,e.useEffect)(()=>{for(const e of as){const l=t[e];l!==h.current[e]&&("undefined"!==typeof t[e]&&("nodes"===e?n(l):"edges"===e?o(l):"minZoom"===e?r(l):"maxZoom"===e?i(l):"translateExtent"===e?s(l):"nodeExtent"===e?a(l):"paneClickDistance"===e?u(l):"ariaLabelConfig"===e?d.setState({ariaLabelConfig:hr(l)}):"fitView"===e?d.setState({fitViewQueued:l}):"fitViewOptions"===e?d.setState({fitViewOptions:l}):d.setState({[e]:l})))}h.current=t},as.map(e=>t[e])),null}function ds(){return"undefined"!==typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}const hs="undefined"!==typeof document?document:null;function fs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{target:hs,actInsideInputWithModifier:!0};const[o,r]=(0,e.useState)(!1),i=(0,e.useRef)(!1),s=(0,e.useRef)(new Set([])),[a,l]=(0,e.useMemo)(()=>{if(null!==t){const e=(Array.isArray(t)?t:[t]).filter(e=>"string"===typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=e.reduce((e,t)=>e.concat(...t),[]);return[e,n]}return[[],[]]},[t]);return(0,e.useEffect)(()=>{var e,o;const c=null!==(e=null===n||void 0===n?void 0:n.target)&&void 0!==e?e:hs,u=null===(o=null===n||void 0===n?void 0:n.actInsideInputWithModifier)||void 0===o||o;if(null!==t){const e=e=>{i.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey;if((!i.current||i.current&&!u)&&vr(e))return!1;const t=ms(e.code,l);if(s.current.add(e[t]),ps(a,s.current,!1)){var o;const t=(null===(o=e.composedPath)||void 0===o||null===(o=o.call(e))||void 0===o?void 0:o[0])||e.target,s="BUTTON"===(null===t||void 0===t?void 0:t.nodeName)||"A"===(null===t||void 0===t?void 0:t.nodeName);!1===n.preventDefault||!i.current&&s||e.preventDefault(),r(!0)}},t=e=>{const t=ms(e.code,l);ps(a,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(e[t]),"Meta"===e.key&&s.current.clear(),i.current=!1},o=()=>{s.current.clear(),r(!1)};return null===c||void 0===c||c.addEventListener("keydown",e),null===c||void 0===c||c.addEventListener("keyup",t),window.addEventListener("blur",o),window.addEventListener("contextmenu",o),()=>{null===c||void 0===c||c.removeEventListener("keydown",e),null===c||void 0===c||c.removeEventListener("keyup",t),window.removeEventListener("blur",o),window.removeEventListener("contextmenu",o)}}},[t,r]),o}function ps(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function ms(e,t){return t.includes(e)?"code":"key"}function gs(e,t){const n=[],o=new Map,r=[];for(const i of e)if("add"!==i.type)if("remove"===i.type||"replace"===i.type)o.set(i.id,[i]);else{const e=o.get(i.id);e?e.push(i):o.set(i.id,[i])}else r.push(i);for(const i of t){const e=o.get(i.id);if(!e){n.push(i);continue}if("remove"===e[0].type)continue;if("replace"===e[0].type){n.push(a({},e[0].item));continue}const t=a({},i);for(const n of e)vs(n,t);n.push(t)}return r.length&&r.forEach(e=>{void 0!==e.index?n.splice(e.index,0,a({},e.item)):n.push(a({},e.item))}),n}function vs(e,t){switch(e.type){case"select":t.selected=e.selected;break;case"position":"undefined"!==typeof e.position&&(t.position=e.position),"undefined"!==typeof e.dragging&&(t.dragging=e.dragging);break;case"dimensions":var n;if("undefined"!==typeof e.dimensions)null!==(n=t.measured)&&void 0!==n||(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(!0!==e.setAttributes&&"width"!==e.setAttributes||(t.width=e.dimensions.width),!0!==e.setAttributes&&"height"!==e.setAttributes||(t.height=e.dimensions.height));"boolean"===typeof e.resizing&&(t.resizing=e.resizing)}}function ys(e,t){return gs(e,t)}function bs(e,t){return gs(e,t)}function xs(e,t){return{id:e,type:"select",selected:t}}function ws(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];for(const[r,i]of e){const e=t.has(r);void 0===i.selected&&!e||i.selected===e||(n&&(i.selected=e),o.push(xs(i.id,e)))}return o}function ks(e){let{items:t=[],lookup:n}=e;const o=[],r=new Map(t.map(e=>[e.id,e]));for(const[a,l]of t.entries()){var i,s;const e=n.get(l.id),t=null!==(i=null===e||void 0===e||null===(s=e.internals)||void 0===s?void 0:s.userNode)&&void 0!==i?i:e;void 0!==t&&t!==l&&o.push({id:l.id,item:l,type:"replace"}),void 0===t&&o.push({item:l,type:"add",index:a})}for(const[a]of n){void 0===r.get(a)&&o.push({id:a,type:"remove"})}return o}function Cs(e){return{id:e.id,type:"remove"}}const Ss=e=>(e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e))(e);function Es(t){return(0,e.forwardRef)(t)}const Ds="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Ms(t){const[n,o]=(0,e.useState)(BigInt(0)),[r]=(0,e.useState)(()=>function(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}(()=>o(e=>e+BigInt(1))));return Ds(()=>{const e=r.get();e.length&&(t(e),r.reset())},[n]),r}const Ns=(0,e.createContext)(null);function As(t){let{children:n}=t;const o=Vi(),r=(0,e.useCallback)(e=>{const{nodes:t=[],setNodes:n,hasDefaultNodes:r,onNodesChange:i,nodeLookup:s,fitViewQueued:a}=o.getState();let l=t;for(const o of e)l="function"===typeof o?o(l):o;const c=ks({items:l,lookup:s});r&&n(l),c.length>0?null===i||void 0===i||i(c):a&&window.requestAnimationFrame(()=>{const{fitViewQueued:e,nodes:t,setNodes:n}=o.getState();e&&n(t)})},[]),i=Ms(r),s=Ms((0,e.useCallback)(e=>{const{edges:t=[],setEdges:n,hasDefaultEdges:r,onEdgesChange:i,edgeLookup:s}=o.getState();let a=t;for(const o of e)a="function"===typeof o?o(a):o;r?n(a):i&&i(ks({items:a,lookup:s}))},[])),a=(0,e.useMemo)(()=>({nodeQueue:i,edgeQueue:s}),[]);return(0,c.jsx)(Ns.Provider,{value:a,children:n})}const Os=e=>!!e.panZoom;function Ts(){const t=(()=>{const t=Vi();return(0,e.useMemo)(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:null===e||void 0===e?void 0:e.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:null===e||void 0===e?void 0:e.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:o}=t.getState();return o?o.scaleTo(e,{duration:null===n||void 0===n?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{var o,r,i;const{transform:[s,a,l],panZoom:c}=t.getState();return c?(await c.setViewport({x:null!==(o=e.x)&&void 0!==o?o:s,y:null!==(r=e.y)&&void 0!==r?r:a,zoom:null!==(i=e.zoom)&&void 0!==i?i:l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,o]=t.getState().transform;return{x:e,y:n,zoom:o}},setCenter:async(e,n,o)=>t.getState().setCenter(e,n,o),fitBounds:async(e,n)=>{var o;const{width:r,height:i,minZoom:s,maxZoom:a,panZoom:l}=t.getState(),c=ir(e,r,i,s,a,null!==(o=null===n||void 0===n?void 0:n.padding)&&void 0!==o?o:.1);return l?(await l.setViewport(c,{duration:null===n||void 0===n?void 0:n.duration,ease:null===n||void 0===n?void 0:n.ease,interpolate:null===n||void 0===n?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:function(e){var n,o;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:i,snapGrid:s,snapToGrid:a,domNode:l}=t.getState();if(!l)return e;const{x:c,y:u}=l.getBoundingClientRect(),d={x:e.x-c,y:e.y-u},h=null!==(n=r.snapGrid)&&void 0!==n?n:s,f=null!==(o=r.snapToGrid)&&void 0!==o?o:a;return nr(d,i,f,h)},flowToScreenPosition:e=>{const{transform:n,domNode:o}=t.getState();if(!o)return e;const{x:r,y:i}=o.getBoundingClientRect(),s=or(e,n);return{x:s.x+r,y:s.y+i}}}),[])})(),n=Vi(),o=function(){const t=(0,e.useContext)(Ns);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}(),r=Bi(Os),i=(0,e.useMemo)(()=>{const e=e=>n.getState().nodeLookup.get(e),t=e=>{o.nodeQueue.push(e)},r=e=>{o.edgeQueue.push(e)},i=e=>{var t,o,r,i;const{nodeLookup:s,nodeOrigin:l}=n.getState(),c=Ss(e)?e:s.get(e.id),u=c.parentId?ur(c.position,c.measured,c.parentId,s,l):c.position,d=a(a({},c),{},{position:u,width:null!==(t=null===(o=c.measured)||void 0===o?void 0:o.width)&&void 0!==t?t:c.width,height:null!==(r=null===(i=c.measured)||void 0===i?void 0:i.height)&&void 0!==r?r:c.height});return Yo(d)},s=function(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};t(t=>t.map(t=>{if(t.id===e){const e="function"===typeof n?n(t):n;return o.replace&&Ss(e)?e:a(a({},t),e)}return t}))},l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};r(o=>o.map(o=>{if(o.id===e){const e="function"===typeof t?t(o):t;return n.replace&&_o(e)?e:a(a({},o),e)}return o}))};return{getNodes:()=>n.getState().nodes.map(e=>a({},e)),getNode:t=>{var n;return null===(n=e(t))||void 0===n?void 0:n.internals.userNode},getInternalNode:e,getEdges:()=>{const{edges:e=[]}=n.getState();return e.map(e=>a({},e))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:t,setEdges:r,addNodes:e=>{const t=Array.isArray(e)?e:[e];o.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{const t=Array.isArray(e)?e:[e];o.edgeQueue.push(e=>[...e,...t])},toObject:()=>{const{nodes:e=[],edges:t=[],transform:o}=n.getState(),[r,i,s]=o;return{nodes:e.map(e=>a({},e)),edges:t.map(e=>a({},e)),viewport:{x:r,y:i,zoom:s}}},deleteElements:async e=>{let{nodes:t=[],edges:o=[]}=e;const{nodes:r,edges:i,onNodesDelete:s,onEdgesDelete:a,triggerNodeChanges:l,triggerEdgeChanges:c,onDelete:u,onBeforeDelete:d}=n.getState(),{nodes:h,edges:f}=await Lo({nodesToRemove:t,edgesToRemove:o,nodes:r,edges:i,onBeforeDelete:d}),p=f.length>0,m=h.length>0;if(p){const e=f.map(Cs);null===a||void 0===a||a(f),c(e)}if(m){const e=h.map(Cs);null===s||void 0===s||s(h),l(e)}return(m||p)&&(null===u||void 0===u||u({nodes:h,edges:f})),{deletedNodes:h,deletedEdges:f}},getIntersectingNodes:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0;const r=Jo(e),s=r?e:i(e),a=void 0!==o;return s?(o||n.getState().nodes).filter(o=>{const i=n.getState().nodeLookup.get(o.id);if(i&&!r&&(o.id===e.id||!i.internals.positionAbsolute))return!1;const l=Yo(a?o:i),c=Go(l,s);return t&&c>0||c>=s.width*s.height}):[]},isNodeIntersecting:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=Jo(e)?e:i(e);if(!o)return!1;const r=Go(o,t);return n&&r>0||r>=o.width*o.height},updateNode:s,updateNodeData:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};s(e,e=>{const o="function"===typeof t?t(e):t;return n.replace?a(a({},e),{},{data:o}):a(a({},e),{},{data:a(a({},e.data),o)})},n)},updateEdge:l,updateEdgeData:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};l(e,e=>{const o="function"===typeof t?t(e):t;return n.replace?a(a({},e),{},{data:o}):a(a({},e),{},{data:a(a({},e.data),o)})},n)},getNodesBounds:e=>{const{nodeLookup:t,nodeOrigin:o}=n.getState();return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{nodeOrigin:[0,0]};if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const o="string"===typeof n;let r=t.nodeLookup||o?void 0:n;t.nodeLookup&&(r=o?t.nodeLookup.get(n):jo(n)?n:t.nodeLookup.get(n.id));const i=r?Xo(r,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Uo(e,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ko(n)}(e,{nodeLookup:t,nodeOrigin:o})},getHandleConnections:e=>{var t,o;let{type:r,id:i,nodeId:s}=e;return Array.from(null!==(t=null===(o=n.getState().connectionLookup.get("".concat(s,"-").concat(r).concat(i?"-".concat(i):"")))||void 0===o?void 0:o.values())&&void 0!==t?t:[])},getNodeConnections:e=>{var t,o;let{type:r,handleId:i,nodeId:s}=e;return Array.from(null!==(t=null===(o=n.getState().connectionLookup.get("".concat(s).concat(r?i?"-".concat(r,"-").concat(i):"-".concat(r):"")))||void 0===o?void 0:o.values())&&void 0!==t?t:[])},fitView:async e=>{var t;const r=null!==(t=n.getState().fitViewResolver)&&void 0!==t?t:function(){let e,t;return{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t}}();return n.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:r}),o.nodeQueue.push(e=>[...e]),r.promise}}},[]);return(0,e.useMemo)(()=>a(a(a({},i),t),{},{viewportInitialized:r}),[r])}const _s=e=>e.selected,js="undefined"!==typeof window?window:void 0;const Ps={position:"absolute",width:"100%",height:"100%",top:0,left:0},Is=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Rs(t){let{onPaneContextMenu:n,zoomOnScroll:o=!0,zoomOnPinch:r=!0,panOnScroll:i=!1,panOnScrollSpeed:s=.5,panOnScrollMode:a=So.Free,zoomOnDoubleClick:l=!0,panOnDrag:u=!0,defaultViewport:d,translateExtent:h,minZoom:f,maxZoom:p,zoomActivationKeyCode:m,preventScrolling:g=!0,children:v,noWheelClassName:y,noPanClassName:b,onViewportChange:x,isControlledViewport:w,paneClickDistance:k}=t;const C=Vi(),S=(0,e.useRef)(null),{userSelectionActive:E,lib:D}=Bi(Is,Ni),M=fs(m),N=(0,e.useRef)();!function(t){const n=Vi();(0,e.useEffect)(()=>{const e=()=>{if(!t.current)return!1;const e=pr(t.current);var o,r;0!==e.height&&0!==e.width||null===(o=(r=n.getState()).onError)||void 0===o||o.call(r,"004",co()),n.setState({width:e.width||500,height:e.height||500})};if(t.current){e(),window.addEventListener("resize",e);const n=new ResizeObserver(()=>e());return n.observe(t.current),()=>{window.removeEventListener("resize",e),n&&t.current&&n.unobserve(t.current)}}},[])}(S);const A=(0,e.useCallback)(e=>{null===x||void 0===x||x({x:e[0],y:e[1],zoom:e[2]}),w||C.setState({transform:e})},[x,w]);return(0,e.useEffect)(()=>{if(S.current){N.current=ui({domNode:S.current,minZoom:f,maxZoom:p,translateExtent:h,viewport:d,paneClickDistance:k,onDraggingChange:e=>C.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{const{onViewportChangeStart:n,onMoveStart:o}=C.getState();null===o||void 0===o||o(e,t),null===n||void 0===n||n(t)},onPanZoom:(e,t)=>{const{onViewportChange:n,onMove:o}=C.getState();null===o||void 0===o||o(e,t),null===n||void 0===n||n(t)},onPanZoomEnd:(e,t)=>{const{onViewportChangeEnd:n,onMoveEnd:o}=C.getState();null===o||void 0===o||o(e,t),null===n||void 0===n||n(t)}});const{x:e,y:t,zoom:n}=N.current.getViewport();return C.setState({panZoom:N.current,transform:[e,t,n],domNode:S.current.closest(".react-flow")}),()=>{var e;null===(e=N.current)||void 0===e||e.destroy()}}},[]),(0,e.useEffect)(()=>{var e;null===(e=N.current)||void 0===e||e.update({onPaneContextMenu:n,zoomOnScroll:o,zoomOnPinch:r,panOnScroll:i,panOnScrollSpeed:s,panOnScrollMode:a,zoomOnDoubleClick:l,panOnDrag:u,zoomActivationKeyPressed:M,preventScrolling:g,noPanClassName:b,userSelectionActive:E,noWheelClassName:y,lib:D,onTransformChange:A})},[n,o,r,i,s,a,l,u,M,g,b,E,y,D,A]),(0,c.jsx)("div",{className:"react-flow__renderer",ref:S,style:Ps,children:v})}const Fs=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function zs(){const{userSelectionActive:e,userSelectionRect:t}=Bi(Fs,Ni);return e&&t?(0,c.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}}):null}const Ls=(e,t)=>n=>{n.target===t.current&&(null===e||void 0===e||e(n))},Bs=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Vs(t){let{isSelecting:n,selectionKeyPressed:o,selectionMode:r=Eo.Full,panOnDrag:i,selectionOnDrag:s,onSelectionStart:a,onSelectionEnd:l,onPaneClick:d,onPaneContextMenu:h,onPaneScroll:f,onPaneMouseEnter:p,onPaneMouseMove:m,onPaneMouseLeave:g,children:v}=t;const y=Vi(),{userSelectionActive:b,elementsSelectable:x,dragging:w,connectionInProgress:k}=Bi(Bs,Ni),C=x&&(n||b),S=(0,e.useRef)(null),E=(0,e.useRef)(),D=(0,e.useRef)(new Set),M=(0,e.useRef)(new Set),N=(0,e.useRef)(!1),A=(0,e.useRef)(!1),O=e=>{N.current||k?N.current=!1:(null===d||void 0===d||d(e),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1}))},T=f?e=>f(e):void 0,_=!0===i||Array.isArray(i)&&i.includes(0);return(0,c.jsxs)("div",{className:u(["react-flow__pane",{draggable:_,dragging:w,selection:n}]),onClick:C?void 0:Ls(O,S),onContextMenu:Ls(e=>{Array.isArray(i)&&null!==i&&void 0!==i&&i.includes(2)?e.preventDefault():null===h||void 0===h||h(e)},S),onWheel:Ls(T,S),onPointerEnter:C?void 0:p,onPointerDown:C?e=>{var t,o;const{resetSelectedElements:r,domNode:i}=y.getState();if(E.current=null===i||void 0===i?void 0:i.getBoundingClientRect(),!x||!n||0!==e.button||e.target!==S.current||!E.current)return;null===(t=e.target)||void 0===t||null===(o=t.setPointerCapture)||void 0===o||o.call(t,e.pointerId),A.current=!0,N.current=!1;const{x:s,y:l}=br(e.nativeEvent,E.current);r(),y.setState({userSelectionRect:{width:0,height:0,startX:s,startY:l,x:s,y:l}}),null===a||void 0===a||a(e)}:m,onPointerMove:C?e=>{var t;const{userSelectionRect:n,transform:o,nodeLookup:i,edgeLookup:s,connectionLookup:a,triggerNodeChanges:l,triggerEdgeChanges:c,defaultEdgeOptions:u}=y.getState();if(!E.current||!n)return;N.current=!0;const{x:d,y:h}=br(e.nativeEvent,E.current),{startX:f,startY:p}=n,m={startX:f,startY:p,x:d<f?d:f,y:h<p?h:p,width:Math.abs(d-f),height:Math.abs(h-p)},g=D.current,v=M.current;D.current=new Set(Ro(i,m,o,r===Eo.Partial,!0).map(e=>e.id)),M.current=new Set;const b=null===(t=null===u||void 0===u?void 0:u.selectable)||void 0===t||t;for(const r of D.current){const e=a.get(r);if(e)for(const{edgeId:t}of e.values()){var x;const e=s.get(t);e&&(null!==(x=e.selectable)&&void 0!==x?x:b)&&M.current.add(t)}}if(!dr(g,D.current)){l(ws(i,D.current,!0))}if(!dr(v,M.current)){c(ws(s,M.current))}y.setState({userSelectionRect:m,userSelectionActive:!0,nodesSelectionActive:!1})}:m,onPointerUp:C?e=>{var t,n;if(0!==e.button||!A.current)return;null===(t=e.target)||void 0===t||null===(n=t.releasePointerCapture)||void 0===n||n.call(t,e.pointerId);const{userSelectionRect:r}=y.getState();!b&&r&&e.target===S.current&&(null===O||void 0===O||O(e)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:D.current.size>0}),null===l||void 0===l||l(e),(o||s)&&(N.current=!1),A.current=!1}:void 0,onPointerLeave:g,ref:S,style:Ps,children:[v,(0,c.jsx)(zs,{})]})}function Hs(e){let{id:t,store:n,unselect:o=!1,nodeRef:r}=e;const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:a,nodeLookup:l,onError:c}=n.getState(),u=l.get(t);u?(n.setState({nodesSelectionActive:!1}),u.selected?(o||u.selected&&a)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var e;return null===r||void 0===r||null===(e=r.current)||void 0===e?void 0:e.blur()})):i([t])):null===c||void 0===c||c("012",vo(t))}function $s(t){let{nodeRef:n,disabled:o=!1,noDragClassName:r,handleSelector:i,nodeId:s,isSelectable:a,nodeClickDistance:l}=t;const c=Vi(),[u,d]=(0,e.useState)(!1),h=(0,e.useRef)();return(0,e.useEffect)(()=>{h.current=Zr({getStoreItems:()=>c.getState(),onNodeMouseDown:e=>{Hs({id:e,store:c,nodeRef:n})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),(0,e.useEffect)(()=>{var e;if(o)null===(e=h.current)||void 0===e||e.destroy();else if(n.current){var t;return null===(t=h.current)||void 0===t||t.update({noDragClassName:r,handleSelector:i,domNode:n.current,isSelectable:a,nodeId:s,nodeClickDistance:l}),()=>{var e;null===(e=h.current)||void 0===e||e.destroy()}}},[r,i,o,a,n,s]),u}function Ws(){const t=Vi(),n=(0,e.useCallback)(e=>{const{nodeExtent:n,snapToGrid:o,snapGrid:r,nodesDraggable:i,onError:s,updateNodePositions:a,nodeLookup:l,nodeOrigin:c}=t.getState(),u=new Map,d=(e=>t=>t.selected&&(t.draggable||e&&"undefined"===typeof t.draggable))(i),h=o?r[0]:5,f=o?r[1]:5,p=e.direction.x*h*e.factor,m=e.direction.y*f*e.factor;for(const[,t]of l){if(!d(t))continue;let e={x:t.internals.positionAbsolute.x+p,y:t.internals.positionAbsolute.y+m};o&&(e=tr(e,r));const{position:i,positionAbsolute:a}=zo({nodeId:t.id,nextPosition:e,nodeLookup:l,nodeExtent:n,nodeOrigin:c,onError:s});t.position=i,t.internals.positionAbsolute=a,u.set(t.id,t)}a(u)},[]);return n}const Us=(0,e.createContext)(null),qs=Us.Provider;Us.Consumer;const Ks=()=>(0,e.useContext)(Us),Ys=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId});const Xs=(0,e.memo)(Es(function(e,t){let{type:n="source",position:o=Ao.Top,isValidConnection:r,isConnectable:i=!0,isConnectableStart:s=!0,isConnectableEnd:d=!0,id:h,onConnect:f,children:p,className:m,onMouseDown:g,onTouchStart:v}=e,y=l(e,Ti);const b=h||null,x="target"===n,w=Vi(),k=Ks(),{connectOnClick:C,noPanClassName:S,rfId:E}=Bi(Ys,Ni),{connectingFrom:D,connectingTo:M,clickConnecting:N,isPossibleEndHandle:A,connectionInProcess:O,clickConnectionInProcess:T,valid:_}=Bi(((e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:l,isValid:c}=s,u=(null===l||void 0===l?void 0:l.nodeId)===e&&(null===l||void 0===l?void 0:l.id)===t&&(null===l||void 0===l?void 0:l.type)===n;return{connectingFrom:(null===a||void 0===a?void 0:a.nodeId)===e&&(null===a||void 0===a?void 0:a.id)===t&&(null===a||void 0===a?void 0:a.type)===n,connectingTo:u,clickConnecting:(null===r||void 0===r?void 0:r.nodeId)===e&&(null===r||void 0===r?void 0:r.id)===t&&(null===r||void 0===r?void 0:r.type)===n,isPossibleEndHandle:i===Co.Strict?(null===a||void 0===a?void 0:a.type)!==n:e!==(null===a||void 0===a?void 0:a.nodeId)||t!==(null===a||void 0===a?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:u&&c}})(k,b,n),Ni);var j,P;k||null===(j=(P=w.getState()).onError)||void 0===j||j.call(P,"010",mo());const I=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:o}=w.getState(),r=a(a({},t),e);if(o){const{edges:e,setEdges:t}=w.getState();t(((e,t)=>{if(!e.source||!e.target)return er(0,ho()),t;let n;return n=_o(e)?a({},e):a(a({},e),{},{id:Mr(e)}),((e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)))(n,t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))})(r,e))}null===n||void 0===n||n(r),null===f||void 0===f||f(r)},R=e=>{if(!k)return;const t=yr(e.nativeEvent);if(s&&(t&&0===e.button||!t)){const t=w.getState();ni.onPointerDown(e.nativeEvent,{autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:x,handleId:b,nodeId:k,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:I,isValidConnection:r||t.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?null===g||void 0===g||g(e):null===v||void 0===v||v(e)};return(0,c.jsx)("div",a(a({"data-handleid":b,"data-nodeid":k,"data-handlepos":o,"data-id":"".concat(E,"-").concat(k,"-").concat(b,"-").concat(n),className:u(["react-flow__handle","react-flow__handle-".concat(o),"nodrag",S,m,{source:!x,target:x,connectable:i,connectablestart:s,connectableend:d,clickconnecting:N,connectingfrom:D,connectingto:M,valid:_,connectionindicator:i&&(!O||A)&&(O||T?d:s)}]),onMouseDown:R,onTouchStart:R,onClick:C?e=>{const{onClickConnectStart:t,onClickConnectEnd:o,connectionClickStartHandle:i,connectionMode:a,isValidConnection:l,lib:c,rfId:u,nodeLookup:d,connection:h}=w.getState();if(!k||!i&&!s)return;if(!i)return null===t||void 0===t||t(e.nativeEvent,{nodeId:k,handleId:b,handleType:n}),void w.setState({connectionClickStartHandle:{nodeId:k,type:n,id:b}});const f=mr(e.target),p=r||l,{connection:m,isValid:g}=ni.isValid(e.nativeEvent,{handle:{nodeId:k,id:b,type:n},connectionMode:a,fromNodeId:i.nodeId,fromHandleId:i.id||null,fromType:i.type,isValidConnection:p,flowId:u,doc:f,lib:c,nodeLookup:d});g&&m&&I(m);const v=structuredClone(h);delete v.inProgress,v.toPosition=v.toHandle?v.toHandle.position:null,null===o||void 0===o||o(e,v),w.setState({connectionClickStartHandle:null})}:void 0,ref:t},y),{},{children:p}))}));const Zs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Gs={input:function(e){let{data:t,isConnectable:n,sourcePosition:o=Ao.Bottom}=e;return(0,c.jsxs)(c.Fragment,{children:[null===t||void 0===t?void 0:t.label,(0,c.jsx)(Xs,{type:"source",position:o,isConnectable:n})]})},default:function(e){let{data:t,isConnectable:n,targetPosition:o=Ao.Top,sourcePosition:r=Ao.Bottom}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Xs,{type:"target",position:o,isConnectable:n}),null===t||void 0===t?void 0:t.label,(0,c.jsx)(Xs,{type:"source",position:r,isConnectable:n})]})},output:function(e){let{data:t,isConnectable:n,targetPosition:o=Ao.Top}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Xs,{type:"target",position:o,isConnectable:n}),null===t||void 0===t?void 0:t.label]})},group:function(){return null}};const Js=e=>{const{width:t,height:n,x:o,y:r}=Io(e.nodeLookup,{filter:e=>!!e.selected});return{width:Qo(t)?t:null,height:Qo(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],") translate(").concat(o,"px,").concat(r,"px)")}};function Qs(t){let{onSelectionContextMenu:n,noPanClassName:o,disableKeyboardA11y:r}=t;const i=Vi(),{width:s,height:a,transformString:l,userSelectionActive:d}=Bi(Js,Ni),h=Ws(),f=(0,e.useRef)(null);if((0,e.useEffect)(()=>{var e;r||(null===(e=f.current)||void 0===e||e.focus({preventScroll:!0}))},[r]),$s({nodeRef:f}),d||!s||!a)return null;const p=n?e=>{const t=i.getState().nodes.filter(e=>e.selected);n(e,t)}:void 0;return(0,c.jsx)("div",{className:u(["react-flow__nodesselection","react-flow__container",o]),style:{transform:l},children:(0,c.jsx)("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:e=>{Object.prototype.hasOwnProperty.call(Zs,e.key)&&(e.preventDefault(),h({direction:Zs[e.key],factor:e.shiftKey?4:1}))},style:{width:s,height:a}})})}const ea="undefined"!==typeof window?window:void 0,ta=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function na(t){let{children:n,onPaneClick:o,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:l,paneClickDistance:u,deleteKeyCode:d,selectionKeyCode:h,selectionOnDrag:f,selectionMode:p,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:b,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:C,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:D,panOnDrag:M,defaultViewport:N,translateExtent:A,minZoom:O,maxZoom:T,preventScrolling:_,onSelectionContextMenu:j,noWheelClassName:P,noPanClassName:I,disableKeyboardA11y:R,onViewportChange:F,isControlledViewport:z}=t;const{nodesSelectionActive:L,userSelectionActive:B}=Bi(ta),V=fs(h,{target:ea}),H=fs(y,{target:ea}),$=H||M,W=H||C,U=f&&!0!==$,q=V||B||U;return function(t){let{deleteKeyCode:n,multiSelectionKeyCode:o}=t;const r=Vi(),{deleteElements:i}=Ts(),s=fs(n,{actInsideInputWithModifier:!1}),a=fs(o,{target:js});(0,e.useEffect)(()=>{if(s){const{edges:e,nodes:t}=r.getState();i({nodes:t.filter(_s),edges:e.filter(_s)}),r.setState({nodesSelectionActive:!1})}},[s]),(0,e.useEffect)(()=>{r.setState({multiSelectionActive:a})},[a])}({deleteKeyCode:d,multiSelectionKeyCode:v}),(0,c.jsx)(Rs,{onPaneContextMenu:a,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:k,panOnScroll:W,panOnScrollSpeed:S,panOnScrollMode:E,zoomOnDoubleClick:D,panOnDrag:!V&&$,defaultViewport:N,translateExtent:A,minZoom:O,maxZoom:T,zoomActivationKeyCode:b,preventScrolling:_,noWheelClassName:P,noPanClassName:I,onViewportChange:F,isControlledViewport:z,paneClickDistance:u,children:(0,c.jsxs)(Vs,{onSelectionStart:m,onSelectionEnd:g,onPaneClick:o,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:l,panOnDrag:$,isSelecting:!!q,selectionMode:p,selectionKeyPressed:V,selectionOnDrag:U,children:[n,L&&(0,c.jsx)(Qs,{onSelectionContextMenu:j,noPanClassName:I,disableKeyboardA11y:R})]})})}na.displayName="FlowRenderer";const oa=(0,e.memo)(na);function ra(t){const n=Bi((0,e.useCallback)((e=>t=>e?Ro(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(e=>e.id):Array.from(t.nodeLookup.keys()))(t),[t]),Ni);return n}const ia=e=>e.updateNodeInternals;function sa(t){var n,o,r;let{id:i,onClick:s,onMouseEnter:l,onMouseMove:d,onMouseLeave:h,onContextMenu:f,onDoubleClick:p,nodesDraggable:m,elementsSelectable:g,nodesConnectable:v,nodesFocusable:y,resizeObserver:b,noDragClassName:x,noPanClassName:w,disableKeyboardA11y:k,rfId:C,nodeTypes:S,nodeClickDistance:E,onError:D}=t;const{node:M,internals:N,isParent:A}=Bi(e=>{const t=e.nodeLookup.get(i),n=e.parentLookup.has(i);return{node:t,internals:t.internals,isParent:n}},Ni);let O=M.type||"default",T=(null===S||void 0===S?void 0:S[O])||Gs[O];void 0===T&&(null===D||void 0===D||D("003",lo(O)),O="default",T=Gs.default);const _=!!(M.draggable||m&&"undefined"===typeof M.draggable),j=!!(M.selectable||g&&"undefined"===typeof M.selectable),P=!!(M.connectable||v&&"undefined"===typeof M.connectable),I=!!(M.focusable||y&&"undefined"===typeof M.focusable),R=Vi(),F=cr(M),z=function(t){let{node:n,nodeType:o,hasDimensions:r,resizeObserver:i}=t;const s=Vi(),a=(0,e.useRef)(null),l=(0,e.useRef)(null),c=(0,e.useRef)(n.sourcePosition),u=(0,e.useRef)(n.targetPosition),d=(0,e.useRef)(o),h=r&&!!n.internals.handleBounds;return(0,e.useEffect)(()=>{!a.current||n.hidden||h&&l.current===a.current||(l.current&&(null===i||void 0===i||i.unobserve(l.current)),null===i||void 0===i||i.observe(a.current),l.current=a.current)},[h,n.hidden]),(0,e.useEffect)(()=>()=>{l.current&&(null===i||void 0===i||i.unobserve(l.current),l.current=null)},[]),(0,e.useEffect)(()=>{if(a.current){const e=d.current!==o,t=c.current!==n.sourcePosition,r=u.current!==n.targetPosition;(e||t||r)&&(d.current=o,c.current=n.sourcePosition,u.current=n.targetPosition,s.getState().updateNodeInternals(new Map([[n.id,{id:n.id,nodeElement:a.current,force:!0}]])))}},[n.id,o,n.sourcePosition,n.targetPosition]),a}({node:M,nodeType:O,hasDimensions:F,resizeObserver:b}),L=$s({nodeRef:z,disabled:M.hidden||!_,noDragClassName:x,handleSelector:M.dragHandle,nodeId:i,isSelectable:j,nodeClickDistance:E}),B=Ws();if(M.hidden)return null;const V=lr(M),H=function(e){var t,n,o,r,i,s,a,l,c,u;return void 0===e.internals.handleBounds?{width:null!==(i=null!==(s=e.width)&&void 0!==s?s:e.initialWidth)&&void 0!==i?i:null===(a=e.style)||void 0===a?void 0:a.width,height:null!==(l=null!==(c=e.height)&&void 0!==c?c:e.initialHeight)&&void 0!==l?l:null===(u=e.style)||void 0===u?void 0:u.height}:{width:null!==(t=e.width)&&void 0!==t?t:null===(n=e.style)||void 0===n?void 0:n.width,height:null!==(o=e.height)&&void 0!==o?o:null===(r=e.style)||void 0===r?void 0:r.height}}(M),$=j||_||s||l||d||h,W=l?e=>l(e,a({},N.userNode)):void 0,U=d?e=>d(e,a({},N.userNode)):void 0,q=h?e=>h(e,a({},N.userNode)):void 0,K=f?e=>f(e,a({},N.userNode)):void 0,Y=p?e=>p(e,a({},N.userNode)):void 0;return(0,c.jsx)("div",a(a({className:u(["react-flow__node","react-flow__node-".concat(O),{[w]:_},M.className,{selected:M.selected,selectable:j,parent:A,draggable:_,dragging:L}]),ref:z,style:a(a({zIndex:N.z,transform:"translate(".concat(N.positionAbsolute.x,"px,").concat(N.positionAbsolute.y,"px)"),pointerEvents:$?"all":"none",visibility:F?"visible":"hidden"},M.style),H),"data-id":i,"data-testid":"rf__node-".concat(i),onMouseEnter:W,onMouseMove:U,onMouseLeave:q,onContextMenu:K,onClick:e=>{const{selectNodesOnDrag:t,nodeDragThreshold:n}=R.getState();j&&(!t||!_||n>0)&&Hs({id:i,store:R,nodeRef:z}),s&&s(e,a({},N.userNode))},onDoubleClick:Y,onKeyDown:I?e=>{if(!vr(e.nativeEvent)&&!k)if(wo.includes(e.key)&&j){const t="Escape"===e.key;Hs({id:i,store:R,unselect:t,nodeRef:z})}else if(_&&M.selected&&Object.prototype.hasOwnProperty.call(Zs,e.key)){e.preventDefault();const{ariaLabelConfig:t}=R.getState();R.setState({ariaLiveMessage:t["node.a11yDescription.ariaLiveMessage"]({direction:e.key.replace("Arrow","").toLowerCase(),x:~~N.positionAbsolute.x,y:~~N.positionAbsolute.y})}),B({direction:Zs[e.key],factor:e.shiftKey?4:1})}}:void 0,tabIndex:I?0:void 0,onFocus:I?()=>{var e;if(k||null===(e=z.current)||void 0===e||!e.matches(":focus-visible"))return;const{transform:t,width:n,height:o,autoPanOnNodeFocus:r,setCenter:s}=R.getState();if(!r)return;Ro(new Map([[i,M]]),{x:0,y:0,width:n,height:o},t,!0).length>0||s(M.position.x+V.width/2,M.position.y+V.height/2,{zoom:t[2]})}:void 0,role:null!==(n=M.ariaRole)&&void 0!==n?n:I?"group":void 0,"aria-roledescription":"node","aria-describedby":k?void 0:"".concat(Wi,"-").concat(C),"aria-label":M.ariaLabel},M.domAttributes),{},{children:(0,c.jsx)(qs,{value:i,children:(0,c.jsx)(T,a({id:i,data:M.data,type:O,positionAbsoluteX:N.positionAbsolute.x,positionAbsoluteY:N.positionAbsolute.y,selected:null!==(o=M.selected)&&void 0!==o&&o,selectable:j,draggable:_,deletable:null===(r=M.deletable)||void 0===r||r,isConnectable:P,sourcePosition:M.sourcePosition,targetPosition:M.targetPosition,dragging:L,dragHandle:M.dragHandle,zIndex:N.z,parentId:M.parentId},V))})}))}const aa=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function la(t){const{nodesDraggable:n,nodesConnectable:o,nodesFocusable:r,elementsSelectable:i,onError:s}=Bi(aa,Ni),a=ra(t.onlyRenderVisibleElements),l=function(){const t=Bi(ia),[n]=(0,e.useState)(()=>"undefined"===typeof ResizeObserver?null:new ResizeObserver(e=>{const n=new Map;e.forEach(e=>{const t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),t(n)}));return(0,e.useEffect)(()=>()=>{null===n||void 0===n||n.disconnect()},[n]),n}();return(0,c.jsx)("div",{className:"react-flow__nodes",style:Ps,children:a.map(e=>(0,c.jsx)(sa,{id:e,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:l,nodesDraggable:n,nodesConnectable:o,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:t.nodeClickDistance,onError:s},e))})}la.displayName="NodeRenderer";const ca=(0,e.memo)(la);const ua={[No.Arrow]:e=>{let{color:t="none",strokeWidth:n=1}=e;return(0,c.jsx)("polyline",{style:{stroke:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"})},[No.ArrowClosed]:e=>{let{color:t="none",strokeWidth:n=1}=e;return(0,c.jsx)("polyline",{style:{stroke:t,fill:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}};const da=t=>{let{id:n,type:o,color:r,width:i=12.5,height:s=12.5,markerUnits:a="strokeWidth",strokeWidth:l,orient:u="auto-start-reverse"}=t;const d=function(t){const n=Vi();return(0,e.useMemo)(()=>{var e,o;return Object.prototype.hasOwnProperty.call(ua,t)?ua[t]:(null===(e=(o=n.getState()).onError)||void 0===e||e.call(o,"009",fo(t)),null)},[t])}(o);return d?(0,c.jsx)("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(i),markerHeight:"".concat(s),viewBox:"-10 -10 20 20",markerUnits:a,orient:u,refX:"0",refY:"0",children:(0,c.jsx)(d,{color:r,strokeWidth:l})}):null},ha=t=>{let{defaultColor:n,rfId:o}=t;const r=Bi(e=>e.edges),i=Bi(e=>e.defaultEdgeOptions),s=(0,e.useMemo)(()=>{const e=function(e,t){let{id:n,defaultColor:o,defaultMarkerStart:r,defaultMarkerEnd:i}=t;const s=new Set;return e.reduce((e,t)=>([t.markerStart||r,t.markerEnd||i].forEach(t=>{if(t&&"object"===typeof t){const r=Fr(t,n);s.has(r)||(e.push(a({id:r,color:t.color||o},t)),s.add(r))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}(r,{id:o,defaultColor:n,defaultMarkerStart:null===i||void 0===i?void 0:i.markerStart,defaultMarkerEnd:null===i||void 0===i?void 0:i.markerEnd});return e},[r,i,o,n]);return s.length?(0,c.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,c.jsx)("defs",{children:s.map(e=>(0,c.jsx)(da,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};ha.displayName="MarkerDefinitions";var fa=(0,e.memo)(ha);function pa(t){let{x:n,y:o,label:r,labelStyle:i,labelShowBg:s=!0,labelBgStyle:d,labelBgPadding:h=[2,4],labelBgBorderRadius:f=2,children:p,className:m}=t,g=l(t,_i);const[v,y]=(0,e.useState)({x:1,y:0,width:0,height:0}),b=u(["react-flow__edge-textwrapper",m]),x=(0,e.useRef)(null);return(0,e.useEffect)(()=>{if(x.current){const e=x.current.getBBox();y({x:e.x,y:e.y,width:e.width,height:e.height})}},[r]),r?(0,c.jsxs)("g",a(a({transform:"translate(".concat(n-v.width/2," ").concat(o-v.height/2,")"),className:b,visibility:v.width?"visible":"hidden"},g),{},{children:[s&&(0,c.jsx)("rect",{width:v.width+2*h[0],x:-h[0],y:-h[1],height:v.height+2*h[1],className:"react-flow__edge-textbg",style:d,rx:f,ry:f}),(0,c.jsx)("text",{className:"react-flow__edge-text",y:v.height/2,dy:"0.3em",ref:x,style:i,children:r}),p]})):null}pa.displayName="EdgeText";const ma=(0,e.memo)(pa);function ga(e){let{path:t,labelX:n,labelY:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,interactionWidth:p=20}=e,m=l(e,ji);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("path",a(a({},m),{},{d:t,fill:"none",className:u(["react-flow__edge-path",m.className])})),p&&(0,c.jsx)("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),r&&Qo(n)&&Qo(o)?(0,c.jsx)(ma,{x:n,y:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f}):null]})}function va(e){let{pos:t,x1:n,y1:o,x2:r,y2:i}=e;return t===Ao.Left||t===Ao.Right?[.5*(n+r),o]:[n,.5*(o+i)]}function ya(e){let{sourceX:t,sourceY:n,sourcePosition:o=Ao.Bottom,targetX:r,targetY:i,targetPosition:s=Ao.Top}=e;const[a,l]=va({pos:o,x1:t,y1:n,x2:r,y2:i}),[c,u]=va({pos:s,x1:r,y1:i,x2:t,y2:n}),[d,h,f,p]=wr({sourceX:t,sourceY:n,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return["M".concat(t,",").concat(n," C").concat(a,",").concat(l," ").concat(c,",").concat(u," ").concat(r,",").concat(i),d,h,f,p]}function ba(t){return(0,e.memo)(e=>{let{id:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,label:u,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:g,markerEnd:v,markerStart:y,interactionWidth:b}=e;const[x,w,k]=ya({sourceX:o,sourceY:r,sourcePosition:a,targetX:i,targetY:s,targetPosition:l}),C=t.isInternal?void 0:n;return(0,c.jsx)(ga,{id:C,path:x,labelX:w,labelY:k,label:u,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:g,markerEnd:v,markerStart:y,interactionWidth:b})})}const xa=ba({isInternal:!1}),wa=ba({isInternal:!0});function ka(t){return(0,e.memo)(e=>{let{id:n,sourceX:o,sourceY:r,targetX:i,targetY:s,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,sourcePosition:m=Ao.Bottom,targetPosition:g=Ao.Top,markerEnd:v,markerStart:y,pathOptions:b,interactionWidth:x}=e;const[w,k,C]=_r({sourceX:o,sourceY:r,sourcePosition:m,targetX:i,targetY:s,targetPosition:g,borderRadius:null===b||void 0===b?void 0:b.borderRadius,offset:null===b||void 0===b?void 0:b.offset}),S=t.isInternal?void 0:n;return(0,c.jsx)(ga,{id:S,path:w,labelX:k,labelY:C,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:v,markerStart:y,interactionWidth:x})})}xa.displayName="SimpleBezierEdge",wa.displayName="SimpleBezierEdgeInternal";const Ca=ka({isInternal:!1}),Sa=ka({isInternal:!0});function Ea(t){return(0,e.memo)(n=>{var o;let{id:r}=n,i=l(n,Pi);const s=t.isInternal?void 0:r;return(0,c.jsx)(Ca,a(a({},i),{},{id:s,pathOptions:(0,e.useMemo)(()=>{var e;return{borderRadius:0,offset:null===(e=i.pathOptions)||void 0===e?void 0:e.offset}},[null===(o=i.pathOptions)||void 0===o?void 0:o.offset])}))})}Ca.displayName="SmoothStepEdge",Sa.displayName="SmoothStepEdgeInternal";const Da=Ea({isInternal:!1}),Ma=Ea({isInternal:!0});function Na(t){return(0,e.memo)(e=>{let{id:n,sourceX:o,sourceY:r,targetX:i,targetY:s,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:g,interactionWidth:v}=e;const[y,b,x]=Nr({sourceX:o,sourceY:r,targetX:i,targetY:s}),w=t.isInternal?void 0:n;return(0,c.jsx)(ga,{id:w,path:y,labelX:b,labelY:x,label:a,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:g,interactionWidth:v})})}Da.displayName="StepEdge",Ma.displayName="StepEdgeInternal";const Aa=Na({isInternal:!1}),Oa=Na({isInternal:!0});function Ta(t){return(0,e.memo)(e=>{let{id:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a=Ao.Bottom,targetPosition:l=Ao.Top,label:u,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:g,markerEnd:v,markerStart:y,pathOptions:b,interactionWidth:x}=e;const[w,k,C]=Sr({sourceX:o,sourceY:r,sourcePosition:a,targetX:i,targetY:s,targetPosition:l,curvature:null===b||void 0===b?void 0:b.curvature}),S=t.isInternal?void 0:n;return(0,c.jsx)(ga,{id:S,path:w,labelX:k,labelY:C,label:u,labelStyle:d,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:g,markerEnd:v,markerStart:y,interactionWidth:x})})}Aa.displayName="StraightEdge",Oa.displayName="StraightEdgeInternal";const _a=Ta({isInternal:!1}),ja=Ta({isInternal:!0});_a.displayName="BezierEdge",ja.displayName="BezierEdgeInternal";const Pa={default:ja,straight:Oa,step:Ma,smoothstep:Sa,simplebezier:wa},Ia={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Ra=(e,t,n)=>n===Ao.Left?e-t:n===Ao.Right?e+t:e,Fa=(e,t,n)=>n===Ao.Top?e-t:n===Ao.Bottom?e+t:e,za="react-flow__edgeupdater";function La(e){let{position:t,centerX:n,centerY:o,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:a,type:l}=e;return(0,c.jsx)("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:a,className:u([za,"".concat(za,"-").concat(l)]),cx:Ra(n,r,t),cy:Fa(o,r,t),r:r,stroke:"transparent",fill:"transparent"})}function Ba(e){let{isReconnectable:t,reconnectRadius:n,edge:o,sourceX:r,sourceY:i,targetX:s,targetY:a,sourcePosition:l,targetPosition:u,onReconnect:d,onReconnectStart:h,onReconnectEnd:f,setReconnecting:p,setUpdateHover:m}=e;const g=Vi(),v=(e,t)=>{if(0!==e.button)return;const{autoPanOnConnect:n,domNode:r,isValidConnection:i,connectionMode:s,connectionRadius:a,lib:l,onConnectStart:c,onConnectEnd:u,cancelConnection:m,nodeLookup:v,rfId:y,panBy:b,updateConnection:x}=g.getState(),w="target"===t.type;ni.onPointerDown(e.nativeEvent,{autoPanOnConnect:n,connectionMode:s,connectionRadius:a,domNode:r,handleId:t.id,nodeId:t.nodeId,nodeLookup:v,isTarget:w,edgeUpdaterType:t.type,lib:l,flowId:y,cancelConnection:m,panBy:b,isValidConnection:i,onConnect:e=>null===d||void 0===d?void 0:d(o,e),onConnectStart:(n,r)=>{p(!0),null===h||void 0===h||h(e,o,t.type),null===c||void 0===c||c(n,r)},onConnectEnd:u,onReconnectEnd:(e,n)=>{p(!1),null===f||void 0===f||f(e,o,t.type,n)},updateConnection:x,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold})},y=()=>m(!0),b=()=>m(!1);return(0,c.jsxs)(c.Fragment,{children:[(!0===t||"source"===t)&&(0,c.jsx)(La,{position:l,centerX:r,centerY:i,radius:n,onMouseDown:e=>{var t;return v(e,{nodeId:o.target,id:null!==(t=o.targetHandle)&&void 0!==t?t:null,type:"target"})},onMouseEnter:y,onMouseOut:b,type:"source"}),(!0===t||"target"===t)&&(0,c.jsx)(La,{position:u,centerX:s,centerY:a,radius:n,onMouseDown:e=>{var t;return v(e,{nodeId:o.source,id:null!==(t=o.sourceHandle)&&void 0!==t?t:null,type:"source"})},onMouseEnter:y,onMouseOut:b,type:"target"})]})}function Va(t){var n,o;let{id:r,edgesFocusable:i,edgesReconnectable:s,elementsSelectable:l,onClick:d,onDoubleClick:h,onContextMenu:f,onMouseEnter:p,onMouseMove:m,onMouseLeave:g,reconnectRadius:v,onReconnect:y,onReconnectStart:b,onReconnectEnd:x,rfId:w,edgeTypes:k,noPanClassName:C,onError:S,disableKeyboardA11y:E}=t,D=Bi(e=>e.edgeLookup.get(r));const M=Bi(e=>e.defaultEdgeOptions);D=M?a(a({},M),D):D;let N=D.type||"default",A=(null===k||void 0===k?void 0:k[N])||Pa[N];void 0===A&&(null===S||void 0===S||S("011",go(N)),N="default",A=Pa.default);const O=!!(D.focusable||i&&"undefined"===typeof D.focusable),T="undefined"!==typeof y&&(D.reconnectable||s&&"undefined"===typeof D.reconnectable),_=!!(D.selectable||l&&"undefined"===typeof D.selectable),j=(0,e.useRef)(null),[P,I]=(0,e.useState)(!1),[R,F]=(0,e.useState)(!1),z=Vi(),{zIndex:L,sourceX:B,sourceY:V,targetX:H,targetY:$,sourcePosition:W,targetPosition:U}=Bi((0,e.useCallback)(e=>{const t=e.nodeLookup.get(D.source),n=e.nodeLookup.get(D.target);if(!t||!n)return a({zIndex:D.zIndex},Ia);const o=function(e){var t,n,o,r;const{sourceNode:i,targetNode:s}=e;if(!jr(i)||!jr(s))return null;const a=i.internals.handleBounds||Pr(i.handles),l=s.internals.handleBounds||Pr(s.handles),c=Rr(null!==(t=null===a||void 0===a?void 0:a.source)&&void 0!==t?t:[],e.sourceHandle),u=Rr(e.connectionMode===Co.Strict?null!==(n=null===l||void 0===l?void 0:l.target)&&void 0!==n?n:[]:(null!==(o=null===l||void 0===l?void 0:l.target)&&void 0!==o?o:[]).concat(null!==(r=null===l||void 0===l?void 0:l.source)&&void 0!==r?r:[]),e.targetHandle);var d;if(!c||!u)return null===(d=e.onError)||void 0===d||d.call(e,"008",po(c?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const h=(null===c||void 0===c?void 0:c.position)||Ao.Bottom,f=(null===u||void 0===u?void 0:u.position)||Ao.Top,p=Ir(i,c,h),m=Ir(s,u,f);return{sourceX:p.x,sourceY:p.y,targetX:m.x,targetY:m.y,sourcePosition:h,targetPosition:f}}({id:r,sourceNode:t,targetNode:n,sourceHandle:D.sourceHandle||null,targetHandle:D.targetHandle||null,connectionMode:e.connectionMode,onError:S}),i=function(e){let{sourceNode:t,targetNode:n,selected:o=!1,zIndex:r,elevateOnSelect:i=!1}=e;return void 0!==r?r:(i&&o?1e3:0)+Math.max(t.parentId?t.internals.z:0,n.parentId?n.internals.z:0)}({selected:D.selected,zIndex:D.zIndex,sourceNode:t,targetNode:n,elevateOnSelect:e.elevateEdgesOnSelect});return a({zIndex:i},o||Ia)},[D.source,D.target,D.sourceHandle,D.targetHandle,D.selected,D.zIndex]),Ni),q=(0,e.useMemo)(()=>D.markerStart?"url('#".concat(Fr(D.markerStart,w),"')"):void 0,[D.markerStart,w]),K=(0,e.useMemo)(()=>D.markerEnd?"url('#".concat(Fr(D.markerEnd,w),"')"):void 0,[D.markerEnd,w]);if(D.hidden||null===B||null===V||null===H||null===$)return null;const Y=h?e=>{h(e,a({},D))}:void 0,X=f?e=>{f(e,a({},D))}:void 0,Z=p?e=>{p(e,a({},D))}:void 0,G=m?e=>{m(e,a({},D))}:void 0,J=g?e=>{g(e,a({},D))}:void 0;return(0,c.jsx)("svg",{style:{zIndex:L},children:(0,c.jsxs)("g",a(a({className:u(["react-flow__edge","react-flow__edge-".concat(N),D.className,C,{selected:D.selected,animated:D.animated,inactive:!_&&!d,updating:P,selectable:_}]),onClick:e=>{const{addSelectedEdges:t,unselectNodesAndEdges:n,multiSelectionActive:o}=z.getState();var i;_&&(z.setState({nodesSelectionActive:!1}),D.selected&&o?(n({nodes:[],edges:[D]}),null===(i=j.current)||void 0===i||i.blur()):t([r]));d&&d(e,D)},onDoubleClick:Y,onContextMenu:X,onMouseEnter:Z,onMouseMove:G,onMouseLeave:J,onKeyDown:O?e=>{if(!E&&wo.includes(e.key)&&_){const{unselectNodesAndEdges:n,addSelectedEdges:o}=z.getState();var t;if("Escape"===e.key)null===(t=j.current)||void 0===t||t.blur(),n({edges:[D]});else o([r])}}:void 0,tabIndex:O?0:void 0,role:null!==(n=D.ariaRole)&&void 0!==n?n:O?"group":"img","aria-roledescription":"edge","data-id":r,"data-testid":"rf__edge-".concat(r),"aria-label":null===D.ariaLabel?void 0:D.ariaLabel||"Edge from ".concat(D.source," to ").concat(D.target),"aria-describedby":O?"".concat(Ui,"-").concat(w):void 0,ref:j},D.domAttributes),{},{children:[!R&&(0,c.jsx)(A,{id:r,source:D.source,target:D.target,type:D.type,selected:D.selected,animated:D.animated,selectable:_,deletable:null===(o=D.deletable)||void 0===o||o,label:D.label,labelStyle:D.labelStyle,labelShowBg:D.labelShowBg,labelBgStyle:D.labelBgStyle,labelBgPadding:D.labelBgPadding,labelBgBorderRadius:D.labelBgBorderRadius,sourceX:B,sourceY:V,targetX:H,targetY:$,sourcePosition:W,targetPosition:U,data:D.data,style:D.style,sourceHandleId:D.sourceHandle,targetHandleId:D.targetHandle,markerStart:q,markerEnd:K,pathOptions:"pathOptions"in D?D.pathOptions:void 0,interactionWidth:D.interactionWidth}),T&&(0,c.jsx)(Ba,{edge:D,isReconnectable:T,reconnectRadius:v,onReconnect:y,onReconnectStart:b,onReconnectEnd:x,sourceX:B,sourceY:V,targetX:H,targetY:$,sourcePosition:W,targetPosition:U,setUpdateHover:I,setReconnecting:F})]}))})}const Ha=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function $a(t){let{defaultMarkerColor:n,onlyRenderVisibleElements:o,rfId:r,edgeTypes:i,noPanClassName:s,onReconnect:a,onEdgeContextMenu:l,onEdgeMouseEnter:u,onEdgeMouseMove:d,onEdgeMouseLeave:h,onEdgeClick:f,reconnectRadius:p,onEdgeDoubleClick:m,onReconnectStart:g,onReconnectEnd:v,disableKeyboardA11y:y}=t;const{edgesFocusable:b,edgesReconnectable:x,elementsSelectable:w,onError:k}=Bi(Ha,Ni),C=(S=o,Bi((0,e.useCallback)(e=>{if(!S)return e.edges.map(e=>e.id);const t=[];if(e.width&&e.height)for(const n of e.edges){const o=e.nodeLookup.get(n.source),r=e.nodeLookup.get(n.target);o&&r&&Dr({sourceNode:o,targetNode:r,width:e.width,height:e.height,transform:e.transform})&&t.push(n.id)}return t},[S]),Ni));var S;return(0,c.jsxs)("div",{className:"react-flow__edges",children:[(0,c.jsx)(fa,{defaultColor:n,rfId:r}),C.map(e=>(0,c.jsx)(Va,{id:e,edgesFocusable:b,edgesReconnectable:x,elementsSelectable:w,noPanClassName:s,onReconnect:a,onContextMenu:l,onMouseEnter:u,onMouseMove:d,onMouseLeave:h,onClick:f,reconnectRadius:p,onDoubleClick:m,onReconnectStart:g,onReconnectEnd:v,rfId:r,onError:k,edgeTypes:i,disableKeyboardA11y:y},e))]})}$a.displayName="EdgeRenderer";const Wa=(0,e.memo)($a),Ua=e=>"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")");function qa(e){let{children:t}=e;const n=Bi(Ua);return(0,c.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:n},children:t})}const Ka=e=>{var t;return null===(t=e.panZoom)||void 0===t?void 0:t.syncViewport};function Ya(e){return e.connection.inProgress?a(a({},e.connection),{},{to:nr(e.connection.to,e.transform)}):a({},e.connection)}function Xa(e){const t=function(e){if(e)return t=>{const n=Ya(t);return e(n)};return Ya}(e);return Bi(t,Ni)}const Za=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ga(e){let{containerStyle:t,style:n,type:o,component:r}=e;const{nodesConnectable:i,width:s,height:a,isValid:l,inProgress:d}=Bi(Za,Ni);return!!(s&&i&&d)?(0,c.jsx)("svg",{style:t,width:s,height:a,className:"react-flow__connectionline react-flow__container",children:(0,c.jsx)("g",{className:u(["react-flow__connection",To(l)]),children:(0,c.jsx)(Ja,{style:n,type:o,CustomComponent:r,isValid:l})})}):null}const Ja=e=>{let{style:t,type:n=Mo.Bezier,CustomComponent:o,isValid:r}=e;const{inProgress:i,from:s,fromNode:l,fromHandle:u,fromPosition:d,to:h,toNode:f,toHandle:p,toPosition:m}=Xa();if(!i)return;if(o)return(0,c.jsx)(o,{connectionLineType:n,connectionLineStyle:t,fromNode:l,fromHandle:u,fromX:s.x,fromY:s.y,toX:h.x,toY:h.y,fromPosition:d,toPosition:m,connectionStatus:To(r),toNode:f,toHandle:p});let g="";const v={sourceX:s.x,sourceY:s.y,sourcePosition:d,targetX:h.x,targetY:h.y,targetPosition:m};switch(n){case Mo.Bezier:[g]=Sr(v);break;case Mo.SimpleBezier:[g]=ya(v);break;case Mo.Step:[g]=_r(a(a({},v),{},{borderRadius:0}));break;case Mo.SmoothStep:[g]=_r(v);break;default:[g]=Nr(v)}return(0,c.jsx)("path",{d:g,fill:"none",className:"react-flow__connection-path",style:t})};Ja.displayName="ConnectionLine";const Qa={};function el(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qa;(0,e.useRef)(t),Vi();(0,e.useEffect)(()=>{},[t])}function tl(t){let{nodeTypes:n,edgeTypes:o,onInit:r,onNodeClick:i,onEdgeClick:s,onNodeDoubleClick:a,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:p,onSelectionStart:m,onSelectionEnd:g,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:x,selectionKeyCode:w,selectionOnDrag:k,selectionMode:C,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:D,deleteKeyCode:M,onlyRenderVisibleElements:N,elementsSelectable:A,defaultViewport:O,translateExtent:T,minZoom:_,maxZoom:j,preventScrolling:P,defaultMarkerColor:I,zoomOnScroll:R,zoomOnPinch:F,panOnScroll:z,panOnScrollSpeed:L,panOnScrollMode:B,zoomOnDoubleClick:V,panOnDrag:H,onPaneClick:$,onPaneMouseEnter:W,onPaneMouseMove:U,onPaneMouseLeave:q,onPaneScroll:K,onPaneContextMenu:Y,paneClickDistance:X,nodeClickDistance:Z,onEdgeContextMenu:G,onEdgeMouseEnter:J,onEdgeMouseMove:Q,onEdgeMouseLeave:ee,reconnectRadius:te,onReconnect:ne,onReconnectStart:oe,onReconnectEnd:re,noDragClassName:ie,noWheelClassName:se,noPanClassName:ae,disableKeyboardA11y:le,nodeExtent:ce,rfId:ue,viewport:de,onViewportChange:he}=t;return el(n),el(o),Vi(),(0,e.useRef)(!1),(0,e.useEffect)(()=>{},[]),function(t){const n=Ts(),o=(0,e.useRef)(!1);(0,e.useEffect)(()=>{!o.current&&n.viewportInitialized&&t&&(setTimeout(()=>t(n),1),o.current=!0)},[t,n.viewportInitialized])}(r),function(t){const n=Bi(Ka),o=Vi();(0,e.useEffect)(()=>{t&&(null===n||void 0===n||n(t),o.setState({transform:[t.x,t.y,t.zoom]}))},[t,n])}(de),(0,c.jsx)(oa,{onPaneClick:$,onPaneMouseEnter:W,onPaneMouseMove:U,onPaneMouseLeave:q,onPaneContextMenu:Y,onPaneScroll:K,paneClickDistance:X,deleteKeyCode:M,selectionKeyCode:w,selectionOnDrag:k,selectionMode:C,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:S,panActivationKeyCode:E,zoomActivationKeyCode:D,elementsSelectable:A,zoomOnScroll:R,zoomOnPinch:F,zoomOnDoubleClick:V,panOnScroll:z,panOnScrollSpeed:L,panOnScrollMode:B,panOnDrag:H,defaultViewport:O,translateExtent:T,minZoom:_,maxZoom:j,onSelectionContextMenu:p,preventScrolling:P,noDragClassName:ie,noWheelClassName:se,noPanClassName:ae,disableKeyboardA11y:le,onViewportChange:he,isControlledViewport:!!de,children:(0,c.jsxs)(qa,{children:[(0,c.jsx)(Wa,{edgeTypes:o,onEdgeClick:s,onEdgeDoubleClick:l,onReconnect:ne,onReconnectStart:oe,onReconnectEnd:re,onlyRenderVisibleElements:N,onEdgeContextMenu:G,onEdgeMouseEnter:J,onEdgeMouseMove:Q,onEdgeMouseLeave:ee,reconnectRadius:te,defaultMarkerColor:I,noPanClassName:ae,disableKeyboardA11y:le,rfId:ue}),(0,c.jsx)(Ga,{style:y,type:v,component:b,containerStyle:x}),(0,c.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,c.jsx)(ca,{nodeTypes:n,onNodeClick:i,onNodeDoubleClick:a,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:f,nodeClickDistance:Z,onlyRenderVisibleElements:N,noPanClassName:ae,noDragClassName:ie,disableKeyboardA11y:le,nodeExtent:ce,rfId:ue}),(0,c.jsx)("div",{className:"react-flow__viewport-portal"})]})})}tl.displayName="GraphView";const nl=(0,e.memo)(tl),ol=function(){var e,t;let{nodes:n,edges:o,defaultNodes:r,defaultEdges:i,width:s,height:l,fitView:c,fitViewOptions:u,minZoom:d=.5,maxZoom:h=2,nodeOrigin:f,nodeExtent:p}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const m=new Map,g=new Map,v=new Map,y=new Map,b=null!==(e=null!==i&&void 0!==i?i:o)&&void 0!==e?e:[],x=null!==(t=null!==r&&void 0!==r?r:n)&&void 0!==t?t:[],w=null!==f&&void 0!==f?f:[0,0],k=null!==p&&void 0!==p?p:xo;qr(v,y,b);const C=Vr(x,m,g,{nodeOrigin:w,nodeExtent:k,elevateNodesOnSelect:!1});let S=[0,0,1];if(c&&s&&l){var E;const e=Io(m,{filter:e=>!(!e.width&&!e.initialWidth||!e.height&&!e.initialHeight)}),{x:t,y:n,zoom:o}=ir(e,s,l,d,h,null!==(E=null===u||void 0===u?void 0:u.padding)&&void 0!==E?E:.1);S=[t,n,o]}return{rfId:"1",width:0,height:0,transform:S,nodes:x,nodesInitialized:C,nodeLookup:m,parentLookup:g,edges:b,edgeLookup:y,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==r,hasDefaultEdges:void 0!==i,panZoom:null,minZoom:d,maxZoom:h,translateExtent:xo,nodeExtent:k,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Co.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:w,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:null!==c&&void 0!==c&&c,fitViewOptions:u,fitViewResolver:null,connection:a({},Do),connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:er,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:ko}},rl=e=>{let{nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:l,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:h,nodeExtent:f}=e;return p=(e,p)=>{async function m(){const{nodeLookup:t,panZoom:n,fitViewOptions:o,fitViewResolver:r,width:i,height:s,minZoom:a,maxZoom:l}=p();n&&(await Fo({nodes:t,width:i,height:s,panZoom:n,minZoom:a,maxZoom:l},o),null===r||void 0===r||r.resolve(!0),e({fitViewResolver:null}))}return a(a({},ol({nodes:t,edges:n,width:i,height:s,fitView:l,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:h,nodeExtent:f,defaultNodes:o,defaultEdges:r})),{},{setNodes:t=>{const{nodeLookup:n,parentLookup:o,nodeOrigin:r,elevateNodesOnSelect:i,fitViewQueued:s}=p(),a=Vr(t,n,o,{nodeOrigin:r,nodeExtent:f,elevateNodesOnSelect:i,checkEquality:!0});s&&a?(m(),e({nodes:t,nodesInitialized:a,fitViewQueued:!1,fitViewOptions:void 0})):e({nodes:t,nodesInitialized:a})},setEdges:t=>{const{connectionLookup:n,edgeLookup:o}=p();qr(n,o,t),e({edges:t})},setDefaultNodesAndEdges:(t,n)=>{if(t){const{setNodes:n}=p();n(t),e({hasDefaultNodes:!0})}if(n){const{setEdges:t}=p();t(n),e({hasDefaultEdges:!0})}},updateNodeInternals:t=>{const{triggerNodeChanges:n,nodeLookup:o,parentLookup:r,domNode:i,nodeOrigin:s,nodeExtent:l,debug:c,fitViewQueued:u}=p(),{changes:d,updatedInternals:h}=function(e,t,n,o,r,i){const s=null===o||void 0===o?void 0:o.querySelector(".xyflow__viewport");let l=!1;if(!s)return{changes:[],updatedInternals:l};const c=[],u=window.getComputedStyle(s),{m22:d}=new window.DOMMatrixReadOnly(u.transform),h=[];for(const f of e.values()){const e=t.get(f.id);if(!e)continue;if(e.hidden){t.set(e.id,a(a({},e),{},{internals:a(a({},e.internals),{},{handleBounds:void 0})})),l=!0;continue}const o=pr(f.nodeElement),s=e.measured.width!==o.width||e.measured.height!==o.height;if(o.width&&o.height&&(s||!e.internals.handleBounds||f.force)){const u=f.nodeElement.getBoundingClientRect(),p=ar(e.extent)?e.extent:i;let{positionAbsolute:m}=e.internals;e.parentId&&"parent"===e.extent?m=Ho(m,o,t.get(e.parentId)):p&&(m=Vo(m,p,o));const g=a(a({},e),{},{measured:o,internals:a(a({},e.internals),{},{positionAbsolute:m,handleBounds:{source:xr("source",f.nodeElement,u,d,e.id),target:xr("target",f.nodeElement,u,d,e.id)}})});t.set(e.id,g),e.parentId&&Hr(g,t,n,{nodeOrigin:r}),l=!0,s&&(c.push({id:e.id,type:"dimensions",dimensions:o}),e.expandParent&&e.parentId&&h.push({id:e.id,parentId:e.parentId,rect:Yo(g,r)}))}}if(h.length>0){const e=Wr(h,t,n,r);c.push(...e)}return{changes:c,updatedInternals:l}}(t,o,r,i,s,l);h&&(function(e,t,n){const o=Br(zr,n);for(const r of e.values())if(r.parentId)Hr(r,e,t,o);else{const e=Po(r,o.nodeOrigin),t=ar(r.extent)?r.extent:o.nodeExtent,n=Vo(e,t,lr(r));r.internals.positionAbsolute=n}}(o,r,{nodeOrigin:s,nodeExtent:l}),u?(m(),e({fitViewQueued:!1,fitViewOptions:void 0})):e({}),(null===d||void 0===d?void 0:d.length)>0&&(c&&console.log("React Flow: trigger node changes",d),null===n||void 0===n||n(d)))},updateNodePositions:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[],o=[],{nodeLookup:r,triggerNodeChanges:i}=p();for(const[c,u]of e){const e=r.get(c),i=!!(null!==e&&void 0!==e&&e.expandParent&&null!==e&&void 0!==e&&e.parentId&&null!==u&&void 0!==u&&u.position),d={id:c,type:"position",position:i?{x:Math.max(0,u.position.x),y:Math.max(0,u.position.y)}:u.position,dragging:t};var s,l;i&&e.parentId&&n.push({id:c,parentId:e.parentId,rect:a(a({},u.internals.positionAbsolute),{},{width:null!==(s=u.measured.width)&&void 0!==s?s:0,height:null!==(l=u.measured.height)&&void 0!==l?l:0})}),o.push(d)}if(n.length>0){const{parentLookup:e,nodeOrigin:t}=p(),i=Wr(n,r,e,t);o.push(...i)}i(o)},triggerNodeChanges:e=>{const{onNodesChange:t,setNodes:n,nodes:o,hasDefaultNodes:r,debug:i}=p();null!==e&&void 0!==e&&e.length&&(r&&n(ys(e,o)),i&&console.log("React Flow: trigger node changes",e),null===t||void 0===t||t(e))},triggerEdgeChanges:e=>{const{onEdgesChange:t,setEdges:n,edges:o,hasDefaultEdges:r,debug:i}=p();null!==e&&void 0!==e&&e.length&&(r&&n(bs(e,o)),i&&console.log("React Flow: trigger edge changes",e),null===t||void 0===t||t(e))},addSelectedNodes:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=p();t?r(e.map(e=>xs(e,!0))):(r(ws(o,new Set([...e]),!0)),i(ws(n)))},addSelectedEdges:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=p();t?i(e.map(e=>xs(e,!0))):(i(ws(n,new Set([...e]))),r(ws(o,new Set,!0)))},unselectNodesAndEdges:function(){let{nodes:e,edges:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{edges:n,nodes:o,nodeLookup:r,triggerNodeChanges:i,triggerEdgeChanges:s}=p(),a=t||n,l=(e||o).map(e=>{const t=r.get(e.id);return t&&(t.selected=!1),xs(e.id,!1)}),c=a.map(e=>xs(e.id,!1));i(l),s(c)},setMinZoom:t=>{const{panZoom:n,maxZoom:o}=p();null===n||void 0===n||n.setScaleExtent([t,o]),e({minZoom:t})},setMaxZoom:t=>{const{panZoom:n,minZoom:o}=p();null===n||void 0===n||n.setScaleExtent([o,t]),e({maxZoom:t})},setTranslateExtent:t=>{var n;null===(n=p().panZoom)||void 0===n||n.setTranslateExtent(t),e({translateExtent:t})},setPaneClickDistance:e=>{var t;null===(t=p().panZoom)||void 0===t||t.setClickDistance(e)},resetSelectedElements:()=>{const{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:o,elementsSelectable:r}=p();if(!r)return;const i=t.reduce((e,t)=>t.selected?[...e,xs(t.id,!1)]:e,[]),s=e.reduce((e,t)=>t.selected?[...e,xs(t.id,!1)]:e,[]);n(i),o(s)},setNodeExtent:t=>{const{nodes:n,nodeLookup:o,parentLookup:r,nodeOrigin:i,elevateNodesOnSelect:s,nodeExtent:a}=p();t[0][0]===a[0][0]&&t[0][1]===a[0][1]&&t[1][0]===a[1][0]&&t[1][1]===a[1][1]||(Vr(n,o,r,{nodeOrigin:i,nodeExtent:t,elevateNodesOnSelect:s,checkEquality:!1}),e({nodeExtent:t}))},panBy:e=>{const{transform:t,width:n,height:o,panZoom:r,translateExtent:i}=p();return async function(e){let{delta:t,panZoom:n,transform:o,translateExtent:r,width:i,height:s}=e;if(!n||!t.x&&!t.y)return Promise.resolve(!1);const a=await n.setViewportConstrained({x:o[0]+t.x,y:o[1]+t.y,zoom:o[2]},[[0,0],[i,s]],r),l=!!a&&(a.x!==o[0]||a.y!==o[1]||a.k!==o[2]);return Promise.resolve(l)}({delta:e,panZoom:r,transform:t,translateExtent:i,width:n,height:o})},setCenter:async(e,t,n)=>{const{width:o,height:r,maxZoom:i,panZoom:s}=p();if(!s)return Promise.resolve(!1);const a="undefined"!==typeof(null===n||void 0===n?void 0:n.zoom)?n.zoom:i;return await s.setViewport({x:o/2-e*a,y:r/2-t*a,zoom:a},{duration:null===n||void 0===n?void 0:n.duration,ease:null===n||void 0===n?void 0:n.ease,interpolate:null===n||void 0===n?void 0:n.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{e({connection:a({},Do)})},updateConnection:t=>{e({connection:t})},reset:()=>e(a({},ol()))})},m=Object.is,p?Mi(p,m):Mi;var p,m};function il(t){let{initialNodes:n,initialEdges:o,defaultNodes:r,defaultEdges:i,initialWidth:s,initialHeight:a,initialMinZoom:l,initialMaxZoom:u,initialFitViewOptions:d,fitView:h,nodeOrigin:f,nodeExtent:p,children:m}=t;const[g]=(0,e.useState)(()=>rl({nodes:n,edges:o,defaultNodes:r,defaultEdges:i,width:s,height:a,fitView:h,minZoom:l,maxZoom:u,fitViewOptions:d,nodeOrigin:f,nodeExtent:p}));return(0,c.jsx)(zi,{value:g,children:(0,c.jsx)(As,{children:m})})}function sl(t){let{children:n,nodes:o,edges:r,defaultNodes:i,defaultEdges:s,width:a,height:l,fitView:u,fitViewOptions:d,minZoom:h,maxZoom:f,nodeOrigin:p,nodeExtent:m}=t;return(0,e.useContext)(Fi)?(0,c.jsx)(c.Fragment,{children:n}):(0,c.jsx)(il,{initialNodes:o,initialEdges:r,defaultNodes:i,defaultEdges:s,initialWidth:a,initialHeight:l,fitView:u,initialFitViewOptions:d,initialMinZoom:h,initialMaxZoom:f,nodeOrigin:p,nodeExtent:m,children:n})}const al={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var ll=Es(function(t,n){let{nodes:o,edges:r,defaultNodes:i,defaultEdges:s,className:d,nodeTypes:h,edgeTypes:f,onNodeClick:p,onEdgeClick:m,onInit:g,onMove:v,onMoveStart:y,onMoveEnd:b,onConnect:x,onConnectStart:w,onConnectEnd:k,onClickConnectStart:C,onClickConnectEnd:S,onNodeMouseEnter:E,onNodeMouseMove:D,onNodeMouseLeave:M,onNodeContextMenu:N,onNodeDoubleClick:A,onNodeDragStart:O,onNodeDrag:T,onNodeDragStop:_,onNodesDelete:j,onEdgesDelete:P,onDelete:I,onSelectionChange:R,onSelectionDragStart:F,onSelectionDrag:z,onSelectionDragStop:L,onSelectionContextMenu:B,onSelectionStart:V,onSelectionEnd:H,onBeforeDelete:$,connectionMode:W,connectionLineType:U=Mo.Bezier,connectionLineStyle:q,connectionLineComponent:K,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:G=!1,selectionMode:J=Eo.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:ee=(sr()?"Meta":"Control"),zoomActivationKeyCode:te=(sr()?"Meta":"Control"),snapToGrid:ne,snapGrid:oe,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ie,nodesDraggable:se,autoPanOnNodeFocus:ae,nodesConnectable:le,nodesFocusable:ce,nodeOrigin:ue=is,edgesFocusable:de,edgesReconnectable:he,elementsSelectable:fe=!0,defaultViewport:pe=ss,minZoom:me=.5,maxZoom:ge=2,translateExtent:ve=xo,preventScrolling:ye=!0,nodeExtent:be,defaultMarkerColor:xe="#b1b1b7",zoomOnScroll:we=!0,zoomOnPinch:ke=!0,panOnScroll:Ce=!1,panOnScrollSpeed:Se=.5,panOnScrollMode:Ee=So.Free,zoomOnDoubleClick:De=!0,panOnDrag:Me=!0,onPaneClick:Ne,onPaneMouseEnter:Ae,onPaneMouseMove:Oe,onPaneMouseLeave:Te,onPaneScroll:_e,onPaneContextMenu:je,paneClickDistance:Pe=0,nodeClickDistance:Ie=0,children:Re,onReconnect:Fe,onReconnectStart:ze,onReconnectEnd:Le,onEdgeContextMenu:Be,onEdgeDoubleClick:Ve,onEdgeMouseEnter:He,onEdgeMouseMove:$e,onEdgeMouseLeave:We,reconnectRadius:Ue=10,onNodesChange:qe,onEdgesChange:Ke,noDragClassName:Ye="nodrag",noWheelClassName:Xe="nowheel",noPanClassName:Ze="nopan",fitView:Ge,fitViewOptions:Je,connectOnClick:Qe,attributionPosition:et,proOptions:tt,defaultEdgeOptions:nt,elevateNodesOnSelect:ot,elevateEdgesOnSelect:rt,disableKeyboardA11y:it=!1,autoPanOnConnect:st,autoPanOnNodeDrag:at,autoPanSpeed:lt,connectionRadius:ct,isValidConnection:ut,onError:dt,style:ht,id:ft,nodeDragThreshold:pt,connectionDragThreshold:mt,viewport:gt,onViewportChange:vt,width:yt,height:bt,colorMode:xt="light",debug:wt,onScroll:kt,ariaLabelConfig:Ct}=t,St=l(t,Ii);const Et=ft||"1",Dt=function(t){var n;const[o,r]=(0,e.useState)("system"===t?null:t);return(0,e.useEffect)(()=>{if("system"!==t)return void r(t);const e=ds(),n=()=>r(null!==e&&void 0!==e&&e.matches?"dark":"light");return n(),null===e||void 0===e||e.addEventListener("change",n),()=>{null===e||void 0===e||e.removeEventListener("change",n)}},[t]),null!==o?o:null!==(n=ds())&&void 0!==n&&n.matches?"dark":"light"}(xt),Mt=(0,e.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),null===kt||void 0===kt||kt(e)},[kt]);return(0,c.jsx)("div",a(a({"data-testid":"rf__wrapper"},St),{},{onScroll:Mt,style:a(a({},ht),al),ref:n,className:u(["react-flow",d,Dt]),id:ft,role:"application",children:(0,c.jsxs)(sl,{nodes:o,edges:r,width:yt,height:bt,fitView:Ge,fitViewOptions:Je,minZoom:me,maxZoom:ge,nodeOrigin:ue,nodeExtent:be,children:[(0,c.jsx)(nl,{onInit:g,onNodeClick:p,onEdgeClick:m,onNodeMouseEnter:E,onNodeMouseMove:D,onNodeMouseLeave:M,onNodeContextMenu:N,onNodeDoubleClick:A,nodeTypes:h,edgeTypes:f,connectionLineType:U,connectionLineStyle:q,connectionLineComponent:K,connectionLineContainerStyle:Y,selectionKeyCode:Z,selectionOnDrag:G,selectionMode:J,deleteKeyCode:X,multiSelectionKeyCode:ee,panActivationKeyCode:Q,zoomActivationKeyCode:te,onlyRenderVisibleElements:re,defaultViewport:pe,translateExtent:ve,minZoom:me,maxZoom:ge,preventScrolling:ye,zoomOnScroll:we,zoomOnPinch:ke,zoomOnDoubleClick:De,panOnScroll:Ce,panOnScrollSpeed:Se,panOnScrollMode:Ee,panOnDrag:Me,onPaneClick:Ne,onPaneMouseEnter:Ae,onPaneMouseMove:Oe,onPaneMouseLeave:Te,onPaneScroll:_e,onPaneContextMenu:je,paneClickDistance:Pe,nodeClickDistance:Ie,onSelectionContextMenu:B,onSelectionStart:V,onSelectionEnd:H,onReconnect:Fe,onReconnectStart:ze,onReconnectEnd:Le,onEdgeContextMenu:Be,onEdgeDoubleClick:Ve,onEdgeMouseEnter:He,onEdgeMouseMove:$e,onEdgeMouseLeave:We,reconnectRadius:Ue,defaultMarkerColor:xe,noDragClassName:Ye,noWheelClassName:Xe,noPanClassName:Ze,rfId:Et,disableKeyboardA11y:it,nodeExtent:be,viewport:gt,onViewportChange:vt}),(0,c.jsx)(us,{nodes:o,edges:r,defaultNodes:i,defaultEdges:s,onConnect:x,onConnectStart:w,onConnectEnd:k,onClickConnectStart:C,onClickConnectEnd:S,nodesDraggable:se,autoPanOnNodeFocus:ae,nodesConnectable:le,nodesFocusable:ce,edgesFocusable:de,edgesReconnectable:he,elementsSelectable:fe,elevateNodesOnSelect:ot,elevateEdgesOnSelect:rt,minZoom:me,maxZoom:ge,nodeExtent:be,onNodesChange:qe,onEdgesChange:Ke,snapToGrid:ne,snapGrid:oe,connectionMode:W,translateExtent:ve,connectOnClick:Qe,defaultEdgeOptions:nt,fitView:Ge,fitViewOptions:Je,onNodesDelete:j,onEdgesDelete:P,onDelete:I,onNodeDragStart:O,onNodeDrag:T,onNodeDragStop:_,onSelectionDrag:z,onSelectionDragStart:F,onSelectionDragStop:L,onMove:v,onMoveStart:y,onMoveEnd:b,noPanClassName:Ze,nodeOrigin:ue,rfId:Et,autoPanOnConnect:st,autoPanOnNodeDrag:at,autoPanSpeed:lt,onError:dt,connectionRadius:ct,isValidConnection:ut,selectNodesOnDrag:ie,nodeDragThreshold:pt,connectionDragThreshold:mt,onBeforeDelete:$,paneClickDistance:Pe,debug:wt,ariaLabelConfig:Ct}),(0,c.jsx)(rs,{onSelectionChange:R}),Re,(0,c.jsx)(Gi,{proOptions:tt,position:et}),(0,c.jsx)(Xi,{rfId:Et,disableKeyboardA11y:it})]})}))});const cl=e=>{var t;return null===(t=e.domNode)||void 0===t?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function ul(e){let{children:t}=e;const n=Bi(cl);return n?(0,Ai.createPortal)(t,n):null}yo();function dl(e){let{dimensions:t,lineWidth:n,variant:o,className:r}=e;return(0,c.jsx)("path",{strokeWidth:n,d:"M".concat(t[0]/2," 0 V").concat(t[1]," M0 ").concat(t[1]/2," H").concat(t[0]),className:u(["react-flow__background-pattern",o,r])})}function hl(e){let{radius:t,className:n}=e;return(0,c.jsx)("circle",{cx:t,cy:t,r:t,className:u(["react-flow__background-pattern","dots",n])})}var fl;!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(fl||(fl={}));const pl={[fl.Dots]:1,[fl.Lines]:1,[fl.Cross]:6},ml=e=>({transform:e.transform,patternId:"pattern-".concat(e.rfId)});function gl(t){let{id:n,variant:o=fl.Dots,gap:r=20,size:i,lineWidth:s=1,offset:l=0,color:d,bgColor:h,style:f,className:p,patternClassName:m}=t;const g=(0,e.useRef)(null),{transform:v,patternId:y}=Bi(ml,Ni),b=i||pl[o],x=o===fl.Dots,w=o===fl.Cross,k=Array.isArray(r)?r:[r,r],C=[k[0]*v[2]||1,k[1]*v[2]||1],S=b*v[2],E=Array.isArray(l)?l:[l,l],D=w?[S,S]:C,M=[E[0]*v[2]||1+D[0]/2,E[1]*v[2]||1+D[1]/2],N="".concat(y).concat(n||"");return(0,c.jsxs)("svg",{className:u(["react-flow__background",p]),style:a(a(a({},f),Ps),{},{"--xy-background-color-props":h,"--xy-background-pattern-color-props":d}),ref:g,"data-testid":"rf__background",children:[(0,c.jsx)("pattern",{id:N,x:v[0]%C[0],y:v[1]%C[1],width:C[0],height:C[1],patternUnits:"userSpaceOnUse",patternTransform:"translate(-".concat(M[0],",-").concat(M[1],")"),children:x?(0,c.jsx)(hl,{radius:S/2,className:m}):(0,c.jsx)(dl,{dimensions:D,lineWidth:s,variant:o,className:m})}),(0,c.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(N,")")})]})}gl.displayName="Background";const vl=(0,e.memo)(gl);function yl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,c.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function bl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,c.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function xl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,c.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function wl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,c.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function kl(){return(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,c.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Cl(e){let{children:t,className:n}=e,o=l(e,Ri);return(0,c.jsx)("button",a(a({type:"button",className:u(["react-flow__controls-button",n])},o),{},{children:t}))}const Sl=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function El(e){let{style:t,showZoom:n=!0,showFitView:o=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:a,onFitView:l,onInteractiveChange:d,className:h,children:f,position:p="bottom-left",orientation:m="vertical","aria-label":g}=e;const v=Vi(),{isInteractive:y,minZoomReached:b,maxZoomReached:x,ariaLabelConfig:w}=Bi(Sl,Ni),{zoomIn:k,zoomOut:C,fitView:S}=Ts(),E="horizontal"===m?"horizontal":"vertical";return(0,c.jsxs)(Zi,{className:u(["react-flow__controls",E,h]),position:p,style:t,"data-testid":"rf__controls","aria-label":null!==g&&void 0!==g?g:w["controls.ariaLabel"],children:[n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Cl,{onClick:()=>{k(),null===s||void 0===s||s()},className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:x,children:(0,c.jsx)(yl,{})}),(0,c.jsx)(Cl,{onClick:()=>{C(),null===a||void 0===a||a()},className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:b,children:(0,c.jsx)(bl,{})})]}),o&&(0,c.jsx)(Cl,{className:"react-flow__controls-fitview",onClick:()=>{S(i),null===l||void 0===l||l()},title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:(0,c.jsx)(xl,{})}),r&&(0,c.jsx)(Cl,{className:"react-flow__controls-interactive",onClick:()=>{v.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),null===d||void 0===d||d(!y)},title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:y?(0,c.jsx)(kl,{}):(0,c.jsx)(wl,{})}),f]})}El.displayName="Controls";const Dl=(0,e.memo)(El);const Ml=(0,e.memo)(function(e){let{id:t,x:n,y:o,width:r,height:i,style:s,color:a,strokeColor:l,strokeWidth:d,className:h,borderRadius:f,shapeRendering:p,selected:m,onClick:g}=e;const{background:v,backgroundColor:y}=s||{},b=a||v||y;return(0,c.jsx)("rect",{className:u(["react-flow__minimap-node",{selected:m},h]),x:n,y:o,rx:f,ry:f,width:r,height:i,style:{fill:b,stroke:l,strokeWidth:d},shapeRendering:p,onClick:g?e=>g(e,t):void 0})}),Nl=e=>e.nodes.map(e=>e.id),Al=e=>e instanceof Function?e:()=>e;const Ol=(0,e.memo)(function(e){let{id:t,nodeColorFunc:n,nodeStrokeColorFunc:o,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:a,NodeComponent:l,onClick:u}=e;const{node:d,x:h,y:f,width:p,height:m}=Bi(e=>{const{internals:n}=e.nodeLookup.get(t),o=n.userNode,{x:r,y:i}=n.positionAbsolute,{width:s,height:a}=lr(o);return{node:o,x:r,y:i,width:s,height:a}},Ni);return d&&!d.hidden&&cr(d)?(0,c.jsx)(l,{x:h,y:f,width:p,height:m,style:d.style,selected:!!d.selected,className:r(d),color:n(d),borderRadius:i,strokeColor:o(d),strokeWidth:s,shapeRendering:a,onClick:u,id:d.id}):null});var Tl=(0,e.memo)(function(e){let{nodeStrokeColor:t,nodeColor:n,nodeClassName:o="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:s=Ml,onClick:a}=e;const l=Bi(Nl,Ni),u=Al(n),d=Al(t),h=Al(o),f="undefined"===typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,c.jsx)(c.Fragment,{children:l.map(e=>(0,c.jsx)(Ol,{id:e,nodeColorFunc:u,nodeStrokeColorFunc:d,nodeClassNameFunc:h,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:s,onClick:a,shapeRendering:f},e))})});const _l=e=>!e.hidden,jl=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Zo(Io(e.nodeLookup,{filter:_l}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}};function Pl(t){var n,o;let{style:r,className:i,nodeStrokeColor:s,nodeColor:l,nodeClassName:d="",nodeBorderRadius:h=5,nodeStrokeWidth:f,nodeComponent:p,bgColor:m,maskColor:g,maskStrokeColor:v,maskStrokeWidth:y,position:b="bottom-right",onClick:x,onNodeClick:w,pannable:k=!1,zoomable:C=!1,ariaLabel:S,inversePan:E,zoomStep:D=10,offsetScale:M=5}=t;const N=Vi(),A=(0,e.useRef)(null),{boundingRect:O,viewBB:T,rfId:_,panZoom:j,translateExtent:P,flowWidth:I,flowHeight:R,ariaLabelConfig:F}=Bi(jl,Ni),z=null!==(n=null===r||void 0===r?void 0:r.width)&&void 0!==n?n:200,L=null!==(o=null===r||void 0===r?void 0:r.height)&&void 0!==o?o:150,B=O.width/z,V=O.height/L,H=Math.max(B,V),$=H*z,W=H*L,U=M*H,q=O.x-($-O.width)/2-U,K=O.y-(W-O.height)/2-U,Y=$+2*U,X=W+2*U,Z="".concat("react-flow__minimap-desc","-").concat(_),G=(0,e.useRef)(0),J=(0,e.useRef)();G.current=H,(0,e.useEffect)(()=>{if(A.current&&j)return J.current=function(e){let{domNode:t,panZoom:n,getTransform:o,getViewScale:r}=e;const i=Oe(t);return{update:function(e){let{translateExtent:t,width:s,height:a,zoomStep:l=10,pannable:c=!0,zoomable:u=!0,inversePan:d=!1}=e,h=[0,0];const f=eo().on("start",e=>{var t,n;"mousedown"!==e.sourceEvent.type&&"touchstart"!==e.sourceEvent.type||(h=[null!==(t=e.sourceEvent.clientX)&&void 0!==t?t:e.sourceEvent.touches[0].clientX,null!==(n=e.sourceEvent.clientY)&&void 0!==n?n:e.sourceEvent.touches[0].clientY])}).on("zoom",c?e=>{var i,l;const c=o();if("mousemove"!==e.sourceEvent.type&&"touchmove"!==e.sourceEvent.type||!n)return;const u=[null!==(i=e.sourceEvent.clientX)&&void 0!==i?i:e.sourceEvent.touches[0].clientX,null!==(l=e.sourceEvent.clientY)&&void 0!==l?l:e.sourceEvent.touches[0].clientY],f=[u[0]-h[0],u[1]-h[1]];h=u;const p=r()*Math.max(c[2],Math.log(c[2]))*(d?-1:1),m={x:c[0]-f[0]*p,y:c[1]-f[1]*p},g=[[0,0],[s,a]];n.setViewportConstrained({x:m.x,y:m.y,zoom:c[2]},g,t)}:null).on("zoom.wheel",u?e=>{const t=o();if("wheel"!==e.sourceEvent.type||!n)return;const r=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*l,i=t[2]*Math.pow(2,r);n.scaleTo(i)}:null);i.call(f,{})},destroy:function(){i.on("zoom",null)},pointer:Te}}({domNode:A.current,panZoom:j,getTransform:()=>N.getState().transform,getViewScale:()=>G.current}),()=>{var e;null===(e=J.current)||void 0===e||e.destroy()}},[j]),(0,e.useEffect)(()=>{var e;null===(e=J.current)||void 0===e||e.update({translateExtent:P,width:I,height:R,inversePan:E,pannable:k,zoomStep:D,zoomable:C})},[k,C,E,D,P,I,R]);const Q=x?e=>{var t;const[n,o]=(null===(t=J.current)||void 0===t?void 0:t.pointer(e))||[0,0];x(e,{x:n,y:o})}:void 0,ee=w?(0,e.useCallback)((e,t)=>{const n=N.getState().nodeLookup.get(t).internals.userNode;w(e,n)},[]):void 0,te=null!==S&&void 0!==S?S:F["minimap.ariaLabel"];return(0,c.jsx)(Zi,{position:b,style:a(a({},r),{},{"--xy-minimap-background-color-props":"string"===typeof m?m:void 0,"--xy-minimap-mask-background-color-props":"string"===typeof g?g:void 0,"--xy-minimap-mask-stroke-color-props":"string"===typeof v?v:void 0,"--xy-minimap-mask-stroke-width-props":"number"===typeof y?y*H:void 0,"--xy-minimap-node-background-color-props":"string"===typeof l?l:void 0,"--xy-minimap-node-stroke-color-props":"string"===typeof s?s:void 0,"--xy-minimap-node-stroke-width-props":"number"===typeof f?f:void 0}),className:u(["react-flow__minimap",i]),"data-testid":"rf__minimap",children:(0,c.jsxs)("svg",{width:z,height:L,viewBox:"".concat(q," ").concat(K," ").concat(Y," ").concat(X),className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:A,onClick:Q,children:[te&&(0,c.jsx)("title",{id:Z,children:te}),(0,c.jsx)(Tl,{onClick:ee,nodeColor:l,nodeStrokeColor:s,nodeBorderRadius:h,nodeClassName:d,nodeStrokeWidth:f,nodeComponent:p}),(0,c.jsx)("path",{className:"react-flow__minimap-mask",d:"M".concat(q-U,",").concat(K-U,"h").concat(Y+2*U,"v").concat(X+2*U,"h").concat(-Y-2*U,"z\n        M").concat(T.x,",").concat(T.y,"h").concat(T.width,"v").concat(T.height,"h").concat(-T.width,"z"),fillRule:"evenodd",pointerEvents:"none"})]})})}Pl.displayName="MiniMap";const Il=(0,e.memo)(Pl),Rl={[di.Line]:"right",[di.Handle]:"bottom-right"};(0,e.memo)(function(t){let{nodeId:n,position:o,variant:r=di.Handle,className:i,style:s,children:l,color:d,minWidth:h=10,minHeight:f=10,maxWidth:p=Number.MAX_VALUE,maxHeight:m=Number.MAX_VALUE,keepAspectRatio:g=!1,resizeDirection:v,autoScale:y=!0,shouldResize:b,onResizeStart:x,onResize:w,onResizeEnd:k}=t;const C=Ks(),S="string"===typeof n?n:C,E=Vi(),D=(0,e.useRef)(null),M=r===di.Handle,N=Bi((0,e.useCallback)((A=M&&y,e=>A?"".concat(Math.max(1/e.transform[2],1)):void 0),[M,y]),Ni);var A;const O=(0,e.useRef)(null),T=null!==o&&void 0!==o?o:Rl[r];(0,e.useEffect)(()=>{if(D.current&&S)return O.current||(O.current=bi({domNode:D.current,nodeId:S,getStoreItems:()=>{const{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,domNode:i}=E.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,paneDomNode:i}},onChange:(e,t)=>{const{triggerNodeChanges:n,nodeLookup:o,parentLookup:r,nodeOrigin:i}=E.getState(),s=[],l={x:e.x,y:e.y},c=o.get(S);if(c&&c.expandParent&&c.parentId){var u,d,h,f,p,m,g;const t=null!==(u=c.origin)&&void 0!==u?u:i,n=null!==(d=null!==(h=e.width)&&void 0!==h?h:c.measured.width)&&void 0!==d?d:0,v=null!==(f=null!==(p=e.height)&&void 0!==p?p:c.measured.height)&&void 0!==f?f:0,y=Wr([{id:c.id,parentId:c.parentId,rect:a({width:n,height:v},ur({x:null!==(m=e.x)&&void 0!==m?m:c.position.x,y:null!==(g=e.y)&&void 0!==g?g:c.position.y},{width:n,height:v},c.parentId,o,t))}],o,r,i);s.push(...y),l.x=e.x?Math.max(t[0]*n,e.x):void 0,l.y=e.y?Math.max(t[1]*v,e.y):void 0}if(void 0!==l.x&&void 0!==l.y){const e={id:S,type:"position",position:a({},l)};s.push(e)}if(void 0!==e.width&&void 0!==e.height){const t={id:S,type:"dimensions",resizing:!0,setAttributes:!v||("horizontal"===v?"width":"height"),dimensions:{width:e.width,height:e.height}};s.push(t)}for(const v of t){const e=a(a({},v),{},{type:"position"});s.push(e)}n(s)},onEnd:e=>{let{width:t,height:n}=e;const o={id:S,type:"dimensions",resizing:!1,dimensions:{width:t,height:n}};E.getState().triggerNodeChanges([o])}})),O.current.update({controlPosition:T,boundaries:{minWidth:h,minHeight:f,maxWidth:p,maxHeight:m},keepAspectRatio:g,resizeDirection:v,onResizeStart:x,onResize:w,onResizeEnd:k,shouldResize:b}),()=>{var e;null===(e=O.current)||void 0===e||e.destroy()}},[T,h,f,p,m,g,x,w,k,b]);const _=T.split("-");return(0,c.jsx)("div",{className:u(["react-flow__resize-control","nodrag",..._,r,i]),ref:D,style:a(a({},s),{},{scale:N},d&&{[M?"backgroundColor":"borderColor"]:d}),children:l})});var Fl=n(3577),zl=n.n(Fl);const Ll=e=>{let{id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s,targetPosition:l,style:u={},data:d}=e;const h=90*(((null===d||void 0===d?void 0:d.siblingIndex)||0)-(((null===d||void 0===d?void 0:d.siblingCount)||1)-1)/2),[f,p,m]=(e=>{let{sourceX:t,sourceY:n,sourcePosition:o,targetX:r,targetY:i,targetPosition:s,offset:a=0}=e;const l=r-t,c=i-n,u=Math.abs(l),d=Math.abs(c),h=u>d,f=.4*(h?u:d);let p={x:t,y:n},m={x:r,y:i};switch(o){case"top":p.y-=f;break;case"bottom":p.y+=f;break;case"left":p.x-=f;break;case"right":p.x+=f}switch(s){case"top":m.y-=f;break;case"bottom":m.y+=f;break;case"left":m.x-=f;break;case"right":m.x+=f}return h?(p.y+=a,m.y+=a):(p.x+=a,m.x+=a),["M".concat(t,",").concat(n," C").concat(p.x,",").concat(p.y," ").concat(m.x,",").concat(m.y," ").concat(r,",").concat(i),.125*t+.375*p.x+.375*m.x+.125*r,.125*n+.375*p.y+.375*m.y+.125*i]})({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:l,offset:h}),g=(null===d||void 0===d?void 0:d.offsetY)||0,v="arrow-".concat(t);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("svg",{style:{height:0,width:0,position:"absolute"},children:(0,c.jsx)("defs",{children:(0,c.jsx)("marker",{id:v,viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",children:(0,c.jsx)("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#2563eb"})})})}),(0,c.jsx)(ga,{id:t,path:f,style:a(a({},u),{},{strokeWidth:3,stroke:"#2563eb",strokeDasharray:"8 4"}),markerEnd:"url(#".concat(v,")")}),(0,c.jsx)(ul,{children:(0,c.jsxs)("div",{style:{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(p,"px,").concat(m+g,"px)"),background:null!==d&&void 0!==d&&d.effectsText?"#dbeafe":"#f1f5f9",padding:"4px 8px",borderRadius:"5px",fontSize:"12px",textAlign:"center",color:"#000",pointerEvents:"all",zIndex:10,border:"1px solid #cbd5e1"},className:"nodrag nopan",children:[(0,c.jsx)("strong",{children:null===d||void 0===d?void 0:d.text}),(null===d||void 0===d?void 0:d.effectsText)&&""!==d.effectsText.trim()&&(0,c.jsx)("div",{style:{fontSize:"10px",color:"#334155",marginTop:"3px",display:"flex",flexDirection:"column",gap:"2px"},children:d.effectsText.split(",").map((e,t)=>(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[(0,c.jsx)("span",{style:{fontSize:"8px"},children:"\u25cf"}),(0,c.jsx)("span",{children:e.trim()})]},t))})]})})]})};const Bl=t=>{let{id:n,data:o,selected:r}=t;const{cleanMainText:i,idLine:s,firstPhoto:a}=(0,e.useMemo)(()=>{const[e,...t]=(o.label||"").split("\n"),n=t.join("\n");let r=(i=n)?i.replace(/<[^>]+>/g,"").replace(/<\/?[^>]+(>|$)/g,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"):"";var i;r.length>1500&&(r=r.substring(0,1500)+"...\n(\u0442\u0435\u043a\u0441\u0442 \u043e\u0431\u0440\u0435\u0437\u0430\u043d)");return{cleanMainText:r,idLine:e,firstPhoto:(o.media||[]).find(e=>"photo"===e.type)}},[o.label,o.media]);return(0,c.jsxs)("div",{style:{backgroundColor:o.bgColor||"#ffffff",color:"black",padding:10,borderRadius:10,minWidth:300,maxWidth:300,textAlign:"center",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",border:r?"2px solid #3b82f6":"none",transition:"border 0.2s",whiteSpace:"normal",wordBreak:"break-word",overflowWrap:"break-word"},children:[(0,c.jsx)("div",{style:{backgroundColor:"rgba(31, 41, 55, 0.7)",color:"white",padding:"4px 8px",borderRadius:6,marginBottom:8,fontWeight:"bold",fontSize:"12px"},children:s}),(0,c.jsx)("div",{style:{whiteSpace:"pre-wrap",textAlign:"left",wordBreak:"break-word",overflowWrap:"break-word",fontSize:14,marginBottom:a?8:0,maxHeight:"none"},children:i}),a&&(0,c.jsx)("img",{src:a.url,alt:"preview",style:{width:"100%",objectFit:"cover",borderRadius:6}}),(0,c.jsx)(Xs,{type:"target",position:Ao.Top,style:{visibility:"hidden"}}),(0,c.jsxs)("div",{style:{position:"absolute",bottom:"-10px",left:"50%",transform:"translateX(-50%)",width:60,height:60,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,c.jsx)(Xs,{type:"source",position:Ao.Bottom,style:{width:"70px",height:"70px",borderRadius:"50%",opacity:0,position:"absolute",top:"5px"}}),(0,c.jsx)("div",{style:{width:34,height:34,borderRadius:"50%",background:"#3b82f6",border:"3px solid white",boxShadow:"0 0 5px 3px rgba(59,130,246,.7)",pointerEvents:"none",zIndex:2,transform:"translateY(50px)"}})]})]})},Vl=(0,e.memo)(t=>{let{data:n,id:o}=t;const{getNode:r}=Ts(),i=(0,e.useCallback)(e=>{e.preventDefault();const t=r(o);t&&window.dispatchEvent(new CustomEvent("noteRightClick",{detail:{event:e,node:t}}))},[o,r]),s=n.text||"",a=s.length>1e3?"".concat(s.slice(0,1e3),"..."):s;return(0,c.jsx)("div",{style:{background:"#fffacd",border:"1px solid #f0e68c",borderRadius:"5px",padding:"10px",fontSize:"14px",color:"#333",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)",width:400,height:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word"},onContextMenu:i,dangerouslySetInnerHTML:{__html:a}})}),Hl=Vl;function $l(t){let{x:n,y:o}=t;const r=(0,e.useRef)(null),[i,s]=(0,e.useState)({position:"absolute",top:o,left:n,opacity:0});return(0,e.useLayoutEffect)(()=>{const e=r.current;if(!e)return;const t=()=>{const t=e.getBoundingClientRect(),{innerWidth:r,innerHeight:i}=window;let a=n,l=o;t.width,n+t.width>r&&(a=n-t.width),a<10&&(a=10),o+t.height>i&&(l=o-t.height),l<10&&(l=10),s({position:"absolute",top:l,left:a,opacity:1})};t();const i=new ResizeObserver(()=>{t()});return i.observe(e),()=>i.disconnect()},[n,o]),{ref:r,style:i}}var Wl=n(9461);function Ul(e){this.content=e}Ul.prototype={constructor:Ul,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var o=n&&n!=e?this.remove(n):this,r=o.find(e),i=o.content.slice();return-1==r?i.push(n||e,t):(i[r+1]=t,n&&(i[r]=n)),new Ul(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new Ul(n)},addToStart:function(e,t){return new Ul([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new Ul(n)},addBefore:function(e,t,n){var o=this.remove(t),r=o.content.slice(),i=o.find(e);return r.splice(-1==i?r.length:i,0,t,n),new Ul(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=Ul.from(e)).size?new Ul(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=Ul.from(e)).size?new Ul(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Ul.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},Ul.from=function(e){if(e instanceof Ul)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new Ul(t)};const ql=Ul;function Kl(e,t,n){for(let o=0;;o++){if(o==e.childCount||o==t.childCount)return e.childCount==t.childCount?null:n;let r=e.child(o),i=t.child(o);if(r!=i){if(!r.sameMarkup(i))return n;if(r.isText&&r.text!=i.text){for(let e=0;r.text[e]==i.text[e];e++)n++;return n}if(r.content.size||i.content.size){let e=Kl(r.content,i.content,n+1);if(null!=e)return e}n+=r.nodeSize}else n+=r.nodeSize}}function Yl(e,t,n,o){for(let r=e.childCount,i=t.childCount;;){if(0==r||0==i)return r==i?null:{a:n,b:o};let s=e.child(--r),a=t.child(--i),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:o};if(s.isText&&s.text!=a.text){let e=0,t=Math.min(s.text.length,a.text.length);for(;e<t&&s.text[s.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,o--;return{a:n,b:o}}if(s.content.size||a.content.size){let e=Yl(s.content,a.content,n-1,o-1);if(e)return e}n-=l,o-=l}else n-=l,o-=l}}class Xl{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;if(l>e&&!1!==n(a,o+s,r||null,i)&&a.content.size){let r=s+1;a.nodesBetween(Math.max(0,e-r),Math.min(a.content.size,t-r),n,o+r)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,o){let r="",i=!0;return this.nodesBetween(e,t,(s,a)=>{let l=s.isText?s.text.slice(Math.max(e,a)-a,t-a):s.isLeaf?o?"function"===typeof o?o(s):o:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(i?i=!1:r+=n),r+=l},0),r}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,o=this.content.slice(),r=0;for(t.isText&&t.sameMarkup(n)&&(o[o.length-1]=t.withText(t.text+n.text),r=1);r<e.content.length;r++)o.push(e.content[r]);return new Xl(o,this.size+e.size)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==e&&t==this.size)return this;let n=[],o=0;if(t>e)for(let r=0,i=0;i<t;r++){let s=this.content[r],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),o+=s.nodeSize),i=a}return new Xl(n,o)}cutByIndex(e,t){return e==t?Xl.empty:0==e&&t==this.content.length?this:new Xl(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let o=this.content.slice(),r=this.size+t.nodeSize-n.nodeSize;return o[e]=t,new Xl(o,r)}addToStart(e){return new Xl([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Xl(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let o=this.content[t];e(o,n,t),n+=o.nodeSize}}findDiffStart(e){return Kl(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}findDiffEnd(e){return Yl(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size)}findIndex(e){if(0==e)return Gl(0,e);if(e==this.size)return Gl(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let t=0,n=0;;t++){let o=n+this.child(t).nodeSize;if(o>=e)return o==e?Gl(t+1,o):Gl(t,n);n=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Xl.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Xl(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Xl.empty;let t,n=0;for(let o=0;o<e.length;o++){let r=e[o];n+=r.nodeSize,o&&r.isText&&e[o-1].sameMarkup(r)?(t||(t=e.slice(0,o)),t[t.length-1]=r.withText(t[t.length-1].text+r.text)):t&&t.push(r)}return new Xl(t||e,n)}static from(e){if(!e)return Xl.empty;if(e instanceof Xl)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Xl([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Xl.empty=new Xl([],0);const Zl={index:0,offset:0};function Gl(e,t){return Zl.index=e,Zl.offset=t,Zl}function Jl(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Jl(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Jl(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class Ql{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let o=0;o<e.length;o++){let r=e[o];if(this.eq(r))return e;if(this.type.excludes(r.type))t||(t=e.slice(0,o));else{if(r.type.excludes(this.type))return e;!n&&r.type.rank>this.type.rank&&(t||(t=e.slice(0,o)),t.push(this),n=!0),t&&t.push(r)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Jl(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));let o=n.create(t.attrs);return n.checkAttrs(o.attrs),o}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return Ql.none;if(e instanceof Ql)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}Ql.none=[];class ec extends Error{}class tc{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=oc(this.content,e+this.openStart,t);return n&&new tc(n,this.openStart,this.openEnd)}removeBetween(e,t){return new tc(nc(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return tc.empty;let n=t.openStart||0,o=t.openEnd||0;if("number"!=typeof n||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new tc(Xl.fromJSON(e,t.content),n,o)}static maxOpen(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,o=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)o++;return new tc(e,n,o)}}function nc(e,t,n){let{index:o,offset:r}=e.findIndex(t),i=e.maybeChild(o),{index:s,offset:a}=e.findIndex(n);if(r==t||i.isText){if(a!=n&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(o,i.copy(nc(i.content,t-r-1,n-r-1)))}function oc(e,t,n,o){let{index:r,offset:i}=e.findIndex(t),s=e.maybeChild(r);if(i==t||s.isText)return o&&!o.canReplace(r,r,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=oc(s.content,t-i-1,n,s);return a&&e.replaceChild(r,s.copy(a))}function rc(e,t,n){if(n.openStart>e.depth)throw new ec("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new ec("Inconsistent open depths");return ic(e,t,n,0)}function ic(e,t,n,o){let r=e.index(o),i=e.node(o);if(r==t.index(o)&&o<e.depth-n.openStart){let s=ic(e,t,n,o+1);return i.copy(i.content.replaceChild(r,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=o||t.depth!=o){let{start:r,end:s}=function(e,t){let n=t.depth-e.openStart,o=t.node(n).copy(e.content);for(let r=n-1;r>=0;r--)o=t.node(r).copy(Xl.from(o));return{start:o.resolveNoCache(e.openStart+n),end:o.resolveNoCache(o.content.size-e.openEnd-n)}}(n,e);return uc(i,dc(e,r,s,t,o))}{let o=e.parent,r=o.content;return uc(o,r.cut(0,e.parentOffset).append(n.content).append(r.cut(t.parentOffset)))}}return uc(i,hc(e,t,o))}function sc(e,t){if(!t.type.compatibleContent(e.type))throw new ec("Cannot join "+t.type.name+" onto "+e.type.name)}function ac(e,t,n){let o=e.node(n);return sc(o,t.node(n)),o}function lc(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function cc(e,t,n,o){let r=(t||e).node(n),i=0,s=t?t.index(n):r.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(lc(e.nodeAfter,o),i++));for(let a=i;a<s;a++)lc(r.child(a),o);t&&t.depth==n&&t.textOffset&&lc(t.nodeBefore,o)}function uc(e,t){return e.type.checkContent(t),e.copy(t)}function dc(e,t,n,o,r){let i=e.depth>r&&ac(e,t,r+1),s=o.depth>r&&ac(n,o,r+1),a=[];return cc(null,e,r,a),i&&s&&t.index(r)==n.index(r)?(sc(i,s),lc(uc(i,dc(e,t,n,o,r+1)),a)):(i&&lc(uc(i,hc(e,t,r+1)),a),cc(t,n,r,a),s&&lc(uc(s,hc(n,o,r+1)),a)),cc(o,null,r,a),new Xl(a)}function hc(e,t,n){let o=[];if(cc(null,e,n,o),e.depth>n){lc(uc(ac(e,t,n+1),hc(e,t,n+1)),o)}return cc(t,null,n,o),new Xl(o)}tc.empty=new tc(Xl.empty,0,0);class fc{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],o=e.child(t);return n?e.child(t).cut(n):o}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],o=0==t?0:this.path[3*t-1]+1;for(let r=0;r<e;r++)o+=n.child(r).nodeSize;return o}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return Ql.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),o=e.maybeChild(t);if(!n){let e=n;n=o,o=e}let r=n.marks;for(var i=0;i<r.length;i++)!1!==r[i].type.spec.inclusive||o&&r[i].isInSet(o.marks)||(r=r[i--].removeFromSet(r));return r}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,o=e.parent.maybeChild(e.index());for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||o&&n[r].isInSet(o.marks)||(n=n[r--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new vc(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],o=0,r=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(r),s=r-t;if(n.push(i,e,o+t),!s)break;if(i=i.child(e),i.isText)break;r=s-1,o+=t+1}return new fc(t,n,r)}static resolveCached(e,t){let n=gc.get(e);if(n)for(let r=0;r<n.elts.length;r++){let e=n.elts[r];if(e.pos==t)return e}else gc.set(e,n=new pc);let o=n.elts[n.i]=fc.resolve(e,t);return n.i=(n.i+1)%mc,o}}class pc{constructor(){this.elts=[],this.i=0}}const mc=12,gc=new WeakMap;class vc{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const yc=Object.create(null);class bc{constructor(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ql.none;this.type=e,this.attrs=t,this.marks=o,this.content=n||Xl.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,n,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,o){return this.content.textBetween(e,t,n,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&Jl(this.attrs,t||e.defaultAttrs||yc)&&Ql.sameSet(this.marks,n||Ql.none)}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e==this.content?this:new bc(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new bc(this.type,this.attrs,this.content,e)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return tc.empty;let o=this.resolve(e),r=this.resolve(t),i=n?0:o.sharedDepth(t),s=o.start(i),a=o.node(i).content.cut(o.pos-s,r.pos-s);return new tc(a,o.depth-i,r.depth-i)}replace(e,t,n){return rc(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:o}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(o==e||t.isText)return t;e-=o+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let o=this.content.child(t-1);return{node:o,index:t-1,offset:n-o.nodeSize}}resolve(e){return fc.resolveCached(this,e)}resolveNoCache(e){return fc.resolve(this,e)}rangeHasMark(e,t,n){let o=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),wc(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xl.empty,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.childCount,i=this.contentMatchAt(e).matchFragment(n,o,r),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let a=o;a<r;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,o){if(o&&!this.type.allowsMarks(o))return!1;let r=this.contentMatchAt(e).matchType(n),i=r&&r.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Ql.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Ql.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(e=>e.type.name)));this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let o=Xl.fromJSON(e,t.content),r=e.nodeType(t.type).create(t.attrs,o,n);return r.type.checkAttrs(r.attrs),r}}bc.prototype.text=void 0;class xc extends bc{constructor(e,t,n,o){if(super(e,t,null,o),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wc(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new xc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new xc(this.type,this.attrs,e,this.marks)}cut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function wc(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class kc{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new Cc(e,t);if(null==n.next)return kc.empty;let o=Sc(n);n.next&&n.err("Unexpected trailing text");let r=function(e){let t=Object.create(null);return n(Oc(e,0));function n(o){let r=[];o.forEach(t=>{e[t].forEach(t=>{let n,{term:o,to:i}=t;if(o){for(let e=0;e<r.length;e++)r[e][0]==o&&(n=r[e][1]);Oc(e,i).forEach(e=>{n||r.push([o,n=[]]),-1==n.indexOf(e)&&n.push(e)})}})});let i=t[o.join(",")]=new kc(o.indexOf(e.length-1)>-1);for(let e=0;e<r.length;e++){let o=r[e][1].sort(Ac);i.next.push({type:r[e][0],next:t[o.join(",")]||n(o)})}return i}}(function(e){let t=[[]];return r(i(e,0),n()),t;function n(){return t.push([])-1}function o(e,n,o){let r={term:o,to:n};return t[e].push(r),r}function r(e,t){e.forEach(e=>e.to=t)}function i(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(i(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let s=n();return o(t,s),r(i(e.expr,s),s),[o(s)]}if("plus"==e.type){let s=n();return r(i(e.expr,t),s),r(i(e.expr,s),s),[o(s)]}if("opt"==e.type)return[o(t)].concat(i(e.expr,t));if("range"==e.type){let s=t;for(let t=0;t<e.min;t++){let t=n();r(i(e.expr,s),t),s=t}if(-1==e.max)r(i(e.expr,s),s);else for(let t=e.min;t<e.max;t++){let t=n();o(s,t),r(i(e.expr,s),t),s=t}return[o(s)]}if("name"==e.type)return[o(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let o=0;;o++){let s=i(e.exprs[o],t);if(o==e.exprs.length-1)return s;r(s,t=n())}}}(o));return function(e,t){for(let n=0,o=[e];n<o.length;n++){let e=o[n],r=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];i.push(n.name),!r||n.isText||n.hasRequiredAttrs()||(r=!1),-1==o.indexOf(s)&&o.push(s)}r&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,n),r}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,o=this;for(let r=t;o&&r<n;r++)o=o.matchType(e.child(r).type);return o}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=[this];return function r(i,s){let a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return Xl.from(s.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==o.indexOf(n)){o.push(n);let e=r(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let o=n.shift(),r=o.match;if(r.matchType(e)){let e=[];for(let t=o;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<r.next.length;e++){let{type:i,next:s}=r.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||o.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:o}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let o=0;o<n.next.length;o++)-1==e.indexOf(n.next[o].next)&&t(n.next[o].next)}(this),e.map((t,n)=>{let o=n+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)o+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return o}).join("\n")}}kc.empty=new kc(!0);class Cc{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Sc(e){let t=[];do{t.push(Ec(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Ec(e){let t=[];do{t.push(Dc(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Dc(e){let t=function(e){if(e.eat("(")){let t=Sc(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,o=n[t];if(o)return[o];let r=[];for(let i in n){let e=n[i];e.isInGroup(t)&&r.push(e)}0==r.length&&e.err("No node type or group '"+t+"' found");return r}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Nc(e,t)}return t}function Mc(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function Nc(e,t){let n=Mc(e),o=n;return e.eat(",")&&(o="}"!=e.next?Mc(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:o,expr:t}}function Ac(e,t){return t-e}function Oc(e,t){let n=[];return function t(o){let r=e[o];if(1==r.length&&!r[0].term)return t(r[0].to);n.push(o);for(let e=0;e<r.length;e++){let{term:o,to:i}=r[e];o||-1!=n.indexOf(i)||t(i)}}(t),n.sort(Ac)}function Tc(e){let t=Object.create(null);for(let n in e){let o=e[n];if(!o.hasDefault)return null;t[n]=o.default}return t}function _c(e,t){let n=Object.create(null);for(let o in e){let r=t&&t[o];if(void 0===r){let t=e[o];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+o);r=t.default}n[o]=r}return n}function jc(e,t,n,o){for(let r in t)if(!(r in e))throw new RangeError("Unsupported attribute ".concat(r," for ").concat(n," of type ").concat(r));for(let r in e){let n=e[r];n.validate&&n.validate(t[r])}}function Pc(e,t){let n=Object.create(null);if(t)for(let o in t)n[o]=new Rc(e,o,t[o]);return n}class Ic{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Pc(e,n.attrs),this.defaultAttrs=Tc(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==kc.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:_c(this.attrs,e)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new bc(this,this.computeAttrs(e),Xl.from(t),Ql.setFrom(n))}createChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return t=Xl.from(t),this.checkContent(t),new bc(this,this.computeAttrs(e),t,Ql.setFrom(n))}createAndFill(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=Xl.from(t),t.size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let o=this.contentMatch.matchFragment(t),r=o&&o.fillBefore(Xl.empty,!0);return r?new bc(this,e,t.append(r),Ql.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}checkAttrs(e){jc(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Ql.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,o)=>n[e]=new Ic(e,t,o));let o=t.spec.topNode||"doc";if(!n[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let r in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class Rc{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let o=n.split("|");return n=>{let r=null===n?"null":typeof n;if(o.indexOf(r)<0)throw new RangeError("Expected value of type ".concat(o," for attribute ").concat(t," on type ").concat(e,", got ").concat(r))}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Fc{constructor(e,t,n,o){this.name=e,this.rank=t,this.schema=n,this.spec=o,this.attrs=Pc(e,o.attrs),this.excluded=null;let r=Tc(this.attrs);this.instance=r?new Ql(this,r):null}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new Ql(this,_c(this.attrs,e))}static compile(e,t){let n=Object.create(null),o=0;return e.forEach((e,r)=>n[e]=new Fc(e,o++,t,r)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){jc(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class zc{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let o in e)t[o]=e[o];t.nodes=ql.from(e.nodes),t.marks=ql.from(e.marks||{}),this.nodes=Ic.compile(this.spec.nodes,this),this.marks=Fc.compile(this.spec.marks,this);let n=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let e=this.nodes[o],t=e.spec.content||"",r=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=kc.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==r?null:r?Lc(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let o in this.marks){let e=this.marks[o],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:Lc(this,t.split(" "))}this.nodeFromJSON=e=>bc.fromJSON(this,e),this.markFromJSON=e=>Ql.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Ic))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,o)}text(e,t){let n=this.nodes.text;return new xc(n,n.defaultAttrs,e,Ql.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Lc(e,t){let n=[];for(let o=0;o<t.length;o++){let r=t[o],i=e.marks[r],s=i;if(i)n.push(i);else for(let t in e.marks){let o=e.marks[t];("_"==r||o.spec.group&&o.spec.group.split(" ").indexOf(r)>-1)&&n.push(s=o)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[o]+"'")}return n}class Bc{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new qc(this,t,!1);return n.addAll(e,Ql.none,t.from,t.to),n.finish()}parseSlice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new qc(this,t,!0);return n.addAll(e,Ql.none,t.from,t.to),tc.maxOpen(n.finish())}matchTag(e,t,n){for(let o=n?this.tags.indexOf(n)+1:0;o<this.tags.length;o++){let n=this.tags[o];if(Kc(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,o){for(let r=o?this.styles.indexOf(o)+1:0;r<this.styles.length;r++){let o=this.styles[r],i=o.style;if(!(0!=i.indexOf(e)||o.context&&!n.matchesContext(o.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(o.getAttrs){let e=o.getAttrs(t);if(!1===e)continue;o.attrs=e||void 0}return o}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,o=0;for(;o<t.length;o++){let e=t[o];if((null==e.priority?50:e.priority)<n)break}t.splice(o,0,e)}for(let o in e.marks){let t=e.marks[o].spec.parseDOM;t&&t.forEach(e=>{n(e=Yc(e)),e.mark||e.ignore||e.clearMark||(e.mark=o)})}for(let o in e.nodes){let t=e.nodes[o].spec.parseDOM;t&&t.forEach(e=>{n(e=Yc(e)),e.node||e.ignore||e.mark||(e.node=o)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Bc(e,Bc.schemaRules(e)))}}const Vc={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Hc={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$c={ol:!0,ul:!0};function Wc(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class Uc{constructor(e,t,n,o,r,i){this.type=e,this.attrs=t,this.marks=n,this.solid=o,this.options=i,this.content=[],this.activeMarks=Ql.none,this.match=r||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Xl.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=Xl.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Xl.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Vc.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class qc{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let o,r=t.topNode,i=Wc(null,t.preserveWhitespace,0)|(n?4:0);o=r?new Uc(r.type,r.attrs,Ql.none,!0,t.topMatch||r.type.contentMatch,i):new Uc(n?null:e.schema.topNodeType,null,Ql.none,!0,null,i),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,o=this.top,r=2&o.options?"full":this.localPreserveWS||(1&o.options)>0,{schema:i}=this.parser;if("full"===r||o.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(r)if("full"===r)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(i.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=o.content[o.content.length-1],r=e.previousSibling;(!t||r&&"BR"==r.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let o=this.localPreserveWS,r=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,s=e.nodeName.toLowerCase();$c.hasOwnProperty(s)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&$c.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));e:if(a?a.ignore:Hc.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,o=this.needsBlock;if(Vc.hasOwnProperty(s))r.content.length&&r.content[0].isInline&&this.open&&(this.open--,r=this.top),n=!0,r.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=a&&a.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),n&&this.sync(r),this.needsBlock=o}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?i:void 0)}this.localPreserveWS=o}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let e=this.parser.matchedStyles[o],r=n.getPropertyValue(e);if(r)for(let n;;){let o=this.parser.matchStyle(e,r,this,n);if(!o)break;if(o.ignore)return null;if(t=o.clearMark?t.filter(e=>!o.clearMark(e)):t.concat(this.parser.schema.marks[o.mark].create(o.attrs)),!1!==o.consuming)break;n=o}}return t}addElementByRule(e,t,n,o){let r,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(r=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(o)this.addElement(e,n,o);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let o=e;"string"==typeof t.contentElement?o=e.querySelector(t.contentElement):"function"==typeof t.contentElement?o=t.contentElement(e):t.contentElement&&(o=t.contentElement),this.findAround(e,o,!0),this.addAll(o,n),this.findAround(e,o,!1)}r&&this.sync(s)&&this.open--}addAll(e,t,n,o){let r=n||0;for(let i=n?e.childNodes[n]:e.firstChild,s=null==o?null:e.childNodes[o];i!=s;i=i.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(i,t);this.findAtPoint(e,r)}findPlace(e,t,n){let o,r;for(let i=this.open,s=0;i>=0;i--){let t=this.nodes[i],a=t.findWrapping(e);if(a&&(!o||o.length>a.length+s)&&(o=a,r=t,!a.length))break;if(t.solid){if(n)break;s+=2}}if(!o)return null;this.sync(r);for(let i=0;i<o.length;i++)t=this.enterInner(o[i],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let o=this.findPlace(e,t,n);if(o){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=Ql.none;for(let r of o.concat(e.marks))(t.type?t.type.allowsMarkType(r.type):Xc(r.type,e.type))&&(n=r.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,o){let r=this.findPlace(e.create(t),n,!1);return r&&(r=this.enterInner(e,t,n,!0,o)),r}enterInner(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let s=Wc(e,r,i.options);4&i.options&&0==i.content.length&&(s|=4);let a=Ql.none;return n=n.filter(t=>!(i.type?i.type.allowsMarkType(t.type):Xc(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new Uc(e,t,a,o,null,s)),this.open++,n}closeExtra(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let o=0;o<this.find.length;o++)if(null==this.find[o].pos&&1==e.nodeType&&e.contains(this.find[o].node)){t.compareDocumentPosition(this.find[o].node)&(n?2:4)&&(this.find[o].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,o=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),r=-(n?n.depth+1:0)+(o?0:1),i=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=r;s--)if(i(e-1,s))return!0;return!1}{let e=s>0||0==s&&o?this.nodes[s].type:n&&s>=r?n.node(s-r).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;s--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function Kc(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Yc(e){let t={};for(let n in e)t[n]=e[n];return t}function Xc(e,t){let n=t.schema.nodes;for(let o in n){let r=n[o];if(!r.allowsMarkType(e))continue;let i=[],s=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:o,next:r}=e.edge(n);if(o==t)return!0;if(i.indexOf(r)<0&&s(r))return!0}};if(s(r.contentMatch))return!0}}class Zc{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;n||(n=Jc(t).createDocumentFragment());let o=n,r=[];return e.forEach(e=>{if(r.length||e.marks.length){let n=0,i=0;for(;n<r.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(r[n][0])||!1===t.type.spec.spanning)break;n++,i++}else i++}for(;n<r.length;)o=r.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],s=this.serializeMark(n,e.isInline,t);s&&(r.push([n,o]),o.appendChild(s.dom),o=s.contentDOM||s.dom)}}o.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:o}=tu(Jc(t),this.nodes[e.type.name](e),null,e.attrs);if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,o)}return n}serializeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serializeNodeInner(e,t);for(let o=e.marks.length-1;o>=0;o--){let r=this.serializeMark(e.marks[o],e.isInline,t);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.marks[e.type.name];return o&&tu(Jc(n),o(e,t),null,e.attrs)}static renderSpec(e,t){return tu(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Zc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Gc(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Gc(e.marks)}}function Gc(e){let t={};for(let n in e){let o=e[n].spec.toDOM;o&&(t[n]=o)}return t}function Jc(e){return e.document||window.document}const Qc=new WeakMap;function eu(e){let t=Qc.get(e);return void 0===t&&Qc.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function tu(e,t,n,o){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let r,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(o&&(r=eu(o))&&r.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s,a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let l=n?e.createElementNS(n,i):e.createElement(i),c=t[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let d=u;d<t.length;d++){let r=t[d];if(0===r){if(d<t.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=tu(e,r,n,o);if(l.appendChild(t),i){if(s)throw new RangeError("Multiple content holes");s=i}}}return{dom:l,contentDOM:s}}const nu=Math.pow(2,16);function ou(e,t){return e+t*nu}function ru(e){return 65535&e}class iu{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class su{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges=e,this.inverted=t,!e.length&&su.empty)return su.empty}recover(e){let t=0,n=ru(e);if(!this.inverted)for(let o=0;o<n;o++)t+=this.ranges[3*o+2]-this.ranges[3*o+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/nu}(e)}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}_map(e,t,n){let o=0,r=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?o:0);if(a>e)break;let l=this.ranges[s+r],c=this.ranges[s+i],u=a+l;if(e<=u){let r=a+o+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return r;let i=e==(t<0?a:u)?null:ou(s/3,e-a),d=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(d|=8),new iu(r,d,i)}o+=c-l}return n?e+o:new iu(e+o,0,null)}touches(e,t){let n=0,o=ru(t),r=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let t=this.ranges[s]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[s+r];if(e<=t+a&&s==3*o)return!0;n+=this.ranges[s+i]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let o=0,r=0;o<this.ranges.length;o+=3){let i=this.ranges[o],s=i-(this.inverted?r:0),a=i+(this.inverted?0:r),l=this.ranges[o+t],c=this.ranges[o+n];e(s,s+l,a,a+c),r+=c-l}}invert(){return new su(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?su.empty:new su(e<0?[0,-e,0]:[0,0,e])}}su.empty=new su([]);class au{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e?e.length:0;this.mirror=t,this.from=n,this.to=o,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new au(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let o=e.getMirror(t);this.appendMap(e._maps[t],null!=o&&o<t?n+o:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let o=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=o&&o>t?n-o-1:void 0)}}invert(){let e=new au;return e.appendMappingInverted(this),e}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}_map(e,t,n){let o=0;for(let r=this.from;r<this.to;r++){let n=this._maps[r].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this._maps[t].recover(n.recover);continue}}o|=n.delInfo,e=n.pos}return n?e:new iu(e,o,null)}}const lu=Object.create(null);class cu{getMap(){return su.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=lu[t.stepType];if(!n)throw new RangeError("No step type ".concat(t.stepType," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in lu)throw new RangeError("Duplicate use of step JSON ID "+e);return lu[e]=t,t.prototype.jsonID=e,t}}class uu{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new uu(e,null)}static fail(e){return new uu(null,e)}static fromReplace(e,t,n,o){try{return uu.ok(e.replace(t,n,o))}catch(r){if(r instanceof ec)return uu.fail(r.message);throw r}}}function du(e,t,n){let o=[];for(let r=0;r<e.childCount;r++){let i=e.child(r);i.content.size&&(i=i.copy(du(i.content,t,i))),i.isInline&&(i=t(i,n,r)),o.push(i)}return Xl.fromArray(o)}class hu extends cu{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),o=n.node(n.sharedDepth(this.to)),r=new tc(du(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,o),t.openStart,t.openEnd);return uu.fromReplace(e,this.from,this.to,r)}invert(){return new fu(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new hu(t.pos,n.pos,this.mark)}merge(e){return e instanceof hu&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hu(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new hu(t.from,t.to,e.markFromJSON(t.mark))}}cu.jsonID("addMark",hu);class fu extends cu{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new tc(du(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return uu.fromReplace(e,this.from,this.to,n)}invert(){return new hu(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new fu(t.pos,n.pos,this.mark)}merge(e){return e instanceof fu&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new fu(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new fu(t.from,t.to,e.markFromJSON(t.mark))}}cu.jsonID("removeMark",fu);class pu extends cu{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return uu.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return uu.fromReplace(e,this.pos,this.pos+1,new tc(Xl.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new pu(this.pos,t.marks[n]);return new pu(this.pos,this.mark)}}return new mu(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new pu(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new pu(t.pos,e.markFromJSON(t.mark))}}cu.jsonID("addNodeMark",pu);class mu extends cu{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return uu.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return uu.fromReplace(e,this.pos,this.pos+1,new tc(Xl.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new pu(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new mu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new mu(t.pos,e.markFromJSON(t.mark))}}cu.jsonID("removeNodeMark",mu);class gu extends cu{constructor(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.from=e,this.to=t,this.slice=n,this.structure=o}apply(e){return this.structure&&yu(e,this.from,this.to)?uu.fail("Structure replace would overwrite content"):uu.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new su([this.from,this.to-this.from,this.slice.size])}invert(e){return new gu(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new gu(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof gu)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?tc.empty:new tc(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new gu(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?tc.empty:new tc(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new gu(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new gu(t.from,t.to,tc.fromJSON(e,t.slice),!!t.structure)}}cu.jsonID("replace",gu);class vu extends cu{constructor(e,t,n,o,r,i){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=o,this.slice=r,this.insert=i,this.structure=s}apply(e){if(this.structure&&(yu(e,this.from,this.gapFrom)||yu(e,this.gapTo,this.to)))return uu.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return uu.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?uu.fromReplace(e,this.from,this.to,n):uu.fail("Content does not fit in gap")}getMap(){return new su([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new vu(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),o=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),r=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||o<t.pos||r>n.pos?null:new vu(t.pos,n.pos,o,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new vu(t.from,t.to,t.gapFrom,t.gapTo,tc.fromJSON(e,t.slice),t.insert,!!t.structure)}}function yu(e,t,n){let o=e.resolve(t),r=n-t,i=o.depth;for(;r>0&&i>0&&o.indexAfter(i)==o.node(i).childCount;)i--,r--;if(r>0){let e=o.node(i).maybeChild(o.indexAfter(i));for(;r>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,r--}}return!1}function bu(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.contentMatch,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=e.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=a+t.nodeSize,u=o.matchType(t.type);if(u){o=u;for(let o=0;o<t.marks.length;o++)n.allowsMarkType(t.marks[o].type)||e.step(new fu(a,c,t.marks[o]));if(r&&t.isText&&"pre"!=n.whitespace){let e,o,r=/\r?\n|\r/g;for(;e=r.exec(t.text);)o||(o=new tc(Xl.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),s.push(new gu(a+e.index,a+e.index+e[0].length,o))}}else s.push(new gu(a,c,tc.empty));a=c}if(!o.validEnd){let t=o.fillBefore(Xl.empty,!0);e.replace(a,a,new tc(t,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function xu(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function wu(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,o=0,r=0;;--n){let i=e.$from.node(n),s=e.$from.index(n)+o,a=e.$to.indexAfter(n)-r;if(n<e.depth&&i.canReplace(s,a,t))return n;if(0==n||i.type.spec.isolating||!xu(i,s,a))break;s&&(o=1),a<i.childCount&&(r=1)}return null}function ku(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=function(e,t){let{parent:n,startIndex:o,endIndex:r}=e,i=n.contentMatchAt(o).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return n.canReplaceWith(o,r,s)?i:null}(e,t),i=r&&function(e,t){let{parent:n,startIndex:o,endIndex:r}=e,i=n.child(o),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let l=o;a&&l<r;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?s:null}(o,t);return i?r.map(Cu).concat({type:t,attrs:n}).concat(i.map(Cu)):null}function Cu(e){return{type:e,attrs:null}}function Su(e,t,n,o){t.forEach((r,i)=>{if(r.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(r.text);){let r=e.mapping.slice(o).map(n+1+i+s.index);e.replaceWith(r,r+1,t.type.schema.linebreakReplacement.create())}}})}function Eu(e,t,n,o){t.forEach((r,i)=>{if(r.type==r.type.schema.linebreakReplacement){let r=e.mapping.slice(o).map(n+1+i);e.replaceWith(r,r+1,t.type.schema.text("\n"))}})}function Du(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,r=e.resolve(t),i=r.depth-n,s=o&&o[o.length-1]||r.parent;if(i<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!s.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,u=n-2;c>i;c--,u--){let e=r.node(c),t=r.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),i=o&&o[u+1];i&&(n=n.replaceChild(0,i.type.create(i.attrs)));let s=o&&o[u]||e;if(!e.canReplace(t+1,e.childCount)||!s.type.validContent(n))return!1}let a=r.indexAfter(i),l=o&&o[0];return r.node(i).canReplaceWith(a,a,l?l.type:r.node(i+1).type)}function Mu(e,t){let n=e.resolve(t),o=n.index();return Nu(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(o,o+1)}function Nu(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:o}=e.type.schema;for(let r=0;r<t.childCount;r++){let i=t.child(r),s=i.type==o?e.type.schema.nodes.text:i.type;if(n=n.matchType(s),!n)return!1;if(!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function Au(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=e.resolve(t);for(let r=o.depth;;r--){let e,i,s=o.index(r);if(r==o.depth?(e=o.nodeBefore,i=o.nodeAfter):n>0?(e=o.node(r+1),s++,i=o.node(r).maybeChild(s)):(e=o.node(r).maybeChild(s-1),i=o.node(r+1)),e&&!e.isTextblock&&Nu(e,i)&&o.node(r).canReplace(s,s+1))return t;if(0==r)break;t=n<0?o.before(r):o.after(r)}}function Ou(e,t,n){let o=e.resolve(t);if(!n.content.size)return t;let r=n.content;for(let i=0;i<n.openStart;i++)r=r.firstChild.content;for(let i=1;i<=(0==n.openStart&&n.size?2:1);i++)for(let e=o.depth;e>=0;e--){let t=e==o.depth?0:o.pos<=(o.start(e+1)+o.end(e+1))/2?-1:1,n=o.index(e)+(t>0?1:0),s=o.node(e),a=!1;if(1==i)a=s.canReplace(n,n,r);else{let e=s.contentMatchAt(n).findWrapping(r.firstChild.type);a=e&&s.canReplaceWith(n,n,e[0])}if(a)return 0==t?o.pos:t<0?o.before(e+1):o.after(e+1)}return null}function Tu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tc.empty;if(t==n&&!o.size)return null;let r=e.resolve(t),i=e.resolve(n);return _u(r,i,o)?new gu(t,n,o):new ju(r,i,o).fit()}function _u(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}cu.jsonID("replaceAround",vu);class ju{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=Xl.empty;for(let o=0;o<=e.depth;o++){let t=e.node(o);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=Xl.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,o=this.close(e<0?this.$to:n.doc.resolve(e));if(!o)return null;let r=this.placed,i=n.depth,s=o.depth;for(;i&&s&&1==r.childCount;)r=r.firstChild.content,i--,s--;let a=new tc(r,i,s);return e>-1?new vu(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new gu(n.pos,o.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,o=this.unplaced.openEnd;n<e;n++){let r=t.firstChild;if(t.childCount>1&&(o=0),r.type.spec.isolating&&o<=n){e=n;break}t=r.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,o=null;n?(o=Ru(this.unplaced.content,n-1).firstChild,e=o.content):e=this.unplaced.content;let r=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:s,match:a}=this.frontier[i],l=null;if(1==t&&(r?a.matchType(r.type)||(l=a.fillBefore(Xl.from(r),!1)):o&&s.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:i,parent:o,inject:l};if(2==t&&r&&(e=a.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:i,parent:o,wrap:e};if(o&&a.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,o=Ru(e,t);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new tc(e,t+1,Math.max(n,o.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,o=Ru(e,t);if(o.childCount<=1&&t>0){let r=e.size-t<=t+o.size;this.unplaced=new tc(Pu(e,t-1,1),t-1,r?t-1:n)}else this.unplaced=new tc(Pu(e,t,1),t,n)}placeNodes(e){let{sliceDepth:t,frontierDepth:n,parent:o,inject:r,wrap:i}=e;for(;this.depth>n;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,a=o?o.content:s.content,l=s.openStart-t,c=0,u=[],{match:d,type:h}=this.frontier[n];if(r){for(let e=0;e<r.childCount;e++)u.push(r.child(e));d=d.matchFragment(r)}let f=a.size+t-(s.content.size-s.openEnd);for(;c<a.childCount;){let e=a.child(c),t=d.matchType(e.type);if(!t)break;c++,(c>1||0==l||e.content.size)&&(d=t,u.push(Fu(e.mark(h.allowedMarks(e.marks)),1==c?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=Iu(this.placed,n,Xl.from(u)),this.frontier[n].match=d,p&&f<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<f;m++){let e=g.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),g=e.content}this.unplaced=p?0==t?tc.empty:new tc(Pu(s.content,t-1,1),t-1,f<0?s.openEnd:t-1):new tc(Pu(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!zu(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,o=this.$to.after(n);for(;n>1&&o==this.$to.end(--n);)++o;return o}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:o}=this.frontier[t],r=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=zu(e,t,o,n,r);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:o}=this.frontier[n],r=zu(e,n,o,t,!0);if(!r||r.childCount)continue e}return{depth:t,fit:i,move:r?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Iu(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),o=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,o)}return e}openFrontierNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=Iu(this.placed,this.depth,Xl.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(Xl.empty,!0);e.childCount&&(this.placed=Iu(this.placed,this.frontier.length,e))}}function Pu(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(Pu(e.firstChild.content,t-1,n)))}function Iu(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Iu(e.lastChild.content,t-1,n)))}function Ru(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function Fu(e,t,n){if(t<=0)return e;let o=e.content;return t>1&&(o=o.replaceChild(0,Fu(o.firstChild,t-1,1==o.childCount?n-1:0))),t>0&&(o=e.type.contentMatch.fillBefore(o).append(o),n<=0&&(o=o.append(e.type.contentMatch.matchFragment(o).fillBefore(Xl.empty,!0)))),e.copy(o)}function zu(e,t,n,o,r){let i=e.node(t),s=r?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let a=o.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(let o=n;o<t.childCount;o++)if(!e.allowsMarks(t.child(o).marks))return!0;return!1}(n,i.content,s)?a:null}function Lu(e){return e.spec.defining||e.spec.definingForContent}function Bu(e,t,n,o,r){if(t<n){let r=e.firstChild;e=e.replaceChild(0,r.copy(Bu(r.content,t+1,n,o,r)))}if(t>o){let t=r.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(Xl.empty,!0))}return e}function Vu(e,t){let n=[];for(let o=Math.min(e.depth,t.depth);o>=0;o--){let r=e.start(o);if(r<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(r==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==r-1)&&n.push(o)}return n}class Hu extends cu{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return uu.fail("No node at attribute step's position");let n=Object.create(null);for(let r in t.attrs)n[r]=t.attrs[r];n[this.attr]=this.value;let o=t.type.create(n,null,t.marks);return uu.fromReplace(e,this.pos,this.pos+1,new tc(Xl.from(o),0,t.isLeaf?0:1))}getMap(){return su.empty}invert(e){return new Hu(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hu(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Hu(t.pos,t.attr,t.value)}}cu.jsonID("attr",Hu);class $u extends cu{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let o in e.attrs)t[o]=e.attrs[o];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return uu.ok(n)}getMap(){return su.empty}invert(e){return new $u(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new $u(t.attr,t.value)}}cu.jsonID("docAttr",$u);let Wu=class extends Error{};Wu=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(Wu.prototype=Object.create(Error.prototype)).constructor=Wu,Wu.prototype.name="TransformError";class Uu{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new au}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Wu(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tc.empty,o=Tu(this.doc,e,t,n);return o&&this.step(o),this}replaceWith(e,t,n){return this.replace(e,t,new tc(Xl.from(n),0,0))}delete(e,t){return this.replace(e,t,tc.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,o){if(!o.size)return e.deleteRange(t,n);let r=e.doc.resolve(t),i=e.doc.resolve(n);if(_u(r,i,o))return e.step(new gu(t,n,o));let s=Vu(r,i);0==s[s.length-1]&&s.pop();let a=-(r.depth+1);s.unshift(a);for(let h=r.depth,f=r.pos-1;h>0;h--,f--){let e=r.node(h).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;s.indexOf(h)>-1?a=h:r.before(h)==f&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=o.openStart;for(let h=o.content,f=0;;f++){let e=h.firstChild;if(c.push(e),f==o.openStart)break;h=e.content}for(let h=u-1;h>=0;h--){let e=c[h],t=Lu(e.type);if(t&&!e.sameMarkup(r.node(Math.abs(a)-1)))u=h;else if(t||!e.type.isTextblock)break}for(let h=o.openStart;h>=0;h--){let t=(h+u+1)%(o.openStart+1),a=c[t];if(a)for(let c=0;c<s.length;c++){let u=s[(c+l)%s.length],d=!0;u<0&&(d=!1,u=-u);let h=r.node(u-1),f=r.index(u-1);if(h.canReplaceWith(f,f,a.type,a.marks))return e.replace(r.before(u),d?i.after(u):n,new tc(Bu(o.content,0,o.openStart,t),t,o.openEnd))}}let d=e.steps.length;for(let h=s.length-1;h>=0&&(e.replace(t,n,o),!(e.steps.length>d));h--){let e=s[h];e<0||(t=r.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,o){if(!o.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let r=function(e,t,n){let o=e.resolve(t);if(o.parent.canReplaceWith(o.index(),o.index(),n))return t;if(0==o.parentOffset)for(let r=o.depth-1;r>=0;r--){let e=o.index(r);if(o.node(r).canReplaceWith(e,e,n))return o.before(r+1);if(e>0)return null}if(o.parentOffset==o.parent.content.size)for(let r=o.depth-1;r>=0;r--){let e=o.indexAfter(r);if(o.node(r).canReplaceWith(e,e,n))return o.after(r+1);if(e<o.node(r).childCount)return null}return null}(e.doc,t,o.type);null!=r&&(t=n=r)}e.replaceRange(t,n,new tc(Xl.from(o),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let o=e.doc.resolve(t),r=e.doc.resolve(n),i=Vu(o,r);for(let s=0;s<i.length;s++){let t=i[s],n=s==i.length-1;if(n&&0==t||o.node(t).type.contentMatch.validEnd)return e.delete(o.start(t),r.end(t));if(t>0&&(n||o.node(t-1).canReplace(o.index(t-1),r.indexAfter(t-1))))return e.delete(o.before(t),r.after(t))}for(let s=1;s<=o.depth&&s<=r.depth;s++)if(t-o.start(s)==o.depth-s&&n>o.end(s)&&r.end(s)-n!=r.depth-s&&o.start(s-1)==r.start(s-1)&&o.node(s-1).canReplace(o.index(s-1),r.index(s-1)))return e.delete(o.before(s),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:o,$to:r,depth:i}=t,s=o.before(i+1),a=r.after(i+1),l=s,c=a,u=Xl.empty,d=0;for(let p=i,m=!1;p>n;p--)m||o.index(p)>0?(m=!0,u=Xl.from(o.node(p).copy(u)),d++):l--;let h=Xl.empty,f=0;for(let p=i,m=!1;p>n;p--)m||r.after(p+1)<r.end(p)?(m=!0,h=Xl.from(r.node(p).copy(h)),f++):c++;e.step(new vu(l,c,s,a,new tc(u.append(h),d,f),u.size-d,!0))}(this,e,t),this}join(e){return function(e,t,n){let o=null,{linebreakReplacement:r}=e.doc.type.schema,i=e.doc.resolve(t-n),s=i.node().type;if(r&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(r);e&&!t?o=!1:!e&&t&&(o=!0)}let a=e.steps.length;if(!1===o){let o=e.doc.resolve(t+n);Eu(e,o.node(),o.before(),a)}s.inlineContent&&bu(e,t+n-1,s,i.node().contentMatchAt(i.index()),null==o);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new gu(c,l.map(t+n,-1),tc.empty,!0)),!0===o){let t=e.doc.resolve(c);Su(e,t.node(),t.before(),e.steps.length)}}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}wrap(e,t){return function(e,t,n){let o=Xl.empty;for(let s=n.length-1;s>=0;s--){if(o.size){let e=n[s].type.contentMatch.matchFragment(o);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}o=Xl.from(n[s].type.create(n[s].attrs,o))}let r=t.start,i=t.end;e.step(new vu(r,i,r,i,new tc(o,0,0),n.length,!0))}(this,e,t),this}setBlockType(e){return function(e,t,n,o,r){if(!o.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let s="function"==typeof r?r(t):r;if(t.isTextblock&&!t.hasMarkup(o,s)&&function(e,t,n){let o=e.resolve(t),r=o.index();return o.parent.canReplaceWith(r,r+1,n)}(e.doc,e.mapping.slice(i).map(n),o)){let r=null;if(o.schema.linebreakReplacement){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(o.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&Eu(e,t,n,i),bu(e,e.mapping.slice(i).map(n,1),o,void 0,null===r);let a=e.mapping.slice(i),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new vu(l,c,l+1,c-1,new tc(Xl.from(o.create(s,null,t.marks)),0,0),1,!0)),!0===r&&Su(e,t,n,i),!1}})}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}setNodeMarkup(e,t){return function(e,t,n,o,r){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let s=n.create(o,null,r||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new vu(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new tc(Xl.from(s),0,0),1,!0))}(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}setNodeAttribute(e,t,n){return this.step(new Hu(e,t,n)),this}setDocAttribute(e,t){return this.step(new $u(e,t)),this}addNodeMark(e,t){return this.step(new pu(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof Ql)t.isInSet(n.marks)&&this.step(new mu(e,t));else{let o,r=n.marks,i=[];for(;o=t.isInSet(r);)i.push(new mu(e,o)),r=o.removeFromSet(r);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,r=e.doc.resolve(t),i=Xl.empty,s=Xl.empty;for(let a=r.depth,l=r.depth-n,c=n-1;a>l;a--,c--){i=Xl.from(r.node(a).copy(i));let e=o&&o[c];s=Xl.from(e?e.type.create(e.attrs,s):r.node(a).copy(s))}e.step(new gu(t,t,new tc(i.append(s),n,n),!0))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}addMark(e,t,n){return function(e,t,n,o){let r,i,s=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!o.isInSet(u)&&c.type.allowsMarkType(o.type)){let c=Math.max(l,t),d=Math.min(l+e.nodeSize,n),h=o.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(h)||(r&&r.to==c&&r.mark.eq(u[e])?r.to=d:s.push(r=new fu(c,d,u[e])));i&&i.to==c?i.to=d:a.push(i=new hu(c,d,o))}}),s.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,o){let r=[],i=0;e.doc.nodesBetween(t,n,(e,s)=>{if(!e.isInline)return;i++;let a=null;if(o instanceof Fc){let t,n=e.marks;for(;t=o.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else o?o.isInSet(e.marks)&&(a=[o]):a=e.marks;if(a&&a.length){let o=Math.min(s+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<r.length;e++){let t=r[e];t.step==i-1&&l.eq(r[e].style)&&(n=t)}n?(n.to=o,n.step=i):r.push({style:l,from:Math.max(s,t),to:o,step:i})}}}),r.forEach(t=>e.step(new fu(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return bu(this,e,t,n),this}}const qu=Object.create(null);class Ku{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new Yu(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.empty,n=t.content.lastChild,o=null;for(let s=0;s<t.openEnd;s++)o=n,n=n.lastChild;let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:l}=i[s],c=e.mapping.slice(r);e.replaceRange(c.map(a.pos),c.map(l.pos),s?tc.empty:t),0==s&&rd(e,r,(n?n.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,o=this.ranges;for(let r=0;r<o.length;r++){let{$from:i,$to:s}=o[r],a=e.mapping.slice(n),l=a.map(i.pos),c=a.map(s.pos);r?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),rd(e,n,t.isInline?-1:1))}}static findFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.parent.inlineContent?new Gu(e):od(e.node(0),e.parent,e.pos,e.index(),t,n);if(o)return o;for(let r=e.depth-1;r>=0;r--){let o=t<0?od(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):od(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(o)return o}return null}static near(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new td(e.node(0))}static atStart(e){return od(e,e,0,0,1)||new td(e)}static atEnd(e){return od(e,e,e.content.size,e.childCount,-1)||new td(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=qu[t.type];if(!n)throw new RangeError("No selection type ".concat(t.type," defined"));return n.fromJSON(e,t)}static jsonID(e,t){if(e in qu)throw new RangeError("Duplicate use of selection JSON ID "+e);return qu[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Gu.between(this.$anchor,this.$head).getBookmark()}}Ku.prototype.visible=!0;class Yu{constructor(e,t){this.$from=e,this.$to=t}}let Xu=!1;function Zu(e){Xu||e.parent.inlineContent||(Xu=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Gu extends Ku{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;Zu(e),Zu(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return Ku.near(n);let o=e.resolve(t.map(this.anchor));return new Gu(o.parent.inlineContent?o:n,n)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.empty;if(super.replace(e,t),t==tc.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Gu&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ju(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Gu(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=e.resolve(t);return new this(o,n==t?o:e.resolve(n))}static between(e,t,n){let o=e.pos-t.pos;if(n&&!o||(n=o>=0?1:-1),!t.parent.inlineContent){let e=Ku.findFrom(t,n,!0)||Ku.findFrom(t,-n,!0);if(!e)return Ku.near(t,n);t=e.$head}return e.parent.inlineContent||(0==o||(e=(Ku.findFrom(e,-n,!0)||Ku.findFrom(e,n,!0)).$anchor).pos<t.pos!=o<0)&&(e=t),new Gu(e,t)}}Ku.jsonID("text",Gu);class Ju{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ju(e.map(this.anchor),e.map(this.head))}resolve(e){return Gu.between(e.resolve(this.anchor),e.resolve(this.head))}}class Qu extends Ku{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:o}=t.mapResult(this.anchor),r=e.resolve(o);return n?Ku.near(r):new Qu(r)}content(){return new tc(Xl.from(this.node),0,0)}eq(e){return e instanceof Qu&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ed(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Qu(e.resolve(t.anchor))}static create(e,t){return new Qu(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}Qu.prototype.visible=!1,Ku.jsonID("node",Qu);class ed{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Ju(n,n):new ed(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Qu.isSelectable(n)?new Qu(t):Ku.near(t)}}class td extends Ku{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.empty;if(t==tc.empty){e.delete(0,e.doc.content.size);let t=Ku.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new td(e)}map(e){return new td(e)}eq(e){return e instanceof td}getBookmark(){return nd}}Ku.jsonID("all",td);const nd={map(){return this},resolve:e=>new td(e)};function od(e,t,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return Gu.create(e,n);for(let s=o-(r>0?0:1);r>0?s<t.childCount:s>=0;s+=r){let o=t.child(s);if(o.isAtom){if(!i&&Qu.isSelectable(o))return Qu.create(e,n-(r<0?o.nodeSize:0))}else{let t=od(e,o,n+r,r<0?o.childCount:0,r,i);if(t)return t}n+=o.nodeSize*r}return null}function rd(e,t,n){let o=e.steps.length-1;if(o<t)return;let r,i=e.steps[o];(i instanceof gu||i instanceof vu)&&(e.mapping.maps[o].forEach((e,t,n,o)=>{null==r&&(r=o)}),e.setSelection(Ku.near(e.doc.resolve(r),n)))}class id extends Uu{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return Ql.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Ql.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let o=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let r=this.storedMarks;if(!r){let e=this.doc.resolve(t);r=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,o.text(e,r)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection(Ku.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function sd(e,t){return t&&e?e.bind(t):e}class ad{constructor(e,t,n){this.name=e,this.init=sd(t.init,n),this.apply=sd(t.apply,n)}}const ld=[new ad("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new ad("selection",{init:(e,t)=>e.selection||Ku.atStart(t.doc),apply:e=>e.selection}),new ad("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,o)=>o.selection.$cursor?e.storedMarks:null}),new ad("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class cd{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ld.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new ad(e.key,e.spec.state,e))})}}class ud{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),o=null;for(;;){let r=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let a=o?o[i].n:0,l=o?o[i].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!o){o=[];for(let e=0;e<this.config.plugins.length;e++)o.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),r=!0}o&&(o[i]={state:n,n:t.length})}}if(!r)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new ud(this.config),n=this.config.fields;for(let o=0;o<n.length;o++){let r=n[o];t[r.name]=r.apply(e,this[r.name],this,t)}return t}get tr(){return new id(this)}static create(e){let t=new cd(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new ud(t);for(let o=0;o<t.fields.length;o++)n[t.fields[o].name]=t.fields[o].init(e,n);return n}reconfigure(e){let t=new cd(this.schema,e.plugins),n=t.fields,o=new ud(t);for(let r=0;r<n.length;r++){let t=n[r].name;o[t]=this.hasOwnProperty(t)?this[t]:n[r].init(e,o)}return o}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[n],r=o.spec.state;r&&r.toJSON&&(t[n]=r.toJSON.call(o,this[o.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new cd(e.schema,e.plugins),r=new ud(o);return o.fields.forEach(o=>{if("doc"==o.name)r.doc=bc.fromJSON(e.schema,t.doc);else if("selection"==o.name)r.selection=Ku.fromJSON(r.doc,t.selection);else if("storedMarks"==o.name)t.storedMarks&&(r.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],a=s.spec.state;if(s.key==o.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(r[o.name]=a.fromJSON.call(s,e,t[i],r))}r[o.name]=o.init(e,r)}}),r}}function dd(e,t,n){for(let o in e){let r=e[o];r instanceof Function?r=r.bind(t):"handleDOMEvents"==o&&(r=dd(r,t,{})),n[o]=r}return n}class hd{constructor(e){this.spec=e,this.props={},e.props&&dd(e.props,this,this.props),this.key=e.key?e.key.key:pd("plugin")}getState(e){return e[this.key]}}const fd=Object.create(null);function pd(e){return e in fd?e+"$"+ ++fd[e]:(fd[e]=0,e+"$")}class md{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";this.key=pd(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const gd=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function vd(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const yd=(e,t,n)=>{let o=vd(e,n);if(!o)return!1;let r=kd(o);if(!r){let n=o.blockRange(),r=n&&wu(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)}let i=r.nodeBefore;if(Pd(e,r,t,-1))return!0;if(0==o.parent.content.size&&(xd(i,"end")||Qu.isSelectable(i)))for(let s=o.depth;;s--){let n=Tu(e.doc,o.before(s),o.after(s),tc.empty);if(n&&n.slice.size<n.to-n.from){if(t){let o=e.tr.step(n);o.setSelection(xd(i,"end")?Ku.findFrom(o.doc.resolve(o.mapping.map(r.pos,-1)),-1):Qu.create(o.doc,r.pos-i.nodeSize)),t(o.scrollIntoView())}return!0}if(1==s||o.node(s-1).childCount>1)break}return!(!i.isAtom||r.depth!=o.depth-1)&&(t&&t(e.tr.delete(r.pos-i.nodeSize,r.pos).scrollIntoView()),!0)};function bd(e,t,n){let o=t.nodeBefore,r=t.pos-1;for(;!o.isTextblock;r--){if(o.type.spec.isolating)return!1;let e=o.lastChild;if(!e)return!1;o=e}let i=t.nodeAfter,s=t.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let a=Tu(e.doc,r,s,tc.empty);if(!a||a.from!=r||a instanceof gu&&a.slice.size>=s-r)return!1;if(n){let t=e.tr.step(a);t.setSelection(Gu.create(t.doc,r)),n(t.scrollIntoView())}return!0}function xd(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let o=e;o;o="start"==t?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(n&&1!=o.childCount)return!1}return!1}const wd=(e,t,n)=>{let{$head:o,empty:r}=e.selection,i=o;if(!r)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=kd(o)}let s=i&&i.nodeBefore;return!(!s||!Qu.isSelectable(s))&&(t&&t(e.tr.setSelection(Qu.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function kd(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Cd(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const Sd=(e,t,n)=>{let o=Cd(e,n);if(!o)return!1;let r=Dd(o);if(!r)return!1;let i=r.nodeAfter;if(Pd(e,r,t,1))return!0;if(0==o.parent.content.size&&(xd(i,"start")||Qu.isSelectable(i))){let n=Tu(e.doc,o.before(),o.after(),tc.empty);if(n&&n.slice.size<n.to-n.from){if(t){let o=e.tr.step(n);o.setSelection(xd(i,"start")?Ku.findFrom(o.doc.resolve(o.mapping.map(r.pos)),1):Qu.create(o.doc,o.mapping.map(r.pos))),t(o.scrollIntoView())}return!0}}return!(!i.isAtom||r.depth!=o.depth-1)&&(t&&t(e.tr.delete(r.pos,r.pos+i.nodeSize).scrollIntoView()),!0)},Ed=(e,t,n)=>{let{$head:o,empty:r}=e.selection,i=o;if(!r)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=Dd(o)}let s=i&&i.nodeAfter;return!(!s||!Qu.isSelectable(s))&&(t&&t(e.tr.setSelection(Qu.create(e.doc,i.pos)).scrollIntoView()),!0)};function Dd(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const Md=(e,t)=>{let{$head:n,$anchor:o}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function Nd(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Ad=(e,t)=>{let{$head:n,$anchor:o}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(o))return!1;let r=n.node(-1),i=n.indexAfter(-1),s=Nd(r.contentMatchAt(i));if(!s||!r.canReplaceWith(i,i,s))return!1;if(t){let o=n.after(),r=e.tr.replaceWith(o,o,s.createAndFill());r.setSelection(Ku.near(r.doc.resolve(o),1)),t(r.scrollIntoView())}return!0},Od=(e,t)=>{let n=e.selection,{$from:o,$to:r}=n;if(n instanceof td||o.parent.inlineContent||r.parent.inlineContent)return!1;let i=Nd(r.parent.contentMatchAt(r.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!o.parentOffset&&r.index()<r.parent.childCount?o:r).pos,s=e.tr.insert(n,i.createAndFill());s.setSelection(Gu.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},Td=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(Du(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}let o=n.blockRange(),r=o&&wu(o);return null!=r&&(t&&t(e.tr.lift(o,r).scrollIntoView()),!0)};const _d=(e,t)=>{let{$from:n,$to:o}=e.selection;if(e.selection instanceof Qu&&e.selection.node.isBlock)return!(!n.parentOffset||!Du(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let r,i,s=[],a=!1,l=!1;for(let h=n.depth;;h--){if(n.node(h).isBlock){a=n.end(h)==n.pos+(n.depth-h),l=n.start(h)==n.pos-(n.depth-h),i=Nd(n.node(h-1).contentMatchAt(n.indexAfter(h-1)));let e=jd&&jd(o.parent,a,n);s.unshift(e||(a&&i?{type:i}:null)),r=h;break}if(1==h)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof Gu||e.selection instanceof td)&&c.deleteSelection();let u=c.mapping.map(n.pos),d=Du(c.doc,u,s.length,s);if(d||(s[0]=i?{type:i}:null,d=Du(c.doc,u,s.length,s)),!d)return!1;if(c.split(u,s.length,s),!a&&l&&n.node(r).type!=i){let e=c.mapping.map(n.before(r)),t=c.doc.resolve(e);i&&n.node(r-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(r)),i)}return t&&t(c.scrollIntoView()),!0};var jd;function Pd(e,t,n,o){let r,i,s=t.nodeBefore,a=t.nodeAfter,l=s.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let o=t.nodeBefore,r=t.nodeAfter,i=t.index();return!!(o&&r&&o.type.compatibleContent(r.type))&&(!o.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(i,i+1)||!r.isTextblock&&!Mu(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(r=(i=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&i.matchType(r[0]||a.type).validEnd){if(n){let o=t.pos+a.nodeSize,i=Xl.empty;for(let e=r.length-1;e>=0;e--)i=Xl.from(r[e].create(null,i));i=Xl.from(s.copy(i));let l=e.tr.step(new vu(t.pos-1,o,t.pos,o,new tc(i,1,0),r.length,!0)),c=l.doc.resolve(o+2*r.length);c.nodeAfter&&c.nodeAfter.type==s.type&&Mu(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=a.type.spec.isolating||o>0&&l?null:Ku.findFrom(t,1),d=u&&u.$from.blockRange(u.$to),h=d&&wu(d);if(null!=h&&h>=t.depth)return n&&n(e.tr.lift(d,h).scrollIntoView()),!0;if(c&&xd(a,"start",!0)&&xd(s,"end")){let o=s,r=[];for(;r.push(o),!o.isTextblock;)o=o.lastChild;let i=a,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(o.canReplace(o.childCount,o.childCount,i.content)){if(n){let o=Xl.empty;for(let e=r.length-1;e>=0;e--)o=Xl.from(r[e].copy(o));n(e.tr.step(new vu(t.pos-r.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new tc(o,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Id(e){return function(t,n){let o=t.selection,r=e<0?o.$from:o.$to,i=r.depth;for(;r.node(i).isInline;){if(!i)return!1;i--}return!!r.node(i).isTextblock&&(n&&n(t.tr.setSelection(Gu.create(t.doc,e<0?r.start(i):r.end(i)))),!0)}}const Rd=Id(-1),Fd=Id(1);function zd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,o){let r=!1;for(let i=0;i<n.selection.ranges.length&&!r;i++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[i];n.doc.nodesBetween(o,s,(o,i)=>{if(r)return!1;if(o.isTextblock&&!o.hasMarkup(e,t))if(o.type==e)r=!0;else{let t=n.doc.resolve(i),o=t.index();r=t.parent.canReplaceWith(o,o+1,e)}})}if(!r)return!1;if(o){let r=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[o];r.setBlockType(i,s,e,t)}o(r.scrollIntoView())}return!0}}function Ld(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,o){for(let r=0;r<t.length;r++)if(t[r](e,n,o))return!0;return!1}}let Bd=Ld(gd,yd,wd),Vd=Ld(gd,Sd,Ed);const Hd={Enter:Ld(Md,Od,Td,_d),"Mod-Enter":Ad,Backspace:Bd,"Mod-Backspace":Bd,"Shift-Backspace":Bd,Delete:Vd,"Mod-Delete":Vd,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new td(e.doc))),!0)},$d={"Ctrl-h":Hd.Backspace,"Alt-Backspace":Hd["Mod-Backspace"],"Ctrl-d":Hd.Delete,"Ctrl-Alt-Backspace":Hd["Mod-Delete"],"Alt-Delete":Hd["Mod-Delete"],"Alt-d":Hd["Mod-Delete"],"Ctrl-a":Rd,"Ctrl-e":Fd};for(let n in Hd)$d[n]=Hd[n];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function Wd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,o){let{$from:r,$to:i}=n.selection,s=r.blockRange(i);if(!s)return!1;let a=o?n.tr:null;return!!function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!1,i=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=s.resolve(t.start-2);i=new vc(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new vc(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),r=!0}let a=ku(i,n,o,t);if(!a)return!1;e&&function(e,t,n,o,r){let i=Xl.empty;for(let u=n.length-1;u>=0;u--)i=Xl.from(n[u].type.create(n[u].attrs,i));e.step(new vu(t.start-(o?2:0),t.end,t.start,t.end,new tc(i,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==r&&(s=u+1);let a=n.length-s,l=t.start+n.length-(o?2:0),c=t.parent;for(let u=t.startIndex,d=t.endIndex,h=!0;u<d;u++,h=!1)!h&&Du(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(u).nodeSize}(e,t,a,r,n);return!0}(a,s,e,t)&&(o&&o(a.scrollIntoView()),!0)}}function Ud(e){return function(t,n){let{$from:o,$to:r}=t.selection,i=o.blockRange(r,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(o.node(i.depth-1).type==e?function(e,t,n,o){let r=e.tr,i=o.end,s=o.$to.end(o.depth);i<s&&(r.step(new vu(i-1,s,i,s,new tc(Xl.from(n.create(null,o.parent.copy())),1,0),1,!0)),o=new vc(r.doc.resolve(o.$from.pos),r.doc.resolve(s),o.depth));const a=wu(o);if(null==a)return!1;r.lift(o,a);let l=r.doc.resolve(r.mapping.map(i,-1)-1);Mu(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos);return t(r.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let o=e.tr,r=n.parent;for(let f=n.end,p=n.endIndex-1,m=n.startIndex;p>m;p--)f-=r.child(p).nodeSize,o.delete(f-1,f+1);let i=o.doc.resolve(n.start),s=i.nodeAfter;if(o.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==r.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?Xl.empty:Xl.from(r))))return!1;let d=i.pos,h=d+s.nodeSize;return o.step(new vu(d-(a?1:0),h+(l?1:0),d+1,h-1,new tc((a?Xl.empty:Xl.from(r.copy(Xl.empty))).append(l?Xl.empty:Xl.from(r.copy(Xl.empty))),a?0:1,l?0:1),a?0:1)),t(o.scrollIntoView()),!0}(t,n,i)))}}const qd=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Kd=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let Yd=null;const Xd=function(e,t,n){let o=Yd||(Yd=document.createRange());return o.setEnd(e,null==n?e.nodeValue.length:n),o.setStart(e,t||0),o},Zd=function(e,t,n,o){return n&&(Jd(e,t,n,o,-1)||Jd(e,t,n,o,1))},Gd=/^(img|br|input|textarea|hr)$/i;function Jd(e,t,n,o,r){for(var i;;){if(e==n&&t==o)return!0;if(t==(r<0?0:Qd(e))){let n=e.parentNode;if(!n||1!=n.nodeType||eh(e)||Gd.test(e.nodeName)||"false"==e.contentEditable)return!1;t=qd(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(r<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;t+=r}else e=n,t=r<0?Qd(e):0}}}}function Qd(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function eh(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const th=function(e){return e.focusNode&&Zd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function nh(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const oh="undefined"!=typeof navigator?navigator:null,rh="undefined"!=typeof document?document:null,ih=oh&&oh.userAgent||"",sh=/Edge\/(\d+)/.exec(ih),ah=/MSIE \d/.exec(ih),lh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ih),ch=!!(ah||lh||sh),uh=ah?document.documentMode:lh?+lh[1]:sh?+sh[1]:0,dh=!ch&&/gecko\/(\d+)/i.test(ih);dh&&(/Firefox\/(\d+)/.exec(ih)||[0,0])[1];const hh=!ch&&/Chrome\/(\d+)/.exec(ih),fh=!!hh,ph=hh?+hh[1]:0,mh=!ch&&!!oh&&/Apple Computer/.test(oh.vendor),gh=mh&&(/Mobile\/\w+/.test(ih)||!!oh&&oh.maxTouchPoints>2),vh=gh||!!oh&&/Mac/.test(oh.platform),yh=!!oh&&/Win/.test(oh.platform),bh=/Android \d/.test(ih),xh=!!rh&&"webkitFontSmoothing"in rh.documentElement.style,wh=xh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function kh(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Ch(e,t){return"number"==typeof e?e:e[t]}function Sh(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,o=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*o}}function Eh(e,t,n){let o=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let s=n||e.dom;s;){if(1!=s.nodeType){s=Kd(s);continue}let e=s,n=e==i.body,a=n?kh(i):Sh(e),l=0,c=0;if(t.top<a.top+Ch(o,"top")?c=-(a.top-t.top+Ch(r,"top")):t.bottom>a.bottom-Ch(o,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+Ch(r,"top")-a.top:t.bottom-a.bottom+Ch(r,"bottom")),t.left<a.left+Ch(o,"left")?l=-(a.left-t.left+Ch(r,"left")):t.right>a.right-Ch(o,"right")&&(l=t.right-a.right+Ch(r,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,o=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let r=e.scrollLeft-n,i=e.scrollTop-o;t={left:t.left-r,top:t.top-i,right:t.right-r,bottom:t.bottom-i}}let u=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(u))break;s="absolute"==u?s.offsetParent:Kd(s)}}function Dh(e){let t=[],n=e.ownerDocument;for(let o=e;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),e!=n);o=Kd(o));return t}function Mh(e,t){for(let n=0;n<e.length;n++){let{dom:o,top:r,left:i}=e[n];o.scrollTop!=r+t&&(o.scrollTop=r+t),o.scrollLeft!=i&&(o.scrollLeft=i)}}let Nh=null;function Ah(e,t){let n,o,r,i,s=2e8,a=0,l=t.top,c=t.top;for(let u=e.firstChild,d=0;u;u=u.nextSibling,d++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=Xd(u).getClientRects()}for(let h=0;h<e.length;h++){let f=e[h];if(f.top<=l&&f.bottom>=c){l=Math.max(f.bottom,l),c=Math.min(f.top,c);let e=f.left>t.left?f.left-t.left:f.right<t.left?t.left-f.right:0;if(e<s){n=u,s=e,o=e&&3==n.nodeType?{left:f.right<t.left?f.right:f.left,top:t.top}:t,1==u.nodeType&&e&&(a=d+(t.left>=(f.left+f.right)/2?1:0));continue}}else f.top>t.top&&!r&&f.left<=t.left&&f.right>=t.left&&(r=u,i={left:Math.max(f.left,Math.min(f.right,t.left)),top:f.top});!n&&(t.left>=f.right&&t.top>=f.top||t.left>=f.left&&t.top>=f.bottom)&&(a=d+1)}}return!n&&r&&(n=r,o=i,s=0),n&&3==n.nodeType?function(e,t){let n,o=e.nodeValue.length,r=document.createRange();for(let i=0;i<o;i++){r.setEnd(e,i+1),r.setStart(e,i);let o=Ph(r,1);if(o.top!=o.bottom&&Oh(t,o)){n={node:e,offset:i+(t.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),n||{node:e,offset:0}}(n,o):!n||s&&1==n.nodeType?{node:e,offset:a}:Ah(n,o)}function Oh(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Th(e,t,n){let o=e.childNodes.length;if(o&&n.top<n.bottom)for(let r=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-n.top)/(n.bottom-n.top))-2)),i=r;;){let n=e.childNodes[i];if(1==n.nodeType){let e=n.getClientRects();for(let o=0;o<e.length;o++){let r=e[o];if(Oh(t,r))return Th(n,t,r)}}if((i=(i+1)%o)==r)break}return e}function _h(e,t){let n,o=e.dom.ownerDocument,r=0,i=function(e,t,n){if(e.caretPositionFromPoint)try{let o=e.caretPositionFromPoint(t,n);if(o)return{node:o.offsetNode,offset:Math.min(Qd(o.offsetNode),o.offset)}}catch(o){}if(e.caretRangeFromPoint){let o=e.caretRangeFromPoint(t,n);if(o)return{node:o.startContainer,offset:Math.min(Qd(o.startContainer),o.startOffset)}}}(o,t.left,t.top);i&&({node:n,offset:r}=i);let s,a=(e.root.elementFromPoint?e.root:o).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!Oh(t,n))return null;if(a=Th(e.dom,t,n),!a)return null}if(mh)for(let c=a;n&&c;c=Kd(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(dh&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let e,o=n.childNodes[r];"IMG"==o.nodeName&&(e=o.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&r++}let o;xh&&r&&1==n.nodeType&&1==(o=n.childNodes[r-1]).nodeType&&"false"==o.contentEditable&&o.getBoundingClientRect().top>=t.top&&r--,n==e.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?s=e.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(s=function(e,t,n,o){let r=-1;for(let i=t,s=!1;i!=e.dom;){let t,n=e.docView.nearestDesc(i,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!s&&t.left>o.left||t.top>o.top?r=n.posBefore:(!s&&t.right<o.left||t.bottom<o.top)&&(r=n.posAfter),s=!0),!n.contentDOM&&r<0&&!n.node.isText))return(n.node.isBlock?o.top<(t.top+t.bottom)/2:o.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;i=n.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,n,-1)}(e,n,r,t))}null==s&&(s=function(e,t,n){let{node:o,offset:r}=Ah(t,n),i=-1;if(1==o.nodeType&&!o.firstChild){let e=o.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(o,r,i)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function jh(e){return e.top<e.bottom||e.left<e.right}function Ph(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(jh(e))return e}return Array.prototype.find.call(n,jh)||e.getBoundingClientRect()}const Ih=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Rh(e,t,n){let{node:o,offset:r,atom:i}=e.docView.domFromPos(t,n<0?-1:1),s=xh||dh;if(3==o.nodeType){if(!s||!Ih.test(o.nodeValue)&&(n<0?r:r!=o.nodeValue.length)){let e=r,t=r,i=n<0?1:-1;return n<0&&!r?(t++,i=-1):n>=0&&r==o.nodeValue.length?(e--,i=1):n<0?e--:t++,Fh(Ph(Xd(o,e,t),i),i<0)}{let e=Ph(Xd(o,r,r),n);if(dh&&r&&/\s/.test(o.nodeValue[r-1])&&r<o.nodeValue.length){let t=Ph(Xd(o,r-1,r-1),-1);if(t.top==e.top){let n=Ph(Xd(o,r,r+1),-1);if(n.top!=e.top)return Fh(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&r&&(n<0||r==Qd(o))){let e=o.childNodes[r-1];if(1==e.nodeType)return zh(e.getBoundingClientRect(),!1)}if(null==i&&r<Qd(o)){let e=o.childNodes[r];if(1==e.nodeType)return zh(e.getBoundingClientRect(),!0)}return zh(o.getBoundingClientRect(),n>=0)}if(null==i&&r&&(n<0||r==Qd(o))){let e=o.childNodes[r-1],t=3==e.nodeType?Xd(e,Qd(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return Fh(Ph(t,1),!1)}if(null==i&&r<Qd(o)){let e=o.childNodes[r];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?Xd(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return Fh(Ph(t,-1),!0)}return Fh(Ph(3==o.nodeType?Xd(o):o,-n),n>=0)}function Fh(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function zh(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function Lh(e,t,n){let o=e.state,r=e.root.activeElement;o!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return n()}finally{o!=t&&e.updateState(o),r!=e.dom&&r&&r.focus()}}const Bh=/[\u0590-\u08ac]/;let Vh=null,Hh=null,$h=!1;function Wh(e,t,n){return Vh==t&&Hh==n?$h:(Vh=t,Hh=n,$h="up"==n||"down"==n?function(e,t,n){let o=t.selection,r="up"==n?o.$from:o.$to;return Lh(e,t,()=>{let{node:t}=e.docView.domFromPos(r.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let o=Rh(e,r.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=Xd(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let r=t[e];if(r.bottom>r.top+1&&("up"==n?o.top-r.top>2*(r.bottom-o.top):r.bottom-o.bottom>2*(o.bottom-r.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let r=o.parentOffset,i=!r,s=r==o.parent.content.size,a=e.domSelection();return a?Bh.test(o.parent.textContent)&&a.modify?Lh(e,t,()=>{let{focusNode:t,focusOffset:r,anchorNode:i,anchorOffset:s}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=o.depth?e.docView.domAfterPos(o.before()):e.dom,{focusNode:u,focusOffset:d}=e.domSelectionRange(),h=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&r==d;try{a.collapse(i,s),t&&(t!=i||r!=s)&&a.extend&&a.extend(t,r)}catch(f){}return null!=l&&(a.caretBidiLevel=l),h}):"left"==n||"backward"==n?i:s:o.pos==o.start()||o.pos==o.end()}(e,t,n))}class Uh{constructor(e,t,n,o){this.parent=e,this.children=t,this.dom=n,this.contentDOM=o,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let o=this.children[t];if(o==e)return n;n+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,o;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(o=n.pmViewDesc)||o.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(o)+o.size:this.posAtStart}{let n,o;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(o=n.pmViewDesc)||o.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(o):this.posAtEnd}}let o;if(e==this.dom&&this.contentDOM)o=t>qd(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){o=!1;break}if(t.previousSibling)break}if(null==o&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){o=!0;break}if(t.nextSibling)break}}return(null==o?n>0:o)?this.posAtEnd:this.posAtStart}nearestDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let n=!0,o=e;o;o=o.parentNode){let r,i=this.getDesc(o);if(i&&(!t||i.node)){if(!n||!(r=i.nodeDOM)||(1==r.nodeType?r.contains(1==e.nodeType?e:e.parentNode):r==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let o=e;o;o=o.parentNode){let r=this.getDesc(o);if(r)return r.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let o=this.children[t],r=n+o.size;if(n==e&&r!=n){for(;!o.border&&o.children.length;)for(let e=0;e<o.children.length;e++){let t=o.children[e];if(t.size){o=t;break}}return o}if(e<r)return o.descAt(e-n-o.border);n=r}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,o=0;for(let r=0;n<this.children.length;n++){let t=this.children[n],i=r+t.size;if(i>e||t instanceof Jh){o=e-r;break}r=i}if(o)return this.children[n].domFromPos(o-this.children[n].border,t);for(let r;n&&!(r=this.children[n-1]).size&&r instanceof qh&&r.side>=0;n--);if(t<=0){let e,o=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,o=!1);return e&&t&&o&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?qd(e.dom)+1:0}}{let e,o=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,o=!1);return e&&o&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?qd(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,r=-1;for(let i=n,s=0;;s++){let n=this.children[s],a=i+n.size;if(-1==o&&e<=a){let r=i+n.border;if(e>=r&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,r);e=i;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){o=qd(n.dom)+1;break}e-=n.size}-1==o&&(o=0)}if(o>-1&&(a>t||s==this.children.length-1)){t=a;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){r=qd(n.dom);break}t+=n.size}-1==r&&(r=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:e,to:t,fromOffset:o,toOffset:r}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Math.min(e,t),i=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let s=this.children[f],a=p+s.size;if(r>p&&i<a)return s.setSelection(e-p-s.border,t-p-s.border,n,o);p=a}let s=this.domFromPos(e,e?-1:1),a=t==e?s:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((dh||mh)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let n,o=e;o;o=o.parentNode){if(n=o.nextSibling){"BR"==n.nodeName&&(s=a={node:n.parentNode,offset:qd(n)+1});break}let e=o.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(dh&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(o=!0)}if(!(o||u&&mh)&&Zd(s.node,s.offset,c.anchorNode,c.anchorOffset)&&Zd(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((l.extend||e==t)&&(!u||!dh)){l.collapse(s.node,s.offset);try{e!=t&&l.extend(a.node,a.offset),d=!0}catch(h){}}if(!d){if(e>t){let e=s;s=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,o=0;o<this.children.length;o++){let r=this.children[o],i=n+r.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let o=n+r.border,s=i-r.border;if(e>=o&&t<=s)return this.dirty=e==n||t==i?2:1,void(e!=o||t!=s||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(e-o,t-o):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class qh extends Uh{constructor(e,t,n,o){let r,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>r?r.parent?r.parent.posBeforeChild(r):void 0:o)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,r=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Kh extends Uh{constructor(e,t,n,o){super(e,[],t,null),this.textDOM=n,this.text=o}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class Yh extends Uh{constructor(e,t,n,o,r){super(e,[],n,o),this.mark=t,this.spec=r}static create(e,t,n,o){let r=o.nodeViews[t.type.name],i=r&&r(t,o,n);return i&&i.dom||(i=Zc.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new Yh(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let o=Yh.create(this.parent,this.mark,!0,n),r=this.children,i=this.size;t<i&&(r=hf(r,t,i,n)),e>0&&(r=hf(r,0,e,n));for(let s=0;s<r.length;s++)r[s].parent=o;return o.children=r,o}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Xh extends Uh{constructor(e,t,n,o,r,i,s,a,l){super(e,[],r,i),this.node=t,this.outerDeco=n,this.innerDeco=o,this.nodeDOM=s}static create(e,t,n,o,r,i){let s,a=r.nodeViews[t.type.name],l=a&&a(t,r,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i,n,o),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=Zc.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:u}=e)}u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=af(c,n,t),l?s=new Qh(e,t,n,o,c,u||null,d,l,r,i+1):t.isText?new Gh(e,t,n,o,c,d,r):new Xh(e,t,n,o,c,u||null,d,r,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Xl.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&lf(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,o=t,r=e.composing?this.localCompositionInfo(e,t):null,i=r&&r.pos>-1?r:null,s=r&&r.pos<0,a=new uf(this,i&&i.node,e);!function(e,t,n,o){let r=t.locals(e),i=0;if(0==r.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);o(s,r,t.forChild(i,s),n),i+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d,h,f;for(;s<r.length&&r[s].to==i;){let e=r[s++];e.widget&&(u?(d||(d=[u])).push(e):u=e)}if(u)if(d){d.sort(df);for(let e=0;e<d.length;e++)n(d[e],c,!!l)}else n(u,c,!!l);if(l)f=-1,h=l,l=null;else{if(!(c<e.childCount))break;f=c,h=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=i&&a.splice(e--,1);for(;s<r.length&&r[s].from<=i&&r[s].to>i;)a.push(r[s++]);let p=i+h.nodeSize;if(h.isText){let e=p;s<r.length&&r[s].from<e&&(e=r[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<p&&(l=h.cut(e-i),h=h.cut(0,e-i),p=e,f=-1)}else for(;s<r.length&&r[s].to<p;)s++;o(h,h.isInline&&!h.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(i,h),f),i=p}}(this.node,this.innerDeco,(t,r,i)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&a.syncToMarks(r==this.node.childCount?Ql.none:this.node.child(r).marks,n,e),a.placeWidget(t,e,o)},(t,i,l,c)=>{let u;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,i,l,c)||s&&e.state.selection.from>o&&e.state.selection.to<o+t.nodeSize&&(u=a.findIndexWithChild(r.node))>-1&&a.updateNodeAt(t,i,l,u,e)||a.updateNextNode(t,i,l,e,c,o)||a.addNode(t,i,l,e,o),o+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),ef(this.contentDOM,this.children,e),gh&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:o}=e.state.selection;if(!(e.state.selection instanceof Gu)||n<t||o>t+this.node.content.size)return null;let r=e.input.compositionNode;if(!r||!this.dom.contains(r.parentNode))return null;if(this.node.inlineContent){let e=r.nodeValue,i=function(e,t,n,o){for(let r=0,i=0;r<e.childCount&&i<=o;){let s=e.child(r++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;r<e.childCount;){let t=e.child(r++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=o&&l.slice(o-t.length-a,o-a)==t)return o-t.length;let e=a<o?l.lastIndexOf(t,o-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==o&&l.length>=o+t.length-a&&l.slice(o-a,o-a+t.length)==t)return o}}return-1}(this.node.content,e,n-t,o-t);return i<0?null:{node:r,pos:i,text:e}}return{node:r,pos:-1,text:""}}protectLocalComposition(e,t){let{node:n,pos:o,text:r}=t;if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new Kh(this,i,n,r);e.input.compositionNodes.push(s),this.children=hf(this.children,o,o+r.length,e,s)}update(e,t,n,o){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,o),!0)}updateInner(e,t,n,o){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(lf(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=rf(this.dom,this.nodeDOM,of(this.outerDeco,this.node,t),of(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Zh(e,t,n,o,r){af(o,t,e);let i=new Xh(void 0,e,t,n,o,o,o,r,0);return i.contentDOM&&i.updateChildren(r,0),i}class Gh extends Xh{constructor(e,t,n,o,r,i,s){super(e,t,n,o,r,null,i,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,o){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let o=this.node.cut(e,t),r=document.createTextNode(o.text);return new Gh(this.parent,o,this.outerDeco,this.innerDeco,r,r,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Jh extends Uh{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class Qh extends Xh{constructor(e,t,n,o,r,i,s,a,l,c){super(e,t,n,o,r,i,s,l,c),this.spec=a}update(e,t,n,o){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let r=this.spec.update(e,t,n);return r&&this.updateInner(e,t,n,o),r}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,o){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ef(e,t,n){let o=e.firstChild,r=!1;for(let i=0;i<t.length;i++){let s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=o;)o=cf(o),r=!0;o=o.nextSibling}else r=!0,e.insertBefore(a,o);if(s instanceof Yh){let t=o?o.previousSibling:e.lastChild;ef(s.contentDOM,s.children,n),o=t?t.nextSibling:e.firstChild}}for(;o;)o=cf(o),r=!0;r&&n.trackWrites==e&&(n.trackWrites=null)}const tf=function(e){e&&(this.nodeName=e)};tf.prototype=Object.create(null);const nf=[new tf];function of(e,t,n){if(0==e.length)return nf;let o=n?nf[0]:new tf,r=[o];for(let i=0;i<e.length;i++){let s=e[i].type.attrs;if(s){s.nodeName&&r.push(o=new tf(s.nodeName));for(let e in s){let i=s[e];null!=i&&(n&&1==r.length&&r.push(o=new tf(t.isInline?"span":"div")),"class"==e?o.class=(o.class?o.class+" ":"")+i:"style"==e?o.style=(o.style?o.style+";":"")+i:"nodeName"!=e&&(o[e]=i))}}}return r}function rf(e,t,n,o){if(n==nf&&o==nf)return t;let r=t;for(let i=0;i<o.length;i++){let t=o[i],s=n[i];if(i){let n;s&&s.nodeName==t.nodeName&&r!=e&&(n=r.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(r),s=nf[0]),r=n}sf(r,s||nf[0],t)}return r}function sf(e,t,n){for(let o in t)"class"==o||"style"==o||"nodeName"==o||o in n||e.removeAttribute(o);for(let o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){let o=t.class?t.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.remove(o[t]);for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.add(r[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=o.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function af(e,t,n){return rf(e,e,nf,of(t,n,1!=e.nodeType))}function lf(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function cf(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class uf{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,o=n.children.length,r=e.childCount,i=new Map,s=[];e:for(;r>0;){let a;for(;;)if(o){let e=n.children[o-1];if(!(e instanceof Yh)){a=e,o--;break}n=e,o=e.children.length}else{if(n==t)break e;o=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(r-1))break;--r,i.set(a,r),s.push(a)}}return{index:r,matched:i,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let o=0,r=this.stack.length>>1,i=Math.min(r,e.length);for(;o<i&&(o==r-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&!1!==e[o].type.spec.spanning;)o++;for(;o<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<e.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[r])&&!this.isLocked(n.dom)){o=t;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let o=Yh.create(this.top,e[r],t,n);this.top.children.splice(this.index,0,o),this.top=o,this.changed=!0}this.index=0,r++}}findNodeMatch(e,t,n,o){let r,i=-1;if(o>=this.preMatch.index&&(r=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&r.matchesNode(e,t,n))i=this.top.children.indexOf(r,this.index);else for(let s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){let o=this.top.children[s];if(o.matchesNode(e,t,n)&&!this.preMatch.matched.has(o)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,o,r){let i=this.top.children[o];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,r)&&(this.destroyBetween(this.index,o),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,o,r,i){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof Xh){let l=this.preMatch.matched.get(a);if(null!=l&&l!=r)return!1;let c,u=a.dom,d=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&lf(t,a.outerDeco));if(!d&&a.update(e,t,n,o))return this.destroyBetween(this.index,s),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(a,e,t,n,o,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(o,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,o,r,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!lf(n,e.outerDeco)||!o.eq(e.innerDeco))return null;let s=Xh.create(this.top,t,n,o,r,i);if(s.contentDOM){s.children=e.children,e.children=[];for(let e of s.children)e.parent=s}return e.destroy(),s}addNode(e,t,n,o,r){let i=Xh.create(this.top,e,t,n,o,r);i.contentDOM&&i.updateChildren(o,r+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(!o||!o.matchesWidget(e)||e!=o.widget&&o.widget.type.toDOM.parentNode){let o=new qh(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Yh;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Gh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((mh||fh)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let o=new Jh(this.top,[],n,null);t!=this.top?t.children.push(o):t.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function df(e,t){return e.type.side-t.type.side}function hf(e,t,n,o,r){let i=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,u=a+=l.size;c>=n||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,o)),r&&(i.push(r),r=void 0),u>n&&i.push(l.slice(n-c,l.size,o)))}return i}function ff(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.domSelectionRange(),o=e.state.doc;if(!n.focusNode)return null;let r=e.docView.nearestDesc(n.focusNode),i=r&&0==r.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=o.resolve(s);if(th(n)){for(a=s;r&&!r.node;)r=r.parent;let e=r.node;if(r&&e.isAtom&&Qu.isSelectable(e)&&r.parent&&(!e.isInline||!function(e,t,n){for(let o=0==t,r=t==Qd(e);o||r;){if(e==n)return!0;let t=qd(e);if(!(e=e.parentNode))return!1;o=o&&0==t,r=r&&t==Qd(e)}}(n.focusNode,n.focusOffset,r.dom))){let e=r.posBefore;l=new Qu(s==e?c:o.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=s,r=s;for(let o=0;o<n.rangeCount;o++){let i=n.getRangeAt(o);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),r=Math.max(r,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[a,s]=r==e.state.selection.anchor?[r,t]:[t,r],c=o.resolve(s)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=o.resolve(a);if(!l){l=kf(e,u,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function pf(e){return e.editable?e.hasFocus():Sf(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function mf(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.state.selection;if(xf(e,n),pf(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&fh){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&Zd(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,o="IMG"==n.nodeName;o?t.collapse(n.parentNode,qd(n)+1):t.collapse(n,0);!o&&!e.state.selection.visible&&ch&&uh<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let o,r,{anchor:i,head:s}=n;!gf||n instanceof Gu||(n.$from.parent.inlineContent||(o=vf(e,n.from)),n.empty||n.$from.parent.inlineContent||(r=vf(e,n.to))),e.docView.setSelection(i,s,e,t),gf&&(o&&bf(o),r&&bf(r)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),o=n.anchorNode,r=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==o&&n.anchorOffset==r||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{pf(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const gf=mh||fh&&ph<63;function vf(e,t){let{node:n,offset:o}=e.docView.domFromPos(t,0),r=o<n.childNodes.length?n.childNodes[o]:null,i=o?n.childNodes[o-1]:null;if(mh&&r&&"false"==r.contentEditable)return yf(r);if((!r||"false"==r.contentEditable)&&(!i||"false"==i.contentEditable)){if(r)return yf(r);if(i)return yf(i)}}function yf(e){return e.contentEditable="true",mh&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function bf(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function xf(e,t){if(t instanceof Qu){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(wf(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else wf(e)}function wf(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function kf(e,t,n,o){return e.someProp("createSelectionBetween",o=>o(e,t,n))||Gu.between(t,n,o)}function Cf(e){return!(e.editable&&!e.hasFocus())&&Sf(e)}function Sf(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function Ef(e,t){let{$anchor:n,$head:o}=e.selection,r=t>0?n.max(o):n.min(o),i=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return i&&Ku.findFrom(i,t)}function Df(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Mf(e,t,n){let o=e.state.selection;if(!(o instanceof Gu)){if(o instanceof Qu&&o.node.isInline)return Df(e,new Gu(t>0?o.$to:o.$from));{let n=Ef(e.state,t);return!!n&&Df(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=o,r=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+r.nodeSize*(t<0?-1:1));return Df(e,new Gu(o.$anchor,i))}if(!o.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=Ef(e.state,t);return!!(n&&n instanceof Qu)&&Df(e,n)}if(!(vh&&n.indexOf("m")>-1)){let n,r=o.$head,i=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!i||i.isText)return!1;let s=t<0?r.pos-i.nodeSize:r.pos;return!!(i.isAtom||(n=e.docView.descAt(s))&&!n.contentDOM)&&(Qu.isSelectable(i)?Df(e,new Qu(t<0?e.state.doc.resolve(r.pos-i.nodeSize):r)):!!xh&&Df(e,new Gu(e.state.doc.resolve(t<0?s:s+i.nodeSize))))}}function Nf(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Af(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function Of(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let r,i,s=!1;dh&&1==n.nodeType&&o<Nf(n)&&Af(n.childNodes[o],-1)&&(s=!0);for(;;)if(o>0){if(1!=n.nodeType)break;{let e=n.childNodes[o-1];if(Af(e,-1))r=n,i=--o;else{if(3!=e.nodeType)break;n=e,o=n.nodeValue.length}}}else{if(Tf(n))break;{let t=n.previousSibling;for(;t&&Af(t,-1);)r=n.parentNode,i=qd(t),t=t.previousSibling;if(t)n=t,o=Nf(n);else{if(n=n.parentNode,n==e.dom)break;o=0}}}s?_f(e,n,o):r&&_f(e,r,i)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,o=t.focusOffset;if(!n)return;let r,i,s=Nf(n);for(;;)if(o<s){if(1!=n.nodeType)break;if(!Af(n.childNodes[o],1))break;r=n,i=++o}else{if(Tf(n))break;{let t=n.nextSibling;for(;t&&Af(t,1);)r=t.parentNode,i=qd(t)+1,t=t.nextSibling;if(t)n=t,o=0,s=Nf(n);else{if(n=n.parentNode,n==e.dom)break;o=s=0}}}r&&_f(e,r,i)}(e)}function Tf(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function _f(e,t,n){if(3!=t.nodeType){let e,o;(o=function(e,t){for(;e&&t==e.childNodes.length&&!eh(e);)t=qd(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=o,n=0):(e=function(e,t){for(;e&&!t&&!eh(e);)t=qd(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let o=e.domSelection();if(!o)return;if(th(o)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),o.removeAllRanges(),o.addRange(e)}else o.extend&&o.extend(t,n);e.domObserver.setCurSelection();let{state:r}=e;setTimeout(()=>{e.state==r&&mf(e)},50)}function jf(e,t){let n=e.state.doc.resolve(t);if(!fh&&!yh&&n.parent.inlineContent){let o=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),r=(n.top+n.bottom)/2;if(r>o.top&&r<o.bottom&&Math.abs(n.left-o.left)>1)return n.left<o.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),r=(n.top+n.bottom)/2;if(r>o.top&&r<o.bottom&&Math.abs(n.left-o.left)>1)return n.left>o.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function Pf(e,t,n){let o=e.state.selection;if(o instanceof Gu&&!o.empty||n.indexOf("s")>-1)return!1;if(vh&&n.indexOf("m")>-1)return!1;let{$from:r,$to:i}=o;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=Ef(e.state,t);if(n&&n instanceof Qu)return Df(e,n)}if(!r.parent.inlineContent){let n=t<0?r:i,s=o instanceof td?Ku.near(n,t):Ku.findFrom(n,t);return!!s&&Df(e,s)}return!1}function If(e,t){if(!(e.state.selection instanceof Gu))return!0;let{$head:n,$anchor:o,empty:r}=e.state.selection;if(!n.sameParent(o))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=e.state.tr;return t<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),e.dispatch(o),!0}return!1}function Rf(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function Ff(e,t){let n=t.keyCode,o=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||vh&&72==n&&"c"==o)return If(e,-1)||Of(e,-1);if(46==n&&!t.shiftKey||vh&&68==n&&"c"==o)return If(e,1)||Of(e,1);if(13==n||27==n)return!0;if(37==n||vh&&66==n&&"c"==o){let t=37==n?"ltr"==jf(e,e.state.selection.from)?-1:1:-1;return Mf(e,t,o)||Of(e,t)}if(39==n||vh&&70==n&&"c"==o){let t=39==n?"ltr"==jf(e,e.state.selection.from)?1:-1:1;return Mf(e,t,o)||Of(e,t)}return 38==n||vh&&80==n&&"c"==o?Pf(e,-1,o)||Of(e,-1):40==n||vh&&78==n&&"c"==o?function(e){if(!mh||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;Rf(e,n,"true"),setTimeout(()=>Rf(e,n,"false"),20)}return!1}(e)||Pf(e,1,o)||Of(e,1):o==(vh?"m":"c")&&(66==n||73==n||89==n||90==n)}function zf(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:o,openStart:r,openEnd:i}=t;for(;r>1&&i>1&&1==o.childCount&&1==o.firstChild.childCount;){r--,i--;let e=o.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),o=e.content}let s=e.someProp("clipboardSerializer")||Zc.fromSchema(e.state.schema),a=Yf(),l=a.createElement("div");l.appendChild(s.serializeFragment(o,{document:a}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=qf[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),d++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice","".concat(r," ").concat(i).concat(d?" -".concat(d):""," ").concat(JSON.stringify(n))),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function Lf(e,t,n,o,r){let i,s,a=r.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(o||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||o,e)}),a)return s=new tc(Xl.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{s=t(s,e,!0)}),s;let n=e.someProp("clipboardTextParser",n=>n(t,r,o,e));if(n)s=n;else{let n=r.marks(),{schema:o}=e.state,s=Zc.fromSchema(o);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(s.serializeNode(o.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,o=Yf().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);(n=r&&qf[r[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(o.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;Xf||(Xf=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return Xf.createHTML(e)}(e),n)for(let i=0;i<n.length;i++)o=o.querySelector(n[i])||o;return o}(n),xh&&function(e){let t=e.querySelectorAll(fh?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let o=t[n];1==o.childNodes.length&&"\xa0"==o.textContent&&o.parentNode&&o.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),o)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!s){let t=e.someProp("clipboardParser")||e.someProp("domParser")||Bc.fromSchema(e.state.schema);s=t.parseSlice(i,{preserveWhitespace:!(!l&&!u),context:r,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||Bf.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)s=function(e,t){if(!e.size)return e;let n,o=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(a){return e}let{content:r,openStart:i,openEnd:s}=e;for(let l=n.length-2;l>=0;l-=2){let e=o.nodes[n[l]];if(!e||e.hasRequiredAttrs())break;r=Xl.from(e.create(n[l+1],r)),i++,s++}return new tc(r,i,s)}(Uf(s,+u[1],+u[2]),u[4]);else if(s=tc.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let o,r=t.node(n).contentMatchAt(t.index(n)),i=[];if(e.forEach(e=>{if(!i)return;let t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&Hf(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=$f(i[i.length-1],o.length));let t=Vf(e,n);i.push(t),r=r.matchType(t.type),o=n}}),i)return Xl.from(i)}return e}(s.content,r),!0),s.openStart||s.openEnd){let e=0,t=0;for(let n=s.content.firstChild;e<s.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=s.content.lastChild;t<s.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);s=Uf(s,e,t)}return e.someProp("transformPasted",t=>{s=t(s,e,l)}),s}const Bf=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Vf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let o=t.length-1;o>=n;o--)e=t[o].create(null,Xl.from(e));return e}function Hf(e,t,n,o,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let i=Hf(e,t,n,o.lastChild,r+1);if(i)return o.copy(o.content.replaceChild(o.childCount-1,i));if(o.contentMatchAt(o.childCount).matchType(r==e.length-1?n.type:e[r+1]))return o.copy(o.content.append(Xl.from(Vf(n,e,r+1))))}}function $f(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,$f(e.lastChild,t-1)),o=e.contentMatchAt(e.childCount).fillBefore(Xl.empty,!0);return e.copy(n.append(o))}function Wf(e,t,n,o,r,i){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(i=0),r<o-1&&(a=Wf(a,t,n,o,r+1,i)),r>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,i<=r).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(Xl.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Uf(e,t,n){return t<e.openStart&&(e=new tc(Wf(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new tc(Wf(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const qf={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Kf=null;function Yf(){return Kf||(Kf=document.implementation.createHTMLDocument("title"))}let Xf=null;const Zf={},Gf={},Jf={touchstart:!0,touchmove:!0};class Qf{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ep(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function tp(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>np(e,t))})}function np(e,t){return e.someProp("handleDOMEvents",n=>{let o=n[t.type];return!!o&&(o(e,t)||t.defaultPrevented)})}function op(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function rp(e){return{left:e.clientX,top:e.clientY}}function ip(e,t,n,o,r){if(-1==o)return!1;let i=e.state.doc.resolve(o);for(let s=i.depth+1;s>0;s--)if(e.someProp(t,t=>s>i.depth?t(e,n,i.nodeAfter,i.before(s),r,!0):t(e,n,i.node(s),i.before(s),r,!1)))return!0;return!1}function sp(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let o=e.state.tr.setSelection(t);"pointer"==n&&o.setMeta("pointer",!0),e.dispatch(o)}function ap(e,t,n,o,r){return ip(e,"handleClickOn",t,n,o)||e.someProp("handleClick",n=>n(e,t,o))||(r?function(e,t){if(-1==t)return!1;let n,o,r=e.state.selection;r instanceof Qu&&(n=r.node);let i=e.state.doc.resolve(t);for(let s=i.depth+1;s>0;s--){let e=s>i.depth?i.nodeAfter:i.node(s);if(Qu.isSelectable(e)){o=n&&r.$from.depth>0&&s>=r.$from.depth&&i.before(r.$from.depth+1)==r.$from.pos?i.before(r.$from.depth):i.before(s);break}}return null!=o&&(sp(e,Qu.create(e.state.doc,o),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),o=n.nodeAfter;return!!(o&&o.isAtom&&Qu.isSelectable(o))&&(sp(e,new Qu(n),"pointer"),!0)}(e,n))}function lp(e,t,n,o){return ip(e,"handleDoubleClickOn",t,n,o)||e.someProp("handleDoubleClick",n=>n(e,t,o))}function cp(e,t,n,o){return ip(e,"handleTripleClickOn",t,n,o)||e.someProp("handleTripleClick",n=>n(e,t,o))||function(e,t,n){if(0!=n.button)return!1;let o=e.state.doc;if(-1==t)return!!o.inlineContent&&(sp(e,Gu.create(o,0,o.content.size),"pointer"),!0);let r=o.resolve(t);for(let i=r.depth+1;i>0;i--){let t=i>r.depth?r.nodeAfter:r.node(i),n=r.before(i);if(t.inlineContent)sp(e,Gu.create(o,n+1,n+1+t.content.size),"pointer");else{if(!Qu.isSelectable(t))continue;sp(e,Qu.create(o,n),"pointer")}return!0}}(e,n,o)}function up(e){return yp(e)}Gf.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!fp(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!bh||!fh||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!gh||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||Ff(e,n)?n.preventDefault():ep(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,nh(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},Gf.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},Gf.keypress=(e,t)=>{let n=t;if(fp(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||vh&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let o=e.state.selection;if(!(o instanceof Gu)||!o.$from.sameParent(o.$to)){let t=String.fromCharCode(n.charCode),r=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,o.$from.pos,o.$to.pos,t,r))||e.dispatch(r()),n.preventDefault()}};const dp=vh?"metaKey":"ctrlKey";Zf.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let o=up(e),r=Date.now(),i="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,o=t.y-e.clientY;return n*n+o*o<100}(n,e.input.lastClick)&&!n[dp]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:i,button:n.button};let s=e.posAtCoords(rp(n));s&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new hp(e,s,n,!!o)):("doubleClick"==i?lp:cp)(e,s.pos,s.inside,n)?n.preventDefault():ep(e,"pointer"))};class hp{constructor(e,t,n,o){let r,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[dp],this.allowDefault=n.shiftKey,t.inside>-1)r=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);r=n.parent,i=n.depth?n.before():0}const s=o?null:n.target,a=s?e.docView.nearestDesc(s,!0):null;this.target=a&&1==a.nodeDOM.nodeType?a.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof Qu&&l.from<=i&&l.to>i)&&(this.mightDrag={node:r,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!dh||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ep(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>mf(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(rp(e))),this.updateAllowDefault(e),this.allowDefault||!t?ep(this.view,"pointer"):ap(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||mh&&this.mightDrag&&!this.mightDrag.node.isAtom||fh&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(sp(this.view,Ku.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):ep(this.view,"pointer")}move(e){this.updateAllowDefault(e),ep(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function fp(e,t){return!!e.composing||!!(mh&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}Zf.touchstart=e=>{e.input.lastTouch=Date.now(),up(e),ep(e,"pointer")},Zf.touchmove=e=>{e.input.lastTouch=Date.now(),ep(e,"pointer")},Zf.contextmenu=e=>up(e);const pp=bh?5e3:-1;function mp(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>yp(e),t))}function gp(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function vp(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=Qd(e=e.childNodes[t-1])}else{if(!e.parentNode||eh(e))return null;t=qd(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),o=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||eh(e))return null;t=qd(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&o&&n!=o){let t=o.pmViewDesc,r=e.domObserver.lastChangedTextNode;if(n==r||o==r)return r;if(!t||!t.isText(o.nodeValue))return o;if(e.input.compositionNode==o){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return o}}return n||o}function yp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(bh&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),gp(e),t||e.docView&&e.docView.dirty){let n=ff(e),o=e.state.selection;return n&&!n.eq(o)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||o.$from.node(o.$from.sharedDepth(o.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}Gf.compositionstart=Gf.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof Gu&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)||fh&&yh&&function(e){let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(!t||1!=t.nodeType||n>=t.childNodes.length)return!1;let o=t.childNodes[n];return 1==o.nodeType&&"false"==o.contentEditable}(e)))e.markCursor=e.state.storedMarks||n.marks(),yp(e,!0),e.markCursor=null;else if(yp(e,!t.selection.empty),dh&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,o=t.focusOffset;n&&1==n.nodeType&&0!=o;){let t=o<0?n.lastChild:n.childNodes[o-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,o=-1}}e.input.composing=!0}mp(e,pp)},Gf.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,mp(e,20))};const bp=ch&&uh<15||gh&&wh<604;function xp(e,t,n,o,r){let i=Lf(e,t,n,o,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,r,i||tc.empty)))return!0;if(!i)return!1;let s=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),a=s?e.state.tr.replaceSelectionWith(s,o):e.state.tr.replaceSelection(i);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function wp(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Zf.copy=Gf.cut=(e,t)=>{let n=t,o=e.state.selection,r="cut"==n.type;if(o.empty)return;let i=bp?null:n.clipboardData,s=o.content(),{dom:a,text:l}=zf(e,s);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),o.removeAllRanges(),o.addRange(r),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Gf.paste=(e,t)=>{let n=t;if(e.composing&&!bh)return;let o=bp?null:n.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;o&&xp(e,wp(o),o.getData("text/html"),r,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,o=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus();let r=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),o.parentNode&&o.parentNode.removeChild(o),n?xp(e,o.value,null,r,t):xp(e,o.textContent,o.innerHTML,r,t)},50)}(e,n)};class kp{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Cp=vh?"altKey":"ctrlKey";function Sp(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[Cp]}Zf.dragstart=(e,t)=>{let n=t,o=e.input.mouseDown;if(o&&o.done(),!n.dataTransfer)return;let r,i=e.state.selection,s=i.empty?null:e.posAtCoords(rp(n));if(s&&s.pos>=i.from&&s.pos<=(i instanceof Qu?i.to-1:i.to));else if(o&&o.mightDrag)r=Qu.create(e.state.doc,o.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(r=Qu.create(e.state.doc,t.posBefore))}let a=(r||e.state.selection).content(),{dom:l,text:c,slice:u}=zf(e,a);(!n.dataTransfer.files.length||!fh||ph>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(bp?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",bp||n.dataTransfer.setData("text/plain",c),e.dragging=new kp(u,Sp(e,n),r)},Zf.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},Gf.dragover=Gf.dragenter=(e,t)=>t.preventDefault(),Gf.drop=(e,t)=>{try{!function(e,t,n){if(!t.dataTransfer)return;let o=e.posAtCoords(rp(t));if(!o)return;let r=e.state.doc.resolve(o.pos),i=n&&n.slice;i?e.someProp("transformPasted",t=>{i=t(i,e,!1)}):i=Lf(e,wp(t.dataTransfer),bp?null:t.dataTransfer.getData("text/html"),!1,r);let s=!(!n||!Sp(e,t));if(e.someProp("handleDrop",n=>n(e,t,i||tc.empty,s)))return void t.preventDefault();if(!i)return;t.preventDefault();let a=i?Ou(e.state.doc,r.pos,i):r.pos;null==a&&(a=r.pos);let l=e.state.tr;if(s){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,d=l.doc;u?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i);if(l.doc.eq(d))return;let h=l.doc.resolve(c);if(u&&Qu.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new Qu(h));else{let t=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,o,r)=>t=r),l.setSelection(kf(e,h,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}(e,t,e.dragging)}finally{e.dragging=null}},Zf.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&mf(e)},20))},Zf.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},Zf.beforeinput=(e,t)=>{if(fh&&bh&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,nh(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let n in Gf)Zf[n]=Gf[n];function Ep(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class Dp{constructor(e,t){this.toDOM=e,this.spec=t||Tp,this.side=this.spec.side||0}map(e,t,n,o){let{pos:r,deleted:i}=e.mapResult(t.from+o,this.side<0?-1:1);return i?null:new Ap(r-n,r-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Dp&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ep(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Mp{constructor(e,t){this.attrs=e,this.spec=t||Tp}map(e,t,n,o){let r=e.map(t.from+o,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+o,this.spec.inclusiveEnd?1:-1)-n;return r>=i?null:new Ap(r,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Mp&&Ep(this.attrs,e.attrs)&&Ep(this.spec,e.spec)}static is(e){return e.type instanceof Mp}destroy(){}}class Np{constructor(e,t){this.attrs=e,this.spec=t||Tp}map(e,t,n,o){let r=e.mapResult(t.from+o,1);if(r.deleted)return null;let i=e.mapResult(t.to+o,-1);return i.deleted||i.pos<=r.pos?null:new Ap(r.pos-n,i.pos-n,this)}valid(e,t){let n,{index:o,offset:r}=e.content.findIndex(t.from);return r==t.from&&!(n=e.child(o)).isText&&r+n.nodeSize==t.to}eq(e){return this==e||e instanceof Np&&Ep(this.attrs,e.attrs)&&Ep(this.spec,e.spec)}destroy(){}}class Ap{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Ap(e,t,this.type)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Ap(e,e,new Dp(t,n))}static inline(e,t,n,o){return new Ap(e,t,new Mp(n,o))}static node(e,t,n,o){return new Ap(e,t,new Np(n,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof Mp}get widget(){return this.type instanceof Dp}}const Op=[],Tp={};class _p{constructor(e,t){this.local=e.length?e:Op,this.children=t.length?t:Op}static create(e,t){return t.length?zp(t,e,0,Tp):jp}find(e,t,n){let o=[];return this.findInner(null==e?0:e,null==t?1e9:t,o,0,n),o}findInner(e,t,n,o,r){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=t&&s.to>=e&&(!r||r(s.spec))&&n.push(s.copy(s.from+o,s.to+o))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let s=this.children[i]+1;this.children[i+2].findInner(e-s,t-s,n,o+s,r)}}map(e,t,n){return this==jp||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Tp)}mapInner(e,t,n,o,r){let i;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,o);a&&a.type.valid(t,a)?(i||(i=[])).push(a):r.onRemove&&r.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,o,r,i,s){let a=e.slice();for(let c=0,u=i;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,o,r)=>{let i=r-o-(n-t);for(let s=0;s<a.length;s+=3){let o=a[s+1];if(o<0||t>o+u-e)continue;let r=a[s]+u-e;n>=r?a[s+1]=t<=r?-2:-1:t>=u&&i&&(a[s]+=i,a[s+1]+=i)}e+=i}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+i),u=t-r;if(u<0||u>=o.content.size){l=!0;continue}let d=n.map(e[c+1]+i,-1)-r,{index:h,offset:f}=o.content.findIndex(u),p=o.maybeChild(h);if(p&&f==u&&f+p.nodeSize==d){let o=a[c+2].mapInner(n,p,t+1,e[c]+i+1,s);o!=jp?(a[c]=u,a[c+1]=d,a[c+2]=o):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,o,r,i,s){function a(e,t){for(let i=0;i<e.local.length;i++){let a=e.local[i].map(o,r,t);a?n.push(a):s.onRemove&&s.onRemove(e.local[i].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+i+1);return n}(a,e,t,n,r,i,s),c=zp(l,o,0,s);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new _p(t.sort(Lp),a)}(this.children,i||[],e,t,n,o,r):i?new _p(i.sort(Lp),Op):jp}add(e,t){return t.length?this==jp?_p.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let o,r=0;e.forEach((e,i)=>{let s,a=i+n;if(s=Rp(t,e,a)){for(o||(o=this.children.slice());r<o.length&&o[r]<i;)r+=3;o[r]==i?o[r+2]=o[r+2].addInner(e,s,a+1):o.splice(r,0,i,i+e.nodeSize,zp(s,e,a+1,Tp)),r+=3}});let i=Ip(r?Fp(t):t,-n);for(let s=0;s<i.length;s++)i[s].type.valid(e,i[s])||i.splice(s--,1);return new _p(i.length?this.local.concat(i).sort(Lp):this.local,o||this.children)}remove(e){return 0==e.length||this==jp?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,o=this.local;for(let r=0;r<n.length;r+=3){let o,i=n[r]+t,s=n[r+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>i&&t.to<s&&(e[n]=null,(o||(o=[])).push(t));if(!o)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(o,i+1);a!=jp?n[r+2]=a:(n.splice(r,3),r-=3)}if(o.length)for(let r,i=0;i<e.length;i++)if(r=e[i])for(let e=0;e<o.length;e++)o[e].eq(r,t)&&(o==this.local&&(o=this.local.slice()),o.splice(e--,1));return n==this.children&&o==this.local?this:o.length||n.length?new _p(o,n):jp}forChild(e,t){if(this==jp)return this;if(t.isLeaf)return _p.empty;let n,o;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(n=this.children[s+2]);break}let r=e+1,i=r+t.content.size;for(let s=0;s<this.local.length;s++){let e=this.local[s];if(e.from<i&&e.to>r&&e.type instanceof Mp){let t=Math.max(r,e.from)-r,n=Math.min(i,e.to)-r;t<n&&(o||(o=[])).push(e.copy(t,n))}}if(o){let e=new _p(o.sort(Lp),Op);return n?new Pp([e,n]):e}return n||jp}eq(e){if(this==e)return!0;if(!(e instanceof _p)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Bp(this.localsInner(e))}localsInner(e){if(this==jp)return Op;if(e.inlineContent||!this.local.some(Mp.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Mp||t.push(this.local[n]);return t}forEachSet(e){e(this)}}_p.empty=new _p([],[]),_p.removeOverlap=Bp;const jp=_p.empty;class Pp{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,Tp));return Pp.from(n)}forChild(e,t){if(t.isLeaf)return _p.empty;let n=[];for(let o=0;o<this.members.length;o++){let r=this.members[o].forChild(e,t);r!=jp&&(r instanceof Pp?n=n.concat(r.members):n.push(r))}return Pp.from(n)}eq(e){if(!(e instanceof Pp)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let o=0;o<this.members.length;o++){let r=this.members[o].localsInner(e);if(r.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<r.length;e++)t.push(r[e])}else t=r}return t?Bp(n?t:t.sort(Lp)):Op}static from(e){switch(e.length){case 0:return jp;case 1:return e[0];default:return new Pp(e.every(e=>e instanceof _p)?e:e.reduce((e,t)=>e.concat(t instanceof _p?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Ip(e,t){if(!t||!e.length)return e;let n=[];for(let o=0;o<e.length;o++){let r=e[o];n.push(new Ap(r.from+t,r.to+t,r.type))}return n}function Rp(e,t,n){if(t.isLeaf)return null;let o=n+t.nodeSize,r=null;for(let i,s=0;s<e.length;s++)(i=e[s])&&i.from>n&&i.to<o&&((r||(r=[])).push(i),e[s]=null);return r}function Fp(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function zp(e,t,n,o){let r=[],i=!1;t.forEach((t,s)=>{let a=Rp(e,t,s+n);if(a){i=!0;let e=zp(a,t,n+s+1,o);e!=jp&&r.push(s,s+t.nodeSize,e)}});let s=Ip(i?Fp(e):e,-n).sort(Lp);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(o.onRemove&&o.onRemove(s[a].spec),s.splice(a--,1));return s.length||r.length?new _p(s,r):jp}function Lp(e,t){return e.from-t.from||e.to-t.to}function Bp(e){let t=e;for(let n=0;n<t.length-1;n++){let o=t[n];if(o.from!=o.to)for(let r=n+1;r<t.length;r++){let i=t[r];if(i.from!=o.from){i.from<o.to&&(t==e&&(t=e.slice()),t[n]=o.copy(o.from,i.from),Vp(t,r,o.copy(i.from,o.to)));break}i.to!=o.to&&(t==e&&(t=e.slice()),t[r]=i.copy(i.from,o.to),Vp(t,r+1,i.copy(o.to,i.to)))}}return t}function Vp(e,t,n){for(;t<e.length&&Lp(n,e[t])>0;)t++;e.splice(t,0,n)}function Hp(e){let t=[];return e.someProp("decorations",n=>{let o=n(e.state);o&&o!=jp&&t.push(o)}),e.cursorWrapper&&t.push(_p.create(e.state.doc,[e.cursorWrapper.deco])),Pp.from(t)}const $p={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Wp=ch&&uh<=11;class Up{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class qp{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Up,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);ch&&uh<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),Wp&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,$p)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Cf(this.view)){if(this.suppressingSelectionUpdates)return mf(this.view);if(ch&&uh<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Zd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let r=e.focusNode;r;r=Kd(r))n.add(r);for(let r=e.anchorNode;r;r=Kd(r))if(n.has(r)){t=r;break}let o=t&&this.view.docView.nearestDesc(t);return o&&o.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Cf(e)&&!this.ignoreSelectionChange(n),r=-1,i=-1,s=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(r=r<0?e.from:Math.min(e.from,r),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(s=!0))}if(dh&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let o of t){let t=o.parentNode;!t||"LI"!=t.nodeName||n&&Zp(e,n)==t||o.remove()}}}else if((fh||mh)&&a.some(e=>"BR"==e.nodeName)&&(8==e.input.lastKeyCode||46==e.input.lastKeyCode))for(let c of a)if("BR"==c.nodeName&&c.parentNode){let e=c.nextSibling;e&&1==e.nodeType&&"false"==e.contentEditable&&c.parentNode.removeChild(c)}let l=null;r<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&th(n)&&(l=ff(e))&&l.eq(Ku.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,mf(e),this.currentSelection.set(n),e.scrollToSelection()):(r>-1||o)&&(r>-1&&(e.docView.markDirty(r,i),function(e){if(Kp.has(e))return;if(Kp.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=dh,Yp)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Yp=!0}}(e)),this.handleDOMChange(r,i,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||mf(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let o=e.addedNodes[n];t.push(o),3==o.nodeType&&(this.lastChangedTextNode=o)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let o=e.previousSibling,r=e.nextSibling;if(ch&&uh<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(o=n),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(r=i)}let i=o&&o.parentNode==e.target?qd(o)+1:0,s=n.localPosFromDOM(e.target,i,-1),a=r&&r.parentNode==e.target?qd(r):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Kp=new WeakMap,Yp=!1;function Xp(e,t){let n=t.startContainer,o=t.startOffset,r=t.endContainer,i=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return Zd(s.node,s.offset,r,i)&&([n,o,r,i]=[r,i,n,o]),{anchorNode:n,anchorOffset:o,focusNode:r,focusOffset:i}}function Zp(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function Gp(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(mh&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||mh&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Jp=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Qp(e,t,n,o,r){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=ff(e,t);if(n&&!e.state.selection.eq(n)){if(fh&&bh&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,nh(13,"Enter"))))return;let o=e.state.tr.setSelection(n);"pointer"==t?o.setMeta("pointer",!0):"key"==t&&o.scrollIntoView(),i&&o.setMeta("composition",i),e.dispatch(o)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(n);t=s.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,u=e.state.selection,d=function(e,t,n){let o,{node:r,fromOffset:i,toOffset:s,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(o=[{node:u,offset:c.anchorOffset}],th(c)||o.push({node:c.focusNode,offset:c.focusOffset})),fh&&8===e.input.lastKeyCode)for(let g=s;g>i;g--){let e=r.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){s=g;break}if(!t||t.size)break}let d=e.state.doc,h=e.someProp("domParser")||Bc.fromSchema(e.state.schema),f=d.resolve(a),p=null,m=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:o,ruleFromNode:Gp,context:f});if(o&&null!=o[0].pos){let e=o[0].pos,t=o[1]&&o[1].pos;null==t&&(t=e),p={anchor:e+a,head:t+a}}return{doc:m,sel:p,from:a,to:l}}(e,t,n),h=e.state.doc,f=h.slice(d.from,d.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let p=function(e,t,n,o,r){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==r){o-=s+Math.max(0,i-Math.min(s,a))-i}if(s<i&&e.size<t.size){let e=o<=i&&o>=s?i-o:0;i-=e,i&&i<t.size&&nm(t.textBetween(i-1,i+1))&&(i+=e?1:-1),a=i+(a-s),s=i}else if(a<i){let t=o<=i&&o>=a?i-o:0;i-=t,i&&i<e.size&&nm(e.textBetween(i-1,i+1))&&(i+=t?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}(f.content,d.doc.content,d.from,l,c);if(p&&e.input.domChangeCount++,(gh&&e.input.lastIOSEnter>Date.now()-225||bh)&&r.some(e=>1==e.nodeType&&!Jp.test(e.nodeName))&&(!p||p.endA>=p.endB)&&e.someProp("handleKeyDown",t=>t(e,nh(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!p){if(!(o&&u instanceof Gu&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){let t=em(e,e.state.doc,d.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);i&&n.setMeta("composition",i),e.dispatch(n)}}return}p={start:u.from,endA:u.to,endB:u.to}}e.state.selection.from<e.state.selection.to&&p.start==p.endB&&e.state.selection instanceof Gu&&(p.start>e.state.selection.from&&p.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?p.start=e.state.selection.from:p.endA<e.state.selection.to&&p.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(p.endB+=e.state.selection.to-p.endA,p.endA=e.state.selection.to)),ch&&uh<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>d.from&&" \xa0"==d.doc.textBetween(p.start-d.from-1,p.start-d.from+1)&&(p.start--,p.endA--,p.endB--);let m=d.doc.resolveNoCache(p.start-d.from),g=d.doc.resolveNoCache(p.endB-d.from),v=h.resolve(p.start),y=m.sameParent(g)&&m.parent.inlineContent&&v.end()>=p.endA;if((gh&&e.input.lastIOSEnter>Date.now()-225&&(!y||r.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!y&&m.pos<d.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(d.doc.textBetween(m.pos,g.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,nh(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>p.start&&function(e,t,n,o,r){if(n-t<=r.pos-o.pos||tm(o,!0,!1)<r.pos)return!1;let i=e.resolve(t);if(!o.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=e.resolve(tm(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||tm(s,!0,!1)<n)&&o.parent.content.cut(o.parentOffset).eq(s.parent.content)}(h,p.start,p.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,nh(8,"Backspace"))))return void(bh&&fh&&e.domObserver.suppressSelectionUpdates());fh&&p.endB==p.start&&(e.input.lastChromeDelete=Date.now()),bh&&!y&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==p.endA&&(p.endB-=2,g=d.doc.resolveNoCache(p.endB-d.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,nh(13,"Enter"))})},20));let b,x=p.start,w=p.endA,k=t=>{let n=t||e.state.tr.replace(x,w,d.doc.slice(p.start-d.from,p.endB-d.from));if(d.sel){let t=em(e,n.doc,d.sel);t&&!(fh&&e.composing&&t.empty&&(p.start!=p.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==x||t.head==n.mapping.map(w)-1)||ch&&t.empty&&t.head==x)&&n.setSelection(t)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(y)if(m.pos==g.pos){ch&&uh<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>mf(e),20));let t=k(e.state.tr.delete(x,w)),n=h.resolve(p.start).marksAcross(h.resolve(p.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(p.endA==p.endB&&(b=function(e,t){let n,o,r,i=e.firstChild.marks,s=t.firstChild.marks,a=i,l=s;for(let u=0;u<s.length;u++)a=s[u].removeFromSet(a);for(let u=0;u<i.length;u++)l=i[u].removeFromSet(l);if(1==a.length&&0==l.length)o=a[0],n="add",r=e=>e.mark(o.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;o=l[0],n="remove",r=e=>e.mark(o.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(r(t.child(u)));if(Xl.from(c).eq(e))return{mark:o,type:n}}(m.parent.content.cut(m.parentOffset,g.parentOffset),v.parent.content.cut(v.parentOffset,p.endA-v.start())))){let t=k(e.state.tr);"add"==b.type?t.addMark(x,w,b.mark):t.removeMark(x,w,b.mark),e.dispatch(t)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset),n=()=>k(e.state.tr.insertText(t,x,w));e.someProp("handleTextInput",o=>o(e,x,w,t,n))||e.dispatch(n())}else e.dispatch(k());else e.dispatch(k())}function em(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:kf(e,t.resolve(n.anchor),t.resolve(n.head))}function tm(e,t,n){let o=e.depth,r=t?e.end():e.pos;for(;o>0&&(t||e.indexAfter(o)==e.node(o).childCount);)o--,r++,t=!1;if(n){let t=e.node(o).maybeChild(e.indexAfter(o));for(;t&&!t.isLeaf;)t=t.firstChild,r++}return r}function nm(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class om{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Qf,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(lm),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=sm(this),im(this),this.nodeViews=am(this),this.docView=Zh(this.state.doc,rm(this),Hp(this),this.dom,this),this.domObserver=new qp(this,(e,t,n,o)=>Qp(this,e,t,n,o)),this.domObserver.start(),function(e){for(let t in Zf){let n=Zf[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!op(e,t)||np(e,t)||!e.editable&&t.type in Gf||n(e,t)},Jf[t]?{passive:!0}:void 0)}mh&&e.dom.addEventListener("input",()=>null),tp(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&tp(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(lm),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let o=this.state,r=!1,i=!1;e.storedMarks&&this.composing&&(gp(this),i=!0),this.state=e;let s=o.plugins!=e.plugins||this._props.plugins!=t.plugins;if(s||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=am(this);(function(e,t){let n=0,o=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let r in t)o++;return n!=o})(e,this.nodeViews)&&(this.nodeViews=e,r=!0)}(s||t.handleDOMEvents!=this._props.handleDOMEvents)&&tp(this),this.editable=sm(this),im(this);let a=Hp(this),l=rm(this),c=o.plugins==e.plugins||o.doc.eq(e.doc)?e.scrollToSelection>o.scrollToSelection?"to selection":"preserve":"reset",u=r||!this.docView.matchesNode(e.doc,l,a);!u&&e.selection.eq(o.selection)||(i=!0);let d="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,n,o=e.dom.getBoundingClientRect(),r=Math.max(0,o.top);for(let i=(o.left+o.right)/2,s=r+1;s<Math.min(innerHeight,o.bottom);s+=5){let o=e.root.elementFromPoint(i,s);if(!o||o==e.dom||!e.dom.contains(o))continue;let a=o.getBoundingClientRect();if(a.top>=r-20){t=o,n=a.top;break}}return{refDOM:t,refTop:n,stack:Dh(e.dom)}}(this);if(i){this.domObserver.stop();let t=u&&(ch||fh)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(o.selection,e.selection);if(u){let n=fh?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=vp(this)),!r&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=Zh(e.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return Zd(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?mf(this,t):(xf(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function(e){let{refDOM:t,refTop:n,stack:o}=e,r=t?t.getBoundingClientRect().top:0;Mh(o,0==r?0:r-n)}(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof Qu){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Eh(this,t.getBoundingClientRect(),e)}else Eh(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,o=-1;if(this.state.doc.nodeAt(n.from)==n.node)o=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(o=e)}this.dragging=new kp(e.slice,e.move,o<0?void 0:Qu.create(this.state.doc,o))}someProp(e,t){let n,o=this._props&&this._props[e];if(null!=o&&(n=t?t(o):o))return n;for(let i=0;i<this.directPlugins.length;i++){let o=this.directPlugins[i].props[e];if(null!=o&&(n=t?t(o):o))return n}let r=this.state.plugins;if(r)for(let i=0;i<r.length;i++){let o=r[i].props[e];if(null!=o&&(n=t?t(o):o))return n}}hasFocus(){if(ch){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Nh)return e.focus(Nh);let t=Dh(e);e.focus(null==Nh?{get preventScroll(){return Nh={preventScroll:!0},!0}}:void 0),Nh||(Nh=!1,Mh(t,0))}(this.dom),mf(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return _h(this,e)}coordsAtPos(e){return Rh(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=this.docView.posFromDOM(e,t,n);if(null==o)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,t){return Wh(this,t||this.state,e)}pasteHTML(e,t){return xp(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return xp(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return zf(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Hp(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Yd=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){np(e,t)||!Zf[t.type]||!e.editable&&t.type in Gf||Zf[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?mh&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return Xp(e,n)}let n;function o(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",o,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",o,!0),n?Xp(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function rm(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[Ap.node(0,e.state.doc.content.size,t)]}function im(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Ap.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function sm(e){return!e.someProp("editable",t=>!1===t(e.state))}function am(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function lm(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}om.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var cm={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},um={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},dm="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),hm="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),fm=0;fm<10;fm++)cm[48+fm]=cm[96+fm]=String(fm);for(fm=1;fm<=24;fm++)cm[fm+111]="F"+fm;for(fm=65;fm<=90;fm++)cm[fm]=String.fromCharCode(fm+32),um[fm]=String.fromCharCode(fm);for(var pm in cm)um.hasOwnProperty(pm)||(um[pm]=cm[pm]);const mm="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),gm="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function vm(e){let t,n,o,r,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let a=0;a<i.length-1;a++){let e=i[a];if(/^(cmd|meta|m)$/i.test(e))r=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))o=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);mm?r=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),r&&(s="Meta-"+s),o&&(s="Shift-"+s),s}function ym(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function bm(e){let t=function(e){let t=Object.create(null);for(let n in e)t[vm(n)]=e[n];return t}(e);return function(e,n){let o,r=function(e){var t=!(dm&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||hm&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?um:cm)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=t[ym(r,n)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let o=t[ym(r,n,!1)];if(o&&o(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(gm&&n.ctrlKey&&n.altKey)&&(o=cm[n.keyCode])&&o!=r){let r=t[ym(o,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}var xm=Object.defineProperty,wm=(e,t)=>{for(var n in t)xm(e,n,{get:t[n],enumerable:!0})};function km(e){const{state:t,transaction:n}=e;let{selection:o}=n,{doc:r}=n,{storedMarks:i}=n;return a(a({},t),{},{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return o},get doc(){return r},get tr(){return o=n.selection,r=n.doc,i=n.storedMarks,n}})}var Cm=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var e=this;const{rawCommands:t,editor:n,state:o}=this,{view:r}=n,{tr:i}=o,s=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(t=>{let[n,o]=t;return[n,function(){const t=o(...arguments)(s);return i.getMeta("preventDispatch")||e.hasCustomState||r.dispatch(i),t}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:o,editor:r,state:i}=this,{view:s}=r,l=[],c=!!e,u=e||i.tr,d=a(a({},Object.fromEntries(Object.entries(o).map(e=>{let[o,r]=e;return[o,function(){const e=t.buildProps(u,n),o=r(...arguments)(e);return l.push(o),d}]}))),{},{run:()=>(c||!n||u.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(u),l.every(e=>!0===e))});return d}createCan(e){const{rawCommands:t,state:n}=this,o=!1,r=e||n.tr,i=this.buildProps(r,o),s=Object.fromEntries(Object.entries(t).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(a(a({},i),{},{dispatch:void 0}))}]}));return a(a({},s),{},{chain:()=>this.createChain(r,o)})}buildProps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:o,state:r}=this,{view:i}=o,s={tr:e,editor:o,view:i,state:km({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(s)}]}))}};return s}},Sm={};wm(Sm,{blur:()=>Em,clearContent:()=>Dm,clearNodes:()=>Mm,command:()=>Nm,createParagraphNear:()=>Am,cut:()=>Om,deleteCurrentNode:()=>Tm,deleteNode:()=>jm,deleteRange:()=>Pm,deleteSelection:()=>Im,enter:()=>Rm,exitCode:()=>Fm,extendMarkRange:()=>Wm,first:()=>Um,focus:()=>Gm,forEach:()=>Jm,insertContent:()=>Qm,insertContentAt:()=>og,joinBackward:()=>sg,joinDown:()=>ig,joinForward:()=>ag,joinItemBackward:()=>lg,joinItemForward:()=>cg,joinTextblockBackward:()=>ug,joinTextblockForward:()=>dg,joinUp:()=>rg,keyboardShortcut:()=>fg,lift:()=>mg,liftEmptyBlock:()=>gg,liftListItem:()=>vg,newlineInCode:()=>yg,resetAttributes:()=>wg,scrollIntoView:()=>kg,selectAll:()=>Cg,selectNodeBackward:()=>Sg,selectNodeForward:()=>Eg,selectParentNode:()=>Dg,selectTextblockEnd:()=>Mg,selectTextblockStart:()=>Ng,setContent:()=>Og,setMark:()=>hv,setMeta:()=>fv,setNode:()=>pv,setNodeSelection:()=>mv,setTextDirection:()=>gv,setTextSelection:()=>vv,sinkListItem:()=>yv,splitBlock:()=>xv,splitListItem:()=>wv,toggleList:()=>Sv,toggleMark:()=>Ev,toggleNode:()=>Dv,toggleWrap:()=>Mv,undoInputRule:()=>Nv,unsetAllMarks:()=>Av,unsetMark:()=>Ov,unsetTextDirection:()=>Tv,updateAttributes:()=>_v,wrapIn:()=>jv,wrapInList:()=>Pv});var Em=()=>e=>{let{editor:t,view:n}=e;return requestAnimationFrame(()=>{var e;t.isDestroyed||(n.dom.blur(),null==(e=null==window?void 0:window.getSelection())||e.removeAllRanges())}),!0},Dm=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t=>{let{commands:n}=t;return n.setContent("",{emitUpdate:e})}},Mm=()=>e=>{let{state:t,tr:n,dispatch:o}=e;const{selection:r}=n,{ranges:i}=r;return!o||(i.forEach(e=>{let{$from:o,$to:r}=e;t.doc.nodesBetween(o.pos,r.pos,(e,t)=>{if(e.type.isText)return;const{doc:o,mapping:r}=n,i=o.resolve(r.map(t)),s=o.resolve(r.map(t+e.nodeSize)),a=i.blockRange(s);if(!a)return;const l=wu(a);if(e.type.isTextblock){const{defaultType:e}=i.parent.contentMatchAt(i.index());n.setNodeMarkup(a.start,e)}(l||0===l)&&n.lift(a,l)})}),!0)},Nm=e=>t=>e(t),Am=()=>e=>{let{state:t,dispatch:n}=e;return Od(t,n)},Om=(e,t)=>n=>{let{editor:o,tr:r}=n;const{state:i}=o,s=i.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const a=r.mapping.map(t);return r.insert(a,s.content),r.setSelection(new Gu(r.doc.resolve(Math.max(a-1,0)))),!0},Tm=()=>e=>{let{tr:t,dispatch:n}=e;const{selection:o}=t,r=o.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1){if(i.node(s).type===r.type){if(n){const e=i.before(s),n=i.after(s);t.delete(e,n).scrollIntoView()}return!0}}return!1};function _m(e,t){if("string"===typeof e){if(!t.nodes[e])throw Error("There is no node type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.nodes[e]}return e}var jm=e=>t=>{let{tr:n,state:o,dispatch:r}=t;const i=_m(e,o.schema),s=n.selection.$anchor;for(let e=s.depth;e>0;e-=1){if(s.node(e).type===i){if(r){const t=s.before(e),o=s.after(e);n.delete(t,o).scrollIntoView()}return!0}}return!1},Pm=e=>t=>{let{tr:n,dispatch:o}=t;const{from:r,to:i}=e;return o&&n.delete(r,i),!0},Im=()=>e=>{let{state:t,dispatch:n}=e;return gd(t,n)},Rm=()=>e=>{let{commands:t}=e;return t.keyboardShortcut("Enter")},Fm=()=>e=>{let{state:t,dispatch:n}=e;return Ad(t,n)};function zm(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Lm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const o=Object.keys(t);return!o.length||o.every(o=>n.strict?t[o]===e[o]:zm(t[o])?t[o].test(e[o]):t[o]===e[o])}function Bm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.find(e=>e.type===t&&Lm(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function Vm(e,t){return!!Bm(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function Hm(e,t,n){var o;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(r.node&&r.node.marks.some(e=>e.type===t)||(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(e=>e.type===t))return;n=n||(null==(o=r.node.marks[0])?void 0:o.attrs);if(!Bm([...r.node.marks],t,n))return;let i=r.index,s=e.start()+r.offset,a=i+1,l=s+r.node.nodeSize;for(;i>0&&Vm([...e.parent.child(i-1).marks],t,n);)i-=1,s-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&Vm([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function $m(e,t){if("string"===typeof e){if(!t.marks[e])throw Error("There is no mark type named '".concat(e,"'. Maybe you forgot to add the extension?"));return t.marks[e]}return e}var Wm=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:o,state:r,dispatch:i}=n;const s=$m(e,r.schema),{doc:a,selection:l}=o,{$from:c,from:u,to:d}=l;if(i){const e=Hm(c,s,t);if(e&&e.from<=u&&e.to>=d){const t=Gu.create(a,e.from,e.to);o.setSelection(t)}}return!0}},Um=e=>t=>{const n="function"===typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1};function qm(e){return e instanceof Gu}function Km(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(e,t),n)}function Ym(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return null;const n=Ku.atStart(e),o=Ku.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return o;const r=n.from,i=o.to;return"all"===t?Gu.create(e,Km(0,r,i),Km(e.content.size,r,i)):Gu.create(e,Km(t,r,i),Km(t,r,i))}function Xm(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function Zm(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Gm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{editor:o,view:r,tr:i,dispatch:s}=n;t=a({scrollIntoView:!0},t);const l=()=>{(Zm()||Xm())&&r.dom.focus(),requestAnimationFrame(()=>{o.isDestroyed||(r.focus(),(null==t?void 0:t.scrollIntoView)&&o.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(s&&null===e&&!qm(o.state.selection))return l(),!0;const c=Ym(i.doc,e)||o.state.selection,u=o.state.selection.eq(c);return s&&(u||i.setSelection(c),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0}},Jm=(e,t)=>n=>e.every((e,o)=>t(e,a(a({},n),{},{index:o}))),Qm=(e,t)=>n=>{let{tr:o,commands:r}=n;return r.insertContentAt({from:o.selection.from,to:o.selection.to},e,t)},eg=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const o=t[n];3===o.nodeType&&o.nodeValue&&/^(\n\s\s|\n)$/.test(o.nodeValue)?e.removeChild(o):1===o.nodeType&&eg(o)}return e};function tg(e){if("undefined"===typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t="<body>".concat(e,"</body>"),n=(new window.DOMParser).parseFromString(t,"text/html").body;return eg(n)}function ng(e,t,n){if(e instanceof bc||e instanceof Xl)return e;n=a({slice:!0,parseOptions:{}},n);const o="string"===typeof e;if("object"===typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return Xl.fromArray(e.map(e=>t.nodeFromJSON(e)));const o=t.nodeFromJSON(e);return n.errorOnInvalidContent&&o.check(),o}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),ng("",t,n)}if(o){if(n.errorOnInvalidContent){let o=!1,r="";const i=new zc({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(o=!0,r="string"===typeof e?e:e.outerHTML,null)}]}})});if(n.slice?Bc.fromSchema(i).parseSlice(tg(e),n.parseOptions):Bc.fromSchema(i).parse(tg(e),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error("Invalid element found: ".concat(r))})}const o=Bc.fromSchema(t);return n.slice?o.parseSlice(tg(e),n.parseOptions).content:o.parse(tg(e),n.parseOptions)}return ng("",t,n)}var og=(e,t,n)=>o=>{let{tr:r,dispatch:i,editor:s}=o;var l;if(i){let o;n=a({parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},n);const i=e=>{s.emit("contentError",{editor:s,error:e,disableCollaboration:()=>{"collaboration"in s.storage&&"object"===typeof s.storage.collaboration&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u=a({preserveWhitespace:"full"},n.parseOptions);if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{ng(t,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(c){i(c)}try{o=ng(t,s.schema,{parseOptions:u,errorOnInvalidContent:null!=(l=n.errorOnInvalidContent)?l:s.options.enableContentCheck})}catch(c){return i(c),!1}let{from:d,to:h}="number"===typeof e?{from:e,to:e}:{from:e.from,to:e.to},f=!0,p=!0;if(("type"in o?[o]:o).forEach(e=>{e.check(),f=!!f&&(e.isText&&0===e.marks.length),p=!!p&&e.isBlock}),d===h&&p){const{parent:e}=r.doc.resolve(d);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(d-=1,h+=1)}let m;if(f){if(Array.isArray(t))m=t.map(e=>e.text||"").join("");else if(t instanceof Xl){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),m=e}else m="object"===typeof t&&t&&t.text?t.text:t;r.insertText(m,d,h)}else{m=o;const e=r.doc.resolve(d),t=e.node(),n=0===e.parentOffset,i=t.isText||t.isTextblock,s=t.content.size>0;n&&i&&s&&(d=Math.max(0,d-1)),r.replaceWith(d,h,m)}n.updateSelection&&function(e,t,n){const o=e.steps.length-1;if(o<t)return;const r=e.steps[o];if(!(r instanceof gu||r instanceof vu))return;const i=e.mapping.maps[o];let s=0;i.forEach((e,t,n,o)=>{0===s&&(s=o)}),e.setSelection(Ku.near(e.doc.resolve(s),n))}(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:m}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:m})}return!0},rg=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,o=e.selection,r=o instanceof Qu;if(r){if(o.node.isTextblock||!Mu(e.doc,o.from))return!1;n=o.from}else if(n=Au(e.doc,o.from,-1),null==n)return!1;if(t){let o=e.tr.join(n);r&&o.setSelection(Qu.create(o.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(o.scrollIntoView())}return!0})(t,n)},ig=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,o=e.selection;if(o instanceof Qu){if(o.node.isTextblock||!Mu(e.doc,o.to))return!1;n=o.to}else if(n=Au(e.doc,o.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(t,n)},sg=()=>e=>{let{state:t,dispatch:n}=e;return yd(t,n)},ag=()=>e=>{let{state:t,dispatch:n}=e;return Sd(t,n)},lg=()=>e=>{let{state:t,dispatch:n,tr:o}=e;try{const e=Au(t.doc,t.selection.$from.pos,-1);return null!==e&&void 0!==e&&(o.join(e,2),n&&n(o),!0)}catch(r){return!1}},cg=()=>e=>{let{state:t,dispatch:n,tr:o}=e;try{const e=Au(t.doc,t.selection.$from.pos,1);return null!==e&&void 0!==e&&(o.join(e,2),n&&n(o),!0)}catch(r){return!1}},ug=()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let o=vd(e,n);if(!o)return!1;let r=kd(o);return!!r&&bd(e,r,t)})(t,n)},dg=()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let o=Cd(e,n);if(!o)return!1;let r=Dd(o);return!!r&&bd(e,r,t)})(t,n)};function hg(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}var fg=e=>t=>{let{editor:n,view:o,tr:r,dispatch:i}=t;const s=function(e){const t=e.split(/-(?!$)/);let n,o,r,i,s=t[t.length-1];"Space"===s&&(s=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))o=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: ".concat(e));Zm()||hg()?i=!0:o=!0}}return n&&(s="Alt-".concat(s)),o&&(s="Ctrl-".concat(s)),i&&(s="Meta-".concat(s)),r&&(s="Shift-".concat(s)),s}(e).split(/-(?!$)/),a=s.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),l=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(()=>{o.someProp("handleKeyDown",e=>e(o,l))});return null==c||c.steps.forEach(e=>{const t=e.map(r.mapping);t&&i&&r.maybeStep(t)}),!0};function pg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:o,to:r,empty:i}=e.selection,s=t?_m(t,e.schema):null,a=[];e.doc.nodesBetween(o,r,(e,t)=>{if(e.isText)return;const n=Math.max(o,t),i=Math.min(r,t+e.nodeSize);a.push({node:e,from:n,to:i})});const l=r-o,c=a.filter(e=>!s||s.name===e.node.type.name).filter(e=>Lm(e.node.attrs,n,{strict:!1}));if(i)return!!c.length;return c.reduce((e,t)=>e+t.to-t.from,0)>=l}var mg=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:o,dispatch:r}=n;return!!pg(o,_m(e,o.schema),t)&&((e,t)=>{let{$from:n,$to:o}=e.selection,r=n.blockRange(o),i=r&&wu(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)})(o,r)}},gg=()=>e=>{let{state:t,dispatch:n}=e;return Td(t,n)},vg=e=>t=>{let{state:n,dispatch:o}=t;return Ud(_m(e,n.schema))(n,o)},yg=()=>e=>{let{state:t,dispatch:n}=e;return Md(t,n)};function bg(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function xg(e,t){const n="string"===typeof t?[t]:t;return Object.keys(e).reduce((t,o)=>(n.includes(o)||(t[o]=e[o]),t),{})}var wg=(e,t)=>n=>{let{tr:o,state:r,dispatch:i}=n,s=null,a=null;const l=bg("string"===typeof e?e:e.name,r.schema);if(!l)return!1;"node"===l&&(s=_m(e,r.schema)),"mark"===l&&(a=$m(e,r.schema));let c=!1;return o.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,n)=>{s&&s===e.type&&(c=!0,i&&o.setNodeMarkup(n,void 0,xg(e.attrs,t))),a&&e.marks.length&&e.marks.forEach(r=>{a===r.type&&(c=!0,i&&o.addMark(n,n+e.nodeSize,a.create(xg(r.attrs,t))))})})}),c},kg=()=>e=>{let{tr:t,dispatch:n}=e;return n&&t.scrollIntoView(),!0},Cg=()=>e=>{let{tr:t,dispatch:n}=e;if(n){const e=new td(t.doc);t.setSelection(e)}return!0},Sg=()=>e=>{let{state:t,dispatch:n}=e;return wd(t,n)},Eg=()=>e=>{let{state:t,dispatch:n}=e;return Ed(t,n)},Dg=()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,{$from:o,to:r}=e.selection,i=o.sharedDepth(r);return 0!=i&&(n=o.before(i),t&&t(e.tr.setSelection(Qu.create(e.doc,n))),!0)})(t,n)},Mg=()=>e=>{let{state:t,dispatch:n}=e;return Fd(t,n)},Ng=()=>e=>{let{state:t,dispatch:n}=e;return Rd(t,n)};function Ag(e,t){return ng(e,t,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}var Og=function(e){let{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:o={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=>{let{editor:i,tr:s,dispatch:a,commands:l}=r;const{doc:c}=s;if("full"!==o.preserveWhitespace){const r=Ag(e,i.schema,o,{errorOnInvalidContent:null!=t?t:i.options.enableContentCheck});return a&&s.replaceWith(0,c.content.size,r).setMeta("preventUpdate",!n),!0}return a&&s.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:c.content.size},e,{parseOptions:o,errorOnInvalidContent:null!=t?t:i.options.enableContentCheck})}};function Tg(e,t){const n=$m(t,e.schema),{from:o,to:r,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(o,r,e=>{s.push(...e.marks)});const l=s.find(e=>e.type.name===n.name);return l?a({},l.attrs):{}}function _g(e,t){const n=new Uu(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function jg(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const o=e.node(n);if(t(o))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:o}}}(t.$from,e)}function Pg(e,t,n){if(void 0===e.config[t]&&e.parent)return Pg(e.parent,t,n);if("function"===typeof e.config[t]){return e.config[t].bind(a(a({},n),{},{parent:e.parent?Pg(e.parent,t,n):null}))}return e.config[t]}function Ig(e){return e.map(e=>{const t=Pg(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...Ig(t())]:e}).flat(10)}function Rg(e,t){const n=Zc.fromSchema(t).serializeFragment(e),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function Fg(e){return"function"===typeof e}function zg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(Fg(e)){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];return t?e.bind(t)(...o):e(...o)}return e}function Lg(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function Bg(e){const t=[],{nodeExtensions:n,markExtensions:o}=Lg(e),r=[...n,...o],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=Pg(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:r});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(e=>{let[o,r]=e;t.push({type:n,name:o,attribute:a(a({},i),r)})})})})}),r.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},o=Pg(e,"addAttributes",n);if(!o)return;const r=o();Object.entries(r).forEach(n=>{let[o,r]=n;const s=a(a({},i),r);"function"===typeof(null==s?void 0:s.default)&&(s.default=s.default()),(null==s?void 0:s.isRequired)&&void 0===(null==s?void 0:s.default)&&delete s.default,t.push({type:e.name,name:o,attribute:s})})}),t}function Vg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>!!e).reduce((e,t)=>{const n=a({},e);return Object.entries(t).forEach(e=>{let[t,o]=e;if(n[t])if("class"===t){const e=o?String(o).split(" "):[],r=n[t]?n[t].split(" "):[],i=e.filter(e=>!r.includes(e));n[t]=[...r,...i].join(" ")}else if("style"===t){const e=o?o.split(";").map(e=>e.trim()).filter(Boolean):[],r=n[t]?n[t].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;r.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),e.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[t]=Array.from(i.entries()).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join("; ")}else n[t]=o;else n[t]=o}),n},{})}function Hg(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>Vg(e,t),{})}function $g(e,t){return"style"in e?e:a(a({},e),{},{getAttrs:n=>{const o=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===o)return!1;const r=t.reduce((e,t)=>{const o=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!==typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null===o||void 0===o?e:a(a({},e),{},{[t.name]:o})},{});return a(a({},o),r)}})}function Wg(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return("attrs"!==t||!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&e.constructor===Object}(n))&&(null!==n&&void 0!==n)}))}function Ug(e){var t,n;const o={};return!(null==(t=null==e?void 0:e.attribute)?void 0:t.isRequired)&&"default"in((null==e?void 0:e.attribute)||{})&&(o.default=e.attribute.default),void 0!==(null==(n=null==e?void 0:e.attribute)?void 0:n.validate)&&(o.validate=e.attribute.validate),[e.name,o]}function qg(e,t){var n;const o=Bg(e),{nodeExtensions:r,markExtensions:i}=Lg(e),s=null==(n=r.find(e=>Pg(e,"topNode")))?void 0:n.name,l=Object.fromEntries(r.map(n=>{const r=o.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce((e,t)=>{const o=Pg(t,"extendNodeSchema",i);return a(a({},e),o?o(n):{})},{}),l=Wg(a(a({},s),{},{content:zg(Pg(n,"content",i)),marks:zg(Pg(n,"marks",i)),group:zg(Pg(n,"group",i)),inline:zg(Pg(n,"inline",i)),atom:zg(Pg(n,"atom",i)),selectable:zg(Pg(n,"selectable",i)),draggable:zg(Pg(n,"draggable",i)),code:zg(Pg(n,"code",i)),whitespace:zg(Pg(n,"whitespace",i)),linebreakReplacement:zg(Pg(n,"linebreakReplacement",i)),defining:zg(Pg(n,"defining",i)),isolating:zg(Pg(n,"isolating",i)),attrs:Object.fromEntries(r.map(Ug))})),c=zg(Pg(n,"parseHTML",i));c&&(l.parseDOM=c.map(e=>$g(e,r)));const u=Pg(n,"renderHTML",i);u&&(l.toDOM=e=>u({node:e,HTMLAttributes:Hg(e,r)}));const d=Pg(n,"renderText",i);return d&&(l.toText=d),[n.name,l]})),c=Object.fromEntries(i.map(n=>{const r=o.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce((e,t)=>{const o=Pg(t,"extendMarkSchema",i);return a(a({},e),o?o(n):{})},{}),l=Wg(a(a({},s),{},{inclusive:zg(Pg(n,"inclusive",i)),excludes:zg(Pg(n,"excludes",i)),group:zg(Pg(n,"group",i)),spanning:zg(Pg(n,"spanning",i)),code:zg(Pg(n,"code",i)),attrs:Object.fromEntries(r.map(Ug))})),c=zg(Pg(n,"parseHTML",i));c&&(l.parseDOM=c.map(e=>$g(e,r)));const u=Pg(n,"renderHTML",i);return u&&(l.toDOM=e=>u({mark:e,HTMLAttributes:Hg(e,r)})),[n.name,l]}));return new zc({topNode:s,nodes:l,marks:c})}function Kg(e){return e.sort((e,t)=>{const n=Pg(e,"priority")||100,o=Pg(t,"priority")||100;return n>o?-1:n<o?1:0})}function Yg(e){const t=Kg(Ig(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name));return n.length&&console.warn("[tiptap warn]: Duplicate extension names found: [".concat(n.map(e=>"'".concat(e,"'")).join(", "),"]. This can lead to issues.")),t}function Xg(e,t,n){const{from:o,to:r}=t,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{};let a="";return e.nodesBetween(o,r,(e,n,l,c)=>{var u;e.isBlock&&n>o&&(a+=i);const d=null==s?void 0:s[e.type.name];if(d)return l&&(a+=d({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null==(u=null==e?void 0:e.text)?void 0:u.slice(Math.max(o,n)-n,r-n))}),a}function Zg(e,t){return Xg(e,{from:0,to:e.content.size},t)}function Gg(e){return Object.fromEntries(Object.entries(e.nodes).filter(e=>{let[,t]=e;return t.spec.toText}).map(e=>{let[t,n]=e;return[t,n.spec.toText]}))}function Jg(e,t){const n=bg("string"===typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=_m(t,e.schema),{from:o,to:r}=e.selection,i=[];e.doc.nodesBetween(o,r,e=>{i.push(e)});const s=i.reverse().find(e=>e.type.name===n.name);return s?a({},s.attrs):{}}(e,t):"mark"===n?Tg(e,t):{}}function Qg(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify;const n={};return e.filter(e=>{const o=t(e);return!Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=!0)})}(e);return 1===t.length?t:t.filter((e,n)=>{const o=t.filter((e,t)=>t!==n);return!o.some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to)})}function ev(e){const{mapping:t,steps:n}=e,o=[];return t.maps.forEach((e,r)=>{const i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{const{from:e,to:t}=n[r];if(void 0===e||void 0===t)return;i.push({from:e,to:t})}i.forEach(e=>{let{from:n,to:i}=e;const s=t.slice(r).map(n,-1),a=t.slice(r).map(i),l=t.invert().map(s,-1),c=t.invert().map(a);o.push({oldRange:{from:l,to:c},newRange:{from:s,to:a}})})}),Qg(o)}function tv(e,t,n){const o=[];return e===t?n.resolve(e).marks().forEach(t=>{const r=Hm(n.resolve(e),t.type);r&&o.push(a({mark:t},r))}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null==e?void 0:e.nodeSize)&&o.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),o}function nv(e,t){return t.nodes[e]||t.marks[e]||null}function ov(e,t,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[o]=n;const r=e.find(e=>e.type===t&&e.name===o);return!!r&&r.attribute.keepOnSplit}))}function rv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:o,ranges:r}=e.selection,i=t?$m(t,e.schema):null;if(o)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>Lm(e.attrs,n,{strict:!1}));let s=0;const a=[];if(r.forEach(t=>{let{$from:n,$to:o}=t;const r=n.pos,i=o.pos;e.doc.nodesBetween(r,i,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(r,t),o=Math.min(i,t+e.nodeSize);s+=o-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:o})))})}),0===s)return!1;const l=a.filter(e=>!i||i.name===e.mark.type.name).filter(e=>Lm(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=s}function iv(e,t){return Array.isArray(t)?t.some(t=>("string"===typeof t?t:t.name)===e.name):t}function sv(e,t){const{nodeExtensions:n}=Lg(t),o=n.find(t=>t.name===e);if(!o)return!1;const r=zg(Pg(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"===typeof r&&r.split(" ").includes("list")}function av(e){let{checkChildren:t=!0,ignoreWhitespace:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var o;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(o=e.text)?o:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let o=!0;return e.content.forEach(e=>{!1!==o&&(av(e,{ignoreWhitespace:n,checkChildren:t})||(o=!1))}),o}return!1}function lv(e){return e instanceof Qu}var cv=class e{constructor(e){this.position=e}static fromJSON(t){return new e(t.position)}toJSON(){return{position:this.position}}};function uv(e,t){const n=t.mapping.mapResult(e.position);return{position:new cv(n.pos),mapResult:n}}function dv(e){return new cv(e)}var hv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:o,state:r,dispatch:i}=n;const{selection:s}=o,{empty:l,ranges:c}=s,u=$m(e,r.schema);if(i)if(l){const e=Tg(r,u);o.addStoredMark(u.create(a(a({},e),t)))}else c.forEach(e=>{const n=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(n,i,(e,r)=>{const s=Math.max(r,n),l=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===u)?e.marks.forEach(e=>{u===e.type&&o.addMark(s,l,u.create(a(a({},e.attrs),t)))}):o.addMark(s,l,u.create(t))})});return function(e,t,n){var o;const{selection:r}=t;let i=null;if(qm(r)&&(i=r.$cursor),i){const t=null!=(o=e.storedMarks)?o:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(t)||!t.some(e=>e.type.excludes(n)))}const{ranges:s}=r;return s.some(t=>{let{$from:o,$to:r}=t,i=0===o.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(o.pos,r.pos,(e,t,o)=>{if(i)return!1;if(e.isInline){const t=!o||o.type.allowsMarkType(n),r=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));i=t&&r}return!i}),i})}(r,o,u)}},fv=(e,t)=>n=>{let{tr:o}=n;return o.setMeta(e,t),!0},pv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:o,dispatch:r,chain:i}=n;const s=_m(e,o.schema);let l;return o.selection.$anchor.sameParent(o.selection.$head)&&(l=o.selection.$anchor.parent.attrs),s.isTextblock?i().command(e=>{let{commands:n}=e;return!!zd(s,a(a({},l),t))(o)||n.clearNodes()}).command(e=>{let{state:n}=e;return zd(s,a(a({},l),t))(n,r)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},mv=e=>t=>{let{tr:n,dispatch:o}=t;if(o){const{doc:t}=n,o=Km(e,0,t.content.size),r=Qu.create(t,o);n.setSelection(r)}return!0},gv=(e,t)=>n=>{let{tr:o,state:r,dispatch:i}=n;const{selection:s}=r;let l,c;return"number"===typeof t?(l=t,c=t):t&&"from"in t&&"to"in t?(l=t.from,c=t.to):(l=s.from,c=s.to),i&&o.doc.nodesBetween(l,c,(t,n)=>{t.isText||o.setNodeMarkup(n,void 0,a(a({},t.attrs),{},{dir:e}))}),!0},vv=e=>t=>{let{tr:n,dispatch:o}=t;if(o){const{doc:t}=n,{from:o,to:r}="number"===typeof e?{from:e,to:e}:e,i=Gu.atStart(t).from,s=Gu.atEnd(t).to,a=Km(o,i,s),l=Km(r,i,s),c=Gu.create(t,a,l);n.setSelection(c)}return!0},yv=e=>t=>{let{state:n,dispatch:o}=t;const r=_m(e,n.schema);return(i=r,function(e,t){let{$from:n,$to:o}=e.selection,r=n.blockRange(o,e=>e.childCount>0&&e.firstChild.type==i);if(!r)return!1;let s=r.startIndex;if(0==s)return!1;let a=r.parent,l=a.child(s-1);if(l.type!=i)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,o=Xl.from(n?i.create():null),s=new tc(Xl.from(i.create(null,Xl.from(a.type.create(null,o)))),n?3:1,0),c=r.start,u=r.end;t(e.tr.step(new vu(c-(n?3:1),u,c,u,s,1,!0)).scrollIntoView())}return!0})(n,o);var i};function bv(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const o=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(o)}}var xv=function(){let{keepMarks:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{tr:n,state:o,dispatch:r,editor:i}=t;const{selection:s,doc:a}=n,{$from:l,$to:c}=s,u=ov(i.extensionManager.attributes,l.node().type.name,l.node().attrs);if(s instanceof Qu&&s.node.isBlock)return!(!l.parentOffset||!Du(a,l.pos))&&(r&&(e&&bv(o,i.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const d=c.parentOffset===c.parent.content.size,h=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=Du(n.doc,n.mapping.map(l.pos),1,f);if(f||p||!Du(n.doc,n.mapping.map(l.pos),1,h?[{type:h}]:void 0)||(p=!0,f=h?[{type:h,attrs:u}]:void 0),r){if(p&&(s instanceof Gu&&n.deleteSelection(),n.split(n.mapping.map(l.pos),1,f),h&&!d&&!l.parentOffset&&l.parent.type!==h)){const e=n.mapping.map(l.before()),t=n.doc.resolve(e);l.node(-1).canReplaceWith(t.index(),t.index()+1,h)&&n.setNodeMarkup(n.mapping.map(l.before()),h)}e&&bv(o,i.extensionManager.splittableMarks),n.scrollIntoView()}return p}},wv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:o,state:r,dispatch:i,editor:s}=n;var l;const c=_m(e,r.schema),{$from:u,$to:d}=r.selection,h=r.selection.node;if(h&&h.isBlock||u.depth<2||!u.sameParent(d))return!1;const f=u.node(-1);if(f.type!==c)return!1;const p=s.extensionManager.attributes;if(0===u.parent.content.size&&u.node(-1).childCount===u.indexAfter(-1)){if(2===u.depth||u.node(-3).type!==c||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let e=Xl.empty;const n=u.index(-1)?1:u.index(-2)?2:3;for(let t=u.depth-n;t>=u.depth-3;t-=1)e=Xl.from(u.node(t).copy(e));const r=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,i=a(a({},ov(p,u.node().type.name,u.node().attrs)),t),s=(null==(l=c.contentMatch.defaultType)?void 0:l.createAndFill(i))||void 0;e=e.append(Xl.from(c.createAndFill(null,s)||void 0));const d=u.before(u.depth-(n-1));o.replace(d,u.after(-r),new tc(e,4-n,0));let h=-1;o.doc.nodesBetween(d,o.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&o.setSelection(Gu.near(o.doc.resolve(h))),o.scrollIntoView()}return!0}const m=d.pos===u.end()?f.contentMatchAt(0).defaultType:null,g=a(a({},ov(p,f.type.name,f.attrs)),t),v=a(a({},ov(p,u.node().type.name,u.node().attrs)),t);o.delete(u.pos,d.pos);const y=m?[{type:c,attrs:g},{type:m,attrs:v}]:[{type:c,attrs:g}];if(!Du(o.doc,u.pos,2))return!1;if(i){const{selection:e,storedMarks:t}=r,{splittableMarks:n}=s.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(o.split(u.pos,2,y).scrollIntoView(),!a||!i)return!0;const l=a.filter(e=>n.includes(e.type.name));o.ensureMarks(l)}return!0}},kv=(e,t)=>{const n=jg(e=>e.type===t)(e.selection);if(!n)return!0;const o=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===o)return!0;const r=e.doc.nodeAt(o);return n.node.type!==(null==r?void 0:r.type)||!Mu(e.doc,n.pos)||(e.join(n.pos),!0)},Cv=(e,t)=>{const n=jg(e=>e.type===t)(e.selection);if(!n)return!0;const o=e.doc.resolve(n.start).after(n.depth);if(void 0===o)return!0;const r=e.doc.nodeAt(o);return n.node.type!==(null==r?void 0:r.type)||!Mu(e.doc,o)||(e.join(o),!0)},Sv=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{let{editor:i,tr:s,state:a,dispatch:l,chain:c,commands:u,can:d}=r;const{extensions:h,splittableMarks:f}=i.extensionManager,p=_m(e,a.schema),m=_m(t,a.schema),{selection:g,storedMarks:v}=a,{$from:y,$to:b}=g,x=y.blockRange(b),w=v||g.$to.parentOffset&&g.$from.marks();if(!x)return!1;const k=jg(e=>sv(e.type.name,h))(g);if(x.depth>=1&&k&&x.depth-k.depth<=1){if(k.node.type===p)return u.liftListItem(m);if(sv(k.node.type.name,h)&&p.validContent(k.node.content)&&l)return c().command(()=>(s.setNodeMarkup(k.pos,p),!0)).command(()=>kv(s,p)).command(()=>Cv(s,p)).run()}return n&&w&&l?c().command(()=>{const e=d().wrapInList(p,o),t=w.filter(e=>f.includes(e.type.name));return s.ensureMarks(t),!!e||u.clearNodes()}).wrapInList(p,o).command(()=>kv(s,p)).command(()=>Cv(s,p)).run():c().command(()=>!!d().wrapInList(p,o)||u.clearNodes()).wrapInList(p,o).command(()=>kv(s,p)).command(()=>Cv(s,p)).run()}},Ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o=>{let{state:r,commands:i}=o;const{extendEmptyMarkRange:s=!1}=n,a=$m(e,r.schema);return rv(r,a,t)?i.unsetMark(a,{extendEmptyMarkRange:s}):i.setMark(a,t)}},Dv=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o=>{let{state:r,commands:i}=o;const s=_m(e,r.schema),l=_m(t,r.schema),c=pg(r,s,n);let u;return r.selection.$anchor.sameParent(r.selection.$head)&&(u=r.selection.$anchor.parent.attrs),c?i.setNode(l,u):i.setNode(s,a(a({},u),n))}},Mv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:o,commands:r}=n;const i=_m(e,o.schema);return pg(o,i,t)?r.lift(i):r.wrapIn(i,t)}},Nv=()=>e=>{let{state:t,dispatch:n}=e;const o=t.plugins;for(let r=0;r<o.length;r+=1){const e=o[r];let i;if(e.spec.isInputRules&&(i=e.getState(t))){if(n){const e=t.tr,n=i.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(i.text){const n=e.doc.resolve(i.from).marks();e.replaceWith(i.from,i.to,t.schema.text(i.text,n))}else e.delete(i.from,i.to)}return!0}}return!1},Av=()=>e=>{let{tr:t,dispatch:n}=e;const{selection:o}=t,{empty:r,ranges:i}=o;return r||n&&i.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},Ov=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:o,state:r,dispatch:i}=n;var s;const{extendEmptyMarkRange:a=!1}=t,{selection:l}=o,c=$m(e,r.schema),{$from:u,empty:d,ranges:h}=l;if(!i)return!0;if(d&&a){let{from:e,to:t}=l;const n=null==(s=u.marks().find(e=>e.type===c))?void 0:s.attrs,r=Hm(u,c,n);r&&(e=r.from,t=r.to),o.removeMark(e,t,c)}else h.forEach(e=>{o.removeMark(e.$from.pos,e.$to.pos,c)});return o.removeStoredMark(c),!0}},Tv=e=>t=>{let{tr:n,state:o,dispatch:r}=t;const{selection:i}=o;let s,l;return"number"===typeof e?(s=e,l=e):e&&"from"in e&&"to"in e?(s=e.from,l=e.to):(s=i.from,l=i.to),r&&n.doc.nodesBetween(s,l,(e,t)=>{if(e.isText)return;const o=a({},e.attrs);delete o.dir,n.setNodeMarkup(t,void 0,o)}),!0},_v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:o,state:r,dispatch:i}=n,s=null,l=null;const c=bg("string"===typeof e?e:e.name,r.schema);if(!c)return!1;"node"===c&&(s=_m(e,r.schema)),"mark"===c&&(l=$m(e,r.schema));let u=!1;return o.selection.ranges.forEach(e=>{const n=e.$from.pos,c=e.$to.pos;let d,h,f,p;o.selection.empty?r.doc.nodesBetween(n,c,(e,t)=>{s&&s===e.type&&(u=!0,f=Math.max(t,n),p=Math.min(t+e.nodeSize,c),d=t,h=e)}):r.doc.nodesBetween(n,c,(e,r)=>{r<n&&s&&s===e.type&&(u=!0,f=Math.max(r,n),p=Math.min(r+e.nodeSize,c),d=r,h=e),r>=n&&r<=c&&(s&&s===e.type&&(u=!0,i&&o.setNodeMarkup(r,void 0,a(a({},e.attrs),t))),l&&e.marks.length&&e.marks.forEach(s=>{if(l===s.type&&(u=!0,i)){const i=Math.max(r,n),u=Math.min(r+e.nodeSize,c);o.addMark(i,u,l.create(a(a({},s.attrs),t)))}}))}),h&&(void 0!==d&&i&&o.setNodeMarkup(d,void 0,a(a({},h.attrs),t)),l&&h.marks.length&&h.marks.forEach(e=>{l===e.type&&i&&o.addMark(f,p,l.create(a(a({},e.attrs),t)))}))}),u}},jv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:o,dispatch:r}=n;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,o){let{$from:r,$to:i}=n.selection,s=r.blockRange(i),a=s&&ku(s,e,t);return!!a&&(o&&o(n.tr.wrap(s,a).scrollIntoView()),!0)}}(_m(e,o.schema),t)(o,r)}},Pv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:o,dispatch:r}=n;return Wd(_m(e,o.schema),t)(o,r)}},Iv=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const r=this.callbacks[e];return r&&r.forEach(e=>e.apply(this,n)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){var n=this;const o=function(){n.off(e,o);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];t.apply(n,i)};return this.on(e,o)}removeAllListeners(){this.callbacks={}}},Rv=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=null==(t=e.undoable)||t}};function Fv(e){var t;const{editor:n,from:o,to:r,text:i,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(o);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let u=!1;const d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n="";const o=e.parentOffset;return e.parent.nodesBetween(Math.max(0,o-t),o,(e,t,r,i)=>{var s,a;const l=(null==(a=(s=e.type.spec).toText)?void 0:a.call(s,{node:e,pos:t,parent:r,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,o-t))}),n}(c)+i;return s.forEach(e=>{if(u)return;const t=((e,t)=>{if(zm(t))return t.exec(e);const n=t(e);if(!n)return null;const o=[n.text];return o.index=n.index,o.input=e,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o})(d,e.find);if(!t)return;const s=l.state.tr,c=km({state:l.state,transaction:s}),h={from:o-(t[0].length-i.length),to:r},{commands:f,chain:p,can:m}=new Cm({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:f,chain:p,can:m})&&s.steps.length&&(e.undoable&&s.setMeta(a,{transform:s,from:o,to:r,text:i}),l.dispatch(s),u=!0)}),u}function zv(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function Lv(e,t){const n=a({},e);return zv(e)&&zv(t)&&Object.keys(t).forEach(o=>{zv(t[o])&&zv(e[o])?n[o]=Lv(e[o],t[o]):n[o]=t[o]}),n}var Bv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=a(a({},this.config),e),this.name=this.config.name}get options(){return a({},zg(Pg(this,"addOptions",{name:this.name}))||{})}get storage(){return a({},zg(Pg(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend(a(a({},this.config),{},{addOptions:()=>Lv(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new this.constructor(a(a({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Vv=class e extends Bv{constructor(){super(...arguments),this.type="mark"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}static handleExit(e){let{editor:t,mark:n}=e;const{tr:o}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const e=r.marks();if(!!!e.find(e=>(null==e?void 0:e.type.name)===n.name))return!1;const i=e.find(e=>(null==e?void 0:e.type.name)===n.name);return i&&o.removeStoredMark(i),o.insertText(" ",r.pos),t.view.dispatch(o),!0}return!1}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}};var Hv=class{constructor(e){this.find=e.find,this.handler=e.handler}};function $v(e){const{editor:t,state:n,from:o,to:r,rule:i,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:u}=new Cm({editor:t,state:n}),d=[];n.doc.nodesBetween(o,r,(e,t)=>{var h,f,p,m,g;if((null==(f=null==(h=e.type)?void 0:h.spec)?void 0:f.code)||!(e.isText||e.isTextblock||e.isInline))return;const v=null!=(g=null!=(m=null==(p=e.content)?void 0:p.size)?m:e.nodeSize)?g:0,y=Math.max(o,t),b=Math.min(r,t+v);if(y>=b)return;const x=((e,t,n)=>{if(zm(t))return[...e.matchAll(t)];const o=t(e,n);return o?o.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.isText?e.text||"":e.textBetween(y-t,b-t,void 0,"\ufffc"),i.find,s);x.forEach(e=>{if(void 0===e.index)return;const t=y+e.index+1,o=t+e[0].length,r={from:n.tr.mapping.map(t),to:n.tr.mapping.map(o)},h=i.handler({state:n,range:r,match:e,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(h)})});return d.every(e=>null!==e)}var Wv=null;function Uv(e){const{editor:t,rules:n}=e;let o,r=null,i=!1,s=!1,a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{o="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(u){o=null}const l=e=>{let{state:n,from:r,to:i,rule:s,pasteEvt:l}=e;const c=n.tr,u=km({state:n,transaction:c});if($v({editor:t,state:u,from:Math.max(r-1,0),to:i.b-1,rule:s,pasteEvent:l,dropEvent:o})&&c.steps.length){try{o="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch(d){o=null}return a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}},c=n.map(e=>new hd({view(e){const n=n=>{var o;r=(null==(o=e.dom.parentElement)?void 0:o.contains(n.target))?e.dom.parentElement:null,r&&(Wv=t)},o=()=>{Wv&&(Wv=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",o),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",o)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(s=r===e.dom.parentElement,o=t,!s){const e=Wv;(null==e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const o=null==(n=t.clipboardData)?void 0:n.getData("text/html");return a=t,i=!!(null==o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,o)=>{const r=t[0],c="paste"===r.getMeta("uiEvent")&&!i,u="drop"===r.getMeta("uiEvent")&&!s,d=r.getMeta("applyPasteRules"),h=!!d;if(!c&&!u&&!h)return;if(h){let{text:t}=d;"string"===typeof t||(t=Rg(Xl.from(t),o.schema));const{from:n}=d,r=n+t.length,i=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n})(t);return l({rule:e,state:o,from:n,to:{b:r},pasteEvt:i})}const f=n.doc.content.findDiffStart(o.doc.content),p=n.doc.content.findDiffEnd(o.doc.content);return function(e){return"number"===typeof e}(f)&&p&&f!==p.b?l({rule:e,state:o,from:f,to:p,pasteEvt:a}):void 0}}));return c}var qv=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=Yg(e),this.schema=qg(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const n=Pg(t,"addCommands",{name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:nv(t.name,this.schema)});return n?a(a({},e),n()):e},{})}get plugins(){const{editor:e}=this,t=Kg([...this.extensions].reverse()).flatMap(t=>{const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:nv(t.name,this.schema)},o=[],r=Pg(t,"addKeyboardShortcuts",n);let i={};if("mark"===t.type&&Pg(t,"exitable",n)&&(i.ArrowRight=()=>Vv.handleExit({editor:e,mark:t})),r){const t=Object.fromEntries(Object.entries(r()).map(t=>{let[n,o]=t;return[n,()=>o({editor:e})]}));i=a(a({},i),t)}const s=new hd({props:{handleKeyDown:bm(i)}});o.push(s);const l=Pg(t,"addInputRules",n);if(iv(t,e.options.enableInputRules)&&l){const t=l();if(t&&t.length){const n=function(e){const{editor:t,rules:n}=e,o=new hd({state:{init:()=>null,apply(e,r,i){const s=e.getMeta(o);if(s)return s;const a=e.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:e}=a;"string"===typeof e||(e=Rg(Xl.from(e),i.schema));const{from:r}=a,s=r+e.length;Fv({editor:t,from:r,to:s,text:e,rules:n,plugin:o})}),e.selectionSet||e.docChanged?null:r}},props:{handleTextInput:(e,r,i,s)=>Fv({editor:t,from:r,to:i,text:s,rules:n,plugin:o}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:r}=e.state.selection;r&&Fv({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:o})}),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;const{$cursor:i}=e.state.selection;return!!i&&Fv({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:o})}},isInputRules:!0});return o}({editor:e,rules:t}),r=Array.isArray(n)?n:[n];o.push(...r)}}const c=Pg(t,"addPasteRules",n);if(iv(t,e.options.enablePasteRules)&&c){const t=c();if(t&&t.length){const n=Uv({editor:e,rules:t});o.push(...n)}}const u=Pg(t,"addProseMirrorPlugins",n);if(u){const e=u();o.push(...e)}return o});return t}get attributes(){return Bg(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Lg(this.extensions);return Object.fromEntries(t.filter(e=>!!Pg(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),o={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:_m(t.name,this.schema)},r=Pg(t,"addNodeView",o);if(!r)return[];const i=r();if(!i)return[];return[t.name,(o,r,s,a,l)=>{const c=Hg(o,n);return i({node:o,view:r,getPos:s,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}get markViews(){const{editor:e}=this,{markExtensions:t}=Lg(this.extensions);return Object.fromEntries(t.filter(e=>!!Pg(e,"addMarkView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),o={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:$m(t.name,this.schema)},r=Pg(t,"addMarkView",o);if(!r)return[];return[t.name,(o,i,s)=>{const a=Hg(o,n);return r()({mark:o,view:i,inline:s,editor:e,extension:t,HTMLAttributes:a,updateAttributes:t=>{by(o,e,t)}})}]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(e=>[e.name,e.storage])),e.forEach(e=>{var t;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:nv(e.name,this.schema)};if("mark"===e.type){(null==(t=zg(Pg(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name)}const o=Pg(e,"onBeforeCreate",n),r=Pg(e,"onCreate",n),i=Pg(e,"onUpdate",n),s=Pg(e,"onSelectionUpdate",n),a=Pg(e,"onTransaction",n),l=Pg(e,"onFocus",n),c=Pg(e,"onBlur",n),u=Pg(e,"onDestroy",n);o&&this.editor.on("beforeCreate",o),r&&this.editor.on("create",r),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}};qv.resolve=Yg,qv.sort=Kg,qv.flatten=Ig;wm({},{ClipboardTextSerializer:()=>Yv,Commands:()=>Xv,Delete:()=>Zv,Drop:()=>Gv,Editable:()=>Jv,FocusEvents:()=>ey,Keymap:()=>ty,Paste:()=>ny,Tabindex:()=>oy,TextDirection:()=>ry,focusEventsPluginKey:()=>Qv});var Kv=class e extends Bv{constructor(){super(...arguments),this.type="extension"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}},Yv=Kv.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new hd({key:new md("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:o,selection:r}=t,{ranges:i}=r,s=Math.min(...i.map(e=>e.$from.pos)),l=Math.max(...i.map(e=>e.$to.pos)),c=Gg(n);return Xg(o,{from:s,to:l},a(a({},void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{}),{},{textSerializers:c}))}}})]}}),Xv=Kv.create({name:"commands",addCommands:()=>a({},Sm)}),Zv=Kv.create({name:"delete",onUpdate(e){let{transaction:t,appendedTransactions:n}=e;var o,r,i;const s=()=>{var e,o,r,i;if(null!=(i=null==(r=null==(o=null==(e=this.editor.options.coreExtensionOptions)?void 0:e.delete)?void 0:o.filterTransaction)?void 0:r.call(o,t))?i:t.getMeta("y-sync$"))return;const s=_g(t.before,[t,...n]);ev(s).forEach(e=>{s.mapping.mapResult(e.oldRange.from).deletedAfter&&s.mapping.mapResult(e.oldRange.to).deletedBefore&&s.before.nodesBetween(e.oldRange.from,e.oldRange.to,(n,o)=>{const r=o+n.nodeSize-2,i=e.oldRange.from<=o&&r<=e.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:o,to:r,newFrom:s.mapping.map(o),newTo:s.mapping.map(r),deletedRange:e.oldRange,newRange:e.newRange,partial:!i,editor:this.editor,transaction:t,combinedTransform:s})})});const a=s.mapping;s.steps.forEach((e,n)=>{var o,r;if(e instanceof fu){const i=a.slice(n).map(e.from,-1),l=a.slice(n).map(e.to),c=a.invert().map(i,-1),u=a.invert().map(l),d=null==(o=s.doc.nodeAt(i-1))?void 0:o.marks.some(t=>t.eq(e.mark)),h=null==(r=s.doc.nodeAt(l))?void 0:r.marks.some(t=>t.eq(e.mark));this.editor.emit("delete",{type:"mark",mark:e.mark,from:e.from,to:e.to,deletedRange:{from:c,to:u},newRange:{from:i,to:l},partial:Boolean(h||d),editor:this.editor,transaction:t,combinedTransform:s})}})};null==(i=null==(r=null==(o=this.editor.options.coreExtensionOptions)?void 0:o.delete)?void 0:r.async)||i?setTimeout(s,0):s()}}),Gv=Kv.create({name:"drop",addProseMirrorPlugins(){return[new hd({key:new md("tiptapDrop"),props:{handleDrop:(e,t,n,o)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:o})}}})]}}),Jv=Kv.create({name:"editable",addProseMirrorPlugins(){return[new hd({key:new md("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Qv=new md("focusEvents"),ey=Kv.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new hd({key:Qv,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const o=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(o),!1},blur:(t,n)=>{e.isFocused=!1;const o=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(o),!1}}}})]}}),ty=Kv.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.undoInputRule(),()=>t.command(e=>{let{tr:n}=e;const{selection:o,doc:r}=n,{empty:i,$anchor:s}=o,{pos:a,parent:l}=s,c=s.parent.isTextblock&&a>0?n.doc.resolve(a-1):s,u=c.parent.type.spec.isolating,d=s.pos-s.parentOffset,h=u&&1===c.parent.childCount?d===s.pos:Ku.atStart(r).from===a;return!(!i||!l.type.isTextblock||l.textContent.length||!h||h&&"paragraph"===s.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]}),t=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]}),n={Enter:()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]}),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},o=a({},n),r=a(a({},n),{},{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return Zm()||hg()?r:o},addProseMirrorPlugins(){return[new hd({key:new md("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const o=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),r=e.some(e=>e.getMeta("preventClearDocument"));if(!o||r)return;const{empty:i,from:s,to:a}=t.selection,l=Ku.atStart(t.doc).from,c=Ku.atEnd(t.doc).to;if(i||!(s===l&&a===c))return;if(!av(n.doc))return;const u=n.tr,d=km({state:n,transaction:u}),{commands:h}=new Cm({editor:this.editor,state:d});return h.clearNodes(),u.steps.length?u:void 0}})]}}),ny=Kv.create({name:"paste",addProseMirrorPlugins(){return[new hd({key:new md("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),oy=Kv.create({name:"tabindex",addProseMirrorPlugins(){return[new hd({key:new md("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),ry=Kv.create({name:"textDirection",addOptions:()=>({direction:void 0}),addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=Lg(this.extensions);return[{types:e.filter(e=>"text"!==e.name).map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const t=e.getAttribute("dir");return!t||"ltr"!==t&&"rtl"!==t&&"auto"!==t?this.options.direction:t},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new hd({key:new md("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),iy=class e{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=o}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error("You can\u2019t set content on a block node. Tried to set content on ".concat(this.name," at ").concat(this.pos));t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new e(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new e(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new e(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,o)=>{const r=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,s=this.pos+o+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!r&&a.depth<=this.depth)return;const l=new e(a,this.editor,r,r?n:null);r&&(l.actualDepth=this.depth+1),t.push(new e(a,this.editor,r,r?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,o=this.parent;for(;o&&!n;){if(o.node.type.name===e)if(Object.keys(t).length>0){const e=o.node.attrs,n=Object.keys(t);for(let o=0;o<n.length;o+=1){const r=n[o];if(e[r]!==t[r])break}}else n=o;o=o.parent}return n}querySelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];if(!this.children||0===this.children.length)return o;const r=Object.keys(t);return this.children.forEach(i=>{if(!(n&&o.length>0)){if(i.node.type.name===e){const e=r.every(e=>t[e]===i.node.attrs[e]);e&&o.push(i)}n&&o.length>0||(o=o.concat(i.querySelectorAll(e,t,n)))}}),o}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,a(a({},this.node.attrs),e)),this.editor.view.dispatch(t)}};var sy=class extends Iv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!==typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:e=>{let{error:t}=e;throw t},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:uv,createMappablePosition:dv},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",e=>{let{event:t,slice:n,moved:o}=e;return this.options.onDrop(t,n,o)}),this.on("paste",e=>{let{event:t,slice:n}=e;return this.options.onPaste(t,n)}),this.on("delete",this.options.onDelete);const t=this.createDoc(),n=Ym(t,this.options.autofocus);this.editorState=ud.create({doc:t,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if("undefined"===typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(!1!==this.options.autofocus&&null!==this.options.autofocus&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;(null==e?void 0:e.editor)&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(".".concat(this.className)).length)try{"function"===typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!==typeof document&&(this.css=function(e,t,n){const o=document.querySelector("style[data-tiptap-style".concat(n?"-".concat(n):"","]"));if(null!==o)return o;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style".concat(n?"-".concat(n):""),""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',this.options.injectNonce))}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=a(a({},this.options),e),this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if("state"===t)return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error("[tiptap error]: The editor view is not available. Cannot access view['".concat(t,"']. The editor may not be mounted yet."))}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const n=Fg(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"===typeof e?"".concat(e,"$"):e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[Jv,Yv.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),Xv,ey,ty,oy,Gv,ny,Zv,ry.configure({direction:this.options.textDirection})].filter(e=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new qv(n,this)}createCommandManager(){this.commandManager=new Cm({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Ag(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&"object"===typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=Ag(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new om(e,a(a({},this.options.editorProps),{},{attributes:a({role:"textbox"},null==(t=this.options.editorProps)?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className="".concat(this.className," ").concat(this.view.dom.className)}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)}):void(this.capturedTransaction=e);const{state:t,transactions:n}=this.state.applyTransaction(e),o=!this.state.selection.eq(t.selection),r=n.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!r)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:n.slice(1)}),o&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=n.findLast(e=>e.getMeta("focus")||e.getMeta("blur")),a=null==s?void 0:s.getMeta("focus"),l=null==s?void 0:s.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),e.getMeta("preventUpdate")||!n.some(e=>e.docChanged)||i.doc.eq(t.doc)||this.emit("update",{editor:this,transaction:e,appendedTransactions:n.slice(1)})}getAttributes(e){return Jg(this.state,e)}isActive(e,t){const n="string"===typeof e?e:null,o="string"===typeof e?t:e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return pg(e,null,n)||rv(e,null,n);const o=bg(t,e.schema);return"node"===o?pg(e,t,n):"mark"===o&&rv(e,t,n)}(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Rg(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return Zg(this.state.doc,{blockSeparator:t,textSerializers:a(a({},Gg(this.schema)),n)})}get isEmpty(){return av(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return null==(t=null==(e=this.editorView)?void 0:e.isDestroyed)||t}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new iy(t,this)}get $doc(){return this.$pos(0)}};function ay(e){return new Rv({find:e.find,handler:t=>{let{state:n,range:o,match:r}=t;const i=zg(e.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:s}=n,a=r[r.length-1],l=r[0];if(a){const t=l.search(/\S/),r=o.from+l.indexOf(a),c=r+a.length;if(tv(o.from,o.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>r).length)return null;c<o.to&&s.delete(c,o.to),r>o.from&&s.delete(o.from+t,r);const u=o.from+t+a.length;s.addMark(o.from+t,u,e.type.create(i||{})),s.removeStoredMark(e.type)}},undoable:e.undoable})}function ly(e){return new Rv({find:e.find,handler:t=>{let{state:n,range:o,match:r}=t;const i=n.doc.resolve(o.from),s=zg(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;n.tr.delete(o.from,o.to).setBlockType(o.from,o.from,e.type,s)},undoable:e.undoable})}function cy(e){return new Rv({find:e.find,handler:t=>{let{state:n,range:o,match:r,chain:i}=t;const s=zg(e.getAttributes,void 0,r)||{},a=n.tr.delete(o.from,o.to),l=a.doc.resolve(o.from).blockRange(),c=l&&ku(l,e.type,s);if(!c)return null;if(a.wrap(l,c),e.keepMarks&&e.editor){const{selection:t,storedMarks:o}=n,{splittableMarks:r}=e.editor.extensionManager,i=o||t.$to.parentOffset&&t.$from.marks();if(i){const e=i.filter(e=>r.includes(e.type.name));a.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,s).run()}const u=a.doc.resolve(o.from-1).nodeBefore;u&&u.type===e.type&&Mu(a.doc,o.from-1)&&(!e.joinPredicate||e.joinPredicate(r,u))&&a.join(o.from-1)},undoable:e.undoable})}function uy(e){if(!(null==e?void 0:e.trim()))return{};const t={},n=[],o=e.replace(/["']([^"']*)["']/g,e=>(n.push(e),"__QUOTED_".concat(n.length-1,"__"))),r=o.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(r){const e=r.map(e=>e.trim().slice(1));t.class=e.join(" ")}const i=o.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]);Array.from(o.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(e=>{let[,o,r]=e;var i;const s=parseInt((null==(i=r.match(/__QUOTED_(\d+)__/))?void 0:i[1])||"0",10),a=n[s];a&&(t[o]=a.slice(1,-1))});const s=o.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();if(s){s.split(/\s+/).filter(Boolean).forEach(e=>{e.match(/^[a-zA-Z][\w-]*$/)&&(t[e]=!0)})}return t}function dy(e){if(!e||0===Object.keys(e).length)return"";const t=[];if(e.class){String(e.class).split(/\s+/).filter(Boolean).forEach(e=>t.push(".".concat(e)))}return e.id&&t.push("#".concat(e.id)),Object.entries(e).forEach(e=>{let[n,o]=e;"class"!==n&&"id"!==n&&(!0===o?t.push(n):!1!==o&&null!=o&&t.push("".concat(n,'="').concat(String(o),'"')))}),t.join(" ")}function hy(e){const{nodeName:t,name:n,parseAttributes:o=uy,serializeAttributes:r=dy,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:l}=e,c=n||t;return{parseMarkdown:(e,n)=>{const o=a(a({},i),e.attributes);return n.createNode(t,o,[])},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp("^:::".concat(c,"(?:\\s|$)"),"m"),o=null==(t=e.match(n))?void 0:t.index;return void 0!==o?o:-1},tokenize(e,n,r){const i=new RegExp("^:::".concat(c,"(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)")),a=e.match(i);if(!a)return;const l=a[1]||"",u=o(l);return s.find(e=>!(e in u))?void 0:{type:t,raw:a[0],attributes:u}}},renderMarkdown:e=>{const t=(e=>{if(!l)return e;const t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),n=r(t),o=n?" {".concat(n,"}"):"";return":::".concat(c).concat(o," :::")}}}function fy(e){const{nodeName:t,name:n,getContent:o,parseAttributes:r=uy,serializeAttributes:i=dy,defaultAttributes:s={},content:l="block",allowedAttributes:c}=e,u=n||t;return{parseMarkdown:(e,n)=>{let r;if(o){const t=o(e);r="string"===typeof t?[{type:"text",text:t}]:t}else r="block"===l?n.parseChildren(e.tokens||[]):n.parseInline(e.tokens||[]);const i=a(a({},s),e.attributes);return n.createNode(t,i,r)},markdownTokenizer:{name:t,level:"block",start(e){var t;const n=new RegExp("^:::".concat(u),"m"),o=null==(t=e.match(n))?void 0:t.index;return void 0!==o?o:-1},tokenize(e,n,o){var i;const s=new RegExp("^:::".concat(u,"(?:\\s+\\{([^}]*)\\})?\\s*\\n")),a=e.match(s);if(!a)return;const[c,d=""]=a,h=r(d);let f=1;const p=c.length;let m="";const g=/^:::([\w-]*)(\s.*)?/gm,v=e.slice(p);for(g.lastIndex=0;;){const n=g.exec(v);if(null===n)break;const r=n.index,s=n[1];if(!(null==(i=n[2])?void 0:i.endsWith(":::")))if(s)f+=1;else if(f-=1,0===f){const i=v.slice(0,r);m=i.trim();const s=e.slice(0,p+r+n[0].length);let a=[];if(m)if("block"===l)for(a=o.blockTokens(i),a.forEach(e=>{!e.text||e.tokens&&0!==e.tokens.length||(e.tokens=o.inlineTokens(e.text))});a.length>0;){const e=a[a.length-1];if("paragraph"!==e.type||e.text&&""!==e.text.trim())break;a.pop()}else a=o.inlineTokens(m);return{type:t,raw:s,attributes:h,content:m,tokens:a}}}}},renderMarkdown:(e,t)=>{const n=(e=>{if(!c)return e;const t={};return c.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),o=i(n),r=o?" {".concat(o,"}"):"",s=t.renderChildren(e.content||[],"\n\n");return":::".concat(u).concat(r,"\n\n").concat(s,"\n\n:::")}}}function py(e){if(!e.trim())return{};const t={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let o=n.exec(e);for(;null!==o;){const[,r,i,s]=o;t[r]=i||s,o=n.exec(e)}return t}function my(e){return Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t&&null!==t}).map(e=>{let[t,n]=e;return"".concat(t,'="').concat(n,'"')}).join(" ")}function gy(e){const{nodeName:t,name:n,getContent:o,parseAttributes:r=py,serializeAttributes:i=my,defaultAttributes:s={},selfClosing:l=!1,allowedAttributes:c}=e,u=n||t,d=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(e,n)=>{const r=a(a({},s),e.attributes);if(l)return n.createNode(t,r);const i=o?o(e):e.content||"";return i?n.createNode(t,r,[n.createTextNode(i)]):n.createNode(t,r,[])},markdownTokenizer:{name:t,level:"inline",start(e){const t=l?new RegExp("\\[".concat(d,"\\s*[^\\]]*\\]")):new RegExp("\\[".concat(d,"\\s*[^\\]]*\\][\\s\\S]*?\\[\\/").concat(d,"\\]")),n=e.match(t),o=null==n?void 0:n.index;return void 0!==o?o:-1},tokenize(e,n,o){const i=l?new RegExp("^\\[".concat(d,"\\s*([^\\]]*)\\]")):new RegExp("^\\[".concat(d,"\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/").concat(d,"\\]")),s=e.match(i);if(!s)return;let a="",c="";if(l){const[,e]=s;c=e}else{const[,e,t]=s;c=e,a=t||""}const u=r(c.trim());return{type:t,raw:s[0],content:a.trim(),attributes:u}}},renderMarkdown:e=>{let t="";o?t=o(e):e.content&&e.content.length>0&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""));const n=(e=>{if(!c)return e;const t={};return c.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{}),r=i(n),s=r?" ".concat(r):"";return l?"[".concat(u).concat(s,"]"):"[".concat(u).concat(s,"]").concat(t,"[/").concat(u,"]")}}}function vy(e,t,n){var o,r,i,s;const a=e.split("\n"),l=[];let c="",u=0;const d=t.baseIndentSize||2;for(;u<a.length;){const e=a[u],h=e.match(t.itemPattern);if(!h){if(l.length>0)break;if(""===e.trim()){u+=1,c="".concat(c).concat(e,"\n");continue}return}const f=t.extractItemData(h),{indentLevel:p,mainContent:m}=f;c="".concat(c).concat(e,"\n");const g=[m];for(u+=1;u<a.length;){const e=a[u];if(""===e.trim()){const t=a.slice(u+1).findIndex(e=>""!==e.trim());if(-1===t)break;if(((null==(r=null==(o=a[u+1+t].match(/^(\s*)/))?void 0:o[1])?void 0:r.length)||0)>p){g.push(e),c="".concat(c).concat(e,"\n"),u+=1;continue}break}if(!(((null==(s=null==(i=e.match(/^(\s*)/))?void 0:i[1])?void 0:s.length)||0)>p))break;g.push(e),c="".concat(c).concat(e,"\n"),u+=1}let v;const y=g.slice(1);if(y.length>0){const e=y.map(e=>e.slice(p+d)).join("\n");e.trim()&&(v=t.customNestedParser?t.customNestedParser(e):n.blockTokens(e))}const b=t.createToken(f,v);l.push(b)}if(0!==l.length)return{items:l,raw:c}}function yy(e,t,n,o){if(!e||!Array.isArray(e.content))return"";const r="function"===typeof n?n(o):n,[i,...s]=e.content,a=t.renderChildren([i]),l=["".concat(r).concat(a)];return s&&s.length>0&&s.forEach(e=>{const n=t.renderChildren([e]);if(n){const e=n.split("\n").map(e=>e?t.indent(e):"").join("\n");l.push(e)}}),l.join("\n")}function by(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{state:o}=t,{doc:r,tr:i}=o,s=e;r.descendants((t,o)=>{const r=i.mapping.map(o),l=i.mapping.map(o)+t.nodeSize;let c=null;if(t.marks.forEach(e=>{if(e!==s)return!1;c=e}),!c)return;let u=!1;if(Object.keys(n).forEach(e=>{n[e]!==c.attrs[e]&&(u=!0)}),u){const t=e.type.create(a(a({},e.attrs),n));i.removeMark(r,l,e.type),i.addMark(r,l,t)}}),i.docChanged&&t.view.dispatch(i)}wm({},{createAtomBlockMarkdownSpec:()=>hy,createBlockMarkdownSpec:()=>fy,createInlineMarkdownSpec:()=>gy,parseAttributes:()=>uy,parseIndentedBlocks:()=>vy,renderNestedMarkdownContent:()=>yy,serializeAttributes:()=>dy});var xy=class e extends Bv{constructor(){super(...arguments),this.type="node"}static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n="function"===typeof t?t():t;return new e(n)}configure(e){return super.configure(e)}extend(e){const t="function"===typeof e?e():e;return super.extend(t)}};function wy(e){return new Hv({find:e.find,handler:t=>{let{state:n,range:o,match:r,pasteEvent:i}=t;const s=zg(e.getAttributes,void 0,r,i);if(!1===s||null===s)return null;const{tr:a}=n,l=r[r.length-1],c=r[0];let u=o.to;if(l){const t=c.search(/\S/),r=o.from+c.indexOf(l),i=r+l.length;if(tv(o.from,o.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>r).length)return null;i<o.to&&a.delete(i,o.to),r>o.from&&a.delete(o.from+t,r),u=o.from+t+l.length,a.addMark(o.from+t,u,e.type.create(s||{})),a.removeStoredMark(e.type)}}})}var ky=Object.getOwnPropertyNames,Cy=Object.getOwnPropertySymbols,Sy=Object.prototype.hasOwnProperty;function Ey(e,t){return function(n,o,r){return e(n,o,r)&&t(n,o,r)}}function Dy(e){return function(t,n,o){if(!t||!n||"object"!==typeof t||"object"!==typeof n)return e(t,n,o);var r=o.cache,i=r.get(t),s=r.get(n);if(i&&s)return i===n&&s===t;r.set(t,n),r.set(n,t);var a=e(t,n,o);return r.delete(t),r.delete(n),a}}function My(e){return ky(e).concat(Cy(e))}var Ny=Object.hasOwn||function(e,t){return Sy.call(e,t)};function Ay(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Oy=Object.getOwnPropertyDescriptor,Ty=Object.keys;function _y(e,t,n){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function jy(e,t){return Ay(e.getTime(),t.getTime())}function Py(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Iy(e,t){return e===t}function Ry(e,t,n){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var r,i,s=new Array(o),a=e.entries(),l=0;(r=a.next())&&!r.done;){for(var c=t.entries(),u=!1,d=0;(i=c.next())&&!i.done;)if(s[d])d++;else{var h=r.value,f=i.value;if(n.equals(h[0],f[0],l,d,e,t,n)&&n.equals(h[1],f[1],h[0],f[0],e,t,n)){u=s[d]=!0;break}d++}if(!u)return!1;l++}return!0}var Fy=Ay;function zy(e,t,n){var o=Ty(e),r=o.length;if(Ty(t).length!==r)return!1;for(;r-- >0;)if(!Uy(e,t,n,o[r]))return!1;return!0}function Ly(e,t,n){var o,r,i,s=My(e),a=s.length;if(My(t).length!==a)return!1;for(;a-- >0;){if(!Uy(e,t,n,o=s[a]))return!1;if(r=Oy(e,o),i=Oy(t,o),(r||i)&&(!r||!i||r.configurable!==i.configurable||r.enumerable!==i.enumerable||r.writable!==i.writable))return!1}return!0}function By(e,t){return Ay(e.valueOf(),t.valueOf())}function Vy(e,t){return e.source===t.source&&e.flags===t.flags}function Hy(e,t,n){var o=e.size;if(o!==t.size)return!1;if(!o)return!0;for(var r,i,s=new Array(o),a=e.values();(r=a.next())&&!r.done;){for(var l=t.values(),c=!1,u=0;(i=l.next())&&!i.done;){if(!s[u]&&n.equals(r.value,i.value,r.value,i.value,e,t,n)){c=s[u]=!0;break}u++}if(!c)return!1}return!0}function $y(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Wy(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Uy(e,t,n,o){return!("_owner"!==o&&"__o"!==o&&"__v"!==o||!e.$$typeof&&!t.$$typeof)||Ny(t,o)&&n.equals(e[o],t[o],o,o,e,t,n)}var qy=Array.isArray,Ky="undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView:null,Yy=Object.assign,Xy=Object.prototype.toString.call.bind(Object.prototype.toString);function Zy(e){var t=e.areArraysEqual,n=e.areDatesEqual,o=e.areErrorsEqual,r=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,a=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,d=e.areTypedArraysEqual,h=e.areUrlsEqual,f=e.unknownTagComparators;return function(e,p,m){if(e===p)return!0;if(null==e||null==p)return!1;var g=typeof e;if(g!==typeof p)return!1;if("object"!==g)return"number"===g?s(e,p,m):"function"===g&&r(e,p,m);var v=e.constructor;if(v!==p.constructor)return!1;if(v===Object)return a(e,p,m);if(qy(e))return t(e,p,m);if(null!=Ky&&Ky(e))return d(e,p,m);if(v===Date)return n(e,p,m);if(v===RegExp)return c(e,p,m);if(v===Map)return i(e,p,m);if(v===Set)return u(e,p,m);var y=Xy(e);if("[object Date]"===y)return n(e,p,m);if("[object RegExp]"===y)return c(e,p,m);if("[object Map]"===y)return i(e,p,m);if("[object Set]"===y)return u(e,p,m);if("[object Object]"===y)return"function"!==typeof e.then&&"function"!==typeof p.then&&a(e,p,m);if("[object URL]"===y)return h(e,p,m);if("[object Error]"===y)return o(e,p,m);if("[object Arguments]"===y)return a(e,p,m);if("[object Boolean]"===y||"[object Number]"===y||"[object String]"===y)return l(e,p,m);if(f){var b=f[y];if(!b){var x=function(e){return null!=e?e[Symbol.toStringTag]:void 0}(e);x&&(b=f[x])}if(b)return b(e,p,m)}return!1}}var Gy=Jy();Jy({strict:!0}),Jy({circular:!0}),Jy({circular:!0,strict:!0}),Jy({createInternalComparator:function(){return Ay}}),Jy({strict:!0,createInternalComparator:function(){return Ay}}),Jy({circular:!0,createInternalComparator:function(){return Ay}}),Jy({circular:!0,createInternalComparator:function(){return Ay},strict:!0});function Jy(e){void 0===e&&(e={});var t,n=e.circular,o=void 0!==n&&n,r=e.createInternalComparator,i=e.createState,s=e.strict,a=void 0!==s&&s,l=function(e){var t=e.circular,n=e.createCustomConfig,o=e.strict,r={areArraysEqual:o?Ly:_y,areDatesEqual:jy,areErrorsEqual:Py,areFunctionsEqual:Iy,areMapsEqual:o?Ey(Ry,Ly):Ry,areNumbersEqual:Fy,areObjectsEqual:o?Ly:zy,arePrimitiveWrappersEqual:By,areRegExpsEqual:Vy,areSetsEqual:o?Ey(Hy,Ly):Hy,areTypedArraysEqual:o?Ly:$y,areUrlsEqual:Wy,unknownTagComparators:void 0};if(n&&(r=Yy({},r,n(r))),t){var i=Dy(r.areArraysEqual),s=Dy(r.areMapsEqual),a=Dy(r.areObjectsEqual),l=Dy(r.areSetsEqual);r=Yy({},r,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:l})}return r}(e),c=Zy(l);return function(e){var t=e.circular,n=e.comparator,o=e.createState,r=e.equals,i=e.strict;if(o)return function(e,s){var a=o(),l=a.cache,c=void 0===l?t?new WeakMap:void 0:l,u=a.meta;return n(e,s,{cache:c,equals:r,meta:u,strict:i})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};var s={cache:void 0,equals:r,meta:void 0,strict:i};return function(e,t){return n(e,t,s)}}({circular:o,comparator:c,createState:i,equals:r?r(c):(t=c,function(e,n,o,r,i,s,a){return t(e,n,a)}),strict:a})}const Qy=["editor","innerRef"];var eb=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):t&&(t.current=e)})}},tb=e=>{let{contentComponent:t}=e;const n=(0,Wl.useSyncExternalStore)(t.subscribe,t.getSnapshot,t.getServerSnapshot);return(0,c.jsx)(c.Fragment,{children:Object.values(n)})};var nb=class extends e.Component{constructor(t){var n;super(t),this.editorContentRef=e.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null==(n=t.editor)?void 0:n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(e.view.dom),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,o){t=a(a({},t),{},{[n]:Ai.createPortal(o.reactElement,o.element,n)}),e.forEach(e=>e())},removeRenderer(n){const o=a({},t);delete o[n],t=o,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!(null==(e=t.view.dom)?void 0:e.firstChild))return;const n=document.createElement("div");n.append(t.view.dom),t.setOptions({element:n})}catch(n){}}}render(){const e=this.props,{editor:t,innerRef:n}=e,o=l(e,Qy);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",a({ref:eb(n,this.editorContentRef)},o)),(null==t?void 0:t.contentComponent)&&(0,c.jsx)(tb,{contentComponent:t.contentComponent})]})}},ob=(0,e.forwardRef)((t,n)=>{const o=e.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[t.editor]);return e.createElement(nb,a({key:o,innerRef:n},t))}),rb=e.memo(ob),ib="undefined"!==typeof window?e.useLayoutEffect:e.useEffect,sb=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}};var ab="undefined"===typeof window,lb=ab||Boolean("undefined"!==typeof window&&window.next),cb=class e{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?ab||lb?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){var e=this;const t=a(a({},this.options.current),{},{onBeforeCreate:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onBeforeCreate)?void 0:n.call(t,...r)},onBlur:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onBlur)?void 0:n.call(t,...r)},onCreate:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onCreate)?void 0:n.call(t,...r)},onDestroy:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onDestroy)?void 0:n.call(t,...r)},onFocus:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onFocus)?void 0:n.call(t,...r)},onSelectionUpdate:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onSelectionUpdate)?void 0:n.call(t,...r)},onTransaction:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onTransaction)?void 0:n.call(t,...r)},onUpdate:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onUpdate)?void 0:n.call(t,...r)},onContentError:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onContentError)?void 0:n.call(t,...r)},onDrop:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onDrop)?void 0:n.call(t,...r)},onPaste:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onPaste)?void 0:n.call(t,...r)},onDelete:function(){for(var t,n,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return null==(n=(t=e.options.current).onDelete)?void 0:n.call(t,...r)}});return new sy(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var o;return e===(null==(o=t.extensions)?void 0:o[n])}):e[n]===t[n]))}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===t.length?e.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions(a(a({},this.options.current),{},{editable:this.editor.isEditable})):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);const t=this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]);if(t)return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function ub(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=(0,e.useRef)(t);o.current=t;const[r]=(0,e.useState)(()=>new cb(o)),i=(0,Wl.useSyncExternalStore)(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,e.useDebugValue)(i),(0,e.useEffect)(r.onRender(n)),function(t){var n;const[o]=(0,e.useState)(()=>new sb(t.editor)),r=(0,xi.useSyncExternalStoreWithSelector)(o.subscribe,o.getSnapshot,o.getServerSnapshot,t.selector,null!=(n=t.equalityFn)?n:Gy);ib(()=>o.watch(t.editor),[t.editor,o]),(0,e.useDebugValue)(r)}({editor:i,selector:e=>{let{transactionNumber:n}=e;return!1===t.shouldRerenderOnTransaction||void 0===t.shouldRerenderOnTransaction?null:t.immediatelyRender&&0===n?0:n+1}}),i}var db=(0,e.createContext)({editor:null});db.Consumer;var hb=(0,e.createContext)({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),fb=()=>(0,e.useContext)(hb);e.forwardRef((e,t)=>{const{onDragStart:n}=fb(),o=e.as||"div";return(0,c.jsx)(o,a(a({},e),{},{ref:t,"data-node-view-wrapper":"",onDragStart:n,style:a({whiteSpace:"normal"},e.style)}))});e.createContext({markViewContentRef:()=>{}});const pb=["children"];var mb=(e,t)=>{if("slot"===e)return 0;if(e instanceof Function)return e(t);const n=null!=t?t:{},{children:o}=n,r=l(n,pb);if("svg"===e)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,o]},gb=/^\s*>\s$/,vb=xy.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return mb("blockquote",a(a({},Vg(this.options.HTMLAttributes,t)),{},{children:mb("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const n=[];return e.content.forEach(e=>{const o=t.renderChildren([e]).split("\n").map(e=>""===e.trim()?">":"".concat(">"," ").concat(e));n.push(o.join("\n"))}),n.join("\n".concat(">","\n"))},addCommands(){return{setBlockquote:()=>e=>{let{commands:t}=e;return t.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{commands:t}=e;return t.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[cy({find:gb,type:this.type})]}}),yb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bb=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,xb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,wb=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,kb=Vv.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML(e){let{HTMLAttributes:t}=e;return mb("strong",a(a({},Vg(this.options.HTMLAttributes,t)),{},{children:mb("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"**".concat(t.renderChildren(e),"**"),addCommands(){return{setBold:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleBold:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetBold:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ay({find:yb,type:this.type}),ay({find:xb,type:this.type})]},addPasteRules(){return[wy({find:bb,type:this.type}),wy({find:wb,type:this.type})]}}),Cb=/(^|[^`])`([^`]+)`(?!`)$/,Sb=/(^|[^`])`([^`]+)`(?!`)/g,Eb=Vv.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(e){let{HTMLAttributes:t}=e;return["code",Vg(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?"`".concat(t.renderChildren(e.content),"`"):"",addCommands(){return{setCode:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleCode:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetCode:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ay({find:Cb,type:this.type})]},addPasteRules(){return[wy({find:Sb,type:this.type})]}}),Db=/^```([a-z]+)?[\s\n]$/,Mb=/^~~~([a-z]+)?[\s\n]$/,Nb=xy.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...(null==(t=e.firstElementChild)?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["pre",Vg(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var n;return!1===(null==(n=e.raw)?void 0:n.startsWith("```"))&&"indented"!==e.codeBlockStyle?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var n;let o="";const r=(null==(n=e.attrs)?void 0:n.language)||"";if(e.content){o=["```".concat(r),t.renderChildren(e.content),"```"].join("\n")}else o="```".concat(r,"\n\n```");return o},addCommands(){return{setCodeBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:n}=t;return n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Tab:e=>{let{editor:t}=e;var n;if(!this.options.enableTabIndentation)return!1;const o=null!=(n=this.options.tabSize)?n:4,{state:r}=t,{selection:i}=r,{$from:s,empty:a}=i;if(s.parent.type!==this.type)return!1;const l=" ".repeat(o);return a?t.commands.insertContent(l):t.commands.command(e=>{let{tr:t}=e;const{from:n,to:o}=i,s=r.doc.textBetween(n,o,"\n","\n").split("\n").map(e=>l+e).join("\n");return t.replaceWith(n,o,r.schema.text(s)),!0})},"Shift-Tab":e=>{let{editor:t}=e;var n;if(!this.options.enableTabIndentation)return!1;const o=null!=(n=this.options.tabSize)?n:4,{state:r}=t,{selection:i}=r,{$from:s,empty:a}=i;return s.parent.type===this.type&&(a?t.commands.command(e=>{let{tr:t}=e;var n;const{pos:i}=s,a=s.start(),l=s.end(),c=r.doc.textBetween(a,l,"\n","\n").split("\n");let u=0,d=0;const h=i-a;for(let o=0;o<c.length;o+=1){if(d+c[o].length>=h){u=o;break}d+=c[o].length+1}const f=(null==(n=c[u].match(/^ */))?void 0:n[0])||"",p=Math.min(f.length,o);if(0===p)return!0;let m=a;for(let o=0;o<u;o+=1)m+=c[o].length+1;t.delete(m,m+p);return i-m<=p&&t.setSelection(Gu.create(t.doc,m)),!0}):t.commands.command(e=>{let{tr:t}=e;const{from:n,to:s}=i,a=r.doc.textBetween(n,s,"\n","\n").split("\n").map(e=>{var t;const n=(null==(t=e.match(/^ */))?void 0:t[0])||"",r=Math.min(n.length,o);return e.slice(r)}).join("\n");return t.replaceWith(n,s,r.schema.text(a)),!0}))},Enter:e=>{let{editor:t}=e;if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:o}=n,{$from:r,empty:i}=o;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,a=r.parent.textContent.endsWith("\n\n");return!(!s||!a)&&t.chain().command(e=>{let{tr:t}=e;return t.delete(r.pos-2,r.pos),!0}).exitCode().run()},ArrowDown:e=>{let{editor:t}=e;if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:o,doc:r}=n,{$from:i,empty:s}=o;if(!s||i.parent.type!==this.type)return!1;if(!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();if(void 0===a)return!1;return r.nodeAt(a)?t.commands.command(e=>{let{tr:t}=e;return t.setSelection(Ku.near(r.resolve(a))),!0}):t.commands.exitCode()}}},addInputRules(){return[ly({find:Db,type:this.type,getAttributes:e=>({language:e[1]})}),ly({find:Mb,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new hd({key:new md("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),o=t.clipboardData.getData("vscode-editor-data"),r=o?JSON.parse(o):void 0,i=null==r?void 0:r.mode;if(!n||!i)return!1;const{tr:s,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Gu.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Ab=xy.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n\n"):""}),Ob=xy.create({name:"hardBreak",markdownTokenName:"br",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(e){let{HTMLAttributes:t}=e;return["br",Vg(this.options.HTMLAttributes,t)]},renderText:()=>"\n",renderMarkdown:()=>"  \n",parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>e=>{let{commands:t,chain:n,state:o,editor:r}=e;return t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:e,storedMarks:t}=o;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:s}=r.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();return n().insertContent({type:this.name}).command(e=>{let{tr:t,dispatch:n}=e;if(n&&a&&i){const e=a.filter(e=>s.includes(e.type.name));t.ensureMarks(e)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Tb=xy.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:"h".concat(e),attrs:{level:e}}))},renderHTML(e){let{node:t,HTMLAttributes:n}=e;const o=this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0];return["h".concat(o),Vg(this.options.HTMLAttributes,n),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var n;const o=(null==(n=e.attrs)?void 0:n.level)?parseInt(e.attrs.level,10):1,r="#".repeat(o);return e.content?"".concat(r," ").concat(t.renderChildren(e.content)):""},addCommands(){return{setHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.setNode(this.name,e)},toggleHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>a(a({},e),{["Mod-Alt-".concat(t)]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ly({find:new RegExp("^(#{".concat(Math.min(...this.options.levels),",").concat(e,"})\\s$")),type:this.type,getAttributes:{level:e}}))}}),_b=xy.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{},nextNodeType:"paragraph"}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",Vg(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>e=>{let{chain:t,state:n}=e;if(!function(e,t){const{selection:n}=e,{$from:o}=n;if(n instanceof Qu){const e=o.index();return o.parent.canReplaceWith(e,e+1,t)}let r=o.depth;for(;r>=0;){const e=o.index(r);if(o.node(r).contentMatchAt(e).matchType(t))return!0;r-=1}return!1}(n,n.schema.nodes[this.name]))return!1;const{selection:o}=n,{$to:r}=o,i=t();return lv(o)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(e=>{let{state:t,tr:n,dispatch:o}=e;if(o){const{$to:e}=n.selection,o=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?n.setSelection(Gu.create(n.doc,e.pos+1)):e.nodeAfter.isBlock?n.setSelection(Qu.create(n.doc,e.pos)):n.setSelection(Gu.create(n.doc,e.pos));else{const r=t.schema.nodes[this.options.nextNodeType]||e.parent.type.contentMatch.defaultType,i=null==r?void 0:r.create();i&&(n.insert(o,i),n.setSelection(Gu.create(n.doc,o+1)))}n.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(e={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new Rv({find:e.find,handler:t=>{let{state:n,range:o,match:r}=t;const i=zg(e.getAttributes,void 0,r)||{},{tr:s}=n,a=o.from;let l=o.to;const c=e.type.create(i);if(r[1]){let e=a+r[0].lastIndexOf(r[1]);e>l?e=l:l=e+r[1].length;const t=r[0][r[0].length-1];s.insertText(t,a+r[0].length-1),s.replaceWith(e,l,c)}else if(r[0]){const t=e.type.isInline?a:a-1;s.insert(t,e.type.create(i)).delete(s.mapping.map(a),s.mapping.map(l))}s.scrollIntoView()},undoable:e.undoable}))];var e}}),jb=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Pb=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ib=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Rb=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Fb=Vv.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML(e){let{HTMLAttributes:t}=e;return["em",Vg(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleItalic:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetItalic:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"*".concat(t.renderChildren(e),"*"),addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ay({find:jb,type:this.type}),ay({find:Ib,type:this.type})]},addPasteRules(){return[wy({find:Pb,type:this.type}),wy({find:Rb,type:this.type})]}});const zb="numeric",Lb="ascii",Bb="alpha",Vb="asciinumeric",Hb="alphanumeric",$b="domain",Wb="emoji",Ub="scheme",qb="slashscheme",Kb="whitespace";function Yb(e,t){return e in t||(t[e]=[]),t[e]}function Xb(e,t,n){t[zb]&&(t[Vb]=!0,t[Hb]=!0),t[Lb]&&(t[Vb]=!0,t[Bb]=!0),t[Vb]&&(t[Hb]=!0),t[Bb]&&(t[Hb]=!0),t[Hb]&&(t[$b]=!0),t[Wb]&&(t[$b]=!0);for(const o in t){const t=Yb(o,n);t.indexOf(e)<0&&t.push(e)}}function Zb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.j={},this.jr=[],this.jd=null,this.t=e}Zb.groups={},Zb.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let o=0;o<t.jr.length;o++){const n=t.jr[o][0],r=t.jr[o][1];if(r&&n.test(e))return r}return t.jd},has(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e in this.j:!!this.go(e)},ta(e,t,n,o){for(let r=0;r<e.length;r++)this.tt(e[r],t,n,o)},tr(e,t,n,o){let r;return o=o||Zb.groups,t&&t.j?r=t:(r=new Zb(t),n&&o&&Xb(t,n,o)),this.jr.push([e,r]),r},ts(e,t,n,o){let r=this;const i=e.length;if(!i)return r;for(let s=0;s<i-1;s++)r=r.tt(e[s]);return r.tt(e[i-1],t,n,o)},tt(e,t,n,o){o=o||Zb.groups;const r=this;if(t&&t.j)return r.j[e]=t,t;const i=t;let s,a=r.go(e);if(a?(s=new Zb,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Zb,i){if(o)if(s.t&&"string"===typeof s.t){const e=Object.assign(function(e,t){const n={};for(const o in t)t[o].indexOf(e)>=0&&(n[o]=!0);return n}(s.t,o),n);Xb(i,e,o)}else n&&Xb(i,n,o);s.t=i}return r.j[e]=s,s}};const Gb=(e,t,n,o,r)=>e.ta(t,n,o,r),Jb=(e,t,n,o,r)=>e.tr(t,n,o,r),Qb=(e,t,n,o,r)=>e.ts(t,n,o,r),ex=(e,t,n,o,r)=>e.tt(t,n,o,r),tx="WORD",nx="UWORD",ox="ASCIINUMERICAL",rx="ALPHANUMERICAL",ix="LOCALHOST",sx="TLD",ax="UTLD",lx="SCHEME",cx="SLASH_SCHEME",ux="NUM",dx="WS",hx="NL",fx="OPENBRACE",px="CLOSEBRACE",mx="OPENBRACKET",gx="CLOSEBRACKET",vx="OPENPAREN",yx="CLOSEPAREN",bx="OPENANGLEBRACKET",xx="CLOSEANGLEBRACKET",wx="FULLWIDTHLEFTPAREN",kx="FULLWIDTHRIGHTPAREN",Cx="LEFTCORNERBRACKET",Sx="RIGHTCORNERBRACKET",Ex="LEFTWHITECORNERBRACKET",Dx="RIGHTWHITECORNERBRACKET",Mx="FULLWIDTHLESSTHAN",Nx="FULLWIDTHGREATERTHAN",Ax="AMPERSAND",Ox="APOSTROPHE",Tx="ASTERISK",_x="AT",jx="BACKSLASH",Px="BACKTICK",Ix="CARET",Rx="COLON",Fx="COMMA",zx="DOLLAR",Lx="DOT",Bx="EQUALS",Vx="EXCLAMATION",Hx="HYPHEN",$x="PERCENT",Wx="PIPE",Ux="PLUS",qx="POUND",Kx="QUERY",Yx="QUOTE",Xx="FULLWIDTHMIDDLEDOT",Zx="SEMI",Gx="SLASH",Jx="TILDE",Qx="UNDERSCORE",ew="EMOJI",tw="SYM";var nw=Object.freeze({__proto__:null,ALPHANUMERICAL:rx,AMPERSAND:Ax,APOSTROPHE:Ox,ASCIINUMERICAL:ox,ASTERISK:Tx,AT:_x,BACKSLASH:jx,BACKTICK:Px,CARET:Ix,CLOSEANGLEBRACKET:xx,CLOSEBRACE:px,CLOSEBRACKET:gx,CLOSEPAREN:yx,COLON:Rx,COMMA:Fx,DOLLAR:zx,DOT:Lx,EMOJI:ew,EQUALS:Bx,EXCLAMATION:Vx,FULLWIDTHGREATERTHAN:Nx,FULLWIDTHLEFTPAREN:wx,FULLWIDTHLESSTHAN:Mx,FULLWIDTHMIDDLEDOT:Xx,FULLWIDTHRIGHTPAREN:kx,HYPHEN:Hx,LEFTCORNERBRACKET:Cx,LEFTWHITECORNERBRACKET:Ex,LOCALHOST:ix,NL:hx,NUM:ux,OPENANGLEBRACKET:bx,OPENBRACE:fx,OPENBRACKET:mx,OPENPAREN:vx,PERCENT:$x,PIPE:Wx,PLUS:Ux,POUND:qx,QUERY:Kx,QUOTE:Yx,RIGHTCORNERBRACKET:Sx,RIGHTWHITECORNERBRACKET:Dx,SCHEME:lx,SEMI:Zx,SLASH:Gx,SLASH_SCHEME:cx,SYM:tw,TILDE:Jx,TLD:sx,UNDERSCORE:Qx,UTLD:ax,UWORD:nx,WORD:tx,WS:dx});const ow=/[a-z]/,rw=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/,iw=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])/,sw=/\d/,aw=/\s/;let lw=null,cw=null;function uw(e,t){const n=function(e){const t=[],n=e.length;let o=0;for(;o<n;){let r,i=e.charCodeAt(o),s=i<55296||i>56319||o+1===n||(r=e.charCodeAt(o+1))<56320||r>57343?e[o]:e.slice(o,o+2);t.push(s),o+=s.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),o=n.length,r=[];let i=0,s=0;for(;s<o;){let a=e,l=null,c=0,u=null,d=-1,h=-1;for(;s<o&&(l=a.go(n[s]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=n[s].length,h++),c+=n[s].length,i+=n[s].length,s++;i-=d,s-=h,c-=d,r.push({t:u.t,v:t.slice(i-c,i),s:i-c,e:i})}return r}function dw(e,t,n,o,r){let i;const s=t.length;for(let a=0;a<s-1;a++){const n=t[a];e.j[n]?i=e.j[n]:(i=new Zb(o),i.jr=r.slice(),e.j[n]=i),e=i}return i=new Zb(n),i.jr=r.slice(),e.j[t[s-1]]=i,i}function hw(e){const t=[],n=[];let o=0;for(;o<e.length;){let r=0;for(;"0123456789".indexOf(e[o+r])>=0;)r++;if(r>0){t.push(n.join(""));for(let t=parseInt(e.substring(o,o+r),10);t>0;t--)n.pop();o+=r}else n.push(e[o]),o++}return t}const fw={defaultProtocol:"http",events:null,format:mw,formatHref:mw,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function pw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object.assign({},fw);e&&(n=Object.assign(n,e instanceof pw?e.o:e));const o=n.ignoreTags,r=[];for(let i=0;i<o.length;i++)r.push(o[i].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=r}function mw(e){return e}pw.prototype={o:fw,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const o=null!=t;let r=this.o[e];return r?("object"===typeof r?(r=n.t in r?r[n.t]:fw[e],"function"===typeof r&&o&&(r=r(t,n))):"function"===typeof r&&o&&(r=r(t,n.t,n)),r):r},getObj(e,t,n){let o=this.o[e];return"function"===typeof o&&null!=t&&(o=o(t,n.t,n)),o},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function gw(e,t){this.t="token",this.v=e,this.tk=t}function vw(e,t){class n extends gw{constructor(t,n){super(t,n),this.t=e}}for(const o in t)n.prototype[o]=t[o];return n.t=e,n}gw.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),o=e.get("format",t,this);return n&&o.length>n?o.substring(0,n)+"\u2026":o},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fw.defaultProtocol;return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),o=e.get("formatHref",n,this),r=e.get("tagName",n,t),i=this.toFormattedString(e),s={},a=e.get("className",n,t),l=e.get("target",n,t),c=e.get("rel",n,t),u=e.getObj("attributes",n,t),d=e.getObj("events",n,t);return s.href=o,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:r,attributes:s,content:i,eventListeners:d}}};const yw=vw("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),bw=vw("text"),xw=vw("nl"),ww=vw("url",{isLink:!0,toHref(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fw.defaultProtocol;return this.hasProtocol()?this.v:"".concat(e,"://").concat(this.v)},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==ix&&e[1].t===Rx}});const kw=e=>new Zb(e);function Cw(e,t,n){const o=n[0].s,r=n[n.length-1].e;return new e(t.slice(o,r),n)}const Sw="undefined"!==typeof console&&console&&console.warn||(()=>{}),Ew="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Dw={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Mw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Dw.initialized&&Sw('linkifyjs: already initialized - will not register custom scheme "'.concat(e,'" ').concat(Ew)),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Dw.customSchemes.push([e,t])}function Nw(){Dw.scanner=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={};Zb.groups=t;const n=new Zb;null==lw&&(lw=hw("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==cw&&(cw=hw("\u03b5\u03bb1\u03c52\u0431\u04331\u0435\u043b3\u0434\u0435\u0442\u04384\u0435\u044e2\u043a\u0430\u0442\u043e\u043b\u0438\u043a6\u043e\u043c3\u043c\u043a\u04342\u043e\u043d1\u0441\u043a\u0432\u04306\u043e\u043d\u043b\u0430\u0439\u043d5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043a\u04403\u049b\u0430\u04373\u0570\u0561\u05753\u05d9\u05e9\u05e8\u05d0\u05dc5\u05e7\u05d5\u05dd3\u0627\u0628\u0648\u0638\u0628\u064a5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062f\u06464\u0628\u062d\u0631\u064a\u06465\u062c\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062f\u064a\u06296\u0639\u0644\u064a\u0627\u06465\u0645\u063a\u0631\u06285\u0645\u0627\u0631\u0627\u062a5\u06cc\u0631\u0627\u06465\u0628\u0627\u0631\u062a2\u0632\u0627\u06314\u064a\u062a\u06433\u06be\u0627\u0631\u062a5\u062a\u0648\u0646\u06334\u0633\u0648\u062f\u0627\u06463\u0631\u064a\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064a\u06466\u0642\u0637\u06313\u0643\u0627\u062b\u0648\u0644\u064a\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064a\u0633\u064a\u06275\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067e\u0627\u06a9\u0633\u062a\u0627\u06467\u0680\u0627\u0631\u062a4\u0915\u0949\u092e3\u0928\u0947\u091f3\u092d\u093e\u0930\u09240\u092e\u094d3\u094b\u09245\u0938\u0902\u0917\u0920\u09285\u09ac\u09be\u0982\u09b2\u09be5\u09ad\u09be\u09b0\u09a42\u09f0\u09a44\u0a2d\u0a3e\u0a30\u0a244\u0aad\u0abe\u0ab0\u0aa44\u0b2d\u0b3e\u0b30\u0b244\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe6\u0bb2\u0b99\u0bcd\u0b95\u0bc86\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd11\u0c2d\u0c3e\u0c30\u0c24\u0c4d5\u0cad\u0cbe\u0cb0\u0ca44\u0d2d\u0d3e\u0d30\u0d24\u0d025\u0dbd\u0d82\u0d9a\u0dcf4\u0e04\u0e2d\u0e213\u0e44\u0e17\u0e223\u0ea5\u0eb2\u0ea73\u10d2\u10d42\u307f\u3093\u306a3\u30a2\u30de\u30be\u30f34\u30af\u30e9\u30a6\u30c94\u30b0\u30fc\u30b0\u30eb4\u30b3\u30e02\u30b9\u30c8\u30a23\u30bb\u30fc\u30eb3\u30d5\u30a1\u30c3\u30b7\u30e7\u30f36\u30dd\u30a4\u30f3\u30c84\u4e16\u754c2\u4e2d\u4fe11\u56fd1\u570b1\u6587\u7f513\u4e9a\u9a6c\u900a3\u4f01\u4e1a2\u4f5b\u5c712\u4fe1\u606f2\u5065\u5eb72\u516b\u53662\u516c\u53f81\u76ca2\u53f0\u6e7e1\u70632\u5546\u57ce1\u5e971\u68072\u5609\u91cc0\u5927\u9152\u5e975\u5728\u7ebf2\u5927\u62ff2\u5929\u4e3b\u65593\u5a31\u4e502\u5bb6\u96fb2\u5e7f\u4e1c2\u5fae\u535a2\u6148\u55842\u6211\u7231\u4f603\u624b\u673a2\u62db\u80582\u653f\u52a11\u5e9c2\u65b0\u52a0\u57612\u95fb2\u65f6\u5c1a2\u66f8\u7c4d2\u673a\u67842\u6de1\u9a6c\u95213\u6e38\u620f2\u6fb3\u95802\u70b9\u770b2\u79fb\u52a82\u7ec4\u7ec7\u673a\u67844\u7f51\u57401\u5e971\u7ad91\u7edc2\u8054\u901a2\u8c37\u6b4c2\u8d2d\u72692\u901a\u8ca92\u96c6\u56e22\u96fb\u8a0a\u76c8\u79d14\u98de\u5229\u6d663\u98df\u54c12\u9910\u53852\u9999\u683c\u91cc\u62c93\u6e2f2\ub2f7\ub1371\ucef42\uc0bc\uc1312\ud55c\uad6d2")),ex(n,"'",Ox),ex(n,"{",fx),ex(n,"}",px),ex(n,"[",mx),ex(n,"]",gx),ex(n,"(",vx),ex(n,")",yx),ex(n,"<",bx),ex(n,">",xx),ex(n,"\uff08",wx),ex(n,"\uff09",kx),ex(n,"\u300c",Cx),ex(n,"\u300d",Sx),ex(n,"\u300e",Ex),ex(n,"\u300f",Dx),ex(n,"\uff1c",Mx),ex(n,"\uff1e",Nx),ex(n,"&",Ax),ex(n,"*",Tx),ex(n,"@",_x),ex(n,"`",Px),ex(n,"^",Ix),ex(n,":",Rx),ex(n,",",Fx),ex(n,"$",zx),ex(n,".",Lx),ex(n,"=",Bx),ex(n,"!",Vx),ex(n,"-",Hx),ex(n,"%",$x),ex(n,"|",Wx),ex(n,"+",Ux),ex(n,"#",qx),ex(n,"?",Kx),ex(n,'"',Yx),ex(n,"/",Gx),ex(n,";",Zx),ex(n,"~",Jx),ex(n,"_",Qx),ex(n,"\\",jx),ex(n,"\u30fb",Xx);const o=Jb(n,sw,ux,{[zb]:!0});Jb(o,sw,o);const r=Jb(o,ow,ox,{[Vb]:!0}),i=Jb(o,rw,rx,{[Hb]:!0}),s=Jb(n,ow,tx,{[Lb]:!0});Jb(s,sw,r),Jb(s,ow,s),Jb(r,sw,r),Jb(r,ow,r);const a=Jb(n,rw,nx,{[Bb]:!0});Jb(a,ow),Jb(a,sw,i),Jb(a,rw,a),Jb(i,sw,i),Jb(i,ow),Jb(i,rw,i);const l=ex(n,"\n",hx,{[Kb]:!0}),c=ex(n,"\r",dx,{[Kb]:!0}),u=Jb(n,aw,dx,{[Kb]:!0});ex(n,"\ufffc",u),ex(c,"\n",l),ex(c,"\ufffc",u),Jb(c,aw,u),ex(u,"\r"),ex(u,"\n"),Jb(u,aw,u),ex(u,"\ufffc",u);const d=Jb(n,iw,ew,{[Wb]:!0});ex(d,"#"),Jb(d,iw,d),ex(d,"\ufe0f",d);const h=ex(d,"\u200d");ex(h,"#"),Jb(h,iw,d);const f=[[ow,s],[sw,r]],p=[[ow,null],[rw,a],[sw,i]];for(let m=0;m<lw.length;m++)dw(n,lw[m],sx,tx,f);for(let m=0;m<cw.length;m++)dw(n,cw[m],ax,nx,p);Xb(sx,{tld:!0,ascii:!0},t),Xb(ax,{utld:!0,alpha:!0},t),dw(n,"file",lx,tx,f),dw(n,"mailto",lx,tx,f),dw(n,"http",cx,tx,f),dw(n,"https",cx,tx,f),dw(n,"ftp",cx,tx,f),dw(n,"ftps",cx,tx,f),Xb(lx,{scheme:!0,ascii:!0},t),Xb(cx,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let m=0;m<e.length;m++){const t=e[m][0],o=e[m][1]?{[Ub]:!0}:{[qb]:!0};t.indexOf("-")>=0?o[$b]=!0:ow.test(t)?sw.test(t)?o[Vb]=!0:o[Lb]=!0:o[zb]=!0,Qb(n,t,t,o)}return Qb(n,"localhost",ix,{ascii:!0}),n.jd=new Zb(tw),{start:n,tokens:Object.assign({groups:t},nw)}}(Dw.customSchemes);for(let e=0;e<Dw.tokenQueue.length;e++)Dw.tokenQueue[e][1]({scanner:Dw.scanner});Dw.parser=function(e){let{groups:t}=e;const n=t.domain.concat([Ax,Tx,_x,jx,Px,Ix,zx,Bx,Hx,ux,$x,Wx,Ux,qx,Gx,tw,Jx,Qx]),o=[Ox,Rx,Fx,Lx,Vx,$x,Kx,Yx,Zx,bx,xx,fx,px,gx,mx,vx,yx,wx,kx,Cx,Sx,Ex,Dx,Mx,Nx],r=[Ax,Ox,Tx,jx,Px,Ix,zx,Bx,Hx,fx,px,$x,Wx,Ux,qx,Kx,Gx,tw,Jx,Qx],i=kw(),s=ex(i,Jx);Gb(s,r,s),Gb(s,t.domain,s);const a=kw(),l=kw(),c=kw();Gb(i,t.domain,a),Gb(i,t.scheme,l),Gb(i,t.slashscheme,c),Gb(a,r,s),Gb(a,t.domain,a);const u=ex(a,_x);ex(s,_x,u),ex(l,_x,u),ex(c,_x,u);const d=ex(s,Lx);Gb(d,r,s),Gb(d,t.domain,s);const h=kw();Gb(u,t.domain,h),Gb(h,t.domain,h);const f=ex(h,Lx);Gb(f,t.domain,h);const p=kw(yw);Gb(f,t.tld,p),Gb(f,t.utld,p),ex(u,ix,p);const m=ex(h,Hx);ex(m,Hx,m),Gb(m,t.domain,h),Gb(p,t.domain,h),ex(p,Lx,f),ex(p,Hx,m);const g=ex(p,Rx);Gb(g,t.numeric,yw);const v=ex(a,Hx),y=ex(a,Lx);ex(v,Hx,v),Gb(v,t.domain,a),Gb(y,r,s),Gb(y,t.domain,a);const b=kw(ww);Gb(y,t.tld,b),Gb(y,t.utld,b),Gb(b,t.domain,a),Gb(b,r,s),ex(b,Lx,y),ex(b,Hx,v),ex(b,_x,u);const x=ex(b,Rx),w=kw(ww);Gb(x,t.numeric,w);const k=kw(ww),C=kw();Gb(k,n,k),Gb(k,o,C),Gb(C,n,k),Gb(C,o,C),ex(b,Gx,k),ex(w,Gx,k);const S=ex(l,Rx),E=ex(c,Rx),D=ex(E,Gx),M=ex(D,Gx);Gb(l,t.domain,a),ex(l,Lx,y),ex(l,Hx,v),Gb(c,t.domain,a),ex(c,Lx,y),ex(c,Hx,v),Gb(S,t.domain,k),ex(S,Gx,k),ex(S,Kx,k),Gb(M,t.domain,k),Gb(M,n,k),ex(M,Gx,k);const N=[[fx,px],[mx,gx],[vx,yx],[bx,xx],[wx,kx],[Cx,Sx],[Ex,Dx],[Mx,Nx]];for(let A=0;A<N.length;A++){const[e,t]=N[A],r=ex(k,e);ex(C,e,r),ex(r,t,k);const i=kw(ww);Gb(r,n,i);const s=kw();Gb(r,o),Gb(i,n,i),Gb(i,o,s),Gb(s,n,i),Gb(s,o,s),ex(i,t,k),ex(s,t,k)}return ex(i,ix,b),ex(i,hx,xw),{start:i,tokens:nw}}(Dw.scanner.tokens);for(let e=0;e<Dw.pluginQueue.length;e++)Dw.pluginQueue[e][1]({scanner:Dw.scanner,parser:Dw.parser});return Dw.initialized=!0,Dw}function Aw(e){return Dw.initialized||Nw(),function(e,t,n){let o=n.length,r=0,i=[],s=[];for(;r<o;){let a=e,l=null,c=null,u=0,d=null,h=-1;for(;r<o&&!(l=a.go(n[r].t));)s.push(n[r++]);for(;r<o&&(c=l||a.go(n[r].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,r++,u++;if(h<0)r-=u,r<o&&(s.push(n[r]),r++);else{s.length>0&&(i.push(Cw(bw,t,s)),s=[]),r-=h,u-=h;const e=d.t,o=n.slice(r-u,r);i.push(Cw(e,t,o))}}return s.length>0&&i.push(Cw(bw,t,s)),i}(Dw.parser.start,e,uw(Dw.scanner.start,e))}function Ow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t&&"object"===typeof t){if(n)throw Error("linkifyjs: Invalid link type ".concat(t,"; must be a string"));n=t,t=null}const o=new pw(n),r=Aw(e),i=[];for(let s=0;s<r.length;s++){const e=r[s];!e.isLink||t&&e.t!==t||!o.check(e)||i.push(e.toFormattedObject(o))}return i}Aw.scan=uw;var Tw="[\0- \xa0\u1680\u180e\u2000-\u2029\u205f\u3000]",_w=new RegExp(Tw),jw=new RegExp("".concat(Tw,"$")),Pw=new RegExp(Tw,"g");function Iw(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{const t="string"===typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(Pw,"").match(new RegExp("^(?:(?:".concat(n.join("|"),"):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))"),"i"))}var Rw=Vv.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{"string"!==typeof e?Mw(e.scheme,e.optionalSlashes):Mw(e)})},onDestroy(){Zb.groups={},Dw.scanner=null,Dw.parser=null,Dw.tokenQueue=[],Dw.pluginQueue=[],Dw.customSchemes=[],Dw.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!Iw(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!Iw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML(e){let{HTMLAttributes:t}=e;return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Iw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Vg(this.options.HTMLAttributes,t),0]:["a",Vg(this.options.HTMLAttributes,a(a({},t),{},{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n;const o=(null==(n=e.attrs)?void 0:n.href)||"",r=t.renderChildren(e);return"[".concat(r,"](").concat(o,")")},addCommands(){return{setLink:e=>t=>{let{chain:n}=t;const{href:o}=e;return!!this.options.isAllowedUri(o,{defaultValidate:e=>!!Iw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&n().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>t=>{let{chain:n}=t;const{href:o}=e||{};return!(o&&!this.options.isAllowedUri(o,{defaultValidate:e=>!!Iw(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&n().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>e=>{let{chain:t}=e;return t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}},addPasteRules(){return[wy({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:o}=this.options,r=Ow(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!Iw(e,n),protocols:n,defaultProtocol:o}));r.length&&r.forEach(e=>{this.options.shouldAutoLink(e.value)&&t.push({text:e.value,data:{href:e.href},index:e.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:null==(t=e.data)?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(function(e){return new hd({key:new md("autolink"),appendTransaction:(t,n,o)=>{const r=t.some(e=>e.docChanged)&&!n.doc.eq(o.doc),i=t.some(e=>e.getMeta("preventAutolink"));if(!r||i)return;const{tr:s}=o;return ev(_g(n.doc,[...t])).forEach(t=>{let{newRange:n}=t;const r=function(e,t,n){const o=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&o.push({node:e,pos:t})}),o}(o.doc,n,e=>e.isTextblock);let i,l;if(r.length>1)i=r[0],l=o.doc.textBetween(i.pos,i.pos+i.node.nodeSize,void 0," ");else if(r.length){const e=o.doc.textBetween(n.from,n.to," "," ");if(!jw.test(e))return;i=r[0],l=o.doc.textBetween(i.pos,n.to,void 0," ")}if(i&&l){const t=l.split(_w).filter(Boolean);if(t.length<=0)return!1;const n=t[t.length-1],r=i.pos+l.lastIndexOf(n);if(!n)return!1;const u=Aw(n).map(t=>t.toObject(e.defaultProtocol));if(!(1===(c=u).length?c[0].isLink:3===c.length&&c[1].isLink&&["()","[]"].includes(c[0].value+c[2].value)))return!1;u.filter(e=>e.isLink).map(e=>a(a({},e),{},{from:r+e.start+1,to:r+e.end+1})).filter(e=>!o.schema.marks.code||!o.doc.rangeHasMark(e.from,e.to,o.schema.marks.code)).filter(t=>e.validate(t.value)).filter(t=>e.shouldAutoLink(t.value)).forEach(t=>{tv(t.from,t.to,o.doc).some(t=>t.mark.type===e.type)||s.addMark(t.from,t.to,e.type.create({href:t.href}))})}var c}),s.steps.length?s:void 0}})}({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!Iw(e,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),!0===this.options.openOnClick&&e.push(function(e){return new hd({key:new md("handleClickLink"),props:{handleClick:(t,n,o)=>{var r,i;if(0!==o.button)return!1;if(!t.editable)return!1;let s=null;if(o.target instanceof HTMLAnchorElement)s=o.target;else{let e=o.target;const t=[];for(;"DIV"!==e.nodeName;)t.push(e),e=e.parentNode;s=t.find(e=>"A"===e.nodeName)}if(!s)return!1;const a=Jg(t.state,e.type.name),l=null!=(r=null==s?void 0:s.href)?r:a.href,c=null!=(i=null==s?void 0:s.target)?i:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),!(!s||!l)&&(window.open(l,c),!0)}}})}({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(function(e){return new hd({key:new md("handlePasteLink"),props:{handlePaste:(t,n,o)=>{const{shouldAutoLink:r}=e,{state:i}=t,{selection:s}=i,{empty:a}=s;if(a)return!1;let l="";o.content.forEach(e=>{l+=e.textContent});const c=Ow(l,{defaultProtocol:e.defaultProtocol}).find(e=>e.isLink&&e.value===l);return!(!l||!c||void 0!==r&&!r(c.href))&&e.editor.commands.setMark(e.type,{href:c.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),Fw=Rw;const zw=["start"];var Lw=Object.defineProperty,Bw="textStyle",Vw=/^\s*([-+*])\s$/,Hw=xy.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},parseHTML:()=>[{tag:"ul"}],renderHTML(e){let{HTMLAttributes:t}=e;return["ul",Vg(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>"list"!==e.type||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Bw)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=cy({find:Vw,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=cy({find:Vw,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Bw),editor:this.editor})),[e]}}),$w=xy.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(e){let{HTMLAttributes:t}=e;return["li",Vg(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if("list_item"!==e.type)return[];let n=[];if(e.tokens&&e.tokens.length>0){if(e.tokens.some(e=>"paragraph"===e.type))n=t.parseChildren(e.tokens);else{const o=e.tokens[0];if(o&&"text"===o.type&&o.tokens&&o.tokens.length>0){if(n=[{type:"paragraph",content:t.parseInline(o.tokens)}],e.tokens.length>1){const o=e.tokens.slice(1),r=t.parseChildren(o);n.push(...r)}}else n=t.parseChildren(e.tokens)}}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(e,t,n)=>yy(e,t,e=>"bulletList"===e.parentType?"- ":"orderedList"===e.parentType?"".concat(e.index+1,". "):"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});((e,t)=>{for(var n in t)Lw(e,n,{get:t[n],enumerable:!0})})({},{findListItemPos:()=>Ww,getNextListDepth:()=>Uw,handleBackspace:()=>Xw,handleDelete:()=>Jw,hasListBefore:()=>qw,hasListItemAfter:()=>Qw,hasListItemBefore:()=>Kw,listItemHasSubList:()=>Yw,nextListIsDeeper:()=>Zw,nextListIsHigher:()=>Gw});var Ww=(e,t)=>{const{$from:n}=t.selection,o=_m(e,t.schema);let r=null,i=n.depth,s=n.pos,a=null;for(;i>0&&null===a;)r=n.node(i),r.type===o?a=i:(i-=1,s-=1);return null===a?null:{$pos:t.doc.resolve(s),depth:a}},Uw=(e,t)=>{const n=Ww(e,t);if(!n)return!1;const[,o]=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;const r=e.doc.resolve(n);let i=o,s=null;for(;i>0&&null===s;){const e=r.node(i);(null==e?void 0:e.type.name)===t?s=e:i-=1}return[s,i]}(t,e,n.$pos.pos+4);return o},qw=(e,t,n)=>{const{$anchor:o}=e.selection,r=Math.max(0,o.pos-2),i=e.doc.resolve(r).node();return!(!i||!n.includes(i.type.name))},Kw=(e,t)=>{var n;const{$anchor:o}=t.selection,r=t.doc.resolve(o.pos-2);return 0!==r.index()&&(null==(n=r.nodeBefore)?void 0:n.type.name)===e},Yw=(e,t,n)=>{if(!n)return!1;const o=_m(e,t.schema);let r=!1;return n.descendants(e=>{e.type===o&&(r=!0)}),r},Xw=(e,t,n)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!pg(e.state,t)&&qw(e.state,t,n)){const{$anchor:n}=e.state.selection,o=e.state.doc.resolve(n.before()-1),r=[];o.node().descendants((e,n)=>{e.type.name===t&&r.push({node:e,pos:n})});const i=r.at(-1);if(!i)return!1;const s=e.state.doc.resolve(o.start()+i.pos+1);return e.chain().cut({from:n.start()-1,to:n.end()+1},s.end()).joinForward().run()}if(!pg(e.state,t))return!1;if(!(e=>{const{$from:t,$to:n}=e.selection;return!(t.parentOffset>0||t.pos!==n.pos)})(e.state))return!1;const o=Ww(t,e.state);if(!o)return!1;const r=e.state.doc.resolve(o.$pos.pos-2).node(o.depth),i=Yw(t,e.state,r);return Kw(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},Zw=(e,t)=>{const n=Uw(e,t),o=Ww(e,t);return!(!o||!n)&&n>o.depth},Gw=(e,t)=>{const n=Uw(e,t),o=Ww(e,t);return!(!o||!n)&&n<o.depth},Jw=(e,t)=>{if(!pg(e.state,t))return!1;if(!((e,t)=>{const{$from:n,$to:o,$anchor:r}=e.selection;if(t){const n=jg(e=>e.type.name===t)(e.selection);if(!n)return!1;const o=e.doc.resolve(n.pos+1);return r.pos+1===o.end()}return!(o.parentOffset<o.parent.nodeSize-2||n.pos!==o.pos)})(e.state,t))return!1;const{selection:n}=e.state,{$from:o,$to:r}=n;return!(!n.empty&&o.sameParent(r))&&(Zw(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Gw(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward())},Qw=(e,t)=>{var n;const{$anchor:o}=t.selection,r=t.doc.resolve(o.pos-o.parentOffset-2);return r.index()!==r.parent.childCount-1&&(null==(n=r.nodeAfter)?void 0:n.type.name)===e},ek=Kv.create({name:"listKeymap",addOptions:()=>({listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}),addKeyboardShortcuts(){return{Delete:e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:o}=e;void 0!==t.state.schema.nodes[o]&&Jw(t,o)&&(n=!0)}),n},"Mod-Delete":e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:o}=e;void 0!==t.state.schema.nodes[o]&&Jw(t,o)&&(n=!0)}),n},Backspace:e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:o,wrapperNames:r}=e;void 0!==t.state.schema.nodes[o]&&Xw(t,o,r)&&(n=!0)}),n},"Mod-Backspace":e=>{let{editor:t}=e,n=!1;return this.options.listTypes.forEach(e=>{let{itemName:o,wrapperNames:r}=e;void 0!==t.state.schema.nodes[o]&&Xw(t,o,r)&&(n=!0)}),n}}}}),tk=/^(\s*)(\d+)\.\s+(.*)$/,nk=/^\s/;function ok(e,t,n){var o;const r=[];let i=0;for(;i<e.length;){const s=e[i];if(s.indent===t){const a=s.content.split("\n"),l=(null==(o=a[0])?void 0:o.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const u=a.slice(1).join("\n").trim();if(u){const e=n.blockTokens(u);c.push(...e)}let d=i+1;const h=[];for(;d<e.length&&e[d].indent>t;)h.push(e[d]),d+=1;if(h.length>0){const e=Math.min(...h.map(e=>e.indent)),t=ok(h,e,n);c.push({type:"list",ordered:!0,start:h[0].number,items:t,raw:h.map(e=>e.raw).join("\n")})}r.push({type:"list_item",raw:s.raw,tokens:c}),i=d}else i+=1}return r}var rk="textStyle",ik=/^(\d+)\.\s$/,sk=xy.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(e){let{HTMLAttributes:t}=e;const{start:n}=t,o=l(t,zw);return 1===n?["ol",Vg(this.options.HTMLAttributes,o),0]:["ol",Vg(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if("list"!==e.type||!e.ordered)return[];const n=e.start||1,o=e.items?function(e,t){return e.map(e=>{if("list_item"!==e.type)return t.parseChildren([e])[0];const n=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(e=>{if("paragraph"===e.type||"list"===e.type||"blockquote"===e.type||"code"===e.type)n.push(...t.parseChildren([e]));else if("text"===e.type&&e.tokens){const o=t.parseChildren([e]);n.push({type:"paragraph",content:o})}else{const o=t.parseChildren([e]);o.length>0&&n.push(...o)}}),{type:"listItem",content:n}})}(e.items,t):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:o}:{type:"orderedList",content:o}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),n=null==t?void 0:t.index;return void 0!==n?n:-1},tokenize:(e,t,n)=>{var o;const r=e.split("\n"),[i,s]=function(e){const t=[];let n=0,o=0;for(;n<e.length;){const r=e[n],i=r.match(tk);if(!i)break;const[,s,a,l]=i,c=s.length;let u=l,d=n+1;const h=[r];for(;d<e.length;){const t=e[d];if(t.match(tk))break;if(""===t.trim())h.push(t),u+="\n",d+=1;else{if(!t.match(nk))break;h.push(t),u+="\n".concat(t.slice(c+2)),d+=1}}t.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:h.join("\n")}),o=d,n=d}return[t,o]}(r);if(0===i.length)return;const a=ok(i,0,n);if(0===a.length)return;return{type:"list",ordered:!0,start:(null==(o=i[0])?void 0:o.number)||1,items:a,raw:r.slice(0,s).join("\n")}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(rk)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=cy({find:ik,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=cy({find:ik,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>a({start:+e[1]},this.editor.getAttributes(rk)),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),ak=/^\s*(\[([( |x])?\])\s$/,lk=xy.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return""===t||"true"===t},renderHTML:e=>({"data-checked":e.checked})}}),parseHTML(){return[{tag:'li[data-type="'.concat(this.name,'"]'),priority:51}]},renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["li",Vg(this.options.HTMLAttributes,n,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const n=[];if(e.tokens&&e.tokens.length>0?n.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?n.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):n.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const o=t.parseChildren(e.nestedTokens);n.push(...o)}return t.createNode("taskItem",{checked:e.checked||!1},n)},renderMarkdown:(e,t)=>{var n;const o=(null==(n=e.attrs)?void 0:n.checked)?"x":" ";return yy(e,t,"- [".concat(o,"] "))},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?a(a({},e),{},{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return e=>{let{node:t,HTMLAttributes:n,getPos:o,editor:r}=e;const i=document.createElement("li"),s=document.createElement("label"),l=document.createElement("span"),c=document.createElement("input"),u=document.createElement("div"),d=e=>{var t,n;c.ariaLabel=(null==(n=null==(t=this.options.a11y)?void 0:t.checkboxLabel)?void 0:n.call(t,e,c.checked))||"Task item checkbox for ".concat(e.textContent||"empty task item")};return d(t),s.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",e=>e.preventDefault()),c.addEventListener("change",e=>{if(!r.isEditable&&!this.options.onReadOnlyChecked)return void(c.checked=!c.checked);const{checked:n}=e.target;r.isEditable&&"function"===typeof o&&r.chain().focus(void 0,{scrollIntoView:!1}).command(e=>{let{tr:t}=e;const r=o();if("number"!==typeof r)return!1;const i=t.doc.nodeAt(r);return t.setNodeMarkup(r,void 0,a(a({},null==i?void 0:i.attrs),{},{checked:n})),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,n)||(c.checked=!c.checked))}),Object.entries(this.options.HTMLAttributes).forEach(e=>{let[t,n]=e;i.setAttribute(t,n)}),i.dataset.checked=t.attrs.checked,c.checked=t.attrs.checked,s.append(c,l),i.append(s,u),Object.entries(n).forEach(e=>{let[t,n]=e;i.setAttribute(t,n)}),{dom:i,contentDOM:u,update:e=>e.type===this.type&&(i.dataset.checked=e.attrs.checked,c.checked=e.attrs.checked,d(e),!0)}}},addInputRules(){return[cy({find:ak,type:this.type,getAttributes:e=>({checked:"x"===e[e.length-1]})})]}}),ck=xy.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return"".concat(this.options.itemTypeName,"+")},parseHTML(){return[{tag:'ul[data-type="'.concat(this.name,'"]'),priority:51}]},renderHTML(e){let{HTMLAttributes:t}=e;return["ul",Vg(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,"\n"):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const n=null==(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:t.index;return void 0!==n?n:-1},tokenize(e,t,n){const o=e=>{const t=vy(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:o},n);return t?[{type:"taskList",raw:t.raw,items:t.items}]:n.blockTokens(e)},r=vy(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:e=>({indentLevel:e[1].length,mainContent:e[4],checked:"x"===e[3].toLowerCase()}),createToken:(e,t)=>({type:"taskItem",raw:"",mainContent:e.mainContent,indentLevel:e.indentLevel,checked:e.checked,text:e.mainContent,tokens:n.inlineTokens(e.mainContent),nestedTokens:t}),customNestedParser:o},n);if(r)return{type:"taskList",raw:r.raw,items:r.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>e=>{let{commands:t}=e;return t.toggleList(this.name,this.options.itemTypeName)}}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),uk=(Kv.create({name:"listKit",addExtensions(){const e=[];return!1!==this.options.bulletList&&e.push(Hw.configure(this.options.bulletList)),!1!==this.options.listItem&&e.push($w.configure(this.options.listItem)),!1!==this.options.listKeymap&&e.push(ek.configure(this.options.listKeymap)),!1!==this.options.orderedList&&e.push(sk.configure(this.options.orderedList)),!1!==this.options.taskItem&&e.push(lk.configure(this.options.taskItem)),!1!==this.options.taskList&&e.push(ck.configure(this.options.taskList)),e}}),xy.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(e){let{HTMLAttributes:t}=e;return["p",Vg(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>{const n=e.tokens||[];return 1===n.length&&"image"===n[0].type?t.parseChildren([n[0]]):t.createNode("paragraph",void 0,t.parseInline(n))},renderMarkdown:(e,t)=>e&&Array.isArray(e.content)?t.renderChildren(e.content):"",addCommands(){return{setParagraph:()=>e=>{let{commands:t}=e;return t.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}})),dk=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,hk=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,fk=Vv.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["s",Vg(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>"~~".concat(t.renderChildren(e),"~~"),addCommands(){return{setStrike:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleStrike:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetStrike:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ay({find:dk,type:this.type})]},addPasteRules(){return[wy({find:hk,type:this.type})]}}),pk=xy.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),mk=Vv.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["u",Vg(this.options.HTMLAttributes,t),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown:(e,t)=>"++".concat(t.renderChildren(e),"++"),markdownTokenizer:{name:"underline",level:"inline",start:e=>e.indexOf("++"),tokenize(e,t,n){const o=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!o)return;const r=o[2].trim();return{type:"underline",raw:o[0],text:r,tokens:n.inlineTokens(r)}}},addCommands(){return{setUnderline:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleUnderline:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetUnderline:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),gk=mk;function vk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new hd({view:t=>new yk(t,e)})}class yk{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(e=>{let{name:t,handler:n}=e;return this.editorView.dom.removeEventListener(t,n)})}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,o=this.editorView.dom,r=o.getBoundingClientRect(),i=r.width/o.offsetWidth,s=r.height/o.offsetHeight;if(n){let n=t.nodeBefore,o=t.nodeAfter;if(n||o){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let r=t.getBoundingClientRect(),i=n?r.bottom:r.top;n&&o&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*s;e={left:r.left,right:r.right,top:i-a,bottom:i+a}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*i;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;a=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-a)/i+"px",this.element.style.top=(e.top-l)/s+"px",this.element.style.width=(e.right-e.left)/i+"px",this.element.style.height=(e.bottom-e.top)/s+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),o=n&&n.type.spec.disableDropCursor,r="function"==typeof o?o(this.editorView,t,e):o;if(t&&!r){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=Ou(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class bk extends Ku{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return bk.valid(n)?new bk(n):Ku.near(n)}content(){return tc.empty}eq(e){return e instanceof bk&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new bk(e.resolve(t.pos))}getBookmark(){return new xk(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),o=e.node(t);if(0!=n)for(let e=o.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||wk(e.type))return!0;if(e.inlineContent)return!1}else if(o.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),o=e.node(t);if(n!=o.childCount)for(let e=o.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||wk(e.type))return!0;if(e.inlineContent)return!1}else if(o.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let o=t.contentMatchAt(e.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!n&&bk.valid(e))return e;let o=e.pos,r=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){r=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;o+=t;let s=e.doc.resolve(o);if(bk.valid(s))return s}for(;;){let i=t>0?r.firstChild:r.lastChild;if(!i){if(r.isAtom&&!r.isText&&!Qu.isSelectable(r)){e=e.doc.resolve(o+r.nodeSize*t),n=!1;continue e}break}r=i,o+=t;let s=e.doc.resolve(o);if(bk.valid(s))return s}return null}}}bk.prototype.visible=!1,bk.findFrom=bk.findGapCursorFrom,Ku.jsonID("gapcursor",bk);class xk{constructor(e){this.pos=e}map(e){return new xk(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return bk.valid(t)?new bk(t):Ku.near(t)}}function wk(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}const kk=bm({ArrowLeft:Ck("horiz",-1),ArrowRight:Ck("horiz",1),ArrowUp:Ck("vert",-1),ArrowDown:Ck("vert",1)});function Ck(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,o,r){let i=e.selection,s=t>0?i.$to:i.$from,a=i.empty;if(i instanceof Gu){if(!r.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=bk.findGapCursorFrom(s,t,a);return!!l&&(o&&o(e.tr.setSelection(new bk(l))),!0)}}function Sk(e,t,n){if(!e||!e.editable)return!1;let o=e.state.doc.resolve(t);if(!bk.valid(o))return!1;let r=e.posAtCoords({left:n.clientX,top:n.clientY});return!(r&&r.inside>-1&&Qu.isSelectable(e.state.doc.nodeAt(r.inside)))&&(e.dispatch(e.state.tr.setSelection(new bk(o))),!0)}function Ek(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof bk))return!1;let{$from:n}=e.state.selection,o=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!o)return!1;let r=Xl.empty;for(let s=o.length-1;s>=0;s--)r=Xl.from(o[s].createAndFill(null,r));let i=e.state.tr.replace(n.pos,n.pos,new tc(r,0,0));return i.setSelection(Gu.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function Dk(e){if(!(e.selection instanceof bk))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",_p.create(e.doc,[Ap.widget(e.selection.head,t,{key:"gapcursor"})])}var Mk=200,Nk=function(){};Nk.prototype.append=function(e){return e.length?(e=Nk.from(e),!this.length&&e||e.length<Mk&&this.leafAppend(e)||this.length<Mk&&e.leafPrepend(this)||this.appendInner(e)):this},Nk.prototype.prepend=function(e){return e.length?Nk.from(e).append(this):this},Nk.prototype.appendInner=function(e){return new Ok(this,e)},Nk.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Nk.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Nk.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Nk.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},Nk.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var o=[];return this.forEach(function(t,n){return o.push(e(t,n))},t,n),o},Nk.from=function(e){return e instanceof Nk?e:e&&e.length?new Ak(e):Nk.empty};var Ak=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,o){for(var r=t;r<n;r++)if(!1===e(this.values[r],o+r))return!1},t.prototype.forEachInvertedInner=function(e,t,n,o){for(var r=t-1;r>=n;r--)if(!1===e(this.values[r],o+r))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=Mk)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=Mk)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Nk);Nk.empty=new Ak([]);var Ok=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,o){var r=this.left.length;return!(t<r&&!1===this.left.forEachInner(e,t,Math.min(n,r),o))&&(!(n>r&&!1===this.right.forEachInner(e,Math.max(t-r,0),Math.min(this.length,n)-r,o+r))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,o){var r=this.left.length;return!(t>r&&!1===this.right.forEachInvertedInner(e,t-r,Math.max(n,r)-r,o+r))&&(!(n<r&&!1===this.left.forEachInvertedInner(e,Math.min(t,r),n,o))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Nk);const Tk=Nk;class _k{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,o,r=this.items.length;for(;;r--){if(this.items.get(r-1).selection){--r;break}}t&&(n=this.remapping(r,this.items.length),o=n.maps.length);let i,s,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(r,t+1),o=n.maps.length),o--,void c.push(e);if(n){c.push(new jk(e.map));let t,r=e.step.map(n.slice(o));r&&a.maybeStep(r).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new jk(t,void 0,void 0,l.length+c.length))),o--,t&&n.appendMap(t,o)}else a.maybeStep(e.step);return e.selection?(i=n?e.selection.map(n.slice(o)):e.selection,s=new _k(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(e,t,n,o){let r=[],i=this.eventCount,s=this.items,a=!o&&s.length?s.get(s.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new jk(e.mapping.maps[c],l,t);(n=a&&a.merge(u))&&(u=n,c?r.pop():s=s.slice(0,s.length-1)),r.push(u),t&&(i++,t=void 0),o||(a=u)}let l=i-n.depth;return l>Ik&&(s=function(e,t){let n;return e.forEach((e,o)=>{if(e.selection&&0==t--)return n=o,!1}),e.slice(n)}(s,l),i-=l),new _k(s.append(r),i)}remapping(e,t){let n=new au;return this.items.forEach((t,o)=>{let r=null!=t.mirrorOffset&&o-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,r)},e,t),n}addMaps(e){return 0==this.eventCount?this:new _k(this.items.append(e.map(e=>new jk(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],o=Math.max(0,this.items.length-t),r=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},o);let a=t;this.items.forEach(t=>{let o=r.getMirror(--a);if(null==o)return;i=Math.min(i,o);let l=r.maps[o];if(t.step){let i=e.steps[o].invert(e.docs[o]),c=t.selection&&t.selection.map(r.slice(a+1,o));c&&s++,n.push(new jk(l,i,c))}else n.push(new jk(l))},o);let l=[];for(let d=t;d<i;d++)l.push(new jk(r.maps[d]));let c=this.items.slice(0,o).append(l).append(n),u=new _k(c,s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.remapping(0,e),n=t.maps.length,o=[],r=0;return this.items.forEach((i,s)=>{if(s>=e)o.push(i),i.selection&&r++;else if(i.step){let e=i.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=i.selection&&i.selection.map(t.slice(n));a&&r++;let l,c=new jk(s.invert(),e,a),u=o.length-1;(l=o.length&&o[u].merge(c))?o[u]=l:o.push(c)}}else i.map&&n--},this.items.length,0),new _k(Tk.from(o.reverse()),r)}}_k.empty=new _k(Tk.empty,0);class jk{constructor(e,t,n,o){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new jk(t.getMap().invert(),t,this.selection)}}}class Pk{constructor(e,t,n,o,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=o,this.prevComposition=r}}const Ik=20;function Rk(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,o,r)=>t.push(o,r));return t}function Fk(e,t){if(!e)return null;let n=[];for(let o=0;o<e.length;o+=2){let r=t.map(e[o],1),i=t.map(e[o+1],-1);r<=i&&n.push(r,i)}return n}let zk=!1,Lk=null;function Bk(e){let t=e.plugins;if(Lk!=t){zk=!1,Lk=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){zk=!0;break}}return zk}const Vk=new md("history"),Hk=new md("closeHistory");function $k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new hd({key:Vk,state:{init:()=>new Pk(_k.empty,_k.empty,null,0,-1),apply:(t,n,o)=>function(e,t,n,o){let r,i=n.getMeta(Vk);if(i)return i.historyState;n.getMeta(Hk)&&(e=new Pk(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(Vk))return s.getMeta(Vk).redo?new Pk(e.done.addTransform(n,void 0,o,Bk(t)),e.undone,Rk(n.mapping.maps),e.prevTime,e.prevComposition):new Pk(e.done,e.undone.addTransform(n,void 0,o,Bk(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(r=n.getMeta("rebased"))?new Pk(e.done.rebased(n,r),e.undone.rebased(n,r),Fk(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new Pk(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),Fk(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let r=n.getMeta("composition"),i=0==e.prevTime||!s&&e.prevComposition!=r&&(e.prevTime<(n.time||0)-o.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,o)=>{for(let r=0;r<t.length;r+=2)e<=t[r+1]&&o>=t[r]&&(n=!0)}),n}(n,e.prevRanges)),a=s?Fk(e.prevRanges,n.mapping):Rk(n.mapping.maps);return new Pk(e.done.addTransform(n,i?t.selection.getBookmark():void 0,o,Bk(t)),_k.empty,a,n.time,null==r?e.prevComposition:r)}}(n,o,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,o="historyUndo"==n?Uk:"historyRedo"==n?qk:null;return!(!o||!e.editable)&&(t.preventDefault(),o(e.state,e.dispatch))}}}})}function Wk(e,t){return(n,o)=>{let r=Vk.getState(n);if(!r||0==(e?r.undone:r.done).eventCount)return!1;if(o){let i=function(e,t,n){let o=Bk(t),r=Vk.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,o);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),r,o),l=new Pk(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(Vk,{redo:n,historyState:l})}(r,n,e);i&&o(t?i.scrollIntoView():i)}return!0}}const Uk=Wk(!1,!0),qk=Wk(!0,!0);Wk(!1,!1),Wk(!0,!1);Kv.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(e=>""!==e).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||this.options.mode)){const e=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(e)}return t.nodeSize},this.storage.words=e=>{const t=(null==e?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new hd({key:new md("characterCount"),appendTransaction:(t,n,o)=>{if(e)return;const r=this.options.limit;if(null===r||void 0===r||0===r)return void(e=!0);const i=this.storage.characters({node:o.doc});if(i>r){const t=0,n=i-r;console.warn("[CharacterCount] Initial content exceeded limit of ".concat(r," characters. Content was automatically trimmed."));const s=o.tr.deleteRange(t,n);return e=!0,s}e=!0},filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||0===n||null===n||void 0===n)return!0;const o=this.storage.characters({node:t.doc}),r=this.storage.characters({node:e.doc});if(r<=n)return!0;if(o>n&&r>n&&r<=o)return!0;if(o>n&&r>n&&r>o)return!1;if(!e.getMeta("paste"))return!1;const i=e.selection.$head.pos,s=i-(r-n),a=i;e.deleteRange(s,a);return!(this.storage.characters({node:e.doc})>n)}})]}});var Kk=Kv.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[vk(this.options)]}}),Yk=(Kv.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new hd({key:new md("focus"),props:{decorations:e=>{let{doc:t,selection:n}=e;const{isEditable:o,isFocused:r}=this.editor,{anchor:i}=n,s=[];if(!o||!r)return _p.create(t,[]);let a=0;"deepest"===this.options.mode&&t.descendants((e,t)=>{if(e.isText)return;if(!(i>=t&&i<=t+e.nodeSize-1))return!1;a+=1});let l=0;return t.descendants((e,t)=>{if(e.isText)return!1;if(!(i>=t&&i<=t+e.nodeSize-1))return!1;l+=1;if("deepest"===this.options.mode&&a-l>0||"shallowest"===this.options.mode&&l>1)return"deepest"===this.options.mode;s.push(Ap.node(t,t+e.nodeSize,{class:this.options.className}))}),_p.create(t,s)}}})]}}),Kv.create({name:"gapCursor",addProseMirrorPlugins:()=>[new hd({props:{decorations:Dk,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&bk.valid(n)?new bk(n):null,handleClick:Sk,handleKeyDown:kk,handleDOMEvents:{beforeinput:Ek}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!=(t=zg(Pg(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))?t:null}}}));Kv.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new hd({key:new md("placeholder"),props:{decorations:e=>{let{doc:t,selection:n}=e;const o=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=n,i=[];if(!o)return null;const s=this.editor.isEmpty;return t.descendants((e,t)=>{const n=r>=t&&r<=t+e.nodeSize,o=!e.isLeaf&&av(e);if((n||!this.options.showOnlyCurrent)&&o){const o=[this.options.emptyNodeClass];s&&o.push(this.options.emptyEditorClass);const r=Ap.node(t,t+e.nodeSize,{class:o.join(" "),"data-placeholder":"function"===typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});i.push(r)}return this.options.includeChildren}),_p.create(t,i)}}})]}}),Kv.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new hd({key:new md("selection"),props:{decorations:n=>n.selection.empty||e.isFocused||!e.isEditable||lv(n.selection)||e.view.dragging?null:_p.create(n.doc,[Ap.inline(n.selection.from,n.selection.to,{class:t.className})])}})]}});function Xk(e){let{types:t,node:n}=e;return n&&Array.isArray(t)&&t.includes(n.type)||(null==n?void 0:n.type)===t}var Zk=Kv.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var e;const t=new md(this.name),n=this.options.node||(null==(e=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:e.name)||"paragraph",o=Object.entries(this.editor.schema.nodes).map(e=>{let[,t]=e;return t}).filter(e=>(this.options.notAfter||[]).concat(n).includes(e.name));return[new hd({key:t,appendTransaction:(e,o,r)=>{const{doc:i,tr:s,schema:a}=r,l=t.getState(r),c=i.content.size,u=a.nodes[n];if(l)return s.insert(c,u.create())},state:{init:(e,t)=>!Xk({node:t.tr.doc.lastChild,types:o}),apply:(e,t)=>{if(!e.docChanged)return t;if(e.getMeta("__uniqueIDTransaction"))return t;return!Xk({node:e.doc.lastChild,types:o})}}})]}}),Gk=Kv.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>e=>{let{state:t,dispatch:n}=e;return Uk(t,n)},redo:()=>e=>{let{state:t,dispatch:n}=e;return qk(t,n)}}),addProseMirrorPlugins(){return[$k(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Jk=Kv.create({name:"starterKit",addExtensions(){var e,t,n,o;const r=[];return!1!==this.options.bold&&r.push(kb.configure(this.options.bold)),!1!==this.options.blockquote&&r.push(vb.configure(this.options.blockquote)),!1!==this.options.bulletList&&r.push(Hw.configure(this.options.bulletList)),!1!==this.options.code&&r.push(Eb.configure(this.options.code)),!1!==this.options.codeBlock&&r.push(Nb.configure(this.options.codeBlock)),!1!==this.options.document&&r.push(Ab.configure(this.options.document)),!1!==this.options.dropcursor&&r.push(Kk.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&r.push(Yk.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&r.push(Ob.configure(this.options.hardBreak)),!1!==this.options.heading&&r.push(Tb.configure(this.options.heading)),!1!==this.options.undoRedo&&r.push(Gk.configure(this.options.undoRedo)),!1!==this.options.horizontalRule&&r.push(_b.configure(this.options.horizontalRule)),!1!==this.options.italic&&r.push(Fb.configure(this.options.italic)),!1!==this.options.listItem&&r.push($w.configure(this.options.listItem)),!1!==this.options.listKeymap&&r.push(ek.configure(null==(e=this.options)?void 0:e.listKeymap)),!1!==this.options.link&&r.push(Rw.configure(null==(t=this.options)?void 0:t.link)),!1!==this.options.orderedList&&r.push(sk.configure(this.options.orderedList)),!1!==this.options.paragraph&&r.push(uk.configure(this.options.paragraph)),!1!==this.options.strike&&r.push(fk.configure(this.options.strike)),!1!==this.options.text&&r.push(pk.configure(this.options.text)),!1!==this.options.underline&&r.push(mk.configure(null==(n=this.options)?void 0:n.underline)),!1!==this.options.trailingNode&&r.push(Zk.configure(null==(o=this.options)?void 0:o.trailingNode)),r}});const Qk=n.p+"static/media/bold.41f57a00325fe3457fac406b73532012.svg";const eC=n.p+"static/media/italic.7182c2308f441a86b0dc3a98e1533b61.svg";const tC=n.p+"static/media/underlined.a806bdfbf788b60d9e145378f92e5c3a.svg";const nC=n.p+"static/media/strikethrough.d0ac6cdd85cad2db575fd6196c97d72f.svg";const oC=n.p+"static/media/code.4dbda37178ab9bbd5da645ae75e5f8a2.svg";const rC=n.p+"static/media/pre.3c753be7a3e519200f358b5269ef0e4f.svg";const iC=n.p+"static/media/hide.cc2e2d54e713af50ddb7137c3544c4cd.svg";const sC=n.p+"static/media/quote.c51d286ac2170fcc54fc5734e54e23bd.svg";const aC=n.p+"static/media/link.b95f85e137c81ff64bcb85d4a1a67d91.svg";const lC=n.p+"static/media/time.1934e893a0580554a6010e9ac3713999.svg";const cC=n.p+"static/media/tag.7efdb48cc9d7eed919d8a564aea65bf3.svg";const uC=n.p+"static/media/copy.2547677716b62f8338f4438c9c8b6a47.svg";const dC=n.p+"static/media/select-all.e2e8e45942637c89e1fd8c8638f2dbd0.svg";const hC=n.p+"static/media/trash.e21cbc6753a20770bfaadd7d0bd540b4.svg";const fC=n.p+"static/media/undo.f11ed93a09602429d1690c587c7a7c07.svg";const pC=n.p+"static/media/redo.dd9ea40512e26e9ae3c1f9daf412450a.svg";async function mC(e,t){const n=await fetch("/api/stories/".concat(e,"/").concat(t,"/delete"),{method:"DELETE"});if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e")}return await n.json()}async function gC(e,t){try{const n=await fetch("/api/story/".concat(e,"/").concat(t,"/effects"));if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u0438")}return await n.json()}catch(n){return console.error("[apiGetStoryEffects] \u041e\u0448\u0438\u0431\u043a\u0430:",n),[]}}async function vC(e,t,n,o){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/media"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"Failed to update media")}return await r.json()}async function yC(e,t){const n=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks"));return n.ok?await n.json():(console.error("Could not load bookmarks"),{})}const bC=/\{\{([A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u04510-9_]+):\s*([^}]+)\}\}/g,xC=/\{\{([A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u04510-9_]+)\}\}/g,wC=Kv.create({name:"attributeHighlight",addProseMirrorPlugins(){const e=e=>{const t=[],n=[],o=[];e.descendants((e,t)=>{if(!e.isText)return;const r=e.text;let i;for(bC.lastIndex=0;null!==(i=bC.exec(r));)n.push({name:i[1],from:t+i.index,to:t+i.index+i[0].length});for(xC.lastIndex=0;null!==(i=xC.exec(r));)o.push({name:i[1],from:t+i.index,to:t+i.index+i[0].length})});const r=new Set;return n.forEach(e=>{const n=o.find(t=>t.name===e.name&&t.from>e.from&&!r.has(t));if(n){r.add(n);const o=(e=>{let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)})(e.name),i="attr-c-".concat(o%7+1);t.push(Ap.inline(e.from,n.to,{class:i}))}}),_p.create(e,t)};let t=null;return t=new hd({state:{init(t,n){let{doc:o}=n;return e(o)},apply:(t,n)=>t.docChanged?e(t.doc):n.map(t.mapping,t.doc)},props:{decorations:e=>t.getState(e)}}),[t]}}),kC=wC;function CC(t){let{onSubmit:n,onCancel:o,userId:r,storyId:i}=t;const[s,a]=(0,e.useState)(""),[l,u]=(0,e.useState)("="),[d,h]=(0,e.useState)(!1),[f,p]=(0,e.useState)(""),[m,g]=(0,e.useState)(""),[v,y]=(0,e.useState)([]),[b,x]=(0,e.useState)(!1),[w,k]=(0,e.useState)(!1),C="display"===l;(0,e.useEffect)(()=>{!async function(){x(!0);const e=await gC(r,i);y(e||[]),x(!1)}()},[r,i]);return(0,c.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,c.jsxs)("div",{className:"modal-content small",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:C?"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u0442\u0440\u0438\u0431\u0443\u0442":"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430"}),(0,c.jsx)("p",{style:{color:"#777",fontSize:"13px",marginTop:"-4px",marginBottom:"12px"},children:C?"\u0412 \u044d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e.":"\u0422\u0435\u043a\u0441\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u043f\u043e\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0432\u043d\u0443\u0442\u0440\u044c \u044d\u0442\u043e\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430"}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"}),(0,c.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,c.jsx)("input",{type:"text",value:s,onChange:e=>{const t=e.target.value;a(t),k(""===t.trim())},placeholder:"\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0441\u0438\u043b\u0430",onFocus:()=>k(""===s.trim()),onBlur:()=>setTimeout(()=>k(!1),150)}),w&&v.length>0&&(0,c.jsx)("ul",{className:"suggestions-list",style:{position:"absolute",top:"100%",left:0,width:"100%",background:"#fff",border:"1px solid #ccc",borderRadius:"6px",maxHeight:"90px",overflowY:"auto",zIndex:1e3,fontSize:"13px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:b?(0,c.jsx)("li",{style:{padding:"6px 10px",color:"#555"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):v.map(e=>(0,c.jsx)("li",{style:{padding:"6px 10px",cursor:"pointer",borderBottom:"1px solid #eee",color:"#222",backgroundColor:"#fff"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f0f0f0",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",onMouseDown:()=>(e=>{a(e),k(!1)})(e),children:e},e))})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435:"})," ",(0,c.jsxs)("select",{value:l,onChange:e=>u(e.target.value),children:[(0,c.jsx)("option",{value:"=",children:"\u0420\u0430\u0432\u043d\u043e (=)"}),(0,c.jsx)("option",{value:"<",children:"\u041c\u0435\u043d\u044c\u0448\u0435 (<)"}),(0,c.jsx)("option",{value:">",children:"\u0411\u043e\u043b\u044c\u0448\u0435 (>)"}),(0,c.jsx)("option",{value:"display",children:"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c "})," "]})]}),!C&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"form-row checkbox",children:(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",checked:d,onChange:e=>h(e.target.checked)}),"\u0420\u0430\u043d\u0434\u043e\u043c"]})}),d?(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u041e\u0442:"}),(0,c.jsx)("input",{type:"number",value:f,onChange:e=>p(e.target.value)}),(0,c.jsx)("label",{children:"\u0414\u043e:"}),(0,c.jsx)("input",{type:"number",value:m,onChange:e=>g(e.target.value)})]}):(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("label",{children:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435:"}),(0,c.jsx)("input",{type:"number",value:f,onChange:e=>p(e.target.value)})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:o,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{if(!s.trim())return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430");if(C)n({name:s.trim(),isDisplay:!0});else{let e="";if(d){if(""===f||""===m)return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0447\u0438\u0441\u0435\u043b");e="".concat(l).concat(f,"-").concat(m)}else{if(""===f)return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435");e="".concat(l).concat(f)}n({name:s.trim(),resultValue:e,isDisplay:!1})}},children:"OK"})]})]})})}function SC(t){let{onSubmit:n,onCancel:o}=t;const[r,i]=(0,e.useState)("add"),[s,a]=(0,e.useState)(""),[l,u]=(0,e.useState)(!1);return(0,c.jsx)("div",{className:"modal-overlay",onPointerDown:o,children:(0,c.jsxs)("div",{className:"modal-content small",onPointerDown:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:"\u0422\u0430\u0439\u043c\u0435\u0440 / \u041e\u0447\u0438\u0441\u0442\u043a\u0430"}),(0,c.jsx)("div",{onClick:()=>u(!l),style:{cursor:"pointer",color:"#888",fontSize:"13px",marginBottom:"8px",userSelect:"none"},children:"\u25b6 \u041f\u043e\u043c\u043e\u0449\u044c"}),l&&(0,c.jsx)("div",{style:{background:"#f5f5f5",padding:"10px",borderRadius:"6px",fontSize:"13px",lineHeight:"1.4",color:"#555",marginBottom:"15px"},children:'\u0422\u0430\u0439\u043c\u0435\u0440 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0438\u0437 \u0441\u0435\u0431\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043f\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438. "\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c" \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u0435\u0441\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0442\u0435\u043a\u0441\u0442 \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e (\u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445) \u043a \u0443\u0436\u0435 \u0438\u043c\u0435\u044e\u0449\u0435\u043c\u0443\u0441\u044f \u0442\u0435\u043a\u0441\u0442\u0443. \u041a\u043d\u043e\u043f\u043a\u0430 "\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c" \u043e\u0447\u0438\u0449\u0430\u0435\u0442 \u0432\u0435\u0441\u044c \u0442\u0435\u043a\u0441\u0442 \u0432 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0435 \u0438 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0438\u0439 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u043c\u0435\u0441\u0442\u0435 \u0441\u0442\u0430\u0440\u043e\u0433\u043e. \u041a\u0430\u0436\u0434\u044b\u0439 \u0442\u044d\u0433 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0441\u0432\u043e\u0439 \u043e\u0442\u0441\u0447\u0451\u0442 \u043e\u0442 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u0442\u044d\u0433\u0430, \u0430 \u043d\u0435 \u043e\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.'}),(0,c.jsxs)("div",{className:"form-row",style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,c.jsxs)("select",{value:r,onChange:e=>i(e.target.value),style:{flex:1},children:[(0,c.jsx)("option",{value:"add",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"clear",children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]}),(0,c.jsx)("input",{type:"number",value:s,onChange:e=>a(e.target.value),placeholder:"\u0421\u0435\u043a",style:{width:"80px"},autoFocus:!0})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:o,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{if(!s.trim())return void alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e");const e="[[".concat("add"===r?"+":"-").concat(s,"]]");n(e)},children:"OK"})]})]})})}const EC="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function DC(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function MC(e){return"nodeType"in e}function NC(e){var t,n;return e?DC(e)?e:MC(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function AC(e){const{Document:t}=NC(e);return e instanceof t}function OC(e){return!DC(e)&&e instanceof NC(e).HTMLElement}function TC(e){return e instanceof NC(e).SVGElement}function _C(e){return e?DC(e)?e.document:MC(e)?AC(e)?e:OC(e)||TC(e)?e.ownerDocument:document:document:document}const jC=EC?e.useLayoutEffect:e.useEffect;function PC(t){const n=(0,e.useRef)(t);return jC(()=>{n.current=t}),(0,e.useCallback)(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return null==n.current?void 0:n.current(...t)},[])}function IC(t,n){void 0===n&&(n=[t]);const o=(0,e.useRef)(t);return jC(()=>{o.current!==t&&(o.current=t)},n),o}function RC(t,n){const o=(0,e.useRef)();return(0,e.useMemo)(()=>{const e=t(o.current);return o.current=e,e},[...n])}function FC(t){const n=PC(t),o=(0,e.useRef)(null),r=(0,e.useCallback)(e=>{e!==o.current&&(null==n||n(e,o.current)),o.current=e},[]);return[o,r]}function zC(t){const n=(0,e.useRef)();return(0,e.useEffect)(()=>{n.current=t},[t]),n.current}let LC={};function BC(t,n){return(0,e.useMemo)(()=>{if(n)return n;const e=null==LC[t]?0:LC[t]+1;return LC[t]=e,t+"-"+e},[t,n])}function VC(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return o.reduce((t,n)=>{const o=Object.entries(n);for(const[r,i]of o){const n=t[r];null!=n&&(t[r]=n+e*i)}return t},a({},t))}}const HC=VC(1),$C=VC(-1);function WC(e){if(!e)return!1;const{KeyboardEvent:t}=NC(e.target);return t&&e instanceof t}function UC(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=NC(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const qC=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[qC.Translate.toString(e),qC.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:o}=e;return t+" "+n+"ms "+o}}}),KC="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function YC(e){return e.matches(KC)?e:e.querySelector(KC)}const XC={display:"none"};function ZC(t){let{id:n,value:o}=t;return e.createElement("div",{id:n,style:XC},o)}function GC(t){let{id:n,announcement:o,ariaLiveType:r="assertive"}=t;return e.createElement("div",{id:n,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},o)}const JC=["transform"],QC=["id","accessibility","autoScroll","children","sensors","collisionDetection","measuring","modifiers"],eS=(0,e.createContext)(null);const tS={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},nS={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function oS(t){let{announcements:n=nS,container:o,hiddenTextDescribedById:r,screenReaderInstructions:i=tS}=t;const{announce:s,announcement:a}=function(){const[t,n]=(0,e.useState)(""),o=(0,e.useCallback)(e=>{null!=e&&n(e)},[]);return{announce:o,announcement:t}}(),l=BC("DndLiveRegion"),[c,u]=(0,e.useState)(!1);if((0,e.useEffect)(()=>{u(!0)},[]),function(t){const n=(0,e.useContext)(eS);(0,e.useEffect)(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(t)},[t,n])}((0,e.useMemo)(()=>({onDragStart(e){let{active:t}=e;s(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:o}=e;n.onDragMove&&s(n.onDragMove({active:t,over:o}))},onDragOver(e){let{active:t,over:o}=e;s(n.onDragOver({active:t,over:o}))},onDragEnd(e){let{active:t,over:o}=e;s(n.onDragEnd({active:t,over:o}))},onDragCancel(e){let{active:t,over:o}=e;s(n.onDragCancel({active:t,over:o}))}}),[s,n])),!c)return null;const d=e.createElement(e.Fragment,null,e.createElement(ZC,{id:r,value:i.draggable}),e.createElement(GC,{id:l,announcement:a}));return o?(0,Ai.createPortal)(d,o):d}var rS;function iS(){}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(rS||(rS={}));const sS=Object.freeze({x:0,y:0});function aS(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function lS(e,t){let{data:{value:n}}=e,{data:{value:o}}=t;return n-o}function cS(e,t){let{data:{value:n}}=e,{data:{value:o}}=t;return o-n}function uS(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const dS=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:o}=e;const r=uS(t,t.left,t.top),i=[];for(const s of o){const{id:e}=s,t=n.get(e);if(t){const n=aS(uS(t),r);i.push({id:e,data:{droppableContainer:s,value:n}})}}return i.sort(lS)};function hS(e,t){const n=Math.max(t.top,e.top),o=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=r-o,a=i-n;if(o<r&&n<i){const n=t.width*t.height,o=e.width*e.height,r=s*a;return Number((r/(n+o-r)).toFixed(4))}return 0}const fS=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:o}=e;const r=[];for(const i of o){const{id:e}=i,o=n.get(e);if(o){const n=hS(o,t);n>0&&r.push({id:e,data:{droppableContainer:i,value:n}})}}return r.sort(cS)};function pS(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:sS}function mS(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return o.reduce((t,n)=>a(a({},t),{},{top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),a({},t))}}const gS=mS(1);function vS(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const yS={ignoreTransform:!1};function bS(e,t){void 0===t&&(t=yS);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:o}=NC(e).getComputedStyle(e);t&&(n=function(e,t,n){const o=vS(t);if(!o)return e;const{scaleX:r,scaleY:i,x:s,y:a}=o,l=e.left-s-(1-r)*parseFloat(n),c=e.top-a-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=r?e.width/r:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(n,t,o))}const{top:o,left:r,width:i,height:s,bottom:a,right:l}=n;return{top:o,left:r,width:i,height:s,bottom:a,right:l}}function xS(e){return bS(e,{ignoreTransform:!0})}function wS(e,t){const n=[];return e?function o(r){if(null!=t&&n.length>=t)return n;if(!r)return n;if(AC(r)&&null!=r.scrollingElement&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!OC(r)||TC(r))return n;if(n.includes(r))return n;const i=NC(e).getComputedStyle(r);return r!==e&&function(e,t){void 0===t&&(t=NC(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const o=t[e];return"string"===typeof o&&n.test(o)})}(r,i)&&n.push(r),function(e,t){return void 0===t&&(t=NC(e).getComputedStyle(e)),"fixed"===t.position}(r,i)?n:o(r.parentNode)}(e):n}function kS(e){const[t]=wS(e,1);return null!=t?t:null}function CS(e){return EC&&e?DC(e)?e:MC(e)?AC(e)||e===_C(e).scrollingElement?window:OC(e)?e:null:null:null}function SS(e){return DC(e)?e.scrollX:e.scrollLeft}function ES(e){return DC(e)?e.scrollY:e.scrollTop}function DS(e){return{x:SS(e),y:ES(e)}}var MS;function NS(e){return!(!EC||!e)&&e===document.scrollingElement}function AS(e){const t={x:0,y:0},n=NS(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},o={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=o.y,isRight:e.scrollLeft>=o.x,maxScroll:o,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(MS||(MS={}));const OS={x:.2,y:.2};function TS(e,t,n,o,r){let{top:i,left:s,right:a,bottom:l}=n;void 0===o&&(o=10),void 0===r&&(r=OS);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=AS(e),f={x:0,y:0},p={x:0,y:0},m=t.height*r.y,g=t.width*r.x;return!c&&i<=t.top+m?(f.y=MS.Backward,p.y=o*Math.abs((t.top+m-i)/m)):!u&&l>=t.bottom-m&&(f.y=MS.Forward,p.y=o*Math.abs((t.bottom-m-l)/m)),!h&&a>=t.right-g?(f.x=MS.Forward,p.x=o*Math.abs((t.right-g-a)/g)):!d&&s<=t.left+g&&(f.x=MS.Backward,p.x=o*Math.abs((t.left+g-s)/g)),{direction:f,speed:p}}function _S(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:o,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:o,bottom:r,width:e.clientWidth,height:e.clientHeight}}function jS(e){return e.reduce((e,t)=>HC(e,DS(t)),sS)}function PS(e,t){if(void 0===t&&(t=bS),!e)return;const{top:n,left:o,bottom:r,right:i}=t(e);kS(e)&&(r<=0||i<=0||n>=window.innerHeight||o>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const IS=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+SS(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+ES(t),0)}]];class RS{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=wS(t),o=jS(n);this.rect=a({},e),this.width=e.width,this.height=e.height;for(const[r,i,s]of IS)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=s(n),i=o[r]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class FS{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var o;null==(o=this.target)||o.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function zS(e,t){const n=Math.abs(e.x),o=Math.abs(e.y);return"number"===typeof t?Math.sqrt(n**2+o**2)>t:"x"in t&&"y"in t?n>t.x&&o>t.y:"x"in t?n>t.x:"y"in t&&o>t.y}var LS,BS;function VS(e){e.preventDefault()}function HS(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(LS||(LS={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(BS||(BS={}));const $S={start:[BS.Space,BS.Enter],cancel:[BS.Esc],end:[BS.Space,BS.Enter,BS.Tab]},WS=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case BS.Right:return a(a({},n),{},{x:n.x+25});case BS.Left:return a(a({},n),{},{x:n.x-25});case BS.Down:return a(a({},n),{},{y:n.y+25});case BS.Up:return a(a({},n),{},{y:n.y-25})}};class US{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new FS(_C(t)),this.windowListeners=new FS(NC(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(LS.Resize,this.handleCancel),this.windowListeners.add(LS.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(LS.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&PS(n),t(sS)}handleKeyDown(e){if(WC(e)){const{active:t,context:n,options:o}=this.props,{keyboardCodes:r=$S,coordinateGetter:i=WS,scrollBehavior:s="smooth"}=o,{code:a}=e;if(r.end.includes(a))return void this.handleEnd(e);if(r.cancel.includes(a))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:sS;this.referenceCoordinates||(this.referenceCoordinates=c);const u=i(e,{active:t,context:n.current,currentCoordinates:c});if(u){const t=$C(u,c),o={x:0,y:0},{scrollableAncestors:r}=n.current;for(const n of r){const r=e.code,{isTop:i,isRight:a,isLeft:l,isBottom:c,maxScroll:d,minScroll:h}=AS(n),f=_S(n),p={x:Math.min(r===BS.Right?f.right-f.width/2:f.right,Math.max(r===BS.Right?f.left:f.left+f.width/2,u.x)),y:Math.min(r===BS.Down?f.bottom-f.height/2:f.bottom,Math.max(r===BS.Down?f.top:f.top+f.height/2,u.y))},m=r===BS.Right&&!a||r===BS.Left&&!l,g=r===BS.Down&&!c||r===BS.Up&&!i;if(m&&p.x!==u.x){const e=n.scrollLeft+t.x,i=r===BS.Right&&e<=d.x||r===BS.Left&&e>=h.x;if(i&&!t.y)return void n.scrollTo({left:e,behavior:s});o.x=i?n.scrollLeft-e:r===BS.Right?n.scrollLeft-d.x:n.scrollLeft-h.x,o.x&&n.scrollBy({left:-o.x,behavior:s});break}if(g&&p.y!==u.y){const e=n.scrollTop+t.y,i=r===BS.Down&&e<=d.y||r===BS.Up&&e>=h.y;if(i&&!t.x)return void n.scrollTo({top:e,behavior:s});o.y=i?n.scrollTop-e:r===BS.Down?n.scrollTop-d.y:n.scrollTop-h.y,o.y&&n.scrollBy({top:-o.y,behavior:s});break}}this.handleMove(e,HC($C(u,this.referenceCoordinates),o))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function qS(e){return Boolean(e&&"distance"in e)}function KS(e){return Boolean(e&&"delay"in e)}US.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:o=$S,onActivation:r}=t,{active:i}=n;const{code:s}=e.nativeEvent;if(o.start.includes(s)){const t=i.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==r||r({event:e.nativeEvent}),!0)}return!1}}];class YS{constructor(e,t,n){var o;void 0===n&&(n=function(e){const{EventTarget:t}=NC(e);return e instanceof t?e:_C(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:i}=r;this.props=e,this.events=t,this.document=_C(i),this.documentListeners=new FS(this.document),this.listeners=new FS(n),this.windowListeners=new FS(NC(i)),this.initialCoordinates=null!=(o=UC(r))?o:sS,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(LS.Resize,this.handleCancel),this.windowListeners.add(LS.DragStart,VS),this.windowListeners.add(LS.VisibilityChange,this.handleCancel),this.windowListeners.add(LS.ContextMenu,VS),this.documentListeners.add(LS.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(KS(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(qS(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:o}=this.props;o(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(LS.Click,HS,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(LS.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:o,props:r}=this,{onMove:i,options:{activationConstraint:s}}=r;if(!o)return;const a=null!=(t=UC(e))?t:sS,l=$C(o,a);if(!n&&s){if(qS(s)){if(null!=s.tolerance&&zS(l,s.tolerance))return this.handleCancel();if(zS(l,s.distance))return this.handleStart()}return KS(s)&&zS(l,s.tolerance)?this.handleCancel():void this.handlePending(s,l)}e.cancelable&&e.preventDefault(),i(a)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===BS.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const XS={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ZS extends YS{constructor(e){const{event:t}=e,n=_C(t.target);super(e,XS,n)}}ZS.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;return!(!n.isPrimary||0!==n.button)&&(null==o||o({event:n}),!0)}}];const GS={move:{name:"mousemove"},end:{name:"mouseup"}};var JS;!function(e){e[e.RightClick=2]="RightClick"}(JS||(JS={}));(class extends YS{constructor(e){super(e,GS,_C(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;return n.button!==JS.RightClick&&(null==o||o({event:n}),!0)}}];const QS={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var eE,tE;function nE(t){let{acceleration:n,activator:o=eE.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:a=5,order:l=tE.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=t;const p=function(e){let{delta:t,disabled:n}=e;const o=zC(t);return RC(e=>{if(n||!o||!e)return oE;const r={x:Math.sign(t.x-o.x),y:Math.sign(t.y-o.y)};return{x:{[MS.Backward]:e.x[MS.Backward]||-1===r.x,[MS.Forward]:e.x[MS.Forward]||1===r.x},y:{[MS.Backward]:e.y[MS.Backward]||-1===r.y,[MS.Forward]:e.y[MS.Forward]||1===r.y}}},[n,t,o])}({delta:h,disabled:!s}),[m,g]=function(){const t=(0,e.useRef)(null),n=(0,e.useCallback)((e,n)=>{t.current=setInterval(e,n)},[]);return[n,(0,e.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]}(),v=(0,e.useRef)({x:0,y:0}),y=(0,e.useRef)({x:0,y:0}),b=(0,e.useMemo)(()=>{switch(o){case eE.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case eE.DraggableRect:return i}},[o,i,c]),x=(0,e.useRef)(null),w=(0,e.useCallback)(()=>{const e=x.current;if(!e)return;const t=v.current.x*y.current.x,n=v.current.y*y.current.y;e.scrollBy(t,n)},[]),k=(0,e.useMemo)(()=>l===tE.TreeOrder?[...u].reverse():u,[l,u]);(0,e.useEffect)(()=>{if(s&&u.length&&b){for(const e of k){if(!1===(null==r?void 0:r(e)))continue;const t=u.indexOf(e),o=d[t];if(!o)continue;const{direction:i,speed:s}=TS(e,o,b,n,f);for(const e of["x","y"])p[e][i[e]]||(s[e]=0,i[e]=0);if(s.x>0||s.y>0)return g(),x.current=e,m(w,a),v.current=s,void(y.current=i)}v.current={x:0,y:0},y.current={x:0,y:0},g()}else g()},[n,w,r,g,s,a,JSON.stringify(b),JSON.stringify(p),m,u,k,d,JSON.stringify(f)])}(class extends YS{constructor(e){super(e,QS)}static setup(){return window.addEventListener(QS.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(QS.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;const{touches:r}=n;return!(r.length>1)&&(null==o||o({event:n}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(eE||(eE={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(tE||(tE={}));const oE={x:{[MS.Backward]:!1,[MS.Forward]:!1},y:{[MS.Backward]:!1,[MS.Forward]:!1}};var rE,iE;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(rE||(rE={})),function(e){e.Optimized="optimized"}(iE||(iE={}));const sE=new Map;function aE(e,t){return RC(n=>e?n||("function"===typeof t?t(e):e):null,[t,e])}function lE(t){let{callback:n,disabled:o}=t;const r=PC(n),i=(0,e.useMemo)(()=>{if(o||"undefined"===typeof window||"undefined"===typeof window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[o]);return(0,e.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function cE(e){return new RS(bS(e),e)}function uE(t,n,o){void 0===n&&(n=cE);const[r,i]=(0,e.useState)(null);function s(){i(e=>{if(!t)return null;var r;if(!1===t.isConnected)return null!=(r=null!=e?e:o)?r:null;const i=n(t);return JSON.stringify(e)===JSON.stringify(i)?e:i})}const a=function(t){let{callback:n,disabled:o}=t;const r=PC(n),i=(0,e.useMemo)(()=>{if(o||"undefined"===typeof window||"undefined"===typeof window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,o]);return(0,e.useEffect)(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(e){if(t)for(const n of e){const{type:e,target:o}=n;if("childList"===e&&o instanceof HTMLElement&&o.contains(t)){s();break}}}}),l=lE({callback:s});return jC(()=>{s(),t?(null==l||l.observe(t),null==a||a.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==a||a.disconnect())},[t]),r}const dE=[];function hE(t,n){void 0===n&&(n=[]);const o=(0,e.useRef)(null);return(0,e.useEffect)(()=>{o.current=null},n),(0,e.useEffect)(()=>{const e=t!==sS;e&&!o.current&&(o.current=t),!e&&o.current&&(o.current=null)},[t]),o.current?$C(t,o.current):sS}function fE(t){return(0,e.useMemo)(()=>t?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(t):null,[t])}const pE=[];function mE(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return OC(t)?t:e}const gE=[{sensor:ZS,options:{}},{sensor:US,options:{}}],vE={current:{}},yE={draggable:{measure:xS},droppable:{measure:xS,strategy:rE.WhileDragging,frequency:iE.Optimized},dragOverlay:{measure:bS}};class bE extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const xE={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new bE,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:iS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:yE,measureDroppableContainers:iS,windowRect:null,measuringScheduled:!1},wE={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:iS,draggableNodes:new Map,over:null,measureDroppableContainers:iS},kE=(0,e.createContext)(wE),CE=(0,e.createContext)(xE);function SE(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new bE}}}function EE(e,t){switch(t.type){case rS.DragStart:return a(a({},e),{},{draggable:a(a({},e.draggable),{},{initialCoordinates:t.initialCoordinates,active:t.active})});case rS.DragMove:return null==e.draggable.active?e:a(a({},e),{},{draggable:a(a({},e.draggable),{},{translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}})});case rS.DragEnd:case rS.DragCancel:return a(a({},e),{},{draggable:a(a({},e.draggable),{},{active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}})});case rS.RegisterDroppable:{const{element:n}=t,{id:o}=n,r=new bE(e.droppable.containers);return r.set(o,n),a(a({},e),{},{droppable:a(a({},e.droppable),{},{containers:r})})}case rS.SetDroppableDisabled:{const{id:n,key:o,disabled:r}=t,i=e.droppable.containers.get(n);if(!i||o!==i.key)return e;const s=new bE(e.droppable.containers);return s.set(n,a(a({},i),{},{disabled:r})),a(a({},e),{},{droppable:a(a({},e.droppable),{},{containers:s})})}case rS.UnregisterDroppable:{const{id:n,key:o}=t,r=e.droppable.containers.get(n);if(!r||o!==r.key)return e;const i=new bE(e.droppable.containers);return i.delete(n),a(a({},e),{},{droppable:a(a({},e.droppable),{},{containers:i})})}default:return e}}function DE(t){let{disabled:n}=t;const{active:o,activatorEvent:r,draggableNodes:i}=(0,e.useContext)(kE),s=zC(r),a=zC(null==o?void 0:o.id);return(0,e.useEffect)(()=>{if(!n&&!r&&s&&null!=a){if(!WC(s))return;if(document.activeElement===s.target)return;const e=i.get(a);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=YC(e);if(t){t.focus();break}}})}},[r,n,i,a,s]),null}function ME(e,t){let{transform:n}=t,o=l(t,JC);return null!=e&&e.length?e.reduce((e,t)=>t(a({transform:e},o)),n):n}const NE=(0,e.createContext)(a(a({},sS),{},{scaleX:1,scaleY:1}));var AE;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(AE||(AE={}));const OE=(0,e.memo)(function(t){var n,o,r,i;let{id:s,accessibility:c,autoScroll:u=!0,children:d,sensors:h=gE,collisionDetection:f=fS,measuring:p,modifiers:m}=t,g=l(t,QC);const v=(0,e.useReducer)(EE,void 0,SE),[y,b]=v,[x,w]=function(){const[t]=(0,e.useState)(()=>new Set),n=(0,e.useCallback)(e=>(t.add(e),()=>t.delete(e)),[t]);return[(0,e.useCallback)(e=>{let{type:n,event:o}=e;t.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,o)})},[t]),n]}(),[k,C]=(0,e.useState)(AE.Uninitialized),S=k===AE.Initialized,{draggable:{active:E,nodes:D,translate:M},droppable:{containers:N}}=y,A=null!=E?D.get(E):null,O=(0,e.useRef)({initial:null,translated:null}),T=(0,e.useMemo)(()=>{var e;return null!=E?{id:E,data:null!=(e=null==A?void 0:A.data)?e:vE,rect:O}:null},[E,A]),_=(0,e.useRef)(null),[j,P]=(0,e.useState)(null),[I,R]=(0,e.useState)(null),F=IC(g,Object.values(g)),z=BC("DndDescribedBy",s),L=(0,e.useMemo)(()=>N.getEnabled(),[N]),B=(V=p,(0,e.useMemo)(()=>({draggable:a(a({},yE.draggable),null==V?void 0:V.draggable),droppable:a(a({},yE.droppable),null==V?void 0:V.droppable),dragOverlay:a(a({},yE.dragOverlay),null==V?void 0:V.dragOverlay)}),[null==V?void 0:V.draggable,null==V?void 0:V.droppable,null==V?void 0:V.dragOverlay]));var V;const{droppableRects:H,measureDroppableContainers:$,measuringScheduled:W}=function(t,n){let{dragging:o,dependencies:r,config:i}=n;const[s,a]=(0,e.useState)(null),{frequency:l,measure:c,strategy:u}=i,d=(0,e.useRef)(t),h=function(){switch(u){case rE.Always:return!1;case rE.BeforeDragging:return o;default:return!o}}(),f=IC(h),p=(0,e.useCallback)(function(e){void 0===e&&(e=[]),f.current||a(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[f]),m=(0,e.useRef)(null),g=RC(e=>{if(h&&!o)return sE;if(!e||e===sE||d.current!==t||null!=s){const e=new Map;for(let n of t){if(!n)continue;if(s&&s.length>0&&!s.includes(n.id)&&n.rect.current){e.set(n.id,n.rect.current);continue}const t=n.node.current,o=t?new RS(c(t),t):null;n.rect.current=o,o&&e.set(n.id,o)}return e}return e},[t,s,o,h,c]);return(0,e.useEffect)(()=>{d.current=t},[t]),(0,e.useEffect)(()=>{h||p()},[o,h]),(0,e.useEffect)(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),(0,e.useEffect)(()=>{h||"number"!==typeof l||null!==m.current||(m.current=setTimeout(()=>{p(),m.current=null},l))},[l,h,p,...r]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:null!=s}}(L,{dragging:S,dependencies:[M.x,M.y],config:B.droppable}),U=function(e,t){const n=null!=t?e.get(t):void 0,o=n?n.node.current:null;return RC(e=>{var n;return null==t?null:null!=(n=null!=o?o:e)?n:null},[o,t])}(D,E),q=(0,e.useMemo)(()=>I?UC(I):null,[I]),K=function(){const e=!1===(null==j?void 0:j.autoScrollEnabled),t="object"===typeof u?!1===u.enabled:!1===u,n=S&&!e&&!t;if("object"===typeof u)return a(a({},u),{},{enabled:n});return{enabled:n}}(),Y=function(e,t){return aE(e,t)}(U,B.draggable.measure);!function(t){let{activeNode:n,measure:o,initialRect:r,config:i=!0}=t;const s=(0,e.useRef)(!1),{x:a,y:l}="boolean"===typeof i?{x:i,y:i}:i;jC(()=>{if(!a&&!l||!n)return void(s.current=!1);if(s.current||!r)return;const e=null==n?void 0:n.node.current;if(!e||!1===e.isConnected)return;const t=pS(o(e),r);if(a||(t.x=0),l||(t.y=0),s.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const n=kS(e);n&&n.scrollBy({top:t.y,left:t.x})}},[n,a,l,r,o])}({activeNode:null!=E?D.get(E):null,config:K.layoutShiftCompensation,initialRect:Y,measure:B.draggable.measure});const X=uE(U,B.draggable.measure,Y),Z=uE(U?U.parentElement:null),G=(0,e.useRef)({activatorEvent:null,active:null,activeNode:U,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:N,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),J=N.getNodeFor(null==(n=G.current.over)?void 0:n.id),Q=function(t){let{measure:n}=t;const[o,r]=(0,e.useState)(null),i=lE({callback:(0,e.useCallback)(e=>{for(const{target:t}of e)if(OC(t)){r(e=>{const o=n(t);return e?a(a({},e),{},{width:o.width,height:o.height}):o});break}},[n])}),s=(0,e.useCallback)(e=>{const t=mE(e);null==i||i.disconnect(),t&&(null==i||i.observe(t)),r(t?n(t):null)},[n,i]),[l,c]=FC(s);return(0,e.useMemo)(()=>({nodeRef:l,rect:o,setRef:c}),[o,l,c])}({measure:B.dragOverlay.measure}),ee=null!=(o=Q.nodeRef.current)?o:U,te=S?null!=(r=Q.rect)?r:X:null,ne=Boolean(Q.nodeRef.current&&Q.rect),oe=pS(re=ne?null:X,aE(re));var re;const ie=fE(ee?NC(ee):null),se=function(t){const n=(0,e.useRef)(t),o=RC(e=>t?e&&e!==dE&&t&&n.current&&t.parentNode===n.current.parentNode?e:wS(t):dE,[t]);return(0,e.useEffect)(()=>{n.current=t},[t]),o}(S?null!=J?J:U:null),ae=function(t,n){void 0===n&&(n=bS);const[o]=t,r=fE(o?NC(o):null),[i,s]=(0,e.useState)(pE);function a(){s(()=>t.length?t.map(e=>NS(e)?r:new RS(n(e),e)):pE)}const l=lE({callback:a});return jC(()=>{null==l||l.disconnect(),a(),t.forEach(e=>null==l?void 0:l.observe(e))},[t]),i}(se),le=ME(m,{transform:{x:M.x-oe.x,y:M.y-oe.y,scaleX:1,scaleY:1},activatorEvent:I,active:T,activeNodeRect:X,containerNodeRect:Z,draggingNodeRect:te,over:G.current.over,overlayNodeRect:Q.rect,scrollableAncestors:se,scrollableAncestorRects:ae,windowRect:ie}),ce=q?HC(q,M):null,ue=function(t){const[n,o]=(0,e.useState)(null),r=(0,e.useRef)(t),i=(0,e.useCallback)(e=>{const t=CS(e.target);t&&o(e=>e?(e.set(t,DS(t)),new Map(e)):null)},[]);return(0,e.useEffect)(()=>{const e=r.current;if(t!==e){n(e);const s=t.map(e=>{const t=CS(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,DS(t)]):null}).filter(e=>null!=e);o(s.length?new Map(s):null),r.current=t}return()=>{n(t),n(e)};function n(e){e.forEach(e=>{const t=CS(e);null==t||t.removeEventListener("scroll",i)})}},[i,t]),(0,e.useMemo)(()=>t.length?n?Array.from(n.values()).reduce((e,t)=>HC(e,t),sS):jS(t):sS,[t,n])}(se),de=hE(ue),he=hE(ue,[X]),fe=HC(le,de),pe=te?gS(te,le):null,me=T&&pe?f({active:T,collisionRect:pe,droppableRects:H,droppableContainers:L,pointerCoordinates:ce}):null,ge=function(e,t){if(!e||0===e.length)return null;const[n]=e;return t?n[t]:n}(me,"id"),[ve,ye]=(0,e.useState)(null),be=function(e,t,n){return a(a({},e),{},{scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1})}(ne?le:HC(le,he),null!=(i=null==ve?void 0:ve.rect)?i:null,X),xe=(0,e.useRef)(null),we=(0,e.useCallback)((e,t)=>{let{sensor:n,options:o}=t;if(null==_.current)return;const r=D.get(_.current);if(!r)return;const i=e.nativeEvent,s=new n({active:_.current,activeNode:r,event:i,options:o,context:G,onAbort(e){if(!D.get(e))return;const{onDragAbort:t}=F.current,n={id:e};null==t||t(n),x({type:"onDragAbort",event:n})},onPending(e,t,n,o){if(!D.get(e))return;const{onDragPending:r}=F.current,i={id:e,constraint:t,initialCoordinates:n,offset:o};null==r||r(i),x({type:"onDragPending",event:i})},onStart(e){const t=_.current;if(null==t)return;const n=D.get(t);if(!n)return;const{onDragStart:o}=F.current,r={activatorEvent:i,active:{id:t,data:n.data,rect:O}};(0,Ai.unstable_batchedUpdates)(()=>{null==o||o(r),C(AE.Initializing),b({type:rS.DragStart,initialCoordinates:e,active:t}),x({type:"onDragStart",event:r}),P(xe.current),R(i)})},onMove(e){b({type:rS.DragMove,coordinates:e})},onEnd:a(rS.DragEnd),onCancel:a(rS.DragCancel)});function a(e){return async function(){const{active:t,collisions:n,over:o,scrollAdjustedTranslate:r}=G.current;let s=null;if(t&&r){const{cancelDrop:a}=F.current;if(s={activatorEvent:i,active:t,collisions:n,delta:r,over:o},e===rS.DragEnd&&"function"===typeof a){await Promise.resolve(a(s))&&(e=rS.DragCancel)}}_.current=null,(0,Ai.unstable_batchedUpdates)(()=>{b({type:e}),C(AE.Uninitialized),ye(null),P(null),R(null),xe.current=null;const t=e===rS.DragEnd?"onDragEnd":"onDragCancel";if(s){const e=F.current[t];null==e||e(s),x({type:t,event:s})}})}}xe.current=s},[D]),ke=(0,e.useCallback)((e,t)=>(n,o)=>{const r=n.nativeEvent,i=D.get(o);if(null!==_.current||!i||r.dndKit||r.defaultPrevented)return;const s={active:i};!0===e(n,t.options,s)&&(r.dndKit={capturedBy:t.sensor},_.current=o,we(n,t))},[D,we]),Ce=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{const{sensor:o}=t;return[...e,...o.activators.map(e=>({eventName:e.eventName,handler:n(e.handler,t)}))]},[]),[t,n])}(h,ke);!function(t){(0,e.useEffect)(()=>{if(!EC)return;const e=t.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const t of e)null==t||t()}},t.map(e=>{let{sensor:t}=e;return t}))}(h),jC(()=>{X&&k===AE.Initializing&&C(AE.Initialized)},[X,k]),(0,e.useEffect)(()=>{const{onDragMove:e}=F.current,{active:t,activatorEvent:n,collisions:o,over:r}=G.current;if(!t||!n)return;const i={active:t,activatorEvent:n,collisions:o,delta:{x:fe.x,y:fe.y},over:r};(0,Ai.unstable_batchedUpdates)(()=>{null==e||e(i),x({type:"onDragMove",event:i})})},[fe.x,fe.y]),(0,e.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:o,scrollAdjustedTranslate:r}=G.current;if(!e||null==_.current||!t||!r)return;const{onDragOver:i}=F.current,s=o.get(ge),a=s&&s.rect.current?{id:s.id,rect:s.rect.current,data:s.data,disabled:s.disabled}:null,l={active:e,activatorEvent:t,collisions:n,delta:{x:r.x,y:r.y},over:a};(0,Ai.unstable_batchedUpdates)(()=>{ye(a),null==i||i(l),x({type:"onDragOver",event:l})})},[ge]),jC(()=>{G.current={activatorEvent:I,active:T,activeNode:U,collisionRect:pe,collisions:me,droppableRects:H,draggableNodes:D,draggingNode:ee,draggingNodeRect:te,droppableContainers:N,over:ve,scrollableAncestors:se,scrollAdjustedTranslate:fe},O.current={initial:te,translated:pe}},[T,U,me,pe,D,ee,te,H,N,ve,se,fe]),nE(a(a({},K),{},{delta:M,draggingRect:pe,pointerCoordinates:ce,scrollableAncestors:se,scrollableAncestorRects:ae}));const Se=(0,e.useMemo)(()=>({active:T,activeNode:U,activeNodeRect:X,activatorEvent:I,collisions:me,containerNodeRect:Z,dragOverlay:Q,draggableNodes:D,droppableContainers:N,droppableRects:H,over:ve,measureDroppableContainers:$,scrollableAncestors:se,scrollableAncestorRects:ae,measuringConfiguration:B,measuringScheduled:W,windowRect:ie}),[T,U,X,I,me,Z,Q,D,N,H,ve,$,se,ae,B,W,ie]),Ee=(0,e.useMemo)(()=>({activatorEvent:I,activators:Ce,active:T,activeNodeRect:X,ariaDescribedById:{draggable:z},dispatch:b,draggableNodes:D,over:ve,measureDroppableContainers:$}),[I,Ce,T,X,b,z,D,ve,$]);return e.createElement(eS.Provider,{value:w},e.createElement(kE.Provider,{value:Ee},e.createElement(CE.Provider,{value:Se},e.createElement(NE.Provider,{value:be},d)),e.createElement(DE,{disabled:!1===(null==c?void 0:c.restoreFocus)})),e.createElement(oS,a(a({},c),{},{hiddenTextDescribedById:z})))}),TE=(0,e.createContext)(null),_E="button";function jE(t){let{id:n,data:o,disabled:r=!1,attributes:i}=t;const s=BC("Draggable"),{activators:a,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=(0,e.useContext)(kE),{role:p=_E,roleDescription:m="draggable",tabIndex:g=0}=null!=i?i:{},v=(null==c?void 0:c.id)===n,y=(0,e.useContext)(v?NE:TE),[b,x]=FC(),[w,k]=FC(),C=function(t,n){return(0,e.useMemo)(()=>t.reduce((e,t)=>{let{eventName:o,handler:r}=t;return e[o]=e=>{r(e,n)},e},{}),[t,n])}(a,n),S=IC(o);jC(()=>(h.set(n,{id:n,key:s,node:b,activatorNode:w,data:S}),()=>{const e=h.get(n);e&&e.key===s&&h.delete(n)}),[h,n]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:(0,e.useMemo)(()=>({role:p,tabIndex:g,"aria-disabled":r,"aria-pressed":!(!v||p!==_E)||void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[r,p,g,v,m,d.draggable]),isDragging:v,listeners:r?void 0:C,node:b,over:f,setNodeRef:x,setActivatorNodeRef:k,transform:y}}function PE(){return(0,e.useContext)(CE)}const IE={timeout:25};function RE(e,t,n){const o=e.slice();return o.splice(n<0?o.length+n:n,0,o.splice(t,1)[0]),o}function FE(e,t){return e.reduce((e,n,o)=>{const r=t.get(n);return r&&(e[o]=r),e},Array(e.length))}function zE(e){return null!==e&&e>=0}const LE=e=>{let{rects:t,activeIndex:n,overIndex:o,index:r}=e;const i=RE(t,o,n),s=t[r],a=i[r];return a&&s?{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}:null},BE={scaleX:1,scaleY:1},VE=e=>{var t;let{activeIndex:n,activeNodeRect:o,index:r,rects:i,overIndex:s}=e;const l=null!=(t=i[n])?t:o;if(!l)return null;if(r===n){const e=i[s];return e?a({x:0,y:n<s?e.top+e.height-(l.top+l.height):e.top-l.top},BE):null}const c=function(e,t,n){const o=e[t],r=e[t-1],i=e[t+1];if(!o)return 0;if(n<t)return r?o.top-(r.top+r.height):i?i.top-(o.top+o.height):0;return i?i.top-(o.top+o.height):r?o.top-(r.top+r.height):0}(i,r,n);return a(r>n&&r<=s?{x:0,y:-l.height-c}:r<n&&r>=s?{x:0,y:l.height+c}:{x:0,y:0},BE)};const HE="Sortable",$E=e.createContext({activeIndex:-1,containerId:HE,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:LE,disabled:{draggable:!1,droppable:!1}});function WE(t){let{children:n,id:o,items:r,strategy:i=LE,disabled:s=!1}=t;const{active:a,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=PE(),h=BC(HE,o),f=Boolean(null!==l.rect),p=(0,e.useMemo)(()=>r.map(e=>"object"===typeof e&&"id"in e?e.id:e),[r]),m=null!=a,g=a?p.indexOf(a.id):-1,v=u?p.indexOf(u.id):-1,y=(0,e.useRef)(p),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(p,y.current),x=-1!==v&&-1===g||b,w=function(e){return"boolean"===typeof e?{draggable:e,droppable:e}:e}(s);jC(()=>{b&&m&&d(p)},[b,p,m,d]),(0,e.useEffect)(()=>{y.current=p},[p]);const k=(0,e.useMemo)(()=>({activeIndex:g,containerId:h,disabled:w,disableTransforms:x,items:p,overIndex:v,useDragOverlay:f,sortedRects:FE(p,c),strategy:i}),[g,h,w.draggable,w.droppable,x,p,v,c,f,i]);return e.createElement($E.Provider,{value:k},n)}const UE=e=>{let{id:t,items:n,activeIndex:o,overIndex:r}=e;return RE(n,o,r).indexOf(t)},qE=e=>{let{containerId:t,isSorting:n,wasDragging:o,index:r,items:i,newIndex:s,previousItems:a,previousContainerId:l,transition:c}=e;return!(!c||!o)&&((a===i||r!==s)&&(!!n||s!==r&&t===l))},KE={duration:200,easing:"ease"},YE="transform",XE=qC.Transition.toString({property:YE,duration:0,easing:"linear"}),ZE={roleDescription:"sortable"};function GE(t){let{animateLayoutChanges:n=qE,attributes:o,disabled:r,data:i,getNewIndex:s=UE,id:l,strategy:c,resizeObserverConfig:u,transition:d=KE}=t;const{items:h,containerId:f,activeIndex:p,disabled:m,disableTransforms:g,sortedRects:v,overIndex:y,useDragOverlay:b,strategy:x}=(0,e.useContext)($E),w=function(e,t){var n,o;if("boolean"===typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(o=null==e?void 0:e.droppable)?o:t.droppable}}(r,m),k=h.indexOf(l),C=(0,e.useMemo)(()=>a({sortable:{containerId:f,index:k,items:h}},i),[f,i,k,h]),S=(0,e.useMemo)(()=>h.slice(h.indexOf(l)),[h,l]),{rect:E,node:D,isOver:M,setNodeRef:N}=function(t){let{data:n,disabled:o=!1,id:r,resizeObserverConfig:i}=t;const s=BC("Droppable"),{active:l,dispatch:c,over:u,measureDroppableContainers:d}=(0,e.useContext)(kE),h=(0,e.useRef)({disabled:o}),f=(0,e.useRef)(!1),p=(0,e.useRef)(null),m=(0,e.useRef)(null),{disabled:g,updateMeasurementsFor:v,timeout:y}=a(a({},IE),i),b=IC(null!=v?v:r),x=lE({callback:(0,e.useCallback)(()=>{f.current?(null!=m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),m.current=null},y)):f.current=!0},[y]),disabled:g||!l}),w=(0,e.useCallback)((e,t)=>{x&&(t&&(x.unobserve(t),f.current=!1),e&&x.observe(e))},[x]),[k,C]=FC(w),S=IC(n);return(0,e.useEffect)(()=>{x&&k.current&&(x.disconnect(),f.current=!1,x.observe(k.current))},[k,x]),(0,e.useEffect)(()=>(c({type:rS.RegisterDroppable,element:{id:r,key:s,disabled:o,node:k,rect:p,data:S}}),()=>c({type:rS.UnregisterDroppable,key:s,id:r})),[r]),(0,e.useEffect)(()=>{o!==h.current.disabled&&(c({type:rS.SetDroppableDisabled,id:r,key:s,disabled:o}),h.current.disabled=o)},[r,s,o,c]),{active:l,rect:p,isOver:(null==u?void 0:u.id)===r,node:k,over:u,setNodeRef:C}}({id:l,data:C,disabled:w.droppable,resizeObserverConfig:a({updateMeasurementsFor:S},u)}),{active:A,activatorEvent:O,activeNodeRect:T,attributes:_,setNodeRef:j,listeners:P,isDragging:I,over:R,setActivatorNodeRef:F,transform:z}=jE({id:l,data:C,attributes:a(a({},ZE),o),disabled:w.draggable}),L=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(0,e.useMemo)(()=>e=>{n.forEach(t=>t(e))},n)}(N,j),B=Boolean(A),V=B&&!g&&zE(p)&&zE(y),H=!b&&I,$=H&&V?z:null,W=V?null!=$?$:(null!=c?c:x)({rects:v,activeNodeRect:T,activeIndex:p,overIndex:y,index:k}):null,U=zE(p)&&zE(y)?s({id:l,items:h,activeIndex:p,overIndex:y}):k,q=null==A?void 0:A.id,K=(0,e.useRef)({activeId:q,items:h,newIndex:U,containerId:f}),Y=h!==K.current.items,X=n({active:A,containerId:f,isDragging:I,isSorting:B,id:l,index:k,items:h,newIndex:K.current.newIndex,previousItems:K.current.items,previousContainerId:K.current.containerId,transition:d,wasDragging:null!=K.current.activeId}),Z=function(t){let{disabled:n,index:o,node:r,rect:i}=t;const[s,a]=(0,e.useState)(null),l=(0,e.useRef)(o);return jC(()=>{if(!n&&o!==l.current&&r.current){const e=i.current;if(e){const t=bS(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&a(n)}}o!==l.current&&(l.current=o)},[n,o,r,i]),(0,e.useEffect)(()=>{s&&a(null)},[s]),s}({disabled:!X,index:k,node:D,rect:E});return(0,e.useEffect)(()=>{B&&K.current.newIndex!==U&&(K.current.newIndex=U),f!==K.current.containerId&&(K.current.containerId=f),h!==K.current.items&&(K.current.items=h)},[B,U,f,h]),(0,e.useEffect)(()=>{if(q===K.current.activeId)return;if(null!=q&&null==K.current.activeId)return void(K.current.activeId=q);const e=setTimeout(()=>{K.current.activeId=q},50);return()=>clearTimeout(e)},[q]),{active:A,activeIndex:p,attributes:_,data:C,rect:E,index:k,newIndex:U,items:h,isOver:M,isSorting:B,isDragging:I,listeners:P,node:D,overIndex:y,over:R,setNodeRef:L,setActivatorNodeRef:F,setDroppableNodeRef:N,setDraggableNodeRef:j,transform:null!=Z?Z:W,transition:function(){if(Z||Y&&K.current.newIndex===k)return XE;if(H&&!WC(O)||!d)return;if(B||X)return qC.Transition.toString(a(a({},d),{},{property:YE}));return}()}}BS.Down,BS.Right,BS.Up,BS.Left;function JE(e){let{userId:t,onUpload:n,onUploadStart:o,onUploadEnd:r}=e;return(0,c.jsxs)("label",{className:"modal-button primary",style:{cursor:"pointer",display:"inline-block"},children:["\ud83d\udcce \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430",(0,c.jsx)("input",{type:"file",style:{display:"none"},onChange:async e=>{const i=e.target.files[0];if(!i)return;const s=new FormData;s.append("file",i),s.append("user_id",t),o&&o();try{const e=await fetch("/api/upload_media",{method:"POST",body:s}),t=await e.json();e.ok&&t.file_id?n(t):alert(t.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 Telegram")}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430:",a),alert("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430. \u0421\u043c. \u043a\u043e\u043d\u0441\u043e\u043b\u044c.")}finally{r&&r(),e.target.value=null}},accept:"image/*,video/*,audio/*,.gif"})]})}const QE=t=>{let{item:n}=t;const o=(0,e.useMemo)(()=>"/api/tgfile/".concat(n.file_id),[n.file_id]),r={width:"60px",height:"60px",borderRadius:"4px",objectFit:"cover",backgroundColor:"#2a2a2a",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"};switch(n.type){case"photo":return(0,c.jsx)("img",{src:o,alt:"preview",style:r});case"video":return(0,c.jsx)("video",{src:o,style:r,playsInline:!0,muted:!0,loop:!0});case"animation":return(0,c.jsx)("video",{src:o,style:r,autoPlay:!0,playsInline:!0,muted:!0,loop:!0});case"audio":return(0,c.jsx)("div",{style:r,children:"\ud83c\udfb5"});default:return(0,c.jsx)("div",{style:r,children:"\u2753"})}};function eD(e){let{item:t,onDelete:n}=e;const{attributes:o,listeners:r,setNodeRef:i,transform:s,transition:l}=GE({id:t.file_id}),u={transform:qC.Transform.toString(s),transition:l,display:"flex",alignItems:"center",justifyContent:"space-between",background:"#3a3a3a",padding:"10px",borderRadius:"8px",gap:"15px",touchAction:"none"};return(0,c.jsxs)("li",a(a({ref:i,style:u},o),{},{children:[(0,c.jsx)("span",a(a({},r),{},{style:{cursor:"grab",color:"white",padding:"0 5px",userSelect:"none"},title:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a",children:"\u2630"})),(0,c.jsx)("div",a(a({},r),{},{style:{cursor:"grab"},children:(0,c.jsx)(QE,{item:t})})),(0,c.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",gap:"5px"},children:[(0,c.jsx)("span",{style:{textTransform:"capitalize",fontWeight:"bold"},children:t.type}),(0,c.jsx)("span",{style:{fontFamily:"monospace",fontSize:"0.8rem",color:"#aaa",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:t.file_id})]}),(0,c.jsx)("button",{className:"modal-button danger",style:{padding:"5px 10px"},onClick:n,children:"\ud83d\uddd1\ufe0f"})]}))}function tD(t){let{node:n,onUpdate:o,onClose:r,userId:i,storyId:s}=t;const[a,l]=(0,e.useState)(n.data.fragment.media||[]),[u,d]=(0,e.useState)(!1),[h,f]=(0,e.useState)(!1),p=(0,e.useCallback)(async e=>{try{await vC(i,s,n.id,e),o(e)}catch(t){console.error("Failed to save media order:",t),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043c\u0435\u0434\u0438\u0430: ".concat(t.message)),l(a)}},[i,s,n.id,o,a]),m=(0,e.useCallback)(async e=>{if(a.length>=10)return void alert("\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 10 \u043c\u0435\u0434\u0438\u0430.");const t=[...a,e];try{await vC(i,s,n.id,t),l(t),o(t)}catch(r){console.error("Failed to add media:",r),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430: ".concat(r.message))}},[a,i,s,n.id,o]),g=(0,e.useCallback)(async e=>{const t=a.filter((t,n)=>n!==e);try{await vC(i,s,n.id,t),l(t),o(t)}catch(r){console.error("Failed to delete media:",r),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0434\u0438\u0430: ".concat(r.message))}},[a,i,s,n.id,o]),v=a.map(e=>e.file_id);return(0,c.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault(),f(!0)},onDragLeave:()=>f(!1),onDrop:async e=>{e.preventDefault(),f(!1);const t=Array.from(e.dataTransfer.files).slice(0,10-a.length);for(const o of t){if(a.length>=10)return void alert("\u041d\u0435\u043b\u044c\u0437\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 10 \u043c\u0435\u0434\u0438\u0430.");const e=new FormData;e.append("file",o),e.append("user_id",i),d(!0);try{const t=await fetch("/api/upload_media",{method:"POST",body:e}),n=await t.json();t.ok&&n.file_id?await m(n):alert(n.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 Telegram")}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430:",n),alert("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u0430. \u0421\u043c. \u043a\u043e\u043d\u0441\u043e\u043b\u044c.")}finally{d(!1)}}},style:{gap:"20px",border:h?"2px dashed #888":"none"},children:[(0,c.jsxs)("h3",{children:['\u041c\u0435\u0434\u0438\u0430 \u0434\u043b\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 "',n.id,'"']}),(0,c.jsx)("div",{style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"10px"},children:0===a.length?(0,c.jsx)("p",{children:"\u041c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442. \u0412\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u044d\u0442\u043e \u043e\u043a\u043d\u043e."}):(0,c.jsx)(OE,{collisionDetection:dS,onDragEnd:e=>{const{active:t,over:n}=e;t.id!==n.id&&l(e=>{const o=e.findIndex(e=>e.file_id===t.id),r=e.findIndex(e=>e.file_id===n.id),i=RE(e,o,r);return p(i),i})},children:(0,c.jsx)(WE,{items:v,strategy:VE,children:(0,c.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"10px"},children:a.map((e,t)=>(0,c.jsx)(eD,{item:e,onDelete:()=>g(t)},e.file_id))})})})}),(0,c.jsxs)("div",{className:"modal-actions",style:{justifyContent:"space-between"},children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:r,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),u?(0,c.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,c.jsx)(JE,{userId:i,onUpload:m,onUploadStart:()=>d(!0),onUploadEnd:()=>d(!1)})]})]})})}const nD=function(t){var n;let{node:o,onClose:r,onUpdateMedia:i,onUpdateChoices:s}=t;const{fragment:a}=o.data,[l,u]=(0,e.useState)(a.media||[]),[d,h]=(0,e.useState)(a.choices||[]),f=(0,e.useRef)(null),p=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText="\n.preview-modal-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.preview-modal-content {\n    background: #282c34;\n    color: white;\n    padding: 20px;\n    border-radius: 8px;\n    width: 90%;\n    max-width: 500px;\n    max-height: 90vh;\n    overflow-y: auto;\n    border: 1px solid #444;\n}\n\n.preview-modal-content h3, .preview-modal-content h4 {\n    margin-top: 0;\n    border-bottom: 1px solid #555;\n    padding-bottom: 8px;\n    margin-bottom: 12px;\n}\n\n.preview-section {\n    margin-bottom: 20px;\n}\n\n.draggable-list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.draggable-item {\n    display: flex;\n    align-items: center;\n    padding: 8px;\n    background-color: #3a3f4a;\n    border: 1px solid #555;\n    border-radius: 4px;\n    cursor: grab;\n    user-select: none;\n    justify-content: space-between; /* \u041d\u043e\u0432\u043e\u0435 */\n}\n\n.draggable-content {\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n    gap: 10px;\n}\n\n.sort-hint {\n    font-size: 0.85em;\n    color: #aaa;\n    white-space: nowrap;\n    margin-left: 10px;\n}\n\n.draggable-item.dragging {\n    opacity: 0.5;\n    border: 1px dashed #fff;\n}\n\n.drag-handle {\n    margin-right: 12px;\n    font-size: 1.2em;\n    color: #888;\n}\n\n.media-preview-img {\n    width: 40px;\n    height: 40px;\n    object-fit: cover;\n    border-radius: 4px;\n    margin-right: 10px;\n}\n\n.text-preview {\n    background-color: #1e1e1e;\n    padding: 10px;\n    border-radius: 4px;\n    white-space: pre-wrap; /* \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u044b \u0441\u0442\u0440\u043e\u043a */\n    word-wrap: break-word;\n    max-height: 200px;\n    overflow-y: auto;\n    border: 1px solid #555;\n    line-height: 1.5; /* \u0423\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0447\u0438\u0442\u0430\u0435\u043c\u043e\u0441\u0442\u044c */\n}\n\n/* \u2728 \u041d\u0410\u0427\u0410\u041b\u041e: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u2728 */\n.text-preview a {\n  color: #87CEFA; /* Light Sky Blue */\n  text-decoration: none;\n}\n.text-preview a:hover {\n  text-decoration: underline;\n}\n\n.text-preview code {\n  font-family: 'Courier New', Courier, monospace;\n  background-color: #3a3f4a;\n  padding: 2px 5px;\n  border-radius: 4px;\n  font-size: 0.9em;\n  border: 1px solid #555;\n}\n\n.text-preview pre {\n  background-color: #1a1c20;\n  border: 1px solid #555;\n  padding: 10px;\n  border-radius: 4px;\n  white-space: pre-wrap;\n  word-break: break-all;\n  margin: 8px 0;\n  font-family: 'Courier New', Courier, monospace;\n  font-size: 0.9em;\n}\n\n.text-preview blockquote {\n  margin: 8px 0 8px 10px;\n  padding-left: 12px;\n  border-left: 3px solid #666;\n  color: #ccc;\n}\n\n.text-preview .tg-spoiler {\n    background-color: #888;\n    color: #888;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: all 0.15s ease-in-out;\n}\n\n.text-preview .tg-spoiler:hover {\n    background-color: #999;\n    color: #999;\n}\n\n.text-preview .tg-spoiler.revealed {\n    background-color: transparent;\n    color: inherit; /* \u041d\u0430\u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u0446\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f */\n}\n/* \u2728 \u041a\u041e\u041d\u0415\u0426: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u2728 */\n\n.telegram-button-preview {\n    width: 100%;\n    padding: 10px;\n    text-align: center;\n    background-color: #4a76a8;\n    color: white;\n    border-radius: 5px;\n    font-size: 1em;\n    border: none;\n}\n\n.modal-actions {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 20px;\n}\n",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const m=e=>{e.currentTarget.classList.remove("dragging"),f.current=null,i(l)},g=e=>{e.currentTarget.classList.remove("dragging"),p.current=null,s(d)},v=(e,t)=>{switch(e.type){case"photo":return(0,c.jsx)("img",{src:"/api/tgfile/".concat(e.file_id),alt:"preview",className:"media-preview-img"});case"video":return(0,c.jsxs)("span",{children:["\ud83c\udfac \u0412\u0438\u0434\u0435\u043e_",t+1]});case"animation":return(0,c.jsxs)("span",{children:["\ud83c\udf9e\ufe0f \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f_",t+1]});case"audio":return(0,c.jsxs)("span",{children:["\ud83c\udfb5 \u0410\u0443\u0434\u0438\u043e_",t+1]});default:return(0,c.jsx)("span",{children:"\u2753 \u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0442\u0438\u043f"})}};return(0,c.jsx)("div",{className:"preview-modal-overlay",onClick:r,children:(0,c.jsxs)("div",{className:"preview-modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h3",{children:["\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440: ",o.id]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u041c\u0435\u0434\u0438\u0430"}),(0,c.jsxs)("div",{className:"draggable-list",children:[l.map((e,t)=>(0,c.jsxs)("div",{className:"draggable-item",draggable:!0,onDragStart:e=>((e,t)=>{f.current=t,e.dataTransfer.effectAllowed="move",e.currentTarget.classList.add("dragging")})(e,t),onDragEnter:e=>((e,t)=>{if(f.current===t)return;const n=[...l],o=n.splice(f.current,1)[0];n.splice(t,0,o),f.current=t,u(n)})(0,t),onDragEnd:m,onDragOver:e=>e.preventDefault(),children:[(0,c.jsxs)("div",{className:"draggable-content",children:[(0,c.jsx)("span",{className:"drag-handle",children:"\u283f"}),v(e,t)]}),(0,c.jsx)("span",{className:"sort-hint",children:"\u0423\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u043b\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438"})]},e.file_id)),0===l.length&&(0,c.jsx)("p",{children:(0,c.jsx)("i",{children:"\u041c\u0435\u0434\u0438\u0430\u0444\u0430\u0439\u043b\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442."})})]})]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u0422\u0435\u043a\u0441\u0442"}),(0,c.jsx)("div",{className:"text-preview",onClick:e=>{const t=e.target.closest(".tg-spoiler");t&&t.classList.toggle("revealed")},dangerouslySetInnerHTML:{__html:(null===(n=a.text)||void 0===n?void 0:n.replace(/\n/g,"<br />"))||"<i>\u0422\u0435\u043a\u0441\u0442 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442.</i>"}})]}),(0,c.jsxs)("div",{className:"preview-section",children:[(0,c.jsx)("h4",{children:"\u041a\u043d\u043e\u043f\u043a\u0438"}),(0,c.jsxs)("div",{className:"draggable-list",children:[d.map((e,t)=>(0,c.jsx)("div",{className:"draggable-item",draggable:!0,onDragStart:e=>((e,t)=>{p.current=t,e.dataTransfer.effectAllowed="move",e.currentTarget.classList.add("dragging")})(e,t),onDragEnter:e=>((e,t)=>{if(p.current===t)return;const n=[...d],o=n.splice(p.current,1)[0];n.splice(t,0,o),p.current=t,h(n)})(0,t),onDragEnd:g,onDragOver:e=>e.preventDefault(),children:(0,c.jsxs)("div",{className:"draggable-content",children:[(0,c.jsx)("span",{className:"drag-handle",children:"\u283f"}),(0,c.jsx)("div",{className:"telegram-button-preview",children:e.text})]})},"".concat(e.target,"-").concat(e.text))),0===d.length&&(0,c.jsx)("p",{children:(0,c.jsx)("i",{children:"\u041a\u043d\u043e\u043f\u043a\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442."})})]})]}),(0,c.jsx)("div",{className:"modal-actions",children:(0,c.jsx)("button",{onClick:r,className:"modal-button primary",children:"\u0413\u043e\u0442\u043e\u0432\u043e"})})]})})},oD='\n\n/* =========================================\n   1. \u0413\u041b\u041e\u0411\u0410\u041b\u042c\u041d\u042b\u0415 \u0421\u0422\u0418\u041b\u0418 \u0418 \u0424\u0418\u041a\u0421\u042b\n   (\u041e\u0432\u0435\u0440\u043b\u0435\u0439, \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0444\u043e\u043d\u0430, z-index)\n   ========================================= */\n\n/* \u0417\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u043d\u044b\u0439 \u0444\u043e\u043d \u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d */\n.modal-overlay {\n  position: fixed;\n  top: 0; left: 0; right: 0; bottom: 0;\n  background-color: rgba(0, 0, 0, 0.75); /* \u0426\u0432\u0435\u0442 \u0437\u0430\u0442\u0435\u043c\u043d\u0435\u043d\u0438\u044f */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000; /* \u041f\u043e\u0432\u0435\u0440\u0445 \u0432\u0441\u0435\u0433\u043e */\n  padding: 1rem;\n  backdrop-filter: blur(2px); /* \u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435 \u0437\u0430\u0434\u043d\u0435\u0433\u043e \u043f\u043b\u0430\u043d\u0430 */\n}\n\n/* \u0424\u0438\u043a\u0441 \u0434\u043b\u044f React Flow, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043c\u0435\u0448\u0430\u043b \u043a\u043b\u0438\u043a\u0430\u043c \u0432 \u043c\u043e\u0434\u0430\u043b\u043a\u0435 */\n.react-flow__pane {\n    pointer-events: none !important;\n    user-select: none !important;\n}\n\n/* \u0421\u043a\u0440\u044b\u0442\u044b\u0439 \u043c\u0430\u0440\u043a\u0435\u0440 (\u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c) */\n#cursor-marker { display: none; }\n\n\n/* =========================================\n   2. \u041c\u041e\u0414\u0410\u041b\u042c\u041d\u041e\u0415 \u041e\u041a\u041d\u041e (\u041a\u041e\u041d\u0422\u0415\u0419\u041d\u0415\u0420)\n   (\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0432\u0438\u0434 \u0441\u0430\u043c\u043e\u0433\u043e \u043e\u043a\u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430)\n   ========================================= */\n\n.modal-content {\n  background: #252525;         /* \u0426\u0432\u0435\u0442 \u0444\u043e\u043d\u0430 \u043e\u043a\u043d\u0430 */\n  color: #f0f0f0;              /* \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0446\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 */\n  padding: 20px;               /* \u041e\u0442\u0441\u0442\u0443\u043f\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u043a\u043d\u0430 */\n  border-radius: 16px;         /* \u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u0443\u0433\u043b\u043e\u0432 */\n  width: 100%;\n  max-width: 1100px;            /* \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0448\u0438\u0440\u0438\u043d\u0430 \u043d\u0430 \u041f\u041a */\n  max-height: 90vh;            /* \u041d\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 \u0432\u044b\u0441\u043e\u0442\u044b \u044d\u043a\u0440\u0430\u043d\u0430 */\n  box-shadow: 0 10px 25px rgba(0,0,0,0.5); /* \u0422\u0435\u043d\u044c */\n  display: flex;\n  flex-direction: column;\n  gap: 15px;                   /* \u041e\u0442\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u0440\u0443\u0433 \u043e\u0442 \u0434\u0440\u0443\u0433\u0430 */\n  border: 1px solid #3a3a3a;   /* \u0422\u043e\u043d\u043a\u0430\u044f \u0440\u0430\u043c\u043a\u0430 */\n}\n\n/* \u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u043e\u0433\u043e \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043a\u043d\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0434\u043b\u044f \u0442\u0430\u0439\u043c\u0435\u0440\u0430) */\n.modal-content.small {\n  max-width: 400px;\n  padding: 15px;\n}\n\n/* \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 \u0432\u043d\u0443\u0442\u0440\u0438 \u043c\u043e\u0434\u0430\u043b\u043a\u0438 */\n.modal-content h3 {\n  margin: 0 0 5px 0;\n  font-size: 1.1rem;\n  color: #ddd;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n/* \u041f\u0430\u0440\u0430\u0433\u0440\u0430\u0444\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043c\u043e\u0434\u0430\u043b\u043a\u0438 */\n.modal-content p {\n    margin: 5px 0;\n}\n\n/* \u0411\u043b\u043e\u043a \u0441 \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438 "\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c/\u041e\u0442\u043c\u0435\u043d\u0430" \u0432\u043d\u0438\u0437\u0443 */\n.modal-actions {\n  display: flex;\n  justify-content: space-between; /* \u0413\u043b\u0430\u0432\u043d\u043e\u0435: \u0440\u0430\u0437\u043d\u043e\u0441\u0438\u043c \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043f\u043e \u043a\u0440\u0430\u044f\u043c */\n  align-items: center;            /* \u0426\u0435\u043d\u0442\u0440\u0438\u0440\u0443\u0435\u043c \u0438\u0445 \u043f\u043e \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u0438 */\n  margin-top: auto;               /* \u041f\u0440\u0438\u0436\u0430\u0442\u044c \u043a \u043d\u0438\u0437\u0443 */\n  width: 100%;                    /* \u041d\u0430 \u0432\u0441\u044e \u0448\u0438\u0440\u0438\u043d\u0443 */\n  padding-top: 10px;              /* \u041d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0442\u0441\u0442\u0443\u043f \u043e\u0442 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 */\n}\n\n/* \u041e\u0431\u0435\u0440\u0442\u043a\u0430 \u0434\u043b\u044f \u043a\u043d\u043e\u043f\u043e\u043a, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u0434\u0435\u0440\u0436\u0430\u043b\u0438\u0441\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441\u043f\u0440\u0430\u0432\u0430 */\n.modal-buttons-group {\n  display: flex;\n  gap: 12px;\n}\n\n\n\n/* \u041e\u0431\u0449\u0438\u0435 \u0441\u0442\u0438\u043b\u0438 \u043a\u043d\u043e\u043f\u043e\u043a \u043c\u043e\u0434\u0430\u043b\u043a\u0438 (\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c/\u041e\u0442\u043c\u0435\u043d\u0430) */\n.modal-button {\n  padding: 10px 24px;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 0.95rem;\n  transition: filter 0.2s;\n}\n\n/* \u0426\u0432\u0435\u0442\u0430 \u043a\u043d\u043e\u043f\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 */\n.modal-button.primary { background-color: #007bff; color: white; }\n.modal-button.primary:hover { background-color: #0056b3; }\n\n.modal-button.secondary { background-color: #6c757d; color: white; }\n.modal-button.secondary:hover { background-color: #5a6268; }\n\n.modal-button.danger { background-color: #dc3545; color: white; }\n.modal-button.danger:hover { background-color: #c82333; }\n\n/* \u0410\u0434\u0430\u043f\u0442\u0438\u0432 \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043a\u043d\u0430 \u0434\u043b\u044f \u041e\u0427\u0415\u041d\u042c \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0445 \u044d\u043a\u0440\u0430\u043d\u043e\u0432 */\n@media (max-width: 360px) {\n  .modal-content {\n    padding: 10px;\n  }\n}\n@media (max-width: 768px) {\n    .modal-content { padding: 10px; gap: 8px; }\n}\n@media (min-width: 768px) {\n  .toolbar-button img {\n    width: 125% !important;\n    height: 125% !important;\n  }\n}\n\n/* =========================================\n   3. \u0422\u0423\u041b\u0411\u0410\u0420 (\u041f\u0410\u041d\u0415\u041b\u042c \u0418\u041d\u0421\u0422\u0420\u0423\u041c\u0415\u041d\u0422\u041e\u0412)\n   (\u0421\u0435\u0442\u043a\u0430, \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f \u043a\u043d\u043e\u043f\u043e\u043a)\n   ========================================= */\n\n.toolbar-container {\n  display: flex;\n  flex-direction: column; /* Mobile First: \u043a\u043d\u043e\u043f\u043a\u0438 \u0432 2 \u0441\u0442\u0440\u043e\u043a\u0438 */\n  gap: 8px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #3a3a3a;\n}\n\n/* \u0413\u0440\u0443\u043f\u043f\u044b \u043a\u043d\u043e\u043f\u043e\u043a \u0432\u043d\u0443\u0442\u0440\u0438 \u0442\u0443\u043b\u0431\u0430\u0440\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, [\u0416\u0438\u0440\u043d\u044b\u0439, \u041a\u0443\u0440\u0441\u0438\u0432] [\u0422\u0430\u0439\u043c\u0435\u0440, \u0410\u0442\u0440\u0438\u0431\u0443\u0442]) */\n.toolbar-group {\n  display: flex;\n  flex-wrap: wrap; /* \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u043d\u0430 \u043e\u0447\u0435\u043d\u044c \u0443\u0437\u043a\u0438\u0445 \u044d\u043a\u0440\u0430\u043d\u0430\u0445 */\n  gap: 4px;\n  align-items: center;\n}\n\n/* \u0422\u043e\u043d\u043a\u0430\u044f \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0447\u0435\u0440\u0442\u0430 \u043c\u0435\u0436\u0434\u0443 \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438 \u043e\u0434\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b */\n.toolbar-separator {\n  width: 1px;\n  height: 24px;\n  background-color: #444;\n  margin: 0 4px;\n  flex-shrink: 0;\n}\n\n/* \u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \u043c\u0435\u0436\u0434\u0443 \u0413\u0420\u0423\u041f\u041f\u0410\u041c\u0418 (\u0432\u0435\u0440\u0445\u043d\u0435\u0439 \u0438 \u043d\u0438\u0436\u043d\u0435\u0439 \u0441\u0442\u0440\u043e\u043a\u043e\u0439 \u043d\u0430 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u0435) */\n.group-separator {\n  display: none; /* \u0421\u043a\u0440\u044b\u0442 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c */\n  width: 1px;\n  height: 28px;\n  background-color: #555;\n  margin: 0 8px;\n}\n\n/* -- \u0410\u0414\u0410\u041f\u0422\u0418\u0412 \u0422\u0423\u041b\u0411\u0410\u0420\u0410 -- */\n\n/* \u041f\u043b\u0430\u043d\u0448\u0435\u0442\u044b \u0438 \u0414\u0435\u0441\u043a\u0442\u043e\u043f\u044b (>= 768px): \u0432\u044b\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c \u0432\u0441\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u043a\u0443 */\n@media (min-width: 768px) {\n    .toolbar-container {\n        flex-direction: row;\n        align-items: center;\n        justify-content: space-between;\n        flex-wrap: wrap;\n    }\n    .toolbar-group {\n        flex-wrap: nowrap;\n    }\n    .group-separator {\n        display: block; /* \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \u0433\u0440\u0443\u043f\u043f */\n    }\n      /* \u041d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0438\u043a\u043e\u043d\u043a\u0438 \u0434\u0435\u043b\u0430\u0435\u043c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043d\u043e\u043f\u043a\u0438 */\n      .toolbar-button img {\n        width: 125% !important;\n        height: 125% !important;\n      }\n\n}\n\n\n/* =========================================\n   4. \u041a\u041d\u041e\u041f\u041a\u0418 \u0422\u0423\u041b\u0411\u0410\u0420\u0410 (\u0418\u041a\u041e\u041d\u041a\u0418)\n   (\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0432\u0438\u0434, \u0440\u0430\u0437\u043c\u0435\u0440\u044b, \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f)\n   ========================================= */\n\n.toolbar-button {\n  /* \u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u0430\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 */\n  width: clamp(32px, 3.5vw, 40px);\n  height: clamp(32px, 3.5vw, 40px);\n  \n  background-color: #333;\n  color: #f0f0f0;\n  border: 1px solid #444;\n  border-radius: 8px; /* \u0424\u043e\u0440\u043c\u0430 \u043a\u043d\u043e\u043f\u043a\u0438 (\u043c\u044f\u0433\u043a\u0438\u0439 \u043a\u0432\u0430\u0434\u0440\u0430\u0442) */\n  \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  \n  cursor: pointer;\n  transition: all 0.2s ease;\n  touch-action: manipulation;\n  user-select: none;\n  position: relative;\n}\n\n/* \u0418\u043a\u043e\u043d\u043a\u0438 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043d\u043e\u043f\u043e\u043a (SVG) */\n.toolbar-button img {\n    width: 85%;  /* \u0420\u0430\u0437\u043c\u0435\u0440 \u0438\u043a\u043e\u043d\u043a\u0438 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043a\u043d\u043e\u043f\u043a\u0438 */\n    height: 85%; \n    object-fit: contain;\n    opacity: 0.9;\n    transition: transform 0.2s;\n}\n\n/* -- \u0421\u041e\u0421\u0422\u041e\u042f\u041d\u0418\u042f \u041a\u041d\u041e\u041f\u041e\u041a -- */\n\n.toolbar-button:hover {\n  background-color: #444;\n  border-color: #555;\n  transform: translateY(-1px); /* \u041b\u0435\u0433\u043a\u0438\u0439 \u043f\u043e\u0434\u044a\u0435\u043c \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 */\n}\n.toolbar-button:hover img {\n  opacity: 1;\n}\n.toolbar-button:active {\n  transform: translateY(1px); /* \u041d\u0430\u0436\u0430\u0442\u0438\u0435 */\n}\n/* \u0410\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u043a\u043d\u043e\u043f\u043a\u0430 (\u0432\u043a\u043b\u044e\u0447\u0435\u043d \u0436\u0438\u0440\u043d\u044b\u0439 \u0438 \u0442.\u0434.) */\n.toolbar-button.active {\n  background-color: #007bff !important;\n  border-color: #0069d9 !important;\n  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.4);\n}\n.toolbar-button.active img {\n  filter: brightness(0) invert(1); /* \u0414\u0435\u043b\u0430\u0435\u043c \u0438\u043a\u043e\u043d\u043a\u0443 \u0431\u0435\u043b\u043e\u0439 */\n}\n/* \u041d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u0430\u044f (disabled) \u043a\u043d\u043e\u043f\u043a\u0430 */\n.toolbar-button:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n  transform: none;\n}\n\n/* -- \u0420\u0410\u0417\u041c\u0415\u0420\u042b \u041a\u041d\u041e\u041f\u041e\u041a (\u0422\u041e\u041d\u041a\u0410\u042f \u041d\u0410\u0421\u0422\u0420\u041e\u0419\u041a\u0410) -- */\n\n/* 1) \u0412\u0415\u0420\u0425\u041d\u042f\u042f \u0413\u0420\u0423\u041f\u041f\u0410 (Formatting) - \u0414\u0435\u043b\u0430\u0435\u043c \u0438\u0445 \u041a\u0420\u0423\u041f\u041d\u0415\u0415 */\n.toolbar-container .toolbar-group:first-of-type .toolbar-button {\n    width: clamp(41px, 5vw, 46px);\n    height: clamp(41px, 5vw, 46px);\n}\n\n/* 2) \u041d\u0418\u0416\u041d\u042f\u042f \u0413\u0420\u0423\u041f\u041f\u0410 (Actions) - \u0414\u0435\u043b\u0430\u0435\u043c \u0438\u0445 \u041c\u0415\u041d\u042c\u0428\u0415 */\n.toolbar-container .toolbar-group:last-of-type .toolbar-button {\n    width: clamp(35px, 3.5vw, 46px);\n    height: clamp(35px, 3.5vw, 46px);\n}\n\n\n/* -- \u041c\u041e\u0411\u0418\u041b\u042c\u041d\u042b\u0415 \u0420\u0410\u0417\u041c\u0415\u0420\u042b \u041a\u041d\u041e\u041f\u041e\u041a -- */\n@media (max-width: 480px) {\n  /* \u041f\u0440\u0438\u0432\u043e\u0434\u0438\u043c \u043a \u0441\u0440\u0435\u0434\u043d\u0435\u043c\u0443 \u0440\u0430\u0437\u043c\u0435\u0440\u0443, \u0447\u0442\u043e\u0431\u044b \u043f\u0430\u043b\u044c\u0446\u0435\u043c \u0431\u044b\u043b\u043e \u0443\u0434\u043e\u0431\u043d\u043e */\n  .toolbar-button {\n    width: 42px !important;\n    height: 42px !important;\n  }\n\n  /* \u041d\u0438\u0436\u043d\u0438\u0439 \u0440\u044f\u0434 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0447\u0443\u0442\u044c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u043d\u043e\u0433\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0430 */\n  .toolbar-container .toolbar-group:first-of-type .toolbar-button {\n      width: 45px !important;\n      height: 45px !important;\n  }\n  \n  /* \u041d\u0438\u0436\u043d\u0438\u0439 \u0440\u044f\u0434 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0447\u0443\u0442\u044c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u043d\u043e\u0433\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0430 */\n  .toolbar-container .toolbar-group:last-of-type .toolbar-button {\n      width: 35px !important;\n      height: 35px !important;\n  }\n\n  /* \u041d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0438\u043a\u043e\u043d\u043a\u0438 \u0434\u0435\u043b\u0430\u0435\u043c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043d\u043e\u043f\u043a\u0438 */\n  .toolbar-button img {\n    width: 95% !important;\n    height: 95% !important;\n  }\n}\n\n/* \u041c\u0438\u043a\u0440\u043e-\u044d\u043a\u0440\u0430\u043d\u044b (\u0441\u0442\u0430\u0440\u044b\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u044b) */\n@media (max-width: 360px) {\n  .toolbar-button {\n    width: 34px; \n    height: 34x;\n    border-radius: 6px;\n  }\n\n  /* \u041d\u0438\u0436\u043d\u0438\u0439 \u0440\u044f\u0434 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0447\u0443\u0442\u044c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u043d\u043e\u0433\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0430 */\n  .toolbar-container .toolbar-group:first-of-type .toolbar-button {\n      width: 39px !important;\n      height: 39px !important;\n  }\n  \n  /* \u041d\u0438\u0436\u043d\u0438\u0439 \u0440\u044f\u0434 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0447\u0443\u0442\u044c \u043a\u0440\u0443\u043f\u043d\u0435\u0435 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u043d\u043e\u0433\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0430 */\n  .toolbar-container .toolbar-group:last-of-type .toolbar-button {\n      width: 32px !important;\n      height: 32px !important;\n  }  \n  .toolbar-separator {\n    margin: 0 1px;\n  }\n  .toolbar-button img {\n    width: 110% !important;\n    height: 110% !important;\n  }\n}\n\n\n/* =========================================\n   5. \u041e\u0411\u041b\u0410\u0421\u0422\u042c \u0420\u0415\u0414\u0410\u041a\u0422\u041e\u0420\u0410 (\u0412\u0412\u041e\u0414 \u0422\u0415\u041a\u0421\u0422\u0410)\n   (\u0421\u043a\u0440\u043e\u043b\u043b\u0431\u0430\u0440\u044b, \u0444\u043e\u043d, \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043f\u0440\u0438 \u0432\u0432\u043e\u0434\u0435)\n   ========================================= */\n\n.editor-container {\n  background-color: #1e1e1e;\n  border: 1px solid #444;\n  border-radius: 8px;\n  \n  /* \ud83d\udc47 \u0423\u0411\u0418\u0420\u0410\u0415\u041c padding \u043e\u0442\u0441\u044e\u0434\u0430, \u0447\u0442\u043e\u0431\u044b \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043f\u0440\u0438\u043b\u0438\u043f\u0430\u043b \u043a \u043a\u0440\u0430\u044f\u043c */\n  padding: 0; \n  \n  flex-grow: 1;\n  min-height: 200px;\n  overflow-y: auto;\n  cursor: text;\n  box-shadow: inset 0 2px 6px rgba(0,0,0,0.2);\n  \n  /* \u0414\u0435\u043b\u0430\u0435\u043c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0444\u043b\u0435\u043a\u0441\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0440\u0430\u0441\u0442\u044f\u0433\u0438\u0432\u0430\u043b\u0438\u0441\u044c */\n  display: flex;\n  flex-direction: column;\n\n  user-select: text !important;           \n  -webkit-user-select: text !important;   \n  touch-action: pan-y !important;         \n}\n/* \ud83d\udc47 \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u0442\u0438\u043b\u044c \u0434\u043b\u044f \u043e\u0431\u0435\u0440\u0442\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u0430\u043c Tiptap */\n.editor-container > div {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    min-height: 100%;\n}\n/* \u0421\u0442\u0438\u043b\u0438 \u0441\u043a\u0440\u043e\u043b\u043b\u0431\u0430\u0440\u0430 (\u043f\u043e\u043b\u043e\u0441\u044b \u043f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0438) */\n.editor-container::-webkit-scrollbar { width: 6px; }\n.editor-container::-webkit-scrollbar-track { background: #2c2c2c; }\n.editor-container::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }\n.editor-container::-webkit-scrollbar-thumb:hover { background: #777; }\n\n\n/* \ud83d\udc47 \u0421\u0442\u0438\u043b\u0438 \u0434\u043b\u044f \u043e\u0448\u0438\u0431\u043a\u0438 \u043b\u0438\u043c\u0438\u0442\u0430 */\n.editor-container.limit-error {\n  border-color: #ff4d4d !important;\n  box-shadow: 0 0 0 1px #ff4d4d inset; /* \u041b\u0435\u0433\u043a\u0430\u044f \u043a\u0440\u0430\u0441\u043d\u0430\u044f \u043f\u043e\u0434\u0441\u0432\u0435\u0442\u043a\u0430 \u0432\u043d\u0443\u0442\u0440\u0438 */\n}\n\n.char-counter {\n  margin: 0; /* \u0423\u0431\u0438\u0440\u0430\u0435\u043c \u043b\u0438\u0448\u043d\u0438\u0435 \u043e\u0442\u0441\u0442\u0443\u043f\u044b */\n  font-family: \'Courier New\', monospace;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #888;\n  transition: color 0.2s;\n  /* \u0423\u0431\u0440\u0430\u043b\u0438 display: flex \u0438 padding, \u0442\u0430\u043a \u043a\u0430\u043a \u0442\u0435\u043f\u0435\u0440\u044c \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u0438\u0440\u0443\u0435\u0442 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c */\n}\n/* \u0415\u0441\u043b\u0438 \u0445\u043e\u0447\u0435\u0442\u0441\u044f, \u0447\u0442\u043e\u0431\u044b \u0432\u0435\u0441\u044c \u0442\u0435\u043a\u0441\u0442 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u0441\u044f \u043a\u0440\u0430\u0441\u043d\u043e\u0432\u0430\u0442\u044b\u043c \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435, \u0440\u0430\u0441\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439: */\n/* .editor-container.limit-error .ProseMirror { color: #ffaaaa; } */\n\n.limit-message {\n  color: #ff4d4d;\n  background-color: rgba(255, 77, 77, 0.1);\n  border: 1px solid rgba(255, 77, 77, 0.3);\n  padding: 8px 12px;\n  border-radius: 6px;\n  font-size: 0.9rem;\n  margin-top: 5px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  animation: fadeIn 0.2s ease-in-out;\n}\n@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n\n\n/* \u0410\u0434\u0430\u043f\u0442\u0438\u0432 \u0432\u044b\u0441\u043e\u0442\u044b \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 */\n@media (max-width: 768px) {\n    .editor-container { max-height: 25vh; min-height: 120px; }\n    /* \u041a\u043d\u043e\u043f\u043a\u0438 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0432 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0435 (\u0435\u0441\u043b\u0438 \u043f\u043e\u043f\u0430\u0434\u0443\u0442 \u0432\u043d\u0443\u0442\u0440\u044c) */\n    .toolbar-button { padding: 5px 8px; font-size: 0.85rem; }\n}\n@media (min-width: 480px) and (max-width: 768px) {\n    .toolbar-button img {\n        width: 100% !important;\n        height: 100% !important;\n    }\n}\n\n/* =========================================\n   6. \u041a\u041e\u041d\u0422\u0415\u041d\u0422 \u0412\u041d\u0423\u0422\u0420\u0418 \u0420\u0415\u0414\u0410\u041a\u0422\u041e\u0420\u0410 (TIPTAP)\n   (\u041a\u0430\u043a \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0441\u0430\u043c \u0442\u0435\u043a\u0441\u0442: \u0436\u0438\u0440\u043d\u044b\u0439, \u043a\u043e\u0434, \u0446\u0438\u0442\u0430\u0442\u044b)\n   ========================================= */\n\n.ProseMirror {\n    outline: none;\n    color: #e0e0e0;\n    font-size: 1rem;\n    line-height: 1.6;\n    \n    /* \ud83d\udc47 \u041f\u0415\u0420\u0415\u041d\u041e\u0421\u0418\u041c padding \u0441\u044e\u0434\u0430. \u0422\u0435\u043f\u0435\u0440\u044c \u043f\u0443\u0441\u0442\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u2014 \u044d\u0442\u043e \u0447\u0430\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 */\n    padding: 15px; \n    \n    /* \ud83d\udc47 \u0420\u0430\u0441\u0442\u044f\u0433\u0438\u0432\u0430\u0435\u043c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u043d\u0430 \u0432\u0441\u044e \u0432\u044b\u0441\u043e\u0442\u0443 */\n    flex-grow: 1;\n    min-height: 100%;\n    box-sizing: border-box; /* \u0412\u0430\u0436\u043d\u043e, \u0447\u0442\u043e\u0431\u044b padding \u043d\u0435 \u043b\u043e\u043c\u0430\u043b \u0448\u0438\u0440\u0438\u043d\u0443 */\n\n    user-select: text !important;\n    -webkit-user-select: text !important;\n    -webkit-touch-callout: default !important;\n}\n.ProseMirror p { margin: 0.5em 0; }\n\n/* \u0421\u0441\u044b\u043b\u043a\u0438 */\n.ProseMirror a { color: #58a6ff; text-decoration: underline; cursor: pointer; }\n\n/* \u0426\u0438\u0442\u0430\u0442\u044b (Blockquote) */\n.ProseMirror blockquote {\n    border-left: 4px solid #007bff; /* \u0421\u0438\u043d\u044f\u044f \u043f\u043e\u043b\u043e\u0441\u043a\u0430 \u0441\u043b\u0435\u0432\u0430 */\n    padding-left: 15px;\n    margin: 10px 0;\n    color: #aaa;\n    font-style: italic;\n    background: #252525;\n    padding: 10px;\n    border-radius: 4px;\n}\n\n/* \u0411\u043b\u043e\u043a\u0438 \u043a\u043e\u0434\u0430 (Code Block) */\n.ProseMirror pre {\n    background-color: #111;\n    padding: 10px;\n    border-radius: 6px;\n    font-family: \'Courier New\', Courier, monospace;\n    white-space: pre-wrap;\n    margin: 10px 0;\n    border: 1px solid #333;\n}\n.ProseMirror pre code {\n    background-color: transparent;\n    color: #f8f8f2;\n    padding: 0;\n}\n\n/* \u0418\u043d\u043b\u0430\u0439\u043d \u043a\u043e\u0434 (Code) */\n.ProseMirror code {\n    background-color: #333;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-family: \'Courier New\', Courier, monospace;\n    font-size: 0.9em;\n    color: #ff79c6;\n}\n\n/* \u0421\u043f\u043e\u0439\u043b\u0435\u0440 (\u0441\u043a\u0440\u044b\u0442\u044b\u0439 \u0442\u0435\u043a\u0441\u0442) */\n.tg-spoiler {\n    background-color: #454545;\n    color: transparent; /* \u0422\u0435\u043a\u0441\u0442 \u043d\u0435 \u0432\u0438\u0434\u0435\u043d */\n    text-shadow: 0 0 8px rgba(255,255,255,0.5); /* \u042d\u0444\u0444\u0435\u043a\u0442 "\u0448\u0443\u043c\u0430" */\n    border-radius: 4px;\n    padding: 0 4px;\n    cursor: help;\n    transition: all 0.2s;\n}\n/* \u0421\u043f\u043e\u0439\u043b\u0435\u0440 \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 */\n.ProseMirror .tg-spoiler:hover, .ProseMirror:focus .tg-spoiler {\n    color: #f0f0f0; /* \u0422\u0435\u043a\u0441\u0442 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0432\u0438\u0434\u0435\u043d */\n    text-shadow: none;\n    background-color: #555;\n}\n\n\n/* =========================================\n   7. \u0412\u0421\u041f\u041e\u041c\u041e\u0413\u0410\u0422\u0415\u041b\u042c\u041d\u042b\u0415 UI \u042d\u041b\u0415\u041c\u0415\u041d\u0422\u042b\n   (\u0422\u0443\u043b\u0442\u0438\u043f\u044b, \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u043c\u0435\u043d\u044e, \u0424\u043e\u0440\u043c\u044b)\n   ========================================= */\n\n/* \u041a\u0430\u0441\u0442\u043e\u043c\u043d\u0430\u044f \u0432\u0441\u043f\u043b\u044b\u0432\u0430\u044e\u0449\u0430\u044f \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430 (Tooltip) */\n.custom-tooltip {\n  position: fixed;\n  background-color: #222;\n  color: #fff;\n  padding: 5px 10px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  pointer-events: none;\n  z-index: 9999;\n  border: 1px solid #444;\n  white-space: nowrap;\n  transform: translate(-50%, -100%); /* \u0426\u0435\u043d\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0434 \u043a\u0443\u0440\u0441\u043e\u0440\u043e\u043c */\n  margin-top: -8px;\n  box-shadow: 0 4px 10px rgba(0,0,0,0.4);\n  font-weight: 500;\n}\n.custom-tooltip.visible {\n    opacity: 1;\n    transition: opacity 0.2s;\n}\n\n/* \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u043c\u0435\u043d\u044e (\u041f\u041a\u041c) */\n.context-menu {\n    position: absolute;\n    background: #333;\n    color: white;\n    border: 1px solid #555;\n    border-radius: 8px;\n    padding: 10px;\n    z-index: 100;\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n}\n.context-menu p {\n    margin: 0 0 5px 0;\n    padding-bottom: 5px;\n    border-bottom: 1px solid #555;\n    font-size: 0.9rem;\n}\n.context-menu button {\n    background: #4a4a4a;\n    color: white;\n    border: none;\n    padding: 10px;\n    border-radius: 6px;\n    text-align: left;\n    cursor: pointer;\n}\n.context-menu button:hover { background: #5a5a5a; }\n.context-menu button.delete { color: #ffcdd2; }\n.context-menu button.delete:hover { background: #c82333; color: white; }\n\n/* \u042d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0444\u043e\u0440\u043c (Input, Select) */\n.prompt-input {\n    width: 100%; padding: 10px; border-radius: 6px;\n    border: 1px solid #555; background-color: #1e1e1e; color: #f0f0f0;\n}\n.form-row {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 10px;\n}\n.form-row.checkbox {\n  justify-content: flex-start;\n}\n.form-row input[type="text"],\n.form-row input[type="number"],\n.form-row select {\n  flex: 1;\n  padding: 5px;\n}\n\n/* \u0426\u0432\u0435\u0442\u0430 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432 (Attribute Highlight) */\n.attr-c-1 { color: #ff595e; } /* \u041a\u0440\u0430\u0441\u043d\u044b\u0439 */\n.attr-c-2 { color: #ffca3a; } /* \u0416\u0435\u043b\u0442\u044b\u0439 */\n.attr-c-3 { color: #8ac926; } /* \u0417\u0435\u043b\u0435\u043d\u044b\u0439 */\n.attr-c-4 { color: #1982c4; } /* \u0421\u0438\u043d\u0438\u0439 */\n.attr-c-5 { color: #6a4c93; } /* \u0424\u0438\u043e\u043b\u0435\u0442\u043e\u0432\u044b\u0439 */\n.attr-c-6 { color: #f15bb5; } /* \u0420\u043e\u0437\u043e\u0432\u044b\u0439 */\n.attr-c-7 { color: #00b4d8; } /* \u0413\u043e\u043b\u0443\u0431\u043e\u0439 */\n',rD=Vv.create({name:"spoiler",addAttributes:()=>({class:{default:"tg-spoiler",renderHTML:e=>({class:"tg-spoiler"})}}),parseHTML:()=>[{tag:"span",getAttrs:e=>e.classList.contains("tg-spoiler")&&null}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",Vg(this.options.HTMLAttributes,t),0]}}),iD=t=>{let{onClick:n,isActive:o,icon:r,label:i,onShowTooltip:s,onHideTooltip:a,disabled:l,style:u}=t;const d=(0,e.useRef)(null),h=(0,e.useRef)(!1);return(0,c.jsx)("button",{onMouseDown:e=>{e.preventDefault()},onClick:e=>{h.current||l||n(e)},onTouchStart:e=>{h.current=!1,d.current=setTimeout(()=>{h.current=!0;const t=e.target.closest("button").getBoundingClientRect();s(i,t.left+t.width/2,t.top)},500)},onTouchEnd:e=>{clearTimeout(d.current),h.current&&(e.preventDefault(),setTimeout(()=>a(),1500))},onMouseEnter:e=>{const t=e.target.closest("button").getBoundingClientRect();s(i,t.left+t.width/2,t.top)},onMouseLeave:a,onContextMenu:e=>e.preventDefault(),disabled:l,className:"toolbar-button ".concat(o?"active":""),style:u,children:(0,c.jsx)("img",{src:r,alt:i,style:{pointerEvents:"none"}})})};function sD(t){let{initialHtml:n,onSave:o,onCancel:r,userId:i,storyId:s}=t;(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=oD,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const[l,u]=(0,e.useState)(!1),[d,h]=(0,e.useState)(!1),[f,p]=(0,e.useState)({current:0,limit:4e3,over:!1}),m=e.useMemo(()=>Kv.create({name:"customHotkeys",addKeyboardShortcuts(){return{"Mod-Alt-t":()=>(u(!0),!0),"Mod-Alt-a":()=>(h(!0),!0),"Mod-b":()=>(this.editor.commands.toggleBold(),!0),"Mod-i":()=>(this.editor.commands.toggleItalic(),!0),"Mod-u":()=>(this.editor.commands.toggleUnderline(),!0),"Mod-Shift-x":()=>(this.editor.commands.toggleStrike(),!0),"Mod-e":()=>(this.editor.commands.toggleCode(),!0),"Mod-Shift-h":()=>(this.editor.commands.toggleMark("spoiler"),!0),"Mod-Shift-b":()=>(this.editor.commands.toggleBlockquote(),!0),"Mod-Alt-c":()=>(this.editor.commands.toggleCodeBlock(),!0),"Mod-k":()=>{if(this.editor.state.selection.empty){const e=window.prompt("URL \u0441\u0441\u044b\u043b\u043a\u0438:");if(!e)return!0;let t=window.prompt("\u0422\u0435\u043a\u0441\u0442 \u0441\u0441\u044b\u043b\u043a\u0438:",e);return t||(t=e),this.editor.chain().focus().insertContent({type:"text",text:t,marks:[{type:"link",attrs:{href:e}}]}).insertContent(" ").unsetMark("link").run(),!0}const e=this.editor.getAttributes("link").href,t=window.prompt("URL \u0441\u0441\u044b\u043b\u043a\u0438:",e);return null===t||(""===t?(this.editor.chain().focus().extendMarkRange("link").unsetLink().run(),!0):(this.editor.chain().focus().extendMarkRange("link").setLink({href:t}).run(),!0))},"Mod-s":()=>!0}}}),[]),g=ub({extensions:[Jk.configure({codeBlock:{HTMLAttributes:{class:"code-block"}}}),gk,Fw.configure({openOnClick:!1,HTMLAttributes:{target:"_blank"}}),rD,kC,m],content:"(\u043f\u0443\u0441\u0442\u043e)"===n?"":n.replace(/\n/g,"<br>"),autofocus:!0}),[,v]=(0,e.useState)(0);(0,e.useEffect)(()=>{if(!g)return;const e=()=>v(e=>e+1);return g.on("selectionUpdate",e),g.on("transaction",e),g.on("update",e),()=>{g.off("selectionUpdate",e),g.off("transaction",e),g.off("update",e)}},[g]);const[y,b]=(0,e.useState)({visible:!1,text:"",x:0,y:0}),x=(e,t,n)=>{b({visible:!0,text:e,x:t,y:n})},w=()=>{b(e=>a(a({},e),{},{visible:!1}))};(0,e.useEffect)(()=>{if(!g)return;const e=()=>{const e=g.state.doc.textBetween(0,g.state.doc.content.size,"\n"),t=g.state.selection.from,n=g.state.doc.textBetween(0,t,"\n"),o=/\[\[-\d+\]\]/g;let r,i=0;for(;null!==(r=o.exec(n));)i=r.index+r[0].length;o.lastIndex=i;const s=o.exec(e),a=(s?s.index:e.length)-i,l=Math.max(0,a);p({current:l,limit:4e3,over:l>4e3})};return g.on("update",e),g.on("selectionUpdate",e),e(),()=>{g.off("update",e),g.off("selectionUpdate",e)}},[g]);const k=e=>{if(!g)return;const t=g.isActive(e),{selection:n}=g.state;if(t&&n.empty){const{$from:t}=n;if(0===t.parent.content.size)return void g.chain().focus().lift(e).run()}if(n.empty)return"blockquote"===e&&g.chain().focus().toggleBlockquote().run(),void("codeBlock"===e&&g.chain().focus().toggleCodeBlock().run());const{from:o,to:r}=g.state.selection,i=g.state.doc.textBetween(o,r,"\n");g.chain().focus().deleteSelection().run(),"blockquote"===e?g.chain().focus().insertContent("<blockquote><p>".concat(i,"</p></blockquote>")).run():"codeBlock"===e&&g.chain().focus().insertContent("<pre><code>".concat(i,"</code></pre>")).run()},C=(0,e.useCallback)(()=>{if(!g)return;if(g.state.selection.empty){const e=window.prompt("URL \u0441\u0441\u044b\u043b\u043a\u0438:");if(!e)return;let t=window.prompt("\u0422\u0435\u043a\u0441\u0442 \u0441\u0441\u044b\u043b\u043a\u0438:",e);return t||(t=e),void g.chain().focus().insertContent({type:"text",text:t,marks:[{type:"link",attrs:{href:e}}]}).insertContent(" ").unsetMark("link").run()}const e=g.getAttributes("link").href,t=window.prompt("URL \u0441\u0441\u044b\u043b\u043a\u0438:",e);null!==t&&(""!==t?g.chain().focus().extendMarkRange("link").setLink({href:t}).run():g.chain().focus().extendMarkRange("link").unsetLink().run())},[g]),S=g&&!g.state.selection.empty;return g?(0,c.jsxs)("div",{className:"modal-overlay",onPointerDown:e=>{if(e.target===e.currentTarget){window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440? \u041d\u0435\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u044b.")&&r()}},children:[y.visible&&(0,c.jsx)("div",{className:"custom-tooltip",style:{left:y.x,top:y.y},children:y.text}),(0,c.jsxs)("div",{className:"modal-content nodrag",children:[(0,c.jsx)("h3",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsxs)("div",{className:"toolbar-container",children:[(0,c.jsxs)("div",{className:"toolbar-group",children:[(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleBold().run(),isActive:g.isActive("bold"),icon:Qk,label:"\u0416\u0438\u0440\u043d\u044b\u0439",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleItalic().run(),isActive:g.isActive("italic"),icon:eC,label:"\u041a\u0443\u0440\u0441\u0438\u0432",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleUnderline().run(),isActive:g.isActive("underline"),icon:tC,label:"\u041f\u043e\u0434\u0447\u0435\u0440\u043a\u043d\u0443\u0442\u044b\u0439",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleStrike().run(),isActive:g.isActive("strike"),icon:nC,label:"\u0417\u0430\u0447\u0435\u0440\u043a\u043d\u0443\u0442\u044b\u0439",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleCode().run(),isActive:g.isActive("code"),icon:oC,label:"\u041c\u043e\u043d\u043e\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u0439",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(iD,{onClick:()=>u(!0),isActive:!1,icon:lC,label:"\u0422\u0430\u0439\u043c\u0435\u0440",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>h(!0),isActive:!1,icon:cC,label:"\u0410\u0442\u0440\u0438\u0431\u0443\u0442",onShowTooltip:x,onHideTooltip:w})]}),(0,c.jsx)("div",{className:"group-separator"}),(0,c.jsxs)("div",{className:"toolbar-group",children:[(0,c.jsx)(iD,{onClick:()=>g.chain().focus().undo().run(),disabled:!g.can().undo(),icon:fC,label:"\u041d\u0430\u0437\u0430\u0434",style:{opacity:g.can().undo()?1:.5},onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().redo().run(),disabled:!g.can().redo(),icon:pC,label:"\u0412\u043f\u0435\u0440\u0451\u0434",style:{opacity:g.can().redo()?1:.5},onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(iD,{onClick:()=>g.chain().focus().toggleMark("spoiler").run(),isActive:g.isActive("spoiler"),icon:iC,label:"\u0421\u043f\u043e\u0439\u043b\u0435\u0440",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>k("blockquote"),isActive:g.isActive("blockquote"),icon:sC,label:"\u0426\u0438\u0442\u0430\u0442\u0430",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>k("codeBlock"),isActive:g.isActive("codeBlock"),icon:rC,label:"\u0411\u043b\u043e\u043a \u043a\u043e\u0434\u0430",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:C,isActive:g.isActive("link"),icon:aC,label:"\u0421\u0441\u044b\u043b\u043a\u0430",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)("div",{className:"toolbar-separator"}),(0,c.jsx)(iD,{onClick:()=>{if(!g)return;const e=g.getText();navigator.clipboard.writeText(e).catch(e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: ",e)})},icon:uC,label:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0451",onShowTooltip:x,onHideTooltip:w}),(0,c.jsx)(iD,{onClick:()=>{g&&(S?window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u0442\u0435\u043a\u0441\u0442?")&&g.chain().focus().deleteSelection().run():g.chain().focus().selectAll().run())},icon:S?hC:dC,label:S?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435":"\u0412\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u0432\u0441\u0451",onShowTooltip:x,onHideTooltip:w,style:S?{borderColor:"#ffcdd2",color:"#ffcdd2"}:{}})]})]}),(0,c.jsx)("div",{className:"editor-container ".concat(f.over?"limit-error":""),children:(0,c.jsx)(rb,{editor:g,style:{height:"100%",display:"flex",flexDirection:"column"}})}),l&&(0,c.jsx)(SC,{onCancel:()=>{u(!1),g.commands.focus()},onSubmit:e=>{g.chain().focus().insertContent(" ".concat(e," ")).run(),u(!1)}}),d&&(0,c.jsx)(CC,{userId:i,storyId:s,onSubmit:e=>{let{name:t,resultValue:n,isDisplay:o}=e;const r="{{".concat(t).concat(o?"":": ".concat(n),"}}"),i="{{".concat(t,"}}");if(g.commands.focus(),o)g.chain().focus().insertContent(" ".concat(r," ")).run();else if(g.state.selection.empty){const e=g.state.selection.from;g.chain().focus().insertContent(r+i).setTextSelection(e+r.length).run()}else{const{from:e,to:t}=g.state.selection,n=g.state.doc.textBetween(e,t," ");g.chain().focus().insertContent("".concat(r).concat(n).concat(i)).run()}h(!1)},onCancel:()=>{h(!1),g.commands.focus()}}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsxs)("div",{className:"char-counter ".concat(f.over?"warning":""),children:[f.current,"/",f.limit]}),(0,c.jsxs)("div",{className:"modal-buttons-group",children:[(0,c.jsx)("button",{className:"modal-button secondary",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{className:"modal-button primary",onClick:()=>{if(!g)return;const e=(e=>{if(!e||"<p></p>"===e)return"";let t=e;return t=t.replace(/<\/p>/g,"\n"),t=t.replace(/<p>/g,""),t=t.replace(/<br\s*\/?>/gi,"\n"),t=t.replace(/&nbsp;/g," ").replace(/\u200B/g,""),t=t.replace(/<(?!\/?(b|strong|i|em|u|s|strike|del|code|pre|blockquote|a|span)(\s|>))[^>]+>/gi,""),t=t.replace(/\n+(?=<\/(blockquote|pre)>)/g,""),t=t.replace(/(<\/(blockquote|pre)>)\n+/g,"$1"),t.trim()})(g.getHTML());o(e||"(\u043f\u0443\u0441\u0442\u043e)")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})]})]}):null}function aD(t){let{title:n,children:o,onConfirm:r,onCancel:i,confirmText:s="\u041e\u041a",cancelText:a="\u041e\u0442\u043c\u0435\u043d\u0430",type:l="confirm"}=t;return(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=oD,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,c.jsx)("div",{className:"modal-overlay",onClick:i,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h3",{children:n}),(0,c.jsx)("div",{children:o}),(0,c.jsxs)("div",{className:"modal-actions",children:[i&&(0,c.jsx)("button",{className:"modal-button secondary",onClick:i,children:a}),(0,c.jsx)("button",{className:"modal-button ".concat("danger"===l?"danger":"primary"),onClick:r,children:s})]})]})})}const lD=window.location.pathname,[cD,uD]=lD.slice(1).split("_");const dD=function(t){let{id:n,top:o,left:r,right:i,bottom:s,onClick:l,node:u,setNodes:d,setEdges:h}=t;const[f,p]=(0,e.useState)(null),m=cD,g=uD,{ref:v,style:y}=$l({x:r,y:o});(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=oD,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);const b=(e,t)=>{const n=t.text||"(\u043f\u0443\u0441\u0442\u043e)",o=t.media||[],r={photo:["\u0444\u043e\u0442\u043e","\u0444\u043e\u0442\u043e","\u0444\u043e\u0442\u043e"],video:["\u0432\u0438\u0434\u0435\u043e","\u0432\u0438\u0434\u0435\u043e","\u0432\u0438\u0434\u0435\u043e"],audio:["\u0430\u0443\u0434\u0438\u043e","\u0430\u0443\u0434\u0438\u043e","\u0430\u0443\u0434\u0438\u043e"],animation:["\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u044f","\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438","\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0439"]};let i="";if(o.length>0){const e=o.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{});i=Object.entries(e).map(e=>{let[t,n]=e;const o=r[t]||[t,t,t];return"".concat({photo:"\ud83d\udcf7",video:"\ud83c\udfac",audio:"\ud83c\udfb5",animation:"\ud83c\udf9e\ufe0f"}[t]||"\u2753"," ").concat(n," ").concat(function(e,t){let[n,o,r]=t;return e%10===1&&e%100!==11?n:[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?o:r}(n,o))}).join(" ")}return"".concat(e,"\n").concat(n.replace(/<[^>]+>/g,"").substring(0,1500)).concat(n.length>1500?"...":"").concat(i?"\n"+i:"")},x=(0,e.useCallback)(async e=>{const t=u.data.fragment.text||"";if(e!==t)try{await async function(e,t,n,o){console.log("[apiUpdateFragmentText] Posting text:",JSON.stringify(o)),await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/text"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:o})})}(m,g,n,e),d(t=>t.map(t=>{if(t.id===n){const o=a(a({},t.data.fragment),{},{text:e});return a(a({},t),{},{data:a(a({},t.data),{},{fragment:o,label:b(n,o),bgColor:tM(n,o)})})}return t}))}catch(o){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: ".concat(o.message)),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: ".concat(o.message))}p(null),l()},[n,u,m,g,d,l]),w=(0,e.useCallback)(async e=>{try{await vC(m,g,n,e),d(t=>t.map(t=>{if(t.id===n){const o=e.map(e=>a(a({},e),{},{url:"/api/tgfile/".concat(e.file_id)})),r=a(a({},t.data.fragment),{},{media:e});return a(a({},t),{},{data:a(a({},t.data),{},{fragment:r,media:o,label:b(n,r),bgColor:tM(n,r)})})}return t}))}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043c\u0435\u0434\u0438\u0430: ".concat(t.message))}},[n,m,g,d]),k=(0,e.useCallback)(async e=>{try{await async function(e,t,n,o){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/choices"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({choices:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"Failed to update choices")}return await r.json()}(m,g,n,e),d(t=>t.map(t=>{if(t.id===n){const o=a(a({},t.data.fragment),{},{choices:e});return a(a({},t),{},{data:a(a({},t.data),{},{fragment:o,label:b(n,o),bgColor:tM(n,o)})})}return t}))}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u043d\u043e\u043f\u043e\u043a: ".concat(t.message))}},[n,m,g,d]),C=(0,e.useCallback)(async e=>{const t=n;if("main_1"===t)return alert("\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 main_1 \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c."),p(null),void l();if(e&&e!==t)try{const{story:n}=await async function(e,t,n,o){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n,"/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newName:o})});if(!r.ok){const{error:e}=await r.json();throw new Error(e)}return await r.json()}(m,g,t,e);d(o=>o.map(o=>o.id===t?a(a({},o),{},{id:e,data:a(a({},o.data),{},{label:"".concat(e,"\n").concat(n.fragments[e].text)})}):o)),h(n=>n.map(n=>(n.source===t&&(n.source=e),n.target===t&&(n.target=e),n)))}catch(o){console.error(o)}p(null),l()},[n,m,g,d,h,l]),S=(0,e.useCallback)(async()=>{try{await async function(e,t,n){return(await fetch("/api/story/".concat(e,"/").concat(t,"/fragment/").concat(n),{method:"DELETE"})).ok}(m,g,n),d(e=>e.filter(e=>e.id!==n)),h(e=>e.filter(e=>e.source!==n&&e.target!==n))}catch(e){console.error(e)}p(null),l()},[n,m,g,d,h,l]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{ref:v,style:y,className:"context-menu",children:[(0,c.jsxs)("p",{children:["\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442: ",(0,c.jsx)("strong",{children:n})]}),(0,c.jsx)("button",{onClick:()=>p("preview"),children:"\ud83d\udc41\ufe0f \u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"}),(0,c.jsx)("button",{onClick:()=>p("rename"),children:"\u270f\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442. \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),(0,c.jsx)("button",{onClick:()=>p("edit"),children:"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442. \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsx)("button",{onClick:()=>p("media"),children:"\ud83d\uddbc\ufe0f \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c/\u0420\u0435\u0434\u0430\u043a\u0442. \u043c\u0435\u0434\u0438\u0430"}),(0,c.jsx)("button",{className:"delete",onClick:()=>p("delete"),children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"}),(0,c.jsx)("button",{onClick:l,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}),"edit"===f&&(0,c.jsx)(sD,{initialHtml:u.data.fragment.text||"",onSave:x,onCancel:()=>{p(null),l()},userId:m,storyId:g}),"rename"===f&&(0,c.jsx)(aD,{title:'\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c "'.concat(n,'"'),onConfirm:()=>C(document.getElementById("rename-input").value),onCancel:()=>{p(null),l()},confirmText:"\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c",children:(0,c.jsx)("input",{id:"rename-input",type:"text",defaultValue:n,className:"prompt-input",autoFocus:!0})}),"delete"===f&&(0,c.jsx)(aD,{title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435",type:"danger",onConfirm:S,onCancel:()=>{p(null),l()},confirmText:"\u0414\u0430, \u0443\u0434\u0430\u043b\u0438\u0442\u044c",children:(0,c.jsxs)("p",{children:["\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 ",(0,c.jsxs)("strong",{children:['"',n,'"']}),"?"]})}),"media"===f&&(0,c.jsx)(tD,{node:u,userId:m,storyId:g,onUpdate:w,onClose:()=>{p(null),l()}}),"preview"===f&&(0,c.jsx)(nD,{node:u,onClose:()=>{p(null),l()},onUpdateMedia:w,onUpdateChoices:k})]})},hD=window.location.pathname,[fD,pD]=hD.slice(1).split("_");const mD=function(t){let{node:n,setNodes:o,onClose:r,top:i,left:s,autoOpenEditor:l=!1}=t;const[u,d]=(0,e.useState)(null),{ref:h,style:f}=$l({x:s,y:i});(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText=oD,document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,e.useEffect)(()=>{l&&d("edit")},[l]);const p=(0,e.useCallback)(async e=>{try{await async function(e,t,n,o){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks/").concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:o})});if(!r.ok){const{error:e}=await r.json();throw new Error(e||"Server error on update")}return await r.json()}(fD,pD,n.id,e),o(t=>t.map(t=>t.id===n.id?a(a({},t),{},{data:a(a({},t.data),{},{text:e})}):t))}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(t.message))}finally{d(null),r()}},[n.id,o,r]),m=(0,e.useCallback)(async()=>{try{await async function(e,t,n){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks/").concat(n),{method:"DELETE"});if(!o.ok){const{error:e}=await o.json();throw new Error(e||"Server error on delete")}return await o.json()}(fD,pD,n.id),o(e=>e.filter(e=>e.id!==n.id))}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(e.message))}finally{d(null),r()}},[n.id,o,r]);return(0,c.jsxs)(c.Fragment,{children:[!l&&(0,c.jsxs)("div",{ref:h,className:"context-menu",style:a(a({},{zIndex:1e3}),f),children:[(0,c.jsxs)("p",{children:["\u0417\u0430\u043c\u0435\u0442\u043a\u0430: ",(0,c.jsx)("strong",{children:n.id})]}),(0,c.jsx)("button",{onClick:()=>d("edit"),children:"\ud83d\udcdd \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,c.jsx)("button",{className:"delete",onClick:()=>d("delete"),children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),(0,c.jsx)("button",{onClick:r,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]}),"edit"===u&&(0,c.jsx)(sD,{initialHtml:n.data.text||"",onSave:p,onCancel:()=>{d(null),r()}}),"delete"===u&&(0,c.jsx)(aD,{title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435",type:"danger",onConfirm:m,onCancel:()=>{d(null),r()},confirmText:"\u0414\u0430, \u0443\u0434\u0430\u043b\u0438\u0442\u044c",children:(0,c.jsx)("p",{children:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443?"})})]})},gD=e=>{let{isOpen:t,onClose:n}=e;return t?(0,c.jsxs)("div",{className:"modal-overlay",children:[" ",(0,c.jsxs)("div",{className:"modal-content help-modal-content",children:[(0,c.jsx)("h3",{children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430"}),(0,c.jsxs)("p",{children:['1) \u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u0443, \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0443, \u043e\u0434\u043d\u043e \u043d\u0438\u0436\u043d\u0435\u0435 \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u0435 \u0438 \u0447\u0438\u0441\u043b\u043e. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: "\u0418\u0434\u0442\u0438\u041f\u0440\u044f\u043c\u043e_2", "\u0412\u0441\u0442\u0430\u0442\u044c_8"',"\n","2) \u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 17 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432","\n","3) \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0435 \u0432\u0432\u043e\u0434\u0438\u0442\u044c \u0447\u0438\u0441\u043b\u043e \u2014 \u043e\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438","\n","4) \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0435 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0438\u043c\u044f \u2014 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0438\u043c\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0441 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u043c \u043d\u0435\u0437\u0430\u043d\u044f\u0442\u044b\u043c \u043d\u043e\u043c\u0435\u0440\u043e\u043c","\n","5) \u0415\u0441\u043b\u0438 \u0432\u043c\u0435\u0441\u0442\u043e \u0442\u0435\u043a\u0441\u0442\u0430 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e \u0447\u0438\u0441\u043b\u043e, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 4, \u0442\u043e \u043a\u043d\u043e\u043f\u043a\u0438 \u0443 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438 \u043e\u043d \u0441\u043c\u0435\u043d\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0432\u043d\u043e\u0435 \u044d\u0442\u043e\u043c\u0443 \u0447\u0438\u0441\u043b\u0443 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445"]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"15px"},children:(0,c.jsx)("button",{onClick:n,className:"button-base ok-button",children:"\u041f\u043e\u043d\u044f\u0442\u043d\u043e"})})]})]}):null},vD=t=>{let{isOpen:n,onClose:o,onSubmit:r,defaultName:i,sourceNodeName:s,generateUniqueFragmentId:a,existingIds:l}=t;const[u,d]=(0,e.useState)(""),[h,f]=(0,e.useState)(""),[p,m]=(0,e.useState)(""),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)(!1);(0,e.useEffect)(()=>{n&&(d(""),f(""),m(""),v(!1))},[n]);return n?(0,c.jsxs)("div",{className:"modal-overlay",children:[" ",(0,c.jsxs)("div",{className:"modal-content",children:[(0,c.jsxs)("h3",{children:['\u041d\u043e\u0432\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u043e\u0442 "',s,'"']}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"fragmentName",style:{display:"block",marginBottom:"5px"},children:"\u0418\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:"}),(0,c.jsx)("input",{id:"fragmentName",type:"text",value:u,onChange:e=>{d(e.target.value),p&&m("")},placeholder:i||"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0421\u0446\u0435\u043d\u0430_1",className:"input-field"}),(0,c.jsx)("div",{className:"error-text",children:p})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"choiceText",style:{display:"block",marginBottom:"5px"},children:"\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430:"}),(0,c.jsx)("input",{id:"choiceText",type:"text",value:h,onChange:e=>f(e.target.value),placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0418\u0434\u0442\u0438 \u0434\u0430\u043b\u044c\u0448\u0435",className:"input-field"})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"15px"},children:[(0,c.jsx)("button",{onClick:o,className:"button-base cancel-button",disabled:g,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{onClick:async()=>{if(g)return;let e,t=u.trim();if(t||(t=null===i||void 0===i?void 0:i.trim()),!t)return void m("\u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c.");if(/_\d+$/.test(t))e=t;else{e=a(t,l,!1).id}const n=a(e,l,!0);if(n.error)m(n.error);else if(h.trim()){v(!0),m("");try{await r(e,h.trim())}catch(o){m(o.message||"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430")}finally{v(!1)}}else m("\u0422\u0435\u043a\u0441\u0442 \u043a\u043d\u043e\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c.")},className:"button-base ok-button",disabled:g,children:g?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u041e\u041a"})]}),(0,c.jsx)("button",{onClick:()=>b(!0),className:"help-button",children:"\u041f\u043e\u043c\u043e\u0449\u044c"}),(0,c.jsx)(gD,{isOpen:y,onClose:()=>b(!1)})]})]}):null},yD={position:"absolute",background:"white",padding:"10px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",zIndex:100,display:"flex",flexDirection:"column",gap:"8px",minWidth:"220px"},bD={background:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"4px",padding:"8px 12px",cursor:"pointer",textAlign:"left",width:"100%",display:"flex",alignItems:"center",gap:"8px"};const xD=function(e){let{top:t,left:n,edge:o,onClick:r,onEditEffects:i,setEdges:s,userId:l,storyId:u}=e;const{source:d,target:h,data:f}=o,{ref:p,style:m}=$l({x:n,y:t});return(0,c.jsxs)("div",{ref:p,style:a(a({},yD),m),onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{style:{padding:"4px 8px",fontWeight:"bold",borderBottom:"1px solid #eee",color:"#333"},children:["\u0421\u0432\u044f\u0437\u044c: ",d," \u2192 ",h]}),(0,c.jsx)("button",{style:bD,onClick:async()=>{const e=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u0442\u0435\u043a\u0441\u0442 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0432\u044b\u0431\u043e\u0440\u0430:",f.text);if(null!==e&&e!==f.text)try{await fetch("/api/story/".concat(l,"/").concat(u,"/choice"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:d,choiceIndex:f.choiceIndex,text:e})}),s(t=>t.map(t=>t.id===o.id?a(a({},t),{},{data:a(a({},t.data),{},{text:e})}):t))}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430: ".concat(t.message))}finally{r()}else r()},children:"\u270f\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442"}),(0,c.jsx)("button",{style:bD,onClick:i,children:"\u2699\ufe0f \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,c.jsx)("button",{style:a(a({},bD),{},{color:"#dc3545"}),onClick:async()=>{if(window.confirm('\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c \u043e\u0442 "'.concat(d,'" \u043a "').concat(h,'"?')))try{if(!(await fetch("/api/story/".concat(l,"/").concat(u,"/choice"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:d,choiceIndex:f.choiceIndex})})).ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u0432\u0435\u0442\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");s(e=>e.filter(e=>e.id!==o.id))}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u044f\u0437\u0438: ".concat(e.message))}r()},children:"\ud83d\uddd1\ufe0f \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u044f\u0437\u044c"}),(0,c.jsx)("button",{style:bD,onClick:r,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})};const wD=function(t){let{top:n,left:o,onClose:r,onCreateFragment:i,onAddNote:s}=t;const{ref:a,style:l}=$l({x:o,y:n});return(0,e.useEffect)(()=>{const e=document.createElement("style");return e.innerText="\n.context-menu {\n    position: absolute; /* \u0412\u0430\u0436\u043d\u043e: \u043f\u043e\u0437\u0438\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 style */\n    background: #333;\n    color: white;\n    border: 1px solid #555;\n    border-radius: 8px;\n    padding: 10px;\n    z-index: 1000; /* \u041f\u043e\u0434\u043d\u044f\u043b z-index, \u0447\u0442\u043e\u0431\u044b \u0442\u043e\u0447\u043d\u043e \u0431\u044b\u043b\u043e \u043f\u043e\u0432\u0435\u0440\u0445 \u0432\u0441\u0435\u0433\u043e */\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    min-width: 200px;\n    transition: opacity 0.1s ease-in; /* \u041f\u043b\u0430\u0432\u043d\u043e\u0435 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 */\n}\n/* ...\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u0438\u043b\u0438 \u0442\u0435 \u0436\u0435... */\n.context-menu p {\n    margin: 0 0 5px 0;\n    padding-bottom: 5px;\n    border-bottom: 1px solid #555;\n    font-size: 0.9rem;\n    font-weight: bold;\n    color: #ccc;\n}\n.context-menu button {\n    background: #4a4a4a;\n    color: white;\n    border: none;\n    padding: 10px;\n    border-radius: 6px;\n    text-align: left;\n    cursor: pointer;\n    transition: background-color 0.2s;\n    font-size: 0.95rem;\n}\n.context-menu button:hover {\n    background: #5a5a5a;\n}\n.context-menu button.delete {\n    color: #ffcdd2;\n    margin-top: 5px;\n    border-top: 1px solid #555;\n}\n.context-menu button.delete:hover {\n    background: #c82333;\n    color: white;\n}\n",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,c.jsxs)("div",{ref:a,className:"context-menu",style:l,children:[(0,c.jsx)("p",{children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043e\u0431\u043b\u0430\u0441\u0442\u044c\u044e"}),(0,c.jsx)("button",{onClick:()=>{i(),r()},children:"\ud83d\udcdd \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442"}),(0,c.jsx)("button",{onClick:()=>{s(),r()},children:"\ud83d\udd16 \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043a\u0443"}),(0,c.jsx)("button",{className:"delete",onClick:r,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})},kD={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},CD={background:"white",padding:"25px",borderRadius:"8px",width:"90%",maxWidth:"450px",maxHeight:"70vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"15px"},SD={display:"grid",gridTemplateColumns:"1fr 3fr 80px",gap:"10px",alignItems:"center"},ED={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"};const DD=function(t){let{isOpen:n,onClose:o,from:r,to:i,modifiers:s,onSave:l}=t;const[u,d]=(0,e.useState)({});if((0,e.useEffect)(()=>{const e={},t=parseInt(r,10),n=parseInt(i,10);if(!isNaN(t)&&!isNaN(n)&&n>=t)for(let o=t;o<=n;o++){const t=s.find(e=>e.value===o);e[o]=t?t.prob:0}d(e)},[n,r,i,s]),!n)return null;const h=(e,t)=>{d(n=>a(a({},n),{},{[e]:parseInt(t,10)||0}))},f=Object.keys(u);return(0,c.jsx)("div",{style:kD,onClick:o,children:(0,c.jsxs)("div",{style:CD,onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h4",{style:{marginTop:0},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0435\u0439"}),f.length>0?f.map(e=>(0,c.jsxs)("div",{style:SD,children:[(0,c.jsxs)("strong",{children:["\u0427\u0438\u0441\u043b\u043e: ",e]}),(0,c.jsx)("input",{type:"range",min:"-100",max:"100",value:u[e],onChange:t=>h(e,t.target.value)}),(0,c.jsx)("input",{type:"number",min:"-100",max:"100",value:u[e],onChange:t=>h(e,t.target.value),style:{width:"70px",textAlign:"center"}})]},e)):(0,c.jsx)("p",{style:{color:"#666"},children:'\u0417\u0430\u0434\u0430\u0439\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d "\u041e\u0442" \u0438 "\u0414\u043e", \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438.'}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[(0,c.jsx)("button",{style:a(a({},ED),{},{background:"#e2e3e5"}),onClick:o,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{style:a(a({},ED),{},{background:"#d4edda",color:"#155724"}),onClick:()=>{const e=Object.entries(u).filter(e=>{let[t,n]=e;return 0!==n}).map(e=>{let[t,n]=e;return{value:parseInt(t,10),prob:n}});l(e)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})};var MD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ND=e.createContext&&e.createContext(MD),AD=["attr","size","title"];function OD(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TD(){return TD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},TD.apply(this,arguments)}function _D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function jD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_D(Object(n),!0).forEach(function(t){PD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function PD(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ID(t){return t&&t.map((t,n)=>e.createElement(t.tag,jD({key:n},t.attr),ID(t.child)))}function RD(t){return n=>e.createElement(FD,TD({attr:jD({},t.attr)},n),ID(t.child))}function FD(t){var n=n=>{var o,{attr:r,size:i,title:s}=t,a=OD(t,AD),l=i||n.size||"1em";return n.className&&(o=n.className),t.className&&(o=(o?o+" ":"")+t.className),e.createElement("svg",TD({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:o,style:jD(jD({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&e.createElement("title",null,s),t.children)};return void 0!==ND?e.createElement(ND.Consumer,null,e=>n(e)):n(MD)}function zD(e){return RD({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function LD(e){return RD({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}const BD={display:"flex",flexDirection:"column",gap:"10px",border:"1px solid #ccc",padding:"10px",borderRadius:"8px",background:"#f9f9f9"},VD={padding:"8px",borderRadius:"4px",border:"1px solid #ddd",width:"100%",boxSizing:"border-box"},HD=a({},VD),$D={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"},WD=a(a({},$D),{},{padding:"4px 8px",fontSize:"12px",maxWidth:"100px",whiteSpace:"normal",textAlign:"center",lineHeight:"1.2"});const UD=function(t){let{effect:n,onChange:o,onDelete:r,availableStats:i=[]}=t;const[s,l]=(0,e.useState)(!1),u=(e,t)=>{o(a(a({},n),{},{[e]:t}))};return(0,c.jsxs)("div",{style:BD,children:[(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsxs)("div",{style:{flex:2},children:[(0,c.jsx)("input",{type:"text",placeholder:"\u0410\u0442\u0440\u0438\u0431\u0443\u0442 (\u0441\u0438\u043b\u0430, \u0443\u0434\u0430\u0447\u0430...)",value:n.stat,onChange:e=>u("stat",e.target.value),list:"available-stats-".concat(n.id),style:VD}),(0,c.jsx)("datalist",{id:"available-stats-".concat(n.id),children:i.map(e=>(0,c.jsx)("option",{value:e},e))})]}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsxs)("select",{style:HD,value:n.type,onChange:e=>u("type",e.target.value),children:[(0,c.jsx)("option",{value:"set",children:"\u0417\u0430\u0434\u0430\u0442\u044c"}),(0,c.jsx)("option",{value:"modify",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"check",children:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430"}),(0,c.jsx)("option",{value:"range",children:"\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d"}),(0,c.jsx)("option",{value:"modifyRange",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d"})]})}),"modifyRange"===n.type&&(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsxs)("select",{style:HD,value:n.modifyType||"increase",onChange:e=>u("modifyType",e.target.value),children:[(0,c.jsx)("option",{value:"increase",children:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"decrease",children:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c"})]})})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flex:1},children:(()=>{switch(n.type){case"set":return(0,c.jsx)("input",{type:"number",style:VD,placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",value:n.value||"",onChange:e=>u("value",e.target.value)});case"modify":return(0,c.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,c.jsxs)("select",{style:HD,value:n.modifyType||"increase",onChange:e=>u("modifyType",e.target.value),children:[(0,c.jsx)("option",{value:"increase",children:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c"}),(0,c.jsx)("option",{value:"decrease",children:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c"})]}),(0,c.jsx)("input",{type:"number",style:VD,placeholder:"\u041d\u0430...",value:n.value||"",onChange:e=>u("value",e.target.value)})]});case"check":return(0,c.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,c.jsxs)("select",{style:HD,value:n.checkType||"equal",onChange:e=>u("checkType",e.target.value),children:[(0,c.jsxs)("option",{value:"greater",children:[">"," (\u0411\u043e\u043b\u044c\u0448\u0435)"]}),(0,c.jsxs)("option",{value:"less",children:["<"," (\u041c\u0435\u043d\u044c\u0448\u0435)"]}),(0,c.jsxs)("option",{value:"equal",children:["="," (\u0420\u0430\u0432\u043d\u043e)"]})]}),(0,c.jsx)("input",{type:"number",style:VD,placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",value:n.value||"",onChange:e=>u("value",e.target.value)})]});case"range":case"modifyRange":return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("input",{type:"number",style:VD,placeholder:"\u041e\u0442",value:n.from||"",onChange:e=>u("from",e.target.value)}),(0,c.jsx)("span",{children:"-"}),(0,c.jsx)("input",{type:"number",style:VD,placeholder:"\u0414\u043e",value:n.to||"",onChange:e=>u("to",e.target.value)}),(0,c.jsx)("button",{style:a(a({},WD),{},{background:"#e0e0e0"}),onClick:()=>l(!0),children:"\ud83c\udfb2 \u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438"})]});default:return null}})()}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsxs)("label",{title:n.hide?"\u042d\u0444\u0444\u0435\u043a\u0442 \u0441\u043a\u0440\u044b\u0442":"\u042d\u0444\u0444\u0435\u043a\u0442 \u0432\u0438\u0434\u0435\u043d \u0438\u0433\u0440\u043e\u043a\u0443",style:{display:"flex",alignItems:"center",gap:"5px",cursor:"pointer",fontSize:"18px"},children:[(0,c.jsx)("input",{type:"checkbox",checked:!!n.hide,onChange:e=>u("hide",e.target.checked),style:{display:"none"}}),(0,c.jsx)("span",{style:{fontSize:20},children:n.hide?(0,c.jsx)(zD,{}):(0,c.jsx)(LD,{})})]}),(0,c.jsx)("button",{style:a(a({},$D),{},{background:"#f8d7da",color:"#721c24"}),onClick:r,children:"\ud83d\uddd1\ufe0f"})]})]}),s&&(0,c.jsx)(DD,{isOpen:s,onClose:()=>l(!1),from:n.from,to:n.to,modifiers:n.modifiers||[],onSave:e=>{u("modifiers",e),l(!1)}})]})};const qD={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},KD={background:"white",padding:"20px",borderRadius:"8px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"15px",position:"relative"},YD={padding:"8px 12px",borderRadius:"4px",border:"none",cursor:"pointer"},XD=a(a({},YD),{},{background:"#f0f0f0",color:"#333",border:"1px solid #ccc"});const ZD=function(t){let{isOpen:n,onClose:o,onSave:r,edge:i,availableStats:s=[]}=t;const[l,u]=(0,e.useState)([]);return(0,e.useEffect)(()=>{var e;if(n&&null!==i&&void 0!==i&&null!==(e=i.data)&&void 0!==e&&e.originalEffects){const e=i.data.originalEffects.map(e=>a(a(a({},e),function(e){"string"!==typeof e&&(e=String(e||""));const t=e.match(/^([+-])\((\-?\d+)-(\-?\d+)\)$/);if(t)return{type:"modifyRange",modifyType:"+"===t[1]?"increase":"decrease",from:t[2],to:t[3]};const n=e.match(/^(\-?\d+)-(\-?\d+)$/);if(n)return{type:"range",from:n[1],to:n[2]};const o=e.match(/^([+-><=])(\-?\d+)$/);if(o){const e=o[1],t=o[2];if("+"===e||"-"===e)return{type:"modify",modifyType:"+"===e?"increase":"decrease",value:t};if(">"===e||"<"===e||"="===e)return{type:"check",checkType:{">":"greater","<":"less","=":"equal"}[e],value:t}}return{type:"set",value:e}}(e.value)),{},{id:Math.random()}));u(e)}else u([])},[n,i]),n?(0,c.jsx)("div",{style:qD,onClick:o,children:(0,c.jsxs)("div",{style:KD,onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("h3",{style:{marginTop:0,borderBottom:"1px solid #eee",paddingBottom:"10px"},children:["\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ",i.source," \u2192 ",i.target]}),(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:l.map((e,t)=>(0,c.jsx)(UD,{effect:e,availableStats:s,onChange:e=>((e,t)=>{const n=[...l];n[e]=t,u(n)})(t,e),onDelete:()=>(e=>{u(l.filter((t,n)=>n!==e))})(t)},e.id))}),(0,c.jsx)("button",{style:a(a({},YD),{},{background:"#cce5ff",color:"#004085",marginTop:"15px"}),onClick:()=>{u([...l,{id:Math.random(),stat:"",hide:!1,type:"set",value:"",modifiers:[],modifyType:"increase",checkType:"equal"}])},children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044d\u0444\u0444\u0435\u043a\u0442"}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px",marginTop:"20px"},children:[(0,c.jsx)("button",{style:XD,onClick:()=>alert('- \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043b\u044e\u0431\u044b\u043c, \u043d\u043e \u0441\u043b\u0435\u0434\u0438\u0442\u0435 \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u044b\u043b\u043e \u043e\u0434\u043d\u0438\u043c \u0438 \u0442\u0435\u043c \u0436\u0435 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430\u0445, \u043b\u044e\u0431\u0430\u044f \u043e\u043f\u0435\u0447\u0430\u0442\u043a\u0430 \u0441\u043b\u043e\u043c\u0430\u0435\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435/\u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439.\n\n- \u0427\u0438\u0441\u043b\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0435\u043b\u044b\u0435.\n\n- \u041a\u043d\u043e\u043f\u043a\u0430 "\u0441\u043a\u0440\u044b\u0442\u044c"(\u0433\u043b\u0430\u0437) \u0431\u0443\u0434\u0435\u0442 \u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432. \u0410 \u0442\u0430\u043a \u0436\u0435 \u043a\u043d\u043e\u043f\u043a\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u044f\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443, \u043f\u0440\u0438 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0441\u043a\u0440\u044b\u0442\u0438\u044f \u0442\u0430\u043a\u0438\u0435 \u043a\u043d\u043e\u043f\u043a\u0438 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u0432 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0435.'),title:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043f\u0440\u0430\u0432\u043a\u0443",children:"? \u041f\u043e\u043c\u043e\u0449\u044c"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)("button",{style:a(a({},YD),{},{background:"#e2e3e5"}),onClick:o,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,c.jsx)("button",{style:a(a({},YD),{},{background:"#d4edda",color:"#155724"}),onClick:()=>{const e=l.map(e=>{if(!e.stat.trim())return null;const{value:t,modifiers:n}=function(e){let t="",n=e.modifiers||[];switch(e.type){case"set":t=String(e.value||"0");break;case"modify":const n="increase"===e.modifyType?"+":"-";t="".concat(n).concat(e.value||"0");break;case"check":const o={greater:">",less:"<",equal:"="}[e.checkType];t="".concat(o).concat(e.value||"0");break;case"range":t="".concat(e.from||"0","-").concat(e.to||"0");break;case"modifyRange":const r="increase"===e.modifyType?"+":"-";t="".concat(r,"(").concat(e.from||"0","-").concat(e.to||"0",")");break;default:t=""}return"range"!==e.type&&"modifyRange"!==e.type&&(n=[]),{value:t,modifiers:n}}(e);return{stat:e.stat,hide:e.hide,value:t,modifiers:n}}).filter(Boolean);e.length===l.filter(e=>e.stat.trim()).length?r(e):alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u043f\u043e\u043b\u044f.")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"})]})]})]})}):null},GD=e=>{let{top:t,left:n,onClose:o,nodes:r,onDeleteAll:i,onCalculate:s}=e;const{ref:l,style:u}=$l({x:n,y:t}),d={background:"none",border:"none",padding:"8px 12px",textAlign:"left",cursor:"pointer",borderRadius:"4px",width:"100%"},h=e=>{e.target.style.backgroundColor="#f0f0f0"},f=e=>{e.target.style.backgroundColor="transparent"};return(0,c.jsxs)("div",{ref:l,style:a(a({},{zIndex:1e3,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"8px",display:"flex",flexDirection:"column",gap:"5px"}),u),onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("button",{style:d,onMouseEnter:h,onMouseLeave:f,onClick:()=>{i(r)},children:["\ud83d\uddd1 \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0451 (",r.length,")"]}),(0,c.jsx)("button",{style:d,onMouseEnter:h,onMouseLeave:f,onClick:()=>{s(r)},children:"\ud83c\udf9b \u041f\u0440\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c"}),(0,c.jsx)("div",{style:{borderTop:"1px solid #eee",margin:"4px 0"}}),(0,c.jsx)("button",{style:d,onMouseEnter:h,onMouseLeave:f,onClick:o,children:"\u274c \u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e"})]})},JD=(e,t)=>{t&&0!==t.length&&t.forEach(t=>{const n=(e=>{if((e=e.trim()).startsWith(">")||e.startsWith("<")||e.startsWith("="))return null;const t=e.match(/^(-?\d+)$/);if(t){const e=parseInt(t[1],10);return{min:e,max:e,type:"set"}}const n=e.match(/^(-?\d+)-(-?\d+)$/);if(n){const e=parseInt(n[1],10),t=parseInt(n[2],10);return{min:Math.min(e,t),max:Math.max(e,t),type:"set"}}const o=e.match(/^([+-])(\d+)$/);if(o){const e=o[1],t=parseInt(o[2],10);return{min:t,max:t,type:"+"===e?"add":"subtract"}}const r=e.match(/^([+-])\((\d+)-(\d+)\)$/);if(r){const e=r[1],t=parseInt(r[2],10),n=parseInt(r[3],10);return{min:Math.min(t,n),max:Math.max(t,n),type:"+"===e?"add":"subtract"}}return null})(t.value);if(!n)return;const o=t.stat;e[o]||(e[o]={min:0,max:0});const r=e[o];switch(n.type){case"set":r.min=n.min,r.max=n.max;break;case"add":r.min+=n.min,r.max+=n.max;break;case"subtract":r.min-=n.max,r.max-=n.min}})},QD=new(zl().graphlib.Graph);QD.setDefaultEdgeLabel(()=>({}));const eM=e=>({photo:"\u0444\u043e\u0442\u043e",video:"\u0432\u0438\u0434\u0435\u043e",animation:"\u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438",audio:"\u0430\u0443\u0434\u0438\u043e"}[e]||e),tM=(e,t)=>{var n;const o=!(null===(n=t.text)||void 0===n||!n.trim())&&"(\u043f\u0443\u0441\u0442\u043e)"!==t.text,r=Array.isArray(t.media)&&t.media.length>0;return o||r?t.choices&&0!==t.choices.length?"main_1"===e?"#86efac":/_1$/.test(e)&&"main_1"!==e?"#bbf7d0":"#e0f2fe":"#fef3c7":"#fecaca"},nM=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=e.match(/^(.*?)(?:_(\d+))?$/);if(!o)return{error:'\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0438\u043c\u0435\u043d\u0438: "'.concat(e,'"')};const r=o[1],i=o[2]?parseInt(o[2],10):0,s=new Set([...t].map(e=>e.toLowerCase()));if(n)return s.has(e.toLowerCase())?{error:'\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c "'.concat(e,'" \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442.')}:e.trim()?{id:e}:{error:"\u0418\u043c\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c."};let a=i+1;for(;s.has("".concat(r.toLowerCase(),"_").concat(a));)a++;return{id:"".concat(r,"_").concat(a)}},oM=(e,t,n)=>{if(null===e||void 0===e||!e.fragments)return{nodes:[],edges:[]};let o=[];const r=[];Object.entries(e.fragments).forEach(e=>{let[t,n]=e;const i=(n.media||[]).reduce((e,t)=>{let{type:n}=t;return a(a({},e),{},{[n]:(e[n]||0)+1})},{}),s=Object.entries(i).map(e=>{let[t,n]=e;return"".concat(n," ").concat(eM(t))}).join(", "),l=[t,n.text||"(\u043f\u0443\u0441\u0442\u043e)",s&&"\ud83d\udcce ".concat(s)].filter(Boolean).join("\n"),c=(n.media||[]).map(e=>a(a({},e),{},{url:"/api/tgfile/".concat(e.file_id)}));o.push({id:t,type:"custom",position:{x:0,y:0},data:{label:l,bgColor:tM(t,n),media:c,fragment:n}}),n.choices&&n.choices.forEach((e,n)=>{var o;const i=null!==(o=e.effects)&&void 0!==o&&o.length?e.effects.map(e=>"".concat(e.stat,": ").concat(e.value)).join(", "):"";r.push({id:"".concat(t,"->").concat(e.target,"_").concat(n),source:t,target:e.target,type:"custom",animated:!0,style:{stroke:"#2563eb"},data:{text:e.text,effectsText:i,originalEffects:e.effects||[],choiceIndex:n}})})}),t&&Object.entries(t).forEach(e=>{let[t,n]=e;o.push({id:t,type:"note",position:n.position,data:{text:n.text},draggable:!0,selectable:!0})});const i=new Set;r.forEach(e=>{i.add("".concat(e.source,"|").concat(e.target))}),r.forEach(e=>{const t="".concat(e.target,"|").concat(e.source);i.has(t)?e.source<e.target?e.data.offsetY=-20:e.data.offsetY=20:e.data.offsetY=0});if(n&&Object.keys(n).length>0)return o.forEach(e=>{n[e.id]&&(e.position=n[e.id])}),{nodes:o,edges:r};{const e=o.filter(e=>"note"!==e.type),t=o.filter(e=>"note"===e.type),{nodes:n,edges:i}=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TB";QD.setGraph({rankdir:n,nodesep:100,ranksep:150}),e.forEach(e=>{QD.setNode(e.id,{width:700,height:36})}),t.forEach(e=>{QD.setEdge(e.source,e.target)}),zl().layout(QD);const o=QD.node("main_1"),r=(null===o||void 0===o?void 0:o.x)||0,i=(null===o||void 0===o?void 0:o.y)||0;return e.forEach(e=>{const t=QD.node(e.id);e.targetPosition="top",e.sourcePosition="bottom",e.position={x:t.x-r,y:t.y-i}}),{nodes:e,edges:t}}(e,r);return{nodes:[...n,...t],edges:i}}},rM=e=>{const t={};return e.forEach(e=>{const n="".concat(e.source,"-").concat(e.target);t[n]||(t[n]=[]),t[n].push(e)}),e.map(e=>{const n="".concat(e.source,"-").concat(e.target),o=t[n];if(o.length<=1)return a(a({},e),{},{data:a(a({},e.data),{},{siblingIndex:0,siblingCount:1})});o.sort((e,t)=>{var n,o;return((null===(n=e.data)||void 0===n?void 0:n.choiceIndex)||0)-((null===(o=t.data)||void 0===o?void 0:o.choiceIndex)||0)});const r=o.findIndex(t=>t.id===e.id);return a(a({},e),{},{data:a(a({},e.data),{},{siblingIndex:r,siblingCount:o.length})})})},iM=e=>{let{onClose:t}=e;return(0,c.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxWidth:"600px",height:"70vh",backgroundColor:"white",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",zIndex:1001,display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsx)("h2",{style:{margin:0},children:"\u041f\u043e\u043c\u043e\u0449\u044c \u043f\u043e \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0443"}),(0,c.jsx)("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer"},children:"\xd7"})]}),(0,c.jsxs)("div",{style:{padding:"16px",overflowY:"auto",flexGrow:1},children:[(0,c.jsx)("h3",{children:"\u2728 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b"}),(0,c.jsxs)("p",{children:["- ",(0,c.jsx)("strong",{children:"\u041d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435:"})," \u041f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u0439\u0442\u0435 \u043a\u0430\u0440\u0442\u0443 \u0438\u043b\u0438 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u044b\u0448\u0438 \u0438\u043b\u0438 \u043f\u0430\u043b\u044c\u0446\u0430 \u043d\u0430 \u0441\u0435\u043d\u0441\u043e\u0440\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435.",(0,c.jsx)("br",{}),"- ",(0,c.jsx)("strong",{children:"\u0410\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435:"})," \u0420\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0438 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043f\u0440\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430."]}),(0,c.jsxs)("blockquote",{style:{margin:"16px 0",padding:"10px 20px",background:"#f9f9f9",borderLeft:"5px solid #ccc"},children:[(0,c.jsx)("strong",{children:"\u0412\u0430\u0436\u043d\u043e:"})," \u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u043d\u0435\u0441\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0431\u043e\u0442\u0435, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0432\u0435\u0431-\u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u043b\u0438\u0441\u044c. \u042d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0438 \u0432 \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443."]}),(0,c.jsx)("h3",{children:"\ud83d\udd1d \u0412\u0435\u0440\u0445\u043d\u0435\u0435 \u043c\u0435\u043d\u044e"}),(0,c.jsxs)("p",{children:["- ",(0,c.jsx)("strong",{children:"\u26f6 \u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c:"})," \u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 \u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e.",(0,c.jsx)("br",{}),"- ",(0,c.jsx)("strong",{children:"\u2195 \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0441\u0432\u0430\u0439\u043f\u043e\u0432:"})," \u0417\u0430\u0449\u0438\u0449\u0430\u0435\u0442 \u043e\u0442 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u0438\u043b\u0438 \u0441\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u043e\u043a\u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u0430 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432.",(0,c.jsx)("br",{}),"- ",(0,c.jsx)("strong",{children:"\u2610 \u041c\u0430\u0441\u0441\u043e\u0432\u043e\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435:"})," \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0440\u0435\u0436\u0438\u043c \u0432\u044b\u0431\u043e\u0440\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0430 \u043e\u0434\u0438\u043d \u0440\u0430\u0437."]}),(0,c.jsx)("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid #eee"}}),(0,c.jsx)("h3",{children:"\ud83e\udde9 \u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438"}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:"}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:"\u041f\u0440\u043e\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u044f\u0437\u044c \u043e\u0442 \u043d\u0438\u0436\u043d\u0435\u0439 \u043a\u0440\u0443\u0433\u043b\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0432 \u043f\u0443\u0441\u0442\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u043d\u0430 \u043a\u0430\u0440\u0442\u0435."}),(0,c.jsx)("li",{children:'\u041b\u0438\u0431\u043e \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u043c\u044b\u0448\u0438 (\u0438\u043b\u0438 \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0434\u043e\u043b\u0433\u043e\u0435 \u043d\u0430\u0436\u0430\u0442\u0438\u0435 \u043d\u0430 \u0441\u0435\u043d\u0441\u043e\u0440\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435) \u043d\u0430 \u043f\u0443\u0441\u0442\u043e\u043c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0435 \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 "\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442".'})]})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"\u0421\u0432\u044f\u0437\u044b\u0432\u0430\u043d\u0438\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432:"}),(0,c.jsx)("br",{}),"\u0427\u0442\u043e\u0431\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0434\u0432\u0430 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u0438\u043d\u0438\u044e \u043e\u0442 \u043a\u0440\u0443\u0433\u043b\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0432\u043d\u0438\u0437\u0443 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u043a \u0432\u0435\u0440\u0445\u043d\u0435\u0439 \u0447\u0430\u0441\u0442\u0438 \u0434\u0440\u0443\u0433\u043e\u0433\u043e."]}),(0,c.jsx)("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid #eee"}}),(0,c.jsx)("h3",{children:"\ud83d\uddb1\ufe0f \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u0435 \u043c\u0435\u043d\u044e"}),(0,c.jsx)("p",{children:"\u0414\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u0435 \u043c\u0435\u043d\u044e:"}),(0,c.jsxs)("ol",{children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u041c\u0435\u043d\u044e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:"})," \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 (\u043b\u044e\u0431\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u043c\u044b\u0448\u0438 \u0438\u043b\u0438 \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u043c/\u0434\u043e\u043b\u0433\u0438\u043c \u043d\u0430\u0436\u0430\u0442\u0438\u0435\u043c \u043d\u0430 \u0441\u0435\u043d\u0441\u043e\u0440\u0435) \u0434\u043b\u044f \u0432\u044b\u0437\u043e\u0432\u0430 \u043c\u0435\u043d\u044e \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u041c\u0435\u043d\u044e \u0441\u0432\u044f\u0437\u0438:"})," \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0442\u0435\u043a\u0441\u0442, \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u043b\u0438\u043d\u0438\u0438 \u0441\u0432\u044f\u0437\u0438 \u043c\u0435\u0436\u0434\u0443 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438, \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u044d\u0442\u043e\u0439 \u0441\u0432\u044f\u0437\u0438."]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"\u041c\u0435\u043d\u044e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f:"})," \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u043c\u044b\u0448\u0438 (\u0438\u043b\u0438 \u0434\u043e\u043b\u0433\u0438\u043c \u043d\u0430\u0436\u0430\u0442\u0438\u0435\u043c) \u043d\u0430 \u043f\u0443\u0441\u0442\u043e\u043c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u043b\u0438 \u0437\u0430\u043c\u0435\u0442\u043a\u0443."]})]}),(0,c.jsx)("hr",{style:{margin:"20px 0",border:"none",borderTop:"1px solid #eee"}}),(0,c.jsx)("h3",{children:"\ud83d\ude80 \u041c\u0430\u0441\u0441\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 (\u0434\u043b\u044f \u041f\u041a)"}),(0,c.jsxs)("p",{children:["\u0427\u0442\u043e\u0431\u044b \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432, \u0437\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043b\u0430\u0432\u0438\u0448\u0443 ",(0,c.jsx)("code",{children:"Shift"})," \u0438\u043b\u0438 ",(0,c.jsx)("code",{children:"Ctrl"})," \u0438 \u043a\u043b\u0438\u043a\u0430\u0439\u0442\u0435 \u043f\u043e \u043d\u0443\u0436\u043d\u044b\u043c \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043c.",(0,c.jsx)("br",{}),"\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f, \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0443\u044e \u043a\u043d\u043e\u043f\u043a\u0443 \u043c\u044b\u0448\u0438 \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0438\u0437 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u043c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043a \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u043f\u043e\u0434\u0441\u0447\u0451\u0442\u0443 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0432\u0441\u0435\u0445 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."]})]})]})};(new(zl().graphlib.Graph)).setDefaultEdgeLabel(()=>({}));function sM(t){let{realUserId:n}=t;const[o,r,i]=function(t){const[n,o]=(0,e.useState)(t),r=(0,e.useCallback)(e=>o(t=>ys(e,t)),[]);return[n,o,r]}([]),[s,l,u]=function(t){const[n,o]=(0,e.useState)(t),r=(0,e.useCallback)(e=>o(t=>bs(e,t)),[]);return[n,o,r]}([]),[d,h]=(0,e.useState)(null),[f,p]=(0,e.useState)(null),[m,g]=(0,e.useState)(null),[v,y]=(0,e.useState)([]),[b,x]=(0,e.useState)({isOpen:!1,edge:null}),[w,k]=(0,e.useState)(!1),[C,S]=(0,e.useState)(!1),E=(0,e.useRef)(!1),[D,M]=(0,e.useState)(null),N=(0,e.useRef)(null),A=(0,e.useRef)(null),{screenToFlowPosition:O,getNodes:T}=Ts(),[_,j]=(0,e.useState)(null),P=(t=>{const[n,o]=(0,e.useState)(()=>window.matchMedia(t).matches);return(0,e.useEffect)(()=>{const e=window.matchMedia(t),n=e=>o(e.matches);return e.addEventListener("change",n),()=>{e.removeEventListener("change",n)}},[t]),n})("(max-width: 768px)"),[I,R]=(0,e.useState)(!1),[F,z]=(0,e.useState)(!1),[L,B]=(0,e.useState)(!1),[V,H]=(0,e.useState)(!1),[$,W]=(0,e.useState)(!1),[U,q]=(0,e.useState)("unknown"),[K,Y]=(0,e.useState)(null),[X,Z]=(0,e.useState)(0);(0,e.useEffect)(()=>{console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 Telegram ID:",n)},[n]),(0,e.useEffect)(()=>{var e;const t=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(t){var n;Y(t);const e=parseFloat(t.version||"0");Z(e),t.ready(),null===(n=t.expand)||void 0===n||n.call(t)}else console.log("\u0417\u0430\u043f\u0443\u0449\u0435\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u2014 Telegram API \u043e\u0442\u043a\u043b\u044e\u0447\u0451\u043d \u2757")},[]),(0,e.useEffect)(()=>{if(!K)return;K.ready(),K.expand(),K&&X>=8&&K.checkHomeScreenStatus&&K.checkHomeScreenStatus(e=>q(e));const e=()=>q("added");return K.onEvent("homeScreenAdded",e),void 0!==K.isFullscreen&&H(K.isFullscreen),()=>{K.offEvent("homeScreenAdded",e)}},[K]);const G={background:"#fff",border:"1px solid #ccc",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",width:"40px",height:"40px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",padding:0,fontSize:"20px",lineHeight:1,transition:"all 0.2s"},J=a(a({},G),{},{background:"#e0f2fe",borderColor:"#2563eb",color:"#2563eb"}),{userId:Q,storyId:ee}=(0,e.useMemo)(()=>{const e=window.location.pathname,[t,n]=e.slice(1).split("_");return{userId:t,storyId:n}},[]),[te,ne]=(0,e.useState)({isOpen:!1,sourceNodeId:null,position:null,defaultName:""});(0,e.useEffect)(()=>{!async function(){var e,t;const n=b.edge;if(b.isOpen&&null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&e.storyId&&null!==n&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.userId){const e=await gC(n.data.userId,n.data.storyId);y(e)}}()},[b]),(0,e.useEffect)(()=>{var e,t,n;if(null!==(e=window.Telegram)&&void 0!==e&&null!==(t=e.WebApp)&&void 0!==t&&null!==(n=t.initDataUnsafe)&&void 0!==n&&n.user){const e=window.Telegram.WebApp.initDataUnsafe.user;console.log("\ud83d\udc64 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b WebApp:",e)}else console.warn("WebApp \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043d\u0435 \u0438\u0437 Telegram \u0438\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 initDataUnsafe")},[]);const oe=(0,e.useCallback)(()=>{if(!Q||!ee)return;const e=T();if(!e.length)return;const t=e.reduce((e,t)=>(e[t.id]=t.position,e),{});fetch("/api/story/".concat(Q,"/").concat(ee,"/positions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{e.ok||console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u043e\u0437\u0438\u0446\u0438\u0439")}).catch(e=>console.error("\u0421\u0435\u0442\u0435\u0432\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u043e\u0437\u0438\u0446\u0438\u0439:",e))},[Q,ee,T]);(0,e.useEffect)(()=>{(async()=>{if(Q&&ee)try{const[e,t,n]=await Promise.all([fetch("/api/story/".concat(Q,"/").concat(ee)),fetch("/api/story/".concat(Q,"/").concat(ee,"/positions")),yC(Q,ee)]),o=await e.json();if(o.error)throw new Error(o.error);let i={};t.ok&&(i=await t.json());const{nodes:s,edges:a}=oM(o,n,i),c=rM(a);r(s),l(c)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445:",e),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u043b\u0438 \u0435\u0435 \u043a\u0430\u0440\u0442\u0443.")}})()},[Q,ee,r,l]),(0,e.useEffect)(()=>{var e;const t=null===(e=N.current)||void 0===e?void 0:e.querySelector(".react-flow__renderer"),n=e=>{if(e.target.classList.contains("react-flow__pane"))return;const t=T().filter(e=>e.selected);t.length>1&&(e.preventDefault(),h(null),M(null),p(null),g(null),j({top:e.clientY,left:e.clientX,nodes:t}))};return null===t||void 0===t||t.addEventListener("contextmenu",n),()=>null===t||void 0===t?void 0:t.removeEventListener("contextmenu",n)},[T]);const re=(0,e.useCallback)((e,t)=>{let{nodeId:n}=t;A.current=n,E.current=!1},[]),ie=(0,e.useCallback)(async e=>{if(!e.source||!e.target)return;E.current=!0;const t=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0434\u043b\u044f \u043a\u043d\u043e\u043f\u043a\u0438 \u044d\u0442\u043e\u0433\u043e \u0432\u044b\u0431\u043e\u0440\u0430:");if(t)try{let n;await async function(e,t,n,o,r){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:n,target:o,text:r})});return await i.json()}(Q,ee,e.source,e.target,t),r(o=>o.map(o=>{if(o.id===e.source){const r={target:e.target,text:t,effects:[]};n=o.data.fragment.choices?o.data.fragment.choices.length:0;const i=o.data.fragment.choices?[...o.data.fragment.choices,r]:[r];return a(a({},o),{},{data:a(a({},o.data),{},{fragment:a(a({},o.data.fragment),{},{choices:i})})})}return o}));const o=s.some(t=>t.source===e.target&&t.target===e.source);let i=0;o&&(i=e.source<e.target?-20:20,l(t=>t.map(t=>t.source===e.target&&t.target===e.source?a(a({},t),{},{data:a(a({},t.data),{},{offsetY:e.source<e.target?20:-20})}):t)));const c={id:"".concat(e.source,"->").concat(e.target,"_").concat(n),source:e.source,target:e.target,type:"custom",animated:!0,style:{stroke:"#2563eb"},data:{text:t,effectsText:"",originalEffects:[],choiceIndex:n,offsetY:i}};l(e=>{const t=e.concat(c);return rM(t)})}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u0432\u044f\u0437\u0438: ".concat(n.message))}},[Q,ee,l,r,s]),se=(0,e.useCallback)(e=>{var t;if(E.current)return void(E.current=!1);const n=A.current;if(A.current=null,!n)return;let o=e.clientX,r=e.clientY;if("touchend"===e.type&&(null===(t=e.changedTouches)||void 0===t?void 0:t.length)>0&&(o=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY),"number"!==typeof o||"number"!==typeof r)return;const i=new Set(T().map(e=>e.id)),{id:s}=nM(n,i);ne({isOpen:!0,sourceNodeId:n,position:O({x:o,y:r}),defaultName:s||""})},[O,T,nM]),ae=(0,e.useCallback)(()=>{oe()},[oe]),le=(0,e.useCallback)(async e=>{const t=e.filter(e=>"note"!==e.type);if(0===t.length)return void j(null);const n=t.map(e=>e.id);if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ".concat(n.length," \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442(\u0430)? \u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e.")))try{await async function(e,t,n){return(await fetch("/api/story/".concat(e,"/").concat(t,"/fragments/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fragment_ids:n})})).ok}(Q,ee,n),r(e=>e.filter(e=>!n.includes(e.id))),l(e=>e.filter(e=>!n.includes(e.source)&&!n.includes(e.target))),console.log("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u043e ".concat(n.length," \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."))}catch(o){alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432."),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0433\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f:",o)}finally{j(null)}},[Q,ee,r,l]),ce=(0,e.useCallback)(e=>{const t=(e=>{if(!e||0===e.length)return"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u0447\u0435\u0442\u0430.";const t=new Set(e.map(e=>e.id)),n=new Map(e.map(e=>[e.id,e])),o=new Set;e.forEach(e=>{var n;null===(n=e.data.fragment.choices)||void 0===n||n.forEach(e=>{t.has(e.target)&&o.add(e.target)})});const r=e.filter(e=>!o.has(e.id)),i=[],s=(e,o)=>{var r;const a=(null===(r=n.get(e).data.fragment.choices)||void 0===r?void 0:r.filter(e=>t.has(e.target)))||[];0!==a.length?a.forEach(t=>{s(t.target,[...o,e])}):i.push([...o,e])};r.forEach(e=>s(e.id,[]));let a="\u26a0\ufe0f \u0415\u0441\u043b\u0438 \u0432\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u043b\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u044b, \u0442\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0441\u0447\u0451\u0442\u0430.\n\n";return i.forEach((e,t)=>{const o={};for(let i=0;i<e.length;i++){const t=e[i],r=n.get(t);if(JD(o,r.data.fragment.effects),i<e.length-1){const t=e[i+1],n=r.data.fragment.choices.find(e=>e.target===t);n&&JD(o,n.effects)}}a+="".concat(t+1,'. "').concat(e.join(" -> "),'"\n\u042d\u0444\u0444\u0435\u043a\u0442\u044b:\n');const r=Object.keys(o);0===r.length?a+="- (\u043d\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432)\n":r.forEach(e=>{const{min:t,max:n}=o[e],r=t===n?t:"".concat(t," - ").concat(n);a+="  - ".concat(e,": ").concat(r,"\n")}),a+="\n"}),0===i.length?"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0446\u0435\u043f\u043e\u0447\u0435\u043a \u043c\u0435\u0436\u0434\u0443 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438. \u041a\u0430\u0436\u0434\u044b\u0439 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d.":a})(e);alert(t),j(null)},[]),ue=(0,e.useCallback)((e,t)=>{e.preventDefault();const n=T().filter(e=>e.selected);n.length>1?n.find(e=>e.id===t.id)&&(h(null),M(null),j({top:e.clientY,left:e.clientX,nodes:n})):(j(null),"note"===t.type?M({id:t.id,node:t,top:e.clientY,left:e.clientX}):h({id:t.id,top:e.clientY,left:e.clientX,node:t}))},[T,h,M,j]),de=(0,e.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),p({id:t.id,top:e.clientY,left:e.clientX,edge:t})},[p]),he=(0,e.useCallback)(()=>{h(null),p(null),g(null),M(null),j(null)},[]),fe=(0,e.useCallback)(()=>{he()},[he]),pe=(0,e.useCallback)(()=>{he()},[he]),me=(0,e.useCallback)(e=>{e.preventDefault(),he(),g({top:e.clientY,left:e.clientX,flowPosition:O({x:e.clientX,y:e.clientY})})},[O,he]),ge=(0,e.useCallback)(async e=>{let t=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0421\u0446\u0435\u043d\u0430_1):");if(!t)return;const n=new Set(T().map(e=>e.id)),{id:o,error:i}=nM(t.trim(),n,!0);if(i)alert(i);else try{const{story:t}=await async function(e,t,n){const o=await fetch("/api/story/".concat(e,"/").concat(t,"/create_fragment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newName:n})});if(!o.ok){const{error:e}=await o.json();throw new Error(e)}return await o.json()}(Q,ee,o),n=t.fragments[o];if(!n)throw new Error("\u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u0432\u0435\u0440\u043d\u0443\u043b \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.");const i={id:o,type:"custom",position:e,data:{label:"".concat(o,"\n(\u043f\u0443\u0441\u0442\u043e)"),bgColor:tM(o,n),media:[],fragment:n}};r(e=>e.concat(i)),setTimeout(oe,100)}catch(s){s.response?s.response.json().then(e=>{alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(e.error||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"))}).catch(()=>{alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(s.message))}):alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430: ".concat(s.message)),console.error(s)}},[Q,ee,T,r,oe,nM]),ve=(0,e.useCallback)(async(e,t)=>{const{sourceNodeId:n,position:o}=te;if(!n||!o||!e||!t)throw new Error("\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430.");try{const{story:i}=await async function(e,t,n,o,r){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/create_and_connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:n,newName:o,choiceText:r})});if(!i.ok){const{error:e}=await i.json();throw new Error(e)}return await i.json()}(Q,ee,n,e,t),s=i.fragments[n].choices.findIndex(t=>t.target===e);if(-1===s)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0432\u044b\u0431\u043e\u0440 \u0432 \u043e\u0442\u0432\u0435\u0442\u0435 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.");const c={id:e,type:"custom",position:o,data:{label:"".concat(e,"\n(\u043f\u0443\u0441\u0442\u043e)"),bgColor:"#fecaca",media:[],fragment:i.fragments[e]}},u={id:"".concat(n,"->").concat(e,"_").concat(s),source:n,target:e,type:"custom",animated:!0,style:{stroke:"#2563eb"},data:{text:t,effectsText:"",originalEffects:[],choiceIndex:s}};r(e=>{const t=e.map(e=>{if(e.id===n){const t=i.fragments[n],o=(t.media||[]).reduce((e,t)=>{let{type:n}=t;return a(a({},e),{},{[n]:(e[n]||0)+1})},{}),r=Object.entries(o).map(e=>{let[t,n]=e;return"".concat(n," ").concat(eM(t))}).join(", "),s=[n,t.text||"(\u043f\u0443\u0441\u0442\u043e)",r&&"\ud83d\udcce ".concat(r)].filter(Boolean).join("\n");return a(a({},e),{},{data:a(a({},e.data),{},{fragment:t,label:s,bgColor:tM(n,t)})})}return e});return[...t,c]}),l(e=>e.concat(u)),ne({isOpen:!1,sourceNodeId:null,position:null,defaultName:""}),setTimeout(oe,100)}catch(i){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 API \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430:",i),i}},[Q,ee,r,l,oe,te]),ye=(0,e.useCallback)(async e=>{try{const{status:t,bookmark:n}=await async function(e,t,n,o){const r=await fetch("/api/story/".concat(e,"/").concat(t,"/bookmarks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,position:o})});if(!r.ok){const{error:e}=await r.json();throw new Error(e||"Server error")}return await r.json()}(Q,ee,"(\u043f\u0443\u0441\u0442\u043e)",e);if("ok"!==t||!n)throw new Error("\u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u0432\u0435\u0440\u043d\u0443\u043b \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0437\u0430\u043c\u0435\u0442\u043a\u0435.");{const e={id:n.id,type:"note",position:n.position,data:{text:n.text},draggable:!0,selectable:!0};r(t=>t.concat(e)),M({node:e,top:window.innerHeight/2,left:window.innerWidth/2,autoOpenEditor:!0}),setTimeout(oe,100)}}catch(t){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u043c\u0435\u0442\u043a\u0438: ".concat(t.message))}},[Q,ee,r,oe]),be=(0,e.useCallback)(async e=>{const{edge:t}=b;if(t){console.log("Saving effects for:",t.data.userId,t.data.storyId);try{await async function(e,t,n,o,r){const i=await fetch("/api/story/".concat(e,"/").concat(t,"/choice"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a({source:n,choiceIndex:o},r))});if(!i.ok){const{error:e}=await i.json();throw new Error(e)}return await i.json()}(Q,ee,t.source,t.data.choiceIndex,{effects:e}),l(n=>n.map(n=>{if(n.id===t.id){const t=e.length?e.map(e=>"".concat(e.stat,": ").concat(e.value)).join(", "):"";return a(a({},n),{},{data:a(a({},n.data),{},{originalEffects:e,effectsText:t})})}return n})),x({isOpen:!1,edge:null})}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ".concat(n.message))}}},[b,Q,ee,l]),xe=(0,e.useMemo)(()=>({custom:Bl,note:Hl}),[]),we=(0,e.useMemo)(()=>({custom:Ll}),[]);return(0,c.jsxs)("div",{style:{height:"100vh",width:"100%",touchAction:I?"none":"pan-y",WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},ref:N,onContextMenu:e=>e.preventDefault(),children:[(0,c.jsxs)("div",{style:{position:"absolute",top:V?90:10,left:10,zIndex:200,display:"flex",alignItems:"center",gap:"2px",transition:"top 0.3s ease"},children:[(0,c.jsx)("button",{onClick:()=>{const e=window.location.pathname.split("_")[0].replace("/","");window.location.href="/".concat(e)},style:{background:"#10b981",border:"none",borderRadius:"8px 0 0 8px",color:"white",cursor:"pointer",width:"40px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"24px",fontWeight:"bold",zIndex:2},title:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0441\u043f\u0438\u0441\u043a\u0443",children:"\u2630"}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",overflow:"hidden",maxWidth:F?"300px":"0px",paddingLeft:F?"8px":"0px",paddingRight:F?"8px":"0px",opacity:F?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:"40px"},children:[(null===K||void 0===K?void 0:K.requestFullscreen)&&(0,c.jsx)("button",{onClick:()=>{K&&(V?K.exitFullscreen&&K.exitFullscreen():K.requestFullscreen&&K.requestFullscreen(),H(!V))},style:V?J:G,title:"\u041d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d",children:V?"\u2715":"\u26f6"}),P&&(null===K||void 0===K?void 0:K.disableVerticalSwipes)&&(0,c.jsx)("button",{onClick:()=>{K&&($?(K.enableVerticalSwipes&&K.enableVerticalSwipes(),W(!1)):(K.disableVerticalSwipes&&K.disableVerticalSwipes(),W(!0)))},style:$?J:G,title:$?"\u0421\u0432\u0430\u0439\u043f\u044b \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u044b":"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u0430\u0439\u043f\u044b",children:(0,c.jsxs)("div",{style:{position:"relative"},children:[(0,c.jsx)("span",{children:"\u2195"}),$&&(0,c.jsx)("div",{style:{position:"absolute",top:"50%",left:"-2px",right:"-2px",height:"2px",background:"#2563eb",transform:"rotate(-45deg)"}})]})}),(0,c.jsx)("button",{onClick:()=>R(!I),style:I?J:G,title:"\u0420\u0435\u0436\u0438\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f",children:(0,c.jsx)("span",{style:{fontSize:"22px",fontWeight:"bold"},children:I?"\u2611":"\u2610"})})]}),(0,c.jsx)("button",{onClick:()=>z(!F),style:{background:"#10b981",border:"none",color:"white",width:"32px",height:"40px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"0.25s",borderRadius:"0 8px 8px 0"},title:"\u0421\u043a\u0440\u044b\u0442\u044c/\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0435\u043d\u044e",children:F?"\u25c0":"\u25b6"})]}),(0,c.jsxs)(ll,{nodes:o,edges:s,onNodesChange:i,onEdgesChange:u,nodeTypes:xe,edgeTypes:we,onConnect:ie,onConnectStart:re,onConnectEnd:se,onPaneClick:pe,onPaneContextMenu:me,onNodeDragStop:ae,onNodeClick:ue,onNodeContextMenu:ue,onEdgeClick:de,onEdgeContextMenu:de,onMoveStart:fe,fitView:!0,minZoom:.1,maxZoom:2,connectionRadius:70,panOnScroll:!1,panOnDrag:!I,zoomOnPinch:!I,zoomOnScroll:!I,zoomOnDoubleClick:!I,selectionOnDrag:I,selectionMode:Eo.Partial,children:[(0,c.jsx)(Dl,{}),(0,c.jsxs)("div",{style:{position:"absolute",bottom:10,right:10,zIndex:100,display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",overflow:"hidden",maxHeight:L?"150px":"0px",opacity:L?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",marginBottom:L?"8px":"0px",width:"140px"},children:[(0,c.jsx)("button",{onClick:()=>k(!w),style:{background:"#fff",border:"1px solid #ccc",borderRadius:"6px",padding:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:w?"\u0421\u043a\u0440\u044b\u0442\u044c \u043a\u0430\u0440\u0442\u0443":"\u041c\u0438\u043d\u0438\u043a\u0430\u0440\u0442\u0430"}),(0,c.jsx)("button",{onClick:()=>S(!0),style:{background:"#fff",border:"1px solid #ccc",borderRadius:"6px",padding:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"\u041f\u043e\u043c\u043e\u0449\u044c"})]}),(0,c.jsx)("button",{onClick:()=>B(!L),style:{width:"140px",height:"24px",background:"#10b981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",marginBottom:"5px",transition:"background 0.2s"},children:L?"\u25bc":"\u25b2"}),(0,c.jsx)("button",{onClick:()=>window.open("https://t.me/FoxNovel_bot?start=".concat(ee),"_blank"),style:{padding:"8px 14px",fontSize:"16px",fontWeight:"bold",borderRadius:"6px",background:"#10b981",color:"white",border:"none",cursor:"pointer",width:"140px",height:"40px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"\u25b6 \u0418\u0433\u0440\u0430\u0442\u044c"})]}),(0,c.jsx)(vl,{}),w&&(0,c.jsx)(Il,{nodeColor:e=>e.data.bgColor,pannable:!0,zoomable:!0,style:{position:"absolute",top:10,right:10,width:P?150:200,height:P?100:150,borderRadius:8,background:"rgba(255,255,255,0.95)",boxShadow:"0 4px 10px rgba(0,0,0,0.15)",zIndex:120}}),d&&(0,c.jsx)(dD,a({onClick:pe,setNodes:r,setEdges:l},d)),f&&(0,c.jsx)(xD,a(a({},f),{},{userId:Q,storyId:ee,onClick:()=>p(null),onEditEffects:()=>{x({isOpen:!0,edge:a(a({},f.edge),{},{data:a(a({},f.edge.data),{},{userId:Q,storyId:ee})})}),p(null)},setEdges:l})),m&&(0,c.jsx)(wD,a(a({},m),{},{onClose:()=>g(null),onCreateFragment:()=>ge(m.flowPosition),onAddNote:()=>ye(m.flowPosition)})),D&&(0,c.jsx)(mD,{node:D.node,setNodes:r,onClose:()=>M(null),top:D.top,left:D.left,autoOpenEditor:D.autoOpenEditor}),_&&(0,c.jsx)(GD,{top:_.top,left:_.left,nodes:_.nodes,onClose:()=>j(null),onDeleteAll:le,onCalculate:ce})]}),(0,c.jsx)(ZD,{isOpen:b.isOpen,edge:b.edge,onClose:()=>x({isOpen:!1,edge:null}),onSave:be,availableStats:v}),(0,c.jsx)(vD,{isOpen:te.isOpen,onClose:()=>ne({isOpen:!1,sourceNodeId:null,position:null,defaultName:""}),onSubmit:ve,sourceNodeName:te.sourceNodeId,defaultName:te.defaultName,generateUniqueFragmentId:nM,existingIds:new Set(T().map(e=>e.id))}),C&&(0,c.jsx)(iM,{onClose:()=>S(!1)})]})}const aM=function(e){return(0,c.jsx)(il,{children:(0,c.jsx)(sM,a({},e))})},lM=t=>{var n,o,r,i,s;let{userId:l}=t;const[u,d]=(0,e.useState)([]),[h,f]=(0,e.useState)(!0),[p,m]=(0,e.useState)(null),[g,v]=(0,e.useState)([]),[y,b]=(0,e.useState)(null),[x,w]=(0,e.useState)(null!==(n=null===(o=window.Telegram)||void 0===o||null===(r=o.WebApp)||void 0===r?void 0:r.isHomeScreenIconAdded)&&void 0!==n&&n);(0,e.useEffect)(()=>{var e;const t=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(!t)return;const n=()=>{t.isHomeScreenIconAdded&&w(!0)};n();try{var o,r,i;null===(o=t.onEvent)||void 0===o||o.call(t,"homeScreenIconAdded",n),null===(r=t.onEvent)||void 0===r||r.call(t,"homeScreenStatusChanged",n),null===(i=t.checkHomeScreenStatus)||void 0===i||i.call(t)}catch(s){console.warn("API HomeScreen \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e:",s.message)}return()=>{var e,o;null===(e=t.offEvent)||void 0===e||e.call(t,"homeScreenIconAdded",n),null===(o=t.offEvent)||void 0===o||o.call(t,"homeScreenStatusChanged",n)}},[]),(0,e.useEffect)(()=>{(async()=>{try{f(!0);const e=await async function(e){const t=await fetch("/api/stories/".concat(e));if(!t.ok)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u0442\u043e\u0440\u0438\u0439");return await t.json()}(l);d(e),m(null)}catch(e){m(e.message)}finally{f(!1)}})()},[l]);const k=()=>b(null),C=e=>{navigator.clipboard.writeText(e),alert("\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e!")};return(0,c.jsxs)("div",{className:"container-dark",children:[(0,c.jsx)("style",{children:'\n      .container-dark {\n        padding: 20px;\n        max-width: 800px;\n        margin: 0 auto;\n        font-family: Arial, sans-serif;\n        background-color: #1e1e1e;\n        color: #e0e0e0;\n        min-height: 100vh;\n      }\n      h1 {\n        font-size: 24px;\n        margin-bottom: 20px;\n        text-align: center;\n        color: #fff;\n      }\n      ul {\n        list-style: none;\n        padding: 0;\n        margin: 0;\n      }\n      li {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 12px 15px;\n        border: 1px solid #333;\n        margin-bottom: 10px;\n        border-radius: 10px;\n        background-color: #2a2a2a;\n        transition: background-color 0.2s;\n        flex-wrap: nowrap; /* \u0432\u0430\u0436\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u2014 \u043d\u0435 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u043c \u043d\u0430 \u0434\u0435\u0441\u043a\u0442\u043e\u043f\u0435 */\n      }\n      li:hover {\n        background-color: #333;\n      }\n      .story-header {\n        display: flex;\n        align-items: center;\n        flex: 1;\n        min-width: 0;\n      }\n      input[type="checkbox"] {\n        transform: scale(1.3);\n        margin-right: 10px;\n        flex-shrink: 0;\n      }\n      .story-title {\n        font-size: 18px;\n        flex: 1;\n        word-break: break-word;\n      }\n      .buttons {\n        display: flex;\n        gap: 8px;\n        flex-shrink: 0;\n        flex-wrap: nowrap;\n      }\n      button, a {\n        text-decoration: none;\n        padding: 8px 12px;\n        color: white;\n        border-radius: 6px;\n        cursor: pointer;\n        border: none;\n        font-size: 14px;\n        transition: opacity 0.2s;\n      }\n      .edit-btn { background-color: #007bff; }\n      .del-btn { background-color: #dc3545; }\n      .share-btn { background-color: #6c757d; }\n      .create-btn, .bulk-del-btn {\n        display: block;\n        width: 100%;\n        padding: 12px;\n        font-size: 16px;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        margin-top: 20px;\n        text-align: center;\n      }\n      .create-btn { background-color: #28a745; color: white; }\n      .bulk-del-btn { background-color: #d9534f; color: white; }\n\n      /* === \u041c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u043d\u043e === */\n      .modal-overlay {\n        position: fixed;\n        top: 0; left: 0; right: 0; bottom: 0;\n        background-color: rgba(0,0,0,0.7);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n      }\n      .modal-content {\n        background-color: #2b2b2b;\n        border-radius: 12px;\n        padding: 25px;\n        max-width: 500px;\n        width: 90%;\n        color: #f1f1f1;\n        box-shadow: 0 0 20px rgba(0,0,0,0.5);\n        animation: fadeIn 0.3s ease;\n      }\n      @keyframes fadeIn {\n        from {opacity: 0; transform: scale(0.9);}\n        to {opacity: 1; transform: scale(1);}\n      }\n      .modal-content h2 {\n        text-align: center;\n        margin-bottom: 20px;\n        color: #fff;\n      }\n      .modal-content p {\n        margin-bottom: 15px;\n        line-height: 1.4;\n      }\n      .link-box {\n        display: flex;\n        align-items: center;\n        background-color: #1e1e1e;\n        border-radius: 8px;\n        padding: 8px 10px;\n        justify-content: space-between;\n        word-break: break-all;\n      }\n      .copy-btn {\n        background-color: #444;\n        border: none;\n        border-radius: 6px;\n        color: #fff;\n        padding: 5px 10px;\n        cursor: pointer;\n      }\n      .copy-btn:hover {\n        background-color: #666;\n      }\n      .modal-footer {\n        text-align: center;\n        margin-top: 25px;\n      }\n      .close-btn {\n        background-color: #555;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        padding: 8px 14px;\n        cursor: pointer;\n      }\n      .close-btn:hover {\n        background-color: #777;\n      }\n      label {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-top: 15px;\n        font-size: 15px;\n      }\n\n      /* === \u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f \u0430\u0434\u0430\u043f\u0442\u0430\u0446\u0438\u044f === */\n      @media (max-width: 600px) {\n        li {\n          flex-direction: column;\n          align-items: flex-start;\n          flex-wrap: wrap;\n        }\n        .story-header {\n          width: 100%;\n          margin-bottom: 6px;\n        }\n        .buttons {\n          width: 100%;\n          justify-content: flex-start;\n          flex-wrap: wrap;\n          margin-top: 10px; /* \u2190 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0442\u0441\u0442\u0443\u043f \u0441\u043d\u0438\u0437\u0443 */\n        }\n      }\n    '}),(0,c.jsx)("h1",{children:"\u0412\u0430\u0448\u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u0438"}),h&&(0,c.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0441\u0442\u043e\u0440\u0438\u0439..."}),p&&(0,c.jsxs)("p",{style:{color:"red"},children:["\u041e\u0448\u0438\u0431\u043a\u0430: ",p]}),!h&&!p&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("ul",{children:u.length>0?u.map(e=>(0,c.jsxs)("li",{children:[(0,c.jsxs)("div",{className:"story-header",children:[(0,c.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:()=>(e=>{v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e.id)}),(0,c.jsx)("span",{className:"story-title",children:e.title})]}),(0,c.jsxs)("div",{className:"buttons",children:[(0,c.jsx)("a",{href:"/".concat(l,"_").concat(e.id),className:"edit-btn",children:"\u0420\u0435\u0434."}),(0,c.jsx)("button",{className:"del-btn",onClick:()=>(async(e,t)=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e \xab".concat(t,"\xbb? \u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e.")))try{await mC(l,e),d(t=>t.filter(t=>t.id!==e))}catch(n){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438: ".concat(n.message))}})(e.id,e.title),children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),(0,c.jsx)("button",{className:"share-btn",onClick:()=>(e=>b(e))(e),children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"})]})]},e.id)):(0,c.jsx)("p",{style:{textAlign:"center"},children:"\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u0439."})}),g.length>0&&(0,c.jsxs)("button",{onClick:async()=>{if(window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c ".concat(g.length," \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0438\u0441\u0442\u043e\u0440\u0438\u0439?")))try{await Promise.all(g.map(e=>mC(l,e))),d(e=>e.filter(e=>!g.includes(e.id))),v([])}catch(e){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438: ".concat(e.message))}},className:"bulk-del-btn",children:["\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435 (",g.length,")"]}),(0,c.jsx)("button",{onClick:async()=>{var e,t,n;const o=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0438:");if(!o||!o.trim())return alert("\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c.");const r=null===(e=window.Telegram)||void 0===e||null===(t=e.WebApp)||void 0===t||null===(n=t.initDataUnsafe)||void 0===n?void 0:n.user,i=(null===r||void 0===r?void 0:r.username)||"unknown_user",s=(null===r||void 0===r?void 0:r.first_name)||i;try{const e=await async function(e,t,n,o){const r=await fetch("/api/stories/".concat(e,"/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,user_name:n,author_name:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e")}return await r.json()}(l,o.trim(),i,s);window.location.href="/".concat(l,"_").concat(e.story_id)}catch(a){alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e: ".concat(a.message))}},className:"create-btn",children:"+ \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e"}),(null===(i=window.Telegram)||void 0===i||null===(s=i.WebApp)||void 0===s?void 0:s.addToHomeScreen)&&!x&&(0,c.jsx)("button",{onClick:()=>{window.Telegram.WebApp.addToHomeScreen(),w(!0)},style:{marginTop:"15px",width:"100%",padding:"12px",borderRadius:"8px",background:"#3a3a3a",color:"#fff",fontSize:"16px",cursor:"pointer",border:"none",opacity:.9},children:"+\u0438\u043a\u043e\u043d\u043a\u0443 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u044b\u0439 \u044d\u043a\u0440\u0430\u043d \u0443\u0441\u0442-\u0432\u0430"})]}),y&&(0,c.jsx)("div",{className:"modal-overlay",onClick:k,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("h2",{children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u0435\u0439"}),(0,c.jsxs)("p",{children:["\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0441\u0432\u043e\u0435\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0435\u0439 ",(0,c.jsxs)("b",{children:["\xab",y.title,"\xbb"]})," \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 3 \u0441\u043f\u043e\u0441\u043e\u0431\u0430\u043c\u0438:"]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"1)"})," \u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0441\u0441\u044b\u043b\u043a\u0438. \u041f\u0440\u043e\u0441\u0442\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u0435\u0451 \u0442\u0435\u043c, \u0441 \u043a\u0435\u043c \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0434\u0430\u043d\u043d\u043e\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0435\u0439:"]}),(0,c.jsxs)("div",{className:"link-box",children:[(0,c.jsx)("span",{children:"https://t.me/FoxNovel_bot?start=".concat(y.id)}),(0,c.jsx)("button",{className:"copy-btn",onClick:()=>C("https://t.me/FoxNovel_bot?start=".concat(y.id)),children:"\ud83d\udccb"})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"2)"})," \u0412 \u043b\u044e\u0431\u043e\u043c Telegram-\u0447\u0430\u0442\u0435 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 ",(0,c.jsx)("b",{children:"@FoxNovel_bot"})," \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043d\u0443\u0436\u043d\u0443\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e:"]}),(0,c.jsxs)("div",{className:"link-box",children:[(0,c.jsx)("span",{children:"@FoxNovel_bot"}),(0,c.jsx)("button",{className:"copy-btn",onClick:()=>C("@FoxNovel_bot"),children:"\ud83d\udccb"})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("b",{children:"3)"})," \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0445 \u0438\u0441\u0442\u043e\u0440\u0438\u0439 \u0431\u043e\u0442\u0430. \u0422\u043e\u0433\u0434\u0430 \u043e\u043d\u0430 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u043c \u043c\u0435\u043d\u044e:"]}),(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",checked:!!y.public,onChange:async e=>{const t=e.target.checked;let n=y.user_name||"";if(t&&(n=prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f:",n||""),!n))return alert("\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0445 \u0438\u0441\u0442\u043e\u0440\u0438\u0439."),void(e.target.checked=!1);try{const e=await async function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=await fetch("/api/story/".concat(e,"/").concat(t,"/public"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({public:n,user_name:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0441\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u0438")}return await r.json()}(l,y.id,t,n);b(a(a({},y),{},{public:t,user_name:e.user_name})),d(n=>n.map(n=>n.id===y.id?a(a({},n),{},{public:t,user_name:e.user_name}):n))}catch(o){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0441\u0442\u0438: "+o.message)}}}),"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u0443\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0439"]}),(0,c.jsx)("div",{className:"modal-footer",children:(0,c.jsx)("button",{className:"close-btn",onClick:k,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]})})]})},cM=()=>{var e,t,n,o;const r=window.location.pathname,i=(null===(e=window.Telegram)||void 0===e||null===(t=e.WebApp)||void 0===t||null===(n=t.initDataUnsafe)||void 0===n||null===(o=n.user)||void 0===o?void 0:o.id)||null,s=r.match(/^\/([^_]+)_(.+)$/),a=r.match(/^\/([^_]+)$/);if(s)return(0,c.jsx)(il,{children:(0,c.jsx)(aM,{realUserId:i})});if(a){const e=a[1];return(0,c.jsx)(lM,{userId:e})}return(0,c.jsxs)("div",{children:["\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441. ",(0,c.jsx)("br",{})," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435 \u0438\u0437 Telegram \u0431\u043e\u0442\u0430."]})};t.createRoot(document.getElementById("root")).render((0,c.jsxs)(e.StrictMode,{children:[(0,c.jsx)(cM,{}),"  "]}))})()})();
//# sourceMappingURL=main.62667385.js.map